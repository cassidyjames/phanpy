import{A as q,y as ne,M as rt,u as de,h as L,s as x,a as le,b as Je,p as gt,c as Ve,q as st,g as vt,d as e,k as O,T as h,e as ke,f as Rt,i as _n,j as Ce,L as mo,C as Dn,D as go,m as bo,n as Gn,o as Zt,r as pe,t as yo,v as Fe,w as Cn,x as Ti,_ as wt,z as hs,B as yd,E as fs,F as ps,G as vo,H as wo,I as at,J as ko,K as si,N as So,O as bt,P as _o,Q as Co,R as oi,S as Lt,U as Qe,V as ms,W as gs,X as Io,Y as sn,Z as To,$ as Ao,a0 as On,a1 as zn,a2 as xo,a3 as Ai,a4 as Eo,a5 as Ro,a6 as Lo,a7 as ci,a8 as Ke,a9 as Mo,aa as $o,ab as Po,ac as No}from"./useTitle-DO1qxJae.js";import{u as ai,a as He,s as me,o as xi,b as Do,J as bs,c as ys,I as T,C as li,d as vs,M as Ye,e as We,S as ln,f as Se,g as Ln,R as It,n as ot,h as qe,A as ft,N as mt,i as lt,j as ut,L as be,l as xt,k as ws,m as et,t as Ei,p as wd,q as it,r as zt,v as ht,w as Kn,x as ks,E as Ss,y as Xe,z as Ri,T as _s,B as pt,D as ri,F as je,G as Ct,H as Oo,K as zo,O as Nt,P as di,Q as Cs,U as Uo,V as jt,W as Fo,X as Bo,Y as Is,Z as Ho,_ as Dt,$ as qo,a0 as Ts,a1 as Yo,a2 as As,a3 as jo,a4 as Vo,a5 as Go,a6 as Ko,a7 as Wo,a8 as Li,a9 as Zo,aa as Bt}from"./ScheduledAtField-CUA83MXQ.js";var xs=Xo;function Xo(n,i,s){var o=null,c=null,l=function(){o&&(clearTimeout(o),c=null,o=null)},u=function(){var d=c;l(),d&&d()},r=function(){if(!i)return n.apply(this,arguments);var d=this,a=arguments,m=s&&!o;if(l(),c=function(){n.apply(d,a)},o=setTimeout(function(){if(o=null,!m){var b=c;return c=null,b()}},i),m)return c()};return r.cancel=l,r.flush=u,r}/*!
 * swiped-events.js - v@version@
 * Pure JavaScript swipe events
 * https://github.com/john-doherty/swiped-events
 * @inspiration https://stackoverflow.com/questions/16348031/disable-scrolling-when-touch-moving-certain-element
 * @author John Doherty <www.johndoherty.info>
 * @license MIT
 */(function(n,i){"use strict";typeof n.CustomEvent!="function"&&(n.CustomEvent=function(p,f){f=f||{bubbles:!1,cancelable:!1,detail:void 0};var y=i.createEvent("CustomEvent");return y.initCustomEvent(p,f.bubbles,f.cancelable,f.detail),y},n.CustomEvent.prototype=n.Event.prototype),i.addEventListener("touchstart",m,!1),i.addEventListener("touchmove",b,!1),i.addEventListener("touchend",a,!1);var s=null,o=null,c=null,l=null,u=null,r=null,d=0;function a(p){if(r===p.target){var f=parseInt(g(r,"data-swipe-threshold","20"),10),y=g(r,"data-swipe-unit","px"),v=parseInt(g(r,"data-swipe-timeout","500"),10),w=Date.now()-u,_="",S=p.changedTouches||p.touches||[];if(y==="vh"&&(f=Math.round(f/100*i.documentElement.clientHeight)),y==="vw"&&(f=Math.round(f/100*i.documentElement.clientWidth)),Math.abs(c)>Math.abs(l)?Math.abs(c)>f&&w<v&&(c>0?_="swiped-left":_="swiped-right"):Math.abs(l)>f&&w<v&&(l>0?_="swiped-up":_="swiped-down"),_!==""){var k={dir:_.replace(/swiped-/,""),touchType:(S[0]||{}).touchType||"direct",fingers:d,xStart:parseInt(s,10),xEnd:parseInt((S[0]||{}).clientX||-1,10),yStart:parseInt(o,10),yEnd:parseInt((S[0]||{}).clientY||-1,10)};r.dispatchEvent(new CustomEvent("swiped",{bubbles:!0,cancelable:!0,detail:k})),r.dispatchEvent(new CustomEvent(_,{bubbles:!0,cancelable:!0,detail:k}))}s=null,o=null,u=null}}function m(p){p.target.getAttribute("data-swipe-ignore")!=="true"&&(r=p.target,u=Date.now(),s=p.touches[0].clientX,o=p.touches[0].clientY,c=0,l=0,d=p.touches.length)}function b(p){if(!(!s||!o)){var f=p.touches[0].clientX,y=p.touches[0].clientY;c=s-f,l=o-y}}function g(p,f,y){for(;p&&p!==i.documentElement;){var v=p.getAttribute(f);if(v)return v;p=p.parentNode}return y}})(window,document);function Vt(n=()=>{},i=[]){const s=q(n);ne(()=>{s.current=n},[i]),ne(()=>{const o=()=>{const c=document.hidden||document.visibilityState==="hidden";s.current(!c)};return document.addEventListener("visibilitychange",o),()=>document.removeEventListener("visibilitychange",o)},[])}const Jo=1e3*3,Mi=2e4,Qo=rt(function({isLoggedIn:i}){const{_:s}=de(),[o,c]=L(!0),l=q();Vt(a=>{clearTimeout(l.current),a?c(!0):l.current=setTimeout(()=>{c(!1)},Mi)});const u=async(a,m,b)=>{var g;if(x.notificationsLast){const p=a.v1.notifications.list({limit:1,sinceId:x.notificationsLast.id}),{value:f}=await p.next();if(f!=null&&f.length)if(b)x.notificationsShowNew=!0;else{let y;try{const v=await a.v1.markers.fetch({timeline:"notifications"});y=(g=v==null?void 0:v.notifications)==null?void 0:g.lastReadId}catch{}y?x.notificationsShowNew=f[0].id!==y:x.notificationsShowNew=!0}}};ne(()=>{let a,m,b;if(i&&o){const{masto:g,streaming:p,instance:f}=le();(async()=>{await u(g,f);let y=!1;p&&(m=setTimeout(()=>{(async()=>{try{y=!0,a=p.user.notification.subscribe();for await(const v of a){if(!a||!o)break;v.event==="notification"&&Je(v.payload,f,{skipThreading:!0}),x.notificationsShowNew=!0}}catch{y=!1}y||(b=setInterval(()=>{u(g,f,!0)},Mi))})()},Jo))})()}return()=>{var g;(g=a==null?void 0:a.unsubscribe)==null||g.call(a),a=null,clearTimeout(m),clearInterval(b)}},[o,i]);const r=q(),d=()=>{r.current=Date.now(),fetch("./version.json").then(a=>a.json()).then(a=>{a&&(x.appVersion=a)}).catch(a=>{})};return ai(d,o&&1e3*60*30),Vt(a=>{a&&(r.current?Date.now()-r.current>1e3*60*60&&d():d())}),He("shift+alt+k",()=>{const a=x.settings.cloakMode;x.settings.cloakMode=!a,me({text:s(a?{id:"oguMwa"}:{id:"IXZLPs"})})}),null}),ec=gt(async(n,i)=>{const s=n.v1.accounts.$select(i).statuses.list({limit:3,exclude_replies:!0,exclude_reblogs:!0}),{value:o}=await s.next();return o||[]},{maxAge:6e4});function tc(){const{_:n}=de(),i=Ve(x),{masto:s}=le(),[o,c]=L(!1),[l,u]=L([]),[r,d]=L(!1),a=q(null),m=q(null);function b(y){if(i.composerState.minimized){x.composerState.minimized=!1,xi();return}y.shiftKey?Do()||(x.showCompose=!0):(xi(),x.showCompose=!0)}He("c, shift+c",b,{ignoreEventWhen:y=>!!document.querySelector("#modal-container > *")});const g=bs(()=>{c(!0)},{threshold:600}),p=st(async()=>{try{d(!0);const y=vt();if(!y)return;const v=await ec(s,y);u(v)}catch{}finally{d(!1)}},[s]),f=st(y=>{ys({replyToStatus:y}),c(!1)},[]);return ne(()=>{o&&p()},[p,o]),e(O,{children:[e("button",{ref:a,type:"button",id:"compose-button",onClick:b,onContextMenu:y=>{y.preventDefault(),c(!0)},...g(),class:`${i.composerState.minimized?"min":""} ${i.composerState.publishing?"loading":""} ${i.composerState.publishingError?"error":""}`,children:e(T,{icon:"quill",size:"xl",alt:n({id:"QOhkyl"})})}),e(li,{ref:m,state:o?"open":void 0,anchorRef:a,onClose:()=>c(!1),direction:"top",gap:8,unmountOnClose:!0,portal:{target:document.body},boundingBoxPadding:vs(),containerProps:{style:{zIndex:9},onClick:()=>{var y,v;(v=(y=m.current)==null?void 0:y.closeMenu)==null||v.call(y)}},submenuOpenDelay:600,children:[e(Ye,{to:"/sp",children:[e(T,{icon:"schedule"})," ",e("span",{children:e(h,{id:"+GkIdc"})})]}),e(We,{}),e(ln,{align:"end",direction:"top",shift:-8,disabled:r||l.length===0,label:e(O,{children:[e(T,{icon:"comment"})," ",e("span",{className:"menu-grow",children:e(h,{id:"LwOr4P"})}),r?"…":e(T,{icon:"chevron-right"})]}),children:l.length>0&&l.map(y=>{const v=new Date(y.createdAt),w=new Date().getTime()-v.getTime()<864e5;return e(Se,{onClick:()=>f(y),children:e("small",{children:[e("div",{class:"menu-post-text",children:Ln(y)}),e("span",{className:"more-insignificant",children:[w&&e(O,{children:[e(It,{datetime:v,format:"micro"})," ","‒"," "]}),e("time",{className:"created",dateTime:v.toISOString(),title:v.toLocaleString(),children:ot(y.createdAt)})]})]})},y.id)})})]})]})}const nc=rt(function(){const{_:i}=de(),s=Ve(x);function o(){x.showKeyboardShortcutsHelp=!1}return He("?, shift+?, shift+slash",c=>{x.showKeyboardShortcutsHelp=!0},{ignoreEventWhen:c=>/\/catchup/i.test(location.hash)}),!!s.showKeyboardShortcutsHelp&&e(qe,{onClose:o,children:e("div",{id:"keyboard-shortcuts-help-container",class:"sheet",tabindex:"-1",children:[e("button",{type:"button",class:"sheet-close",onClick:o,children:e(T,{icon:"x",alt:i({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(h,{id:"77Emn0"})})}),e("main",{children:e("table",{children:e("tbody",{children:[{action:i({id:"ulXSNi"}),keys:e("kbd",{children:"?"})},{action:i({id:"Gy9P9T"}),keys:e("kbd",{children:"j"})},{action:i({id:"6XYpYY"}),keys:e("kbd",{children:"k"})},{action:i({id:"DYowFe"}),keys:e(h,{id:"mzjGX4",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"S5ez7Y"}),keys:e(h,{id:"Fd8FaU",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"VkLESX"}),keys:e("kbd",{children:"."})},{action:i({id:"jsFF8C"}),keys:e(h,{id:"80sOCm",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:e(h,{id:"41gejM",components:{0:e("br",{})}}),keys:e("kbd",{children:"x"})},{action:i({id:"jAj8rv"}),keys:e(h,{id:"evz6c6",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"duF1lx"}),keys:e(h,{id:"nhpsIN",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"YrR3Co"}),keys:e("kbd",{children:"]"})},{action:i({id:"noxAFR"}),keys:e("kbd",{children:"["})},{action:i({id:"AIa/f7"}),keys:e("kbd",{children:"c"})},{action:i({id:"snPx8X"}),className:"insignificant",keys:e(h,{id:"+Cxvld",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"1pKapz"}),keys:e(h,{id:"py67WT",components:{0:e("kbd",{}),1:e("kbd",{}),2:e("kbd",{}),3:e("kbd",{})}})},{action:i({id:"A1taO8"}),keys:e("kbd",{children:"/"})},{action:i({id:"ImOQa9"}),keys:e("kbd",{children:"r"})},{action:i({id:"KFs8c6"}),className:"insignificant",keys:e(h,{id:"XpQLJF",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"cqi4Mx"}),keys:e(h,{id:"84WuL2",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"kulphB"}),keys:e(h,{id:"yrz6Ck",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"PZlHt8"}),keys:e("kbd",{children:"d"})},{action:i({id:"C7ujRh"}),keys:e(h,{id:"v4TbMP",components:{0:e("kbd",{}),1:e("kbd",{}),2:e("kbd",{})}})}].map(({action:c,className:l,keys:u})=>e("tr",{children:[e("th",{class:l,children:c}),e("td",{children:u})]},c))})})})]})})}),Es=new Set,ct=new WeakMap,Gt=new WeakMap,Ot=new WeakMap,Wn=new WeakMap,ic=new WeakMap,Kt=new WeakMap,In=new WeakMap,tn=new WeakSet;let Et,ui=0,hi=0;const St="__aa_tgt",on="__aa_del",Tn="__aa_new",sc=n=>{const i=dc(n);i&&i.forEach(s=>uc(s))},oc=n=>{n.forEach(i=>{i.target===Et&&ac(),ct.has(i.target)&&Ut(i.target)})};function cc(n){const i=Wn.get(n);i==null||i.disconnect();let s=ct.get(n),o=0;const c=5;s||(s=Wt(n),ct.set(n,s));const{offsetWidth:l,offsetHeight:u}=Et,d=[s.top-c,l-(s.left+c+s.width),u-(s.top+c+s.height),s.left-c].map(m=>`${-1*Math.floor(m)}px`).join(" "),a=new IntersectionObserver(()=>{++o>1&&Ut(n)},{root:Et,threshold:1,rootMargin:d});a.observe(n),Wn.set(n,a)}function Ut(n){clearTimeout(In.get(n));const i=Mn(n),s=cn(i)?500:i.duration;In.set(n,setTimeout(async()=>{const o=Ot.get(n);try{await(o==null?void 0:o.finished),ct.set(n,Wt(n)),cc(n)}catch{}},s))}function ac(){clearTimeout(In.get(Et)),In.set(Et,setTimeout(()=>{Es.forEach(n=>$s(n,i=>Rs(()=>Ut(i))))},100))}function lc(n){setTimeout(()=>{ic.set(n,setInterval(()=>Rs(Ut.bind(null,n)),2e3))},Math.round(2e3*Math.random()))}function Rs(n){typeof requestIdleCallback=="function"?requestIdleCallback(()=>n()):requestAnimationFrame(()=>n())}let Zn,Yt;const rc=typeof window<"u"&&"ResizeObserver"in window;rc&&(Et=document.documentElement,Zn=new MutationObserver(sc),Yt=new ResizeObserver(oc),window.addEventListener("scroll",()=>{hi=window.scrollY,ui=window.scrollX}),Yt.observe(Et));function dc(n){return n.reduce((o,c)=>[...o,...Array.from(c.addedNodes),...Array.from(c.removedNodes)],[]).every(o=>o.nodeName==="#comment")?!1:n.reduce((o,c)=>{if(o===!1)return!1;if(c.target instanceof Element){if(Un(c.target),!o.has(c.target)){o.add(c.target);for(let l=0;l<c.target.children.length;l++){const u=c.target.children.item(l);if(u){if(on in u)return!1;Un(c.target,u),o.add(u)}}}if(c.removedNodes.length)for(let l=0;l<c.removedNodes.length;l++){const u=c.removedNodes[l];if(on in u)return!1;u instanceof Element&&(o.add(u),Un(c.target,u),Gt.set(u,[c.previousSibling,c.nextSibling]))}}return o},new Set)}function Un(n,i){!i&&!(St in n)?Object.defineProperty(n,St,{value:n}):i&&!(St in i)&&Object.defineProperty(i,St,{value:n})}function uc(n){var i;const s=n.isConnected,o=ct.has(n);s&&Gt.has(n)&&Gt.delete(n),Ot.has(n)&&((i=Ot.get(n))===null||i===void 0||i.cancel()),Tn in n?$i(n):o&&s?fc(n):o&&!s?pc(n):$i(n)}function yt(n){return Number(n.replace(/[^0-9.\-]/g,""))}function hc(n){let i=n.parentElement;for(;i;){if(i.scrollLeft||i.scrollTop)return{x:i.scrollLeft,y:i.scrollTop};i=i.parentElement}return{x:0,y:0}}function Wt(n){const i=n.getBoundingClientRect(),{x:s,y:o}=hc(n);return{top:i.top+o,left:i.left+s,width:i.width,height:i.height}}function Ls(n,i,s){let o=i.width,c=i.height,l=s.width,u=s.height;const r=getComputedStyle(n);if(r.getPropertyValue("box-sizing")==="content-box"){const a=yt(r.paddingTop)+yt(r.paddingBottom)+yt(r.borderTopWidth)+yt(r.borderBottomWidth),m=yt(r.paddingLeft)+yt(r.paddingRight)+yt(r.borderRightWidth)+yt(r.borderLeftWidth);o-=m,l-=m,c-=a,u-=a}return[o,l,c,u].map(Math.round)}function Mn(n){return St in n&&Kt.has(n[St])?Kt.get(n[St]):{duration:250,easing:"ease-in-out"}}function Ms(n){if(St in n)return n[St]}function fi(n){const i=Ms(n);return i?tn.has(i):!1}function $s(n,...i){i.forEach(s=>s(n,Kt.has(n)));for(let s=0;s<n.children.length;s++){const o=n.children.item(s);o&&i.forEach(c=>c(o,Kt.has(o)))}}function pi(n){return Array.isArray(n)?n:[n]}function cn(n){return typeof n=="function"}function fc(n){const i=ct.get(n),s=Wt(n);if(!fi(n))return ct.set(n,s);let o;if(!i)return;const c=Mn(n);if(typeof c!="function"){const l=i.left-s.left,u=i.top-s.top,[r,d,a,m]=Ls(n,i,s),b={transform:`translate(${l}px, ${u}px)`},g={transform:"translate(0, 0)"};r!==d&&(b.width=`${r}px`,g.width=`${d}px`),a!==m&&(b.height=`${a}px`,g.height=`${m}px`),o=n.animate([b,g],{duration:c.duration,easing:c.easing})}else{const[l]=pi(c(n,"remain",i,s));o=new Animation(l),o.play()}Ot.set(n,o),ct.set(n,s),o.addEventListener("finish",Ut.bind(null,n))}function $i(n){Tn in n&&delete n[Tn];const i=Wt(n);ct.set(n,i);const s=Mn(n);if(!fi(n))return;let o;if(typeof s!="function")o=n.animate([{transform:"scale(.98)",opacity:0},{transform:"scale(0.98)",opacity:0,offset:.5},{transform:"scale(1)",opacity:1}],{duration:s.duration*1.5,easing:"ease-in"});else{const[c]=pi(s(n,"add",i));o=new Animation(c),o.play()}Ot.set(n,o),o.addEventListener("finish",Ut.bind(null,n))}function Pi(n,i){var s;n.remove(),ct.delete(n),Gt.delete(n),Ot.delete(n),(s=Wn.get(n))===null||s===void 0||s.disconnect(),setTimeout(()=>{if(on in n&&delete n[on],Object.defineProperty(n,Tn,{value:!0,configurable:!0}),i&&n instanceof HTMLElement)for(const o in i)n.style[o]=""},0)}function pc(n){var i;if(!Gt.has(n)||!ct.has(n))return;const[s,o]=Gt.get(n);Object.defineProperty(n,on,{value:!0,configurable:!0});const c=window.scrollX,l=window.scrollY;if(o&&o.parentNode&&o.parentNode instanceof Element?o.parentNode.insertBefore(n,o):s&&s.parentNode?s.parentNode.appendChild(n):(i=Ms(n))===null||i===void 0||i.appendChild(n),!fi(n))return Pi(n);const[u,r,d,a]=gc(n),m=Mn(n),b=ct.get(n);(c!==ui||l!==hi)&&mc(n,c,l,m);let g,p={position:"absolute",top:`${u}px`,left:`${r}px`,width:`${d}px`,height:`${a}px`,margin:"0",pointerEvents:"none",transformOrigin:"center",zIndex:"100"};if(!cn(m))Object.assign(n.style,p),g=n.animate([{transform:"scale(1)",opacity:1},{transform:"scale(.98)",opacity:0}],{duration:m.duration,easing:"ease-out"});else{const[f,y]=pi(m(n,"remove",b));(y==null?void 0:y.styleReset)!==!1&&(p=(y==null?void 0:y.styleReset)||p,Object.assign(n.style,p)),g=new Animation(f),g.play()}Ot.set(n,g),g.addEventListener("finish",Pi.bind(null,n,p))}function mc(n,i,s,o){const c=ui-i,l=hi-s,u=document.documentElement.style.scrollBehavior;if(getComputedStyle(Et).scrollBehavior==="smooth"&&(document.documentElement.style.scrollBehavior="auto"),window.scrollTo(window.scrollX+c,window.scrollY+l),!n.parentElement)return;const d=n.parentElement;let a=d.clientHeight,m=d.clientWidth;const b=performance.now();function g(){requestAnimationFrame(()=>{if(!cn(o)){const p=a-d.clientHeight,f=m-d.clientWidth;b+o.duration>performance.now()?(window.scrollTo({left:window.scrollX-f,top:window.scrollY-p}),a=d.clientHeight,m=d.clientWidth,g()):document.documentElement.style.scrollBehavior=u}})}g()}function gc(n){const i=ct.get(n),[s,,o]=Ls(n,i,Wt(n));let c=n.parentElement;for(;c&&(getComputedStyle(c).position==="static"||c instanceof HTMLBodyElement);)c=c.parentElement;c||(c=document.body);const l=getComputedStyle(c),u=ct.get(c)||Wt(c),r=Math.round(i.top-u.top)-yt(l.borderTopWidth),d=Math.round(i.left-u.left)-yt(l.borderLeftWidth);return[r,d,s,o]}function Ps(n,i={}){return Zn&&Yt&&(window.matchMedia("(prefers-reduced-motion: reduce)").matches&&!cn(i)&&!i.disrespectUserMotionPreference||(tn.add(n),getComputedStyle(n).position==="static"&&Object.assign(n.style,{position:"relative"}),$s(n,Ut,lc,c=>Yt==null?void 0:Yt.observe(c)),cn(i)?Kt.set(n,i):Kt.set(n,{duration:250,easing:"ease-in-out",...i}),Zn.observe(n,{childList:!0}),Es.add(n))),Object.freeze({parent:n,enable:()=>{tn.add(n)},disable:()=>{tn.delete(n)},isEnabled:()=>tn.has(n)})}function mi(n){const i=q(null),[s,o]=L(),c=l=>{s&&(l?s.enable():s.disable())};return ne(()=>{i.current instanceof HTMLElement&&o(Ps(i.current,n||{}))},[]),[i,c]}const bc=window.matchMedia("(display-mode: standalone)").matches;function yc({onClose:n}){const{_:i}=de(),{masto:s}=le(),o=ke.local.getJSON("accounts"),c=vt(),l=o.length>1,[u,r]=Rt(a=>a+1,0),[d]=mi();return e("div",{id:"accounts-container",class:"sheet",tabIndex:"-1",children:[!!n&&e("button",{type:"button",class:"sheet-close",onClick:n,children:e(T,{icon:"x",alt:i({id:"yz7wBu"})})}),e("header",{class:"header-grid",children:e("h2",{children:e(h,{id:"bPwFdf"})})}),e("main",{children:e("section",{children:[e("ul",{class:"accounts-list",ref:d,children:o.map((a,m)=>{const b=a.info.id===c,g=m===0;return e("li",{children:[e("div",{children:[l&&e("span",{class:`current ${b?"is-current":""}`,children:e(T,{icon:"check-circle",alt:i({id:"Hp1l6f"})})}),e(ft,{url:a.info.avatarStatic,size:"xxl",onDblClick:async()=>{if(b)try{const p=await s.v1.accounts.$select(a.info.id).fetch();a.info=p,ke.local.setJSON("accounts",o),r()}catch{}}}),e(mt,{account:l?{...a.info,acct:/@/.test(a.info.acct)?a.info.acct:`${a.info.acct}@${a.instanceURL}`}:a.info,showAcct:!0,onClick:()=>{b?x.showAccount=`${a.info.username}@${a.instanceURL}`:(_n(a.info.id),location.reload())}})]}),e("div",{class:"actions",children:[g&&l&&e(O,{children:[e("span",{class:"tag",children:e(h,{id:"ovBPCi"})})," "]}),e(lt,{align:"end",menuButton:e("button",{type:"button",class:"plain more-button",children:e(T,{icon:"more",size:"l",alt:i({id:"2FYpfJ"})})}),children:[l&&e(O,{children:[e(Se,{disabled:b,onClick:()=>{_n(a.info.id),location.reload()},children:[e(T,{icon:"transfer"})," ",e(h,{id:"3t/Nrv"})]}),!bc&&!b&&e(Ye,{href:`./?account=${a.info.id}`,target:"_blank",children:[e(T,{icon:"external"}),e("span",{children:e(h,{id:"PZgZtY"})})]}),e(We,{})]}),e(Se,{onClick:()=>{x.showAccount=`${a.info.username}@${a.instanceURL}`},children:[e(T,{icon:"user"}),e("span",{children:e(h,{id:"40z2Fm"})})]}),e(We,{}),l&&e(Se,{disabled:g,onClick:()=>{o.splice(m,1),o.unshift(a),ke.local.setJSON("accounts",o),r()},children:[e(T,{icon:"check-circle"}),e("span",{children:e(h,{id:"PPcets"})})]}),e(ut,{subMenu:!0,confirmLabel:e(O,{children:[e(T,{icon:"exit"}),e("span",{children:e(h,{id:"k08LxG",values:{0:a.info.acct},components:{0:e("span",{class:"bidi-isolate"})}})})]}),disabled:!b,menuItemClassName:"danger",onClick:()=>{o.splice(m,1),ke.local.setJSON("accounts",o),location.href=location.pathname||"/"},children:[e(T,{icon:"exit"}),e("span",{children:e(h,{id:"CXk1bI"})})]})]})]})]},a.info.id)})}),e("p",{children:e(be,{to:"/login",class:"button plain2",onClick:n,children:[e(T,{icon:"plus"})," ",e("span",{children:e(h,{id:"Is7/PB"})})]})}),l&&e("p",{children:e("small",{children:e(h,{id:"52x24e",components:{0:e("i",{})}})})})]})})]})}const gi="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20fill-rule='evenodd'%20stroke-linejoin='round'%20stroke-miterlimit='2'%20clip-rule='evenodd'%20viewBox='0%200%2064%2064'%3e%3cpath%20fill='none'%20d='M0%200h63.994v63.994H0z'/%3e%3cpath%20fill='%23a4bff7'%20d='M37.774%2011.471c14.639%203.752%2019.034%2016.557%2015.889%2031.304-.696%203.261-2.563%206.661-6.356%208.693-3.204%201.717-8.07%202.537-15.338.55l-9.634-2.404C11.651%2046.992%208.378%2038.733%2010.027%2031.823c3.627-15.201%2015.543-23.48%2027.747-20.352Z'/%3e%3cpath%20fill='%23d8e7fe'%20d='M36.76%2015.429c12.289%203.15%2015.547%2014.114%2012.907%2026.493-.947%204.44-4.937%209.365-16.664%206.143l-9.684-2.417c-7.854-1.923-10.53-7.8-9.318-12.877%203.016-12.639%2012.611-19.943%2022.759-17.342Z'/%3e%3cpath%20fill='%236081e6'%20d='M27.471%2024.991c-1.457-.698-7.229%203.213-7.663%208.926-.182%202.39%204.55%203.237%205.071-.169.725-4.743%203.715-8.218%202.592-8.757Zm10.746%202.005c-2.083.327-.382%205.901-.595%2010.727-.123%202.8%204.388%203.464%204.703%202.011%201.098-5.073-2.066-13.058-4.108-12.738Z'/%3e%3c/svg%3e",vc={"zh-CN":"zh-Hans","zh-TW":"zh-Hant","pt-BR":"pt-BR"};function bi(){const{i18n:n}=de(),i=Ce(()=>mo.map(s=>{var u,r;const o=vc[s]||s.replace(/-[a-z]+$/i,""),c=xt({code:o,locale:s,fallback:(u=Dn.find(d=>d.code===s))==null?void 0:u.nativeName}),l=xt({code:o,locale:n.locale,fallback:(r=Dn.find(d=>d.code===s))==null?void 0:r.name});return{code:s,regionlessCode:o,_common:l,native:c}}).sort((s,o)=>{const c=s._common.localeCompare(o._common,n.locale);return c!==0?c:s.code<o.code?-1:s.code>o.code?1:0}),[]);return e("label",{class:"lang-selector",children:["🌐"," ",e("select",{class:"small",value:n.locale||go,onChange:s=>{ke.local.set("lang",s.target.value),bo(s.target.value)},children:[i.map(({code:s,regionlessCode:o,native:c})=>{var r;const l=xt({code:o,locale:n.locale,fallback:(r=Dn.find(d=>d.code===s))==null?void 0:r.name});return e("option",{value:s,"data-regionless-code":o,children:!!l&&l!==c?`${c} - ${l}`:c},s)}),void 0]})]})}function Ni(n){const{masto:i}=le();return i.v1.push.subscription.create(n)}function wc(){const{masto:n}=le();return n.v1.push.subscription.fetch()}function kc(n){const{masto:i}=le();return i.v1.push.subscription.update(n)}function Sc(){const{masto:n}=le();return n.v1.push.subscription.remove()}function $n(){return"serviceWorker"in navigator&&"PushManager"in window}function _c(){return navigator.serviceWorker.getRegistration()}async function yi(){const n=await _c(),i=n?await n.pushManager.getSubscription():void 0;return{registration:n,subscription:i}}function Ns(n){const i="=".repeat((4-n.length%4)%4),s=`${n}${i}`.replace(/-/g,"+").replace(/_/g,"/"),o=window.atob(s),c=new Uint8Array(o.length);for(let l=0;l<o.length;++l)c[l]=o.charCodeAt(l);return c}async function Cc(){if(!$n())return;const{subscription:n}=await yi();let i=null;try{i=await wc()}catch(s){if(!/(not found|unknown)/i.test(s.message))throw s}if(i&&n){const s=i.endpoint===n.endpoint,o=Gn(),c=i.serverKey===o;if(!s)throw new Error("Backend subscription endpoint changed");if(!c)throw new Error("Backend subscription key and vapid key changed")}if(n&&!i){const s=Gn();if(s){const{applicationServerKey:o}=n.options,c=Ns(s).toString(),l=new Uint8Array(o).toString();if(!(c===l))throw await n.unsubscribe(),new Error("Subscription key and vapid key changed")}}return{subscription:n,backendSubscription:i}}async function Di({data:n,policy:i}){if(!$n())return;let{registration:s,subscription:o}=await yi(),c=null;if(o)try{c=await kc({data:n,policy:i})}catch{c=await Ni({subscription:o,data:n,policy:i})}else{const l=Gn();if(!l)throw new Error("No server key found");o=await s.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Ns(l)}),c=await Ni({subscription:o,data:n,policy:i})}return{subscription:o,backendSubscription:c}}async function Oi(){if(!$n())return;const{subscription:n}=await yi();n&&(await Sc(),await n.unsubscribe())}const Ic={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Blaede Phanpy",PHANPY_DEFAULT_INSTANCE:"mastodon.blaede.family",PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:"https://mastodon.blaede.family/auth/sign_up",PHANPY_GIPHY_API_KEY:"48JGsrSS1XE5w4nWe9c9hqxPbsfRWR0e",PHANPY_LINGVA_INSTANCES:"lingva.phanpy.social lingva.lunar.icu lingva.garudalinux.org translate.plausibility.cloud",PHANPY_PRIVACY_POLICY_URL:"https://mastodon.blaede.family/privacy-policy",PHANPY_WEBSITE:"https://phanpy.blaede.family",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},zi=16,Pt=[14,15,16,17,18,19,20],{PHANPY_WEBSITE:Ui,PHANPY_PRIVACY_POLICY_URL:Tc,PHANPY_IMG_ALT_API_URL:Ac,PHANPY_GIPHY_API_KEY:xc}=Ic;function Ec({onClose:n}){const{_:i}=de(),s=Ve(x),o=ke.local.get("theme")||"auto",c=q(),l=s.settings.contentTranslationTargetLanguage||null,u=ws(),r=xt(u),d=ke.local.get("textSize")||zi,[a,m]=L(ke.account.get("preferences")||{}),{masto:b,authenticated:g,instance:p}=le();return e("div",{id:"settings-container",class:"sheet",tabIndex:"-1",style:{"--current-text-size":`${d}px`},children:[!!n&&e("button",{type:"button",class:"sheet-close",onClick:n,children:e(T,{icon:"x",alt:i({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(h,{id:"Tz0i8g"})})}),e("main",{children:[e("section",{children:e("ul",{children:[e("li",{children:[e("div",{children:e("label",{children:e(h,{id:"aAIQg2"})})}),e("div",{children:e("form",{ref:c,onInput:f=>{f.preventDefault();const v=new FormData(c.current).get("theme"),w=document.documentElement;if(v==="auto"){w.classList.remove("is-light","is-dark");const _=document.querySelector('meta[data-theme-setting="manual"]');_&&(_.name=""),document.querySelectorAll('meta[data-theme-setting="auto"]').forEach(k=>{k.name="theme-color"})}else{w.classList.toggle("is-light",v==="light"),w.classList.toggle("is-dark",v==="dark");const _=document.querySelector('meta[data-theme-setting="manual"]');_&&(_.name="theme-color",_.content=v==="light"?_.dataset.themeLightColor:_.dataset.themeDarkColor),document.querySelectorAll('meta[data-theme-setting="auto"]').forEach(k=>{k.name=""})}document.querySelector('meta[name="color-scheme"]').setAttribute("content",v==="auto"?"dark light":v),v==="auto"?ke.local.del("theme"):ke.local.set("theme",v)},children:e("div",{class:"radio-group",children:[e("label",{children:[e("input",{type:"radio",name:"theme",value:"light",defaultChecked:o==="light"}),e("span",{children:e(h,{id:"1njn7W"})})]}),e("label",{children:[e("input",{type:"radio",name:"theme",value:"dark",defaultChecked:o==="dark"}),e("span",{children:e(h,{id:"pvnfJD"})})]}),e("label",{children:[e("input",{type:"radio",name:"theme",value:"auto",defaultChecked:o!=="light"&&o!=="dark"}),e("span",{children:e(h,{id:"R9Khdg"})})]})]})})})]}),e("li",{children:[e("div",{children:e("label",{children:e(h,{id:"7r6sCa"})})}),e("div",{class:"range-group",children:[e("span",{style:{fontSize:Pt[0]},children:e(h,{id:"J6ypuD"})})," ",e("input",{type:"range",min:Pt[0],max:Pt[Pt.length-1],step:"1",value:d,list:"sizes",onChange:f=>{const y=parseInt(f.target.value,10);document.documentElement.style.setProperty("--text-size",`${y}px`),y===zi?ke.local.del("textSize"):ke.local.set("textSize",f.target.value)}})," ",e("span",{style:{fontSize:Pt[Pt.length-1]},children:e(h,{id:"J6ypuD"})}),e("datalist",{id:"sizes",children:Pt.map(f=>e("option",{value:f}))})]})]}),e("li",{children:[e("span",{children:[e("label",{children:e(h,{id:"CeJHfb"})}),e("br",{}),e("small",{children:e("a",{href:"https://crowdin.com/project/phanpy",target:"_blank",rel:"noopener",children:e(h,{id:"FFmj1D"})})})]}),e(bi,{})]})]})}),g&&e(O,{children:[e("h3",{children:e(h,{id:"PcoS3v"})}),e("section",{children:e("ul",{children:e("li",{children:[e("div",{children:e("label",{for:"posting-privacy-field",children:[e(h,{id:"NAjVvt"})," ",e(T,{icon:"cloud",alt:i({id:"N2FcBE"}),class:"synced-icon"})]})}),e("div",{children:e("select",{id:"posting-privacy-field",value:a["posting:default:visibility"]||"public",onChange:f=>{const{value:y}=f.target;(async()=>{try{await b.v1.accounts.updateCredentials({source:{privacy:y}}),m({...a,"posting:default:visibility":y}),ke.account.set("preferences",{...a,"posting:default:visibility":y})}catch{alert(i({id:"Oa+KBY"}))}})()},children:[e("option",{value:"public",children:e(h,{id:"7d1a0d"})}),e("option",{value:"unlisted",children:e(h,{id:"WDcQq9"})}),e("option",{value:"private",children:e(h,{id:"o34OrG"})})]})})]})})}),e("p",{class:"section-postnote",children:[e(T,{icon:"cloud",alt:i({id:"N2FcBE"}),class:"synced-icon"})," ",e("small",{children:e(h,{id:"xlsg7n",values:{instance:p},components:{0:e("a",{href:`https://${p}/`,target:"_blank",rel:"noopener"})}})})]})]}),e("h3",{children:e(h,{id:"ivdhsq"})}),e("section",{children:e("ul",{children:[e("li",{class:"block",children:e("label",{children:[e("input",{type:"checkbox",checked:s.settings.autoRefresh,onChange:f=>{x.settings.autoRefresh=f.target.checked}})," ",e(h,{id:"0mC0SF"})]})}),e("li",{class:"block",children:e("label",{children:[e("input",{type:"checkbox",checked:s.settings.boostsCarousel,onChange:f=>{x.settings.boostsCarousel=f.target.checked}})," ",e(h,{id:"TSbnoW"})]})}),e("li",{class:"block",children:[e("label",{children:[e("input",{type:"checkbox",checked:s.settings.contentTranslation,onChange:f=>{const{checked:y}=f.target;x.settings.contentTranslation=y,y||(x.settings.contentTranslationTargetLanguage=null)}})," ",e(h,{id:"0SdaOt"})]}),e("div",{class:`sub-section ${s.settings.contentTranslation?"":"more-insignificant"}`,children:[e("div",{children:e("label",{children:[e(h,{id:"zXCa9e"})," ",e("select",{value:l||"",disabled:!s.settings.contentTranslation,style:{width:"10em"},onChange:f=>{x.settings.contentTranslationTargetLanguage=f.target.value||null},children:[e("option",{value:"",children:e(h,{id:"jNCSyx",values:{systemTargetLanguageText:r}})}),e("option",{disabled:!0,children:"──────────"}),Ei.map(f=>{const y=xt({code:f.code,fallback:f.name}),v=xt({code:f.code,locale:f.code}),w=y!==v;return e("option",{value:f.code,children:w?`${v} - ${y}`:y})})]})]})}),e("hr",{}),e("div",{class:"checkbox-fieldset",children:[e(h,{id:"cc0NrU",values:{0:s.settings.contentTranslationHideLanguages.length}}),e("div",{class:"checkbox-fields",children:Ei.map(f=>{const y=xt({code:f.code,fallback:f.name}),v=xt({code:f.code,locale:f.code}),w=y!==v;return e("label",{children:[e("input",{type:"checkbox",checked:s.settings.contentTranslationHideLanguages.includes(f.code),onChange:_=>{const{checked:S}=_.target;S?x.settings.contentTranslationHideLanguages.push(f.code):x.settings.contentTranslationHideLanguages=s.settings.contentTranslationHideLanguages.filter(k=>k!==f.code)}})," ",w?e("span",{children:[v," ",e("span",{class:"insignificant",children:["- ",y]})]}):y]})})})]}),e("p",{class:"insignificant",children:e("small",{children:e(h,{id:"xpF+wU",components:{0:e("a",{href:"https://github.com/cheeaun/lingva-api",target:"_blank",rel:"noopener"}),1:e("a",{href:"https://github.com/thedaviddelta/lingva-translate",target:"_blank",rel:"noopener"})}})})}),e("hr",{}),e("div",{children:[e("label",{children:[e("input",{type:"checkbox",checked:s.settings.contentTranslationAutoInline,disabled:!s.settings.contentTranslation,onChange:f=>{x.settings.contentTranslationAutoInline=f.target.checked}})," ",e(h,{id:"gURvmk"})]}),e("p",{class:"insignificant",children:e("small",{children:e(h,{id:"PbHARL",components:{0:e("b",{})}})})})]})]})]}),!!xc&&g&&e("li",{class:"block",children:[e("label",{children:[e("input",{type:"checkbox",checked:s.settings.composerGIFPicker,onChange:f=>{x.settings.composerGIFPicker=f.target.checked}})," ",e(h,{id:"D7/2jB"})]}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(h,{id:"/CLBTL",components:{0:e("a",{href:"https://developers.giphy.com/",target:"_blank",rel:"noopener"})}})})})]}),!!Ac&&g&&e("li",{class:"block",children:[e("label",{children:[e("input",{type:"checkbox",checked:s.settings.mediaAltGenerator,onChange:f=>{x.settings.mediaAltGenerator=f.target.checked}})," ",e(h,{id:"9q5uor"})," ",e(T,{icon:"sparkles2",class:"more-insignificant"})]}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(h,{id:"faZ9RI"})})}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(h,{id:"fHZgvt",components:{0:e("a",{href:"https://github.com/cheeaun/img-alt-api",target:"_blank",rel:"noopener"})}})})})]}),g&&et("@mastodon/grouped-notifications")&&e("li",{class:"block",children:[e("label",{children:[e("input",{type:"checkbox",checked:s.settings.groupedNotificationsAlpha,onChange:f=>{x.settings.groupedNotificationsAlpha=f.target.checked}})," ",e(h,{id:"aGziA/"})]}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(h,{id:"X17jCM"})})})]}),g&&e("li",{class:"block",children:[e("label",{children:[e("input",{type:"checkbox",checked:s.settings.shortcutSettingsCloudImportExport,onChange:f=>{x.settings.shortcutSettingsCloudImportExport=f.target.checked}})," ",e(h,{id:"570qTm"})," ",e(T,{icon:"cloud",class:"more-insignificant"})]}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(h,{id:"0tZAhT",components:{0:e("br",{})}})})}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(h,{id:"fHf1v/"})})})]}),e("li",{class:"block",children:[e("label",{children:[e("input",{type:"checkbox",checked:s.settings.cloakMode,onChange:f=>{x.settings.cloakMode=f.target.checked}})," ",e(h,{id:"lxYe+I",components:{0:e("span",{class:"insignificant"}),1:e("samp",{}),2:e("samp",{})}})]}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(h,{id:"T/hglb"})})})]}),g&&e("li",{children:e("button",{type:"button",class:"light",onClick:()=>{x.showDrafts=!0,x.showSettings=!1},children:e(h,{id:"krk5ws"})})})]})}),g&&e(Rc,{onClose:n}),e("h3",{children:e(h,{id:"uyJsf6"})}),e("section",{children:[e("div",{style:{display:"flex",flexWrap:"wrap",gap:8,lineHeight:1.25,alignItems:"center",marginTop:8},children:[e("img",{src:gi,alt:"",width:"64",height:"64",style:{aspectRatio:"1/1",verticalAlign:"middle",background:"#b7cdf9",borderRadius:12}}),e("div",{children:[e("b",{children:"Phanpy"})," ",e("a",{href:"https://hachyderm.io/@phanpy",rel:"noopener",onClick:f=>{f.preventDefault(),x.showAccount="phanpy@hachyderm.io"},children:"@phanpy"}),e("br",{}),e(h,{id:"AZ2EoP",components:{0:e("a",{href:"https://github.com/cheeaun/phanpy",target:"_blank",rel:"noopener"}),1:e("a",{href:"https://mastodon.social/@cheeaun",rel:"noopener",onClick:f=>{f.preventDefault(),x.showAccount="cheeaun@mastodon.social"}})}})]})]}),e("p",{children:[e("a",{href:"https://github.com/sponsors/cheeaun",target:"_blank",rel:"noopener",children:e(h,{id:"O4cLCR"})})," ","·"," ",e("a",{href:"https://www.buymeacoffee.com/cheeaun",target:"_blank",rel:"noopener",children:e(h,{id:"Ng063n"})})," ","·"," ",e("a",{href:"https://patreon.com/cheeaun",target:"_blank",rel:"noopener",children:"Patreon"})," ","·"," ",e("a",{href:Tc,target:"_blank",rel:"noopener",children:e(h,{id:"LcET2C"})})]}),e("p",{children:[Ui&&e(O,{children:[e(h,{id:"pFnMHn",values:{0:Ui.replace(/https?:\/\//g,"").replace(/\/$/,"")},components:{0:e("span",{class:"insignificant"})}}),e("br",{})]}),e(h,{id:"6KkH+2",values:{0:e("span",{class:"ib insignificant",children:["(",e("a",{href:"https://github.com/cheeaun/phanpy/commit/512af62",target:"_blank",rel:"noopener",children:e(It,{datetime:new Date("2025-03-10T21:23:02.486Z")})}),")"]})},components:{0:e("span",{class:"insignificant"}),1:e("input",{type:"text",class:"version-string",readOnly:!0,size:"18",value:`${"2025-03-10T21:23:02.486Z".slice(0,10).replace(/-/g,".")}.512af62`,onClick:f=>{f.target.select();try{navigator.clipboard.writeText(f.target.value),me(i({id:"PiPfua"}))}catch{me(i({id:"gdxreD"}))}}})}})]})]}),void 0]})]})}function Rc({onClose:n}){const{_:i}=de();if(!$n())return null;const{instance:s}=le(),[o,c]=L("default"),l=q(),[u,r]=L(!1),[d,a]=L(!1),m=q();ne(()=>{(async()=>{c("loading");try{const{subscription:g,backendSubscription:p}=await Cc();if(p!=null&&p.policy&&p.policy!=="none"){r(!0);const{alerts:f,policy:y}=p;m.current=y;const{elements:v}=l.current,w=v.namedItem("policy");w&&(w.value=y),Object.entries(f).forEach(([_,S])=>{const k=v.namedItem(_);(k==null?void 0:k.type)==="checkbox"&&(k.checked=!!S)})}c("default")}catch(g){/outside.*authorized/i.test(g.message)?a(!0):alert((g==null?void 0:g.message)||g),c("error")}})()},[]);const b=o==="loading";return e("form",{ref:l,onChange:()=>{setTimeout(()=>{const g=Object.fromEntries(new FormData(l.current)),p=!!g["policy-allow"],f={data:{policy:g.policy,alerts:{mention:!!g.mention,favourite:!!g.favourite,reblog:!!g.reblog,follow:!!g.follow,follow_request:!!g.followRequest,poll:!!g.poll,update:!!g.update,status:!!g.status}}};let y=0;Object.keys(f.data.alerts).forEach(w=>{f.data.alerts[w]?y++:delete f.data.alerts[w]});const v=m.current!==f.data.policy;p&&y>0?v?Oi().then(()=>{Di(f)}).catch(w=>{alert(i({id:"I6pdY3"}))}):Di(f).catch(w=>{alert(i({id:"I6pdY3"}))}):Oi().catch(w=>{alert(i({id:"q1zFd+"}))})},100)},children:[e("h3",{children:e(h,{id:"WUHLnz"})}),e("section",{children:e("ul",{children:e("li",{children:[e("label",{children:[e("input",{type:"checkbox",disabled:b||d,name:"policy-allow",checked:u,onChange:async g=>{const{checked:p}=g.target;if(p){const f=await Notification.requestPermission();f==="granted"?r(!0):(r(!1),f==="denied"&&alert(i({id:"6LUsk7"})))}else r(!1)}})," ",e(h,{id:"qYNCa1",values:{0:[{value:"all",label:i({id:"+niKJH"})},{value:"followed",label:i({id:"x2NYtp"})},{value:"follower",label:i({id:"PBFNgg"})}].map(g=>e("option",{value:g.value,children:g.label}))},components:{0:e("select",{name:"policy",disabled:b||d||!u})}})]}),e("div",{class:"shazam-container no-animation",style:{width:"100%"},hidden:!u,children:e("div",{class:"shazam-container-inner",children:e("div",{class:"sub-section",children:e("ul",{children:[{value:"mention",label:i({id:"/bZzdR"})},{value:"favourite",label:i({id:"zZOZj7"})},{value:"reblog",label:i({id:"puY2t0"})},{value:"follow",label:i({id:"aaJhcT"})},{value:"followRequest",label:i({id:"6Fs1Ba"})},{value:"poll",label:i({id:"wNExRS"})},{value:"update",label:i({id:"K/EtE6"})},{value:"status",label:i({id:"2yr1/p"})}].map(g=>e("li",{children:e("label",{children:[e("input",{type:"checkbox",name:g.value})," ",g.label]})}))})})})}),d&&e("div",{class:"sub-section",children:e("p",{children:e(h,{id:"8d0b8B",components:{0:e(be,{to:`/login?instance=${s}`,onClick:n}),1:e("b",{})}})})})]})})}),e("p",{class:"section-postnote",children:e("small",{children:e(h,{id:"z96cOX",components:{0:e("b",{})}})})})]})}const Xn=()=>{let n=setTimeout(()=>{var s,o;const i=document.getElementById("columns");if(i){const c=i.querySelector(".deck-container.focus");if(c)c.focus();else{const l=Array.from(i.querySelectorAll(".deck-container")).find(u=>u.getBoundingClientRect().left>=0);l?l.focus():(o=(s=i.querySelector(".deck-container"))==null?void 0:s.focus)==null||o.call(s)}}else{const c=document.querySelectorAll("#modal-container > *");if(c!=null&&c.length){const d=c[c.length-1],a=d.querySelector('[tabindex="-1"]')||d;if(a){a.focus();return}}if(document.querySelector(".deck-backdrop"))return;const u=document.querySelectorAll(".deck-container"),r=u[u.length-1];r&&r.tabIndex===-1&&r.focus()}},100);return()=>clearTimeout(n)};function Ds(n){if(!n)return;const i=Zt(),s=q(i.pathname);ne(()=>{s.current&&i.pathname!==s.current&&(n==null||n())},[i.pathname,n])}const Os=1e3*60,Lc=24*60*60*1e3,Jn=gt(async()=>{const{masto:n}=le(),i=await n.v1.lists.list();return i.sort((s,o)=>s.title.localeCompare(o.title)),i.length&&setTimeout(()=>{ke.account.set("lists",{lists:i,updatedAt:Date.now()})},1),i},{maxAge:Os});async function rn(){try{const{lists:n,updatedAt:i}=ke.account.get("lists")||{};return n!=null&&n.length?(Date.now()-i>Lc&&Jn(),n):await Jn()}catch{return[]}}const Mc=gt(n=>{const{masto:i}=le();return i.v1.lists.$select(n).fetch()},{maxAge:Os});async function zs(n){const{lists:i}=ke.account.get("lists")||{};if(i!=null&&i.length){const s=i.find(o=>o.id===n);if(s)return s}try{return Mc(n)}catch{return null}}async function $c(n){const i=await zs(n);return(i==null?void 0:i.title)||""}function Pc(n){const{lists:i}=ke.account.get("lists")||{};i!=null&&i.length&&(i.push(n),i.sort((s,o)=>s.title.localeCompare(o.title)),ke.account.set("lists",{lists:i,updatedAt:Date.now()}))}function Nc(n){const{lists:i}=ke.account.get("lists")||{};if(i!=null&&i.length){const s=i.findIndex(o=>o.id===n.id);s!==-1&&(i[s]=n,i.sort((o,c)=>o.title.localeCompare(c.title)),ke.account.set("lists",{lists:i,updatedAt:Date.now()}))}}function Dc(n){const{lists:i}=ke.account.get("lists")||{};if(i!=null&&i.length){const s=i.findIndex(o=>o.id===n);s!==-1&&(i.splice(s,1),ke.account.set("lists",{lists:i,updatedAt:Date.now()}))}}function vi({list:n,onClose:i}){const{_:s}=de(),{masto:o}=le(),[c,l]=L("default"),u=!!n,r=q(),d=q(),a=q();ne(()=>{u&&(r.current.value=n.title,d.current.value=n.repliesPolicy,a.current&&(a.current.checked=n.exclusive))},[u]);const m=et("@mastodon/list-exclusive")||et("@gotosocial/list-exclusive");return e("div",{class:"sheet",children:[!!i&&e("button",{type:"button",class:"sheet-close",onClick:i,children:e(T,{icon:"x",alt:s({id:"yz7wBu"})})})," ",e("header",{children:e("h2",{children:s(u?{id:"tuhghE"}:{id:"Sb2gYF"})})}),e("main",{children:e("form",{class:"list-form",onSubmit:b=>{b.preventDefault();const g=new FormData(b.target),p=g.get("title"),f=g.get("replies_policy"),y=g.get("exclusive")==="on";l("loading"),(async()=>{try{let v;u?v=await o.v1.lists.$select(n.id).update({title:p,replies_policy:f,exclusive:y}):v=await o.v1.lists.create({title:p,replies_policy:f,exclusive:y}),l("default"),i==null||i({state:"success",list:v}),setTimeout(()=>{u?Nc(v):Pc(v)},1)}catch{l("error"),alert(s(u?{id:"R7ep1i"}:{id:"KPoj8w"}))}})()},children:[e("div",{class:"list-form-row",children:e("label",{for:"list-title",children:[e(h,{id:"6YtxFj"})," ",e("input",{ref:r,type:"text",id:"list-title",name:"title",required:!0,disabled:c==="loading",dir:"auto"})]})}),e("div",{class:"list-form-row",children:e("select",{ref:d,name:"replies_policy",required:!0,disabled:c==="loading",children:[e("option",{value:"list",children:e(h,{id:"ei6pnR"})}),e("option",{value:"followed",children:e(h,{id:"Mr53YX"})}),e("option",{value:"none",children:e(h,{id:"PM7llw"})})]})}),m&&e("div",{class:"list-form-row",children:e("label",{class:"label-block",children:[e("input",{ref:a,type:"checkbox",name:"exclusive",disabled:c==="loading"})," ",e(h,{id:"jxxYp0"})]})}),e("div",{class:"list-form-footer",children:[e("button",{type:"submit",disabled:c==="loading",children:s(u?{id:"tfDRzk"}:{id:"hYgDIe"})}),u&&e(ut,{disabled:c==="loading",align:"end",menuItemClassName:"danger",confirmLabel:s({id:"+kQ/cY"}),onClick:()=>{l("loading"),(async()=>{try{await o.v1.lists.$select(n.id).remove(),l("default"),i==null||i({state:"deleted"}),setTimeout(()=>{Dc(n.id)},1)}catch{l("error"),alert(s({id:"tqUaGL"}))}})()},children:e("button",{type:"button",class:"light danger",disabled:c==="loading",children:e(h,{id:"Jb6/SB"})})})]})]})})]})}const Oc=[60*5,60*30,60*60,60*60*6,60*60*24,60*60*24*3,60*60*24*7,60*60*24*30,0],Ht={0:{id:"9ZP9cc"},300:it(5,"minute"),1800:it(30,"minute"),3600:it(1,"hour"),21600:it(6,"hour"),86400:it(1,"day"),259200:it(3,"day"),604800:it(1,"week"),2592e3:it(30,"day")},Fi=80,Us=1e3*60*10;function zc(n,i){return i.v1.accounts.familiarFollowers.fetch({id:[n]})}const Uc=gt(zc,{maxAge:Us});async function Fc(n,i){const s=i.v1.accounts.$select(n).statuses.list({limit:20}).next(),{value:o}=await s,c={total:o.length,originals:0,replies:0,boosts:0};return o.forEach(l=>{l.reblog?c.boosts++:l.inReplyToId&&l.inReplyToAccountId!==l.account.id?c.replies++:c.originals++}),o.length&&(c.daysSinceLastPost=Math.ceil((Date.now()-new Date(o[o.length-1].createdAt))/864e5)),c}const Bc=gt(Fc,{maxAge:Us});function Fs({account:n,fetchAccount:i=()=>{},standalone:s,instance:o,authenticated:c}){const{i18n:l,_:u}=de(),{masto:r}=le({instance:o}),{masto:d,instance:a}=le(),[m,b]=L("default"),g=typeof n=="string",[p,f]=L(g?null:n),y=Ce(()=>o===a,[o,a]);ne(()=>{if(!g){f(n);return}b("loading"),(async()=>{try{const H=await i();x.accounts[`${H.id}@${o}`]=H,f(H),b("default")}catch{f(null),b("error")}})()},[g,n,i]);const{acct:v,avatar:w,avatarStatic:_,bot:S,createdAt:k,displayName:A,emojis:C,fields:I,followersCount:E,followingCount:M,group:z,id:P,lastStatusAt:W,locked:ee,note:Z,statusesCount:V,url:U,username:B,memorial:se,moved:$,roles:F,hideCollections:Y}=p||{};let G=!1,{header:te,headerStatic:ae}=p||{};(!te||/missing\.png$/.test(te))&&w&&!/missing\.png$/.test(w)&&(te=w,G=!0,_&&!/missing\.png$/.test(_)&&(ae=_));const ve=Ce(()=>P===vt(),[P]);ne(()=>{const H=!!(p!=null&&p.id&&(p!=null&&p.username)&&(p!=null&&p.acct)&&(p!=null&&p.avatar)&&(p!=null&&p.avatarStatic)&&(p!=null&&p.displayName)&&(p!=null&&p.url));if(ve&&o&&H){const ye=ke.local.getJSON("accounts");let Ee=!1;ye.forEach(R=>{R.info.id===p.id&&R.instanceURL===o&&(R.info=p,Ee=!0)}),Ee&&ke.local.setJSON("accounts",ye)}},[ve,p,o]);const _e=Ce(()=>U?zt.toUnicode(URL.parse(U).hostname):null,[U]),[j,he]=L([]),Ae=q(),Pe=q([]);async function Ne(H){var K;(H||!Ae.current)&&(Ae.current=r.v1.accounts.$select(P).followers.list({limit:Fi}));const ye=await Ae.current.next();if(ve||!y)return ye;const{value:Ee}=ye;let R=[];if(H){let ce=[];try{ce=await r.v1.accounts.familiarFollowers.fetch({id:[P]})}catch{}Pe.current=((K=ce==null?void 0:ce[0])==null?void 0:K.accounts)||[],R=[...Pe.current,...Ee.filter(J=>!Pe.current.some(oe=>oe.id===J.id))]}else Ee!=null&&Ee.length&&(R=Ee.filter(ce=>!Pe.current.some(J=>J.id===ce.id)));return{...ye,value:R}}const Ue=q();async function Re(H){return(H||!Ue.current)&&(Ue.current=r.v1.accounts.$select(P).following.list({limit:Fi})),await Ue.current.next()}const Le=s?"div":be,X=o?`/${o}/a/${P}`:`/a/${P}`,[Ie,De]=L([]),[fe,Q]=L(),[ge,D]=L("default"),ie=!!(fe!=null&&fe.total),ue=async H=>{try{const ye=await Uc(H,d);De(ye[0].accounts.slice(0,Hc))}catch{}},N=async()=>{if(P){D("loading");try{const H=await Bc(P,r);Q(H),D("default")}catch{D("error")}}},re=st(({relationship:H,currentID:ye})=>{H.following||(ue(ye),!s&&V>0&&N())},[s,P,V]),Te=st(H=>{H.id===P&&(f(H),x.accounts[`${H.id}@${o}`]=H)},[P,o]);return e("div",{tabIndex:"-1",class:`account-container ${m==="loading"?"skeleton":""}`,style:{"--header-color-1":j[0],"--header-color-2":j[1],"--header-color-3":j[2],"--header-color-4":j[3]},children:[m==="error"&&e("div",{class:"ui-state",children:[e("p",{children:e(h,{id:"44hICK"})}),g?e("p",{children:e("code",{class:"insignificant",children:n})}):e("p",{children:e("a",{href:U,target:"_blank",rel:"noopener",children:[e(h,{id:"Aadw0+"})," ",e(T,{icon:"external"})]})})]}),m==="loading"?e(O,{children:[e("header",{children:e(ht,{avatarSize:"xxxl",skeleton:!0})}),e("main",{children:[e("div",{class:"note",children:[e("p",{children:"███████ ████ ████"}),e("p",{children:"████ ████████ ██████ █████████ ████ ██"})]}),e("div",{class:"account-metadata-box",children:[e("div",{class:"profile-metadata",children:[e("div",{class:"profile-field",children:[e("b",{class:"more-insignificant",children:"███"}),e("p",{children:"██████"})]}),e("div",{class:"profile-field",children:[e("b",{class:"more-insignificant",children:"████"}),e("p",{children:"███████████"})]})]}),e("div",{class:"stats",children:[e("div",{children:[e("span",{children:"██"})," ",e(h,{id:"x5LEuB"})]}),e("div",{children:[e("span",{children:"██"})," ",e(h,{id:"following.stats"})]}),e("div",{children:[e("span",{children:"██"})," ",e(h,{id:"+owNNn"})]})]})]}),e("div",{class:"actions",children:[e("span",{}),e("span",{class:"buttons",children:e("button",{type:"button",class:"plain",disabled:!0,children:e(T,{icon:"more",size:"l",alt:u({id:"2FYpfJ"})})})})]})]})]}):p&&e(O,{children:[!!$&&e("div",{class:"account-moved",children:[e("p",{children:e(h,{id:"C6cVP/",values:{displayName:A},components:{0:e("b",{})}})}),e(ht,{account:$,instance:o,onClick:H=>{H.stopPropagation(),x.showAccount=$}})]}),!!te&&!/missing\.png$/.test(te)&&e("img",{src:te,alt:"",class:`header-banner ${G?"header-is-avatar":""}`,onError:H=>{H.target.crossOrigin?H.target.src!==ae?H.target.src=ae:(H.target.removeAttribute("crossorigin"),H.target.src=te):H.target.src!==ae?H.target.src=ae:H.target.remove()},crossOrigin:"anonymous",onLoad:H=>{H.target.classList.add("loaded");try{const ye=window.OffscreenCanvas?new OffscreenCanvas(1,1):document.createElement("canvas"),Ee=ye.getContext("2d",{willReadFrequently:!0});ye.width=H.target.width,ye.height=H.target.height,Ee.imageSmoothingEnabled=!1,Ee.drawImage(H.target,0,0);const R=10,ce=[Ee.getImageData(0,0,R,R).data,Ee.getImageData(H.target.width-R,0,R,R).data,Ee.getImageData(0,H.target.height-R,R,R).data,Ee.getImageData(H.target.width-R,H.target.height-R,R,R).data].map(J=>{let oe=0,Oe=0,Me=0,$e=0;for(let Ge=0;Ge<J.length;Ge+=4)oe+=J[Ge],Oe+=J[Ge+1],Me+=J[Ge+2],$e+=J[Ge+3];const Be=J.length/4;return[oe/Be,Oe/Be,Me/Be,$e/Be]}).map(J=>{const[oe,Oe,Me,$e]=Yc(J);return`rgba(${oe}, ${Oe}, ${Me}, ${$e})`});he(ce)}catch{}}}),e("header",{children:s?e(lt,{shift:window.matchMedia("(min-width: calc(40em))").matches?114:64,menuButton:e("div",{children:e(ht,{account:p,instance:o,avatarSize:"xxxl",onClick:()=>{}})}),children:[e("div",{class:"szh-menu__header",children:e(Jc,{acct:v,instance:o})}),e(Se,{onClick:()=>{const H=v.includes("@")?`@${v}`:`@${v}@${o}`;try{navigator.clipboard.writeText(H),me(u({id:"zJoEwS"}))}catch{me(u({id:"BC0lSD"}))}},children:[e(T,{icon:"link"}),e("span",{children:e(h,{id:"27x6gl"})})]}),e(Se,{href:U,target:"_blank",children:[e(T,{icon:"external"}),e("span",{children:e(h,{id:"Bz5hLl"})})]}),e(We,{}),e(Se,{onClick:()=>{x.showMediaModal={mediaAttachments:[{type:"image",url:_}]}},children:[e(T,{icon:"user"}),e("span",{children:e(h,{id:"7WYl2I"})})]}),e(Se,{onClick:()=>{x.showMediaModal={mediaAttachments:[{type:"image",url:ae}]}},children:[e(T,{icon:"media"}),e("span",{children:e(h,{id:"ZNme5R"})})]})]}):e(ht,{account:p,instance:o,avatarSize:"xxxl",internal:!0})}),e("div",{class:"faux-header-bg","aria-hidden":"true"}),e("main",{children:[!!se&&e("span",{class:"tag",children:e(h,{id:"prdIOK"})}),!!S&&e("span",{class:"tag",children:[e(T,{icon:"bot"})," ",e(h,{id:"9Vdq+j"})]}),!!z&&e("span",{class:"tag",children:[e(T,{icon:"group"})," ",e(h,{id:"L8fEEm"})]}),F==null?void 0:F.map(H=>e("span",{class:"tag",children:[H.name,!!_e&&e(O,{children:[" ",e("span",{class:"more-insignificant",children:_e})]})]})),e("div",{class:"note",dir:"auto",onClick:ks({instance:a}),dangerouslySetInnerHTML:{__html:Kn(Z,{emojis:C})}}),e("div",{class:"account-metadata-box",children:[(I==null?void 0:I.length)>0&&e("div",{class:"profile-metadata",children:I.map(({name:H,value:ye,verifiedAt:Ee},R)=>e("div",{class:`profile-field ${Ee?"profile-verified":""}`,dir:"auto",children:[e("b",{children:[e(Ss,{text:H,emojis:C})," ",!!Ee&&e(T,{icon:"check-circle",size:"s",alt:u({id:"QDEWii"})})]}),e("p",{dangerouslySetInnerHTML:{__html:Kn(ye,{emojis:C})}})]},H+R))}),e("div",{class:"stats",children:[e(Le,{tabIndex:0,to:X,onClick:()=>{setTimeout(()=>{x.showGenericAccounts={id:"followers",heading:u({id:"x5LEuB"}),fetchAccounts:Ne,instance:o,excludeRelationshipAttrs:ve?["followedBy"]:[],blankCopy:Y?u({id:"BRV/wh"}):void 0}},0)},children:[!!Ie.length&&e("span",{class:"shazam-container-horizontal",children:e("span",{class:"shazam-container-inner stats-avatars-bunch",children:Ie.map(H=>e(ft,{url:H.avatarStatic,size:"s",alt:`${H.displayName} @${H.acct}`,squircle:H==null?void 0:H.bot}))})}),e("span",{title:E,children:Xe(E)})," ",e(h,{id:"x5LEuB"})]}),e(Le,{class:"insignificant",tabIndex:0,to:X,onClick:()=>{setTimeout(()=>{x.showGenericAccounts={heading:u({id:"following.stats"}),fetchAccounts:Re,instance:o,excludeRelationshipAttrs:ve?["following"]:[],blankCopy:Y?u({id:"BRV/wh"}):void 0}},0)},children:[e("span",{title:M,children:Xe(M)})," ",e(h,{id:"following.stats"}),e("br",{})]}),e(Le,{class:"insignificant",to:X,children:[e("span",{title:V,children:Xe(V)})," ",e(h,{id:"+owNNn"})]}),!!k&&e("div",{class:"insignificant",children:e(h,{id:"PCcEFZ",values:{0:ot(k,{hideTime:!0})},components:{0:e("time",{datetime:k})}})})]})]}),!!fe&&e(Le,{to:X,class:"account-metadata-box",children:e("div",{class:"shazam-container",children:e("div",{class:"shazam-container-inner",children:ie?e("div",{class:"posting-stats",title:u({id:"wiuWLe",values:{0:(fe.originals/fe.total).toLocaleString(l.locale||void 0,{style:"percent"}),1:(fe.replies/fe.total).toLocaleString(l.locale||void 0,{style:"percent"}),2:(fe.boosts/fe.total).toLocaleString(l.locale||void 0,{style:"percent"})}}),children:[e("div",{children:fe.daysSinceLastPost<365?pe._({id:"oZUtTk",values:{0:fe.total,1:fe.daysSinceLastPost,2:fe.daysSinceLastPost,3:fe.daysSinceLastPost,4:fe.total,5:fe.total,6:fe.daysSinceLastPost}}):pe._({id:"JvA7Mo",values:{0:fe.total,1:fe.total}})}),e("div",{class:"posting-stats-bar",style:{"--originals-percentage":`${fe.originals/fe.total*100}%`,"--replies-percentage":`${(fe.originals+fe.replies)/fe.total*100}%`}}),e("div",{class:"posting-stats-legends",children:[e("span",{class:"ib",children:[e("span",{class:"posting-stats-legend-item posting-stats-legend-item-originals"})," ",e(h,{id:"HxF6Fk"})]})," ",e("span",{class:"ib",children:[e("span",{class:"posting-stats-legend-item posting-stats-legend-item-replies"})," ",e(h,{id:"N8UzTV"})]})," ",e("span",{class:"ib",children:[e("span",{class:"posting-stats-legend-item posting-stats-legend-item-boosts"})," ",e(h,{id:"puY2t0"})]})]})]}):e("div",{class:"posting-stats",children:e(h,{id:"vl3XTJ"})})})})}),!$&&e("div",{class:"account-metadata-box",children:e("div",{class:"shazam-container no-animation",hidden:!!fe,children:e("div",{class:"shazam-container-inner",children:e("button",{type:"button",class:"posting-stats-button",disabled:ge==="loading",onClick:()=>{N()},children:[e("div",{class:`posting-stats-bar posting-stats-icon ${ge==="loading"?"loading":""}`,style:{"--originals-percentage":"33%","--replies-percentage":"66%"}}),e(h,{id:"PjP87f"})," "]})})})})]}),e("footer",{children:e(qc,{info:p,instance:o,standalone:s,authenticated:c,onRelationshipChange:re,onProfileUpdate:Te})})]})]})}const Hc=3;function qc({info:n,instance:i,standalone:s,authenticated:o,onRelationshipChange:c=()=>{},onProfileUpdate:l=()=>{}}){var fe;if(!n)return null;const{_:u,_:r}=de(),{masto:d,instance:a,authenticated:m}=le(),b=i===a,[g,p]=L("default"),[f,y]=L(null),{id:v,acct:w,url:_,username:S,locked:k,lastStatusAt:A,note:C,fields:I,moved:E}=n,M=q(v),{following:z,showingReblogs:P,notifying:W,followedBy:ee,blocking:Z,blockedBy:V,muting:U,mutingNotifications:B,requested:se,domainBlocking:$,endorsed:F,note:Y}=f||{},[G,te]=L(null),[ae,ve]=L(!1),_e=w.includes("@")?w:`${w}@${i}`;ne(()=>{if(n){const Q=vt();let ge;(async()=>{if(b&&o)ge=v;else if(!b&&m){const ie=n.acct.includes("@");try{const ue=await d.v2.search.fetch({q:ie?n.acct:`${n.username}@${i}`,type:"accounts",limit:1,resolve:!0});ue.accounts.length&&(ge=ue.accounts[0].id,te(ue.accounts[0]))}catch{}}if(!ge)return;if(Q===ge){ve(!0);return}M.current=ge,p("loading");const D=d.v1.accounts.relationships.fetch({id:[ge]});try{const ie=await D;if(p("default"),ie.length){const ue=ie[0];y(ue),c({relationship:ue,currentID:ge})}}catch{p("error")}})()}},[n,o]),ne(()=>{n&&ae&&yo(n)},[n,ae]);const j=g==="loading",[he,Ae]=L(!1),[Pe,Ne]=L(!1),[Ue,Re]=L(!1),[Le,X]=L(!1),[Ie,De]=L([]);return e(O,{children:[e("div",{class:"actions",children:[e("span",{children:[ee?e("span",{class:"tag",children:e(h,{id:"p3UO/y"})}):A?e("small",{class:"insignificant",children:e(h,{id:"F3cM1G",values:{0:ot(A,{hideTime:!0})},components:{0:e("span",{class:"ib"})}})}):e("span",{}),U&&e("span",{class:"tag danger",children:e(h,{id:"+IJm1Z"})}),Z&&e("span",{class:"tag danger",children:e(h,{id:"32TndD"})})]})," ",e("span",{class:"buttons",children:[!!Y&&e("button",{type:"button",class:"private-note-tag",title:r({id:"zxFxcH"}),onClick:()=>{Re(!0)},dir:"auto",children:e("span",{children:Y})}),e(lt,{portal:{target:document.body},containerProps:{style:{zIndex:1001}},align:"center",position:"anchor",overflow:"auto",menuButton:e("button",{type:"button",class:"plain",disabled:j,children:e(T,{icon:"more",size:"l",alt:r({id:"2FYpfJ"})})}),onMenuChange:Q=>{z&&Q.open&&(async()=>{try{const ge=await d.v1.accounts.$select(M.current).lists.list();De(ge)}catch{}})()},children:[m&&!ae&&e(O,{children:[e(Se,{onClick:()=>{ys({draftStatus:{status:`@${(G==null?void 0:G.acct)||w} `}})},children:[e(T,{icon:"at"}),e("span",{children:e(h,{id:"3LkfZu",values:{username:S},components:{0:e("span",{class:"bidi-isolate"})}})})]}),e(Se,{onClick:()=>{Ae(!0)},children:[e(T,{icon:"translate"}),e("span",{children:e(h,{id:"R8mSiS"})})]}),et("@mastodon/profile-private-note")&&e(Se,{onClick:()=>{Re(!0)},children:[e(T,{icon:"pencil"}),e("span",{children:r(Y?{id:"U+Gokq"}:{id:"VcQzRi"})})]}),z&&!!f&&e(O,{children:[e(Se,{onClick:()=>{p("loading"),(async()=>{try{const Q=await d.v1.accounts.$select(M.current).follow({notify:!W});Q&&y(Q),p("default"),me(Q.notifying?r({id:"jL3N0G",values:{username:S}}):r({id:"0h4/9h",values:{username:S}}))}catch(Q){alert(Q),p("error")}})()},children:[e(T,{icon:"notification"}),e("span",{children:r(W?{id:"osJmEN"}:{id:"I92Z+b"})})]}),e(Se,{onClick:()=>{p("loading"),(async()=>{try{const Q=await d.v1.accounts.$select(M.current).follow({reblogs:!P});Q&&y(Q),p("default"),me(Q.showingReblogs?r({id:"0X2KC8",values:{username:S}}):r({id:"cXWjH0",values:{username:S}}))}catch(Q){alert(Q),p("error")}})()},children:[e(T,{icon:"rocket"}),e("span",{children:r(P?{id:"GRUr8d"}:{id:"uREpT3"})})]})]}),z&&e(Se,{onClick:()=>{Ne(!0)},children:[e(T,{icon:"list"}),Ie.length?e(O,{children:[e("small",{class:"menu-grow",children:[e(h,{id:"sJ2yQc"}),e("br",{}),e("span",{class:"more-insignificant",children:Ie.map(Q=>Q.title).join(", ")})]}),e("small",{class:"more-insignificant",children:Ie.length})]}):e("span",{children:e(h,{id:"sJ2yQc"})})]}),e(We,{})]}),e(Se,{onClick:()=>{const Q=`@${(G==null?void 0:G.acct)||_e}`;try{navigator.clipboard.writeText(Q),me(r({id:"zJoEwS"}))}catch{me(r({id:"BC0lSD"}))}},children:[e(T,{icon:"copy"}),e("small",{children:[e(h,{id:"27x6gl"}),e("br",{}),e("span",{class:"more-insignificant bidi-isolate",children:["@",(G==null?void 0:G.acct)||_e]})]})]}),e(Se,{href:_,target:"_blank",children:[e(T,{icon:"external"}),e("small",{class:"menu-double-lines",children:jc(_)})]}),e("div",{class:"menu-horizontal",children:[e(Se,{onClick:()=>{try{navigator.clipboard.writeText(_),me(r({id:"edWbV6"}))}catch{me(r({id:"W1ewR0"}))}},children:[e(T,{icon:"link"}),e("span",{children:e(h,{id:"he3ygx"})})]}),(navigator==null?void 0:navigator.share)&&((fe=navigator==null?void 0:navigator.canShare)==null?void 0:fe.call(navigator,{url:_}))&&e(Se,{onClick:()=>{try{navigator.share({url:_})}catch{alert(r({id:"TtG3Uh"}))}},children:[e(T,{icon:"share"}),e("span",{children:e(h,{id:"LFKLqp"})})]})]}),!!f&&e(O,{children:[e(We,{}),U?e(Se,{onClick:()=>{p("loading"),(async()=>{try{const Q=await d.v1.accounts.$select((G==null?void 0:G.id)||v).unmute();y(Q),p("default"),me(r({id:"B4Xkly",values:{username:S}})),x.reloadGenericAccounts.id="mute",x.reloadGenericAccounts.counter++}catch{p("error")}})()},children:[e(T,{icon:"unmute"}),e("span",{children:e(h,{id:"Q/HUhC",values:{username:S},components:{0:e("span",{class:"bidi-isolate"})}})})]}):e(ln,{menuClassName:"menu-blur",openTrigger:"clickOnly",direction:"bottom",overflow:"auto",shift:16,label:e(O,{children:[e(T,{icon:"mute"}),e("span",{class:"menu-grow",children:e(h,{id:"xhPEH3",values:{username:S},components:{0:e("span",{class:"bidi-isolate"})}})}),e("span",{style:{textOverflow:"clip"},children:[e(T,{icon:"time"}),e(T,{icon:"chevron-right"})]})]}),children:e("div",{class:"menu-wrap",children:Oc.map(Q=>e(Se,{onClick:()=>{p("loading"),(async()=>{try{const ge=await d.v1.accounts.$select((G==null?void 0:G.id)||v).mute({duration:Q});y(ge),p("default"),me(r({id:"/plB9m",values:{0:typeof Ht[Q]=="function"?Ht[Q]():u(Ht[Q]),username:S}})),x.reloadGenericAccounts.id="mute",x.reloadGenericAccounts.counter++}catch{p("error"),me(r({id:"vWGBjT",values:{username:S}}))}})()},children:typeof Ht[Q]=="function"?Ht[Q]():u(Ht[Q])}))})}),ee&&e(ut,{subMenu:!0,menuItemClassName:"danger",confirmLabel:e(O,{children:[e(T,{icon:"user-x"}),e("span",{children:e(h,{id:"unyq2W",values:{username:S},components:{0:e("span",{class:"bidi-isolate"})}})})]}),onClick:()=>{p("loading"),(async()=>{try{const Q=await d.v1.accounts.$select((G==null?void 0:G.id)||v).removeFromFollowers();y(Q),p("default"),me(r({id:"AgkcM/",values:{username:S}})),x.reloadGenericAccounts.id="followers",x.reloadGenericAccounts.counter++}catch{p("error")}})()},children:[e(T,{icon:"user-x"}),e("span",{children:e(h,{id:"VCZ0OT"})})]}),e(ut,{subMenu:!0,confirm:!Z,confirmLabel:e(O,{children:[e(T,{icon:"block"}),e("span",{children:e(h,{id:"aforS9",values:{username:S},components:{0:e("span",{class:"bidi-isolate"})}})})]}),itemProps:{className:"danger"},menuItemClassName:"danger",onClick:()=>{p("loading"),(async()=>{try{if(Z){const Q=await d.v1.accounts.$select((G==null?void 0:G.id)||v).unblock();y(Q),p("default"),me(r({id:"sI9N29",values:{username:S}}))}else{const Q=await d.v1.accounts.$select((G==null?void 0:G.id)||v).block();y(Q),p("default"),me(r({id:"uYcYzu",values:{username:S}}))}x.reloadGenericAccounts.id="block",x.reloadGenericAccounts.counter++}catch{p("error"),Z?me(r({id:"0tG4wG",values:{username:S}})):me(r({id:"pA+qEx",values:{username:S}}))}})()},children:Z?e(O,{children:[e(T,{icon:"unblock"}),e("span",{children:e(h,{id:"/3LJfX",values:{username:S},components:{0:e("span",{class:"bidi-isolate"})}})})]}):e(O,{children:[e(T,{icon:"block"}),e("span",{children:e(h,{id:"JRswkR",values:{username:S},components:{0:e("span",{class:"bidi-isolate"})}})})]})}),e(Se,{className:"danger",onClick:()=>{x.showReportModal={account:G||n}},children:[e(T,{icon:"flag"}),e("span",{children:e(h,{id:"qTJgpR",values:{username:S},components:{0:e("span",{class:"bidi-isolate"})}})})]})]}),m&&ae&&s&&et("@mastodon/profile-edit")&&e(O,{children:[e(We,{}),e(Se,{onClick:()=>{X(!0)},children:[e(T,{icon:"pencil"}),e("span",{children:e(h,{id:"9OpVZg"})})]})]}),!1]}),!f&&g==="loading"&&e(Fe,{abrupt:!0}),!!f&&!E&&e(ut,{confirm:z||se,confirmLabel:e("span",{children:r(se?{id:"e7qQIH"}:{id:"q4ucww",values:{1:n.acct||n.username}})}),menuItemClassName:"danger",align:"end",disabled:j,onClick:()=>{p("loading"),(async()=>{try{let Q;z||se?Q=await d.v1.accounts.$select(M.current).unfollow():Q=await d.v1.accounts.$select(M.current).follow(),Q&&y(Q),p("default")}catch(Q){alert(Q),p("error")}})()},children:e("button",{type:"button",class:`${z||se?"light swap":""}`,"data-swap-state":z||se?"danger":"",disabled:j,children:z?e(O,{children:[e("span",{children:e(h,{id:"y6sq5j"})}),e("span",{children:e(h,{id:"HKrBPX"})})]}):se?e(O,{children:[e("span",{children:e(h,{id:"Yx0Ud8"})}),e("span",{children:e(h,{id:"yTVtKs"})})]}):k?e(O,{children:[e(T,{icon:"lock"})," ",e("span",{children:e(h,{id:"MKEPCY"})})]}):r({id:"MKEPCY"})})})]})]}),!!he&&e(qe,{onClose:()=>{Ae(!1)},children:e(Vc,{note:C,fields:I,onClose:()=>Ae(!1)})}),!!Pe&&e(qe,{onClose:()=>{Ne(!1)},children:e(Gc,{accountID:M.current,onClose:()=>Ne(!1)})}),!!Ue&&e(qe,{onClose:()=>{Re(!1)},children:e(Kc,{account:n,note:Y,onRelationshipChange:Q=>{y(Q)},onClose:()=>Re(!1)})}),!!Le&&e(qe,{onClose:()=>{X(!1)},children:e(Zc,{onClose:({state:Q,account:ge}={})=>{X(!1),Q==="success"&&ge&&l(ge)}})})]})}function Yc([n,i,s]){const o=.2126*n+.7152*i+.0722*s;let c;return o>=220?c=1:o<=50?c=.1:c=o/255,c=Math.min(1,c),[n,i,s,c]}function jc(n){if(!n)return;const i=URL.parse(n),{host:s,pathname:o}=i,c=o.replace(/\/$/,"").replace(/^\//,"");return e(O,{children:[e("span",{class:"more-insignificant",children:[zt.toUnicode(s),"/"]}),e("wbr",{}),e("span",{children:c})]})}function Vc({note:n,fields:i,onClose:s}){const{_:o}=de(),c=(i==null?void 0:i.map(({name:u,value:r})=>`${u}
${Ri(r)}`).join(`

`))||"",l=Ri(n)+(c?`

${c}`:"");return e("div",{class:"sheet",children:[!!s&&e("button",{type:"button",class:"sheet-close",onClick:s,children:e(T,{icon:"x",alt:o({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(h,{id:"9groMz"})})}),e("main",{children:[e("p",{style:{whiteSpace:"pre-wrap"},children:l}),e(_s,{forceTranslate:!0,text:l})]})]})}function Gc({accountID:n,onClose:i}){const{_:s}=de(),{masto:o}=le(),[c,l]=L("default"),[u,r]=L([]),[d,a]=L([]),[m,b]=Rt(f=>f+1,0);ne(()=>{l("loading"),(async()=>{try{const f=await rn();r(f);const y=await o.v1.accounts.$select(n).lists.list();a(y),l("default")}catch{l("error")}})()},[m]);const[g,p]=L(!1);return e("div",{class:"sheet",id:"list-add-remove-container",children:[!!i&&e("button",{type:"button",class:"sheet-close",onClick:i,children:e(T,{icon:"x",alt:s({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(h,{id:"sJ2yQc"})})}),e("main",{children:[u.length>0?e("ul",{class:"list-add-remove",children:u.map(f=>{const y=d.some(v=>v.id===f.id);return e("li",{children:e("button",{type:"button",class:`light ${y?"checked":""}`,disabled:c==="loading",onClick:()=>{l("loading"),(async()=>{try{y?await o.v1.lists.$select(f.id).accounts.remove({accountIds:[n]}):await o.v1.lists.$select(f.id).accounts.create({accountIds:[n]}),b()}catch{l("error"),alert(s(y?{id:"7KnEYa"}:{id:"Tba8uO"}))}})()},children:[e(T,{icon:"check-circle",alt:"☑️"}),e("span",{children:f.title})]})})})}):c==="loading"?e("p",{class:"ui-state",children:e(Fe,{abrupt:!0})}):c==="error"?e("p",{class:"ui-state",children:e(h,{id:"v/l5uA"})}):e("p",{class:"ui-state",children:e(h,{id:"/MJ7gZ"})}),e("button",{type:"button",class:"plain2",onClick:()=>p(!0),disabled:c!=="default",children:[e(T,{icon:"plus",size:"l"})," ",e("span",{children:e(h,{id:"Sb2gYF"})})]})]}),g&&e(qe,{onClick:f=>{f.target===f.currentTarget&&p(!1)},children:e(vi,{list:g==null?void 0:g.list,onClose:f=>{f.state==="success"&&b(),p(!1)}})})]})}function Kc({account:n,note:i,onRelationshipChange:s=()=>{},onClose:o=()=>{}}){const{_:c}=de(),{masto:l}=le(),[u,r]=L("default"),d=q(null);return ne(()=>{let a;return d.current&&!i&&(a=setTimeout(()=>{var m,b;(b=(m=d.current).focus)==null||b.call(m)},100)),()=>{clearTimeout(a)}},[]),e("div",{class:"sheet",id:"private-note-container",children:[!!o&&e("button",{type:"button",class:"sheet-close",onClick:o,children:e(T,{icon:"x",alt:c({id:"yz7wBu"})})}),e("header",{children:e("b",{children:e(h,{id:"DYqYm5",values:{0:(n==null?void 0:n.username)||(n==null?void 0:n.acct)},components:{0:e("span",{class:"bidi-isolate"})}})})}),e("main",{children:e("form",{onSubmit:a=>{a.preventDefault();const b=new FormData(a.target).get("note");(b==null?void 0:b.trim())!==(i==null?void 0:i.trim())&&(r("loading"),(async()=>{try{const g=await l.v1.accounts.$select(n==null?void 0:n.id).note.create({comment:b});r("default"),s(g),o()}catch(g){r("error"),alert((g==null?void 0:g.message)||c({id:"ot8LpF"}))}})())},children:[e("textarea",{ref:d,name:"note",disabled:u==="loading",dir:"auto",children:i}),e("footer",{children:[e("button",{type:"button",class:"light",disabled:u==="loading",onClick:()=>{o==null||o()},children:e(h,{id:"dEgA5A"})}),e("span",{children:[e(Fe,{abrupt:!0,hidden:u!=="loading"}),e("button",{disabled:u==="loading",type:"submit",children:e(h,{id:"SrwrEj"})})]})]})]})})]})}const Wc=["image/jpeg","image/png","image/gif","image/webp"],Bi=Wc.join(",");function Zc({onClose:n=()=>{}}){const{_:i}=de(),{masto:s}=le(),[o,c]=L("loading"),[l,u]=L(null),[r,d]=L(null),[a,m]=L(null);ne(()=>{(async()=>{try{const k=await s.v1.accounts.verifyCredentials();u(k),c("default")}catch{c("error")}})()},[]);const{displayName:b,source:g,avatar:p,header:f}=l||{},{note:y,fields:v}=g||{},w=q(null),_=[...p?[{type:"image",url:p}]:[],...a?[{type:"image",url:a}]:[]],S=[...f?[{type:"image",url:f}]:[],...r?[{type:"image",url:r}]:[]];return e("div",{class:"sheet",id:"edit-profile-container",children:[!!n&&e("button",{type:"button",class:"sheet-close",onClick:n,children:e(T,{icon:"x",alt:i({id:"yz7wBu"})})}),e("header",{children:e("b",{children:e(h,{id:"9OpVZg"})})}),e("main",{children:o==="loading"?e("p",{class:"ui-state",children:e(Fe,{abrupt:!0})}):e("form",{onSubmit:k=>{k.preventDefault();const A=new FormData(k.target),C=A.get("header"),I=A.get("avatar"),E=A.get("display_name"),M=A.get("note"),z=w.current.querySelectorAll('input[name^="fields_attributes"]'),P=[];z.forEach(W=>{const ee=W.name,[Z,V,U]=ee.match(/fields_attributes\[(\d+)\]\[(.+)\]/)||[],B=W.value?W.value.trim():"";V&&U&&B&&(P[V]||(P[V]={}),P[V][U]=B)}),P.forEach(W=>{W.name&&!W.value&&(W.value="")}),(async()=>{try{const W=await s.v1.accounts.updateCredentials({header:C,avatar:I,displayName:E,note:M,fieldsAttributes:P});n==null||n({state:"success",account:W})}catch(W){alert((W==null?void 0:W.message)||i({id:"FwMMx0"}))}})()},children:[e("div",{class:"edit-profile-media-container",children:[e("label",{children:[e(h,{id:"C5zXYJ"})," ",e("input",{type:"file",name:"header",accept:Bi,onChange:k=>{const A=k.target.files[0];if(A){const C=URL.createObjectURL(A);d(C)}}})]}),e("div",{class:"edit-profile-media-field",children:[f?e("div",{class:"edit-media",tabIndex:"0",onClick:()=>{x.showMediaModal={mediaAttachments:S,index:0}},children:e("img",{src:f,alt:""})}):e("div",{class:"edit-media"}),r&&e(O,{children:[e(T,{icon:"arrow-right"}),e("div",{class:"edit-media",tabIndex:"0",onClick:()=>{x.showMediaModal={mediaAttachments:S,index:1}},children:e("img",{src:r,alt:""})})]})]})]}),e("div",{class:"edit-profile-media-container",children:[e("label",{children:[e(h,{id:"4XF0BB"})," ",e("input",{type:"file",name:"avatar",accept:Bi,onChange:k=>{const A=k.target.files[0];if(A){const C=URL.createObjectURL(A);m(C)}}})]}),e("div",{class:"edit-profile-media-field",children:[p?e("div",{class:"edit-media",tabIndex:"0",onClick:()=>{x.showMediaModal={mediaAttachments:_,index:0}},children:e("img",{src:p,alt:""})}):e("div",{class:"edit-media"}),a&&e(O,{children:[e(T,{icon:"arrow-right"}),e("div",{class:"edit-media",tabIndex:"0",onClick:()=>{x.showMediaModal={mediaAttachments:_,index:1}},children:e("img",{src:a,alt:""})})]})]})]}),e("p",{children:e("label",{children:[e(h,{id:"6YtxFj"})," ",e("input",{type:"text",name:"display_name",defaultValue:b,maxLength:30,disabled:o==="loading",dir:"auto"})]})}),e("p",{children:e("label",{children:[e(h,{id:"E+oKCO"}),e("textarea",{defaultValue:y,name:"note",maxLength:500,rows:"5",disabled:o==="loading",dir:"auto"})]})}),e("p",{children:e(h,{id:"T4I119"})}),e("table",{ref:w,children:[e("thead",{children:e("tr",{children:[e("th",{children:e(h,{id:"87a/t/"})}),e("th",{children:e(h,{id:"4b3oEV"})})]})}),e("tbody",{children:Array.from({length:Math.max(4,v.length)}).map((k,A)=>{const{name:C="",value:I=""}=v[A]||{};return e(Xc,{name:C,value:I,index:A,disabled:o==="loading"},A)})})]}),e("footer",{children:[e("button",{type:"button",class:"light",disabled:o==="loading",onClick:()=>{n==null||n()},children:e(h,{id:"dEgA5A"})}),e("button",{type:"submit",disabled:o==="loading",children:e(h,{id:"tfDRzk"})})]})]})})]})}function Xc({name:n,value:i,disabled:s,index:o}){const[c,l]=L(!!i);return e("tr",{children:[e("td",{children:e("input",{type:"text",name:`fields_attributes[${o}][name]`,defaultValue:n,disabled:s,maxLength:255,required:c,dir:"auto"})}),e("td",{children:e("input",{type:"text",name:`fields_attributes[${o}][value]`,defaultValue:i,disabled:s,maxLength:255,onChange:u=>l(!!u.currentTarget.value),dir:"auto"})})]})}function Jc({acct:n,instance:i}){let[s,o]=n.split("@");o||(o=i);const c=zt.toASCII(n);return e("div",{class:"handle-info",children:[e("span",{class:"handle-handle",title:c,children:[e("b",{class:"handle-username",children:s}),e("span",{class:"handle-at",children:"@"}),e("b",{class:"handle-server",children:o})]}),e("div",{class:"handle-legend",children:[e("span",{class:"ib",children:[e("span",{class:"handle-legend-icon username"})," ",e(h,{id:"silO9A"})]})," ",e("span",{class:"ib",children:[e("span",{class:"handle-legend-icon server"})," ",e(h,{id:"rZgCpJ"})]})]})]})}function Qc({account:n,instance:i,onClose:s}){const{_:o}=de(),{masto:c,instance:l,authenticated:u}=le({instance:i}),r=typeof n=="string";return ne(()=>{r||(x.accounts[`${n.id}@${l}`]=n)},[n]),Ds(s),e("div",{class:"sheet",children:[!!s&&e("button",{type:"button",class:"sheet-close outer",onClick:s,children:e(T,{icon:"x",alt:o({id:"yz7wBu"})})}),e(Fs,{instance:l,authenticated:u,account:n,fetchAccount:async()=>{if(r)try{return await c.v1.accounts.lookup({acct:n,skip_webfinger:!1})}catch{const a=await c.v2.search.fetch({q:n,type:"accounts",limit:1,resolve:u});if(a.accounts.length)return a.accounts[0];if(/https?:\/\/[^/]+\/@/.test(n)){const m=URL.parse(n),{hostname:b,pathname:g}=m,p=g.replace(/^\//,"").replace(/\/$/,"")+"@"+b,f=await c.v2.search.fetch({q:p,type:"accounts",limit:1,resolve:u});if(f.accounts.length)return f.accounts[0]}}else return n}})]})}function ea({onClose:n}){const{_:i}=de(),{masto:s}=le(),[o,c]=L("default"),[l,u]=L([]),[r,d]=Rt(m=>m+1,0);ne(()=>{c("loading"),(async()=>{try{const m=await pt.drafts.keys();if(m.length){const b=Cn(),g=m.filter(p=>p.startsWith(b));if(g.length){const p=await pt.drafts.getMany(g);p.sort((f,y)=>new Date(y.updatedAt).getTime()-new Date(f.updatedAt).getTime()),u(p)}else u([])}else u([]);c("default")}catch{c("error")}})()},[r]);const a=(l==null?void 0:l.length)>0;return e("div",{class:"sheet",children:[!!n&&e("button",{type:"button",class:"sheet-close",onClick:n,children:e(T,{icon:"x",alt:i({id:"yz7wBu"})})}),e("header",{children:[e("h2",{children:[e(h,{id:"krk5ws"})," ",e(Fe,{abrupt:!0,hidden:o!=="loading"})]}),a&&e("div",{class:"insignificant",children:e(h,{id:"Ap/10+"})})]}),e("main",{children:a?e(O,{children:[e("ul",{class:"drafts-list",children:l.map(m=>{const{updatedAt:b,key:g,draftStatus:p,replyTo:f}=m,y=new Date(b);return e("li",{children:[e("div",{class:"mini-draft-meta",children:[e("b",{children:[e(T,{icon:f?"reply":"quill",size:"s"})," ",e("time",{children:[!!f&&e(O,{children:[e("span",{class:"bidi-isolate",children:["@",f.account.acct]}),e("br",{})]}),ot(y)]})]}),e(ut,{confirmLabel:e("span",{children:e(h,{id:"/W5yFF"})}),menuItemClassName:"danger",align:"end",disabled:o==="loading",onClick:()=>{(async()=>{try{await pt.drafts.del(g),d()}catch{alert(i({id:"rEYoku"}))}})()},children:e("button",{type:"button",class:"small light",disabled:o==="loading",children:e(h,{id:"Jb6/SB"})})})]}),e("button",{type:"button",disabled:o==="loading",class:"draft-item",onClick:async()=>{let v;if(f){c("loading");try{v=await s.v1.statuses.$select(f.id).fetch()}catch{alert(i({id:"tMwimH"})),c("default");return}c("default")}window.__COMPOSE__={draftStatus:p,replyToStatus:v},x.showCompose=!0,x.showDrafts=!1},children:e(ta,{draft:m})})]},b)})}),l.length>1&&e("p",{children:e(ut,{confirmLabel:e("span",{children:e(h,{id:"3IakFR"})}),menuItemClassName:"danger",disabled:o==="loading",onClick:()=>{(async()=>{c("loading");try{await pt.drafts.delMany(l.map(m=>m.key)),c("default"),d()}catch{alert(i({id:"0J4sZq"})),c("error")}})()},children:e("button",{type:"button",class:"light danger",disabled:o==="loading",children:e(h,{id:"hOg+Mt"})})})})]}):e("p",{children:e(h,{id:"8iQ+jk"})})})]})}function ta({draft:n}){var g;const{_:i}=de(),{draftStatus:s,replyTo:o}=n,{status:c,spoilerText:l,poll:u,mediaAttachments:r}=s,d=((g=u==null?void 0:u.options)==null?void 0:g.length)>0,a=(r==null?void 0:r.length)>0,m=d||a,b=Ce(()=>{if(!a)return;const p=r.find(v=>/image/.test(v.type));if(!p)return;const{file:f}=p;return URL.createObjectURL(f)},[a,r]);return e(O,{children:e("div",{class:"mini-draft",children:[m&&e("div",{class:`mini-draft-aside ${b?"has-image":""}`,style:b?{"--bg-image":`url(${b})`}:{},children:[d&&e(T,{icon:"poll",alt:i({id:"4WUbF1"})}),a&&e("span",{children:[e(T,{icon:"attachment",alt:i({id:"xYilR2"})})," ",e("small",{children:r==null?void 0:r.length})]})]}),e("div",{class:"mini-draft-main",children:[!!l&&e("div",{class:"mini-draft-spoiler",children:l}),!!c&&e("div",{class:"mini-draft-status",children:c})]})]})})}function na({html:n,url:i,width:s,height:o,onClose:c=()=>{}}){const{_:l}=de();return e("div",{class:"embed-modal-container",children:[e("div",{class:"top-controls",children:[e("button",{type:"button",class:"light",onClick:()=>c(),children:e(T,{icon:"x",alt:l({id:"yz7wBu"})})}),i&&e("a",{href:i,target:"_blank",rel:"noopener",class:"button plain",children:[e("span",{children:e(h,{id:"4/RpOy"})})," ",e(T,{icon:"external"})]})]}),e("div",{class:"embed-content",dangerouslySetInnerHTML:{__html:n},style:{"--width":s+"px","--height":o+"px","--aspect-ratio":`${s}/${o}`}})]})}function ia({instance:n,excludeRelationshipAttrs:i=[],postID:s,onClose:o=()=>{},blankCopy:c}){const{_:l}=de(),{masto:u,instance:r}=le(),d=n?n===r:!0,a=Ve(x),[m,b]=L("default"),[g,p]=L([]),[f,y]=L(!1);if(Ds(o),!a.showGenericAccounts)return null;const{id:v,heading:w,fetchAccounts:_,accounts:S,showReactions:k}=a.showGenericAccounts,[A,C]=L({}),I=async P=>{if(!(P!=null&&P.length)||!d)return;const W=await ri(P,A);W&&C({...A,...W})},E=P=>{_&&(P&&p([]),b("loading"),(async()=>{try{const{done:W,value:ee}=await _(P);if(Array.isArray(ee)){if(P){const Z=[];for(let V=0;V<ee.length;V++){const U=ee[V],B=Z.find((se,$)=>se.id===U.id&&V!==$);B?B._types.push(...U._types):Z.push({_types:[],...U})}p(Z)}else p(Z=>{const V=Z;for(const U of ee){const B=V.find(se=>se.id===U.id);B?B._types.push(...U._types):V.push(U)}return V});y(!W),I(ee)}else y(!1);b("default")}catch{b("error")}})())},M=q(!0);ne(()=>{(S==null?void 0:S.length)>0?(p(S),I(S)):(E(!0),M.current=!1)},[S,_]),ne(()=>{var P;M.current||((P=a.reloadGenericAccounts)==null?void 0:P.id)===v&&E(!0)},[a.reloadGenericAccounts.counter]);const z=x.statuses[s];return e("div",{id:"generic-accounts-container",class:"sheet",tabindex:"-1",children:[e("button",{type:"button",class:"sheet-close",onClick:o,children:e(T,{icon:"x",alt:l({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:w||l({id:"bPwFdf"})})}),e("main",{children:[z&&e(be,{to:`/${n||r}/s/${z.id}`,class:"post-preview",children:e(je,{status:z,size:"s",readOnly:!0})}),g.length>0?e(O,{children:[e("ul",{class:"accounts-list",children:g.map(P=>{var Z,V;const W=A[P.id],ee=`${P.id}-${((Z=P._types)==null?void 0:Z.length)||""}`;return e("li",{children:[k&&((V=P._types)==null?void 0:V.length)>0&&e("div",{class:"reactions-block",children:P._types.map(U=>e(T,{icon:{reblog:"rocket",favourite:"heart"}[U],class:`${U}-icon`}))}),e("div",{class:"account-relationships",children:e(ht,{account:P,showStats:!0,relationship:W,excludeRelationshipAttrs:i})})]},ee)})}),m==="default"?f?e(Ct,{onChange:P=>{P&&E()},children:e("button",{type:"button",class:"plain block",onClick:()=>E(),children:e(h,{id:"uXRAkV"})})}):e("p",{class:"ui-state insignificant",children:e(h,{id:"2EYeAZ"})}):m==="loading"&&e("p",{class:"ui-state",children:e(Fe,{abrupt:!0})})]}):m==="loading"?e("p",{class:"ui-state",children:e(Fe,{abrupt:!0})}):m==="error"?e("p",{class:"ui-state",children:e(h,{id:"AThL/k"})}):e("p",{class:"ui-state insignificant",children:c||l({id:"10OlfF"})})]})]})}function sa({alt:n,lang:i,onClose:s}){const{_:o}=de(),c=Ve(x),[l,u]=L(!1),r=ws(!0),d=c.settings.contentTranslationHideLanguages||[],a=!!i&&i!==r&&!Ti([i],[r])&&!d.find(m=>i===m||Ti([i],[m]));return e("div",{class:"sheet",tabindex:"-1",children:[!!s&&e("button",{type:"button",class:"sheet-close outer",onClick:s,children:e(T,{icon:"x",alt:o({id:"yz7wBu"})})}),e("header",{class:"header-grid",children:[e("h2",{children:e(h,{id:"5gfDMm"})}),e("div",{class:"header-side",children:e(lt,{align:"end",menuButton:e("button",{type:"button",class:"plain4",children:e(T,{icon:"more",alt:o({id:"2FYpfJ"}),size:"xl"})}),children:[e(Se,{disabled:l,onClick:()=>{u(!0)},children:[e(T,{icon:"translate"}),e("span",{children:e(h,{id:"pi8x/S"})})]}),Oo&&e(Se,{onClick:()=>{zo(n,i)},children:[e(T,{icon:"speak"}),e("span",{children:e(h,{id:"yIBLq8"})})]})]})})]}),e("main",{lang:i,dir:"auto",children:[e("p",{style:{whiteSpace:"pre-wrap",textWrap:"pretty"},children:n}),(a||l)&&e(_s,{forceTranslate:l,sourceLanguage:i,text:n})]})]})}const{min:kd,max:Sd}=Math;const Bs={};for(let n of["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"])Bs[`[object ${n}]`]=n.toLowerCase();function oa(n){return Bs[Object.prototype.toString.call(n)]||"object"}const Xt=(n,i=null)=>n.length>=3?Array.prototype.slice.call(n):oa(n[0])=="object"&&i?i.split("").filter(s=>n[0][s]!==void 0).map(s=>n[0][s]):n[0].slice(0);const{PI:Pn,min:_d,max:Cd}=Math;const Id=Pn*2,Td=Pn/3,ca=Pn/180,aa=180/Pn;function An(n,i){let s=n.length;Array.isArray(n[0])||(n=[n]),Array.isArray(i[0])||(i=i.map(u=>[u]));let o=i[0].length,c=i[0].map((u,r)=>i.map(d=>d[r])),l=n.map(u=>c.map(r=>Array.isArray(u)?u.reduce((d,a,m)=>d+a*(r[m]||0),0):r.reduce((d,a)=>d+a*u,0)));return s===1&&(l=l[0]),o===1?l.map(u=>u[0]):l}const Hs={Kn:18,labWhitePoint:"d65",Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452,kE:216/24389,kKE:8,kK:24389/27,RefWhiteRGB:{X:.95047,Y:1,Z:1.08883},MtxRGB2XYZ:{m00:.4124564390896922,m01:.21267285140562253,m02:.0193338955823293,m10:.357576077643909,m11:.715152155287818,m12:.11919202588130297,m20:.18043748326639894,m21:.07217499330655958,m22:.9503040785363679},MtxXYZ2RGB:{m00:3.2404541621141045,m01:-.9692660305051868,m02:.055643430959114726,m10:-1.5371385127977166,m11:1.8760108454466942,m12:-.2040259135167538,m20:-.498531409556016,m21:.041556017530349834,m22:1.0572251882231791},As:.9414285350000001,Bs:1.040417467,Cs:1.089532651,MtxAdaptMa:{m00:.8951,m01:-.7502,m02:.0389,m10:.2664,m11:1.7135,m12:-.0685,m20:-.1614,m21:.0367,m22:1.0296},MtxAdaptMaI:{m00:.9869929054667123,m01:.43230526972339456,m02:-.008528664575177328,m10:-.14705425642099013,m11:.5183602715367776,m12:.04004282165408487,m20:.15996265166373125,m21:.0492912282128556,m22:.9684866957875502}};const Fn=n=>{const i=Math.sign(n);return n=Math.abs(n),(n<=.0031308?n*12.92:1.055*Math.pow(n,1/2.4)-.055)*i},la=(n,i,s)=>{const{MtxAdaptMa:o,MtxAdaptMaI:c,MtxXYZ2RGB:l,RefWhiteRGB:u,Xn:r,Yn:d,Zn:a}=Hs,m=r*o.m00+d*o.m10+a*o.m20,b=r*o.m01+d*o.m11+a*o.m21,g=r*o.m02+d*o.m12+a*o.m22,p=u.X*o.m00+u.Y*o.m10+u.Z*o.m20,f=u.X*o.m01+u.Y*o.m11+u.Z*o.m21,y=u.X*o.m02+u.Y*o.m12+u.Z*o.m22,v=(n*o.m00+i*o.m10+s*o.m20)*(p/m),w=(n*o.m01+i*o.m11+s*o.m21)*(f/b),_=(n*o.m02+i*o.m12+s*o.m22)*(y/g),S=v*c.m00+w*c.m10+_*c.m20,k=v*c.m01+w*c.m11+_*c.m21,A=v*c.m02+w*c.m12+_*c.m22,C=Fn(S*l.m00+k*l.m10+A*l.m20),I=Fn(S*l.m01+k*l.m11+A*l.m21),E=Fn(S*l.m02+k*l.m12+A*l.m22);return[C*255,I*255,E*255]},wi=(...n)=>{n=Xt(n,"lab");const[i,s,o,...c]=n,[l,u,r]=ra([i,s,o]),[d,a,m]=la(l,u,r);return[d,a,m,...c.length>0&&c[0]<1?[c[0]]:[]]};function ra(n){var i=[[1.2268798758459243,-.5578149944602171,.2813910456659647],[-.0405757452148008,1.112286803280317,-.0717110580655164],[-.0763729366746601,-.4214933324022432,1.5869240198367816]],s=[[1,.3963377773761749,.2158037573099136],[1,-.1055613458156586,-.0638541728258133],[1,-.0894841775298119,-1.2914855480194092]],o=An(s,n);return An(i,o.map(c=>c**3))}function Bn(n){const i=Math.sign(n);return n=Math.abs(n),(n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4))*i}const da=(n,i,s)=>{n=Bn(n/255),i=Bn(i/255),s=Bn(s/255);const{MtxRGB2XYZ:o,MtxAdaptMa:c,MtxAdaptMaI:l,Xn:u,Yn:r,Zn:d,As:a,Bs:m,Cs:b}=Hs;let g=n*o.m00+i*o.m10+s*o.m20,p=n*o.m01+i*o.m11+s*o.m21,f=n*o.m02+i*o.m12+s*o.m22;const y=u*c.m00+r*c.m10+d*c.m20,v=u*c.m01+r*c.m11+d*c.m21,w=u*c.m02+r*c.m12+d*c.m22;let _=g*c.m00+p*c.m10+f*c.m20,S=g*c.m01+p*c.m11+f*c.m21,k=g*c.m02+p*c.m12+f*c.m22;return _*=y/a,S*=v/m,k*=w/b,g=_*l.m00+S*l.m10+k*l.m20,p=_*l.m01+S*l.m11+k*l.m21,f=_*l.m02+S*l.m12+k*l.m22,[g,p,f]},ki=(...n)=>{const[i,s,o,...c]=Xt(n,"rgb"),l=da(i,s,o);return[...ua(l),...c.length>0&&c[0]<1?[c[0]]:[]]};function ua(n){const i=[[.819022437996703,.3619062600528904,-.1288737815209879],[.0329836539323885,.9292868615863434,.0361446663506424],[.0481771893596242,.2642395317527308,.6335478284694309]],s=[[.210454268309314,.7936177747023054,-.0040720430116193],[1.9779985324311684,-2.42859224204858,.450593709617411],[.0259040424655478,.7827717124575296,-.8086757549230774]],o=An(i,n);return An(s,o.map(c=>Math.cbrt(c)))}const{sin:ha,cos:fa}=Math,pa=(...n)=>{let[i,s,o]=Xt(n,"lch");return isNaN(o)&&(o=0),o=o*ca,[i,fa(o)*s,ha(o)*s]},Hn=(...n)=>{n=Xt(n,"lch");const[i,s,o,...c]=n,[l,u,r]=pa(i,s,o),[d,a,m]=wi(l,u,r);return[d,a,m,...c.length>0&&c[0]<1?[c[0]]:[]]},{sqrt:ma,atan2:ga,round:ba}=Math,ya=(...n)=>{const[i,s,o]=Xt(n,"lab"),c=ma(s*s+o*o);let l=(ga(o,s)*aa+360)%360;return ba(c*1e4)===0&&(l=Number.NaN),[i,c,l]},va=(...n)=>{const[i,s,o,...c]=Xt(n,"rgb"),[l,u,r]=ki(i,s,o),[d,a,m]=ya(l,u,r);return[d,a,m,...c.length>0&&c[0]<1?[c[0]]:[]]},wa={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Blaede Phanpy",PHANPY_DEFAULT_INSTANCE:"mastodon.blaede.family",PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:"https://mastodon.blaede.family/auth/sign_up",PHANPY_GIPHY_API_KEY:"48JGsrSS1XE5w4nWe9c9hqxPbsfRWR0e",PHANPY_LINGVA_INSTANCES:"lingva.phanpy.social lingva.lunar.icu lingva.garudalinux.org translate.plausibility.cloud",PHANPY_PRIVACY_POLICY_URL:"https://mastodon.blaede.family/privacy-policy",PHANPY_WEBSITE:"https://phanpy.blaede.family",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},{PHANPY_IMG_ALT_API_URL:Ad}=wa;function qs({mediaAttachments:n,statusID:i,instance:s,lang:o,index:c=0,onClose:l=()=>{}}){var k,A;const{_:u}=de(),[r,d]=L("default"),a=q(null),[m,b]=L(c),g=q(null);wt(()=>{var C;(C=g.current)==null||C.scrollIntoView()},[]);const p=q(i);ne(()=>{const C=c*a.current.clientWidth,I=p.current!==i;I&&(p.current=i),a.current.focus(),a.current.scrollTo({left:C*(Nt()?-1:1),behavior:I?"auto":"smooth"})},[c,i]);const[f,y]=L(!0);ne(()=>{let C=()=>{l()};return a.current&&a.current.addEventListener("swiped-down",C),()=>{a.current&&a.current.removeEventListener("swiped-down",C)}},[]),He("esc",l,{ignoreEventWhen:C=>!!document.querySelector("#modal-container > *")},[l]),ne(()=>{let C=()=>{const{clientWidth:I,scrollLeft:E}=a.current,M=Math.round(Math.abs(E)/I);b(M)};return a.current&&a.current.addEventListener("scroll",C,{passive:!0}),()=>{a.current&&a.current.removeEventListener("scroll",C)}},[]),ne(()=>{let C=setTimeout(()=>{var I,E;(E=(I=a.current)==null?void 0:I.focus)==null||E.call(I)},100);return()=>clearTimeout(C)},[]);const v=Ce(()=>n==null?void 0:n.map(C=>{const{blurhash:I}=C;if(I){const E=di(I);return va(E)}return null}),[n]),w=Ce(()=>v==null?void 0:v.map(C=>C?{light:Hn([.95,.01,C[2]]),dark:Hn([.35,.01,C[2]]),default:Hn([.6,C[1],C[2]])}:null)),_=Ce(()=>{const I=100/w.length,E=w.map((P,W)=>{var V,U,B,se;const ee=W*I+5,Z=(W+1)*I-5;return P!=null&&P.light&&(P!=null&&P.dark)?{light:`
                rgb(${(V=P.light)==null?void 0:V.join(",")}) ${ee}%, 
                rgb(${(U=P.light)==null?void 0:U.join(",")}) ${Z}%
              `,dark:`
                rgb(${(B=P.dark)==null?void 0:B.join(",")}) ${ee}%, 
                rgb(${(se=P.dark)==null?void 0:se.join(",")}) ${Z}%
              `}:{light:`
              transparent ${ee}%, 
              transparent ${Z}%
            `,dark:`
              transparent ${ee}%, 
              transparent ${Z}%
            `}}),M=E.map(P=>P.light).join(", "),z=E.map(P=>P.dark).join(", ");return{light:M,dark:z}},[w]);let S=q(null);return ne(()=>()=>{var C,I;(I=(C=S.current)==null?void 0:C.hideToast)==null||I.call(C)},[]),wt(()=>{const C=w[m];let I,E;if(C){const M=ke.local.get("theme");if(M){const z=`rgb(${C[M].join(",")})`;I=document.querySelector('meta[name="theme-color"][data-theme-setting="manual"]'),I&&(E=I.content,I.content=z)}else{const z=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",P=`rgb(${C[z].join(",")})`;I=document.querySelector(`meta[name="theme-color"][media*="${z}"]`),I&&(E=I.content,I.content=P)}}return()=>{I&&E&&(I.content=E)}},[m,w]),e("div",{class:`media-modal-container media-modal-count-${n==null?void 0:n.length}`,children:[e("div",{ref:a,tabIndex:"0","data-swipe-threshold":"44",class:"carousel",onClick:C=>{(C.target.classList.contains("carousel-item")||C.target.classList.contains("media")||C.target.classList.contains("media-zoom"))&&l()},style:n.length>1?{backgroundAttachment:"local","--accent-gradient-light":_==null?void 0:_.light,"--accent-gradient-dark":_==null?void 0:_.dark}:{},children:n==null?void 0:n.map((C,I)=>{var M,z;const E=n.length===1?w[I]:null;return e("div",{class:"carousel-item",style:E?{"--accent-color":`rgb(${E.default.join(",")})`,"--accent-light-color":`rgb(${(M=E.light)==null?void 0:M.join(",")})`,"--accent-dark-color":`rgb(${(z=E.dark)==null?void 0:z.join(",")})`,"--accent-alpha-color":`rgba(${E.default.join(",")}, 0.4)`}:{},tabindex:"0",ref:I===m?g:null,onClick:P=>{P.target.classList.contains("media")||y(!f)},children:[!!C.description&&e("button",{type:"button",class:"media-alt",hidden:!f,onClick:()=>{x.showMediaAlt={alt:C.description,lang:o}},children:[e("span",{class:"alt-badge",children:"ALT"}),e("span",{class:"media-alt-desc",lang:o,dir:"auto",children:C.description})]}),e(Cs,{media:C,showOriginal:!0,lang:o})]},C.id)})}),e("div",{class:"carousel-top-controls",hidden:!f,children:[e("span",{children:e("button",{type:"button",class:"carousel-button",onClick:()=>l(),children:e(T,{icon:"x",alt:u({id:"yz7wBu"})})})}),(n==null?void 0:n.length)>1?e("span",{class:"carousel-dots",children:n==null?void 0:n.map((C,I)=>e("button",{type:"button",disabled:I===m,class:`carousel-dot ${I===m?"active":""}`,onClick:E=>{E.preventDefault(),E.stopPropagation();const M=a.current.clientWidth*I*(Nt()?-1:1);a.current.focus(),a.current.scrollTo({left:M,behavior:"smooth"})},children:e(T,{icon:"round",size:"s",alt:"⸱"})},C.id))}):e("span",{}),e("span",{children:[e(lt,{overflow:"auto",align:"end",position:"anchor",gap:4,menuClassName:"glass-menu",menuButton:e("button",{type:"button",class:"carousel-button",children:e(T,{icon:"more",alt:u({id:"2FYpfJ"})})}),children:[e(Ye,{href:((k=n[m])==null?void 0:k.remoteUrl)||((A=n[m])==null?void 0:A.url),class:"carousel-button",target:"_blank",title:u({id:"5hXGws"}),children:[e(T,{icon:"popout"}),e("span",{children:e(h,{id:"aDr7Vc"})})]}),!1]})," ",!!i&&e(be,{to:`${s?`/${s}`:""}/s/${i}${window.matchMedia("(min-width: calc(40em + 350px))").matches?`?media=${m+1}`:""}`,class:"button carousel-button media-post-link",children:[e("span",{class:"button-label",children:[e(h,{id:"ISg5SQ"})," "]}),"»"]})]})]}),(n==null?void 0:n.length)>1&&e("div",{class:"carousel-controls",hidden:!f,children:[e("button",{type:"button",class:"carousel-button",hidden:m===0,onClick:C=>{C.preventDefault(),C.stopPropagation(),a.current.focus(),a.current.scrollTo({left:a.current.clientWidth*(m-1)*(Nt()?-1:1),behavior:"smooth"})},children:e(T,{icon:"arrow-left",alt:u({id:"DHhJ7s"})})}),e("button",{type:"button",class:"carousel-button",hidden:m===n.length-1,onClick:C=>{C.preventDefault(),C.stopPropagation(),a.current.focus(),a.current.scrollTo({left:a.current.clientWidth*(m+1)*(Nt()?-1:1),behavior:"smooth"})},children:e(T,{icon:"arrow-right",alt:u({id:"hXzOVo"})})})]})]})}const ka=[,"spam","legal","violation","other"],Jt={spam:{label:{id:"t8dIOP"},description:{id:"csQin/"}},legal:{label:{id:"IjKdHM"},description:{id:"e6tGFu"}},violation:{label:{id:"KPFHM2"},description:{id:"fpotTF"},stampLabel:{id:"iuLUuH"}},other:{label:{id:"/IX/7x"},description:{id:"kxiG8g"},excludeStamp:!0}};function Sa({account:n,post:i,onClose:s}){const{_:o,_:c}=de(),{masto:l}=le(),[u,r]=L("default"),[d,a]=n.acct.split("@"),[m,b]=Ce(()=>{const{rules:S,domain:k}=hs();return[S||[],k]}),[g,p]=L(null),[f,y]=L(!1),v=q(null),[w,_]=L(!1);return e("div",{class:"report-modal-container",children:[e("div",{class:"top-controls",children:[e("h1",{children:c(i?{id:"muLhL3"}:{id:"ACul2G",values:{username:d}})}),e("button",{type:"button",class:"plain4 small",disabled:u==="loading",onClick:()=>s(),children:e(T,{icon:"x",size:"xl",alt:c({id:"yz7wBu"})})})]}),e("main",{children:[e("div",{class:"report-preview",children:i?e(je,{status:i,size:"s",previewMode:!0}):e(ht,{account:n,avatarSize:"xxl",useAvatarStatic:!0,showStats:!0,showActivity:!0})}),!!g&&!Jt[g].excludeStamp&&e("span",{class:"rubber-stamp","aria-hidden":"true",children:[o(Jt[g].stampLabel||o(Jt[g].label)),e("small",{children:e(h,{id:"2WtL62"})})]},g),e("form",{onSubmit:S=>{S.preventDefault();const k=new FormData(S.target),A=Object.fromEntries(k.entries());let{category:C,comment:I,forward:E}=A;I||(I=void 0),E==="on"&&(E=!0);const M=C==="violation"?Object.entries(A).filter(([P])=>P.startsWith("rule_ids")).map(([P,W])=>W):void 0,z={category:C,comment:I,forward:E,ruleIds:M};r("loading"),(async()=>{try{await l.v1.reports.create({accountId:n.id,statusIds:i!=null&&i.id?[i.id]:void 0,category:C,comment:I,ruleIds:M,forward:E}),r("success"),me(c(i?{id:"y3ou+8"}:{id:"R9kjEL"})),s()}catch(P){r("error"),me((P==null?void 0:P.message)||c(i?{id:"+3FjPq"}:{id:"oEQq5w"}))}})()},children:[e("p",{children:c(i?{id:"L9fUm+"}:{id:"rSLkfe"})}),e("section",{class:"report-categories",children:ka.map(S=>S==="violation"&&!(m!=null&&m.length)?null:e(O,{children:[e("label",{class:"report-category",children:[e("input",{type:"radio",name:"category",value:S,required:!0,disabled:u==="loading",onChange:k=>{p(k.target.value),y(k.target.value==="violation")}}),e("span",{children:[o(Jt[S].label),"  ",e("small",{class:"ib insignificant",children:o(Jt[S].description)})]})]}),S==="violation"&&!!(m!=null&&m.length)&&e("div",{class:"shazam-container no-animation",hidden:!f,children:e("div",{class:"shazam-container-inner",children:e("div",{class:"report-rules",ref:v,children:m.map((k,A)=>e("label",{class:"report-rule",children:[e("input",{type:"checkbox",name:`rule_ids[${A}]`,value:k.id,required:f&&!w,disabled:u==="loading",onChange:C=>{const{checked:I}=C.target;I?_(!0):v.current.querySelectorAll("input:checked").length||_(!1)}}),e("span",{children:k.text})]},k.id))})})})]},S))}),e("section",{class:"report-comment",children:[e("p",{children:e("label",{for:"report-comment",children:e(h,{id:"ecVtjm"})})}),e("textarea",{maxlength:"1000",rows:"1",name:"comment",id:"report-comment",disabled:u==="loading",required:!i})]}),!!a&&a!==b&&e("section",{children:e("p",{children:e("label",{children:[e("input",{type:"checkbox",switch:!0,name:"forward",disabled:u==="loading"})," ",e("span",{children:e(h,{id:"cyjS8M",values:{domain:a},components:{0:e("i",{})}})})]})})}),e("footer",{children:[e("button",{type:"submit",disabled:u==="loading",children:e(h,{id:"4cijjm"})})," ",e("button",{type:"submit",class:"plain2",disabled:u==="loading",onClick:async()=>{try{await l.v1.accounts.$select(n.id).mute(),me(c({id:"/BGBeF",values:{username:d}}))}catch{me(c({id:"v02K7/",values:{username:d}}))}},children:e(h,{id:"caeqw/",components:{0:e("small",{class:"ib"})}})})," ",e("button",{type:"submit",class:"plain2",disabled:u==="loading",onClick:async()=>{try{await l.v1.accounts.$select(n.id).block(),me(c({id:"kjUejn",values:{username:d}}))}catch{me(c({id:"pMcdDp",values:{username:d}}))}},children:e(h,{id:"JybQca",components:{0:e("small",{class:"ib"})}})}),e(Fe,{hidden:u!=="loading"})]})]})]})]})}var bn={exports:{}},xd=bn.exports,Hi;function _a(){return Hi||(Hi=1,function(n){var i=function(){var s=String.fromCharCode,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",l={};function u(d,a){if(!l[d]){l[d]={};for(var m=0;m<d.length;m++)l[d][d.charAt(m)]=m}return l[d][a]}var r={compressToBase64:function(d){if(d==null)return"";var a=r._compress(d,6,function(m){return o.charAt(m)});switch(a.length%4){default:case 0:return a;case 1:return a+"===";case 2:return a+"==";case 3:return a+"="}},decompressFromBase64:function(d){return d==null?"":d==""?null:r._decompress(d.length,32,function(a){return u(o,d.charAt(a))})},compressToUTF16:function(d){return d==null?"":r._compress(d,15,function(a){return s(a+32)})+" "},decompressFromUTF16:function(d){return d==null?"":d==""?null:r._decompress(d.length,16384,function(a){return d.charCodeAt(a)-32})},compressToUint8Array:function(d){for(var a=r.compress(d),m=new Uint8Array(a.length*2),b=0,g=a.length;b<g;b++){var p=a.charCodeAt(b);m[b*2]=p>>>8,m[b*2+1]=p%256}return m},decompressFromUint8Array:function(d){if(d==null)return r.decompress(d);for(var a=new Array(d.length/2),m=0,b=a.length;m<b;m++)a[m]=d[m*2]*256+d[m*2+1];var g=[];return a.forEach(function(p){g.push(s(p))}),r.decompress(g.join(""))},compressToEncodedURIComponent:function(d){return d==null?"":r._compress(d,6,function(a){return c.charAt(a)})},decompressFromEncodedURIComponent:function(d){return d==null?"":d==""?null:(d=d.replace(/ /g,"+"),r._decompress(d.length,32,function(a){return u(c,d.charAt(a))}))},compress:function(d){return r._compress(d,16,function(a){return s(a)})},_compress:function(d,a,m){if(d==null)return"";var b,g,p={},f={},y="",v="",w="",_=2,S=3,k=2,A=[],C=0,I=0,E;for(E=0;E<d.length;E+=1)if(y=d.charAt(E),Object.prototype.hasOwnProperty.call(p,y)||(p[y]=S++,f[y]=!0),v=w+y,Object.prototype.hasOwnProperty.call(p,v))w=v;else{if(Object.prototype.hasOwnProperty.call(f,w)){if(w.charCodeAt(0)<256){for(b=0;b<k;b++)C=C<<1,I==a-1?(I=0,A.push(m(C)),C=0):I++;for(g=w.charCodeAt(0),b=0;b<8;b++)C=C<<1|g&1,I==a-1?(I=0,A.push(m(C)),C=0):I++,g=g>>1}else{for(g=1,b=0;b<k;b++)C=C<<1|g,I==a-1?(I=0,A.push(m(C)),C=0):I++,g=0;for(g=w.charCodeAt(0),b=0;b<16;b++)C=C<<1|g&1,I==a-1?(I=0,A.push(m(C)),C=0):I++,g=g>>1}_--,_==0&&(_=Math.pow(2,k),k++),delete f[w]}else for(g=p[w],b=0;b<k;b++)C=C<<1|g&1,I==a-1?(I=0,A.push(m(C)),C=0):I++,g=g>>1;_--,_==0&&(_=Math.pow(2,k),k++),p[v]=S++,w=String(y)}if(w!==""){if(Object.prototype.hasOwnProperty.call(f,w)){if(w.charCodeAt(0)<256){for(b=0;b<k;b++)C=C<<1,I==a-1?(I=0,A.push(m(C)),C=0):I++;for(g=w.charCodeAt(0),b=0;b<8;b++)C=C<<1|g&1,I==a-1?(I=0,A.push(m(C)),C=0):I++,g=g>>1}else{for(g=1,b=0;b<k;b++)C=C<<1|g,I==a-1?(I=0,A.push(m(C)),C=0):I++,g=0;for(g=w.charCodeAt(0),b=0;b<16;b++)C=C<<1|g&1,I==a-1?(I=0,A.push(m(C)),C=0):I++,g=g>>1}_--,_==0&&(_=Math.pow(2,k),k++),delete f[w]}else for(g=p[w],b=0;b<k;b++)C=C<<1|g&1,I==a-1?(I=0,A.push(m(C)),C=0):I++,g=g>>1;_--,_==0&&(_=Math.pow(2,k),k++)}for(g=2,b=0;b<k;b++)C=C<<1|g&1,I==a-1?(I=0,A.push(m(C)),C=0):I++,g=g>>1;for(;;)if(C=C<<1,I==a-1){A.push(m(C));break}else I++;return A.join("")},decompress:function(d){return d==null?"":d==""?null:r._decompress(d.length,32768,function(a){return d.charCodeAt(a)})},_decompress:function(d,a,m){var b=[],g,p=4,f=4,y=3,v="",w=[],_,S,k,A,C,I,E,M={val:m(0),position:a,index:1};for(_=0;_<3;_+=1)b[_]=_;for(k=0,C=Math.pow(2,2),I=1;I!=C;)A=M.val&M.position,M.position>>=1,M.position==0&&(M.position=a,M.val=m(M.index++)),k|=(A>0?1:0)*I,I<<=1;switch(g=k){case 0:for(k=0,C=Math.pow(2,8),I=1;I!=C;)A=M.val&M.position,M.position>>=1,M.position==0&&(M.position=a,M.val=m(M.index++)),k|=(A>0?1:0)*I,I<<=1;E=s(k);break;case 1:for(k=0,C=Math.pow(2,16),I=1;I!=C;)A=M.val&M.position,M.position>>=1,M.position==0&&(M.position=a,M.val=m(M.index++)),k|=(A>0?1:0)*I,I<<=1;E=s(k);break;case 2:return""}for(b[3]=E,S=E,w.push(E);;){if(M.index>d)return"";for(k=0,C=Math.pow(2,y),I=1;I!=C;)A=M.val&M.position,M.position>>=1,M.position==0&&(M.position=a,M.val=m(M.index++)),k|=(A>0?1:0)*I,I<<=1;switch(E=k){case 0:for(k=0,C=Math.pow(2,8),I=1;I!=C;)A=M.val&M.position,M.position>>=1,M.position==0&&(M.position=a,M.val=m(M.index++)),k|=(A>0?1:0)*I,I<<=1;b[f++]=s(k),E=f-1,p--;break;case 1:for(k=0,C=Math.pow(2,16),I=1;I!=C;)A=M.val&M.position,M.position>>=1,M.position==0&&(M.position=a,M.val=m(M.index++)),k|=(A>0?1:0)*I,I<<=1;b[f++]=s(k),E=f-1,p--;break;case 2:return w.join("")}if(p==0&&(p=Math.pow(2,y),y++),b[E])v=b[E];else if(E===f)v=S+S.charAt(0);else return null;w.push(v),b[f++]=S+v.charAt(0),p--,S=v,p==0&&(p=Math.pow(2,y),y++)}}};return r}();n!=null?n.exports=i:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return i})}(bn)),bn.exports}var qi=_a();const Ca="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20fill='none'%20viewBox='0%200%2084%2062'%3e%3crect%20width='64'%20height='48'%20x='18'%20y='2'%20fill='%23fff'%20stroke='%23999'%20stroke-width='3'%20rx='4'/%3e%3crect%20width='32'%20height='48'%20x='2'%20y='12'%20fill='%23fff'%20stroke='%23999'%20stroke-width='3'%20rx='4'/%3e%3cpath%20fill='%234169E1'%20d='M14%2052a4%204%200%201%201-8%200%204%204%200%200%201%208%200Zm64-42a4%204%200%201%201-8%200%204%204%200%200%201%208%200Z'/%3e%3c/svg%3e",Ia="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20fill='none'%20viewBox='0%200%2082%2062'%3e%3crect%20width='78'%20height='58'%20x='2'%20y='2'%20fill='%23999'%20fill-opacity='.3'%20stroke='%23999'%20stroke-width='3'%20rx='4'/%3e%3crect%20width='18'%20height='46'%20x='8'%20y='8'%20fill='%23fff'%20stroke='%23999'%20stroke-width='2'%20rx='1'/%3e%3crect%20width='18'%20height='46'%20x='32'%20y='8'%20fill='%23fff'%20stroke='%23999'%20stroke-width='2'%20rx='1'/%3e%3crect%20width='18'%20height='46'%20x='56'%20y='8'%20fill='%23fff'%20stroke='%23999'%20stroke-width='2'%20rx='1'/%3e%3c/svg%3e",Ta="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20fill='none'%20viewBox='0%200%2084%2062'%3e%3crect%20width='64'%20height='48'%20x='18'%20y='2'%20fill='%23fff'%20stroke='%23999'%20stroke-width='3'%20rx='4'/%3e%3cpath%20fill='%23999'%20fill-opacity='.3'%20d='M19%203h62v10H19z'/%3e%3cpath%20stroke='%234169E1'%20stroke-width='2'%20d='M43%208a2%202%200%201%201-4%200%202%202%200%200%201%204%200Z'/%3e%3cpath%20stroke='%23999'%20stroke-width='2'%20d='M52%208a2%202%200%201%201-4%200%202%202%200%200%201%204%200Zm9%200a2%202%200%201%201-4%200%202%202%200%200%201%204%200Z'/%3e%3crect%20width='32'%20height='48'%20x='2'%20y='12'%20fill='%23fff'%20stroke='%23999'%20stroke-width='3'%20rx='4'/%3e%3cpath%20fill='%23999'%20fill-opacity='.3'%20d='M3%2049h30v10H3z'/%3e%3cpath%20stroke='%234169E1'%20stroke-width='2'%20d='M11%2054a2%202%200%201%201-4%200%202%202%200%200%201%204%200Z'/%3e%3cpath%20stroke='%23999'%20stroke-width='2'%20d='M20%2054a2%202%200%201%201-4%200%202%202%200%200%201%204%200Zm9%200a2%202%200%201%201-4%200%202%202%200%200%201%204%200Z'/%3e%3c/svg%3e",Aa=200,xa=10;async function xn(){const{masto:n}=le(),i=n.v1.followedTags.list({limit:Aa}),s=[];let o=0;do{const{value:c,done:l}=await i.next();if(l||(c==null?void 0:c.length)===0)break;s.push(...c),o++}while(o<xa);return s.sort((c,l)=>c.name.localeCompare(l.name)),s.length&&setTimeout(()=>{ke.account.set("followedTags",{tags:s,updatedAt:Date.now()})},1),s}const Ea=24*60*60*1e3;async function Ra(){try{const{tags:n,updatedAt:i}=ke.account.get("followedTags")||{};return n!=null&&n.length?(Date.now()-i>Ea&&xn(),n):await xn()}catch{return[]}}const Yi=document.createElement("div"),La=n=>{if(!n)return[];if(n.indexOf("#")===-1)return[];Yi.innerHTML=n;const i=Yi.querySelectorAll("a.hashtag");return i.length?Array.from(i).map(s=>s.innerText.trim().replace(/^[^#]*#+/,"")):[]};function yn({children:n}){if(typeof n=="string")return n;const[i,s]=L("");return ne(()=>{Promise.resolve(n).then(s)},[n]),i}const _t=9,Ma=["following","mentions","notifications","list","public","trending","search","hashtag","bookmarks","favourites"],Ys={following:{id:"7ZJHdw"},notifications:{id:"iDNBZe"},list:{id:"h16FyT"},public:{id:"tXgQpk"},search:{id:"A1taO8"},"account-statuses":{id:"AeXO77"},bookmarks:{id:"7Ff7ia"},favourites:{id:"zZOZj7"},hashtag:{id:"GP8RLS"},trending:{id:"4/iCqx"},mentions:{id:"/bZzdR"}},vn={list:[{text:{id:"DUMt1y"},name:"id",notRequired:!0}],public:[{text:{id:"OgyJSr"},name:"local",type:"checkbox"},{text:{id:"kyAi7k"},name:"instance",type:"text",placeholder:{id:"7defFj"},notRequired:!0}],trending:[{text:{id:"kyAi7k"},name:"instance",type:"text",placeholder:{id:"7defFj"},notRequired:!0}],search:[{text:{id:"dmloPh"},name:"query",type:"text",placeholder:{id:"UHDQDE"},notRequired:!0}],"account-statuses":[{text:"@",name:"id",type:"text",placeholder:"cheeaun@mastodon.social"}],hashtag:[{text:"#",name:"hashtag",type:"text",placeholder:{id:"a6oTWs"},pattern:"[^#]+"},{text:{id:"eK4SL/"},name:"media",type:"checkbox"},{text:{id:"kyAi7k"},name:"instance",type:"text",placeholder:{id:"7defFj"},notRequired:!0}]},$a=gt(async({id:n})=>{const i=await le().masto.v1.accounts.$select(n).fetch();return i.username||i.acct||i.displayName}),En={following:{id:"home",title:(n,i)=>i===0?pe._({id:"i0qMbr"}):pe._({id:"following.title"}),path:"/",icon:"home"},mentions:{id:"mentions",title:{id:"/bZzdR"},path:"/mentions",icon:"at"},notifications:{id:"notifications",title:{id:"iDNBZe"},path:"/notifications",icon:"notification"},list:{id:({id:n})=>n?"list":"lists",title:({id:n})=>n?$c(n):pe._({id:"h16FyT"}),path:({id:n})=>n?`/l/${n}`:"/l",icon:"list",excludeViewMode:({id:n})=>n?[]:["multi-column"]},public:{id:"public",title:({local:n})=>n?pe._({id:"d5zxa4"}):pe._({id:"4ERYY7"}),subtitle:({instance:n})=>n||le().instance,path:({local:n,instance:i})=>`/${i}/p${n?"/l":""}`,icon:({local:n})=>n?"building":"earth"},trending:{id:"trending",title:{id:"4/iCqx"},subtitle:({instance:n})=>n||le().instance,path:({instance:n})=>`/${n}/trending`,icon:"chart"},search:{id:"search",title:({query:n})=>n?`“${n}”`:pe._({id:"A1taO8"}),path:({query:n})=>n?`/search?q=${encodeURIComponent(n)}&type=statuses`:"/search",icon:"search",excludeViewMode:({query:n})=>n?[]:["multi-column"]},"account-statuses":{id:"account-statuses",title:$a,path:({id:n})=>`/a/${n}`,icon:"user"},bookmarks:{id:"bookmarks",title:{id:"7Ff7ia"},path:"/b",icon:"bookmark"},favourites:{id:"favourites",title:{id:"zZOZj7"},path:"/f",icon:"heart"},hashtag:{id:"hashtag",title:({hashtag:n})=>n,subtitle:({instance:n})=>n||le().instance,path:({hashtag:n,instance:i,media:s})=>`${i?`/${i}`:""}/t/${n.split(/\s+/).join("+")}${s?"?media=1":""}`,icon:"hashtag"}};function Pa({onClose:n}){const{_:i}=de(),s=Ve(x),{shortcuts:o}=s,[c,l]=L(!1),[u,r]=L(!1),[d]=mi();return e("div",{id:"shortcuts-settings-container",class:"sheet",tabindex:"-1",children:[!!n&&e("button",{type:"button",class:"sheet-close",onClick:n,children:e(T,{icon:"x",alt:pe._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:[e(T,{icon:"shortcut"})," ",e(h,{id:"CTqTgr"})," ",e("sup",{style:{fontSize:12,opacity:.5,textTransform:"uppercase"},children:e(h,{id:"A1As8l"})})]})}),e("main",{children:[e("p",{children:e(h,{id:"CIHAsy"})}),e("div",{class:"shortcuts-view-mode",children:[{value:"float-button",label:pe._({id:"qwdOim"}),imgURL:Ca},{value:"tab-menu-bar",label:pe._({id:"UxBoCm"}),imgURL:Ta},{value:"multi-column",label:pe._({id:"uvDfdW"}),imgURL:Ia}].map(({value:a,label:m,imgURL:b})=>{const g=s.settings.shortcutsViewMode===a||a==="float-button"&&!s.settings.shortcutsViewMode;return e("label",{class:g?"checked":"",children:[e("input",{type:"radio",name:"shortcuts-view-mode",value:a,checked:g,onChange:p=>{x.settings.shortcutsViewMode=p.target.value}})," ",e("img",{src:b,alt:"",width:"80",height:"58"})," ",e("span",{children:m})]},a)})}),o.length>0?e(O,{children:[e("ol",{class:"shortcuts-list",ref:d,children:o.filter(Boolean).map((a,m)=>{const b=Object.values(a).join("-"),{type:g}=a;if(!En[g])return null;let{icon:p,title:f,subtitle:y,excludeViewMode:v}=En[g];typeof f=="function"?f=f(a,m):f=i(f),typeof y=="function"?y=y(a,m):y=i(y),typeof p=="function"&&(p=p(a,m)),typeof v=="function"&&(v=v(a,m));const w=v==null?void 0:v.includes(s.settings.shortcutsViewMode);return e("li",{children:[e(T,{icon:p}),e("span",{class:"shortcut-text",children:[e(yn,{children:f}),y&&e(O,{children:[" ",e("small",{class:"ib insignificant",children:y})]}),w&&e("span",{class:"tag",children:e(h,{id:"5KJFnN"})})]}),e("span",{class:"shortcut-actions",children:[e("button",{type:"button",class:"plain small",disabled:m===0,onClick:()=>{const _=Array.from(x.shortcuts);if(m>0){const S=x.shortcuts[m-1];_[m-1]=a,_[m]=S,x.shortcuts=_}},children:e(T,{icon:"arrow-up",alt:pe._({id:"QyioBP"})})}),e("button",{type:"button",class:"plain small",disabled:m===o.length-1,onClick:()=>{const _=Array.from(x.shortcuts);if(m<x.shortcuts.length-1){const S=x.shortcuts[m+1];_[m+1]=a,_[m]=S,x.shortcuts=_}},children:e(T,{icon:"arrow-down",alt:pe._({id:"3Ib6FN"})})}),e("button",{type:"button",class:"plain small",onClick:()=>{l({shortcut:a,shortcutIndex:m})},children:e(T,{icon:"pencil",alt:pe._({id:"ePK91l"})})})]})]},b)})}),o.length===1&&s.settings.shortcutsViewMode!=="float-button"&&e("div",{class:"ui-state insignificant",children:[e(T,{icon:"info"})," ",e("small",{children:e(h,{id:"3Xq4Zi"})})]})]}):e("div",{class:"ui-state insignificant",children:[e("p",{children:s.settings.shortcutsViewMode==="multi-column"?pe._({id:"3xIN+E"}):pe._({id:"vLxvHT"})}),e("p",{children:e(h,{id:"Fq4zw3",components:{0:e("br",{}),1:e("a",{href:"#",onClick:a=>{a.preventDefault(),x.shortcuts=[{type:"following"},{type:"notifications"}]}})}})})]}),e("p",{class:"insignificant",children:o.length>=_t&&(s.settings.shortcutsViewMode==="multi-column"?pe._({id:"RqXfsz",values:{SHORTCUTS_LIMIT:_t}}):pe._({id:"EVRO/o",values:{SHORTCUTS_LIMIT:_t}}))}),e("p",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e("button",{type:"button",class:"light",onClick:()=>r(!0),children:e(h,{id:"bgVLbt"})}),e("button",{type:"button",disabled:o.length>=_t,onClick:()=>l(!0),children:[e(T,{icon:"plus"})," ",e("span",{children:s.settings.shortcutsViewMode==="multi-column"?pe._({id:"Vh3ADI"}):pe._({id:"9tmn6W"})})]})]})]}),c&&e(qe,{onClick:a=>{a.target===a.currentTarget&&l(!1)},children:e(Na,{shortcut:c.shortcut,shortcutIndex:c.shortcutIndex,onSubmit:({result:a,mode:m})=>{m==="edit"?x.shortcuts[c.shortcutIndex]=a:x.shortcuts.push(a)},onClose:()=>l(!1)})}),u&&e(qe,{onClick:a=>{a.target===a.currentTarget&&r(!1)},children:e(Da,{shortcuts:o,onClose:()=>r(!1)})})]})}const ji={list:{id:"1qL+L+"},search:{id:"dmTmkQ"},hashtag:{id:"E8laYz"}};function Na({onSubmit:n,disabled:i,shortcut:s,shortcutIndex:o,onClose:c}){var v,w;const{_:l}=de(),u=!!s,[r,d]=L((s==null?void 0:s.type)||null),[a,m]=L("default"),[b,g]=L([]),[p,f]=L([]);ne(()=>{(async()=>{if(r==="list")try{m("loading");const _=await rn();g(_),m("default")}catch{m("error")}})(),(async()=>{if(r==="hashtag")try{const _=await xn();f(_)}catch{}})()},[r]);const y=q();return ne(()=>{if(u&&r&&vn[r]){const _=y.current;vn[r].forEach(({name:S,type:k})=>{const A=_.querySelector(`[name="${S}"]`);A&&s[S]&&(k==="checkbox"?A.checked=s[S]==="on":A.value=s[S])})}},[u,r]),e("div",{id:"shortcut-settings-form",class:"sheet",children:[!!c&&e("button",{type:"button",class:"sheet-close",onClick:c,children:e(T,{icon:"x",alt:pe._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:u?pe._({id:"pe1jog"}):pe._({id:"Lsxpe5"})})}),e("main",{tabindex:"-1",children:e("form",{ref:y,onSubmit:_=>{_.preventDefault();const S=new FormData(_.target),k={};S.forEach((A,C)=>{k[C]=A==null?void 0:A.trim(),C==="instance"&&(k[C]=k[C].replace(/^https?:\/\//,"").replace(/\/+$/,""),k[C]=k[C].replace(/^@?[^@]+@/,""))}),k.type&&(n({result:k,mode:u?"edit":"add"}),_.target.reset(),d(null),c==null||c())},children:[e("p",{children:e("label",{children:[e("span",{children:e(h,{id:"cklVjM"})}),e("select",{required:!0,disabled:i,onChange:_=>{d(_.target.value)},defaultValue:u?s.type:void 0,name:"type",dir:"auto",children:[e("option",{}),Ma.map(_=>e("option",{value:_,children:l(Ys[_])}))]})]})}),(w=(v=vn[r])==null?void 0:v.map)==null?void 0:w.call(v,({text:_,name:S,type:k,placeholder:A,pattern:C,notRequired:I})=>r==="list"?e("p",{children:e("label",{children:[e("span",{children:e(h,{id:"2BBAbc"})}),e("select",{name:"id",required:!I,disabled:i||a==="loading",defaultValue:u?s.id:void 0,dir:"auto",children:[e("option",{value:""}),b.map(E=>e("option",{value:E.id,children:E.title}))]})]})}):e("p",{children:e("label",{children:[e("span",{children:l(_)})," ",e("input",{type:k,switch:k==="checkbox"||void 0,name:S,placeholder:l(A),required:k==="text"&&!I,disabled:i,list:r==="hashtag"?"followed-hashtags-datalist":null,autocorrect:"off",autocapitalize:"off",spellCheck:!1,pattern:C,dir:"auto"}),r==="hashtag"&&p.length>0&&e("datalist",{id:"followed-hashtags-datalist",children:p.map(E=>e("option",{value:E.name}))})]})})),!!ji[r]&&e("p",{class:"form-note insignificant",children:[e(T,{icon:"info"}),l(ji[r])]}),e("footer",{children:[e("button",{type:"submit",class:"block",disabled:i||a==="loading",children:u?pe._({id:"tfDRzk"}):pe._({id:"m16xKo"})}),u&&e("button",{type:"button",class:"light danger",onClick:()=>{x.shortcuts.splice(o,1),c==null||c()},children:e(h,{id:"t/YqKh"})})]})]})})]})}function Da({shortcuts:n,onClose:i}){var g;const{_:s}=de(),{masto:o}=le(),c=Ce(()=>!n||!n.filter(Boolean).length?"":qi.compressToEncodedURIComponent(JSON.stringify(n.filter(Boolean))),[n]),[l,u]=L(""),[r,d]=L("default"),a=Ce(()=>{if(!l)return d("default"),null;try{const p=JSON.parse(qi.decompressFromEncodedURIComponent(l));if(!Array.isArray(p))throw new Error("Not an array");return d("default"),p}catch{try{const f=JSON.parse(l);if(!Array.isArray(f))throw new Error("Not an array");return d("default"),f}catch{return d("error"),null}}},[l]),m=x.shortcuts.length>0,b=q();return e("div",{id:"import-export-container",class:"sheet",children:[!!i&&e("button",{type:"button",class:"sheet-close",onClick:i,children:e(T,{icon:"x",alt:pe._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(h,{id:"OOa7/5",components:{0:e("small",{class:"ib insignificant"})}})})}),e("main",{tabindex:"-1",children:[e("section",{children:[e("h3",{children:[e(T,{icon:"arrow-down-circle",size:"l",class:"insignificant"})," ",e("span",{children:e(h,{id:"l3s5ri"})})]}),e("p",{class:"field-button",children:[e("input",{ref:b,type:"text",name:"import",placeholder:pe._({id:"tBmklN"}),class:"block",onInput:p=>{u(p.target.value)},dir:"auto"}),x.settings.shortcutSettingsCloudImportExport&&e("button",{type:"button",class:"plain2 small",disabled:r==="cloud-downloading",onClick:async()=>{d("cloud-downloading");const p=vt();me(pe._({id:"HLqLGx"}));try{const y=(await o.v1.accounts.relationships.fetch({id:[p]}))[0];if(y){const{note:v=""}=y;if(/<phanpy-shortcuts-settings>(.*)<\/phanpy-shortcuts-settings>/.test(v)){const w=v.match(/<phanpy-shortcuts-settings>(.*)<\/phanpy-shortcuts-settings>/)[1],{v:_,dt:S,data:k}=JSON.parse(w);b.current.value=k,b.current.dispatchEvent(new Event("input"))}}d("default")}catch{d("error"),me(pe._({id:"gCDfX+"}))}},title:pe._({id:"B6cG3J"}),children:[e(T,{icon:"cloud"}),e(T,{icon:"arrow-down"})]})]}),!!a&&Array.isArray(a)&&e(O,{children:[e("p",{children:[e("b",{children:a.length})," shortcut",a.length>1?"s":""," ",e("small",{class:"insignificant",children:["(",l.length," characters)"]})]}),e("ol",{class:"import-settings-list",children:a.map(p=>{var f,y;return e("li",{children:[e("span",{style:{opacity:n.some(v=>Object.keys(v).every(w=>v[w]===p[w]))?1:0},children:"*"}),e("span",{children:[s(Ys[p.type]),p.type==="list"&&" ⚠️"," ",(y=(f=vn[p.type])==null?void 0:f.map)==null?void 0:y.call(f,({text:v,name:w,type:_})=>p[w]?e(O,{children:[e("span",{class:"tag collapsed insignificant",children:[v,":"," ",_==="checkbox"?p[w]==="on"?"✅":"❌":p[w]]})," "]}):null)]})]})})}),e("p",{children:[e("small",{children:e(h,{id:"o6sElH"})}),e("br",{}),e("small",{children:["⚠️"," ",e(h,{id:"N4z4P/"})]})]})]}),r==="error"&&e("p",{class:"error",children:e("small",{children:["⚠️ ",e(h,{id:"ZhsPEb"})]})}),e("p",{children:[m&&e(O,{children:[e(ut,{confirmLabel:pe._({id:"6MzUUU"}),menuFooter:e("div",{class:"footer",children:e(h,{id:"nl8sCE"})}),onClick:()=>{const p=a.filter(v=>!x.shortcuts.some(w=>Object.keys(w).every(_=>w[_]===v[_])));if(!p.length){me(pe._({id:"o6L30P"}));return}let f=[...x.shortcuts,...p];const y=f.length>_t;y&&(f=f.slice(0,_t)),x.shortcuts=f,me(y?pe._({id:"SBmqmC",values:{SHORTCUTS_LIMIT:_t}}):pe._({id:"QO9uTx"})),i==null||i()},children:e("button",{type:"button",class:"plain2",disabled:!a,children:e(h,{id:"c89gCv"})})})," "]}),e(ut,{confirmLabel:m?pe._({id:"6ZjzWP"}):pe._({id:"DWumLi"}),menuItemClassName:m?"danger":void 0,onClick:()=>{x.shortcuts=a,me(pe._({id:"QO9uTx"})),i==null||i()},children:e("button",{type:"button",class:"plain2",disabled:!a,children:m?pe._({id:"uIp8WL"}):pe._({id:"Sjnlwj"})})})]})]}),e("section",{children:[e("h3",{children:[e(T,{icon:"arrow-up-circle",size:"l",class:"insignificant"})," ",e("span",{children:e(h,{id:"GS+Mus"})})]}),e("p",{children:e("input",{style:{width:"100%"},type:"text",value:c,readOnly:!0,onClick:p=>{if(p.target.value){p.target.select();try{navigator.clipboard.writeText(p.target.value),me(pe._({id:"cWtH+v"}))}catch{me(pe._({id:"yUWyHa"}))}}},dir:"auto"})}),e("p",{children:[e("button",{type:"button",class:"plain2",disabled:!c,onClick:()=>{try{navigator.clipboard.writeText(c),me(pe._({id:"+Kq2vY"}))}catch{me(pe._({id:"tFvxZF"}))}},children:[e(T,{icon:"clipboard"})," ",e("span",{children:e(h,{id:"he3ygx"})})]})," ",(navigator==null?void 0:navigator.share)&&((g=navigator==null?void 0:navigator.canShare)==null?void 0:g.call(navigator,{text:c}))&&e("button",{type:"button",class:"plain2",disabled:!c,onClick:()=>{try{navigator.share({text:c})}catch{alert(pe._({id:"TtG3Uh"}))}},children:[e(T,{icon:"share"})," ",e("span",{children:e(h,{id:"Z8lGw6"})})]})," ",x.settings.shortcutSettingsCloudImportExport&&e("button",{type:"button",class:"plain2",disabled:r==="cloud-uploading",onClick:async()=>{d("cloud-uploading");const p=vt();try{const y=(await o.v1.accounts.relationships.fetch({id:[p]}))[0];if(y){const{note:v=""}=y;let w="";const _=JSON.stringify({v:"1",dt:Date.now(),data:c});/<phanpy-shortcuts-settings>(.*)<\/phanpy-shortcuts-settings>/.test(v)?w=v.replace(/<phanpy-shortcuts-settings>(.*)<\/phanpy-shortcuts-settings>/,`<phanpy-shortcuts-settings>${_}</phanpy-shortcuts-settings>`):w=`${v}


<phanpy-shortcuts-settings>${_}</phanpy-shortcuts-settings>`,me(pe._({id:"9ZYiLz"})),await o.v1.accounts.$select(p).note.create({comment:w}),d("default"),me(pe._({id:"5w02SH"}))}}catch{d("error"),me(pe._({id:"aVsTYo"}))}},title:pe._({id:"gWd6Cu"}),children:[e(T,{icon:"cloud"}),e(T,{icon:"arrow-up"})]})," ",c.length>0&&e("small",{class:"insignificant ib",children:e(h,{id:"IPXOXm",values:{0:c.length}})})]}),!!c&&e("details",{children:[e("summary",{class:"insignificant",children:e("small",{children:e(h,{id:"e5E+WH"})})}),e("textarea",{style:{width:"100%"},rows:10,readOnly:!0,children:JSON.stringify(n.filter(Boolean),null,2)})]})]}),x.settings.shortcutSettingsCloudImportExport&&e("footer",{children:e("p",{children:[e(T,{icon:"cloud"})," ",e(h,{id:"C4T6O/"})]})})]})]})}fs(x,n=>{for(const[i,s,o,c]of n)/^show/i.test(s)&&!o&&Xn()});function Oa(){var c,l,u,r,d,a,m,b;const{_:n}=de(),i=Ve(x),s=ps(),o=Zt();return ne(()=>{setTimeout(vo,1e3)},[]),e(O,{children:[!!i.showCompose&&e(qe,{class:`solid ${i.composerState.minimized?"min":""}`,minimized:!!i.composerState.minimized,children:e(wo,{replyToStatus:typeof i.showCompose!="boolean"?i.showCompose.replyToStatus:((c=window.__COMPOSE__)==null?void 0:c.replyToStatus)||null,editStatus:((l=x.showCompose)==null?void 0:l.editStatus)||((u=window.__COMPOSE__)==null?void 0:u.editStatus)||null,draftStatus:((r=x.showCompose)==null?void 0:r.draftStatus)||((d=window.__COMPOSE__)==null?void 0:d.draftStatus)||null,onClose:g=>{const{newStatus:p,instance:f,type:y,scheduledAt:v}=g||{};x.showCompose=!1,window.__COMPOSE__=null,p&&(x.reloadStatusPage++,v&&x.reloadScheduledPosts++,me({text:{post:n(v?{id:"IrX0sj"}:{id:"aTyHBW"}),reply:n(v?{id:"+38pse"}:{id:"lZdBKl"}),edit:n({id:"a5BN7l"})}[y||"post"],delay:1e3,duration:1e4,onClick:w=>{w.hideToast(),x.prevLocation=o,s(v?"/sp":f?`/${f}/s/${p.id}`:`/s/${p.id}`)}}))}})}),!!i.showSettings&&e(qe,{onClose:()=>{x.showSettings=!1},children:e(Ec,{onClose:()=>{x.showSettings=!1}})}),!!i.showAccounts&&e(qe,{onClose:()=>{x.showAccounts=!1},children:e(yc,{onClose:()=>{x.showAccounts=!1}})}),!!i.showAccount&&e(qe,{onClose:()=>{x.showAccount=!1},children:e(Qc,{account:((a=i.showAccount)==null?void 0:a.account)||i.showAccount,instance:(m=i.showAccount)==null?void 0:m.instance,onClose:({destination:g}={})=>{x.showAccount=!1}})}),!!i.showDrafts&&e(qe,{onClose:()=>{x.showDrafts=!1},children:e(ea,{onClose:()=>x.showDrafts=!1})}),!!i.showMediaModal&&e(qe,{onClick:g=>{(g.target===g.currentTarget||g.target.classList.contains("media"))&&(x.showMediaModal=!1)},children:e(qs,{mediaAttachments:i.showMediaModal.mediaAttachments,instance:i.showMediaModal.instance,index:i.showMediaModal.index,statusID:i.showMediaModal.statusID,onClose:()=>{x.showMediaModal=!1}})}),!!i.showShortcutsSettings&&e(qe,{onClose:()=>{x.showShortcutsSettings=!1},children:e(Pa,{onClose:()=>x.showShortcutsSettings=!1})}),!!i.showGenericAccounts&&e(qe,{onClose:()=>{x.showGenericAccounts=!1},children:e(ia,{instance:i.showGenericAccounts.instance,excludeRelationshipAttrs:i.showGenericAccounts.excludeRelationshipAttrs,postID:i.showGenericAccounts.postID,onClose:()=>x.showGenericAccounts=!1,blankCopy:i.showGenericAccounts.blankCopy})}),!!i.showMediaAlt&&e(qe,{onClose:g=>{x.showMediaAlt=!1},children:e(sa,{alt:i.showMediaAlt.alt||i.showMediaAlt,lang:(b=i.showMediaAlt)==null?void 0:b.lang,onClose:()=>{x.showMediaAlt=!1}})}),!!i.showEmbedModal&&e(qe,{class:"solid",onClose:()=>{x.showEmbedModal=!1},children:e(na,{html:i.showEmbedModal.html,url:i.showEmbedModal.url,width:i.showEmbedModal.width,height:i.showEmbedModal.height,onClose:()=>{x.showEmbedModal=!1}})}),!!i.showReportModal&&e(qe,{onClose:()=>{x.showReportModal=!1},children:e(Sa,{account:i.showReportModal.account,post:i.showReportModal.post,onClose:()=>{x.showReportModal=!1}})})]})}function Qn({accountID:n,onChange:i}){const{_:s}=de(),{masto:o}=le(),[c,l]=L("default"),[u,r]=L(null),[d,a]=L(null),m=d!==null;return e("p",{class:"follow-request-buttons",children:[e("button",{type:"button",disabled:c==="loading"||m,onClick:()=>{l("loading"),r("accept"),(async()=>{try{const b=await o.v1.followRequests.$select(n).authorize();if(!(b!=null&&b.followedBy))throw new Error("Follow request not accepted");a(b),i()}catch{}l("default")})()},children:e(h,{id:"g3UF2V"})})," ",e("button",{type:"button",disabled:c==="loading"||m,class:"light danger",onClick:()=>{l("loading"),r("reject"),(async()=>{try{const b=await o.v1.followRequests.$select(n).reject();if(b!=null&&b.followedBy)throw new Error("Follow request not rejected");a(b),i()}catch{l("default")}})()},children:e(h,{id:"1t/NnN"})}),e("span",{class:"follow-request-states",children:m&&u?u==="accept"?e(T,{icon:"check-circle",alt:s({id:"bzMKg7"}),class:"follow-accepted"}):e(T,{icon:"x-circle",alt:s({id:"ekCRTP"}),class:"follow-rejected"}):e(Fe,{hidden:c!=="loading"})})]})}const Vi={mention:"comment",status:"notification",reblog:"rocket",follow:"follow",follow_request:"follow-add",favourite:"heart",poll:"poll",update:"pencil","admin.signup":"account-edit","admin.report":"account-warning",severed_relationships:"heart-break",moderation_warning:"alert",emoji_reaction:"emoji2","pleroma:emoji_reaction":"emoji2",annual_report:"celebrate"};function Gi({account:n,emoji:i,emoji_url:s}){let o,c;typeof s=="string"?o=s:(o=s==null?void 0:s.url,c=s==null?void 0:s.staticUrl);const l=o?e(Uo,{url:o,staticUrl:c,alt:i}):i;return e(h,{id:"i5uN6K",values:{account:n,emojiObject:l}})}const qn={status:({account:n})=>e(h,{id:"idiIxW",values:{account:n}}),reblog:({count:n,account:i,postsCount:s,postType:o,components:{Subject:c}})=>e(h,{id:"jkt9P5",values:{0:Xe(n),1:Xe(n),count:n,postsCount:s,postType:o,account:i},components:{0:e(c,{clickable:n>1}),1:e("span",{title:n}),2:e(c,{clickable:n>1}),3:e("span",{title:n})}}),follow:({account:n,count:i,components:{Subject:s}})=>e(h,{id:"+71G9C",values:{0:Xe(i),count:i,account:n},components:{0:e(s,{clickable:i>1}),1:e("span",{title:i})}}),follow_request:({account:n})=>e(h,{id:"eh6NHW",values:{account:n}}),favourite:({account:n,count:i,postsCount:s,postType:o,components:{Subject:c}})=>e(h,{id:"RqX1mR",values:{0:Xe(i),1:Xe(i),count:i,postsCount:s,postType:o,account:n},components:{0:e(c,{clickable:i>1}),1:e("span",{title:i}),2:e(c,{clickable:i>1}),3:e("span",{title:i})}}),poll:()=>pe._({id:"kIlJaS"}),"poll-self":()=>pe._({id:"kpjzdN"}),"poll-voted":()=>pe._({id:"moT7M8"}),update:()=>pe._({id:"uzt17m"}),"favourite+reblog":({count:n,account:i,postsCount:s,postType:o,components:{Subject:c}})=>e(h,{id:"NunZZQ",values:{0:Xe(n),1:Xe(n),count:n,postsCount:s,postType:o,account:i},components:{0:e(c,{clickable:n>1}),1:e("span",{title:n}),2:e(c,{clickable:n>1}),3:e("span",{title:n})}}),"admin.sign_up":({account:n})=>e(h,{id:"fJCCpx",values:{account:n}}),"admin.report":({account:n,targetAccount:i})=>e(h,{id:"eNfCmq",values:{account:n,targetAccount:i}}),severed_relationships:({name:n})=>e(h,{id:"Xl9v6+",values:{name:n},components:{0:e("i",{})}}),moderation_warning:()=>e("b",{children:e(h,{id:"YqffEv"})}),emoji_reaction:Gi,"pleroma:emoji_reaction":Gi,annual_report:({year:n})=>e(h,{id:"INLTzH",values:{year:n}})},za={account_suspension:({from:n,targetName:i})=>e(h,{id:"uRkcgw",values:{from:n,targetName:i},components:{0:e("i",{}),1:e("i",{})}}),domain_block:({from:n,targetName:i,followersCount:s,followingCount:o})=>e(h,{id:"Q3yArs",values:{from:n,targetName:i,followersCount:s,followingCount:o},components:{0:e("i",{}),1:e("i",{})}}),user_domain_block:({targetName:n,followersCount:i,followingCount:s})=>e(h,{id:"RQKWUa",values:{targetName:n,followersCount:i,followingCount:s},components:{0:e("i",{})}})},Ua={none:{id:"ipnHrn"},disable:{id:"jw0eSZ"},mark_statuses_as_sensitive:{id:"v9jO+F"},delete_statuses:{id:"raUMBQ"},sensitive:{id:"w2OpMr"},silence:{id:"mlycBx"},suspend:{id:"Fz4lZ1"}},Yn=30;function Fa({notification:n,instance:i,isStatic:s,disableContextMenu:o}){var F,Y,G,te,ae,ve,_e;const{_:c}=de(),{masto:l}=le(),{id:u,status:r,account:d,report:a,event:m,moderation_warning:b,annualReport:g,_ids:p,_accounts:f,_statuses:y,_groupKeys:v,sampleAccounts:w,notificationsCount:_,groupKey:S}=n;let{type:k}=n;if(k==="mention"&&!r)return null;const A=(r==null?void 0:r.reblog)||r,C=A==null?void 0:A.id,I=vt(),E=I===(d==null?void 0:d.id),M=(F=r==null?void 0:r.poll)==null?void 0:F.voted,z=!!(r!=null&&r.inReplyToAccountId)&&(r==null?void 0:r.inReplyToAccountId)!==I&&((Y=r==null?void 0:r.account)==null?void 0:Y.id)===I;let P=0,W=0;if(k==="favourite+reblog"){if(f)for(const j of f)(G=j._types)!=null&&G.includes("favourite")&&P++,(te=j._types)!=null&&te.includes("reblog")&&W++;!W&&P&&(k="favourite"),!P&&W&&(k="reblog")}let ee;k==="poll"?ee=qn[E?"poll-self":M?"poll-voted":"poll"]:qn[k]?ee=qn[k]:ee=pe._({id:"ODqZt1",values:{type:k}});const Z=({clickable:j,...he})=>j?e("b",{tabIndex:"0",onClick:B,...he}):e("b",{...he});if(typeof ee=="function"){const j=(f==null?void 0:f.length)||(w==null?void 0:w.length)||(d?1:0),he=(y==null?void 0:y.length)||(r?1:0);if(k==="admin.report"){const Ae=a==null?void 0:a.targetAccount;Ae&&(ee=ee({account:e(mt,{account:d,showAvatar:!0}),targetAccount:e(mt,{account:Ae,showAvatar:!0})}))}else if(k==="severed_relationships"){const Ae=m==null?void 0:m.targetName;Ae&&(ee=ee({name:Ae}))}else if((k==="emoji_reaction"||k==="pleroma:emoji_reaction")&&n.emoji){const Ae=n.emoji_url||((ve=(ae=r==null?void 0:r.emojis)==null?void 0:ae.find)==null?void 0:ve.call(ae,Pe=>(Pe==null?void 0:Pe.shortcode)===n.emoji.replace(/^:/,"").replace(/:$/,"")));ee=ee({account:e(mt,{account:d,showAvatar:!0}),emoji:n.emoji,emojiURL:Ae})}else k==="annual_report"?ee=ee({...n.annualReport}):ee=ee({account:d?e(mt,{account:d,showAvatar:!0}):(w==null?void 0:w[0])&&e(mt,{account:w[0],showAvatar:!0}),count:j,postsCount:he,postType:z?"reply":"post",components:{Subject:Z}})}const V=n.createdAt&&new Date(n.createdAt).toLocaleString(),U={"favourite+reblog":pe._({id:"+XOeb+"}),favourite:pe._({id:"LQFF6J"}),reblog:pe._({id:"phQpSa"}),follow:pe._({id:"Ih01jh"})}[k]||pe._({id:"bPwFdf"}),B=()=>{x.showGenericAccounts={heading:U,accounts:f,showReactions:k==="favourite+reblog",excludeRelationshipAttrs:k==="follow"?["followedBy"]:[],postID:at(C,i)}},$=_>0&&_>(w==null?void 0:w.length)?"remote":"local";if(r!=null&&r.filtered){const j=((_e=r==null?void 0:r.account)==null?void 0:_e.id)===I,he=jt(r.filtered,"notifications");if(!E&&!j&&(he==null?void 0:he.action)==="hide")return null}return e("div",{class:`notification notification-${k}`,"data-notification-id":p||u,"data-group-key":(v==null?void 0:v.join(" "))||S,tabIndex:"0",children:[e("div",{class:`notification-type notification-${k}`,title:V,children:k==="favourite+reblog"?e(O,{children:[e(T,{icon:"rocket",size:"xl",alt:k,class:"reblog-icon"}),e(T,{icon:"heart",size:"xl",alt:k,class:"favourite-icon"})]}):e(T,{icon:Vi[k]||"notification",size:"xl",alt:k})}),e("div",{class:"notification-content",children:[k!=="mention"&&e(O,{children:[e("p",{children:ee}),k==="follow_request"&&e(Qn,{accountID:d.id}),k==="severed_relationships"&&e("div",{children:[za[m.type]({from:i,...m}),e("br",{}),e("a",{href:`https://${i}/severed_relationships`,target:"_blank",rel:"noopener",children:e(h,{id:"YL6Y8P",components:{0:e(T,{icon:"external",size:"s"})}})}),"."]}),k==="moderation_warning"&&!!b&&e("div",{children:[c(Ua[b.action]()),e("br",{}),e("a",{href:`/disputes/strikes/${b.id}`,target:"_blank",rel:"noopener",children:e(h,{id:"YL6Y8P",components:{0:e(T,{icon:"external",size:"s"})}})})]}),k==="annual_report"&&e("div",{children:e(be,{to:`/annual_report/${g==null?void 0:g.year}`,children:e(h,{id:"5PGPvG"})})})]}),(f==null?void 0:f.length)>1&&e("p",{class:"avatars-stack",children:[f.slice(0,Yn).map(j=>e(O,{children:[e("a",{href:j.url,rel:"noopener",class:"account-avatar-stack",onClick:he=>{he.preventDefault(),x.showAccount=j},children:[e(ft,{url:j.avatarStatic,size:f.length<=10?"xxl":f.length<20?"xl":"l",alt:`${j.displayName} @${j.acct}`,squircle:j==null?void 0:j.bot},j.id),k==="favourite+reblog"&&e("div",{class:"account-sub-icons",children:j._types.map(he=>e(T,{icon:Vi[he],size:"s",class:`${he}-icon`}))})]},j.id)," "]},j.id)),k==="favourite+reblog"&&$==="remote"?e("button",{type:"button",class:"small plain","data-group-keys":v==null?void 0:v.join(" "),onClick:()=>{x.showGenericAccounts={heading:U,fetchAccounts:async()=>{const j=await Promise.allSettled(v.map(async Ae=>{const Pe=l.v2.notifications.$select(Ae).accounts.list();return[Ae,(await Pe.next()).value]})),he=[];for(const Ae of j){const[Pe,Ne]=Ae.value,Ue=/^favourite/.test(Pe)?"favourite":/^reblog/.test(Pe)?"reblog":null;if(Ue)for(const Re of Ne){const Le=he.find(X=>X.id===Re.id);Le?Le._types.push(Ue):(Re._types=[Ue],he.push(Re))}}return{done:!0,value:he}},showReactions:!0,postID:at(C,i)}},children:e(T,{icon:"chevron-down"})}):e("button",{type:"button",class:"small plain",onClick:B,children:[f.length>Yn&&`+${f.length-Yn}`,e(T,{icon:"chevron-down"})]})]}),!(f!=null&&f.length)&&(w==null?void 0:w.length)>1&&e("p",{class:"avatars-stack",children:[w.map(j=>e(O,{children:[e("a",{href:j.url,rel:"noopener",class:"account-avatar-stack",onClick:he=>{he.preventDefault(),x.showAccount=j},children:e(ft,{url:j.avatarStatic,size:"xxl",alt:`${j.displayName} @${j.acct}`,squircle:j==null?void 0:j.bot},j.id)},j.id)," "]},j.id)),_>w.length&&e(be,{to:i?`/${i}/s/${r.id}`:`/s/${r.id}`,class:"button small plain centered",children:["+",_-w.length,e(T,{icon:"chevron-right"})]})]}),(y==null?void 0:y.length)>1&&e("ul",{class:"notification-group-statuses",children:y.map(j=>e("li",{children:e(Ki,{class:`status-link status-type-${k}`,to:i?`/${i}/s/${j.id}`:`/s/${j.id}`,children:e(je,{status:j,size:"s",previewMode:!0,allowContextMenu:!0})})},j.id))}),r&&(!(y!=null&&y.length)||(y==null?void 0:y.length)<=1)&&e(Ki,{class:`status-link status-type-${k}`,to:i?`/${i}/s/${C}`:`/s/${C}`,onContextMenu:o?void 0:j=>{const he=j.target.querySelector(".status");if(he){if(j.metaKey)return;j.preventDefault(),he.dispatchEvent(new MouseEvent("contextmenu",{clientX:j.clientX,clientY:j.clientY}))}},children:s?e(je,{status:A,size:"s",readOnly:!0,allowContextMenu:!0}):e(je,{statusID:C,size:"s",readOnly:!0,allowContextMenu:!0})})]})]})}function Ki(n){const i=Fo();return e(be,{...n,"data-read-more":pe._({id:"8fZueG"}),ref:i})}const an=rt(Fa,(n,i)=>{var s,o;return((s=n.notification)==null?void 0:s.id)===((o=i.notification)==null?void 0:o.id)});"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",n=>{const{type:i,id:s,accessToken:o}=(n==null?void 0:n.data)||{};i==="notification"&&(x.routeNotification={id:s,accessToken:o})});const Ba=rt(function(){const{_:i}=de();if(!("serviceWorker"in navigator))return null;const s=Ve(x),{routeNotification:o}=s,{id:c,accessToken:l}=o||{},[u,r]=L(!1);wt(()=>{if(!c||!l)return;const{instance:a}=le(),{masto:m,instance:b}=le({accessToken:l}),g=a===b,p=l?ko(l):si();(async()=>{const f=await m.v1.notifications.$select(c).fetch();if(f&&p){const y=p.instanceURL,{type:v,status:w,account:_}=f,S=!!document.querySelector("#modal-container > *"),k=v==="follow"&&!!(_!=null&&_.id),A=!!(_!=null&&_.id),C=!!(w!=null&&w.id);k&&g?x.showAccount={account:_,instance:y}:S||!g||A&&C?r({id:c,account:p,notification:f,sameInstance:g}):C?location.hash=`/${a}/s/${w.id}`:k?location.hash=`/${a}/a/${_.id}`:location.hash="/notifications"}})()},[c,l]),wt(()=>{navigator!=null&&navigator.clearAppBadge&&navigator.clearAppBadge()},[]),Vt(a=>{a&&(navigator!=null&&navigator.clearAppBadge)&&navigator.clearAppBadge()});const d=()=>{r(!1),x.routeNotification=null,/\/notifications\?id=/i.test(location.hash)&&(location.hash="/notifications")};if(u){const{id:a,account:m,notification:b,sameInstance:g}=u;return e(qe,{onClick:p=>{p.target===p.currentTarget&&d()},children:e("div",{class:"sheet",tabIndex:"-1",children:[e("button",{type:"button",class:"sheet-close",onClick:d,children:e(T,{icon:"x",alt:i({id:"yz7wBu"})})}),e("header",{children:e("b",{children:e(h,{id:"5+87Pq"})})}),e("main",{children:[!g&&e("p",{children:e(h,{id:"k9N0Xk"})}),e("div",{class:"notification-peek",onClick:p=>{const{target:f}=p;(p.target.tagName==="BUTTON"||p.target.tagName==="A")&&d()},children:e(an,{instance:m.instanceURL,notification:b,isStatic:!0})}),e("div",{style:{textAlign:"end"},children:e(be,{to:"/notifications",class:"button light",onClick:d,children:[e("span",{children:e(h,{id:"/WA/tl"})})," ",e(T,{icon:"arrow-right"})]})})]})]})})}return null}),js=So((n,i)=>{const{_:s}=de(),{instance:o}=le(),[c,l]=bt(),[u,r]=L(!1),[d,a]=L(c.get("q")||""),m=c.get("type"),b=q(null),g=q(null);return _o(i,()=>({setValue:p=>{a(p)},focus:()=>{g.current.focus()},select:()=>{g.current.select()},blur:()=>{g.current.blur()}})),e("form",{ref:b,class:"search-popover-container",onSubmit:p=>{var y;if(p.preventDefault(),/\/search/.test(location.hash))if(d){const v={q:d};m&&(v.type=m),l(v)}else l({});else d?location.hash=`/search?q=${encodeURIComponent(d)}${m?`&type=${m}`:""}`:location.hash="/search";(y=n==null?void 0:n.onSubmit)==null||y.call(n,p)},children:[e("input",{ref:g,value:d,name:"q",type:"search",placeholder:s({id:"A1taO8"}),dir:"auto",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellCheck:"false",onSearch:p=>{p.target.value||l({})},onInput:p=>{a(p.target.value),r(!0)},onFocus:()=>{var p,f;r(!0),(f=(p=b.current)==null?void 0:p.querySelector(".search-popover-item"))==null||f.classList.add("focus")},onBlur:()=>{var p,f;setTimeout(()=>{r(!1)},100),(f=(p=b.current)==null?void 0:p.querySelector(".search-popover-item.focus"))==null||f.classList.remove("focus")},onKeyDown:p=>{var y;const{key:f}=p;switch(f){case"Escape":r(!1);break;case"Down":case"ArrowDown":if(p.preventDefault(),u){const v=b.current.querySelector(".search-popover-item.focus");if(v){let w=v.nextElementSibling;for(;w&&w.hidden;)w=w.nextElementSibling;w&&(w.classList.add("focus"),Array.from(w.parentElement.children).filter(S=>S!==w).forEach(S=>{S.classList.remove("focus")}))}else{const w=b.current.querySelector(".search-popover-item");w&&w.classList.add("focus")}}break;case"Up":case"ArrowUp":if(p.preventDefault(),u){const v=document.querySelector(".search-popover-item.focus");if(v){let w=v.previousElementSibling;for(;w&&w.hidden;)w=w.previousElementSibling;w&&(w.classList.add("focus"),Array.from(w.parentElement.children).filter(S=>S!==w).forEach(S=>{S.classList.remove("focus")}))}else{const w=document.querySelector(".search-popover-item:last-child");w&&w.classList.add("focus")}}break;case"Enter":if(u){const v=document.querySelector(".search-popover-item.focus");v&&(p.preventDefault(),v.click()),r(!1),(y=n==null?void 0:n.onSubmit)==null||y.call(n,p)}break}}}),e("div",{class:"search-popover",hidden:!u||!d,children:!!d&&[{label:e(h,{id:"48oDit",values:{query:d},components:{0:e("small",{class:"insignificant"})}}),to:`/search?q=${encodeURIComponent(d)}`,top:!m&&!/\s/.test(d),hidden:!!m},{label:e(h,{id:"o1mMWT",values:{query:d},components:{0:e("q",{})}}),to:`/search?q=${encodeURIComponent(d)}&type=statuses`,hidden:/^https?:/.test(d),top:/\s/.test(d),icon:"document",queryType:"statuses"},{label:e(h,{id:"YAZw8D",values:{0:d.replace(/^#/,"")},components:{0:e("mark",{})}}),to:`/${o}/t/${d.replace(/^#/,"")}`,hidden:/^@/.test(d)||/^https?:/.test(d)||/\s/.test(d),top:/^#/.test(d),type:"link",icon:"hashtag",queryType:"hashtags"},{label:e(h,{id:"gEoOUj",values:{query:d},components:{0:e("mark",{})}}),to:`/${d}`,hidden:!/^https?:/.test(d),top:/^https?:/.test(d),type:"link"},{label:e(h,{id:"cDoNQr",values:{query:d},components:{0:e("q",{})}}),to:`/search?q=${encodeURIComponent(d)}&type=accounts`,icon:"group",queryType:"accounts"}].sort((p,f)=>{if(m){if(p.queryType===m)return-1;if(f.queryType===m)return 1}return p.top&&!f.top?-1:!p.top&&f.top?1:0}).filter(({hidden:p})=>!p).map(({label:p,to:f,icon:y,type:v},w)=>e(be,{to:f,class:`search-popover-item ${w===0?"focus":""}`,onClick:_=>{var S;(S=n==null?void 0:n.onSubmit)==null||S.call(n,_)},children:[e(T,{icon:y||(v==="link"?"arrow-right":"search"),class:"more-insignificant"}),e("span",{children:p})," "]}))})]})}),Ha=rt(function({onClose:i=()=>{}}){const[s,o]=L(!1),c=q(null);He(["Slash","/"],u=>{o(!0),setTimeout(()=>{var r,d,a,m;(d=(r=c.current)==null?void 0:r.focus)==null||d.call(r),(m=(a=c.current)==null?void 0:a.select)==null||m.call(a)},0)},{preventDefault:!0,ignoreEventWhen:u=>{const r=/\/search/.test(location.hash),d=!!document.querySelector("#modal-container > *");return r||d}});const l=()=>{o(!1),i()};return He("esc",u=>{var r,d;(d=(r=c.current)==null?void 0:r.blur)==null||d.call(r),l()},{enabled:s,enableOnFormTags:!0,preventDefault:!0}),e("div",{id:"search-command-container",hidden:!s,onClick:u=>{u.target===u.currentTarget&&l()},children:e(js,{ref:c,onSubmit:()=>{l()}})})});function qa(){const{_:n,_:i}=de(),{instance:s}=le(),o=Ve(x),{shortcuts:c,settings:l}=o;if(!c.length)return null;const u=l.shortcutsViewMode==="multi-column"||!l.shortcutsViewMode&&l.shortcutsColumnsMode;if(u)return null;const r=q(),d=q(!1),a=c.map((p,f)=>{const{type:y,...v}=p;if(!En[y])return null;let{id:w,path:_,title:S,subtitle:k,icon:A}=En[y];return typeof w=="function"&&(w=w(v,f)),typeof _=="function"&&(_=_({...v,instance:v.instance||s},f)),typeof S=="function"?S=S(v,f):S=i(S),typeof k=="function"?k=k(v,f):k=i(k),typeof A=="function"&&(A=A(v,f)),w==="lists"&&(d.current=!0),{id:w,path:_,title:S,subtitle:k,icon:A}}).filter(Boolean),m=ps();He(["1","2","3","4","5","6","7","8","9"],(p,f)=>{var v,w;const y=parseInt(f.keys[0],10)-1;if(y<a.length){const{path:_}=a[y];_&&(m(_),(w=(v=r.current)==null?void 0:v.closeMenu)==null||w.call(v))}},{enabled:!u});const[b,g]=L([]);return e("div",{id:"shortcuts",children:o.settings.shortcutsViewMode==="tab-menu-bar"?e("nav",{class:"tab-bar",onContextMenu:p=>{p.preventDefault(),x.showShortcutsSettings=!0},children:e("ul",{children:a.map(({id:p,path:f,title:y,subtitle:v,icon:w},_)=>e("li",{children:e(be,{class:v?"has-subtitle":"",to:f,onClick:S=>{if(S.target.classList.contains("is-active")){S.preventDefault();const k=document.getElementById(`${p}-page`);if(k){k.scrollTop=0;const A=k.querySelector(".updates-button");A&&A.click()}}},children:[e(T,{icon:w,size:"xl",alt:y}),e("span",{children:[e(yn,{children:y}),v&&e(O,{children:[e("br",{}),e("small",{children:v})]})]})]})},`${_}-${p}-${y}-${v}-${f}`))})}):e(lt,{instanceRef:r,overflow:"auto",viewScroll:"close",menuClassName:"glass-menu shortcuts-menu",gap:8,position:"anchor",onMenuChange:p=>{p.open&&d.current&&rn().then(g)},menuButton:e("button",{type:"button",id:"shortcuts-button",class:"plain",onContextMenu:p=>{p.preventDefault(),x.showShortcutsSettings=!0},onTransitionStart:p=>{var f,y;try{const{target:v}=p;getComputedStyle(v).pointerEvents==="none"&&((y=(f=r.current)==null?void 0:f.closeMenu)==null||y.call(f))}catch{}},children:e(T,{icon:"shortcut",size:"xl",alt:n({id:"CTqTgr"})})}),children:a.map(({id:p,path:f,title:y,subtitle:v,icon:w},_)=>p==="lists"?e(ln,{menuClassName:"glass-menu",overflow:"auto",gap:-8,label:e(O,{children:[e(T,{icon:w,size:"l"}),e("span",{class:"menu-grow",children:e(yn,{children:y})}),e(T,{icon:"chevron-right"})]}),children:[e(Ye,{to:"/l",children:e("span",{children:e(h,{id:"BHWx+g"})})}),e(We,{}),b==null?void 0:b.map(S=>e(Ye,{to:`/l/${S.id}`,children:e("span",{children:S.title})},S.id))]}):e(Ye,{to:f,class:"glass-menu-item",children:[e(T,{icon:w,size:"l"})," ",e("span",{class:"menu-grow",children:[e("span",{children:e(yn,{children:y})}),v&&e(O,{children:[" ",e("small",{class:"more-insignificant",children:v})]})]}),e("span",{class:"menu-shortcut hide-until-focus-visible",children:_+1})]},`${_}-${p}-${y}-${v}-${f}`))})})}const Ya=rt(qa);function ja(n){var c;let i=[],s=[],o=0;for(let l=0;l<n.length;l++){const u=n[l];u.reblog&&!((c=u.account)!=null&&c.group)?(s.push(u),o++):(i.push(u),o<3&&(o=0))}if(n.length>10&&(s.length>n.length/4||o>=3)){const l=s.map(u=>u.id);if(s.length>n.length*3/4)i=[...i,{id:l,items:s,type:"boosts"}];else{const u=Math.floor(i.length/2);i=[...i.slice(0,u),{id:l,items:s,type:"boosts"},...i.slice(u)]}return i}else return n}function Wi(n,i){const s=ke.account.get("boostedStatusIDs")||{},o=n.filter(l=>{if(!l.reblog)return!0;const u=`${i}-${l.reblog.id}`,r=s[u];return r&&r!==l.id?!1:(s[u]=l.id,!0)}),c=Object.keys(s);return c.length>50&&c.slice(0,c.length-50).forEach(l=>{delete s[l]}),ke.account.set("boostedStatusIDs",s),o}function Va(n,i){const s=[];let o=0;n.forEach(r=>{for(let a=0;a<s.length;a++){if(s[a].find(m=>m.id===r.id))return;if(s[a].find(m=>m.id===r.inReplyToId)||s[a].find(m=>m.inReplyToId===r.id)){s[a].push(r);return}}const d=n.find(a=>a.id===r.inReplyToId);d&&(s[o++]=[r,d])});for(let r=0;r<s.length;r++)for(let d=r+1;d<s.length;d++)s[r].find(m=>s[d].includes(m))&&(s[r]=[...s[r],...s[d]],s[r]=s[r].filter((m,b,g)=>g.findIndex(p=>p.id===m.id)===b),s.splice(d,1),d--);s.forEach(r=>{r.sort((d,a)=>!d.inReplyToId&&!a.inReplyToId?new Date(d.createdAt)-new Date(a.createdAt):d.inReplyToId===a.id?1:a.inReplyToId===d.id||!d.inReplyToId?-1:a.inReplyToId?new Date(d.createdAt)-new Date(a.createdAt):1)}),s.forEach(r=>{const d=r[0].account.id;r.forEach(a=>{a.account.id!==d&&(a._differentAuthor=!0)})}),s.length;const c=[],l=[],u=[];return n.forEach(r=>{if(r.reblog){c.push(r);return}for(let d=0;d<s.length;d++)if(s[d].find(a=>a.id===r.id)){if(l.includes(d))return;const a=s[d];a.sort((b,g)=>{const p=new Date(b.createdAt),f=new Date(g.createdAt);return p-f});const m=a[0].account.id;c.push({id:a.map(b=>b.id),items:a,type:a.every(b=>b.account.id===m)?"thread":"conversation"}),l.push(d);return}if(r.inReplyToId&&r.inReplyToAccountId!==r.account.id){const d=at(r.id,i);x.statusReply[d]||u.push({sKey:d,inReplyToId:r.inReplyToId})}c.push(r)}),u!=null&&u.length&&queueMicrotask(()=>{const{masto:r}=le({instance:i});async function d(){for(let a=0;a<u.length;a++){const{sKey:m,inReplyToId:b}=u[a];try{const g=await Ga(b,r);Je(g,i,{skipThreading:!0}),x.statusReply[m]={id:g.id,instance:i},await new Promise(p=>setTimeout(p,1e3))}catch{}}}if(et("@mastodon/fetch-multiple-statuses")){const a=u.map(({inReplyToId:m})=>m);(async()=>{var m;try{const b=await r.v1.statuses.list({id:a});if(b!=null&&b.length)for(const g of b){Je(g,i,{skipThreading:!0});const p=(m=u.find(({inReplyToId:f})=>f===g.id))==null?void 0:m.sKey;p&&(x.statusReply[p]={id:g.id,instance:i})}else d()}catch{d()}})()}else d()}),c}const Ga=gt((n,i)=>i.v1.statuses.$select(n).fetch());async function Vs(n,i){const s=await Ra();if(!s.length)return;const{statusFollowedTags:o}=x,c=[];if(n.forEach(l=>{var g;if(l.reblog)return;const{id:u,content:r,tags:d=[]}=l,a=at(u,i);if((g=o[a])!=null&&g.length)return;const m=La(r);if(!m.length&&!d.length)return;const b=s.reduce((p,f)=>((m.some(y=>y.toLowerCase()===f.name.toLowerCase())||d.some(y=>y.name.toLowerCase()===f.name.toLowerCase()))&&p.push(f.name),p),[]);b.length&&c.push({item:l,sKey:a,followedTags:b})}),c.length){const l=c.map(r=>r.item.account),u=await ri(l);if(!u)return;c.forEach(r=>{const{item:d,sKey:a,followedTags:m}=r,b=u[d.account.id];b&&!b.following&&(o[a]=m)})}}function Ka(){x.statusFollowedTags={}}function Wa({scrollableRef:n,distanceFromStart:i=1,distanceFromEnd:s=1,scrollThresholdStart:o=10,scrollThresholdEnd:c=10,direction:l="vertical",distanceFromStartPx:u,distanceFromEndPx:r}={}){const[d,a]=L(null),[m,b]=L(!1),[g,p]=L(!1),[f,y]=L(!1),[v,w]=L(!1),_=l==="vertical";return wt(()=>{const S=n.current;if(!S)return{};let k=_?S.scrollTop:S.scrollLeft;function A(){const{scrollTop:C,scrollLeft:I,scrollHeight:E,scrollWidth:M,clientHeight:z,clientWidth:P}=S,W=_?C:I,ee=_?E:M,Z=_?z:P,V=Math.abs(W-k),U=u||Math.min(Z*i,ee,W),B=r||Math.min(Z*s,ee,ee-W-Z);V>=(k<W?c:o)&&(a(k<W?"end":"start"),k=W),b(W<=0),p(W+Z>=ee),y(W<=U),w(W+Z>=ee-B)}return S.addEventListener("scroll",A,{passive:!0}),()=>S.removeEventListener("scroll",A)},[i,s,o,c]),{scrollDirection:d,reachStart:m,reachEnd:g,nearReachStart:f,nearReachEnd:v,init:()=>{n.current&&n.current.dispatchEvent(new Event("scroll"))}}}function Za({scrollableRef:n,distanceFromStart:i=1,distanceFromEnd:s=1,scrollThresholdStart:o=10,scrollThresholdEnd:c=10,direction:l="vertical",distanceFromStartPx:u,distanceFromEndPx:r,init:d}={},a,m){if(!a)return;const b=l==="vertical",g=q(null),p=q(null),f=Bo(()=>{let y=!1,v=!1,w=!1,_=!1;const S=n.current,{scrollTop:k,scrollLeft:A,scrollHeight:C,scrollWidth:I,clientHeight:E,clientWidth:M}=S,z=b?k:A,P=b?C:I,W=b?E:M,ee=Math.abs(z-g.current),Z=u||Math.min(W*i,P,z),V=r||Math.min(W*s,P,P-z-W);ee>=(g.current<z?c:o)&&(p.current=g.current<z?"end":"start",g.current=z),y=z<=0,v=z+W>=P,w=z<=Z,_=z+W>=P-V,a({scrollDirection:p.current,reachStart:y,reachEnd:v,nearReachStart:w,nearReachEnd:_})},500);wt(()=>{const y=n.current;return y?(g.current=y[b?"scrollTop":"scrollLeft"],y.addEventListener("scroll",f,{passive:!0}),()=>y.removeEventListener("scroll",f)):{}},[i,s,o,c,...m]),ne(()=>{d&&n.current&&queueMicrotask(()=>{n.current.dispatchEvent(new Event("scroll"))})},[d])}function Xa({class:n,statusID:i,status:s,instance:o,parent:c,onMediaClick:l}){const{_:u}=de();let r=at(i,o);const d=Ve(x);if(s||(s=d.statuses[r]||d.statuses[i],r=at(s==null?void 0:s.id,o)),!s)return null;const{account:{acct:a,avatar:m,avatarStatic:b,id:g,url:p,displayName:f,username:y,emojis:v,bot:w,group:_},id:S,repliesCount:k,reblogged:A,reblogsCount:C,favourited:I,favouritesCount:E,bookmarked:M,poll:z,muted:P,sensitive:W,spoilerText:ee,visibility:Z,language:V,editedAt:U,filtered:B,card:se,createdAt:$,inReplyToId:F,inReplyToAccountId:Y,content:G,mentions:te,mediaAttachments:ae,reblog:ve,uri:_e,url:j,emojis:he,_deleted:Ae,_pinned:Pe}=s;if(!(ae!=null&&ae.length))return null;const Ne=ge=>{ge.shiftKey},Ue=Ce(()=>vt(),[]),Re=Ce(()=>Ue&&Ue===g,[g,Ue]),Le=Co(Is),X=!Re&&jt(B,Le);if((X==null?void 0:X.action)==="hide")return null;const Ie=W,fe=Ce(()=>{var D;return((D=(ke.account.get("preferences")||{})["reading:expand:media"])==null?void 0:D.toLowerCase())||"default"},[])==="show_all",Q=c||"div";return ae.map((ge,D)=>{const ie=`${r}-${ge.id}`,ue=X==null?void 0:X.titlesStr;return e(Q,{"data-state-post-id":r,onMouseEnter:Ne,"data-spoiler-text":ee||(W?u({id:"FKojeB"}):void 0),"data-filtered-text":X?u(ue?{id:"7FGvtQ",values:{filterTitleStr:ue}}:{id:"03Qqf9"}):void 0,class:`
          media-post
          ${X?"filtered":""}
          ${Ie?"has-spoiler":""}
          ${fe?"show-media":""}
        `,children:e(Cs,{class:n,media:ge,lang:V,to:`/${o}/s/${S}?media-only=${D+1}`,onClick:l?N=>l(N,D,ge,s):void 0})},ie)})}const Zi=rt(Xa);function Ja(n){var S,k,A,C,I;const{_:i}=de(),s=Ve(x),{masto:o,instance:c,authenticated:l}=le(),[u,r]=Ce(()=>{const E=ke.local.getJSON("accounts")||[];return[E.find(z=>z.info.id===vt())||E[0],E.length>1]},[]),d=(s.settings.shortcutsViewMode==="multi-column"||!s.settings.shortcutsViewMode&&s.settings.shortcutsColumnsMode)&&!s.shortcuts.find(E=>E.type==="following"),a=bs(()=>{x.showAccounts=!0},{threshold:600,detect:"touch",cancelOnMovement:!0}),m=q(),[b,g]=L(void 0),p=vs([0,0,s.settings.shortcutsViewMode==="tab-menu-bar"?50:0,0]),f=q();async function y(E){return(E||!f.current)&&(f.current=o.v1.mutes.list({limit:80})),await f.current.next()}const v=q();async function w(E){return(E||!v.current)&&(v.current=o.v1.blocks.list({limit:80})),await v.current.next()}const _=q();return e(O,{children:[e("button",{ref:m,type:"button",class:`button plain nav-menu-button ${r?"with-avatar":""} ${b==="open"?"active":""}`,style:{position:"relative"},onClick:()=>{_.current=Date.now(),g(E=>E?void 0:"open")},onContextMenu:E=>{E.preventDefault(),x.showAccounts=!0},...a(),children:[r&&e(ft,{url:((S=u==null?void 0:u.info)==null?void 0:S.avatar)||((k=u==null?void 0:u.info)==null?void 0:k.avatarStatic),size:"l",squircle:(A=u==null?void 0:u.info)==null?void 0:A.bot}),e(T,{icon:"menu",size:r?"s":"l",alt:i({id:"zucql+"})})]}),e(li,{menuClassName:"nav-menu",state:b,anchorRef:m,onClose:()=>{g(void 0)},containerProps:{style:{zIndex:10},onClick:()=>{Date.now()-_.current<300}},portal:{target:document.body},...n,overflow:"auto",viewScroll:"close",position:"anchor",align:"center",boundingBoxPadding:p,unmountOnClose:!0,children:[!!((C=s.appVersion)!=null&&C.commitHash)&&s.appVersion.commitHash!=="512af62"&&e("div",{class:"top-menu",children:[e(Se,{onClick:()=>{confirm(i({id:"Djbaby"}))&&(async()=>{try{location.reload()}catch{}})()},children:[e(T,{icon:"sparkles",class:"sparkle-icon",size:"l"})," ",e("span",{children:e(h,{id:"95IFnD"})})]}),e(We,{})]}),e("section",{children:[e(Ye,{to:"/",children:[e(T,{icon:"home",size:"l"})," ",e("span",{children:e(h,{id:"i0qMbr"})})]}),l?e(O,{children:[d&&e(Ye,{to:"/following",children:[e(T,{icon:"following",size:"l"})," ",e("span",{children:e(h,{id:"following.title"})})]}),e(Ye,{to:"/catchup",children:[e(T,{icon:"history2",size:"l"}),e("span",{children:e(h,{id:"xrl8fj"})})]}),et("@mastodon/mentions")&&e(Ye,{to:"/mentions",children:[e(T,{icon:"at",size:"l"})," ",e("span",{children:e(h,{id:"/bZzdR"})})]}),e(Ye,{to:"/notifications",children:[e(T,{icon:"notification",size:"l"})," ",e("span",{children:e(h,{id:"iDNBZe"})}),s.notificationsShowNew&&e("sup",{title:i({id:"isRobC"}),style:{opacity:.5},children:[" ","•"]})]}),e(We,{}),((I=u==null?void 0:u.info)==null?void 0:I.id)&&e(Ye,{to:`/${c}/a/${u.info.id}`,children:[e(T,{icon:"user",size:"l"})," ",e("span",{children:e(h,{id:"vERlcd"})})]}),e(Qa,{menuState:b}),e(Ye,{to:"/b",children:[e(T,{icon:"bookmark",size:"l"})," ",e("span",{children:e(h,{id:"7Ff7ia"})})]}),e(ln,{menuClassName:"nav-submenu",overflow:"auto",gap:-8,label:e(O,{children:[e(T,{icon:"more",size:"l"}),e("span",{class:"menu-grow",children:e(h,{id:"24misb"})}),e(T,{icon:"chevron-right"})]}),children:[e(Ye,{to:"/f",children:[e(T,{icon:"heart",size:"l"})," ",e("span",{children:e(h,{id:"zZOZj7"})})]}),e(Ye,{to:"/fh",children:[e(T,{icon:"hashtag",size:"l"})," ",e("span",{children:e(h,{id:"Xi1/bw"})})]}),e(Ye,{to:"/sp",children:[e(T,{icon:"schedule",size:"l"})," ",e("span",{children:e(h,{id:"+GkIdc"})})]}),e(We,{}),et("@mastodon/filters")&&e(Ye,{to:"/ft",children:[e(T,{icon:"filters",size:"l"})," ",e("span",{children:e(h,{id:"cSev+j"})})]}),e(Se,{onClick:()=>{x.showGenericAccounts={id:"mute",heading:i({id:"sOKhEA"}),fetchAccounts:y,excludeRelationshipAttrs:["muting"]}},children:[e(T,{icon:"mute",size:"l"})," ",e("span",{children:e(h,{id:"n1sANU"})})]}),e(Se,{onClick:()=>{x.showGenericAccounts={id:"block",heading:i({id:"nL8nlr"}),fetchAccounts:w,excludeRelationshipAttrs:["blocking"]}},children:[e(T,{icon:"block",size:"l"})," ",e("span",{children:e(h,{id:"r3RRWo"})})]})," "]}),e(We,{}),e(Se,{onClick:()=>{x.showAccounts=!0},children:[e(T,{icon:"group",size:"l"})," ",e("span",{children:e(h,{id:"7e0O8Z"})})]})]}):e(O,{children:[e(We,{}),e(Ye,{to:"/login",children:[e(T,{icon:"user",size:"l"})," ",e("span",{children:e(h,{id:"sQia9P"})})]})]})]}),e("section",{children:[e(We,{}),e(Ye,{to:"/search",children:[e(T,{icon:"search",size:"l"})," ",e("span",{children:e(h,{id:"A1taO8"})})]}),e(Ye,{to:`/${c}/trending`,children:[e(T,{icon:"chart",size:"l"})," ",e("span",{children:e(h,{id:"4/iCqx"})})]}),e(Ye,{to:`/${c}/p/l`,children:[e(T,{icon:"building",size:"l"})," ",e("span",{children:e(h,{id:"d5zxa4"})})]}),e(Ye,{to:`/${c}/p`,children:[e(T,{icon:"earth",size:"l"})," ",e("span",{children:e(h,{id:"4ERYY7"})})]}),l?e(O,{children:[e(We,{className:"divider-grow"}),e(Se,{onClick:()=>{x.showKeyboardShortcutsHelp=!0},children:[e(T,{icon:"keyboard",size:"l"})," ",e("span",{children:e(h,{id:"77Emn0"})})]}),e(Se,{onClick:()=>{x.showShortcutsSettings=!0},children:[e(T,{icon:"shortcut",size:"l"})," ",e("span",{children:e(h,{id:"8Kudkr"})})]}),e(Se,{onClick:()=>{x.showSettings=!0},children:[e(T,{icon:"gear",size:"l"})," ",e("span",{children:e(h,{id:"uVbUP8"})})]})]}):e(O,{children:[e(We,{}),e(Se,{onClick:()=>{x.showSettings=!0},children:[e(T,{icon:"gear",size:"l"})," ",e("span",{children:e(h,{id:"uVbUP8"})})]})]})]})]})]})}function Qa({menuState:n}){const i=et("@mastodon/lists"),[s,o]=L([]);return ne(()=>{i&&n==="open"&&rn().then(o)},[n,i]),s.length>0?e(ln,{menuClassName:"nav-submenu",overflow:"auto",gap:-8,label:e(O,{children:[e(T,{icon:"list",size:"l"}),e("span",{class:"menu-grow",children:e(h,{id:"h16FyT"})}),e(T,{icon:"chevron-right"})]}),children:[e(Ye,{to:"/l",children:e("span",{children:e(h,{id:"BHWx+g"})})}),(s==null?void 0:s.length)>0&&e(O,{children:[e(We,{}),s.map(c=>e(Ye,{to:`/l/${c.id}`,children:e("span",{children:c.title})},c.id))]})]}):i&&e(Ye,{to:"/l",children:[e(T,{icon:"list",size:"l"}),e("span",{children:e(h,{id:"h16FyT"})})]})}const Mt=rt(Ja),un={block:"start",inline:"center",behavior:"smooth"};function Tt({title:n,titleComponent:i,id:s,instance:o,emptyText:c,errorText:l,useItemID:u,boostsCarousel:r,fetchItems:d=()=>{},checkForUpdates:a=()=>{},checkForUpdatesInterval:m=15e3,headerStart:b,headerEnd:g,timelineStart:p,refresh:f,view:y,filterContext:v,showFollowedTags:w,showReplyParent:_,clearWhenRefresh:S}){const{_:k}=de(),A=Ve(x),[C,I]=L([]),[E,M]=L("start"),[z,P]=L(!1),[W,ee]=L(!1),[Z,V]=L(!0),U=q();__BENCHMARK.start(`timeline-${s}-load`);const B=Ce(()=>oi(),[]),se=y!=="media",$=q(0),F=Ho(X=>{ee(!1),M("loading"),(async()=>{try{const Ie=$.current=Date.now();let{done:De,value:fe}=await d(X);if(Ie!==$.current)return;if(Array.isArray(fe)){const[Q,ge]=fe.reduce((D,ie)=>(ie._pinned?D[0].push(ie):D[1].push(ie),D),[[],[]]);fe=ge,se&&(r&&(fe=ja(fe)),fe=Va(fe,o)),Q.length&&(fe=Q.concat(fe)),I(X?fe:D=>[...D,...fe]),fe.length||(De=!0),P(!De)}else P(!1);M("default"),__BENCHMARK.end(`timeline-${s}-load`)}catch{M("error"),X&&!C.length&&l&&me(l)}finally{F.cancel()}})()},1e3,{leading:!0}),Y=".timeline-item, .timeline-item-alt",G=He("j, shift+j",(X,Ie)=>{const De=document.activeElement.closest(Y),fe=De==null?void 0:De.getBoundingClientRect(),Q=Array.from(U.current.querySelectorAll(Y)).filter(ge=>!!ge.offsetHeight);if(De&&fe.top<U.current.clientHeight&&fe.bottom>0){const ge=Q.indexOf(De);let D=Q[ge+1];Ie.shift&&(D=Q.find((ie,ue)=>ue>ge&&!ie.classList.contains("timeline-item-alt"))),D&&(D.focus(),D.scrollIntoView(un))}else{const ge=Q.find(D=>{const ie=D.getBoundingClientRect();return ie.top>=44&&ie.left>=0});ge&&(ge.focus(),ge.scrollIntoView(un))}}),te=He("k, shift+k",(X,Ie)=>{const De=document.activeElement.closest(Y),fe=De==null?void 0:De.getBoundingClientRect(),Q=Array.from(U.current.querySelectorAll(Y)).filter(ge=>!!ge.offsetHeight);if(De&&fe.top<U.current.clientHeight&&fe.bottom>0){const ge=Q.indexOf(De);let D=Q[ge-1];Ie.shift&&(D=Q.findLast((ie,ue)=>ue<ge&&!ie.classList.contains("timeline-item-alt"))),D&&(D.focus(),D.scrollIntoView(un))}else{const ge=Q.find(D=>{const ie=D.getBoundingClientRect();return ie.top>=44&&ie.left>=0});ge&&(ge.focus(),ge.scrollIntoView(un))}}),ae=He(["enter","o"],()=>{const X=document.activeElement;X!=null&&X.matches(Y)&&X.click()}),ve=C.length>0&&E!=="loading"&&W,_e=st(()=>{var X;ve&&F(!0),(X=U.current)==null||X.scrollTo({top:0,behavior:"smooth"})},[F,ve]),j=He(".",_e),he=q(),[Ae,Pe]=L(!1);Za({scrollableRef:U,distanceFromEnd:2,scrollThresholdStart:44},({scrollDirection:X,nearReachStart:Ie,reachStart:De})=>{if(he.current){const fe=X==="end"&&!Ie;he.current.hidden=fe}Pe(Ie),De&&F(!0)},[]),ne(()=>{var X;(X=U.current)==null||X.scrollTo({top:0}),F(!0)},[]);const Ne=q(!0);ne(()=>{var X;if(Ne.current){Ne.current=!1;return}S&&(C!=null&&C.length)&&((X=F.cancel)==null||X.call(F),I([])),F(!0)},[S,f]);const Ue=q(y);ne(()=>{Ue.current!==y&&(Ue.current=y,I([]))},[y]);const Re=st(async({disableIdleCheck:X=!1}={})=>{const Ie=U.current?getComputedStyle(U.current).pointerEvents==="none":!1;A.settings.autoRefresh&&U.current.scrollTop<16&&(X||window.__IDLE__)&&!il()&&!Ie?F(!0):await a()&&ee(!0)},[s,F,a,A.settings.autoRefresh]),Le=q();return Vt(X=>{if(X){const Ie=Date.now()-Le.current;(!Le.current||Ie>1e3*3)&&Re({disableIdleCheck:!0})}else Le.current=Date.now();V(X)},[a,Re,A.settings.autoRefresh]),ai(Re,Z&&!W?m*(Ae?1:2):null),e(Is.Provider,{value:v,children:e("div",{id:`${s}-page`,class:`deck-container ${B?"deck-container-media-first":""}`,ref:X=>{U.current=X,G(X),te(X),ae(X),j(X)},tabIndex:"-1",onClick:X=>{he.current&&X.target.closest(".timeline-item, .timeline-item-alt")&&setTimeout(()=>{he.current.hidden=!1},250)},children:e("div",{class:"timeline-deck deck",children:[e("header",{ref:he,onClick:X=>{var Ie;X.target.closest("a, button")||(Ie=U.current)==null||Ie.scrollTo({top:0,behavior:"smooth"})},onDblClick:X=>{X.target.closest("a, button")||F(!0)},class:E==="loading"?"loading":"",children:[e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Mt,{}),b??e(be,{to:"/",class:"button plain home-button",children:e(T,{icon:"home",size:"l",alt:k({id:"i0qMbr"})})})]}),n&&(i||e("h1",{children:n})),e("div",{class:"header-side",children:!!g&&g})]}),ve&&e("button",{class:"updates-button shiny-pill",type:"button",onClick:_e,children:[e(T,{icon:"arrow-up"})," ",e(h,{id:"2yr1/p"})]})]}),!!p&&e("div",{class:`timeline-start ${E==="loading"?"loading":""}`,children:p}),C.length?e(O,{children:[e("ul",{class:`timeline ${y?`timeline-${y}`:""}`,children:[C.map(X=>e(el,{status:X,instance:o,useItemID:u,filterContext:v,view:y,showFollowedTags:w,showReplyParent:_,mediaFirst:B},X.id+(X==null?void 0:X._pinned)+y)),z&&E==="loading"&&(y==="media"?null:e(O,{children:[e("li",{style:{height:"20vh"},children:e(je,{skeleton:!0,mediaFirst:B})}),e("li",{style:{height:"25vh"},children:e(je,{skeleton:!0,mediaFirst:B})})]}))]}),E==="default"&&(z?e(Ct,{root:U.current,rootMargin:`0px 0px ${screen.height*1.5}px 0px`,onChange:X=>{X&&F()},children:e("button",{type:"button",class:"plain block",onClick:()=>F(),style:{marginBlockEnd:"6em"},children:e(h,{id:"uXRAkV"})})}):e("p",{class:"ui-state insignificant",children:e(h,{id:"2EYeAZ"})}))]}):E==="loading"?e("ul",{class:"timeline",children:Array.from({length:5}).map((X,Ie)=>y==="media"?e("div",{style:{height:"50vh"}}):e("li",{children:e(je,{skeleton:!0,mediaFirst:B})},Ie))}):E!=="error"&&E!=="start"&&e("p",{class:"ui-state",children:c}),E==="error"&&e("p",{class:"ui-state",children:[l,e("br",{}),e("br",{}),e("button",{type:"button",onClick:()=>F(!C.length),children:e(h,{id:"KDw4GX"})})]})]})})})}const el=rt(({status:n,instance:i,useItemID:s,filterContext:o,view:c,showFollowedTags:l,showReplyParent:u,mediaFirst:r})=>{const{_:d}=de(),{id:a,reblog:m,items:b,type:g,_pinned:p}=n;p&&(s=!1);const f=(m==null?void 0:m.id)||a,y=i?`/${i}/s/${f}`:`/s/${f}`;if(b){let w=Dt(b,o),_="";if(g==="boosts"?_=pe._({id:"NuqppG",values:{0:w.length}}):g==="pinned"&&(_=d({id:"GlfmCu"})),g==="boosts"||g==="pinned"){const A=new Set;if(w.sort((C,I)=>{const E=jt(C.filtered,o),M=jt(I.filtered,o);return E&&A.add(C.id),M&&A.add(I.id),E&&!M?1:!E&&M?-1:0}),A.size>=2){const I=[],E=[];w.forEach(z=>{A.has(z.id)?E.push(z):I.push(z)});const M=[];for(let z=0;z<E.length;z+=5)M.push({_grouped:!0,posts:E.slice(z,z+5)});w=I.concat(M)}return e("li",{class:"timeline-item-carousel",children:e(tl,{title:_,class:`${g}-carousel`,children:w.map(C=>{const{id:I,reblog:E,_pinned:M,_grouped:z}=C;if(z)return e("li",{class:"timeline-item-carousel-group",children:C.posts.map(ee=>{const{id:Z,reblog:V,_pinned:U}=ee,B=(V==null?void 0:V.id)||Z,se=i?`/${i}/s/${B}`:`/s/${B}`;return U&&(s=!1),e(be,{class:"status-carousel-link timeline-item-alt",to:se,children:s?e(je,{statusID:Z,instance:i,size:"s"}):e(je,{status:ee,instance:i,size:"s"})})})},I);const P=(E==null?void 0:E.id)||I,W=i?`/${i}/s/${P}`:`/s/${P}`;return M&&(s=!1),e("li",{children:e(be,{class:"status-carousel-link timeline-item-alt",to:W,children:s?e(je,{statusID:I,instance:i,size:"s",contentTextWeight:!0,enableCommentHint:!0,mediaFirst:r}):e(je,{status:C,instance:i,size:"s",contentTextWeight:!0,enableCommentHint:!0,mediaFirst:r})})},I)})})},`timeline-${a}`)}const k=w.length>3;return w.map((A,C)=>{const{id:I,_differentAuthor:E}=A,M=i?`/${i}/s/${I}`:`/s/${I}`,z=C>0&&C<w.length-1,P=A.sensitive&&!!A.spoilerText,W=!E&&P&&C>0||k&&z&&(g==="thread"||g==="conversation"&&!E&&!w[C-1]._differentAuthor&&!w[C+1]._differentAuthor),ee=C===0,Z=C===w.length-1;return e("li",{class:`timeline-item-container timeline-item-container-type-${g} timeline-item-container-${ee?"start":Z?"end":"middle"} ${E?"timeline-item-diff-author":""}`,children:e(be,{class:"status-link timeline-item",to:M,children:W?e(nl,{status:A,instance:i,filterContext:o}):s?e(je,{statusID:I,instance:i,enableCommentHint:Z,showFollowedTags:l}):e(je,{status:A,instance:i,enableCommentHint:Z,showFollowedTags:l})})},`timeline-${I}`)})}const v=`timeline-${a+p}`;return c==="media"?s?e(Zi,{class:"timeline-item",parent:"li",statusID:a,instance:i},v):e(Zi,{class:"timeline-item",parent:"li",status:n,instance:i},v):e("li",{children:e(be,{class:"status-link timeline-item",to:y,children:s?e(je,{statusID:a,instance:i,enableCommentHint:!0,showFollowedTags:l,showReplyParent:u,mediaFirst:r}):e(je,{status:n,instance:i,enableCommentHint:!0,showFollowedTags:l,showReplyParent:u,mediaFirst:r})})},v)},(n,i)=>{var c,l;const s=(((c=n.status)==null?void 0:c.id)||"").toString(),o=(((l=i.status)==null?void 0:l.id)||"").toString();return s===o&&n.instance===i.instance&&n.view===i.view});function tl({title:n,class:i,children:s}){const{_:o}=de(),c=q(),l=q(),u=q(),[r,d]=L(!1);return ne(()=>{setTimeout(()=>{d(!0)},1)},[]),e("div",{class:`status-carousel ${i}`,children:[e("header",{children:[e("h3",{children:n}),e("span",{children:[e("button",{ref:l,type:"button",class:"small plain2",onClick:()=>{var m,b;const a=Math.min(320,(m=c.current)==null?void 0:m.offsetWidth)*(Nt()?1:-1);(b=c.current)==null||b.scrollBy({left:a,behavior:"smooth"})},children:e(T,{icon:"chevron-left",alt:o({id:"DHhJ7s"})})})," ",e("button",{ref:u,type:"button",class:"small plain2",onClick:()=>{var m,b;const a=Math.min(320,(m=c.current)==null?void 0:m.offsetWidth)*(Nt()?-1:1);(b=c.current)==null||b.scrollBy({left:a,behavior:"smooth"})},children:e(T,{icon:"chevron-right",alt:o({id:"hXzOVo"})})})]})]}),e("ul",{ref:c,children:[e(Ct,{class:"status-carousel-beacon",onChange:a=>{l.current&&(l.current.disabled=a)}}),s[0],r&&s.slice(1),e(Ct,{class:"status-carousel-beacon",onChange:a=>{u.current&&(u.current.disabled=a)}})]})]})}function nl({status:n,instance:i,filterContext:s}){const{_:o}=de(),c=Ve(x),{id:l,visibility:u,language:r}=n,d=Ln(n),a=at(l,i),m=jt(n.filtered,s);return e("article",{class:`status compact-thread ${u==="direct"?"visibility-direct":""}`,tabindex:"-1",children:[c.statusThreadNumber[a]?e("div",{class:"status-thread-badge",children:[e(T,{icon:"thread",size:"s",alt:o({id:"e66y2Z"})}),c.statusThreadNumber[a]?` ${c.statusThreadNumber[a]}/X`:""]}):e("div",{class:"status-thread-badge",children:e(T,{icon:"thread",size:"s",alt:o({id:"e66y2Z"})})}),e("div",{class:"content-compact",title:d,lang:r,dir:"auto",children:m?e("b",{class:"status-filtered-badge badge-meta horizontal",title:(m==null?void 0:m.titlesStr)||"",children:m!=null&&m.titlesStr?e(h,{id:"sr6maL",values:{0:m.titlesStr},components:{0:e("span",{}),1:e("span",{})}}):e("span",{children:e(h,{id:"03Qqf9"})})}):e(O,{children:[d,n.sensitive&&n.spoilerText&&e(O,{children:[" ",e("span",{class:"spoiler-badge",children:e(T,{icon:"eye-close",size:"s",alt:o({id:"gnKo7f"})})})]})]})})]})}function il(){return!!document.querySelector(".deck-backdrop, #modal-container > *")}const qt=20,Si=1983,Xi=`${Si}-01`,sl=(()=>{try{const n=document.createElement("input");return n.setAttribute("type","month"),n.type==="month"}catch{return!1}})();async function ol(n){var o;const{masto:i}=le({instance:n}),s=await i.v2.search.fetch({q:"from:me",type:"statuses",limit:1});return!!((o=s==null?void 0:s.statuses)!=null&&o.length)}const cl=gt(ol);function al(){const{i18n:n,_:i}=de(),s=Ve(x),{id:o,...c}=Lt(),[l,u]=bt(),r=l.get("month"),d=!l.get("replies"),a=!!l.get("boosts"),m=l.get("tagged"),b=!!l.get("media"),{masto:g,instance:p,authenticated:f}=le({instance:c.instance}),{masto:y,instance:v}=le(),w=q(),_=[r,d,a,m,b],[S,k]=L(),A=q(0);ne(()=>{A.current=0},_);const C=Ce(()=>oi(),[]),I=Ce(()=>p===v,[p,v]),[E,M]=L(!1);ne(()=>{I&&S!=null&&S.acct&&(async()=>{const te=await cl(p);M(te)})()},[p,I,S==null?void 0:S.acct]);async function z(te){var Ae,Pe,Ne,Ue;const ae=/^\d{4}-[01]\d$/.test(r),ve=((Pe=(Ae=r==null?void 0:r.split)==null?void 0:Ae.call(r,"-"))==null?void 0:Pe[0])>=Si;if(ae&&ve){if(!S)return{value:[],done:!0};const[Re,Le]=r.split("-"),X=parseInt(Le,10)-1,Ie=new Date(Re,X,0),De=`${Ie.getFullYear()}-${(Ie.getMonth()+1).toString().padStart(2,"0")}-${Ie.getDate().toString().padStart(2,"0")}`,fe=new Date(Re,X+1,1),Q=`${fe.getFullYear()}-${(fe.getMonth()+1).toString().padStart(2,"0")}-${fe.getDate().toString().padStart(2,"0")}`;let ge;te?(ge=qt+1,A.current=0):(ge=qt+A.current+1,A.current+=qt);const D=await g.v2.search.fetch({q:`from:${S.acct} after:${De} before:${Q}`,type:"statuses",limit:ge,offset:A.current});if((Ne=D==null?void 0:D.statuses)!=null&&Ne.length){const ie=D.statuses.slice(0,qt);ie.forEach(N=>{Je(N,p)});const ue=D.statuses.length<=qt;return{value:ie,done:ue}}else return{value:[],done:!0}}let _e=[];if(te){const{value:Re}=await g.v1.accounts.$select(o).statuses.list({pinned:!0}).next();if(Re!=null&&Re.length&&!m&&!b){const Le=Re.map(X=>(Je(X,p),{...X,_pinned:!0}));if(Le.length>=3){const X=Le.map(Ie=>Ie.id);_e.push({id:X,items:Le,type:"pinned"})}else _e.push(...Le)}}(te||!w.current)&&(w.current=g.v1.accounts.$select(o).statuses.list({limit:qt,exclude_replies:d,exclude_reblogs:a,only_media:b||void 0,tagged:m}));const{value:j,done:he}=await w.current.next();if(j!=null&&j.length){if(_e.length){let Re=[];((Ue=_e[0])==null?void 0:Ue.type)==="pinned"?Re=_e[0].id:Re=_e.filter(X=>X._pinned).map(X=>X.id),Re.every(X=>j.some(Ie=>Ie.id===X))&&(_e=[])}_e.push(...j),j.forEach(Re=>{Je(Re,p)})}return{value:_e,done:he}}const[P,W]=L([]);let ee=i({id:"/cKnpj"});if(S!=null&&S.acct){const te=(/@/.test(S.acct)?"":"@")+S.acct,ae=S!=null&&S.displayName?`${S.displayName} (${te})`:`${te}`;if(!d)ee=i({id:"hS1Opy",values:{accountDisplay:ae}});else if(a)ee=i({id:"A/CX5F",values:{accountDisplay:ae}});else if(m)ee=i({id:"QQrO94",values:{accountDisplay:ae,tagged:m}});else if(b)ee=i({id:"NoG5wD",values:{accountDisplay:ae}});else if(r){const ve=new Date(r).toLocaleString(n.locale,{month:"long",year:"numeric"});ee=i({id:"8GjLvB",values:{accountDisplay:ae,monthYear:ve}})}else ee=ae}Qe(ee,"/:instance?/a/:id");const Z=st(()=>dl(o,g),[o,g]);ne(()=>{(async()=>{try{const te=await Z();k(te)}catch{}if(!C)try{const te=await g.v1.accounts.$select(o).featuredTags.list();W(te)}catch{}})()},[o,C]);const{displayName:V,acct:U,emojis:B}=S||{},se=q(),$=Ce(()=>{const te=!d||a||m||b||!!r,ae=s.accounts[`${o}@${p}`];return e(O,{children:[e(Fs,{instance:p,account:ae||o,fetchAccount:Z,authenticated:f,standalone:!0}),!C&&e("div",{class:"filter-bar",ref:se,style:{position:"relative"},children:[te?e(be,{to:`/${p}/a/${o}`,class:"insignificant filter-clear",title:i({id:"u8JHrO"}),children:e(T,{icon:"x",size:"l",alt:i({id:"xCJdfg"})})},"clear-filters"):e(T,{icon:"filter",class:"insignificant",size:"l",alt:i({id:"cSev+j"})}),e(be,{to:`/${p}/a/${o}${d?"?replies=1":""}`,onClick:()=>{d&&me(i({id:"PIWNSQ"}))},class:d?"":"is-active",children:e(h,{id:"5BFynH"})}),e(be,{to:`/${p}/a/${o}${a?"":"?boosts=0"}`,onClick:()=>{a||me(i({id:"Qd13i0"}))},class:a?"is-active":"",children:e(h,{id:"usxQx0"})}),e(be,{to:`/${p}/a/${o}${b?"":"?media=1"}`,onClick:()=>{b||me(i({id:"rKpfPY"}))},class:b?"is-active":"",children:e(h,{id:"xYilR2"})}),P.map(ve=>e(be,{to:`/${p}/a/${o}${m===ve.name?"":`?tagged=${encodeURIComponent(ve.name)}`}`,onClick:()=>{m!==ve.name&&me(i({id:"L+HFfr",values:{0:ve.name}}))},class:m===ve.name?"is-active":"",children:e("span",{children:[e("span",{class:"more-insignificant",children:"#"}),ve.name]})},ve.id)),E&&(sl?e("label",{class:`filter-field ${r?"is-active":""}`,children:[e(T,{icon:"month",size:"l"}),e("input",{type:"month",disabled:!(S!=null&&S.acct),value:r||"",min:Xi,max:new Date().toISOString().slice(0,7),onInput:ve=>{const{value:_e,validity:j}=ve.currentTarget;if(!j.valid)return;u(_e?{month:_e}:{});const[he,Ae]=_e.split("-"),Pe=parseInt(Ae,10)-1,Ne=new Date(he,Pe);me(i({id:"yKR8NJ",values:{1:Ne.toLocaleString(n.locale,{month:"long",year:"numeric"})}}))}})]}):e(ll,{class:`filter-field ${r?"is-active":""}`,disabled:!(S!=null&&S.acct),value:r||"",min:Xi,max:new Date().toISOString().slice(0,7),onInput:ve=>{const{value:_e,validity:j}=ve;j.valid&&u(_e?{month:_e}:{})}}))]})]})},[o,p,f,P,Z,E,..._]);ne(()=>{var ae;const te=(ae=se.current)==null?void 0:ae.querySelector(".is-active");te&&se.current.scrollTo({behavior:"smooth",left:te.offsetLeft-(se.current.offsetWidth-te.offsetWidth)/2})},[P,E,..._]);const F=Ce(()=>S!=null&&S.url?URL.parse(S.url).hostname:null,[S]),G=!!S&&!(p===F);return e(Tt,{title:`${S!=null&&S.acct?"@"+S.acct:i({id:"+owNNn"})}`,titleComponent:e("h1",{class:"header-double-lines header-account",children:[e("b",{children:e(Ss,{text:V,emojis:B})}),e("div",{children:e("span",{class:"bidi-isolate",children:["@",U]})})]}),id:"account-statuses",instance:p,emptyText:i({id:"+k97fV"}),errorText:i({id:"scd9lw"}),fetchItems:z,useItemID:!0,view:b||C?"media":void 0,boostsCarousel:s.settings.boostsCarousel,timelineStart:$,refresh:[d,a,m,b,r+(S==null?void 0:S.acct)].toString(),headerEnd:e(lt,{portal:!0,overflow:"auto",viewScroll:"close",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(T,{icon:"more",size:"l",alt:i({id:"2FYpfJ"})})}),children:[e(Se,{disabled:!G,onClick:()=>{(async()=>{try{const{masto:te}=le({instance:F}),ae=await te.v1.accounts.lookup({acct:S.acct}),{id:ve}=ae;location.hash=`/${F}/a/${ve}`}catch{alert(i({id:"FgdLx0"}))}})()},children:[e(T,{icon:"transfer"})," ",e("small",{class:"menu-double-lines",children:e(h,{id:"/JFxxT",values:{0:F?e(O,{children:[" ","(",e("b",{children:zt.toUnicode(F)}),")"]}):null}})})]}),!I&&e(Se,{onClick:()=>{(async()=>{try{const te=await y.v1.accounts.lookup({acct:S.acct+"@"+p}),{id:ae}=te;location.hash=`/${v}/a/${ae}`}catch{alert(i({id:"FgdLx0"}))}})()},children:[e(T,{icon:"transfer"})," ",e("small",{class:"menu-double-lines",children:e(h,{id:"HkuyOu",values:{currentInstance:v},components:{0:e("b",{})}})})]})]})},o)}function ll(n){const{i18n:i}=de(),{class:s,disabled:o,value:c,min:l,max:u,onInput:r=()=>{}}=n,[d,a]=(c==null?void 0:c.split("-"))||[],m=q(),b=q(),g=(p,f)=>{const[y,v]=(l==null?void 0:l.split("-"))||[],[w,_]=(u==null?void 0:u.split("-"))||[];return!(f<y||f>w||f===y&&p<v||f===w&&p>_)};return e("div",{class:s,children:[e(T,{icon:"month",size:"l"}),e("select",{ref:m,disabled:o,value:a||"",onInput:p=>{const{value:f}=p.currentTarget,y=b.current.value;if(!g(f,y))return{value:"",validity:{valid:!1}};r({value:f?`${y}-${f}`:"",validity:{valid:!0}})},children:[e("option",{value:"",children:e(h,{id:"HajiZl"})}),e("option",{disabled:!0,children:"-----"}),Array.from({length:12},(p,f)=>e("option",{value:(f+1).toString().padStart(2,"0"),children:new Date(0,f).toLocaleString(i.locale,{month:"long"})},f))]})," ",e("input",{ref:b,type:"number",disabled:o,value:d||new Date().getFullYear(),min:(l==null?void 0:l.slice(0,4))||Si,max:(u==null?void 0:u.slice(0,4))||new Date().getFullYear(),onInput:p=>{const{value:f,validity:y}=p.currentTarget,v=m.current.value;if(!y.valid||!g(v,f))return{value:"",validity:{valid:!1}};r({value:f?`${f}-${v}`:"",validity:{valid:!0}})},style:{width:"4.5em"}})]})}function rl(n,i){return i.v1.accounts.$select(n).fetch()}const dl=gt(rl,{maxAge:30*60*1e3});function ul(){var p;const n=Lt(),{year:i}=n;Qe(i?`Annual Report: ${i}`:"Annual Report");const{masto:s,instance:o}=le(),[c,l]=L(null),[u,r]=L("default");ne(()=>{i&&(async()=>{r("loading");const f=await s.v1.annualReports.$select(i).fetch();l(f),r("default")})()},[i]);const{accounts:d,annualReports:a,statuses:m}=c||{},b=(p=a==null?void 0:a.find(f=>f.year==i))==null?void 0:p.data,g=new Date;return e("div",{id:"annual-report-page",class:"deck-container",tabIndex:"-1",children:[e("div",{class:"report",children:[e("h1",{children:[i," #Wrapstodon"]}),u==="loading"&&e("p",{children:[e(Fe,{abrupt:!0})," ",e(h,{id:"Pwqkdw"})]}),!!b&&e("dl",{children:Object.entries(b).map(([f,y])=>e(O,{children:[e("dt",{children:f}),e("dd",{class:`report-${f}`,children:Array.isArray(y)?e("table",{children:[e("thead",{children:e("tr",{children:Object.entries(y[0]).map(([v,w])=>e("th",{class:v!=="month"&&typeof w=="number"?"number":"",children:v}))})}),e("tbody",{children:y.map(v=>e("tr",{children:Object.entries(v).map(([w,_])=>e("td",{class:w!=="month"&&typeof _=="number"?"number":"",children:_&&/(accountId)/i.test(w)&&/^(mostRebloggedAccounts|commonlyInteractedWithAccounts)$/i.test(f)?e(mt,{account:d==null?void 0:d.find(S=>S.id===_),showAvatar:!0}):w==="month"?g.setMonth(_-1)&&g.toLocaleString(void 0,{month:"long"}):typeof _=="number"?_.toLocaleString():_}))}))})]}):typeof y=="object"?/^(topStatuses)$/i.test(f)?e("dl",{children:Object.entries(y).map(([v,w])=>e(O,{children:[e("dt",{children:v}),e("dd",{children:w&&e(be,{to:`/${o}/s/${w}`,children:e(je,{status:m==null?void 0:m.find(_=>_.id===w),size:"s",readOnly:!0})})})]}))}):e("table",{children:e("tbody",{children:Object.entries(y).map(([v,w])=>e("tr",{children:[e("th",{children:v}),e("td",{class:typeof w=="number"?"number":"",children:w})]}))})}):typeof y=="string"?y:JSON.stringify(y,null,2)})]}))})]}),e("hr",{}),e("p",{style:{textAlign:"center"},children:e(be,{to:"/",children:e(h,{id:"iWpEwy"})})})]})}const hl=20;function Gs(){const{_:n}=de();Qe(n({id:"7Ff7ia"}),"/bookmarks");const{masto:i,instance:s}=le(),o=q();async function c(l){return(l||!o.current)&&(o.current=i.v1.bookmarks.list({limit:hl})),await o.current.next()}return e(Tt,{title:n({id:"7Ff7ia"}),id:"bookmarks",emptyText:n({id:"8k2w6G"}),errorText:n({id:"UoL+FC"}),instance:s,fetchItems:c})}const fl=""+new URL("catch-up-O5q5C75Z.png",import.meta.url).href,pl="home",dt=[{label:{id:"Ov9hfp"},value:1},{label:{id:"tVE2wM"},value:2},{label:{id:"8+HOWa"},value:3},{label:{id:"1o+mEC"},value:4},{label:{id:"dZZ8oA"},value:5},{label:{id:"lpPucp"},value:6},{label:{id:"r9r5X6"},value:7},{label:{id:"I9uBFA"},value:8},{label:{id:"pBYFlb"},value:9},{label:{id:"wvL7OJ"},value:10},{label:{id:"7Vb+qD"},value:11},{label:{id:"VU1Pnd"},value:12},{label:{id:"vpc27K"},value:13}],ml={original:{id:"HxF6Fk"},replies:{id:"N8UzTV"},boosts:{id:"puY2t0"},followedTags:{id:"lCLRBe"},groups:{id:"zhrjek"},filtered:{id:"03Qqf9"}},gl=["createdAt","repliesCount","favouritesCount","reblogsCount","density"],bl=[null,"account"],yl=ms(n=>new Intl.DateTimeFormat(n||void 0,{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}));function vl(){const{i18n:n,_:i,_:s}=de(),o=yl(n.locale);Qe("Catch-up","/catchup");const{masto:c,instance:l}=le(),[u,r]=bt(),d=u.get("id"),[a,m]=L("start"),[b,g]=L(!1),p=Ce(()=>vt(),[]),f=R=>R===p,y=et("@pixelfed/home-include-reblogs");async function v({maxCreatedAt:R}){var oe,Oe,Me;const K=R?new Date(R):null,ce=[],J=c.v1.timelines.home.list({limit:40});e:for(;;)try{y&&J.nextParams&&(typeof J.nextParams=="string"?J.nextParams+="&include_reblogs=true":J.nextParams.include_reblogs=!0);const $e=await J.next(),{value:Be}=$e;if(Be!=null&&Be.length){await Vs(Be,l);let Ge=!1;for(let we=0;we<Be.length;we++){const ze=Be[we],tt=new Date(ze.createdAt);if(!K||tt>=K){const Ze=!f(((Oe=(oe=ze.reblog)==null?void 0:oe.account)==null?void 0:Oe.id)||ze.account.id)&&jt(((Me=ze.reblog)==null?void 0:Me.filtered)||ze.filtered,pl);if((Ze==null?void 0:Ze.action)==="hide")continue;ze._filtered=Ze;const kt=at(ze.id,l);ze._followedTags=x.statusFollowedTags[kt]?[...x.statusFollowedTags[kt]]:[],ce.push(ze),Ge=!0}if(!Ge)break e}}else break e;await new Promise(Ge=>setTimeout(Ge,1e3))}catch{break e}return ce.forEach($e=>{if($e!=null&&$e.inReplyToId){const Be=ce.find(Ge=>Ge.id===$e.inReplyToId);Be&&!Be.inReplyToId&&(Be._thread=!0)}}),ce}const[w,_]=L([]),S=q(),k=q(),A=Ce(()=>Cn(),[]),C=st(async({duration:R}={})=>{const K=Date.now(),ce=R?K-R:null;m("loading");const J=await v({maxCreatedAt:ce}),oe=`${A}-${qo()}`;try{await pt.catchup.set(oe,{id:oe,posts:J,count:J.length,startAt:ce,endAt:K}),r({id:oe})}catch{}},[]);ne(()=>{d?(async()=>{const R=await pt.catchup.get(d);R&&(R.posts.sort((K,ce)=>K.createdAt>ce.createdAt?1:-1),_(R.posts),m("results"))})():a==="results"&&(_([]),m("start"))},[d]);const[I,E]=Rt(R=>R+1,0),[M,z]=L(null),[P,W]=L([]);ne(()=>{(async()=>{try{const R=await pt.catchup.keys();if(R.length){const K=Cn(),ce=R.filter(J=>J.startsWith(`${K}-`));if(ce.length){let J=await pt.catchup.getMany(ce);J.sort(($e,Be)=>Be.endAt-$e.endAt);let oe=J.slice(0,3),Oe=J.slice(3);const Me=oe.map($e=>{const{id:Be,count:Ge,startAt:we,endAt:ze}=$e;return{id:Be,count:Ge,startAt:we,endAt:ze}});W(Me),z(oe[0].endAt),J=null,oe=null,queueMicrotask(()=>{Oe.length&&pt.catchup.delMany(Oe.map($e=>$e.id)).then(()=>{Oe=null}).catch($e=>{})});return}}}catch{}W([])})()},[I]),ne(()=>{a==="start"&&E()},[a==="start"]);const[ee,Z]=Ce(()=>{var Be,Ge,we,ze,tt;let R=0,K=0,ce=0,J=0,oe=0,Oe=0;const Me={};for(const xe of w){xe._filtered?(R++,xe.__FILTER="filtered"):xe.group?(K++,xe.__FILTER="groups"):xe.reblog?(ce++,xe.__FILTER="boosts"):(Be=xe._followedTags)!=null&&Be.length?(oe++,xe.__FILTER="followedTags"):xe.inReplyToId&&xe.inReplyToAccountId!==((Ge=xe.account)==null?void 0:Ge.id)?(J++,xe.__FILTER="replies"):(Oe++,xe.__FILTER="original");const Ze=xe.reblog||xe;if(xe.__FILTER!=="filtered"&&((we=Ze.card)!=null&&we.url)&&((ze=Ze.card)!=null&&ze.image)&&((tt=Ze.card)==null?void 0:tt.type)==="link"){const{card:kt,favouritesCount:dn,reblogsCount:$t}=Ze;let{url:nt}=kt;if(nt=nt.replace(/\/$/,""),!Me[nt])Me[nt]={postID:Ze.id,card:kt,shared:1,sharers:[xe.account],likes:dn,boosts:$t};else{if(Me[nt].sharers.find(Ft=>Ft.id===xe.account.id))continue;Me[nt].shared++,Me[nt].sharers.push(xe.account),Me[nt].postID!==Ze.id&&(Me[nt].likes+=dn,Me[nt].boosts+=$t)}}}let $e=[];for(const xe in Me)$e.push({url:xe,...Me[xe]});if($e.sort((xe,Ze)=>xe.shared>Ze.shared?-1:xe.shared<Ze.shared?1:xe.boosts>Ze.boosts?-1:xe.boosts<Ze.boosts?1:xe.likes>Ze.likes?-1:xe.likes<Ze.likes?1:0),$e.length>10)e:for(let xe=10;xe<$e.length;xe++){const{shared:Ze}=$e[xe];if(Ze<=1){$e=$e.slice(0,xe);break e}}return[{filtered:R,groups:K,boosts:ce,replies:J,followedTags:oe,original:Oe},$e]},[w]),[V,U]=L("all"),[B,se]=L(null),[$,F]=L(1),[Y,G]=L("createdAt"),[te,ae]=L("asc"),[ve,_e]=L(null),[j,he,Ae]=Ce(()=>{const R={},K=new Map;let ce=w.filter(oe=>{const Oe=V==="all"||oe.__FILTER===V;return Oe&&(R[oe.account.id]=oe.account,K.set(oe.account.id,(K.get(oe.account.id)||0)+1)),Oe});const J={};return ce.forEach(oe=>{oe.reblog&&(J[oe.reblog.id]?(J[oe.reblog.id].__BOOSTERS?J[oe.reblog.id].__BOOSTERS.add(oe.account):J[oe.reblog.id].__BOOSTERS=new Set([oe.account]),oe.__HIDDEN=!0):J[oe.reblog.id]=oe)}),B&&K.has(B)&&(ce=ce.filter(oe=>oe.account.id===B||[...oe.__BOOSTERS||[]].find(Oe=>Oe.id===B))),[ce,R,Object.fromEntries(K)]},[V,B,w]),Pe=Ce(()=>{const R={};return j.forEach(K=>{R[K.id]=K}),R},[j]),Ne=Ce(()=>Object.keys(Ae).sort((R,K)=>Ae[K]-Ae[R]),[Ae]),Ue=Ce(()=>{const R={};return Ne.forEach((K,ce)=>{R[K]=ce}),j.filter(K=>!K.__HIDDEN).sort((K,ce)=>{if(ve==="account"){const J=K.account.id,oe=ce.account.id,Oe=R[J],Me=R[oe],$e=Oe-Me;if($e!==0)return $e}if(Y!=="createdAt"&&(K=K.reblog||K,ce=ce.reblog||ce,Y!=="density"&&K[Y]===ce[Y]))return K.createdAt>ce.createdAt?1:-1;if(Y==="density"){const J=Ji(K),oe=Ji(ce);return te==="asc"?J>oe?1:-1:oe>J?1:-1}return te==="asc"?K[Y]>ce[Y]?1:-1:ce[Y]>K[Y]?1:-1})},[j,Y,te,ve,Ne]),Re=q(null),Le=q(null),X=q(!1);ne(()=>{w.length>100||X.current||Le.current&&(Ps(Le.current,{duration:200}),X.current=!0)},[w,Le]);const Ie=w.length>160?"3d":"2d",De=Ce(()=>Ie!=="2d"?null:w.map(R=>{const K=Pe[R.id];return e("span",{class:`post-dot ${K?"post-dot-highlight":""}`},R.id)}),[Pe]),fe=Ce(()=>Ie!=="3d"||!(w!=null&&w.length)?null:Tl(w,"createdAt",320).map((K,ce)=>e("div",{class:"posts-bin",children:K.map(J=>{const oe=Pe[J.id];return e("span",{class:`post-dot ${oe?"post-dot-highlight":""}`},J.id)})},ce)),[Pe]),Q=q(null),ge=Ce(()=>M?(Date.now()-M)/1e3/60/60:null,[M,$]);ne(()=>{if(a!=="results")return;const R=B&&he[B]?he[B].username:"",K=te==="asc"?0:1,ce={account:"authors"};let J=me({duration:5e3,text:s({id:"TLYeLT",values:{selectedFilterCategory:V,sortBy:Y,sortOrder:te,groupBy:ve}})});return()=>{var oe;(oe=J==null?void 0:J.hideToast)==null||oe.call(J)}},[a,V,B,Y,te,ve,he]),ne(()=>{var R;if(B&&he[B]){const K=Le.current.querySelector(`[data-author="${B}"]`),ce=(R=Le.current)==null?void 0:R.getBoundingClientRect(),J=K==null?void 0:K.getBoundingClientRect();J.left<ce.left||J.right>ce.right?K.scrollIntoView({block:"nearest",inline:"center",behavior:"smooth"}):J.top<0&&K.scrollIntoView({block:"nearest",inline:"nearest",behavior:"smooth"})}},[B,he]);const[D,ie]=L(!1),ue=".catchup-list > li > a",N=He("j",()=>{const R=document.activeElement.closest(ue),K=R==null?void 0:R.getBoundingClientRect(),ce=Array.from(Q.current.querySelectorAll(ue));if(R&&K.top<Q.current.clientHeight&&K.bottom>0){const J=ce.indexOf(R),oe=ce[J+1];oe&&(oe.focus(),oe.scrollIntoView({block:"center",inline:"center",behavior:"smooth"}))}else{const J=ce.find(oe=>oe.getBoundingClientRect().top>=0);J&&(J.focus(),J.scrollIntoView({block:"nearest",inline:"center",behavior:"smooth"}))}},{preventDefault:!0,ignoreModifiers:!0}),re=He("k",()=>{const R=document.activeElement.closest(ue),K=R==null?void 0:R.getBoundingClientRect(),ce=Array.from(Q.current.querySelectorAll(ue));if(R&&K.top<Q.current.clientHeight&&K.bottom>0){const J=ce.indexOf(R);let oe=ce[J-1];oe&&(oe.focus(),oe.scrollIntoView({block:"center",inline:"center",behavior:"smooth"}))}else{const J=ce.find(oe=>{const Oe=oe.getBoundingClientRect();return Oe.top>=44&&Oe.left>=0});J&&(J.focus(),J.scrollIntoView({block:"nearest",inline:"center",behavior:"smooth"}))}},{preventDefault:!0,ignoreModifiers:!0}),Te=He("h, l",(R,K)=>{var J,oe,Oe;const ce=K.keys[0];if(B){const Me=Ne.indexOf(B);ce==="h"?Me>0&&Me<Ne.length&&(se(Ne[Me-1]),(J=Q.current)==null||J.focus()):ce==="l"&&Me<Ne.length-1&&Me>=0&&(se(Ne[Me+1]),(oe=Q.current)==null||oe.focus())}else ce==="l"&&(se(Ne[0]),(Oe=Q.current)==null||Oe.focus())},{preventDefault:!0,ignoreModifiers:!0,enableOnFormTags:["input"]}),H=He("esc",()=>{var R;se(null),(R=Q.current)==null||R.focus()},{preventDefault:!0,ignoreModifiers:!0,enableOnFormTags:["input"]}),ye=He(".",()=>{var R;(R=Q.current)==null||R.scrollTo({top:0,behavior:"smooth"})},{preventDefault:!0,ignoreModifiers:!0,enableOnFormTags:["input"]}),Ee=st(R=>{const K=document.activeElement,ce=(K==null?void 0:K.tagName)==="INPUT"&&K.type==="radio";if((R.key==="ArrowDown"||R.key==="ArrowUp"||R.key==="ArrowLeft"||R.key==="ArrowRight")&&ce){K.blur();return}},[]);return e("div",{ref:R=>{Q.current=R,N(R),re(R),Te(R),H(R)},id:"catchup-page",class:"deck-container",tabIndex:"-1",children:[e("div",{class:"timeline-deck deck wide",children:[e("header",{class:`${a==="loading"?"loading":""}`,onClick:R=>{var K;R.target.closest("a, button")||(K=Q.current)==null||K.scrollTo({top:0,behavior:"smooth"})},children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Mt,{}),a==="results"&&e(be,{to:"/catchup",class:"button plain",children:e(T,{icon:"history2",size:"l",alt:s({id:"xrl8fj"})})}),a==="start"&&e(be,{to:"/",class:"button plain",children:e(T,{icon:"home",size:"l",alt:s({id:"i0qMbr"})})})]}),e("h1",{children:a!=="start"&&e(h,{id:"wyL/3/",components:{0:e("sup",{})}})}),e("div",{class:"header-side",children:a!=="start"&&a!=="loading"&&e("button",{type:"button",class:"plain",onClick:()=>{ie(!0)},children:e(h,{id:"c3XJ18"})})})]})}),e("main",{onKeyDown:Ee,children:[a==="start"&&e("div",{class:"catchup-start",children:[e("h1",{children:e(h,{id:"wyL/3/",components:{0:e("sup",{})}})}),e("details",{children:[e("summary",{children:e(h,{id:"CxKPv6"})}),e("p",{children:e(h,{id:"YMU1CK"})}),e("img",{src:fl,width:"1200",height:"900",alt:s({id:"CeInO2"})}),e("p",{children:e("button",{type:"button",onClick:R=>{R.target.closest("details").open=!1},children:e(h,{id:"2jI8hh"})})})]}),e("p",{children:e(h,{id:"1RfGk7"})}),e("p",{children:e("b",{children:e(h,{id:"OOEonE"})})}),e("div",{class:"catchup-form",children:[e("input",{ref:S,type:"range",value:$,min:dt[0].value,max:dt[dt.length-1].value,step:"1",list:"catchup-ranges",onChange:R=>F(+R.target.value)})," ",e("span",{style:{width:"8em"},children:[i(dt[$-1].label),e("br",{}),e("small",{class:"insignificant",children:$==dt[dt.length-1].value?s({id:"NMNiaO"}):ot(new Date(Date.now()-$*60*60*1e3))})]}),e("datalist",{id:"catchup-ranges",children:dt.map(({label:R,value:K})=>e("option",{value:K,label:i(R)}))})," ",e("button",{type:"button",onClick:()=>{var R;if($<dt[dt.length-1].value){let K;$===dt[dt.length-1].value&&((R=k.current)!=null&&R.checked)?K=Date.now()-M:K=$*60*60*1e3,C({duration:K})}else C()},children:e(h,{id:"R0yu2l"})})]}),ge&&$>ge?e("p",{class:"catchup-info",children:[e(T,{icon:"info"})," ",e(h,{id:"AGyV7s"})]}):$===dt[dt.length-1].value&&M?e("p",{class:"catchup-info",children:e("label",{children:[e("input",{type:"checkbox",switch:!0,checked:!0,ref:k})," ",e(h,{id:"dDJEHI",values:{0:o.format(new Date(M))}})]})}):null,e("p",{class:"insignificant",children:e("small",{children:e(h,{id:"EAjFM0"})})}),!!(P!=null&&P.length)&&e("div",{class:"catchup-prev",children:[e("p",{children:e(h,{id:"Yfb9A8"})}),e("ul",{children:P.map(R=>e("li",{children:[e(be,{to:`/catchup?id=${R.id}`,children:[e(T,{icon:"history2"})," ",e("span",{children:R.startAt?o.formatRange(new Date(R.startAt),new Date(R.endAt)):`… – ${o.format(new Date(R.endAt))}`})]})," ",e("span",{children:[e("small",{class:"ib insignificant",children:e(h,{id:"S6XZwv",values:{0:R.count}})})," ",e("button",{type:"button",class:"light danger small",onClick:async()=>{var ce;if(confirm(s({id:"D9CmP2"}))){let J=me(s({id:"xJUo4P",values:{0:R.id}}));await pt.catchup.del(R.id),(ce=J==null?void 0:J.hideToast)==null||ce.call(J),me(s({id:"bRDKRy",values:{1:R.id}})),E()}},children:e(T,{icon:"x",alt:s({id:"t/YqKh"})})})]})]},R.id))}),P.length>=3&&e("p",{children:e("small",{children:e(h,{id:"sXmrl4"})})})]})]}),a==="loading"&&e("div",{class:"ui-state catchup-start",children:[e(Fe,{abrupt:!0}),e("p",{class:"insignificant",children:e(h,{id:"rbUTzD"})}),e("p",{class:"insignificant",children:e(h,{id:"q9urQO"})})]}),a==="results"&&e(O,{children:[e("div",{class:"catchup-header",children:[w.length>0&&e("p",{children:e("b",{class:"ib",children:o.formatRange(new Date(w[0].createdAt),new Date(w[w.length-1].createdAt))})}),e("aside",{children:[e("button",{hidden:V==="all"&&!B&&Y==="createdAt"&&te==="asc",type:"button",class:"plain4 small",onClick:()=>{U("all"),se(null),G("createdAt"),_e(null),ae("asc")},children:e(h,{id:"I9EnzM"})}),(Z==null?void 0:Z.length)>0&&e("button",{type:"button",class:"plain small",onClick:()=>g(!b),children:[e(h,{id:"EIZREX"})," ",e(T,{icon:"chevron-down",style:{transform:b?"rotate(180deg)":"rotate(0deg)"}})]})]})]}),e("div",{class:"shazam-container no-animation",hidden:!b,children:e("div",{class:"shazam-container-inner",children:e("div",{class:"catchup-top-links links-bar",children:Z.map(R=>{const{card:K,shared:ce,sharers:J,likes:oe,boosts:Oe}=R,{blurhash:Me,title:$e,description:Be,url:Ge,image:we,imageDescription:ze,language:tt,width:xe,height:Ze,publishedAt:kt}=K,dn=zt.toUnicode(URL.parse(Ge).hostname.replace(/^www\./,"").replace(/\/$/,""));let $t;if(Me){const nt=di(Me),Ft=ki(nt);$t=wi([.6,Ft[1],Ft[2]])}return e("a",{href:Ge,target:"_blank",rel:"noopener",class:"link-block",style:$t?{"--accent-color":`rgb(${$t.join(",")})`,"--accent-alpha-color":`rgba(${$t.join(",")}, 0.4)`}:{},children:e("article",{children:[e("figure",{children:e("img",{src:we,alt:ze,width:xe,height:Ze,loading:"lazy"})}),e("div",{class:"article-body",children:[e("header",{children:[e("div",{class:"article-meta",children:[e("span",{class:"domain",children:dn})," ",!!kt&&e(O,{children:"· "}),!!kt&&e(O,{children:e(It,{datetime:kt,format:"micro"})})]}),!!$e&&e("h1",{class:"title",lang:tt,dir:"auto",title:$e,children:$e})]}),!!Be&&e("p",{class:"description",lang:tt,dir:"auto",title:Be,children:Be}),e("hr",{}),e("p",{style:{whiteSpace:"nowrap"},children:e(h,{id:"bfSr6z",values:{0:J.map(nt=>{const{avatarStatic:Ft,displayName:fo}=nt;return e("button",{type:"button",class:"plain",style:{padding:0},onClick:Ii=>{Ii.preventDefault(),Ii.stopPropagation();const{id:po}=nt;se(po),U("all")},children:e(ft,{url:Ft,size:"s",alt:fo})})})}})})]})]})},Ge)})})})}),w.length>=5&&(Ie==="3d"?e("div",{class:"catchup-posts-viz-time-bar",children:fe}):e("div",{class:"catchup-posts-viz-bar",children:De})),w.length>=2&&e("div",{class:"catchup-filters",children:[e("label",{class:"filter-cat",children:[e("input",{type:"radio",name:"filter-cat",checked:V.toLowerCase()==="all",onChange:()=>{U("all")}}),e(h,{id:"N40H+G"})," ",e("span",{class:"count",children:w.length})]}),Object.entries(ml).map(([R,K])=>!!ee[R]&&e("label",{class:"filter-cat",title:(ee[R]/w.length*100).toFixed(2)+"%",children:[e("input",{type:"radio",name:"filter-cat",checked:V.toLowerCase()===R.toLowerCase(),onChange:()=>{U(R),R==="boosts"&&(G("reblogsCount"),ae("desc"),_e(null))}}),i(K)," ",e("span",{class:"count",children:ee[R]})]},i(K)))]}),w.length>=2&&!!Ae&&e("div",{class:"catchup-filters authors-filters",ref:Le,children:[Ne.map(R=>e("label",{class:"filter-author","data-author":R,children:[e("input",{type:"radio",name:"filter-author",checked:B===R,onChange:()=>{se(R)},onClick:()=>{B===R&&se(null)}}),e(ft,{url:he[R].avatarStatic||he[R].avatar,size:"xxl",alt:`${he[R].displayName} (@${he[R].acct})`})," ",e("span",{class:"count",children:Ae[R]}),e("span",{class:"username",children:he[R].username})]},`${R}-${Ae[R]}`)),Ne.length>5&&e("small",{style:{whiteSpace:"nowrap",paddingInline:"1em",opacity:.33},children:e(h,{id:"HHtYi7",values:{0:Ne.length}})},"authors-count")]}),w.length>=2&&e("div",{class:"catchup-filters",children:[e("span",{class:"filter-label",children:e(h,{id:"f6Hub0"})})," ",e("fieldset",{class:"radio-field-group",children:gl.map(R=>e("label",{class:"filter-sort",onClick:K=>{Y===R&&(K.preventDefault(),K.stopPropagation(),ae(te==="asc"?"desc":"asc"))},children:[e("input",{type:"radio",name:"filter-sort-cat",checked:Y===R,onChange:()=>{G(R);const K=/(replies|favourites|reblogs)/.test(R)?"desc":"asc";ae(K)}}),{createdAt:s({id:"mYGY3B"}),repliesCount:s({id:"N8UzTV"}),favouritesCount:s({id:"zZOZj7"}),reblogsCount:s({id:"puY2t0"}),density:s({id:"0tQ7AD"})}[R],Y===R&&(te==="asc"?" ↑":" ↓")]},R))}),e("span",{class:"filter-label",children:e(h,{id:"group.filter"})})," ",e("fieldset",{class:"radio-field-group",children:bl.map(R=>e("label",{class:"filter-group",children:[e("input",{type:"radio",name:"filter-group",checked:ve===R,onChange:()=>{_e(R)},disabled:R==="account"&&B}),{account:s({id:"dpqPBg"})}[R]||s({id:"EdQY6l"})]},R||"none"))}),B&&Ne.length>1?e("button",{type:"button",class:"plain6 small",onClick:()=>{se(null)},style:{whiteSpace:"nowrap"},children:e(h,{id:"/dlmrZ"})}):null]}),e("ul",{class:`catchup-list catchup-filter-${V||""} ${Y?`catchup-sort-${Y}`:""} ${B&&he[B]?"catchup-selected-author":""} ${ve?`catchup-group-${ve}`:""}`,children:Ue.map((R,K)=>{var oe;const ce=((oe=R.reblog)==null?void 0:oe.id)||R.id;let J=!1;return ve==="account"&&(Re.current&&R.account.id!==Re.current&&K>0&&(J=!0),Re.current=R.account.id),e(O,{children:[J&&e("li",{class:"separator"}),e(kl,{to:`/${l}/s/${ce}`,post:R,root:Q.current})]},`${R.id}-${J}`)})}),e("footer",{children:j.length>5&&e("p",{children:[s(V==="boosts"?{id:"eVosYr"}:{id:"rhmyFK"})," ",e("button",{type:"button",class:"textual",onClick:()=>{Q.current.scrollTop=0},children:e(h,{id:"0MgdN+"})}),"."]})})]})]})]}),D&&e(qe,{onClose:()=>ie(!1),children:e("div",{class:"sheet",id:"catchup-help-sheet",children:[e("button",{type:"button",class:"sheet-close",onClick:()=>ie(!1),children:e(T,{icon:"x",alt:s({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(h,{id:"c3XJ18"})})}),e("main",{children:e("dl",{children:[e("dt",{children:e(h,{id:"EIZREX"})}),e("dd",{children:e(h,{id:"YmGrIy"})}),e("dt",{children:e(h,{id:"coaNtr"})}),e("dd",{children:e(h,{id:"UUrqX1"})}),e("dt",{children:e(h,{id:"ScQBC/"})}),e("dd",{children:e(h,{id:"srocAr"})}),e("dt",{children:e(h,{id:"77Emn0"})}),e("dd",{children:e("table",{children:e("tbody",{children:[e("tr",{children:[e("td",{children:e(h,{id:"Gy9P9T"})}),e("td",{children:e("kbd",{children:"j"})})]}),e("tr",{children:[e("td",{children:e(h,{id:"6XYpYY"})}),e("td",{children:e("kbd",{children:"k"})})]}),e("tr",{children:[e("td",{children:e(h,{id:"f5dduh"})}),e("td",{children:e("kbd",{children:"l"})})]}),e("tr",{children:[e("td",{children:e(h,{id:"rj0vxZ"})}),e("td",{children:e("kbd",{children:"h"})})]}),e("tr",{children:[e("td",{children:e(h,{id:"jsFF8C"})}),e("td",{children:e("kbd",{children:"Enter"})})]}),e("tr",{children:[e("td",{children:e(h,{id:"bUUv3P"})}),e("td",{children:e("kbd",{children:"."})})]})]})})})]})})]})})]})}const wl=rt(function({post:n}){const{id:i,account:s,group:o,reblog:c,inReplyToId:l,inReplyToAccountId:u,_followedTags:r,_filtered:d,visibility:a,__BOOSTERS:m}=n,b=l&&u!==s.id,g=!!d,p=f=>{f.shiftKey};return e("article",{class:`post-line ${o?"group":c?"reblog":r!=null&&r.length?"followed-tags":""} ${b?"reply-to":""} ${g?"filtered":""} visibility-${a}`,onMouseEnter:p,children:[e("span",{class:"post-author",children:c?e("span",{class:"post-reblog-avatar",children:[e(ft,{url:s.avatarStatic||s.avatar,squircle:s.bot}),(m==null?void 0:m.size)>0?[...m].map(f=>e(ft,{url:f.avatarStatic||f.avatar,squircle:f.bot})):""," ",e(T,{icon:"rocket"})," ",e(mt,{account:c.account,showAvatar:!0})]}):e(mt,{account:s,showAvatar:!0})}),e(Cl,{post:c||n,filterInfo:d}),e("span",{class:"post-meta",children:[e(Il,{post:c||n})," ",e(It,{datetime:new Date((c==null?void 0:c.createdAt)||n.createdAt),format:"micro"})]})]})},(n,i)=>{var s,o;return((s=n==null?void 0:n.post)==null?void 0:s.id)===((o=i==null?void 0:i.post)==null?void 0:o.id)}),kl=({root:n,to:i,...s})=>{const o=q(),[c,l]=L(!1);return ne(()=>{const u=new IntersectionObserver(r=>{r[0].isIntersecting&&(queueMicrotask(()=>l(!0)),u.unobserve(o.current))},{root:n,rootMargin:`${Math.max(320,screen.height*.75)}px`});return o.current&&u.observe(o.current),()=>{o.current&&u.unobserve(o.current)}},[]),c?e("li",{children:e(be,{to:i,children:e(wl,{...s})})}):e("li",{ref:o,style:{height:"4em"}})},Sl=8,_l=8;function Ji(n){var d;const{spoilerText:i,content:s,poll:o,mediaAttachments:c,card:l}=n,u=(d=o==null?void 0:o.options)!=null&&d.length?o.options.reduce((a,m)=>a+m.title,""):"";return(i.length+Ts(s)+u.length)/140+(c!=null&&c.length?Sl*c.length:l!=null&&l.image?_l:0)}const At=48;function Cl({post:n,filterInfo:i}){var S;const{_:s}=de(),{spoilerText:o,sensitive:c,content:l,emojis:u,poll:r,mediaAttachments:d,card:a,inReplyToId:m,inReplyToAccountId:b,account:g,_thread:p}=n,f=m&&b===g.id||!!p,y=Ce(()=>!!(ke.account.get("preferences")||{})["reading:expand:spoilers"],[]),v=y||!o&&!c,w=l?Ln(n):"",_=!o||y;return e("div",{class:"post-peek",title:o?"":w,children:[e("span",{class:"post-peek-content",children:[f&&!_&&e(O,{children:[e("span",{class:"post-peek-tag post-peek-thread",children:"Thread"})," "]}),i?e("span",{class:"post-peek-filtered",children:i!=null&&i.titlesStr?s({id:"suKjh3",values:{0:i.titlesStr}}):s({id:"03Qqf9"})}):e(O,{children:[!!o&&e("span",{class:"post-peek-spoiler",children:[e(T,{icon:`${y?"eye-open":"eye-close"}`})," ",o]}),_&&e("div",{class:"post-peek-html",children:[f&&e(O,{children:[e("span",{class:"post-peek-tag post-peek-thread",children:e(h,{id:"e66y2Z"})})," "]}),!!l&&e("div",{dangerouslySetInnerHTML:{__html:Yo(l,u)}}),!!((S=r==null?void 0:r.options)!=null&&S.length)&&r.options.map(k=>e("div",{children:[r.multiple?"▪️":"•"," ",k.title]})),!l&&(d==null?void 0:d.length)===1&&d[0].description&&e(O,{children:[e("span",{class:"post-peek-tag post-peek-alt",children:"ALT"})," ",e("div",{children:d[0].description})]})]})]})]}),!i&&e("span",{class:"post-peek-post-content",children:[!!r&&e("span",{class:"post-peek-tag post-peek-poll",children:[e(T,{icon:"poll",size:"s"}),e(h,{id:"4WUbF1"})]}),d!=null&&d.length?d.map(k=>{var M,z,P,W,ee,Z,V,U,B,se;const A=k.previewUrl||k.url,C=k.previewRemoteUrl||k.remoteUrl,I=(M=k.meta)!=null&&M.original?k.meta.original.width:((P=(z=k.meta)==null?void 0:z.small)==null?void 0:P.width)||((ee=(W=k.meta)==null?void 0:W.original)==null?void 0:ee.width),E=(Z=k.meta)!=null&&Z.original?k.meta.original.height:((U=(V=k.meta)==null?void 0:V.small)==null?void 0:U.height)||((se=(B=k.meta)==null?void 0:B.original)==null?void 0:se.height);return e("span",{class:"post-peek-media",children:{image:(A||C)&&v?e("img",{src:A,width:At,height:At,alt:k.description,loading:"lazy",onError:$=>{const{src:F}=$.target;F===A&&($.target.src=C)},style:{"--anim-duration":`${Math.min(Math.max(Math.max(I,E)/100,5),120)}s`}}):e("span",{class:"post-peek-faux-media",children:"🖼"}),gifv:(A||C)&&v?e("img",{src:A,width:At,height:At,alt:k.description,loading:"lazy",onError:$=>{const{src:F}=$.target;F===A&&($.target.src=C)}}):e("span",{class:"post-peek-faux-media",children:"🎞️"}),video:(A||C)&&v?e("img",{src:A,width:At,height:At,alt:k.description,loading:"lazy",onError:$=>{const{src:F}=$.target;F===A&&($.target.src=C)}}):e("span",{class:"post-peek-faux-media",children:"📹"}),audio:e("span",{class:"post-peek-faux-media",children:"🎵"})}[k.type]||null},k.id)}):!!a&&a.image&&v&&e("span",{class:`post-peek-media post-peek-card card-${a.type||""}`,children:a.image?e("img",{src:a.image,width:At,height:At,alt:a.title||a.description||a.imageDescription,loading:"lazy",style:{"--anim-duration":a.width&&a.height&&`${Math.min(Math.max(Math.max(a.width,a.height)/100,5),120)}s`}}):e("span",{class:"post-peek-faux-media",children:"🔗"})})]})]})}function Il({post:n}){const{_:i}=de(),{reblogsCount:s,repliesCount:o,favouritesCount:c}=n;return e("span",{class:"post-stats",children:[o>0&&e("span",{class:"post-stat-replies",children:[e(T,{icon:"comment2",size:"s",alt:i({id:"N8UzTV"})})," ",Xe(o)]}),c>0&&e("span",{class:"post-stat-likes",children:[e(T,{icon:"heart",size:"s",alt:i({id:"zZOZj7"})})," ",Xe(c)]}),s>0&&e("span",{class:"post-stat-boosts",children:[e(T,{icon:"rocket",size:"s",alt:i({id:"puY2t0"})})," ",Xe(s)]})]})}function Tl(n,i,s){const o=n.map(d=>new Date(d[i])),c=o.reduce((d,a)=>a<d?a:d,o[0]),l=o.reduce((d,a)=>a>d?a:d,o[0]),u=Math.min(l.getTime(),Date.now())-c.getTime(),r=Array.from({length:s},()=>[]);return n.forEach(d=>{const a=new Date(d[i]);if(a.getTime()>Date.now())r[r.length-1].push(d);else{const m=(a.getTime()-c.getTime())/u,b=Math.floor(m*(s-1));r[b].push(d)}}),r}const Al=20;function Ks(){const{_:n}=de();Qe(n({id:"zZOZj7"}),"/favourites");const{masto:i,instance:s}=le(),o=q();async function c(l){return(l||!o.current)&&(o.current=i.v1.favourites.list({limit:Al})),await o.current.next()}return e(Tt,{title:n({id:"zZOZj7"}),id:"favourites",emptyText:n({id:"PHIrMr"}),errorText:n({id:"khVljG"}),instance:s,fetchItems:c})}const xl=["home","public","notifications","thread","account"],Qi=["notifications","thread","account"],El={home:{id:"Buy2bt"},notifications:{id:"iDNBZe"},public:{id:"RO10dm"},thread:{id:"EnJuK0"},account:{id:"vrQQgz"}},Rl=[0,30*60,60*60,6*60*60,12*60*60,60*60*24,60*60*24*7,60*60*24*30],jn={0:{id:"qqeAJM"},1800:it(30,"minute"),3600:it(1,"hour"),21600:it(6,"hour"),43200:it(12,"hour"),86400:it(24,"hour"),604800:it(7,"day"),2592e3:it(30,"day")};function Ll(){const{_:n}=de(),{masto:i}=le();Qe(n({id:"cSev+j"}),"/ft");const[s,o]=L("default"),[c,l]=L(!1),[u,r]=Rt(m=>m+1,0),[d,a]=L([]);return ne(()=>{o("loading"),(async()=>{try{const m=await i.v2.filters.list();m.sort((b,g)=>b.title.localeCompare(g.title)),m.forEach(b=>{var g;(g=b.keywords)!=null&&g.length&&b.keywords.sort((p,f)=>p.id-f.id)}),a(m),o("default")}catch{o("error")}})()},[u]),e("div",{id:"filters-page",class:"deck-container",tabIndex:"-1",children:[e("div",{class:"timeline-deck deck",children:[e("header",{children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Mt,{}),e(be,{to:"/",class:"button plain",children:e(T,{icon:"home",size:"l",alt:n({id:"i0qMbr"})})})]}),e("h1",{children:e(h,{id:"cSev+j"})}),e("div",{class:"header-side",children:e("button",{type:"button",class:"plain",onClick:()=>{l(!0)},children:e(T,{icon:"plus",size:"l",alt:n({id:"yFfBdX"})})})})]})}),e("main",{children:d.length>0?e(O,{children:[e("ul",{class:"filters-list",children:d.map(m=>{const{id:b,title:g,expiresAt:p,keywords:f}=m;return e("li",{children:[e("div",{children:[e("h2",{children:g}),(f==null?void 0:f.length)>0&&e("div",{children:f.map(y=>e(O,{children:[e("span",{class:"tag collapsed insignificant",children:y.wholeWord?`“${y.keyword}”`:y.keyword})," "]}))}),e("small",{class:"insignificant",children:e(Ws,{expiresAt:p})})]}),e("button",{type:"button",class:"plain",onClick:()=>{l({filter:m})},children:e(T,{icon:"pencil",size:"l",alt:"Edit filter"})})]},b)})}),d.length>1&&e("footer",{class:"ui-state",children:e("small",{class:"insignificant",children:e(h,{id:"5vzJxv",values:{0:d.length}})})})]}):s==="loading"?e("p",{class:"ui-state",children:e(Fe,{})}):s==="error"?e("p",{class:"ui-state",children:e(h,{id:"qcAUwp"})}):e("p",{class:"ui-state",children:e(h,{id:"cWIHTt"})})})]}),!!c&&e(qe,{title:n({id:"vCSBPD"}),onClose:()=>{l(!1)},children:e(Pl,{filter:c==null?void 0:c.filter,onClose:m=>{m.state==="success"&&r(),l(!1)}})})]})}let Ml=1;const $l=()=>Ml++;function Pl({filter:n,onClose:i}){const{_:s,_:o}=de(),{masto:c}=le(),[l,u]=L("default"),r=!!n,{context:d,expiresAt:a,id:m,keywords:b,title:g,filterAction:p}=n||{},f=!!a,y=f&&new Date(a),[v,w]=L(b||[]),_=q(),[S,k]=L([]),[A,C]=L([]),I=v.filter(E=>!S.includes(E.id)&&!A.includes(E._id));return e("div",{class:"sheet",id:"filters-add-edit-modal",children:[!!i&&e("button",{type:"button",class:"sheet-close",onClick:i,children:e(T,{icon:"x",alt:o({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:o(r?{id:"3mOee6"}:{id:"yFfBdX"})})}),e("main",{children:e("form",{onSubmit:E=>{E.preventDefault();const M=new FormData(E.target),z=M.get("title"),P=M.getAll("keyword_attributes[][id]"),W=M.getAll("keyword_attributes[][keyword]"),ee=[..._.current.querySelectorAll('input[name="keyword_attributes[][whole_word]"]')].map(se=>se.checked),Z=W.map((se,$)=>({id:P[$]||void 0,keyword:se,wholeWord:ee[$]}));r&&(S!=null&&S.length)&&S.forEach(se=>{Z.push({id:se,_destroy:!0})});const V=M.getAll("context");let U=M.get("expires_in");const B=M.get("filter_action");!z||!(V!=null&&V.length)||(u("loading"),(async()=>{try{let se;r?(U===""||U===null?f?U=Math.floor((y-new Date)/1e3):U=null:U==="0"||U===0?U=null:U=+U,se=await c.v2.filters.$select(m).update({title:z,context:V,expiresIn:U,keywordsAttributes:Z,filterAction:B})):(U=+U||null,se=await c.v2.filters.create({title:z,context:V,expiresIn:U,keywordsAttributes:Z,filterAction:B})),u("default"),i==null||i({state:"success",filter:se})}catch{u("error"),alert(o(r?{id:"H8RP+h"}:{id:"Fr0hAN"}))}})())},children:[e("div",{class:"filter-form-row",children:e("label",{children:[e("b",{children:e(h,{id:"MHrjPM"})}),e("input",{type:"text",name:"title",defaultValue:g,disabled:l==="loading",dir:"auto",required:!0})]})}),e("div",{class:"filter-form-keywords",ref:_,children:[I.length?e("ul",{class:"filter-keywords",children:I.map(E=>{const{id:M,keyword:z,wholeWord:P,_id:W}=E;return e("li",{children:[e("input",{type:"hidden",name:"keyword_attributes[][id]",value:M}),e("input",{name:"keyword_attributes[][keyword]",type:"text",defaultValue:z,disabled:l==="loading",required:!0,dir:"auto"}),e("div",{class:"filter-keyword-actions",children:[e("label",{children:[e("input",{name:"keyword_attributes[][whole_word]",type:"checkbox",value:M,defaultChecked:P,disabled:l==="loading"})," ",e(h,{id:"/7UQ7y"})]}),e("button",{type:"button",class:"light danger small",disabled:l==="loading",onClick:()=>{M?(S.push(M),k([...S])):W&&(A.push(W),C([...A]))},children:e(T,{icon:"x",alt:o({id:"t/YqKh"})})})]})]},`${M}-${W}`)})}):e("div",{class:"filter-keywords",children:e("div",{class:"insignificant",children:e(h,{id:"SYKm3p"})})}),e("footer",{class:"filter-keywords-footer",children:[e("button",{type:"button",class:"light",onClick:()=>{w([...v,{_id:$l(),keyword:"",wholeWord:!0}]),setTimeout(()=>{var M,z;const E=_.current.querySelectorAll('input[type="text"]');(z=(M=E[E.length-1])==null?void 0:M.focus)==null||z.call(M)},10)},children:e(h,{id:"qn5Dbn"})})," ",(I==null?void 0:I.length)>1&&e("small",{class:"insignificant",children:e(h,{id:"1JZ175",values:{0:I.length}})})]})]}),e("div",{class:"filter-form-cols",children:[e("div",{class:"filter-form-col",children:[e("div",{children:e("b",{children:e(h,{id:"uqf7Yq"})})}),xl.map(E=>e("div",{children:[e("label",{class:Qi.includes(E)?"insignificant":"",children:[e("input",{type:"checkbox",name:"context",value:E,defaultChecked:d?d.includes(E):!0,disabled:l==="loading"})," ",s(El[E]),Qi.includes(E)?"*":""]})," "]})),e("p",{children:e("small",{class:"insignificant",children:e(h,{id:"m0G499"})})})]}),e("div",{class:"filter-form-col",children:[r&&e(h,{id:"ucJk3m",components:{0:e("b",{}),1:e(Ws,{expiresAt:a,showNeverExpires:!0})}}),e("div",{children:[e("label",{for:"filters-expires_in",children:o(r?{id:"BcNdg+"}:{id:"agO/T/"})}),e("select",{id:"filters-expires_in",name:"expires_in",disabled:l==="loading",defaultValue:r?void 0:0,children:[r&&e("option",{}),Rl.map(E=>e("option",{value:E,children:typeof jn[E]=="function"?jn[E]():s(jn[E])}))]})]}),e("p",{children:[e(h,{id:"blQMpa"}),e("br",{}),e("label",{class:"ib",children:[e("input",{type:"radio",name:"filter_action",value:"warn",defaultChecked:p==="warn"||!r,disabled:l==="loading"})," ",e(h,{id:"jbreWy"})]})," ",e("label",{class:"ib",children:[e("input",{type:"radio",name:"filter_action",value:"hide",defaultChecked:p==="hide",disabled:l==="loading"})," ",e(h,{id:"zNCBmf"})]})]})]})]}),e("footer",{class:"filter-form-footer",children:[e("span",{children:[e("button",{type:"submit",disabled:l==="loading",children:o(r?{id:"tfDRzk"}:{id:"hYgDIe"})})," ",e(Fe,{abrupt:!0,hidden:l!=="loading"})]}),r&&e(ut,{disabled:l==="loading",align:"end",menuItemClassName:"danger",confirmLabel:o({id:"BPjyR2"}),onClick:()=>{u("loading"),(async()=>{try{await c.v2.filters.$select(m).remove(),u("default"),i==null||i({state:"success"})}catch{u("error"),alert(o({id:"4Dh9J1"}))}})()},children:e("button",{type:"button",class:"light danger",onClick:()=>{},disabled:l==="loading",children:e(h,{id:"Jb6/SB"})})})]})]})})]})}function Ws({expiresAt:n,showNeverExpires:i}){const{_:s}=de(),o=!!n,c=o&&new Date(n),l=o&&c<=new Date,[u,r]=Rt(d=>d+1,0);return ai(r,l||3e4),l?s({id:"M1RnFv"}):o?e(h,{id:"urGtsw",components:{0:e(It,{datetime:c})}}):i&&s({id:"O1Aswy"})}function Nl(){const{_:n}=de(),{masto:i,instance:s}=le();Qe(n({id:"Xi1/bw"}),"/fh");const[o,c]=L("default"),[l,u]=L([]);return ne(()=>{c("loading"),(async()=>{try{const r=await xn();u(r),c("default")}catch{c("error")}})()},[]),e("div",{id:"followed-hashtags-page",class:"deck-container",tabIndex:"-1",children:e("div",{class:"timeline-deck deck",children:[e("header",{children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Mt,{}),e(be,{to:"/",class:"button plain",children:e(T,{icon:"home",size:"l",alt:n({id:"i0qMbr"})})})]}),e("h1",{children:e(h,{id:"Xi1/bw"})}),e("div",{class:"header-side"})]})}),e("main",{children:l.length>0?e(O,{children:[e("ul",{class:"link-list",children:l.map(r=>e("li",{children:e(be,{to:s?`/${s}/t/${r.name}`:`/t/${r.name}`,children:[e(T,{icon:"hashtag",alt:"#"})," ",e("span",{children:r.name})]})}))}),l.length>1&&e("footer",{class:"ui-state",children:e("small",{class:"insignificant",children:e(h,{id:"2S/uvJ",values:{0:l.length}})})})]}):o==="loading"?e("p",{class:"ui-state",children:e(Fe,{abrupt:!0})}):o==="error"?e("p",{class:"ui-state",children:e(h,{id:"2AeREO"})}):e("p",{class:"ui-state",children:e(h,{id:"vKsGhk"})})})]})})}const Dl=20;function _i({title:n,path:i,id:s,...o}){const{_:c}=de();Qe(n||c({id:"following.title"}),i||"/following");const{masto:l,streaming:u,instance:r}=le(),d=Ve(x),a=q(),m=q();__BENCHMARK.end("time-to-following");const b=et("@pixelfed/home-include-reblogs");async function g(f){var w;(f||!a.current)&&(__BENCHMARK.start("fetch-home-first"),a.current=l.v1.timelines.home.list({limit:Dl})),b&&((w=a.current)!=null&&w.nextParams)&&(typeof a.current.nextParams=="string"?a.current.nextParams+="&include_reblogs=true":a.current.nextParams.include_reblogs=!0);const y=await a.current.next();let{value:v}=y;if(v!=null&&v.length){let _=!1;f&&(v[0].id!==m.current&&(_=!0),m.current=v[0].id),v.forEach(S=>{Je(S,r)}),v=Wi(v,r),f&&_&&Ka(),Vs(v,r),v.sort((S,k)=>{const A=new Date(S.createdAt);return new Date(k.createdAt)-A})}return __BENCHMARK.end("fetch-home-first"),{...y,value:v}}async function p(){var f;try{const y={limit:5,since_id:m.current};et("@pixelfed/home-include-reblogs")&&(y.include_reblogs=!0);const v=await l.v1.timelines.home.list(y).next();let{value:w}=v;const _=((f=w[0])==null?void 0:f.id)===m.current;return!!(w!=null&&w.length&&!_&&(m.current=w[0].id,w=Wi(w,r),w=Dt(w,"home"),w.some(S=>!S.reblog)))}catch{return!1}}return ne(()=>{let f;return(async()=>{if(u){f=u.user.subscribe();for await(const y of f){if(!f)break;if(y.event==="status.update"){const v=y.payload;Je(v,r)}else if(y.event==="delete"){const v=y.payload,w=gs(v,r);w&&(w._deleted=!0)}}}})(),()=>{var y;(y=f==null?void 0:f.unsubscribe)==null||y.call(f),f=null}},[u]),e(Tt,{title:n||c({id:"following.title"}),id:s||"following",emptyText:c({id:"nJEKbY"}),errorText:c({id:"7QSeK6"}),instance:r,fetchItems:g,checkForUpdates:p,useItemID:!0,boostsCarousel:d.settings.boostsCarousel,...o,filterContext:"home",showFollowedTags:!0,showReplyParent:!0})}const Ol=20,zl=4,es=zl+1;function Zs({media:n,columnMode:i,...s}){const{_:o}=de();let{hashtag:c,...l}=i?{}:Lt();s.hashtag&&(c=s.hashtag);let u=c.trim().split(/[\s+]+/);u.sort(),c=u[0];const[r,d]=bt(),a=n||!!r.get("media"),m=a?"?media=1":"",{masto:b,instance:g,authenticated:p}=le({instance:(s==null?void 0:s.instance)||l.instance}),{masto:f,instance:y,authenticated:v}=le(),w=u.map($=>`#${$}`).join(" "),_=o(g?a?{id:"kH0rA0",values:{hashtagTitle:w,instance:g}}:{id:"IK0zKi",values:{hashtagTitle:w,instance:g}}:a?{id:"hHSI3w",values:{hashtagTitle:w}}:{id:"+ZzjRY",values:{hashtagTitle:w}});Qe(_,"/:instance?/t/:hashtag");const S=q(),k=Ce(()=>oi(),[]),A=q(void 0);async function C($){const F=await b.v1.timelines.tag.$select(c).list({limit:Ol,any:u.slice(1),maxId:$?void 0:A.current,onlyMedia:a?!0:void 0}).next();let{value:Y}=F;return Y!=null&&Y.length&&($&&(S.current=Y[0].id),Y.forEach(G=>{Je(G,g,{skipThreading:a||k})}),A.current=Y[Y.length-1].id),{...F,value:Y}}async function I(){var $;try{const F=await b.v1.timelines.tag.$select(c).list({limit:1,any:u.slice(1),since_id:S.current,onlyMedia:a}).next();let{value:Y}=F;const G=(($=Y[0])==null?void 0:$.id)===S.current;return Y!=null&&Y.length&&!G?(Y=Dt(Y,"public"),!0):!1}catch{return!1}}const[E,M]=L("default"),[z,P]=L();ne(()=>{(async()=>{try{const $=await b.v1.tags.$select(c).fetch();P($)}catch{}})()},[c]);const W=u.length>=es,[ee,Z]=L("default"),[V,U]=L([]),[B,se]=L(!1);return ne(()=>{p&&(async()=>{try{const $=await b.v1.featuredTags.list();U($),se($.some(F=>F.name.toLowerCase()===c.toLowerCase()))}catch{}})()},[]),e(Tt,{title:_,titleComponent:!!g&&e("h1",{class:"header-double-lines",children:[e("b",{dir:"auto",children:w}),e("div",{children:g})]}),id:"hashtag",instance:g,emptyText:o({id:"CNSLAW"}),errorText:o({id:"yjj6Ll"}),fetchItems:C,checkForUpdates:I,useItemID:!0,view:a||k?"media":void 0,refresh:a,filterContext:"public",headerEnd:e(lt,{portal:!0,setDownOverflow:!0,overflow:"auto",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(T,{icon:"more",size:"l",alt:o({id:"2FYpfJ"})})}),children:[!!z&&u.length===1&&e(O,{children:[e(ut,{subMenu:!0,confirm:z.following,confirmLabel:o({id:"ctJi7k",values:{hashtag:c}}),disabled:E==="loading"||!p,onClick:()=>{M("loading"),z.following?b.v1.tags.$select(c).unfollow().then(()=>{P({...z,following:!1}),me(o({id:"doK/ij",values:{hashtag:c}}))}).catch($=>{alert($)}).finally(()=>{M("default")}):b.v1.tags.$select(c).follow().then(()=>{P({...z,following:!0}),me(o({id:"R9+aEN",values:{hashtag:c}}))}).catch($=>{alert($)}).finally(()=>{M("default")})},children:z.following?e(O,{children:[e(T,{icon:"check-circle"})," ",e("span",{children:e(h,{id:"HOSk7R"})})]}):e(O,{children:[e(T,{icon:"plus"})," ",e("span",{children:e(h,{id:"MKEPCY"})})]})}),e(Se,{type:"checkbox",checked:B,disabled:ee==="loading"||!p,onClick:()=>{if(Z("loading"),B){const $=V.find(F=>F.name.toLowerCase()===c.toLowerCase()).id;$?b.v1.featuredTags.$select($).remove().then(()=>{se(!1),me(o({id:"VH+Tf9"})),U(V.filter(F=>F.id!==$))}).catch(F=>{}).finally(()=>{Z("default")}):me(o({id:"3OLv47"}))}else b.v1.featuredTags.create({name:c}).then($=>{se(!0),me(o({id:"9ra4hn"})),U(V.concat($))}).catch($=>{}).finally(()=>{Z("default")})},children:B?e(O,{children:[e(T,{icon:"check-circle"}),e("span",{children:e(h,{id:"9ra4hn"})})]}):e(O,{children:[e(T,{icon:"check-circle"}),e("span",{children:e(h,{id:"UlJ3QN"})})]})}),e(We,{})]}),!k&&e(O,{children:[e(As,{className:"plain",children:e(h,{id:"cSev+j"})}),e(Se,{type:"checkbox",checked:!!a,onClick:()=>{a?r.delete("media"):r.set("media","1"),d(r)},children:[e(T,{icon:"check-circle",alt:"☑️"})," ",e("span",{class:"menu-grow",children:e(h,{id:"eK4SL/"})})]}),e(We,{})]}),e(jo,{className:"menu-field",disabled:W,children:({ref:$})=>e("form",{onSubmit:F=>{var G,te;F.preventDefault();const Y=(te=(G=F.target[0].value)==null?void 0:G.trim)==null?void 0:te.call(G);Y&&!u.some(ae=>ae.toLowerCase()===Y.toLowerCase())&&(u.push(Y),u.sort(),location.hash=g?`/${g}/t/${u.join("+")}${m}`:`/t/${u.join("+")}${m}`)},children:[e(T,{icon:"hashtag"}),e("input",{ref:$,type:"text",placeholder:W?pe._({id:"ouWc/D",values:{TOTAL_TAGS_LIMIT:es}}):o({id:"cxL5F9"}),required:!0,autocorrect:"off",autocapitalize:"off",spellCheck:!1,pattern:"[^#][^\\s#]+[^#]",disabled:W,dir:"auto"})]})}),e(Vo,{takeOverflow:!0,children:u.map(($,F)=>e(Se,{disabled:u.length===1,onClick:Y=>{u.splice(F,1),u.sort(),location.hash=g?`/${g}/t/${u.join("+")}${m}`:`/t/${u.join("+")}${m}`},children:[e(T,{icon:"x",alt:o({id:"OISAkj"}),class:"danger-icon"}),e("span",{class:"bidi-isolate",children:[e("span",{class:"more-insignificant",children:"#"}),$]})]},$))}),e(We,{}),e(Se,{disabled:!v,onClick:()=>{if(x.shortcuts.length>=_t){alert(pe._({id:"XN1xAY",values:{SHORTCUTS_LIMIT:_t}}));return}const $={type:"hashtag",hashtag:u.join(" "),instance:g,media:a?"on":void 0};x.shortcuts.some(Y=>Y.type===$.type&&Y.hashtag.split(/[\s+]+/).sort().join(" ")===$.hashtag.split(/[\s+]+/).sort().join(" ")&&(Y.instance?Y.instance===$.instance:!0)&&(Y.media?!!Y.media==!!$.media:!0))?alert(o({id:"kfeQnS"})):(x.shortcuts.push($),me(o({id:"MIhb91"})))},children:[e(T,{icon:"shortcut"})," ",e("span",{children:e(h,{id:"i02Lq/"})})]}),e(Se,{onClick:()=>{let $=prompt(o({id:"2MQ2cd"}));if(!/\./.test($)){$&&alert(o({id:"7WddtO"}));return}$&&($=$.toLowerCase().trim(),location.hash=`/${$}/t/${u.join("+")}${m}`)},children:[e(T,{icon:"bus"})," ",e("span",{children:e(h,{id:"Sq04Yc"})})]}),y!==g&&e(Se,{onClick:()=>{location.hash=`/${y}/t/${u.join("+")}${m}`},children:[e(T,{icon:"bus"})," ",e("small",{class:"menu-double-lines",children:e(h,{id:"iAzCp4",values:{currentInstance:y},components:{0:e("b",{})}})})]})]})},g+w)}const Ul=20;function Xs(n){var _;const{_:i}=de(),s=Ve(x),{masto:o,instance:c}=le(),l=(n==null?void 0:n.id)||((_=Lt())==null?void 0:_.id),u=q(),r=q();async function d(S){(S||!r.current)&&(r.current=o.v1.timelines.list.$select(l).list({limit:Ul}));const k=await r.current.next();let{value:A}=k;return A!=null&&A.length&&(S&&(u.current=A[0].id),A.forEach(C=>{Je(C,c)})),{...k,value:A}}async function a(){var S;try{const k=await o.v1.timelines.list.$select(l).list({limit:1,since_id:u.current});let{value:A}=k;const C=((S=A[0])==null?void 0:S.id)===u.current;return A!=null&&A.length&&!C?(A=Dt(A,"home"),!0):!1}catch{return!1}}const[m,b]=L([]);ne(()=>{rn().then(b)},[]);const[g,p]=L({title:"List"});Qe(g.title,"/l/:id"),ne(()=>{(async()=>{try{const S=await zs(l);p(S)}catch{}})()},[l]);const[f,y]=L(!1),[v,w]=L(!1);return e(O,{children:[e(Tt,{title:g.title,id:"list",emptyText:i({id:"KkDhfU"}),errorText:i({id:"7QSeK6"}),instance:c,fetchItems:d,checkForUpdates:a,useItemID:!0,boostsCarousel:s.settings.boostsCarousel,filterContext:"home",showReplyParent:!0,headerStart:e(lt,{overflow:"auto",menuButton:e("button",{type:"button",class:"plain",children:[e(T,{icon:"list",size:"l",alt:i({id:"h16FyT"})}),e(T,{icon:"chevron-down",size:"s"})]}),children:[e(Ye,{to:"/l",children:e("span",{children:e(h,{id:"BHWx+g"})})}),(m==null?void 0:m.length)>0&&e(O,{children:[e(We,{}),m.map(S=>e(Ye,{to:`/l/${S.id}`,children:e("span",{children:S.title})},S.id))]})]}),headerEnd:e(lt,{portal:!0,setDownOverflow:!0,overflow:"auto",viewScroll:"close",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(T,{icon:"more",size:"l",alt:i({id:"2FYpfJ"})})}),children:[e(Se,{onClick:()=>y({list:g}),children:[e(T,{icon:"pencil",size:"l"}),e("span",{children:e(h,{id:"ePK91l"})})]}),e(Se,{onClick:()=>w(!0),children:[e(T,{icon:"group",size:"l"}),e("span",{children:e(h,{id:"hB02vO"})})]})]})},l),f&&e(qe,{onClick:S=>{S.target===S.currentTarget&&y(!1)},children:e(vi,{list:f==null?void 0:f.list,onClose:S=>{S.state==="success"&&S.list?p(S.list):S.state==="deleted"&&(location.hash="/l"),y(!1)}})}),v&&e(qe,{onClick:S=>{S.target===S.currentTarget&&w(!1)},children:e(Bl,{listID:l,onClose:()=>w(!1)})})]})}const Fl=40;function Bl({listID:n,onClose:i}){const{_:s}=de(),{masto:o,instance:c}=le(),[l,u]=L([]),[r,d]=L("default"),[a,m]=L(!1),b=q();async function g(p){m(!1),d("loading"),(async()=>{try{(p||!b.current)&&(b.current=o.v1.lists.$select(n).accounts.list({limit:Fl}));const f=await b.current.next();let{done:y,value:v}=f;v!=null&&v.length?(u(p?v:l.concat(v)),m(!y)):m(!1),d("default")}catch{d("error")}})()}return ne(()=>{g(!0)},[]),e("div",{class:"sheet",id:"list-manage-members-container",children:[!!i&&e("button",{type:"button",class:"sheet-close",onClick:i,children:e(T,{icon:"x",alt:s({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(h,{id:"hB02vO"})})}),e("main",{children:e("ul",{children:[l.map(p=>e("li",{children:[e(ht,{account:p,instance:c}),e(Hl,{account:p,listID:n})]},p.id)),a&&r==="default"&&e(Ct,{as:"li",onChange:p=>p&&g(),children:e("button",{type:"button",class:"light block",onClick:g,children:e(h,{id:"uXRAkV"})})})]})})]})}function Hl({account:n,listID:i}){const{_:s}=de(),{masto:o}=le(),[c,l]=L("default"),[u,r]=L(!1);return e(ut,{confirm:!u,confirmLabel:e("span",{children:e(h,{id:"j5n9Ry",values:{0:n.username},components:{0:e("span",{class:"bidi-isolate"})}})}),align:"end",menuItemClassName:"danger",onClick:()=>{u?(l("loading"),(async()=>{try{await o.v1.lists.$select(i).accounts.create({accountIds:[n.id]}),l("default"),r(!1)}catch{l("error")}})()):(l("loading"),(async()=>{try{await o.v1.lists.$select(i).accounts.remove({accountIds:[n.id]}),l("default"),r(!0)}catch{l("error")}})())},children:e("button",{type:"button",class:`light ${u?"":"danger"}`,disabled:c==="loading",children:s(u?{id:"m16xKo"}:{id:"MWIaew"})})})}const ql={mention:["account","status"],status:["account","status"],reblog:["account","status"],follow:["account"],follow_request:["account"],favourite:["account","status"],poll:["status"],update:["status"]},Yl=["favourite","reblog","follow"],Js=n=>Yl.includes(n);function Qs(n){return n.filter(i=>{const{type:s,id:o,createdAt:c}=i;if(!s)return!1;const l=ql[s];return l!=null&&l.length?l.every(u=>!!i[u]):!0})}function eo(n){if(n!=null&&n.notificationGroups){const{accounts:i=[],notificationGroups:s=[],statuses:o=[]}=n;return s.map(c=>{const{sampleAccountIds:l,statusId:u}=c,r=(l==null?void 0:l.map(a=>i.find(m=>m.id===a)))||[],d=(o==null?void 0:o.find(a=>a.id===u))||null;return{...c,sampleAccounts:r,status:d}})}return n}function jl(n){const i=n.map(u=>{const{latestPageNotificationAt:r,mostRecentNotificationId:d,sampleAccounts:a,notificationsCount:m}=u;return{id:""+d,createdAt:r,account:a[0],...u}}),s={},o=[];for(let u=0;u<i.length;u++){const r=i[u],{type:d,status:a,createdAt:m,notificationsCount:b,sampleAccounts:g,groupKey:p}=r,f=m?new Date(m).toLocaleDateString():"";let y=d;b>0&&(g==null||g.length),(d==="favourite"||d==="reblog")&&(y="favourite+reblog");const v=`${a==null?void 0:a.id}-${y}-${f}`,w=s[v];if(!Js(d))o.push(r);else if(w)g.forEach(_=>{const S=w.sampleAccounts.find(k=>k.id===_.id);S?(S._types.push(d),S._types.sort().reverse()):w.sampleAccounts.push({..._,_types:[d]})}),w.notificationsCount=Math.min(w.notificationsCount,b),w._notificationsCount.push(b),w._accounts=w.sampleAccounts,w._groupKeys.push(p);else{const _=g.map(S=>({...S,_types:[d]}));s[v]={...r,sampleAccounts:_,type:y,_accounts:_,_groupKeys:p?[p]:[],_notificationsCount:[b]},o.push(s[v])}}const c={},l=[];for(let u=0;u<o.length;u++){const r=o[u],{type:d,account:a,_accounts:m,sampleAccounts:b,createdAt:g,groupKey:p}=r,f=g?new Date(g).toLocaleDateString():"",y=(b==null?void 0:b.length)===1||(m==null?void 0:m.length)===1;if((d==="favourite"||d==="reblog"||d==="favourite+reblog")&&y){const v=`${a==null?void 0:a.id}-${d}-${f}`,w=c[v];if(w)w._statuses.push(r.status),w._ids+=`-${r.id}`,w._groupKeys.push(p);else{let _=c[v]={...r,type:d,_ids:r.id,_statuses:[r.status],_groupKeys:p?[p]:[]};l.push(_)}}else l.push(r)}return l}function Vl(n){n=Qs(n);const i={},s=[];for(let l=0,u=0;l<n.length;l++){const r=n[l],{id:d,status:a,account:m,type:b,createdAt:g}=r,p=g?new Date(g).toLocaleDateString():"";let f=b;(b==="favourite"||b==="reblog")&&(f="favourite+reblog");const y=`${a==null?void 0:a.id}-${f}-${p}`,v=i[y];if(!Js(b))s[u++]=r;else if(v!=null&&v.account){const w=v._accounts.find(_=>_.id===m.id);w?(w._types.push(b),w._types.sort().reverse(),v._ids+=`-${d}`):(m._types=[b],v._accounts.push(m),v._ids+=`-${d}`)}else{m&&(m._types=[b]);let w=i[y]={...r,type:f,_ids:d,_accounts:m?[m]:[]};s[u++]=w}}const o={},c=[];for(let l=0,u=0;l<s.length;l++){const r=s[l],{id:d,account:a,_accounts:m,type:b,createdAt:g}=r,p=g?new Date(g).toLocaleDateString():"";if(b==="favourite+reblog"&&a&&m.length===1){const f=`${a==null?void 0:a.id}-${b}-${p}`,y=o[f];if(y)y._statuses.push(r.status),y._ids+=`-${d}`;else{let v=o[f]={...r,type:b,_ids:d,_statuses:[r.status]};c[u++]=v}}else c[u++]=r}return c}const ts=20,Gl=new URLSearchParams;function to({columnMode:n,...i}){const{_:s}=de(),{masto:o,instance:c}=le(),[l]=n?[Gl]:bt(),[u,r]=L(null),d=(i==null?void 0:i.type)||l.get("type")||u;Qe(s(d==="private"?{id:"2BApYc"}:{id:"/bZzdR"}),"/mentions");const a=q(),m=q();async function b(_){(_||!a.current)&&(a.current=o.v1.notifications.list({limit:ts,types:["mention"]}));const S=await a.current.next();let{value:k}=S;return k!=null&&k.length&&(k=Qs(k),_&&(m.current=k[0].id),k.forEach(({status:A})=>{Je(A,c)})),{...S,value:k==null?void 0:k.map(A=>A.status)}}const g=q(),p=q();async function f(_){(_||!g.current)&&(g.current=o.v1.conversations.list({limit:ts}));const S=await g.current.next();let{value:k}=S;return k=k==null?void 0:k.filter(A=>A.lastStatus),k!=null&&k.length&&(_&&(p.current=k[0].lastStatus.id),k.forEach(({lastStatus:A})=>{Je(A,c)})),{...S,value:k==null?void 0:k.map(A=>A.lastStatus)}}function y(..._){return d==="private"?f(..._):b(..._)}async function v(){var _;if(d==="private")try{const S=await o.v1.conversations.list({limit:1,since_id:p.current}).next();let{value:k}=S;const A=((_=k[0])==null?void 0:_.id)===p.current;return k!=null&&k.length&&!A?(p.current=k[0].lastStatus.id,!0):!1}catch{return!1}else try{const S=await o.v1.notifications.list({limit:1,types:["mention"],since_id:m.current}).next();let{value:k}=S;return k!=null&&k.length?(m.current=k[0].id,!0):!1}catch{return!1}}const w=Ce(()=>e("div",{class:"filter-bar centered",children:[e(be,{to:"/mentions",class:d?"":"is-active",onClick:_=>{n&&(_.preventDefault(),r(null))},children:e(h,{id:"N40H+G"})}),e(be,{to:"/mentions?type=private",class:d==="private"?"is-active":"",onClick:_=>{n&&(_.preventDefault(),r("private"))},children:e(h,{id:"zwBp5t"})})]}),[d]);return e(Tt,{title:s({id:"/bZzdR"}),id:"mentions",emptyText:s({id:"03jFGT"}),errorText:s({id:"pqR9KF"}),instance:c,fetchItems:y,checkForUpdates:v,useItemID:!0,timelineStart:w,refresh:d})}const Kl=80,Wl=20,Zl=new URLSearchParams,hn={block:"center",inline:"center",behavior:"smooth"},no=ms(()=>et("@mastodon/grouped-notifications"),{maxAge:1e3*60*5});function ei(n={}){const{masto:i}=le();return x.settings.groupedNotificationsAlpha&&no()?i.v2.notifications.list({limit:Wl,...n}):i.v1.notifications.list({limit:Kl,...n})}function io(n){return x.settings.groupedNotificationsAlpha&&no()?jl(n):Vl(n)}const Xl=["forNotFollowing","forNotFollowers","forNewAccounts","forPrivateMentions","forLimitedAccounts"],Jl={forNotFollowing:{id:"d+hDoa"},forNotFollowers:{id:"oAwuQj"},forNewAccounts:{id:"Srs8u7"},forPrivateMentions:{id:"IDC5Uw"},forLimitedAccounts:{id:"XMGM2e"}};function Ql({columnMode:n}){var ue;const{_:i,_:s}=de();Qe(s({id:"iDNBZe"}),"/notifications");const{masto:o,instance:c}=le(),l=Ve(x),[u,r]=L("default"),[d]=n?[Zl]:bt(),a=d.get("id"),m=d.get("access_token"),[b,g]=L(!1),[p,f]=L(!1),y=q(),{nearReachEnd:v,scrollDirection:w,reachStart:_,nearReachStart:S}=Wa({scrollableRef:y}),k=w==="end"&&!S,[A,C]=L([]),[I,E]=L([]),M=q();async function z(N){var H;if((N||!M.current)&&(M.current=ei({excludeTypes:["follow_request"]})),/max_id=($|&)/i.test((H=M.current)==null?void 0:H.nextParams))return{done:!0};const re=await M.current.next(),Te=eo(re.value);if(Te!=null&&Te.length){Te.forEach(Ee=>{Je(Ee.status,c,{skipThreading:!0})});const ye=io(Te);N?(x.notificationsLast=ye[0],x.notifications=ye,o.v1.markers.create({notifications:{lastReadId:ye[0].id}}).catch(()=>{})):x.notifications.push(...ye)}return x.notificationsShowNew=!1,x.notificationsLastFetchTime=Date.now(),re}async function P(){try{return await o.v1.followRequests.list({limit:80})}catch{return[]}}const W=()=>{r("loading"),(async()=>{try{const N=await P();C(N),r("default")}catch{r("error")}})()};async function ee(){try{return await o.v1.announcements.list()}catch{return[]}}const Z=et("@mastodon/filtered-notifications"),[V,U]=L(!1),[B,se]=L({});function $(){return o.v2.notifications.policy.fetch().catch(()=>{})}function F(){$().then(N=>{se(N)}).catch(()=>{})}const[Y,G]=L(null);function te(){return o.v1.notifications.requests.list()}const ae=N=>{_e(!1),r("loading"),(async()=>{try{const re=z(N);N&&(ee().then(H=>{H.sort((ye,Ee)=>{const R=new Date(ye.updatedAt||ye.createdAt);return new Date(Ee.updatedAt||Ee.createdAt)-R}),E(H)}).catch(()=>{}),P().then(H=>{C(H)}).catch(()=>{}),Z&&F());const{done:Te}=await re;g(!Te),r("default")}catch{r("error")}})()};ne(()=>{ae(!0)},[]),ne(()=>{_&&ae(!0)},[_]);const[ve,_e]=L(!1),j=st(({disableIdleCheck:N=!1}={})=>{var re;u!=="loading"&&l.settings.autoRefresh&&((re=y.current)==null?void 0:re.scrollTop)<16&&(N||window.__IDLE__)&&!er()&&ae(!0)},[l.notificationsShowNew,l.settings.autoRefresh,u]),he=q();Vt(N=>{if(N){const re=Date.now()-he.current;!he.current||re>1e3*3?j({disableIdleCheck:!0}):he.current=Date.now()}});const Ae=q(!0);ne(()=>{let N=Io(x,"notificationsShowNew",re=>{if(Ae.current){Ae.current=!1;return}u!=="loading"&&(re&&j(),_e(re))});return()=>N==null?void 0:N()},[]);const Pe=new Date,Ne=new Date(Pe-24*60*60*1e3);let Ue=new Date;const Re=!l.notifications.some(N=>new Date(N.createdAt).toDateString()===Pe.toDateString()),Le=q();ne(()=>{a&&(x.routeNotification={id:a,accessToken:atob(m)})},[a,m]);const[X,Ie]=L(null);ne(async()=>{var H,ye,Ee;const N=new Date;if(N.getMonth()!==11||!et("@mastodon/annual-report"))return;let re=ke.account.get("annualReportNotification");if(re){Ie(re);return}const Te=ei({types:["annual_report"]});try{const R=await Te.next();re=(ye=(H=R==null?void 0:R.value)==null?void 0:H.notificationGroups)==null?void 0:ye[0],((Ee=re==null?void 0:re.annualReport)==null?void 0:Ee.year)==N.getFullYear()&&(Ie(re),ke.account.set("annualReportNotification",re))}catch{}},[]);const De=".notification",fe=He("j",()=>{const N=document.activeElement.closest(De),re=N==null?void 0:N.getBoundingClientRect(),Te=Array.from(y.current.querySelectorAll(De));if(N&&re.top<y.current.clientHeight&&re.bottom>0){const H=Te.indexOf(N);let ye=Te[H+1];ye&&(ye.focus(),ye.scrollIntoView(hn))}else{const H=Te.find(ye=>{const Ee=ye.getBoundingClientRect();return Ee.top>=44&&Ee.left>=0});H&&(H.focus(),H.scrollIntoView(hn))}}),Q=He("k",()=>{const N=document.activeElement.closest(De),re=N==null?void 0:N.getBoundingClientRect(),Te=Array.from(y.current.querySelectorAll(De));if(N&&re.top<y.current.clientHeight&&re.bottom>0){const H=Te.indexOf(N);let ye=Te[H-1];ye&&(ye.focus(),ye.scrollIntoView(hn))}else{const H=Te.find(ye=>{const Ee=ye.getBoundingClientRect();return Ee.top>=44&&Ee.left>=0});H&&(H.focus(),H.scrollIntoView(hn))}}),ge=He(["enter","o"],()=>{const N=document.activeElement.closest(De),re=N==null?void 0:N.querySelector(".status-link");re&&re.click()}),D=new Date,ie=Ce(()=>ot(D,{forceOpts:{weekday:"long"}}),[D]);return e("div",{id:"notifications-page",class:"deck-container",ref:N=>{y.current=N,fe(N),Q(N),ge(N)},tabIndex:"-1",children:[e("div",{class:`timeline-deck deck ${p?"only-mentions":""}`,children:[e("header",{hidden:k,onClick:N=>{var re;N.target.closest("a, button")||(re=y.current)==null||re.scrollTo({top:0,behavior:"smooth"})},onDblClick:N=>{N.target.closest("a, button")||ae(!0)},class:u==="loading"?"loading":"",children:[e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Mt,{}),e(be,{to:"/",class:"button plain",children:e(T,{icon:"home",size:"l",alt:s({id:"i0qMbr"})})})]}),e("h1",{children:e(h,{id:"iDNBZe"})}),e("div",{class:"header-side",children:Z&&e("button",{type:"button",class:"button plain4",onClick:()=>{U(!0)},children:e(T,{icon:"settings",size:"l",alt:s({id:"a/+arl"})})})})]}),ve&&u!=="loading"&&e("button",{class:"updates-button shiny-pill",type:"button",onClick:()=>{var N;ae(!0),(N=y.current)==null||N.scrollTo({top:0,behavior:"smooth"})},children:[e(T,{icon:"arrow-up"})," ",e(h,{id:"Jy9RU/"})]})]}),I.length>0&&e("div",{class:"shazam-container",children:e("div",{class:"shazam-container-inner",children:e("details",{class:"announcements",children:[e("summary",{children:[e("span",{children:[e(T,{icon:"announce",class:"announcement-icon",size:"l"})," ",e(h,{id:"0whvLM",values:{0:I.length}})," ",e("small",{class:"insignificant",children:c})]}),I.length>1&&e("span",{class:"announcements-nav-buttons",children:I.map((N,re)=>e("button",{type:"button",class:"plain2 small",onClick:()=>{var Te;(Te=Le.current)==null||Te.children[re].scrollIntoView({behavior:"smooth",block:"nearest"})},children:re+1}))})]}),e("ul",{class:`announcements-list-${I.length>1?"multiple":"single"}`,ref:Le,children:I.map(N=>e("li",{children:e(tr,{announcement:N})}))})]})})}),A.length>0&&e("div",{class:"follow-requests",children:[e("h2",{class:"timeline-header",children:e(h,{id:"6Fs1Ba"})}),A.length>5?e("details",{children:[e("summary",{children:e(h,{id:"7dHKu4",values:{0:A.length}})}),e("ul",{children:A.map(N=>e("li",{children:[e(ht,{account:N}),e(Qn,{accountID:N.id,onChange:()=>{}})]},N.id))})]}):e("ul",{children:A.map(N=>e("li",{children:[e(ht,{account:N}),e(Qn,{accountID:N.id,onChange:()=>{}})]},N.id))})]}),Z&&((ue=B==null?void 0:B.summary)==null?void 0:ue.pendingRequestsCount)>0&&e("div",{class:"shazam-container",children:e("div",{class:"shazam-container-inner",children:e("div",{class:"filtered-notifications",children:e("details",{onToggle:async N=>{const{open:re}=N.target;if(re){const Te=await te();G(Te)}},children:[e("summary",{children:e(h,{id:"N3Bq0f",values:{0:B.summary.pendingRequestsCount}})}),Y?(Y==null?void 0:Y.length)>0&&e("ul",{children:Y.map(N=>{var re,Te;return e("li",{children:[e("div",{class:"request-notifcations",children:[!((re=N.lastStatus)!=null&&re.id)&&e(ht,{useAvatarStatic:!0,showStats:!0,account:N.account}),((Te=N.lastStatus)==null?void 0:Te.id)&&e("div",{class:"last-post",children:e(be,{class:"status-link",to:`/${c}/s/${N.lastStatus.id}`,children:e(je,{status:N.lastStatus,size:"s",readOnly:!0})})}),e(ir,{request:N})]}),e(sr,{request:N,onChange:()=>{ae(!0)}})]},N.id)})}):e("p",{class:"ui-state",children:e(Fe,{abrupt:!0})})]})})})}),X&&e("div",{class:"shazam-container",children:e("div",{class:"shazam-container-inner",children:e(an,{notification:X})})}),e("div",{id:"mentions-option",children:e("label",{children:[e("input",{type:"checkbox",checked:p,onChange:N=>{f(N.target.checked)}})," ",e(h,{id:"0udtPI"})]})}),e("h2",{class:"timeline-header",children:[e(h,{id:"ecUA8p"})," ",e("small",{class:"insignificant bidi-isolate",children:ie})]}),Re&&e("p",{class:"ui-state insignificant",children:u==="default"?s({id:"KS7iJH"}):e(O,{children:"…"})}),l.notifications.length?e(O,{children:l.notifications.filter(N=>N.type!=="follow_request").map(N=>{if(p&&N.type!=="mention")return null;const re=new Date(N.createdAt),Te=re.toDateString()!==Ue.toDateString();Te&&(Ue=re);const H=re.toDateString()===Ne.toDateString()?s({id:"y/0uwd"}):ot(Ue,{hideTime:!0}),ye=ot(Ue,{forceOpts:{weekday:"long"}});return e(O,{children:[Te&&e("h2",{class:"timeline-header",children:[e("span",{children:H})," ",e("small",{class:"insignificant bidi-isolate",children:ye})]}),e(an,{instance:c,notification:N},N._ids||N.id)]},N._ids||N.id)})}):e(O,{children:[u==="loading"&&e(O,{children:e("ul",{class:"timeline flat",children:Array.from({length:5}).map((N,re)=>e("li",{class:"notification skeleton",children:[e("div",{class:"notification-type",children:e(T,{icon:"notification",size:"xl"})}),e("div",{class:"notification-content",children:e("p",{children:"███████████ ████"})})]}))})}),u==="error"&&e("p",{class:"ui-state",children:[e(h,{id:"gjzl8E"}),e("br",{}),e("br",{}),e("button",{type:"button",onClick:()=>ae(!0),children:e(h,{id:"KDw4GX"})})]})]}),b&&e(Ct,{onChange:N=>{N&&ae()},children:e("button",{type:"button",class:"plain block",disabled:u==="loading",onClick:()=>ae(),style:{marginBlockEnd:"6em"},children:u==="loading"?e(Fe,{abrupt:!0}):e(h,{id:"uXRAkV"})})})]}),Z&&V&&e(qe,{onClick:N=>{N.target===N.currentTarget&&U(!1)},children:e("div",{class:"sheet",id:"notifications-settings",tabIndex:"-1",children:[e("button",{type:"button",class:"sheet-close",onClick:()=>U(!1),children:e(T,{icon:"x",alt:s({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(h,{id:"a/+arl"})})}),e("main",{children:e("form",{onSubmit:N=>{N.preventDefault();const{forNotFollowing:re,forNotFollowers:Te,forNewAccounts:H,forPrivateMentions:ye,forLimitedAccounts:Ee}=N.target,R={...B,forNotFollowing:re.value,forNotFollowers:Te.value,forNewAccounts:H.value,forPrivateMentions:ye.value,forLimitedAccounts:Ee.value};se(R),U(!1),(async()=>{try{await o.v2.notifications.policy.update(R),me(s({id:"4+7X9i"}))}catch{}})()},children:[e("p",{children:e(h,{id:"WrkPTf"})}),e("div",{class:"notification-policy-fields",children:Xl.map(N=>{const re=B[N];return e("div",{children:e("label",{children:[i(Jl[N]),e("select",{name:N,defaultValue:re,class:"small",children:[e("option",{value:"accept",children:e(h,{id:"g3UF2V"})}),e("option",{value:"filter",children:e(h,{id:"o7J4JM"})}),e("option",{value:"drop",children:e(h,{id:"gbbkE7"})})]})]})},N)})}),e("p",{children:e("button",{type:"submit",children:e(h,{id:"tfDRzk"})})})]})})]})})]})}function er(){return!!document.querySelector(".deck-backdrop, #modal-container > *")}function tr({announcement:n}){const{instance:i}=le(),{contact:s}=hs(),o=s==null?void 0:s.account,{id:c,content:l,startsAt:u,endsAt:r,published:d,allDay:a,publishedAt:m,updatedAt:b,read:g,mentions:p,statuses:f,tags:y,emojis:v,reactions:w}=n,_=new Date(m),S=ot(_),k=new Date(b),A=ot(k);return e("div",{class:"announcement-block",children:[e(ht,{account:o}),e("div",{class:"announcement-content",onClick:ks({mentions:p,instance:i}),dangerouslySetInnerHTML:{__html:Kn(l,{emojis:v})}}),e("p",{class:"insignificant",children:[e("time",{datetime:_.toISOString(),children:ot(_)}),b&&A!==S&&e(O,{children:[" ","•"," ",e("span",{class:"ib",children:e(h,{id:"TbFrLc",values:{0:ot(k)},components:{0:e("time",{datetime:k.toISOString()})}})})]})]}),e("div",{class:"announcement-reactions",hidden:!0,children:w.map(C=>{const{name:I,count:E,me:M,staticUrl:z,url:P}=C;return e("button",{type:"button",class:`plain4 small ${M?"reacted":""}`,children:[P||z?e("img",{src:P||z,alt:I,width:"16",height:"16"}):e("span",{children:I})," ",e("span",{class:"count",children:Xe(E)})]})})})]})}function nr(n){const{masto:i}=le();return i.v1.notifications.list({accountID:n})}function ir({request:n}){var b;const{instance:i}=le(),[s,o]=L("loading"),{account:c,lastStatus:l}=n,[u,r]=L(!1),[d,a]=L([]);function m(){r(!1)}return ne(()=>{var g;(g=n==null?void 0:n.account)!=null&&g.id&&u&&(o("loading"),(async()=>{const p=await nr(n.account.id);a(p||[]),o("default")})())},[u,(b=n==null?void 0:n.account)==null?void 0:b.id]),e(O,{children:[e("button",{type:"button",class:"plain4 request-notifications-account",onClick:()=>{r(!0)},children:[e(T,{icon:"notification",class:"more-insignificant"})," ",e("small",{children:e(h,{id:"H0wUNM",values:{0:c.username},components:{0:e("span",{class:"bidi-isolate"})}})})," ",e(T,{icon:"chevron-down"})]}),u&&e(qe,{onClick:g=>{g.target===g.currentTarget&&m()},children:e("div",{class:"sheet",tabIndex:"-1",children:[e("button",{type:"button",class:"sheet-close",onClick:m,children:e(T,{icon:"x",alt:t`Close`})}),e("header",{children:e("b",{children:e(h,{id:"MXOmPt",values:{0:c.username},components:{0:e("span",{class:"bidi-isolate"})}})})}),e("main",{children:s==="loading"?e("p",{class:"ui-state",children:e(Fe,{abrupt:!0})}):d.map(g=>e("div",{class:"notification-peek",onClick:p=>{const{target:f}=p;(p.target.tagName==="BUTTON"||p.target.tagName==="A")&&m()},children:e(an,{instance:i,notification:g,isStatic:!0})}))})]})})]})}function sr({request:n,onChange:i}){const{_:s}=de(),{masto:o}=le(),[c,l]=L("default"),[u,r]=L(null),d=u!==null;return e("p",{class:"notification-request-buttons",children:[e("button",{type:"button",disabled:c==="loading"||d,onClick:()=>{l("loading"),(async()=>{try{await o.v1.notifications.requests.$select(n.id).accept(),r("accept"),l("default"),i({request:n,state:"accept"}),me(s({id:"ZtBMwU",values:{0:n.account.username}}))}catch{l("error"),me(s({id:"S92JKG"}))}})()},children:e(h,{id:"h7peZQ"})})," ",e("button",{type:"button",disabled:c==="loading"||d,class:"light danger",onClick:()=>{l("loading"),(async()=>{try{await o.v1.notifications.requests.$select(n.id).dismiss(),r("dismiss"),l("default"),i({request:n,state:"dismiss"}),me(s({id:"pRqdUf",values:{1:n.account.username}}))}catch{l("error"),me(s({id:"S5aemF"}))}})()},children:e(h,{id:"1QfxQT"})}),e("span",{class:"notification-request-states",children:c==="loading"?e(Fe,{abrupt:!0}):u==="accept"?e(T,{icon:"check-circle",alt:s({id:"bzMKg7"}),class:"notification-accepted"}):u==="dismiss"&&e(T,{icon:"x-circle",alt:s({id:"J6hrEy"}),class:"notification-dismissed"})})]})}const so=rt(Ql),or=20;function ti({local:n,columnMode:i,...s}){const{_:o}=de(),c=Ve(x),l=!!n,u=i?{}:Lt(),{masto:r,instance:d}=le({instance:(s==null?void 0:s.instance)||u.instance}),{masto:a,instance:m}=le(),b=o(l?{id:"u96B/B",values:{instance:d}}:{id:"PgVqvd",values:{instance:d}});Qe(b,l?"/:instance?/p/l":"/:instance?/p");const g=q(),p=q();async function f(v){if(v||!p.current){const S={limit:or,local:l||void 0};!l&&et("@pixelfed/global-feed")&&(S.remote=!0),p.current=r.v1.timelines.public.list(S)}const w=await p.current.next();let{value:_}=w;return _!=null&&_.length&&(v&&(g.current=_[0].id),_.forEach(S=>{Je(S,d)})),{...w,value:_}}async function y(){var v;try{const w=await r.v1.timelines.public.list({limit:1,local:l,since_id:g.current}).next();let{value:_}=w;const S=((v=_[0])==null?void 0:v.id)===g.current;return _!=null&&_.length&&!S?(_=Dt(_,"public"),!0):!1}catch{return!1}}return e(Tt,{title:b,titleComponent:e("h1",{class:"header-double-lines",children:[e("b",{children:o(l?{id:"pJQgQV"}:{id:"cg0I+x"})}),e("div",{children:d})]}),id:"public",instance:d,emptyText:o({id:"BiZJ6G"}),errorText:o({id:"scd9lw"}),fetchItems:f,checkForUpdates:y,useItemID:!0,headerStart:e(O,{}),boostsCarousel:c.settings.boostsCarousel,filterContext:"public",headerEnd:e(lt,{portal:!0,overflow:"auto",viewScroll:"close",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(T,{icon:"more",size:"l",alt:o({id:"2FYpfJ"})})}),children:[e(Se,{href:l?`/#/${d}/p`:`/#/${d}/p/l`,children:l?e(O,{children:[e(T,{icon:"transfer"})," ",e("span",{children:e(h,{id:"dXMiUw"})})]}):e(O,{children:[e(T,{icon:"transfer"})," ",e("span",{children:e(h,{id:"t2B/we"})})]})}),e(We,{}),e(Se,{onClick:()=>{let v=prompt(o({id:"2MQ2cd"}));if(!/\./.test(v)){v&&alert(o({id:"7WddtO"}));return}v&&(v=v.toLowerCase().trim(),location.hash=l?`/${v}/p/l`:`/${v}/p`)},children:[e(T,{icon:"bus"})," ",e("span",{children:e(h,{id:"Sq04Yc"})})]}),m!==d&&e(Se,{onClick:()=>{location.hash=l?`/${m}/p/l`:`/${m}/p`},children:[e(T,{icon:"bus"})," ",e("small",{class:"menu-double-lines",children:e(h,{id:"iAzCp4",values:{currentInstance:m},components:{0:e("b",{})}})})]})]})},d+l)}const fn=5,Vn=40,cr=new URLSearchParams,pn={block:"nearest",inline:"center",behavior:"smooth"};function oo({columnMode:n,...i}){const{_:s}=de(),o=n?{}:Lt(),{masto:c,instance:l,authenticated:u}=le({instance:o.instance}),[r,d]=L("default"),[a]=n?[cr]:bt(),m=q(),b=(i==null?void 0:i.query)||a.get("q"),g=n?"statuses":(i==null?void 0:i.type)||a.get("type");let p=s({id:"A1taO8"});if(b)switch(g){case"statuses":p=s({id:"6YeoAt",values:{q:b}});break;case"accounts":p=s({id:"fpgumQ",values:{q:b}});break;case"hashtags":p=s({id:"AuiMZZ",values:{q:b}});break;default:p=s({id:"wr3GZI",values:{q:b}})}Qe(p,"/search");const[f,y]=L(!1),v=q(0);ne(()=>{v.current=0},[b,g]);const w=q();wt(()=>{var $,F;(F=($=w.current)==null?void 0:$.scrollTo)==null||F.call($,0,0)},[b,g]);const[_,S]=L([]),[k,A]=L([]),[C,I]=L([]);ne(()=>{S([]),A([]),I([])},[b]);const E={statuses:_,accounts:k,hashtags:C},M={statuses:S,accounts:A,hashtags:I},[z,P]=L({}),W=async $=>{if(!($!=null&&$.length))return;const F=await ri($,z);F&&P({...z,...F})};function ee($){$&&(v.current=0),!(!$&&!u)&&(d("loading"),$&&!g&&(S(_.slice(0,fn)),A(k.slice(0,fn)),I(C.slice(0,fn))),(async()=>{var Y,G,te,ae,ve,_e;const F={q:b,resolve:u,limit:fn};g&&(F.limit=Vn,F.type=g,u&&(F.offset=v.current));try{const j=await c.v2.search.fetch(F);if(g)if($){M[g](j[g]);const he=(Y=j[g])==null?void 0:Y.length;v.current=Vn,y(!!he)}else if(((te=(G=j[g])==null?void 0:G[0])==null?void 0:te.id)===((ve=(ae=E[g])==null?void 0:ae[0])==null?void 0:ve.id))y(!1);else{M[g](Ae=>[...Ae,...j[g]]);const he=(_e=j[g])==null?void 0:_e.length;v.current=v.current+Vn,y(!!he)}else S(j.statuses||[]),A(j.accounts||[]),I(j.hashtags||[]),v.current=0,y(!1);W(j.accounts),d("default")}catch{d("error")}})())}const Z=q();Vt($=>{var Y;const F=((Y=w.current)==null?void 0:Y.scrollTop)===0;if($&&F){const G=Date.now()-Z.current;!Z.current||G>1e3*3?ee(!0):Z.current=Date.now()}}),ne(()=>{var F,Y;let $;return(Y=(F=m.current)==null?void 0:F.setValue)==null||Y.call(F,b||""),b?ee(!0):$=setTimeout(()=>{var G,te;(te=(G=m.current)==null?void 0:G.focus)==null||te.call(G)},150),()=>clearTimeout($)},[b,g,l]),He(["/","Slash"],$=>{var F,Y,G,te;(Y=(F=m.current)==null?void 0:F.focus)==null||Y.call(F),(te=(G=m.current)==null?void 0:G.select)==null||te.call(G)},{preventDefault:!0});const V=".timeline > li > a, .hashtag-list > li > a",U=He("j",()=>{const $=document.activeElement.closest(V),F=$==null?void 0:$.getBoundingClientRect(),Y=Array.from(w.current.querySelectorAll(V));if($&&F.top<w.current.clientHeight&&F.bottom>0){const G=Y.indexOf($);let te=Y[G+1];te&&(te.focus(),te.scrollIntoView(pn))}else{const G=Y.find(te=>{const ae=te.getBoundingClientRect();return ae.top>=44&&ae.left>=0});G&&(G.focus(),G.scrollIntoView(pn))}}),B=He("k",()=>{const $=document.activeElement.closest(V),F=$==null?void 0:$.getBoundingClientRect(),Y=Array.from(w.current.querySelectorAll(V));if($&&F.top<w.current.clientHeight&&F.bottom>0){const G=Y.indexOf($);let te=Y[G-1];te&&(te.focus(),te.scrollIntoView(pn))}else{const G=Y.find(te=>{const ae=te.getBoundingClientRect();return ae.top>=44&&ae.left>=0});G&&(G.focus(),G.scrollIntoView(pn))}}),[se]=mi();return e("div",{id:"search-page",class:"deck-container",tabIndex:"-1",ref:$=>{w.current=$,U($),B($)},children:e("div",{class:"timeline-deck deck",children:[e("header",{class:r==="loading"?"loading":"",children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:e(Mt,{})}),e(js,{ref:m}),e("div",{class:"header-side",children:e("button",{type:"button",class:"plain",onClick:()=>{ee(!0)},disabled:r==="loading",children:e(T,{icon:"search",size:"l",alt:s({id:"A1taO8"})})})})]})}),e("main",{children:[!!b&&!n&&e("div",{ref:se,class:`filter-bar ${r==="loading"?"loading":""}`,children:[!!g&&e(be,{to:`/search${b?`?q=${encodeURIComponent(b)}`:""}`,children:[e(T,{icon:"chevron-left"})," ",e(h,{id:"N40H+G"})]}),[{label:s({id:"bPwFdf"}),type:"accounts",to:`/search?q=${encodeURIComponent(b)}&type=accounts`},{label:s({id:"VwUsHI"}),type:"hashtags",to:`/search?q=${encodeURIComponent(b)}&type=hashtags`},{label:s({id:"+owNNn"}),type:"statuses",to:`/search?q=${encodeURIComponent(b)}&type=statuses`}].sort(($,F)=>$.type===g?-1:F.type===g?1:0).map($=>e(be,{to:$.to,children:$.label},$.type))]}),b?e(O,{children:[(!g||g==="accounts")&&e(O,{children:[g!=="accounts"&&e("h2",{class:"timeline-header",children:[e(h,{id:"bPwFdf"})," ",e(be,{to:`/search?q=${encodeURIComponent(b)}&type=accounts`,children:e(T,{icon:"arrow-right",size:"l",alt:s({id:"V1fa9u"})})})]}),k.length>0?e(O,{children:[e("ul",{class:"timeline flat accounts-list",children:k.map($=>e("li",{children:e(ht,{account:$,instance:l,showStats:!0,relationship:z[$.id]})},$.id))}),g!=="accounts"&&e("div",{class:"ui-state",children:e(be,{class:"plain button",to:`/search?q=${encodeURIComponent(b)}&type=accounts`,children:[e(h,{id:"BMmtZ8"})," ",e(T,{icon:"arrow-right"})]})})]}):!g&&(r==="loading"?e("p",{class:"ui-state",children:e(Fe,{abrupt:!0})}):e("p",{class:"ui-state",children:e(h,{id:"YYB61U"})}))]}),(!g||g==="hashtags")&&e(O,{children:[g!=="hashtags"&&e("h2",{class:"timeline-header",children:[e(h,{id:"VwUsHI"})," ",e(be,{to:`/search?q=${encodeURIComponent(b)}&type=hashtags`,children:e(T,{icon:"arrow-right",size:"l",alt:s({id:"V1fa9u"})})})]}),C.length>0?e(O,{children:[e("ul",{class:"link-list hashtag-list",children:C.map($=>{var te;const{name:F,history:Y}=$,G=(te=Y==null?void 0:Y.reduce)==null?void 0:te.call(Y,(ae,ve)=>ae+ +ve.uses,0);return e("li",{children:e(be,{to:l?`/${l}/t/${F}`:`/t/${F}`,children:[e(T,{icon:"hashtag",alt:"#"}),e("span",{children:F}),!!G&&e("span",{class:"count",children:Xe(G)})]})},`${F}-${G}`)})}),g!=="hashtags"&&e("div",{class:"ui-state",children:e(be,{class:"plain button",to:`/search?q=${encodeURIComponent(b)}&type=hashtags`,children:[e(h,{id:"Nc/W5J"})," ",e(T,{icon:"arrow-right"})]})})]}):!g&&(r==="loading"?e("p",{class:"ui-state",children:e(Fe,{abrupt:!0})}):e("p",{class:"ui-state",children:e(h,{id:"4MFM3P"})}))]}),(!g||g==="statuses")&&e(O,{children:[g!=="statuses"&&e("h2",{class:"timeline-header",children:[e(h,{id:"+owNNn"})," ",e(be,{to:`/search?q=${encodeURIComponent(b)}&type=statuses`,children:e(T,{icon:"arrow-right",size:"l",alt:s({id:"V1fa9u"})})})]}),_.length>0?e(O,{children:[e("ul",{class:"timeline",children:_.map($=>e("li",{children:e(be,{class:"status-link",to:l?`/${l}/s/${$.id}`:`/s/${$.id}`,children:e(je,{status:$})})},$.id))}),g!=="statuses"&&e("div",{class:"ui-state",children:e(be,{class:"plain button",to:`/search?q=${encodeURIComponent(b)}&type=statuses`,children:[e(h,{id:"LYCgej"})," ",e(T,{icon:"arrow-right"})]})})]}):!g&&(r==="loading"?e("p",{class:"ui-state",children:e(Fe,{abrupt:!0})}):e("p",{class:"ui-state",children:e(h,{id:"Hzi9AA"})}))]}),!!g&&(r==="default"?f?e(Ct,{onChange:$=>{$&&ee()},children:e("button",{type:"button",class:"plain block",onClick:()=>ee(),style:{marginBlockEnd:"6em"},children:e(h,{id:"uXRAkV"})})}):e("p",{class:"ui-state insignificant",children:e(h,{id:"2EYeAZ"})}):r==="loading"&&e("p",{class:"ui-state",children:e(Fe,{abrupt:!0})}))]}):r==="loading"?e("p",{class:"ui-state",children:e(Fe,{abrupt:!0})}):e("p",{class:"ui-state",children:e(h,{id:"fGn1Hk"})})]})]})})}const ar=20,co=10*60*1e3,lr=gt(n=>n.v1.trends.links.list().next(),{maxAge:co}),rr=gt(n=>n.v1.trends.tags.list().next(),{maxAge:co});function dr(n){return et("@pixelfed/trending")?n.pixelfed.v2.discover.posts.trending.list({range:"daily"}):n.v1.trends.statuses.list({limit:ar})}function ur(n,i){return n.v1.timelines.link.list(i)}function ao({columnMode:n,...i}){const{_:s}=de(),o=Ve(x),c=n?{}:Lt(),{masto:l,instance:u}=le({instance:(i==null?void 0:i.instance)||c.instance}),{masto:r,instance:d}=le(),a=s({id:"cI3UEs",values:{instance:u}});Qe(a,"/:instance?/trending");const m=q(),b=u===d,[g,p]=L([]),[f,y]=L([]),v=q();async function w(Z){var B;if(Z||!v.current){if(v.current=dr(l),et("@mastodon/trending-hashtags"))try{const{value:se}=await rr(l);se!=null&&se.length&&p(se)}catch{}if(et("@mastodon/trending-links"))try{const{value:se}=await lr(l,u),$=(B=se==null?void 0:se.filter)==null?void 0:B.call(se,F=>F.type==="link");$!=null&&$.length&&y($)}catch{}}const V=await v.current.next();let{value:U}=V;return U!=null&&U.length&&(Z&&(m.current=U[0].id),U.forEach(se=>{Je(se,u)})),{...V,value:U}}const[_,S]=L(!1),k=q(),[A,C]=L(null),I=!!A,E=q(),M=b&&et("@mastodon/trending-link-posts");ne(()=>{A&&E.current&&E.current.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})},[A]);const z=q();async function P(Z){(Z||!k.current)&&(S(!0),k.current=ur(l,{url:A})),z.current=A;const V=await k.current.next();let{value:U}=V;return U!=null&&U.length&&(U=Dt(U,"public"),U.forEach(B=>{Je(B,u)})),z.current===A&&S(!1),{...V,value:U}}async function W(){try{const Z=await l.v1.trends.statuses.list({limit:1}).next();let{value:V}=Z;return V=Dt(V,"public"),V!=null&&V.length&&V[0].id!==m.current?(m.current=V[0].id,!0):!1}catch{return!1}}const ee=Ce(()=>e(O,{children:[!!g.length&&e("div",{class:"filter-bar expandable",children:[e(T,{icon:"chart",class:"insignificant",size:"l"}),g.map((Z,V)=>{const{name:U,history:B}=Z,se=B.reduce(($,F)=>$+ +F.uses,0);return e(be,{to:`/${u}/t/${U}`,children:[e("span",{dir:"auto",children:[e("span",{class:"more-insignificant",children:"#"}),U]}),e("span",{class:"filter-count",children:Xe(se)})]},U)})]}),!!f.length&&e("div",{class:"links-bar",children:[e("header",{children:e("h3",{children:e(h,{id:"9veeTb"})})}),f.map(Z=>{var X,Ie;const{authors:V,authorName:U,authorUrl:B,blurhash:se,description:$,height:F,image:Y,imageDescription:G,language:te,providerName:ae,providerUrl:ve,publishedAt:_e,title:j,url:he,width:Ae}=Z,Pe=(Ie=(X=V==null?void 0:V[0])==null?void 0:X.account)!=null&&Ie.id?V[0].account:null,Ne=j.length<30,Ue=!!(U||Pe),Re=zt.toUnicode(URL.parse(he).hostname.replace(/^www\./,"").replace(/\/$/,""));let Le;if(se){const De=di(se),fe=ki(De);Le=wi([.6,fe[1],fe[2]])}return e("div",{children:[e("a",{ref:A===he?E:null,href:he,target:"_blank",rel:"noopener",class:`link-block ${I?A===he?"active":"inactive":""}`,style:Le?{"--accent-color":`rgb(${Le.join(",")})`,"--accent-alpha-color":`rgba(${Le.join(",")}, 0.4)`}:{},children:e("article",{children:[e("figure",{children:e("img",{src:Y,alt:G,width:Ae,height:F,loading:"lazy"})}),e("div",{class:"article-body",children:[e("header",{children:[e("div",{class:"article-meta",children:[e("span",{class:"domain",children:Re})," ",!!_e&&e(O,{children:"· "}),!!_e&&e(O,{children:e(It,{datetime:_e,format:"micro"})})]}),!!j&&e("h1",{class:"title",lang:te,dir:"auto",title:j,children:j})]}),!!$&&e("p",{class:`description ${Ue&&!Ne?"":"more-lines"}`,lang:te,dir:"auto",title:$,children:$}),Ue&&e(O,{children:[e("hr",{}),e("p",{class:"byline",children:e("small",{children:e(h,{id:"aavdrC",values:{0:Pe?e(mt,{account:Pe,showAvatar:!0}):B?e("a",{href:B,target:"_blank",rel:"noopener",children:U}):U}})})})]})]})]})}),M&&e("button",{type:"button",class:"small plain4 block",onClick:()=>{C(he)},disabled:he===A,children:[e(T,{icon:"comment2"})," ",e("span",{children:e(h,{id:"/bZzdR"})})," ",e(T,{icon:"chevron-down"})]})]},he)})]}),M&&!!f.length&&e("div",{class:`timeline-header-block ${I?"blended":""}`,children:I?e(O,{children:[e("div",{style:{width:50,flexShrink:0,textAlign:"center"},children:_?e(Fe,{abrupt:!0}):e("button",{type:"button",class:"light",onClick:()=>{C(null)},children:e(T,{icon:"x",alt:s({id:"9Q/4xJ"})})})}),e("p",{children:e(h,{id:"BATCqf",values:{0:A.replace(/^https?:\/\/(www\.)?/i,"").replace(/\/$/,"")},components:{0:e("span",{class:"link-text"})}})})]}):e("p",{class:"insignificant",children:e(h,{id:"Vosm4k"})})})]}),[g,f,A,_]);return e(Tt,{title:a,titleComponent:e("h1",{class:"header-double-lines",children:[e("b",{children:e(h,{id:"4/iCqx"})}),e("div",{children:u})]}),id:"trending",instance:u,emptyText:s({id:"6HA9+s"}),errorText:s({id:"scd9lw"}),fetchItems:I?P:w,checkForUpdates:I?void 0:W,checkForUpdatesInterval:5*60*1e3,useItemID:!0,headerStart:e(O,{}),boostsCarousel:o.settings.boostsCarousel,filterContext:"public",timelineStart:ee,refresh:A,clearWhenRefresh:!0,view:I?"link-mentions":void 0,headerEnd:e(lt,{portal:!0,overflow:"auto",viewScroll:"close",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(T,{icon:"more",size:"l",alt:s({id:"2FYpfJ"})})}),children:[e(Se,{onClick:()=>{let Z=prompt(s({id:"2MQ2cd"}));if(!/\./.test(Z)){Z&&alert(s({id:"7WddtO"}));return}Z&&(Z=Z.toLowerCase().trim(),location.hash=`/${Z}/trending`)},children:[e(T,{icon:"bus"})," ",e("span",{children:e(h,{id:"Sq04Yc"})})]}),d!==u&&e(Se,{onClick:()=>{location.hash=`/${d}/trending`},children:[e(T,{icon:"bus"})," ",e("small",{class:"menu-double-lines",children:e(h,{id:"iAzCp4",values:{currentInstance:d},components:{0:e("b",{})}})})]})]})},u)}const ns={block:"nearest",inline:"nearest",behavior:"smooth"};function hr(){const{_:n}=de();Qe(n({id:"i0qMbr"}),"/");const i=Ve(x),{shortcuts:s}=i,o=s.map(c=>{if(!c)return null;const{type:l,...u}=c,r={following:_i,notifications:so,list:Xs,public:ti,bookmarks:Gs,favourites:Ks,hashtag:Zs,mentions:to,trending:ao,search:oo}[l];return!r||l==="search"&&!u.query||l==="list"&&!u.id?null:e(r,{...u,columnMode:!0},l+JSON.stringify(u))});return He(["1","2","3","4","5","6","7","8","9"],(c,l)=>{try{const u=parseInt(l.keys[0],10)-1,r=document.querySelectorAll("#columns > *")[u];r&&(r.focus(),r.scrollIntoView(ns))}catch{}}),He(["[","]"],(c,l)=>{const u=l.keys[0],r=document.activeElement.closest("#columns > *"),d=Nt(),a=d?"]":"[",m=d?"[":"]";let b;u===a?b=r?r.previousElementSibling:document.querySelectorAll("#columns > *")[0]:u===m&&(b=r?r.nextElementSibling:document.querySelectorAll("#columns > *")[1]),b&&(b.focus(),b.scrollIntoView(ns))}),e("div",{id:"columns",onContextMenu:c=>{c.target.closest(".deck > header")&&!c.target.closest("a")&&!c.target.closest("button")&&(c.preventDefault(),x.showShortcutsSettings=!0)},onFocus:()=>{const c=document.activeElement.closest("#columns > *");c&&document.querySelectorAll("#columns > *").forEach(l=>{l.classList.toggle("focus",l===c)})},children:o})}function fr(){var s;const{_:n}=de(),i=Ve(x);return __BENCHMARK.end("time-to-home"),ne(()=>{(async()=>{const o=await pt.drafts.keys();if(o.length){const c=Cn();o.filter(u=>u.startsWith(c)).length&&(x.showDrafts=!0)}})()},[]),e(O,{children:(i.settings.shortcutsViewMode==="multi-column"||!i.settings.shortcutsViewMode&&i.settings.shortcutsColumnsMode)&&((s=i.shortcuts)!=null&&s.length)?e(hr,{}):e(_i,{title:n({id:"i0qMbr"}),path:"/",id:"home",headerStart:!1,headerEnd:e(pr,{})})})}function pr(){const{_:n}=de(),i=Ve(x),s=q(),[o,c]=L(void 0);return e(O,{children:[e(be,{ref:s,to:"/notifications",class:`button plain notifications-button ${i.notificationsShowNew?"has-badge":""} ${o||""}`,onClick:l=>{l.stopPropagation(),window.matchMedia("(min-width: calc(40em))").matches&&(l.preventDefault(),c(u=>u?void 0:"open"))},children:e(T,{icon:"notification",size:"l",alt:n({id:"iDNBZe"})})}),e(gr,{state:o,anchorRef:s,onClose:()=>c(void 0)})]})}const mr=5;function gr({anchorRef:n,state:i,onClose:s}){const{masto:o,instance:c}=le(),l=Ve(x),[u,r]=L("default"),d=ei();async function a(){const y=await d.next(),v=eo(y.value);if(v!=null&&v.length){v.forEach(_=>{Je(_.status,c,{skipThreading:!0})});const w=io(v);x.notificationsLast=w[0],x.notifications=w,o.v1.markers.create({notifications:{lastReadId:w[0].id}}).catch(()=>{})}return x.notificationsShowNew=!1,x.notificationsLastFetchTime=Date.now(),y}const[m,b]=L(!1);function g(){return o.v1.followRequests.list({limit:1})}function p(){r("loading"),(async()=>{try{await a();const y=await g();b(!!(y!=null&&y.length)),r("default")}catch{r("error")}})()}ne(()=>{i==="open"&&p()},[i]);const f=q();return e(li,{ref:f,menuClassName:"notifications-menu",state:i,anchorRef:n,onClose:s,portal:{target:document.body},containerProps:{onClick:()=>{var y,v;(v=(y=f.current)==null?void 0:y.closeMenu)==null||v.call(y)}},overflow:"auto",viewScroll:"close",position:"anchor",align:"center",boundingBoxPadding:"8 8 8 8",children:[e("header",{children:e("h2",{children:e(h,{id:"iDNBZe"})})}),e("main",{children:l.notifications.length?e(O,{children:l.notifications.slice(0,mr).map(y=>e(an,{instance:c,notification:y,disableContextMenu:!0},y._ids||y.id))}):u==="loading"?e("div",{class:"ui-state",children:e(Fe,{abrupt:!0})}):u==="error"&&e("div",{class:"ui-state",children:[e("p",{children:e(h,{id:"5GFQTh"})}),e("p",{children:e("button",{type:"button",onClick:p,children:e(h,{id:"KDw4GX"})})})]})}),e("footer",{children:[e(be,{to:"/mentions",class:"button plain",children:[e(T,{icon:"at"})," ",e("span",{children:e(h,{id:"/bZzdR"})})]}),e(be,{to:"/notifications",class:"button plain2",children:[m?e(h,{id:"OdVhdR",components:{0:e("span",{class:"tag collapsed"}),1:e("span",{})}}):e("b",{children:e(h,{id:"gukqfD"})})," ",e(T,{icon:"arrow-right"})]})]})]})}const br=rt(fr),yr=[/^\/@[^@\/]+\/(?:statuses|posts)\/([^\/]+)/i,/\/notes\/([^\/]+)/i,/^\/(?:notice|objects)\/([a-z0-9-]+)/i,/\/@[^@\/]+\/post\/([^\/]+)/i,/\/@[^@\/]+@?[^\/]+?\/([^\/]+)/i,/^\/p\/[^\/]+\/([^\/]+)/i];function lo(n){const{hostname:i,pathname:s}=URL.parse(n);for(const o of yr){const[,c]=s.match(o)||[];if(c)return{instance:i,id:c}}return{}}function vr(n){const{instance:i,id:s}=lo(n);return i&&s?`/${i}/s/${s}`:null}function wr(){const i=Zt().pathname.replace(/^\//,""),s=lo(i),o=s!=null&&s.instance?`/${s.instance}/s/${s.id}`:null,[c,l]=L("loading");return wt(()=>{l("loading"),(async()=>{try{const{instance:u,id:r}=s;if(r){const{masto:d}=le({instance:u});if(await d.v1.statuses.$select(r).fetch()){window.location.hash=o+"?view=full";return}}}catch{}{const{masto:u,instance:r}=le(),d=await u.v2.search.fetch({q:i,limit:1,resolve:!0});if(d.statuses.length){const a=d.statuses[0];window.location.hash=`/${r}/s/${a.id}?view=full`}else if(d.accounts.length){const a=d.accounts[0];window.location.hash=`/${r}/a/${a.id}`}else o?window.location.hash=o+"?view=full":l("error")}})()},[o]),e("div",{class:"ui-state",tabIndex:"-1",children:[c==="loading"?e(O,{children:[e(Fe,{abrupt:!0}),e("h2",{children:e(h,{id:"RTAr/z"})}),e("p",{children:e("a",{href:i,target:"_blank",rel:"noopener",children:i})})]}):e(O,{children:[e("h2",{children:e(h,{id:"ufzZSJ"})}),e("p",{children:e("a",{href:i,target:"_blank",rel:"noopener",children:i})})]}),e("hr",{}),e("p",{children:e(be,{to:"/",children:e(h,{id:"iWpEwy"})})})]})}function kr(){const{_:n}=de();Qe(n({id:"h16FyT"}),"/l");const[i,s]=L("default"),[o,c]=Rt(a=>a+1,0),[l,u]=L([]);ne(()=>{s("loading"),(async()=>{try{const a=await Jn();u(a),s("default")}catch{s("error")}})()},[o]);const[r,d]=L(!1);return e("div",{id:"lists-page",class:"deck-container",tabIndex:"-1",children:[e("div",{class:"timeline-deck deck",children:[e("header",{children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Mt,{}),e(be,{to:"/",class:"button plain",children:e(T,{icon:"home",size:"l"})})]}),e("h1",{children:e(h,{id:"h16FyT"})}),e("div",{class:"header-side",children:e("button",{type:"button",class:"plain",onClick:()=>d(!0),children:e(T,{icon:"plus",size:"l",alt:n({id:"Sb2gYF"})})})})]})}),e("main",{children:l.length>0?e(O,{children:[e("ul",{class:"link-list",children:l.map(a=>e("li",{children:e(be,{to:`/l/${a.id}`,children:e("span",{children:[e(T,{icon:"list"})," ",e("span",{children:a.title})]})})}))}),l.length>1&&e("footer",{class:"ui-state",children:e("small",{class:"insignificant",children:e(h,{id:"8prZNK",values:{0:l.length}})})})]}):i==="loading"?e("p",{class:"ui-state",children:e(Fe,{})}):i==="error"?e("p",{class:"ui-state",children:e(h,{id:"v/l5uA"})}):e("p",{class:"ui-state",children:e(h,{id:"IvPikw"})})})]}),r&&e(qe,{onClick:a=>{a.target===a.currentTarget&&d(!1)},children:e(vi,{list:r==null?void 0:r.list,onClose:a=>{a.state==="success"&&c(),d(!1)}})})]})}const Sr=""+new URL("instances-LA7224ZB.json",import.meta.url).href;function _r(n){return("0"+n.toString(16)).slice(-2)}function Cr(){var n=new Uint32Array(28);return window.crypto.getRandomValues(n),Array.from(n,_r).join("")}function Ir(n){const s=new TextEncoder().encode(n);return window.crypto.subtle.digest("SHA-256",s)}function Tr(n){let i="";const s=new Uint8Array(n),o=s.byteLength;for(var c=0;c<o;c++)i+=String.fromCharCode(s[c]);return btoa(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ro(n){const i=await Ir(n);return Tr(i)}async function Ar({instanceURL:n}){var i;if(!n)return!1;try{const s=await fetch(`https://${n}/.well-known/oauth-authorization-server`);return!s.ok||s.status!==200?!1:!!((i=(await s.json()).code_challenge_methods_supported)!=null&&i.includes("S256"))}catch{return!1}}window.__generateCodeChallenge=ro;const xr={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Blaede Phanpy",PHANPY_DEFAULT_INSTANCE:"mastodon.blaede.family",PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:"https://mastodon.blaede.family/auth/sign_up",PHANPY_GIPHY_API_KEY:"48JGsrSS1XE5w4nWe9c9hqxPbsfRWR0e",PHANPY_LINGVA_INSTANCES:"lingva.phanpy.social lingva.lunar.icu lingva.garudalinux.org translate.plausibility.cloud",PHANPY_PRIVACY_POLICY_URL:"https://mastodon.blaede.family/privacy-policy",PHANPY_WEBSITE:"https://phanpy.blaede.family",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},{DEV:Er,PHANPY_CLIENT_NAME:Rr,PHANPY_WEBSITE:Rn}=xr,Ci="read write follow push",Lr=Rn?Rn.toLowerCase().includes(location.hostname):!1,Mr=location.origin+location.pathname,Nn=Er||!Lr?Mr:Rn;async function $r({instanceURL:n}){const i=new URLSearchParams({client_name:Rr,redirect_uris:Nn,scopes:Ci,website:Rn});return await(await fetch(`https://${n}/api/v1/apps`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:i.toString()})).json()}async function Pr({instanceURL:n,client_id:i}){const s=Cr(),o=await ro(s),c=new URLSearchParams({client_id:i,code_challenge_method:"S256",code_challenge:o,redirect_uri:Nn,response_type:"code",scope:Ci});return[`https://${n}/oauth/authorize?${c.toString()}`,s]}async function Nr({instanceURL:n,client_id:i}){const s=new URLSearchParams({client_id:i,scope:Ci,redirect_uri:Nn,response_type:"code"});return`https://${n}/oauth/authorize?${s.toString()}`}async function Dr({instanceURL:n,client_id:i,client_secret:s,code:o,code_verifier:c}){const l=new URLSearchParams({client_id:i,redirect_uri:Nn,grant_type:"authorization_code",code:o});return s&&l.append("client_secret",s),c&&l.append("code_verifier",c),await(await fetch(`https://${n}/oauth/token`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:l.toString()})).json()}const Or={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Blaede Phanpy",PHANPY_DEFAULT_INSTANCE:"mastodon.blaede.family",PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:"https://mastodon.blaede.family/auth/sign_up",PHANPY_GIPHY_API_KEY:"48JGsrSS1XE5w4nWe9c9hqxPbsfRWR0e",PHANPY_LINGVA_INSTANCES:"lingva.phanpy.social lingva.lunar.icu lingva.garudalinux.org translate.plausibility.cloud",PHANPY_PRIVACY_POLICY_URL:"https://mastodon.blaede.family/privacy-policy",PHANPY_WEBSITE:"https://phanpy.blaede.family",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},{PHANPY_DEFAULT_INSTANCE:zr}=Or;function Ur(){var S,k;const{_:n}=de();Qe(n({id:"sQia9P"}),"/login");const i=q(),s=ke.local.get("instanceURL"),[o,c]=L("default"),[l]=bt(),u=l.get("instance"),r=l.get("submit"),[d,a]=L(u||(s==null?void 0:s.toLowerCase())||""),[m,b]=L([]),g=q();ne(()=>{(async()=>{try{const C=await(await fetch(Sr)).json();b(C),g.current=new Go(C)}catch{}})()},[]);const p=A=>{A&&(async()=>{try{const I=await(await fetch(`https://${A}/.well-known/host-meta`)).text(),P=new DOMParser().parseFromString(I,"text/xml").getElementsByTagName("Link")[0].getAttribute("template"),W=URL.parse(P),{host:ee}=W;A!==ee&&(A=ee)}catch{}ke.local.set("instanceURL",A),c("loading");try{const{client_id:C,client_secret:I,vapid_key:E}=await $r({instanceURL:A});if(await Ar({instanceURL:A}))if(C&&I){ke.sessionCookie.set("clientID",C),ke.sessionCookie.set("clientSecret",I),ke.sessionCookie.set("vapidKey",E);const[z,P]=await Pr({instanceURL:A,client_id:C});ke.sessionCookie.set("codeVerifier",P),location.href=z}else alert(n({id:"ZP1FIA"}));else C&&I?(ke.sessionCookie.set("clientID",C),ke.sessionCookie.set("clientSecret",I),ke.sessionCookie.set("vapidKey",E),location.href=await Nr({instanceURL:A,client_id:C})):alert(n({id:"ZP1FIA"}));c("default")}catch{c("error")}})()},f=d?d.replace(/^https?:\/\//,"").replace(/\/+$/,"").replace(/^@?[^@]+@/,"").trim():null,y=/[^\s\r\n\t\/\\]+\.[^\s\r\n\t\/\\]+/.test(f)&&!/[\s\/\\@]/.test(f),v=f?(k=(S=g.current)==null?void 0:S.search(f,{limit:10}))==null?void 0:k.map(A=>A.item):[],w=y?f:v!=null&&v.length?v[0]:d?m.find(A=>A.includes(d)):null,_=A=>{A.preventDefault(),p(w)};return r&&ne(()=>{p(u||w)},[]),e("main",{id:"login",style:{textAlign:"center"},children:e("form",{onSubmit:_,children:[e("h1",{children:[e("img",{src:gi,alt:"",width:"80",height:"80"}),e("br",{}),e(h,{id:"sQia9P"})]}),e("label",{children:[e("p",{children:e(h,{id:"kyAi7k"})}),e("input",{value:d,required:!0,type:"text",class:"large",id:"instanceURL",ref:i,disabled:o==="loading",autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellCheck:!1,placeholder:n({id:"u3gOdY"}),onInput:A=>{a(A.target.value)},dir:"auto"}),(v==null?void 0:v.length)>0?e("ul",{id:"instances-suggestions",children:v.map((A,C)=>e("li",{children:e("button",{type:"button",class:"plain5",onClick:()=>{p(A)},children:A})}))}):e("div",{id:"instances-eg",children:e(h,{id:"/OvbEC"})})]}),o==="error"&&e("p",{class:"error",children:e(h,{id:"rmBHZn"})}),e("div",{children:[e("button",{disabled:o==="loading"||!d||!w,children:n(w?{id:"2xahsi",values:{selectedInstanceText:w}}:{id:"xGVfLh"})})," "]}),e(Fe,{hidden:o!=="loading"}),e("hr",{}),!zr&&e("p",{children:e("a",{href:"https://joinmastodon.org/servers",target:"_blank",children:e(h,{id:"LcOiWS"})})}),e("p",{children:e(be,{to:"/",children:e(h,{id:"iWpEwy"})})}),e(bi,{})]})})}const Fr=40;function Br(){const{_:n}=de(),i=Ve(x);Qe(n({id:"+GkIdc"}),"/sp");const{masto:s}=le(),[o,c]=L([]),[l,u]=L("default"),[r,d]=Rt(b=>b+1,0),[a,m]=L(!1);return ne(d,[i.reloadScheduledPosts]),ne(()=>{u("loading"),(async()=>{try{const b=s.v1.scheduledStatuses.list({limit:Fr}),g=[];let p;do p=(await b.next()).value,p!=null&&p.length&&g.push(...p);while(p!=null&&p.length);c(g)}catch{u("error")}finally{u("default")}})()},[r]),e("div",{id:"scheduled-posts-page",class:"deck-container",tabIndex:"-1",children:e("div",{class:"timeline-deck deck",children:[e("header",{children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Mt,{}),e(be,{to:"/",class:"button plain",children:e(T,{icon:"home",size:"l",alt:n({id:"i0qMbr"})})})]}),e("h1",{children:e(h,{id:"+GkIdc"})}),e("div",{class:"header-side",children:e(lt,{portal:!0,setDownOverflow:!0,overflow:"auto",viewScroll:"close",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(T,{icon:"more",size:"l",alt:n({id:"2FYpfJ"})})}),children:e(Se,{onClick:()=>{d()},children:[e(T,{icon:"refresh",size:"l"}),e("span",{children:e(h,{id:"lCF0wC"})})]})})})]})}),e("main",{children:[o.length?e("ul",{class:"posts-list",children:o.map(b=>{const{id:g,params:p,scheduledAt:f,mediaAttachments:y}=b,{inReplyToId:v,language:w,poll:_,sensitive:S,spoilerText:k,text:A,visibility:C}=p,I={id:g,inReplyToId:v,language:w,mediaAttachments:y,poll:_?{..._,expiresAt:new Date(Date.now()+_.expiresIn*1e3),options:_.options.map(E=>({title:E,votesCount:0}))}:void 0,sensitive:S,spoilerText:k,text:A,visibility:C,content:`<p>${A}</p>`};return e("li",{children:e(Hr,{status:I,scheduledAt:f,onClick:()=>{m({post:I,scheduledAt:new Date(f)})}})},g)})}):e("p",{class:"ui-state",children:l==="loading"?e(Fe,{}):n({id:"mZYb1f"})}),a&&e(qe,{onClick:b=>{b.target===b.currentTarget&&m(!1)},children:e(qr,{post:a.post,scheduledAt:a.scheduledAt,onClose:()=>m(!1)})})]})]})})}function Hr({status:n,scheduledAt:i,onClick:s}){const o=Ce(()=>{const c=(new Date(i).getTime()-Date.now())/36e5;return c<24?"time":c<720?"day":"month"},[i]);return e("button",{type:"button",class:"textual block",onClick:s,children:[e("div",{class:`post-schedule-meta post-schedule-${o}`,children:[e(T,{icon:o,class:"insignificant"})," ",e("span",{children:e(h,{id:"aEp6lO",values:{0:ot(i,{formatOpts:{weekday:"short",second:"numeric"}})},components:{0:e("b",{}),1:e(It,{datetime:i}),2:e("small",{})}})})]}),e(je,{status:n,size:"s",previewMode:!0,readOnly:!0})]})}function qr({post:n,scheduledAt:i,onClose:s}){const{masto:o}=le(),{_:c}=de(),[l,u]=L("default"),[r,d]=L(),a=r&&r.getTime()!==i.getTime(),m=Ko(),b=i&&i<=Date.now(),{inReplyToId:g}=n,[p,f]=L(null);return e("div",{id:"scheduled-post-sheet",class:"sheet",children:[e("button",{type:"button",class:"sheet-close",onClick:s,children:e(T,{icon:"x",size:"l",alt:c({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:[e(h,{id:"orjBLU",components:{0:e("b",{}),1:e(It,{datetime:i})}}),e("br",{}),e("small",{children:ot(i,{formatOpts:{weekday:"short",second:"numeric"}})})]})}),e("main",{tabIndex:"-1",children:[!!p&&e("div",{class:"status-reply",children:e(je,{status:p,size:"s",previewMode:!0,readOnly:!0})}),e(je,{status:n,size:"s",previewMode:!0,readOnly:!0,onMediaClick:(y,v,w,_)=>{y.preventDefault(),x.showMediaModal={mediaAttachments:n.mediaAttachments,mediaIndex:v}}}),e("form",{onSubmit:y=>{y.preventDefault(),u("loading"),(async()=>{try{await o.v1.scheduledStatuses.$select(n.id).update({scheduledAt:r.toISOString()}),me(c({id:"40naR1"})),s(),u("default"),x.reloadScheduledPosts++}catch{u("error"),me(c({id:"ZM3jAs"}))}})()},children:e("footer",{children:[e("div",{class:"row",children:e("span",{children:[e(Wo,{scheduledAt:i,setScheduledAt:y=>{d(y)}})," ",e("small",{class:"ib",children:m})]})}),e("div",{class:"row",children:[e("button",{disabled:!a||l==="loading"||b,children:e(h,{id:"QqW27M"})}),e("span",{class:"grow"}),e(ut,{align:"end",menuItemClassName:"danger",confirmLabel:c({id:"09u3Kk"}),onClick:()=>{u("loading"),(async()=>{try{await le().masto.v1.scheduledStatuses.$select(n.id).remove(),me(c({id:"/zL/Mq"})),s(),u("default"),x.reloadScheduledPosts++}catch{u("error"),me(c({id:"aOh6Md"}))}})()},children:e("button",{type:"button",class:"light danger",disabled:l==="loading"||b,children:e(h,{id:"Jb6/SB"})})})]})]})})]})]})}const Yr={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Blaede Phanpy",PHANPY_DEFAULT_INSTANCE:"mastodon.blaede.family",PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:"https://mastodon.blaede.family/auth/sign_up",PHANPY_GIPHY_API_KEY:"48JGsrSS1XE5w4nWe9c9hqxPbsfRWR0e",PHANPY_LINGVA_INSTANCES:"lingva.phanpy.social lingva.lunar.icu lingva.garudalinux.org translate.plausibility.cloud",PHANPY_PRIVACY_POLICY_URL:"https://mastodon.blaede.family/privacy-policy",PHANPY_WEBSITE:"https://phanpy.blaede.family",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},{PHANPY_DEFAULT_INSTANCE:is}=Yr,mn=40,jr=10,Vr=5;let ni={},wn={},kn={};function Sn(n){delete wn[n],delete kn[n]}const Qt={block:"nearest",inline:"center",behavior:"smooth"},ss=".status-link:not(details:not([open]) > summary ~ *, details:not([open]) > summary ~ * *), .status-focus:not(details:not([open]) > summary ~ *, details:not([open]) > summary ~ * *)",os=/\/s\//i;function Gr(n){var A;const{_:i}=de(),{id:s}=n,{masto:o,instance:c}=le({instance:n.instance}),l=Ve(x),[u,r]=bt(),d=u.get("media"),a=u.get("media-only"),m=parseInt(d||a,10);let b=m>0;const g=u.get("mediaStatusID"),p=gs(g,c);g&&!p&&(b=!1);const f=b&&!!a,y=at(s,c),[v,w]=L(x.statuses[y]);ne(()=>{x.statuses[y]&&w(x.statuses[y])},[y]);const _=Ce(()=>{const{prevLocation:C}=x,I=((C==null?void 0:C.pathname)||"")+((C==null?void 0:C.search)||""),E=sn("/:instance/s/:id",I)||sn("/s/:id",I);return!I||E?"/":I},[]);ne(()=>{!v&&b&&(async()=>{try{const C=await o.v1.statuses.$select(s).fetch();Je(C,c),w(C)}catch{alert("Unable to load post."),location.hash=_}})()},[b]);const S=g?(A=l.statuses[at(g,c)])==null?void 0:A.mediaAttachments:v==null?void 0:v.mediaAttachments,k=st(()=>{!window.matchMedia("(min-width: calc(40em + 350px))").matches&&l.prevLocation?history.back():f?location.hash=_:(u.delete("media"),u.delete("mediaStatusID"),r(u))},[f,_,l.prevLocation]);return ne(()=>{let C=setTimeout(()=>{const I=document.querySelector(".carousel");I&&I.focus()},100);return()=>clearTimeout(C)},[f]),ne(()=>{const C=document.querySelectorAll(".deck-container");return C.forEach(I=>{I.setAttribute("inert","")}),()=>{C.forEach(I=>{I.removeAttribute("inert")})}},[]),e("div",{class:"deck-backdrop",children:[b?S!=null&&S.length?e(qs,{mediaAttachments:S,statusID:g||s,instance:c,lang:v==null?void 0:v.language,index:m-1,onClose:k}):e("div",{class:"media-modal-container loading",children:e(Fe,{abrupt:!0})}):e(be,{to:_}),!f&&e(Wr,{id:s,instance:n.instance,closeLink:_})]})}function Kr(n){const{linkable:i,to:s,onClick:o,...c}=n;return i?e(be,{class:"status-link",to:s,onClick:o,...c}):e("div",{class:"status-focus",tabIndex:0,...c})}function cs(n,i){return new Date(i.created_at)-new Date(n.created_at)}function Wr({id:n,closeLink:i="/",instance:s}){var Q,ge;const{_:o}=de(),[c,l]=bt(),u=c.get("media"),r=c.get("mediaStatusID"),d=parseInt(u,10)>0,a=q(!x.prevLocation&&(history.length===1||"navigation"in window&&((ge=(Q=navigation==null?void 0:navigation.entries)==null?void 0:Q.call(navigation))==null?void 0:ge.length)===1)),[m,b]=L(c.get("view")||a.current?"full":null),g=!!parseInt(c.get("translate")),{masto:p,instance:f}=le({instance:s}),{masto:y,instance:v,authenticated:w}=le(),_=f===v,S=Ve(x),[k,A]=L([]),[C,I]=L("default"),E=q(),M=at(n,f),z=q(0),P=q();ne(()=>{var D;(D=P.current)==null||D.focus()},[]),ne(()=>{var ie;const D=xs(()=>{if(!P.current)return;const{scrollTop:ue}=P.current;C!=="loading"&&(kn[n]=ue)},50);return(ie=P.current)==null||ie.addEventListener("scroll",D,{passive:!0}),D(),()=>{var ue;D.cancel(),(ue=P.current)==null||ue.removeEventListener("scroll",D)}},[n,C!=="loading"]);const W=q(),ee=q(),Z=({reloadHero:D}={})=>{I("loading");let ie;const ue=wn[n];if(ue){const N=ue.filter(re=>x.statuses[M]);A(N)}else A([{id:n}]);return(async()=>{var ye,Ee;const N=()=>Li(()=>p.v1.statuses.$select(n).fetch(),{retries:4}),re=Li(()=>p.v1.statuses.$select(n).context.fetch(),{retries:8}),Te=!!S.statuses[M];let H=S.statuses[M];if(!(Te&&!D))try{H=await N(),Je(H,f),await new Promise(R=>{setTimeout(R,100)})}catch{I("error");return}try{let R=function(we,ze){const tt=ze+1;return tt>$e&&($e=ze),we==null?void 0:we.map(xe=>({id:xe.id,account:xe.account,repliesCount:xe.repliesCount,content:xe.content,weight:nn(xe),level:tt,replies:R(xe.__replies,tt)}))};const K=await re,{ancestors:ce,descendants:J}=K;ce.sort(cs),J.sort(cs),z.current=(J==null?void 0:J.length)||0;const oe=new Set;ce.forEach(we=>{Je(we,f,{skipThreading:!0}),we.inReplyToId&&!ce.find(ze=>ze.id===we.inReplyToId)&&oe.add(we.inReplyToId)});const Oe=ce.every(we=>we.account.id===H.account.id),Me=[];J.forEach(we=>{if(Je(we,f,{skipThreading:!0}),we.inReplyToId&&!J.find(ze=>ze.id===we.inReplyToId)&&we.inReplyToId!==H.id&&oe.add(we.inReplyToId),we.inReplyToAccountId===we.account.id)Me.push(we);else if(we.inReplyToId===H.id)Me.push(we);else if(!we.inReplyToAccountId&&Me.find(ze=>ze.id===we.inReplyToId&&ze.account.id===H.account.id)&&we.account.id===H.account.id)Me.push(we);else{const ze=J.find(tt=>tt.id===we.inReplyToId);ze&&(ze.__replies||(ze.__replies=[]),ze.__replies.push(we))}}),Me.sort((we,ze)=>{const tt=H.account.id;return we.account.id===tt&&ze.account.id!==tt?-1:ze.account.id===tt&&we.account.id!==tt?1:0}),oe.size;let $e=1;const Be=[...ce.map(we=>({id:we.id,ancestor:!0,isThread:Oe,accountID:we.account.id,account:we.account,repliesCount:we.repliesCount,weight:nn(we)})),{id:n,accountID:H.account.id,weight:nn(H)},...Me.map(we=>({id:we.id,account:we.account,accountID:we.account.id,descendant:!0,thread:we.account.id===H.account.id,weight:nn(we),level:1,replies:R(we.__replies,1)}))];I("default"),W.current={offsetTop:(ye=E.current)==null?void 0:ye.offsetTop,scrollTop:(Ee=P.current)==null?void 0:Ee.scrollTop};const Ge=ce.length||0;Ge>=G&&te(Ge+1),A(Be),wn[n]=Be,To(H,f)}catch{I("error")}})(),ee.current=Date.now(),()=>{clearTimeout(ie)}};ne(Z,[n,p]);const[V,U]=L(!1);ne(()=>{let D=setInterval(()=>{const ie=Date.now();ee.current&&ie-ee.current>=6e4&&U(!0)},6e4);return()=>{clearInterval(D)}},[]),wt(()=>{var ie,ue;if(!k.length)return;const D=kn[n];if(D)P.current.scrollTop=D;else if(W.current){const N={offsetTop:(ie=E.current)==null?void 0:ie.offsetTop,scrollTop:(ue=P.current)==null?void 0:ue.scrollTop},re=N.offsetTop-W.current.offsetTop+N.scrollTop;P.current.scrollTop=re}else k.length===1&&(P.current.scrollTop=0);W.current=null},[k]),ne(()=>{S.reloadStatusPage<=0||(async()=>{try{const{instanceURL:D}=si(),ie=`https://${D}/api/v1/statuses/${n}/context`;return await(await caches.open("api")).delete(ie,{ignoreVary:!0}),Z({reloadHero:!0})}catch{}})()},[S.reloadStatusPage]),ne(()=>()=>{kn={},x.reloadStatusPage=0,wn={},ni={},ii.clear()},[]);const B=S.statuses[M]||S.statuses[n],se=Ce(()=>{if(!B)return"";const{account:D}=B,ie=document.createElement("div");return ie.innerHTML=D.displayName,ie.innerText.trim()},[B]),$=Ce(()=>{if(!B)return"";let D=Ln(B);return D.length>64&&(D=D.slice(0,64)+"…"),D},[B]);Qe(se&&$?`${se}: "${$}"`:o({id:"post.title"}),"/:instance?/s/:id");const F=Ce(()=>{if(!B)return;const{url:D}=B;if(D)return URL.parse(D).hostname},[B]),Y=Ce(()=>{if(F)return F===f},[F,f]),[G,te]=L(mn),ae=Ce(()=>k.length-G,[k.length,G]),ve=k.some(D=>D.descendant),_e=k.filter(D=>D.ancestor),[j,he]=L(!0),Ae=Ce(()=>{if(!E.current||j)return null;const{top:D}=E.current.getBoundingClientRect();return D>0?"down":"up"},[j]);He("esc",()=>{location.hash=i},{enabled:!d,ignoreEventWhen:D=>!!document.querySelector("#modal-container > *")}),He("backspace",()=>{location.hash=i}),He("j",()=>{const D=document.activeElement.closest(".status-link, .status-focus"),ie=D==null?void 0:D.getBoundingClientRect(),ue=Array.from(P.current.querySelectorAll(ss));if(D&&ie.top<P.current.clientHeight&&ie.bottom>0){const N=ue.indexOf(D);let re=ue[N+1];re&&(re.focus(),re.scrollIntoView(Qt))}else{const N=ue.find(re=>{const Te=re.getBoundingClientRect();return Te.top>=44&&Te.left>=0});N&&(N.focus(),N.scrollIntoView(Qt))}}),He("k",()=>{const D=document.activeElement.closest(".status-link, .status-focus"),ie=D==null?void 0:D.getBoundingClientRect(),ue=Array.from(P.current.querySelectorAll(ss));if(D&&ie.top<P.current.clientHeight&&ie.bottom>0){const N=ue.indexOf(D);let re=ue[N-1];re&&(re.focus(),re.scrollIntoView(Qt))}else{const N=ue.find(re=>{const Te=re.getBoundingClientRect();return Te.top>=44&&Te.left>=0});N&&(N.focus(),N.scrollIntoView(Qt))}}),He("x",()=>{const D=document.activeElement.closest(".status-link, .status-focus");if(D){const ie=D.nextElementSibling;ie&&ie.tagName.toLowerCase()==="details"&&(ie.open=!ie.open)}});const[Pe,Ne]=L(!1),Ue=q(d?"media+status":"status"),Re=st((D,ie,ue,N)=>{D.preventDefault(),D.stopPropagation(),l({media:ie+1,mediaStatusID:N.id})},[n]),Le=st((D,ie)=>{Sn(ie.id)},[]);ne(()=>{let D;return r&&d&&(D=setTimeout(()=>{var ue;const ie=(ue=P.current)==null?void 0:ue.querySelector(`.status-link[href*="/${r}"]`);ie&&ie.scrollIntoView(Qt)},400)),()=>{clearTimeout(D)}},[r,d]);const X=st((D,ie)=>{const{id:ue,ancestor:N,isThread:re,descendant:Te,thread:H,replies:ye,repliesCount:Ee,weight:R,level:K}=D,ce=ue===n;return e("li",{ref:ce?E:null,class:`${N?"ancestor":""} ${Te?"descendant":""} ${H?"thread":""} ${ce?"hero":""}`,children:[ce?e(O,{children:[e(Ct,{threshold:.1,onChange:oe=>{queueMicrotask(()=>{requestAnimationFrame(()=>{he(oe)})})},class:"status-focus",tabIndex:0,children:e(je,{statusID:ue,instance:f,withinContext:!0,size:"l",enableTranslate:!0,forceTranslate:g})}),C!=="loading"&&!w?e("div",{class:"post-status-banner",children:[e("p",{children:e(h,{id:"Vyeh4F"})}),e(be,{to:is?`/login?instance=${is}&submit=1`:"/login",class:"button",children:e(h,{id:"sQia9P"})})]}):!_&&e("div",{class:"post-status-banner",children:[e("p",{children:e(h,{id:"j5roNG",values:{instance:f},components:{0:e("b",{})}})}),e("button",{type:"button",disabled:C==="loading",onClick:()=>{I("loading"),(async()=>{try{const oe=await y.v2.search.fetch({q:B.url,type:"statuses",resolve:!0,limit:1});if(oe.statuses.length){const Oe=oe.statuses[0];location.hash=v?`/${v}/s/${Oe.id}`:`/s/${Oe.id}`}else throw new Error("No results")}catch(oe){I("default"),alert(o({id:"DnepCE",values:{e:oe}}))}})()},children:[e(T,{icon:"transfer"})," ",e(h,{id:"ejAVrO"})]})]})]}):e(Kr,{linkable:re||N,to:f?`/${f}/s/${ue}`:`/s/${ue}`,onClick:()=>{Sn(ue)},children:[ie===0&&N?e(Ct,{threshold:.5,onChange:oe=>{queueMicrotask(()=>{requestAnimationFrame(()=>{Ne(oe)})})},children:e(je,{statusID:ue,instance:f,withinContext:!0,size:H||N?"m":"s",enableTranslate:!0,onMediaClick:Re,onStatusLinkClick:Le})}):e(je,{statusID:ue,instance:f,withinContext:!0,size:H||N?"m":"s",enableTranslate:!0,onMediaClick:Re,onStatusLinkClick:Le,showActionsBar:!!Te}),N&&Ee>1&&e("div",{class:"replies-link",children:[e(T,{icon:"comment2",alt:o({id:"N8UzTV"})})," ",e("span",{title:Ee,children:Xe(Ee)})]})," "]}),Te&&(ye==null?void 0:ye.length)>0&&e(uo,{instance:f,replies:ye,hasParentThread:H,level:K,accWeight:R,openAll:z.current<jr,parentLink:{to:f?`/${f}/s/${ue}`:`/s/${ue}`,onClick:()=>Sn(ue)}}),C==="loading"&&ce&&!!(B!=null&&B.repliesCount)&&!ve&&e("div",{class:"status-loading",children:e(Fe,{abrupt:B.repliesCount>=3})}),C==="error"&&ce&&!!(B!=null&&B.repliesCount)&&!ve&&e("div",{class:"status-error",children:[e(h,{id:"HQJU6W"}),e("br",{}),e("button",{type:"button",class:"plain",onClick:()=>{x.reloadStatusPage++},children:e(h,{id:"KDw4GX"})})]})]},ue)},[n,f,C,w,_,g,Re,Le,ve]),Ie=Ce(()=>{var D;if("navigation"in window&&(navigation!=null&&navigation.entries)){const ie=navigation.entries()[navigation.currentEntry.index-1];if(ie!=null&&ie.url)return os.test(ie.url)}return os.test((D=x.prevLocation)==null?void 0:D.pathname)},[M]),De=Ce(()=>{if(!ae)return[];const D=[];function ie(ue){D.push(ue.id),ue.replies&&ue.replies.forEach(ie)}return k.slice(G).forEach(ie),D.map(ue=>at(ue,f))},[ae,k,G,f]),fe=Ce(()=>k.slice(0,G).map(X),[k,G,X]);return ne(()=>{let D=setTimeout(()=>{if(!E.current)return;const ie=E.current.querySelector(".spoiler-button:not(.spoiling), .spoiler-media-button:not(.spoiling)");ie&&ie.click()},1e3);return()=>clearTimeout(D)},[n]),e("div",{tabIndex:"-1",ref:P,class:`status-deck deck contained ${k.length>1?"padded-bottom":""} ${Ue.current==="status"&&!a.current?"slide-in":""} ${m?`deck-view-${m}`:""}`,onAnimationEnd:D=>{Ue.current==="status"&&(Ue.current=null)},children:[e("header",{class:`${C==="loading"?"loading":""}`,onDblClick:D=>{x.reloadStatusPage++},children:e("div",{class:"header-grid header-grid-2",children:[e("h1",{children:[Ie&&e("button",{type:"button",class:"plain deck-back",onClick:()=>{history.back()},children:e(T,{icon:"chevron-left",size:"xl",alt:o({id:"iH8pgl"})})}),!j&&B&&C!=="loading"?e(O,{children:[e("span",{class:"hero-heading",children:[e(mt,{account:B.account,instance:f,showAvatar:!0,short:!0})," ",e("span",{class:"insignificant",children:["•"," ",e(It,{datetime:B.createdAt,format:"micro"})]})]})," ",e("button",{type:"button",class:"ancestors-indicator light small",onClick:D=>{D.preventDefault(),D.stopPropagation(),E.current.scrollIntoView({behavior:"smooth",block:"start"})},title:o({id:"NCy+Nw"}),children:e(T,{icon:Ae==="down"?"arrow-down":"arrow-up"})})]}):e(O,{children:[e(h,{id:"post.title"})," ",e("button",{type:"button",class:"ancestors-indicator light small",onClick:D=>{D.preventDefault(),D.stopPropagation(),P.current.scrollTo({top:0,behavior:"smooth"})},hidden:!_e.length||Pe,title:o({id:"R8CUl0",values:{0:_e.length}}),children:[e(T,{icon:"arrow-up"}),_e.filter((D,ie,ue)=>ue.findIndex(N=>N.accountID===D.accountID)===ie).slice(0,3).map(D=>e(ft,{url:D.account.avatar,alt:D.account.displayName},D.account.id)),_e.length>3&&e(O,{children:[" ",e("span",{class:"insignificant",children:Xe(_e.length)})]})]})]})]}),e("div",{class:"header-side",children:[e("button",{type:"button",class:"plain4 button-switch-view",style:{display:m==="full"?"":"none"},onClick:()=>{b(null),c.delete("media"),c.delete("media-only"),c.delete("view"),l(c)},title:o({id:"+/xYEI"}),children:e(T,{icon:"layout4",size:"l"})}),V&&e("button",{type:"button",class:"plain button-refresh",onClick:()=>{x.reloadStatusPage++,U(!1)},children:e(T,{icon:"refresh",size:"l",alt:o({id:"lCF0wC"})})}),e(lt,{align:"end",portal:{target:P.current},menuButton:e("button",{type:"button",class:"button plain4",children:e(T,{icon:"more",alt:o({id:"2FYpfJ"}),size:"xl"})}),children:[e(Se,{disabled:C==="loading",onClick:()=>{x.reloadStatusPage++},children:[e(T,{icon:"refresh"}),e("span",{children:e(h,{id:"lCF0wC"})})]}),e(Se,{className:"menu-switch-view",onClick:()=>{b(m==="full"?null:"full"),c.delete("media"),c.delete("media-only"),m==="full"?c.delete("view"):c.set("view","full"),l(c)},children:[e(T,{icon:{"":"layout5",full:"layout4"}[m||""]}),e("span",{children:o(m==="full"?{id:"+/xYEI"}:{id:"2LiWsE"})})]}),e(Se,{onClick:()=>{Array.from(P.current.querySelectorAll(".spoiler-button:not(.spoiling), .spoiler-media-button:not(.spoiling)")).forEach(ie=>{ie.click()})},children:[e(T,{icon:"eye-open"})," ",e("span",{children:e(h,{id:"8r8KmB"})})]}),e(We,{}),e(As,{className:"plain",children:e(h,{id:"Rsjgm0"})}),e(Se,{disabled:!F||Y,onClick:()=>{const D=vr(B.url);D?location.hash=D:alert(o({id:"9J6biQ"}))},children:[e(T,{icon:"transfer"}),e("small",{class:"menu-double-lines",children:o(F?{id:"tElD3e",values:{1:zt.toUnicode(F)}}:{id:"lb07+k"})})]})]}),e(be,{class:"button plain deck-close",to:i,children:e(T,{icon:"x",size:"xl",alt:o({id:"yz7wBu"})})})]})]})}),k.length&&B?e("ul",{class:`timeline flat contextual grow ${C==="loading"?"loading":""}`,children:[fe,ae>0&&e("li",{class:"descendant descendant-more",children:e("button",{type:"button",class:"plain block show-more",disabled:C==="loading",onClick:()=>te(D=>D+mn),style:{marginBlockEnd:"6em"},"data-state-post-ids":De.join(" "),children:[e("div",{class:"ib avatars-bunch",children:k.slice(G,G+5).map(D=>e(ft,{url:D.account.avatarStatic},D.id))})," ",e("div",{class:"ib",children:[e(h,{id:"uXRAkV"})," ",e("span",{class:"tag",children:ae>mn?`${mn}+`:ae})]})]})})]}):e(O,{children:[C==="loading"&&e("ul",{class:"timeline flat contextual grow loading",children:e("li",{children:e(je,{skeleton:!0,size:"l"})})}),C==="error"&&e("p",{class:"ui-state",children:[e(h,{id:"JWxodU"}),e("br",{}),e("br",{}),e("button",{type:"button",onClick:()=>{x.reloadStatusPage++},children:e(h,{id:"KDw4GX"})})]})]})]})}function uo({replies:n,instance:i,hasParentThread:s,level:o,accWeight:c,openAll:l,parentLink:u}){const{_:r}=de(),[d,a]=bt(),m=I=>I.reduce((E,M)=>{const{repliesCount:z,replies:P}=M,W=(P==null?void 0:P.length)||z;return E+W+m(P||[])},0),b=n.length+m(n),g=n.length===b,p=n.map(I=>I.account).filter((I,E,M)=>M.findIndex(z=>z.id===I.id)===E).slice(0,3),f=Ce(()=>n==null?void 0:n.reduce((I,E)=>I+(E==null?void 0:E.weight),c),[c,n==null?void 0:n.length]);let y=!1;(l||f<=Vr||!s&&b===1&&nn(n[0])<2)&&(y=!0);const v=ni[n[0].id],w=st((I,E,M,z)=>{I.preventDefault(),I.stopPropagation(),a({media:E+1,mediaStatusID:z.id})},[]),_=q();wt(()=>{var E;function I(M){M.target.dataset.scrollLeft=M.target.scrollLeft}return(E=_.current)==null||E.addEventListener("scroll",I,{passive:!0}),()=>{var M;(M=_.current)==null||M.removeEventListener("scroll",I)}},[]);const[S,k]=L(v||y);ne(()=>{let I;return!v&&!y&&(I=setTimeout(()=>k(!0),100)),()=>clearTimeout(I)},[v,y]);const A=y?"div":"details",C=A==="details";return e(A,{ref:_,class:"replies",open:C?v||y:void 0,onToggle:C?I=>{const{open:E}=I.target;ni[n[0].id]=E}:void 0,style:{"--comments-level":o},"data-comments-level":o,"data-comments-level-overflow":o>4,children:[!y&&e("summary",{class:"replies-summary",hidden:y,children:[e("span",{class:"avatars",children:p.map(I=>e(ft,{url:I.avatarStatic,title:`${I.displayName} @${I.username}`,squircle:I==null?void 0:I.bot},I.id))}),e("span",{class:"replies-counts",children:[e("b",{children:e(h,{id:"DOQUen",values:{0:n.length,1:Xe(n.length)},components:{0:e("span",{title:n.length})}})}),!g&&b>1&&e(O,{children:[" ","·"," ",e("span",{children:e(h,{id:"qSQQSe",values:{0:Xe(b),totalComments:b},components:{0:e("span",{title:b})}})})]})]}),e(T,{icon:"chevron-down",class:"replies-summary-chevron"}),!!u&&e(be,{class:"replies-parent-link",to:u.to,onClick:u.onClick,title:r({id:"ZlV82A"}),children:"»"})]}),S&&e("ul",{children:n.map(I=>{var E,M;return e("li",{children:[e("div",{class:"status-focus",tabIndex:0,children:[e(je,{statusID:I.id,instance:i,withinContext:!0,size:"s",enableTranslate:!0,onMediaClick:w,showActionsBar:!0}),!((E=I.replies)!=null&&E.length)&&I.repliesCount>0&&e("div",{class:"replies-link",children:[e(T,{icon:"comment2",alt:r({id:"N8UzTV"})})," ",e("span",{title:I.repliesCount,children:Xe(I.repliesCount)})]})]}),((M=I.replies)==null?void 0:M.length)&&e(uo,{instance:i,replies:I.replies,level:I.level,accWeight:y?f:I.weight,openAll:l,parentLink:{to:i?`/${i}/s/${I.id}`:`/s/${I.id}`,onClick:()=>{Sn(I.id)}}})]},I.id)})})]})}const Zr=140,Xr=35,Jr=70,Qr=140,ii=new Map;function nn(n){var p,f;const i=ii.get(n.id);if(i)return i;const{spoilerText:s,content:o,mediaAttachments:c,poll:l,card:u}=n,r=Ts(s+o),d=c!=null&&c.length?Zr:0,a=(((p=l==null?void 0:l.options)==null?void 0:p.length)||0)*Xr,m=u&&(c!=null&&c.length||(f=l==null?void 0:l.options)!=null&&f.length)?0:Jr,g=(r+d+a+m)/Qr;return ii.set(n.id,g),g}const ed=rt(Gr);function td(){const n=Lt(),{id:i,instance:s}=n;return e(ed,{id:i,instance:s})}const nd=""+new URL("boosts-carousel-BiOaNdMT.jpg",import.meta.url).href,id=""+new URL("grouped-notifications-DFgwVVj3.jpg",import.meta.url).href,sd=""+new URL("multi-column-ROck0NVt.jpg",import.meta.url).href,od=""+new URL("multi-hashtag-timeline-DH5INVHi.jpg",import.meta.url).href,cd=""+new URL("nested-comments-thread-hv59kZLc.jpg",import.meta.url).href,ad="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20fill-rule='evenodd'%20stroke-linejoin='round'%20stroke-miterlimit='2'%20clip-rule='evenodd'%20viewBox='0%200%20102%2028'%3e%3cpath%20fill='none'%20d='M0%200h101.5v27.5H0z'/%3e%3cg%20fill-rule='nonzero'%3e%3cpath%20fill='url(%23a)'%20d='M2.32%2021.85c1.4%200%202.21-.85%202.21-2.3v-4.64H8.5c4.45%200%207.54-2.9%207.54-7.24%200-4.35-2.98-7.24-7.32-7.24h-6.4C.93.43.11%201.28.11%202.73v16.82c0%201.45.82%202.3%202.21%202.3Zm2.21-10.4V3.94h3c2.54%200%204%201.34%204%203.75s-1.47%203.76-4%203.76h-3Z'/%3e%3cpath%20fill='url(%23b)'%20d='M20.52%2021.88c1.25%200%202.13-.76%202.13-2.23v-7.04c0-2.07%201.2-3.49%203.21-3.49%201.95%200%202.95%201.23%202.95%203.25v7.28c0%201.47.89%202.23%202.13%202.23%201.26%200%202.14-.76%202.14-2.23v-8.18c0-3.64-1.99-5.9-5.48-5.9-2.38%200-4.1%201.12-4.93%203.1h-.09V2.3c0-1.38-.78-2.2-2.1-2.2-1.31%200-2.1.82-2.1%202.2v17.34c0%201.47.9%202.23%202.14%202.23Z'/%3e%3cpath%20fill='url(%23c)'%20d='M40.45%2021.82c1.96%200%203.93-.98%204.8-2.65h.1v.8c.08%201.27.89%201.91%202.05%201.91%201.21%200%202.08-.73%202.08-2.15v-8.95c0-3.17-2.63-5.25-6.65-5.25-3.26%200-5.78%201.16-6.5%203.04-.15.32-.23.63-.23.96%200%20.97.75%201.64%201.79%201.64.69%200%201.23-.26%201.7-.79.95-1.23%201.74-1.65%203.04-1.65%201.62%200%202.64.85%202.64%202.31v1.04l-3.95.24c-3.93.23-6.13%201.88-6.13%204.74%200%202.83%202.27%204.76%205.26%204.76Zm1.4-3.09c-1.43%200-2.4-.73-2.4-1.9%200-1.12.91-1.83%202.51-1.95l3.31-.2v1.14c0%201.7-1.54%202.91-3.41%202.91Z'/%3e%3cpath%20fill='url(%23d)'%20d='M54.37%2021.88c1.26%200%202.14-.76%202.14-2.23v-7.09c0-2.03%201.21-3.44%203.13-3.44s2.89%201.17%202.89%203.22v7.31c0%201.47.88%202.23%202.14%202.23%201.24%200%202.13-.76%202.13-2.23v-8.2c0-3.68-1.96-5.87-5.45-5.87-2.41%200-4%201.07-4.83%203.01h-.09v-.87c0-1.35-.85-2.17-2.14-2.17-1.28%200-2.06.82-2.06%202.15v11.95c0%201.47.9%202.23%202.14%202.23Z'/%3e%3cpath%20fill='url(%23e)'%20d='M71.65%2027.17c1.26%200%202.14-.76%202.14-2.23v-6h.09a5.15%205.15%200%200%200%204.88%202.88c3.92%200%206.35-3.05%206.35-8.1%200-5.07-2.44-8.1-6.43-8.1a5.12%205.12%200%200%200-4.86%202.99h-.09v-.85c0-1.45-.88-2.21-2.1-2.21-1.24%200-2.11.76-2.11%202.2v17.2c0%201.46.89%202.22%202.13%202.22Zm5.6-8.8c-2.1%200-3.47-1.8-3.47-4.65%200-2.81%201.37-4.67%203.47-4.67%202.14%200%203.49%201.83%203.49%204.67%200%202.86-1.35%204.66-3.5%204.66Z'/%3e%3cpath%20fill='url(%23f)'%20d='M89.61%2027.39c3.44%200%205.26-1.5%206.73-5.55l4.81-13.1a4%204%200%200%200%20.24-1.26c0-1.13-.85-1.93-2.08-1.93-1.1%200-1.71.51-2.07%201.7l-3.4%2010.9h-.08L90.35%207.28c-.36-1.25-.94-1.73-2.07-1.73-1.26%200-2.21.83-2.21%201.99%200%20.35.09.82.25%201.26l5%2013.21-.21.56c-.52%201.1-1.32%201.42-2.07%201.42l-.75-.01c-.96%200-1.56.54-1.56%201.4%200%201.29%201%202%202.88%202Z'/%3e%3c/g%3e%3cdefs%3e%3cradialGradient%20id='a'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3cradialGradient%20id='b'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3cradialGradient%20id='c'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3cradialGradient%20id='d'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3cradialGradient%20id='e'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3cradialGradient%20id='f'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3c/defs%3e%3c/svg%3e",ld={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Blaede Phanpy",PHANPY_DEFAULT_INSTANCE:"mastodon.blaede.family",PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:"https://mastodon.blaede.family/auth/sign_up",PHANPY_GIPHY_API_KEY:"48JGsrSS1XE5w4nWe9c9hqxPbsfRWR0e",PHANPY_LINGVA_INSTANCES:"lingva.phanpy.social lingva.lunar.icu lingva.garudalinux.org translate.plausibility.cloud",PHANPY_PRIVACY_POLICY_URL:"https://mastodon.blaede.family/privacy-policy",PHANPY_WEBSITE:"https://phanpy.blaede.family",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},{PHANPY_DEFAULT_INSTANCE:en,PHANPY_WEBSITE:as,PHANPY_PRIVACY_POLICY_URL:rd,PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:ls}=ld,rs=as?as.replace(/https?:\/\//g,"").replace(/\/$/,""):null,ds=`${"2025-03-10T21:23:02.486Z".slice(0,10).replace(/-/g,".")}.512af62`;function ho(){const{_:n}=de();return Qe(null,["/","/welcome"]),e("main",{id:"welcome",children:[e("div",{class:"hero-container",children:[e("div",{class:"hero-content",children:[e("h1",{children:[e("img",{src:gi,alt:"",width:"160",height:"160",style:{aspectRatio:"1/1",marginBlockEnd:-16}}),e("img",{src:ad,alt:"Phanpy",width:"200"})]}),e("p",{class:"desc",children:e(h,{id:"Ogtv0V"})}),e("p",{children:e(be,{to:en?`/login?instance=${en}&submit=1`:"/login",class:"button",children:n(en?{id:"sQia9P"}:{id:"ZLoGls"})})}),en&&ls&&e("p",{children:e("a",{href:ls,class:"button plain5",children:e(h,{id:"e+RpCP"})})}),!en&&e("p",{class:"insignificant",children:e("small",{children:e(h,{id:"fvAsUK",components:{0:e("br",{})}})})})]}),(rs||ds)&&e("p",{class:"app-site-version",children:e("small",{children:[rs," ",ds]})}),e("p",{children:e(h,{id:"BskFI2",components:{0:e("a",{href:"https://github.com/cheeaun/phanpy",target:"_blank"}),1:e("a",{href:"https://mastodon.social/@cheeaun",target:"_blank",onClick:i=>{i.preventDefault(),x.showAccount="cheeaun@mastodon.social"}}),2:e("a",{href:rd,target:"_blank"})}})}),e("div",{children:e(bi,{})})]}),e("div",{id:"why-container",children:e("div",{class:"sections",children:[e("section",{children:[e("img",{src:nd,alt:n({id:"S5cYrQ"}),loading:"lazy"}),e("h4",{children:e(h,{id:"Tu+sCN"})}),e("p",{children:e(h,{id:"e2uVlo"})})]}),e("section",{children:[e("img",{src:cd,alt:n({id:"CGQ27z"}),loading:"lazy"}),e("h4",{children:e(h,{id:"cYE45+"})}),e("p",{children:e(h,{id:"Pc7QKh"})})]}),e("section",{children:[e("img",{src:id,alt:n({id:"rnrM7k"}),loading:"lazy"}),e("h4",{children:e(h,{id:"4RRMre"})}),e("p",{children:e(h,{id:"8GMtDr"})})]}),e("section",{children:[e("img",{src:sd,alt:n({id:"VLKtvP"}),loading:"lazy"}),e("h4",{children:e(h,{id:"pEkad9"})}),e("p",{children:e(h,{id:"t7Py5R"})})]}),e("section",{children:[e("img",{src:od,alt:n({id:"wOax6E"}),loading:"lazy"}),e("h4",{children:e(h,{id:"Wi1Ov0"})}),e("p",{children:e(h,{id:"tS2i+h"})})]})]})})]})}const dd=window.alert;window.__nativeAlert||(window.__nativeAlert=dd);window.alert=function(n){n instanceof Error&&(n!=null&&n.message)&&(n=n.message),typeof n!="string"&&(n=JSON.stringify(n));const i=Zo({text:n,className:"alert",gravity:"top",position:"center",duration:1e4,offset:{y:48},onClick:()=>{i.hideToast()}});i.showToast()};window.__STATES__=x;window.__STATES_STATS__=()=>{const n=["statuses","accounts","spoilers","unfurledLinks","statusQuotes"],i={};n.forEach(c=>{i[c]=Object.keys(x[c]).length});const{statuses:s}=x,o=[];for(const c in s)document.querySelector(`[data-state-post-id~="${c}"], [data-state-post-ids~="${c}"]`)||o.push(c)};setInterval(()=>{if(!window.__IDLE__)return;const{statuses:n,unfurledLinks:i,notifications:s}=x;let o=0;const{instance:c}=le();for(const l in n){if(!window.__IDLE__)break;try{const u=document.querySelector(`[data-state-post-id~="${l}"], [data-state-post-ids~="${l}"]`),r=s.some(d=>{var a;return l===at((a=d.status)==null?void 0:a.id,c)});if(!u&&!r){delete x.statuses[l],delete x.statusQuotes[l];for(const d in i){const a=i[d];if(at(a.id,a.instance)===l){delete x.unfurledLinks[d];break}}o++}}catch{}}},15*60*1e3);setTimeout(()=>{for(const n in Bt)setTimeout(()=>{var i,s,o,c,l,u;Array.isArray(Bt[n])?(s=(i=Bt[n])[0])==null||s.call(i):typeof Bt[n]=="object"?(c=(o=Bt[n]).module)==null||c.call(o):(u=(l=Bt)[n])==null||u.call(l)},1)},5e3);(()=>{window.__IDLE__=!0;const n=["mousemove","mousedown","resize","keydown","touchstart","pointerdown","pointermove","wheel"],i=()=>{window.__IDLE__=!0},o=xs(i,3e3),c=()=>{window.__IDLE__=!1,o()};n.forEach(l=>{window.addEventListener(l,c,{passive:!0,capture:!0})}),window.addEventListener("blur",i,{passive:!0}),document.documentElement.addEventListener("mouseleave",l=>{!l.relatedTarget&&!l.toElement&&i()},{passive:!0})})();const ud=/iPad|iPhone|iPod/.test(navigator.userAgent);ud&&document.addEventListener("visibilitychange",()=>{if(document.visibilityState==="visible"){if(document.getElementsByClassName("media-modal-container").length>0)return;const i=ke.local.get("theme");let s;if(i){if(s=document.querySelector('meta[name="theme-color"][data-theme-setting="manual"]'),s){const o=s.content,c=i==="light"?s.dataset.themeLightColorTemp:s.dataset.themeDarkColorTemp;s.content=c||"",setTimeout(()=>{s.content=o},10)}}else{const o=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";if(s=document.querySelector(`meta[name="theme-color"][media*="${o}"]`),s){const c=s.dataset.content,l=s.dataset.contentTemp;s.content=l||"",setTimeout(()=>{s.content=c},10)}}}});{const n=ke.local.get("theme");if(n){document.documentElement.classList.add(`is-${n}`),document.querySelector('meta[name="color-scheme"]').setAttribute("content",n||"dark light");const s=document.querySelector('meta[data-theme-setting="manual"]');s&&(s.name="theme-color",s.content=n==="light"?s.dataset.themeLightColor:s.dataset.themeDarkColor),document.querySelectorAll('meta[data-theme-setting="auto"]').forEach(c=>{c.name=""})}const i=ke.local.get("textSize");i&&document.documentElement.style.setProperty("--text-size",`${i}px`)}fs(x,n=>{var i;for(const[s,o,c,l]of n){if(o.join(".")==="settings.shortcutsViewMode"){const u=document.getElementById("app");u&&(u.dataset.shortcutsViewMode=(i=x.shortcuts)!=null&&i.length?c:"")}o.join(".")==="settings.cloakMode"&&document.body.classList.toggle("cloak",c)}});const gn=new Map;window.__BENCH_RESULTS=new Map;window.__BENCHMARK={start(n){},end(n){}};function hd(){const[n,i]=L(!1),[s,o]=L("loading");__BENCHMARK.start("app-init"),__BENCHMARK.start("time-to-following"),__BENCHMARK.start("time-to-home"),__BENCHMARK.start("time-to-isLoggedIn"),de(),ne(()=>{const l=ke.local.get("instanceURL"),u=decodeURIComponent((window.location.search.match(/code=([^&]+)/)||[,""])[1]);if(u){window.history.replaceState({},document.title,window.location.pathname||"/");const r=ke.sessionCookie.get("clientID"),d=ke.sessionCookie.get("clientSecret"),a=ke.sessionCookie.get("vapidKey"),m=ke.sessionCookie.get("codeVerifier");(async()=>{o("loading");const{access_token:b}=await Dr({instanceURL:l,client_id:r,client_secret:d,code:u,code_verifier:m||void 0});if(b){const g=Ao({instance:l,accessToken:b});await Promise.allSettled([On(g),zn(g,l),xo(g,l,b,a)]),Ai(),window.__IGNORE_GET_ACCOUNT_ERROR__=!0,i(!0),o("default")}else o("error");__BENCHMARK.end("app-init")})()}else{window.__IGNORE_GET_ACCOUNT_ERROR__=!0;const r=decodeURIComponent((window.location.search.match(/account=([^&]+)/)||[,""])[1]);let d;if(r&&(d=Eo(r),d&&(_n(d.info.id),window.history.replaceState({},document.title,window.location.pathname||"/"))),d||(d=si()),d){_n(d.info.id);const{client:a}=le({account:d}),{instance:m}=a;Ai(),o("loading"),(async()=>{try{Ro()&&Lo(m)?(On(a),zn(a,m)):await Promise.allSettled([On(a),zn(a,m)])}catch{}finally{i(!0),o("default"),__BENCHMARK.end("app-init")}})()}else o("default"),__BENCHMARK.end("app-init")}ke.sessionCookie.del("clientID"),ke.sessionCookie.del("clientSecret"),ke.sessionCookie.del("codeVerifier")},[]);let c=Zt();return x.currentLocation=c.pathname,ne(Xn,[c,n]),/\/https?:/.test(c.pathname)?e(wr,{}):s==="loading"?e(Fe,{id:"loader-root"}):e(O,{children:[e(pd,{isLoggedIn:n}),e(md,{isLoggedIn:n}),e(ci,{children:e(Ke,{path:"/:instance?/s/:id",element:e(td,{})})}),n&&e(tc,{}),n&&e(Ya,{}),e(Oa,{}),n&&e(Ba,{}),e(Qo,{isLoggedIn:n}),e(Ha,{onClose:Xn}),e(nc,{})]})}function fd({isLoggedIn:n}){return n&&__BENCHMARK.end("time-to-isLoggedIn"),n?e(br,{}):e(ho,{})}const pd=rt(({isLoggedIn:n})=>{const i=Zt(),s=Ce(()=>{const{pathname:o}=i;return!/^\/(login|welcome)/i.test(o)},[i]);return e(ci,{location:s||i,children:[e(Ke,{path:"/",element:e(fd,{isLoggedIn:n})}),e(Ke,{path:"/login",element:e(Ur,{})}),e(Ke,{path:"/welcome",element:e(ho,{})})]})});function us(){return x.prevLocation||null}function md({isLoggedIn:n}){const i=Zt(),s=q(us());return Ce(()=>sn("/:instance/s/:id",i.pathname)||sn("/s/:id",i.pathname),[i.pathname,sn])?s.current||(s.current=us()):s.current=null,e(ci,{location:s.current||i,children:[n&&e(O,{children:[e(Ke,{path:"/notifications",element:e(so,{})}),e(Ke,{path:"/mentions",element:e(to,{})}),e(Ke,{path:"/following",element:e(_i,{})}),e(Ke,{path:"/b",element:e(Gs,{})}),e(Ke,{path:"/f",element:e(Ks,{})}),e(Ke,{path:"/l",children:[e(Ke,{index:!0,element:e(kr,{})}),e(Ke,{path:":id",element:e(Xs,{})})]}),e(Ke,{path:"/fh",element:e(Nl,{})}),e(Ke,{path:"/sp",element:e(Br,{})}),e(Ke,{path:"/ft",element:e(Ll,{})}),e(Ke,{path:"/catchup",element:e(vl,{})}),e(Ke,{path:"/annual_report/:year",element:e(ul,{})})]}),e(Ke,{path:"/:instance?/t/:hashtag",element:e(Zs,{})}),e(Ke,{path:"/:instance?/a/:id",element:e(al,{})}),e(Ke,{path:"/:instance?/p",children:[e(Ke,{index:!0,element:e(ti,{})}),e(Ke,{path:"l",element:e(ti,{local:!0})})]}),e(Ke,{path:"/:instance?/trending",element:e(ao,{})}),e(Ke,{path:"/:instance?/search",element:e(oo,{})})]})}Mo();$o(e(Po,{i18n:pe,children:e(No,{children:e(hd,{})})}),document.getElementById("app"));setTimeout(()=>{try{Object.keys(localStorage).forEach(n=>{n.startsWith("iconify")&&localStorage.removeItem(n)}),Object.keys(sessionStorage).forEach(n=>{n.startsWith("iconify")&&sessionStorage.removeItem(n)}),localStorage.removeItem("settings:boostsCarousel")}catch{}},5e3);if("serviceWorker"in navigator&&typeof caches<"u"){const i=["icons"];let s=!1;const o=1e4,c=60*60*1e3;async function l(){if(window.__IDLE__)try{const u=await caches.keys();for(const r of u){if(i.includes(r))continue;const d=await caches.open(r),a=await d.keys();if(a.length>50){const m=a.slice(50);for(const b of m)await d.delete(b)}}s=!0}catch{}setTimeout(l,s?c:o)}setTimeout(l,o)}window.__CLOAK__=()=>{document.body.classList.toggle("cloak")};
//# sourceMappingURL=main-C-6qJuv2.js.map
