import{A as Y,y as Q,h as R,s as A,a as se,b as Ge,i as g,x as st,u as Fe,c as e,T as u,k as O,d as we,g as bt,p as Lt,e as ji,f as et,D as Bs,j as qs,L as Hs,l as Ft,m as jt,n as wt,o as be,q as at,r as Ys,t as Le,v as mn,w as ri,_ as vt,z as Vi,B as nl,C as Gi,E as Wi,F as js,G as Vs,H as nt,I as Gs,J as dt,K as Ws,M as Ks,N as Zs,O as Bn,P as $t,Q as We,R as Ki,S as Zi,U as Js,V as Qt,W as Xs,X as Qs,Y as li,Z as di,$ as ec,a0 as ui,a1 as qn,a2 as Ye,a3 as tc,a4 as nc,a5 as ic,a6 as sc}from"./useTitle-OKrMI7HS.js";import{u as Hn,s as le,a as Ue,o as hi,b as cc,I as S,M as Ne,A as rt,N as At,c as it,d as ge,e as je,f as ot,L as de,l as Tt,g as Ji,t as fi,h as Ke,R as Vt,i as Xe,p as Gt,j as ct,k as ze,m as Xi,n as $n,E as Qi,q as Ve,r as pt,v as ac,S as gn,w as pi,T as es,x as lt,y as Yn,z as qe,B as yt,C as oc,D as rc,F as xt,G as jn,H as ts,J as lc,K as dc,O as uc,P as ns,Q as en,U as hc,V as fc,W as is,X as pc,Y as Et,Z as Vn,_ as mc,$ as ss,a0 as gc,a1 as cs,a2 as bc,a3 as vc,a4 as yc,a5 as mi,a6 as wc,a7 as Nt}from"./fuse-xJR8qYiD.js";import"./tinyld-light-PxOyhYWY.js";var as=kc;function kc(t,n,i){var s=null,c=null,a=function(){s&&(clearTimeout(s),c=null,s=null)},p=function(){var o=c;a(),o&&o()},r=function(){if(!n)return t.apply(this,arguments);var o=this,l=arguments,m=i&&!s;if(a(),c=function(){t.apply(o,l)},s=setTimeout(function(){if(s=null,!m){var h=c;return c=null,h()}},n),m)return c()};return r.cancel=a,r.flush=p,r}/*!
 * swiped-events.js - v@version@
 * Pure JavaScript swipe events
 * https://github.com/john-doherty/swiped-events
 * @inspiration https://stackoverflow.com/questions/16348031/disable-scrolling-when-touch-moving-certain-element
 * @author John Doherty <www.johndoherty.info>
 * @license MIT
 */(function(t,n){"use strict";typeof t.CustomEvent!="function"&&(t.CustomEvent=function(d,v){v=v||{bubbles:!1,cancelable:!1,detail:void 0};var b=n.createEvent("CustomEvent");return b.initCustomEvent(d,v.bubbles,v.cancelable,v.detail),b},t.CustomEvent.prototype=t.Event.prototype),n.addEventListener("touchstart",m,!1),n.addEventListener("touchmove",h,!1),n.addEventListener("touchend",l,!1);var i=null,s=null,c=null,a=null,p=null,r=null,o=0;function l(d){if(r===d.target){var v=parseInt(f(r,"data-swipe-threshold","20"),10),b=f(r,"data-swipe-unit","px"),w=parseInt(f(r,"data-swipe-timeout","500"),10),k=Date.now()-p,y="",I=d.changedTouches||d.touches||[];if(b==="vh"&&(v=Math.round(v/100*n.documentElement.clientHeight)),b==="vw"&&(v=Math.round(v/100*n.documentElement.clientWidth)),Math.abs(c)>Math.abs(a)?Math.abs(c)>v&&k<w&&(c>0?y="swiped-left":y="swiped-right"):Math.abs(a)>v&&k<w&&(a>0?y="swiped-up":y="swiped-down"),y!==""){var _={dir:y.replace(/swiped-/,""),touchType:(I[0]||{}).touchType||"direct",fingers:o,xStart:parseInt(i,10),xEnd:parseInt((I[0]||{}).clientX||-1,10),yStart:parseInt(s,10),yEnd:parseInt((I[0]||{}).clientY||-1,10)};r.dispatchEvent(new CustomEvent("swiped",{bubbles:!0,cancelable:!0,detail:_})),r.dispatchEvent(new CustomEvent(y,{bubbles:!0,cancelable:!0,detail:_}))}i=null,s=null,p=null}}function m(d){d.target.getAttribute("data-swipe-ignore")!=="true"&&(r=d.target,p=Date.now(),i=d.touches[0].clientX,s=d.touches[0].clientY,c=0,a=0,o=d.touches.length)}function h(d){if(!(!i||!s)){var v=d.touches[0].clientX,b=d.touches[0].clientY;c=i-v,a=s-b}}function f(d,v,b){for(;d&&d!==n.documentElement;){var w=d.getAttribute(v);if(w)return w;d=d.parentNode}return b}})(window,document);function Bt(t=()=>{},n=[]){const i=Y(t);Q(()=>{i.current=t},[n]),Q(()=>{const s=()=>{const c=document.hidden||document.visibilityState==="hidden";i.current(!c)};return document.addEventListener("visibilitychange",s),()=>document.removeEventListener("visibilitychange",s)},[])}const _c=1e3*3,Sc=2e4,Ic=st(function({isLoggedIn:n}){const[i,s]=R(!0);Bt(s);const c=async(r,o,l)=>{var m;if(A.notificationsLast){const h=r.v1.notifications.list({limit:1,sinceId:A.notificationsLast.id}),{value:f}=await h.next();if(f!=null&&f.length)if(l)A.notificationsShowNew=!0;else{let d;try{const v=await r.v1.markers.fetch({timeline:"notifications"});d=(m=v==null?void 0:v.notifications)==null?void 0:m.lastReadId}catch{}d?A.notificationsShowNew=f[0].id!==d:A.notificationsShowNew=!0}}};Q(()=>{let r,o,l;if(n&&i){const{masto:m,streaming:h,instance:f}=se();(async()=>{await c(m,f);let d=!1;h&&(o=setTimeout(()=>{(async()=>{try{d=!0,r=h.user.notification.subscribe();for await(const v of r){if(!r||!i)break;v.event==="notification"&&Ge(v.payload,f,{skipThreading:!0}),A.notificationsShowNew=!0}}catch{d=!1}d||(l=setInterval(()=>{c(m,f,!0)},Sc))})()},_c))})()}return()=>{var m;(m=r==null?void 0:r.unsubscribe)==null||m.call(r),r=null,clearTimeout(o),clearInterval(l)}},[i,n]);const a=Y(),p=()=>{a.current=Date.now(),fetch("./version.json").then(r=>r.json()).then(r=>{r&&(A.appVersion=r)}).catch(r=>{})};return Hn(p,i&&1e3*60*30),Bt(r=>{r&&(a.current?Date.now()-a.current>1e3*60*60&&p():p())}),Ue("shift+alt+k",()=>{const r=A.settings.cloakMode;A.settings.cloakMode=!r,le({text:r?g._({id:"oguMwa"}):g._({id:"IXZLPs"})})}),null});function Cc(){const t=Fe(A);function n(i){if(t.composerState.minimized){A.composerState.minimized=!1,hi();return}i.shiftKey?cc()||(A.showCompose=!0):(hi(),A.showCompose=!0)}return Ue("c, shift+c",n,{ignoreEventWhen:i=>!!document.querySelector("#modal-container > *")}),e("button",{type:"button",id:"compose-button",onClick:n,class:`${t.composerState.minimized?"min":""} ${t.composerState.publishing?"loading":""} ${t.composerState.publishingError?"error":""}`,children:e(S,{icon:"quill",size:"xl",alt:g._({id:"QOhkyl"})})})}const Tc=st(function(){const n=Fe(A);function i(){A.showKeyboardShortcutsHelp=!1}return Ue("?, shift+?, shift+slash",s=>{A.showKeyboardShortcutsHelp=!0},{ignoreEventWhen:s=>!!document.querySelector("#modal-container > *")}),!!n.showKeyboardShortcutsHelp&&e(Ne,{onClose:i,children:e("div",{id:"keyboard-shortcuts-help-container",class:"sheet",tabindex:"-1",children:[e("button",{type:"button",class:"sheet-close",onClick:i,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(u,{id:"77Emn0"})})}),e("main",{children:e("table",{children:e("tbody",{children:[{action:g._({id:"ulXSNi"}),keys:e("kbd",{children:"?"})},{action:g._({id:"Gy9P9T"}),keys:e("kbd",{children:"j"})},{action:g._({id:"6XYpYY"}),keys:e("kbd",{children:"k"})},{action:g._({id:"DYowFe"}),keys:e(O,{children:[e("kbd",{children:"Shift"})," + ",e("kbd",{children:"j"})]})},{action:g._({id:"S5ez7Y"}),keys:e(O,{children:[e("kbd",{children:"Shift"})," + ",e("kbd",{children:"k"})]})},{action:g._({id:"VkLESX"}),keys:e("kbd",{children:"."})},{action:g._({id:"jsFF8C"}),keys:e(O,{children:[e("kbd",{children:"Enter"})," or ",e("kbd",{children:"o"})]})},{action:e(u,{id:"41gejM",components:{0:e("br",{})}}),keys:e("kbd",{children:"x"})},{action:g._({id:"jAj8rv"}),keys:e(O,{children:[e("kbd",{children:"Esc"})," or ",e("kbd",{children:"Backspace"})]})},{action:g._({id:"duF1lx"}),keys:e(O,{children:[e("kbd",{children:"1"})," to ",e("kbd",{children:"9"})]})},{action:g._({id:"AIa/f7"}),keys:e("kbd",{children:"c"})},{action:g._({id:"snPx8X"}),className:"insignificant",keys:e(O,{children:[e("kbd",{children:"Shift"})," + ",e("kbd",{children:"c"})]})},{action:g._({id:"1pKapz"}),keys:e(O,{children:[e("kbd",{children:"Ctrl"})," + ",e("kbd",{children:"Enter"})," or ",e("kbd",{children:"⌘"})," +"," ",e("kbd",{children:"Enter"})]})},{action:g._({id:"A1taO8"}),keys:e("kbd",{children:"/"})},{action:g._({id:"ImOQa9"}),keys:e("kbd",{children:"r"})},{action:g._({id:"KFs8c6"}),className:"insignificant",keys:e(O,{children:[e("kbd",{children:"Shift"})," + ",e("kbd",{children:"r"})]})},{action:g._({id:"cqi4Mx"}),keys:e(O,{children:[e("kbd",{children:"l"})," or ",e("kbd",{children:"f"})]})},{action:g._({id:"kulphB"}),keys:e(O,{children:[e("kbd",{children:"Shift"})," + ",e("kbd",{children:"b"})]})},{action:g._({id:"PZlHt8"}),keys:e("kbd",{children:"d"})},{action:g._({id:"C7ujRh"}),keys:e(O,{children:[e("kbd",{children:"Shift"})," + ",e("kbd",{children:"Alt"})," + ",e("kbd",{children:"k"})]})}].map(({action:s,className:c,keys:a})=>e("tr",{children:[e("th",{class:c,children:s}),e("td",{children:a})]},s))})})})]})})}),os=new Set,Qe=new WeakMap,qt=new WeakMap,Rt=new WeakMap,Mn=new WeakMap,xc=new WeakMap,Ht=new WeakMap,bn=new WeakMap,Jt=new WeakSet;let St,Gn=0,Wn=0;const mt="__aa_tgt",tn="__aa_del",vn="__aa_new",Ac=t=>{const n=Dc(t);n&&n.forEach(i=>Pc(i))},Ec=t=>{t.forEach(n=>{n.target===St&&Lc(),Qe.has(n.target)&&Mt(n.target)})};function Rc(t){const n=Mn.get(t);n==null||n.disconnect();let i=Qe.get(t),s=0;const c=5;i||(i=Yt(t),Qe.set(t,i));const{offsetWidth:a,offsetHeight:p}=St,o=[i.top-c,a-(i.left+c+i.width),p-(i.top+c+i.height),i.left-c].map(m=>`${-1*Math.floor(m)}px`).join(" "),l=new IntersectionObserver(()=>{++s>1&&Mt(t)},{root:St,threshold:1,rootMargin:o});l.observe(t),Mn.set(t,l)}function Mt(t){clearTimeout(bn.get(t));const n=kn(t),i=nn(n)?500:n.duration;bn.set(t,setTimeout(async()=>{const s=Rt.get(t);try{await(s==null?void 0:s.finished),Qe.set(t,Yt(t)),Rc(t)}catch{}},i))}function Lc(){clearTimeout(bn.get(St)),bn.set(St,setTimeout(()=>{os.forEach(t=>us(t,n=>rs(()=>Mt(n))))},100))}function $c(t){setTimeout(()=>{xc.set(t,setInterval(()=>rs(Mt.bind(null,t)),2e3))},Math.round(2e3*Math.random()))}function rs(t){typeof requestIdleCallback=="function"?requestIdleCallback(()=>t()):requestAnimationFrame(()=>t())}let Dn,Ut;const Mc=typeof window<"u"&&"ResizeObserver"in window;Mc&&(St=document.documentElement,Dn=new MutationObserver(Ac),Ut=new ResizeObserver(Ec),window.addEventListener("scroll",()=>{Wn=window.scrollY,Gn=window.scrollX}),Ut.observe(St));function Dc(t){return t.reduce((s,c)=>[...s,...Array.from(c.addedNodes),...Array.from(c.removedNodes)],[]).every(s=>s.nodeName==="#comment")?!1:t.reduce((s,c)=>{if(s===!1)return!1;if(c.target instanceof Element){if(In(c.target),!s.has(c.target)){s.add(c.target);for(let a=0;a<c.target.children.length;a++){const p=c.target.children.item(a);if(p){if(tn in p)return!1;In(c.target,p),s.add(p)}}}if(c.removedNodes.length)for(let a=0;a<c.removedNodes.length;a++){const p=c.removedNodes[a];if(tn in p)return!1;p instanceof Element&&(s.add(p),In(c.target,p),qt.set(p,[c.previousSibling,c.nextSibling]))}}return s},new Set)}function In(t,n){!n&&!(mt in t)?Object.defineProperty(t,mt,{value:t}):n&&!(mt in n)&&Object.defineProperty(n,mt,{value:t})}function Pc(t){var n;const i=t.isConnected,s=Qe.has(t);i&&qt.has(t)&&qt.delete(t),Rt.has(t)&&((n=Rt.get(t))===null||n===void 0||n.cancel()),vn in t?gi(t):s&&i?Oc(t):s&&!i?zc(t):gi(t)}function ut(t){return Number(t.replace(/[^0-9.\-]/g,""))}function Nc(t){let n=t.parentElement;for(;n;){if(n.scrollLeft||n.scrollTop)return{x:n.scrollLeft,y:n.scrollTop};n=n.parentElement}return{x:0,y:0}}function Yt(t){const n=t.getBoundingClientRect(),{x:i,y:s}=Nc(t);return{top:n.top+s,left:n.left+i,width:n.width,height:n.height}}function ls(t,n,i){let s=n.width,c=n.height,a=i.width,p=i.height;const r=getComputedStyle(t);if(r.getPropertyValue("box-sizing")==="content-box"){const l=ut(r.paddingTop)+ut(r.paddingBottom)+ut(r.borderTopWidth)+ut(r.borderBottomWidth),m=ut(r.paddingLeft)+ut(r.paddingRight)+ut(r.borderRightWidth)+ut(r.borderLeftWidth);s-=m,a-=m,c-=l,p-=l}return[s,a,c,p].map(Math.round)}function kn(t){return mt in t&&Ht.has(t[mt])?Ht.get(t[mt]):{duration:250,easing:"ease-in-out"}}function ds(t){if(mt in t)return t[mt]}function Kn(t){const n=ds(t);return n?Jt.has(n):!1}function us(t,...n){n.forEach(i=>i(t,Ht.has(t)));for(let i=0;i<t.children.length;i++){const s=t.children.item(i);s&&n.forEach(c=>c(s,Ht.has(s)))}}function Zn(t){return Array.isArray(t)?t:[t]}function nn(t){return typeof t=="function"}function Oc(t){const n=Qe.get(t),i=Yt(t);if(!Kn(t))return Qe.set(t,i);let s;if(!n)return;const c=kn(t);if(typeof c!="function"){const a=n.left-i.left,p=n.top-i.top,[r,o,l,m]=ls(t,n,i),h={transform:`translate(${a}px, ${p}px)`},f={transform:"translate(0, 0)"};r!==o&&(h.width=`${r}px`,f.width=`${o}px`),l!==m&&(h.height=`${l}px`,f.height=`${m}px`),s=t.animate([h,f],{duration:c.duration,easing:c.easing})}else{const[a]=Zn(c(t,"remain",n,i));s=new Animation(a),s.play()}Rt.set(t,s),Qe.set(t,i),s.addEventListener("finish",Mt.bind(null,t))}function gi(t){vn in t&&delete t[vn];const n=Yt(t);Qe.set(t,n);const i=kn(t);if(!Kn(t))return;let s;if(typeof i!="function")s=t.animate([{transform:"scale(.98)",opacity:0},{transform:"scale(0.98)",opacity:0,offset:.5},{transform:"scale(1)",opacity:1}],{duration:i.duration*1.5,easing:"ease-in"});else{const[c]=Zn(i(t,"add",n));s=new Animation(c),s.play()}Rt.set(t,s),s.addEventListener("finish",Mt.bind(null,t))}function bi(t,n){var i;t.remove(),Qe.delete(t),qt.delete(t),Rt.delete(t),(i=Mn.get(t))===null||i===void 0||i.disconnect(),setTimeout(()=>{if(tn in t&&delete t[tn],Object.defineProperty(t,vn,{value:!0,configurable:!0}),n&&t instanceof HTMLElement)for(const s in n)t.style[s]=""},0)}function zc(t){var n;if(!qt.has(t)||!Qe.has(t))return;const[i,s]=qt.get(t);Object.defineProperty(t,tn,{value:!0,configurable:!0});const c=window.scrollX,a=window.scrollY;if(s&&s.parentNode&&s.parentNode instanceof Element?s.parentNode.insertBefore(t,s):i&&i.parentNode?i.parentNode.appendChild(t):(n=ds(t))===null||n===void 0||n.appendChild(t),!Kn(t))return bi(t);const[p,r,o,l]=Fc(t),m=kn(t),h=Qe.get(t);(c!==Gn||a!==Wn)&&Uc(t,c,a,m);let f,d={position:"absolute",top:`${p}px`,left:`${r}px`,width:`${o}px`,height:`${l}px`,margin:"0",pointerEvents:"none",transformOrigin:"center",zIndex:"100"};if(!nn(m))Object.assign(t.style,d),f=t.animate([{transform:"scale(1)",opacity:1},{transform:"scale(.98)",opacity:0}],{duration:m.duration,easing:"ease-out"});else{const[v,b]=Zn(m(t,"remove",h));(b==null?void 0:b.styleReset)!==!1&&(d=(b==null?void 0:b.styleReset)||d,Object.assign(t.style,d)),f=new Animation(v),f.play()}Rt.set(t,f),f.addEventListener("finish",bi.bind(null,t,d))}function Uc(t,n,i,s){const c=Gn-n,a=Wn-i,p=document.documentElement.style.scrollBehavior;if(getComputedStyle(St).scrollBehavior==="smooth"&&(document.documentElement.style.scrollBehavior="auto"),window.scrollTo(window.scrollX+c,window.scrollY+a),!t.parentElement)return;const o=t.parentElement;let l=o.clientHeight,m=o.clientWidth;const h=performance.now();function f(){requestAnimationFrame(()=>{if(!nn(s)){const d=l-o.clientHeight,v=m-o.clientWidth;h+s.duration>performance.now()?(window.scrollTo({left:window.scrollX-v,top:window.scrollY-d}),l=o.clientHeight,m=o.clientWidth,f()):document.documentElement.style.scrollBehavior=p}})}f()}function Fc(t){const n=Qe.get(t),[i,,s]=ls(t,n,Yt(t));let c=t.parentElement;for(;c&&(getComputedStyle(c).position==="static"||c instanceof HTMLBodyElement);)c=c.parentElement;c||(c=document.body);const a=getComputedStyle(c),p=Qe.get(c)||Yt(c),r=Math.round(n.top-p.top)-ut(a.borderTopWidth),o=Math.round(n.left-p.left)-ut(a.borderLeftWidth);return[r,o,i,s]}function hs(t,n={}){return Dn&&Ut&&(window.matchMedia("(prefers-reduced-motion: reduce)").matches&&!nn(n)&&!n.disrespectUserMotionPreference||(Jt.add(t),getComputedStyle(t).position==="static"&&Object.assign(t.style,{position:"relative"}),us(t,Mt,$c,c=>Ut==null?void 0:Ut.observe(c)),nn(n)?Ht.set(t,n):Ht.set(t,{duration:250,easing:"ease-in-out",...n}),Dn.observe(t,{childList:!0}),os.add(t))),Object.freeze({parent:t,enable:()=>{Jt.add(t)},disable:()=>{Jt.delete(t)},isEnabled:()=>Jt.has(t)})}function Jn(t){const n=Y(null),[i,s]=R(),c=a=>{i&&(a?i.enable():i.disable())};return Q(()=>{n.current instanceof HTMLElement&&s(hs(n.current,t||{}))},[]),[n,c]}function Bc({onClose:t}){const{masto:n}=se(),i=we.local.getJSON("accounts"),s=bt(),c=i.length>1,[a,p]=Lt(o=>o+1,0),[r]=Jn();return e("div",{id:"accounts-container",class:"sheet",tabIndex:"-1",children:[!!t&&e("button",{type:"button",class:"sheet-close",onClick:t,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{class:"header-grid",children:e("h2",{children:e(u,{id:"bPwFdf"})})}),e("main",{children:e("section",{children:[e("ul",{class:"accounts-list",ref:r,children:i.map((o,l)=>{const m=o.info.id===s,h=l===0;return e("li",{children:[e("div",{children:[c&&e("span",{class:`current ${m?"is-current":""}`,children:e(S,{icon:"check-circle",alt:g._({id:"Hp1l6f"})})}),e(rt,{url:o.info.avatarStatic,size:"xxl",onDblClick:async()=>{if(m)try{const f=await n.v1.accounts.$select(o.info.id).fetch();o.info=f,we.local.setJSON("accounts",i),p()}catch{}}}),e(At,{account:c?{...o.info,acct:/@/.test(o.info.acct)?o.info.acct:`${o.info.acct}@${o.instanceURL}`}:o.info,showAcct:!0,onClick:()=>{m?A.showAccount=`${o.info.username}@${o.instanceURL}`:(ji(o.info.id),location.reload())}})]}),e("div",{class:"actions",children:[h&&c&&e(O,{children:[e("span",{class:"tag",children:e(u,{id:"ovBPCi"})})," "]}),e(it,{align:"end",menuButton:e("button",{type:"button",class:"plain more-button",children:e(S,{icon:"more",size:"l",alt:g._({id:"2FYpfJ"})})}),children:[e(ge,{onClick:()=>{A.showAccount=`${o.info.username}@${o.instanceURL}`},children:[e(S,{icon:"user"}),e("span",{children:e(u,{id:"40z2Fm"})})]}),e(je,{}),c&&e(ge,{disabled:h,onClick:()=>{i.splice(l,1),i.unshift(o),we.local.setJSON("accounts",i),p()},children:[e(S,{icon:"check-circle"}),e("span",{children:e(u,{id:"PPcets"})})]}),e(ot,{subMenu:!0,confirmLabel:e(O,{children:[e(S,{icon:"exit"}),e("span",{children:e(u,{id:"Li7UOV",values:{0:o.info.acct}})})]}),disabled:!m,menuItemClassName:"danger",onClick:()=>{i.splice(l,1),we.local.setJSON("accounts",i),location.href=location.pathname||"/"},children:[e(S,{icon:"exit"}),e("span",{children:e(u,{id:"CXk1bI"})})]})]})]})]},o.info.id)})}),e("p",{children:e(de,{to:"/login",class:"button plain2",onClick:t,children:[e(S,{icon:"plus"})," ",e("span",{children:e(u,{id:"Is7/PB"})})]})}),c&&e("p",{children:e("small",{children:e(u,{id:"52x24e",components:{0:e("i",{})}})})})]})})]})}const Xn="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20fill-rule='evenodd'%20stroke-linejoin='round'%20stroke-miterlimit='2'%20clip-rule='evenodd'%20viewBox='0%200%2064%2064'%3e%3cpath%20fill='none'%20d='M0%200h63.994v63.994H0z'/%3e%3cpath%20fill='%23a4bff7'%20d='M37.774%2011.471c14.639%203.752%2019.034%2016.557%2015.889%2031.304-.696%203.261-2.563%206.661-6.356%208.693-3.204%201.717-8.07%202.537-15.338.55l-9.634-2.404C11.651%2046.992%208.378%2038.733%2010.027%2031.823c3.627-15.201%2015.543-23.48%2027.747-20.352Z'/%3e%3cpath%20fill='%23d8e7fe'%20d='M36.76%2015.429c12.289%203.15%2015.547%2014.114%2012.907%2026.493-.947%204.44-4.937%209.365-16.664%206.143l-9.684-2.417c-7.854-1.923-10.53-7.8-9.318-12.877%203.016-12.639%2012.611-19.943%2022.759-17.342Z'/%3e%3cpath%20fill='%236081e6'%20d='M27.471%2024.991c-1.457-.698-7.229%203.213-7.663%208.926-.182%202.39%204.55%203.237%205.071-.169.725-4.743%203.715-8.218%202.592-8.757Zm10.746%202.005c-2.083.327-.382%205.901-.595%2010.727-.123%202.8%204.388%203.464%204.703%202.011%201.098-5.073-2.066-13.058-4.108-12.738Z'/%3e%3c/svg%3e";function Qn(){const{i18n:t}=et();return e("label",{class:"lang-selector",children:["🌐"," ",e("select",{value:t.locale||Bs,onChange:n=>{localStorage.setItem("lang",n.target.value),qs(n.target.value)},children:Hs.map(n=>{if(n==="pseudo-LOCALE")return e(O,{children:[e("hr",{}),e("option",{value:n,children:"Pseudolocalization (test)"},n)]});const i=Tt(n),s=Tt({code:n,locale:n});return e("option",{value:n,children:i===s?i:`${i} (${s})`},n)})})]})}function vi(t){const{masto:n}=se();return n.v1.push.subscription.create(t)}function qc(){const{masto:t}=se();return t.v1.push.subscription.fetch()}function Hc(t){const{masto:n}=se();return n.v1.push.subscription.update(t)}function Yc(){const{masto:t}=se();return t.v1.push.subscription.remove()}function _n(){return"serviceWorker"in navigator&&"PushManager"in window}function jc(){return navigator.serviceWorker.getRegistration()}async function ei(){const t=await jc(),n=t?await t.pushManager.getSubscription():void 0;return{registration:t,subscription:n}}function fs(t){const n="=".repeat((4-t.length%4)%4),i=`${t}${n}`.replace(/-/g,"+").replace(/_/g,"/"),s=window.atob(i),c=new Uint8Array(s.length);for(let a=0;a<s.length;++a)c[a]=s.charCodeAt(a);return c}async function Vc(){if(!_n())return;const{subscription:t}=await ei();let n=null;try{n=await qc()}catch(i){if(!/(not found|unknown)/i.test(i.message))throw i}if(n&&t){const i=n.endpoint===t.endpoint,{vapidKey:s}=Ft(),c=n.serverKey===s;if(!i)throw new Error("Backend subscription endpoint changed");if(!c)throw new Error("Backend subscription key and vapid key changed")}if(t&&!n){const{vapidKey:i}=Ft();if(i){const{applicationServerKey:s}=t.options,c=fs(i).toString(),a=new Uint8Array(s).toString();if(!(c===a))throw await t.unsubscribe(),new Error("Subscription key and vapid key changed")}}return{subscription:t,backendSubscription:n}}async function yi({data:t,policy:n}){if(!_n())return;let{registration:i,subscription:s}=await ei(),c=null;if(s)try{c=await Hc({data:t,policy:n})}catch{c=await vi({subscription:s,data:t,policy:n})}else{const{vapidKey:a}=Ft();if(!a)throw new Error("No server key found");s=await i.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:fs(a)}),c=await vi({subscription:s,data:t,policy:n})}return{subscription:s,backendSubscription:c}}async function wi(){if(!_n())return;const{subscription:t}=await ei();t&&(await Yc(),await t.unsubscribe())}var Gc={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Blaede Phanpy",PHANPY_DEFAULT_INSTANCE:"mastodon.blaede.family",PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:"https://mastodon.blaede.family/auth/sign_up",PHANPY_GIPHY_API_KEY:"48JGsrSS1XE5w4nWe9c9hqxPbsfRWR0e",PHANPY_LINGVA_INSTANCES:"lingva.phanpy.social lingva.lunar.icu lingva.garudalinux.org translate.plausibility.cloud",PHANPY_PRIVACY_POLICY_URL:"https://mastodon.blaede.family/privacy-policy",PHANPY_WEBSITE:"https://phanpy.blaede.family",PROD:!0,SSR:!1,VITE_APP_ENV:"production"};const ki=16,Ct=[14,15,16,17,18,19,20],{PHANPY_WEBSITE:_i,PHANPY_PRIVACY_POLICY_URL:Wc,PHANPY_IMG_ALT_API_URL:Kc,PHANPY_GIPHY_API_KEY:Zc}=Gc;function Jc({onClose:t}){const n=Fe(A),i=we.local.get("theme")||"auto",s=Y(),c=n.settings.contentTranslationTargetLanguage||null,a=Ji(),p=Tt(a),r=we.local.get("textSize")||ki,[o,l]=R(we.account.get("preferences")||{}),{masto:m,authenticated:h,instance:f}=se();return e("div",{id:"settings-container",class:"sheet",tabIndex:"-1",children:[!!t&&e("button",{type:"button",class:"sheet-close",onClick:t,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(u,{id:"Tz0i8g"})})}),e("main",{children:[e("section",{children:e("ul",{children:[e("li",{children:[e("div",{children:e("label",{children:e(u,{id:"aAIQg2"})})}),e("div",{children:e("form",{ref:s,onInput:d=>{d.preventDefault();const b=new FormData(s.current).get("theme"),w=document.documentElement;if(b==="auto"){w.classList.remove("is-light","is-dark");const k=document.querySelector('meta[data-theme-setting="manual"]');k&&(k.name=""),document.querySelectorAll('meta[data-theme-setting="auto"]').forEach(I=>{I.name="theme-color"})}else{w.classList.toggle("is-light",b==="light"),w.classList.toggle("is-dark",b==="dark");const k=document.querySelector('meta[data-theme-setting="manual"]');k&&(k.name="theme-color",k.content=b==="light"?k.dataset.themeLightColor:k.dataset.themeDarkColor),document.querySelectorAll('meta[data-theme-setting="auto"]').forEach(I=>{I.name=""})}document.querySelector('meta[name="color-scheme"]').setAttribute("content",b==="auto"?"dark light":b),b==="auto"?we.local.del("theme"):we.local.set("theme",b)},children:e("div",{class:"radio-group",children:[e("label",{children:[e("input",{type:"radio",name:"theme",value:"light",defaultChecked:i==="light"}),e("span",{children:e(u,{id:"1njn7W"})})]}),e("label",{children:[e("input",{type:"radio",name:"theme",value:"dark",defaultChecked:i==="dark"}),e("span",{children:e(u,{id:"pvnfJD"})})]}),e("label",{children:[e("input",{type:"radio",name:"theme",value:"auto",defaultChecked:i!=="light"&&i!=="dark"}),e("span",{children:e(u,{id:"R9Khdg"})})]})]})})})]}),e("li",{children:[e("div",{children:e("label",{children:e(u,{id:"7r6sCa"})})}),e("div",{class:"range-group",children:[e("span",{style:{fontSize:Ct[0]},children:e(u,{id:"J6ypuD"})})," ",e("input",{type:"range",min:Ct[0],max:Ct[Ct.length-1],step:"1",value:r,list:"sizes",onChange:d=>{const v=parseInt(d.target.value,10);document.documentElement.style.setProperty("--text-size",`${v}px`),v===ki?we.local.del("textSize"):we.local.set("textSize",d.target.value)}})," ",e("span",{style:{fontSize:Ct[Ct.length-1]},children:e(u,{id:"J6ypuD"})}),e("datalist",{id:"sizes",children:Ct.map(d=>e("option",{value:d}))})]})]}),e("li",{children:[e("label",{children:e(u,{id:"CeJHfb"})}),e(Qn,{})]})]})}),h&&e(O,{children:[e("h3",{children:e(u,{id:"PcoS3v"})}),e("section",{children:e("ul",{children:e("li",{children:[e("div",{children:e("label",{for:"posting-privacy-field",children:[e(u,{id:"NAjVvt"})," ",e(S,{icon:"cloud",alt:g._({id:"N2FcBE"}),class:"synced-icon"})]})}),e("div",{children:e("select",{id:"posting-privacy-field",value:o["posting:default:visibility"]||"public",onChange:d=>{const{value:v}=d.target;(async()=>{try{await m.v1.accounts.updateCredentials({source:{privacy:v}}),l({...o,"posting:default:visibility":v}),we.account.set("preferences",{...o,"posting:default:visibility":v})}catch{alert(g._({id:"Oa+KBY"}))}})()},children:[e("option",{value:"public",children:e(u,{id:"7d1a0d"})}),e("option",{value:"unlisted",children:e(u,{id:"WDcQq9"})}),e("option",{value:"private",children:e(u,{id:"o34OrG"})})]})})]})})}),e("p",{class:"section-postnote",children:[e(S,{icon:"cloud",alt:g._({id:"N2FcBE"}),class:"synced-icon"})," ",e("small",{children:e(u,{id:"xlsg7n",values:{instance:f},components:{0:e("a",{href:`https://${f}/`,target:"_blank",rel:"noopener noreferrer"})}})})]})]}),e("h3",{children:e(u,{id:"ivdhsq"})}),e("section",{children:e("ul",{children:[e("li",{children:e("label",{children:[e("input",{type:"checkbox",checked:n.settings.autoRefresh,onChange:d=>{A.settings.autoRefresh=d.target.checked}})," ",e(u,{id:"0mC0SF"})]})}),e("li",{children:e("label",{children:[e("input",{type:"checkbox",checked:n.settings.boostsCarousel,onChange:d=>{A.settings.boostsCarousel=d.target.checked}})," ",e(u,{id:"TSbnoW"})]})}),e("li",{children:[e("label",{children:[e("input",{type:"checkbox",checked:n.settings.contentTranslation,onChange:d=>{const{checked:v}=d.target;A.settings.contentTranslation=v,v||(A.settings.contentTranslationTargetLanguage=null)}})," ",e(u,{id:"0SdaOt"})]}),e("div",{class:`sub-section ${n.settings.contentTranslation?"":"more-insignificant"}`,children:[e("div",{children:e("label",{children:[e(u,{id:"rJ8YHs"}),e("select",{value:c||"",disabled:!n.settings.contentTranslation,onChange:d=>{A.settings.contentTranslationTargetLanguage=d.target.value||null},children:[e("option",{value:"",children:e(u,{id:"jNCSyx",values:{systemTargetLanguageText:p}})}),e("option",{disabled:!0,children:"──────────"}),fi.map(d=>{const v=Tt({code:d.code,fallback:d.name}),b=Tt({code:d.code,locale:d.code}),w=!b||v===b;return e("option",{value:d.code,children:w?v:`${v} (${b})`})})]})]})}),e("hr",{}),e("div",{class:"checkbox-fieldset",children:[e(u,{id:"cc0NrU",values:{0:n.settings.contentTranslationHideLanguages.length}}),e("div",{class:"checkbox-fields",children:fi.map(d=>{const v=Tt({code:d.code,fallback:d.name}),b=Tt({code:d.code,locale:d.code}),w=!b||v===b;return e("label",{children:[e("input",{type:"checkbox",checked:n.settings.contentTranslationHideLanguages.includes(d.code),onChange:k=>{const{checked:y}=k.target;y?A.settings.contentTranslationHideLanguages.push(d.code):A.settings.contentTranslationHideLanguages=n.settings.contentTranslationHideLanguages.filter(I=>I!==d.code)}})," ",w?v:`${v} (${b})`]})})})]}),e("p",{class:"insignificant",children:e("small",{children:e(u,{id:"xpF+wU",components:{0:e("a",{href:"https://github.com/cheeaun/lingva-api",target:"_blank",rel:"noopener noreferrer"}),1:e("a",{href:"https://github.com/thedaviddelta/lingva-translate",target:"_blank",rel:"noopener noreferrer"})}})})}),e("hr",{}),e("div",{children:[e("label",{children:[e("input",{type:"checkbox",checked:n.settings.contentTranslationAutoInline,disabled:!n.settings.contentTranslation,onChange:d=>{A.settings.contentTranslationAutoInline=d.target.checked}})," ",e(u,{id:"gURvmk"})]}),e("p",{class:"insignificant",children:e("small",{children:e(u,{id:"PbHARL",components:{0:e("b",{})}})})})]})]})]}),!!Zc&&h&&e("li",{children:[e("label",{children:[e("input",{type:"checkbox",checked:n.settings.composerGIFPicker,onChange:d=>{A.settings.composerGIFPicker=d.target.checked}})," ",e(u,{id:"D7/2jB"})]}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(u,{id:"/CLBTL",components:{0:e("a",{href:"https://developers.giphy.com/",target:"_blank",rel:"noopener noreferrer"})}})})})]}),!!Kc&&h&&e("li",{children:[e("label",{children:[e("input",{type:"checkbox",checked:n.settings.mediaAltGenerator,onChange:d=>{A.settings.mediaAltGenerator=d.target.checked}})," ",e(u,{id:"9q5uor"})," ",e(S,{icon:"sparkles2",class:"more-insignificant"})]}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(u,{id:"faZ9RI"})})}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(u,{id:"fHZgvt",components:{0:e("a",{href:"https://github.com/cheeaun/img-alt-api",target:"_blank",rel:"noopener noreferrer"})}})})})]}),h&&Ke("@mastodon/grouped-notifications")&&e("li",{children:[e("label",{children:[e("input",{type:"checkbox",checked:n.settings.groupedNotificationsAlpha,onChange:d=>{A.settings.groupedNotificationsAlpha=d.target.checked}})," ",e(u,{id:"aGziA/"})]}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(u,{id:"X17jCM"})})})]}),h&&e("li",{children:[e("label",{children:[e("input",{type:"checkbox",checked:n.settings.shortcutSettingsCloudImportExport,onChange:d=>{A.settings.shortcutSettingsCloudImportExport=d.target.checked}})," ",e(u,{id:"570qTm"})," ",e(S,{icon:"cloud",class:"more-insignificant"})]}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(u,{id:"0tZAhT",components:{0:e("br",{})}})})}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(u,{id:"fHf1v/"})})})]}),e("li",{children:[e("label",{children:[e("input",{type:"checkbox",checked:n.settings.cloakMode,onChange:d=>{A.settings.cloakMode=d.target.checked}})," ",e(u,{id:"lxYe+I",components:{0:e("span",{class:"insignificant"}),1:e("samp",{}),2:e("samp",{})}})]}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(u,{id:"T/hglb"})})})]}),h&&e("li",{children:e("button",{type:"button",class:"light",onClick:()=>{A.showDrafts=!0,A.showSettings=!1},children:e(u,{id:"krk5ws"})})})]})}),h&&e(Xc,{onClose:t}),e("h3",{children:e(u,{id:"uyJsf6"})}),e("section",{children:[e("div",{style:{display:"flex",flexWrap:"wrap",gap:8,lineHeight:1.25,alignItems:"center",marginTop:8},children:[e("img",{src:Xn,alt:"",width:"64",height:"64",style:{aspectRatio:"1/1",verticalAlign:"middle",background:"#b7cdf9",borderRadius:12}}),e("div",{children:[e("b",{children:"Phanpy"})," ",e("a",{href:"https://hachyderm.io/@phanpy",rel:"noopener noreferrer",onClick:d=>{d.preventDefault(),A.showAccount="phanpy@hachyderm.io"},children:"@phanpy"}),e("br",{}),e(u,{id:"AZ2EoP",components:{0:e("a",{href:"https://github.com/cheeaun/phanpy",target:"_blank",rel:"noopener noreferrer"}),1:e("a",{href:"https://mastodon.social/@cheeaun",rel:"noopener noreferrer",onClick:d=>{d.preventDefault(),A.showAccount="cheeaun@mastodon.social"}})}})]})]}),e("p",{children:[e("a",{href:"https://github.com/sponsors/cheeaun",target:"_blank",rel:"noopener noreferrer",children:e(u,{id:"O4cLCR"})})," ","·"," ",e("a",{href:"https://www.buymeacoffee.com/cheeaun",target:"_blank",rel:"noopener noreferrer",children:e(u,{id:"Ng063n"})})," ","·"," ",e("a",{href:Wc,target:"_blank",rel:"noopener noreferrer",children:e(u,{id:"LcET2C"})})]}),e("p",{children:[_i&&e(O,{children:[e(u,{id:"pFnMHn",values:{0:_i.replace(/https?:\/\//g,"").replace(/\/$/,"")},components:{0:e("span",{class:"insignificant"})}}),e("br",{})]}),e(u,{id:"6KkH+2",values:{0:e("span",{class:"ib insignificant",children:["(",e("a",{href:"https://github.com/cheeaun/phanpy/commit/bff9a84",target:"_blank",rel:"noopener noreferrer",children:e(Vt,{datetime:new Date("2024-08-13T20:03:18.539Z")})}),")"]})},components:{0:e("span",{class:"insignificant"}),1:e("input",{type:"text",class:"version-string",readOnly:!0,size:"18",value:`${"2024-08-13T20:03:18.539Z".slice(0,10).replace(/-/g,".")}.bff9a84`,onClick:d=>{d.target.select();try{navigator.clipboard.writeText(d.target.value),le(g._({id:"PiPfua"}))}catch{le(g._({id:"gdxreD"}))}}})}})]})]})]})]})}function Xc({onClose:t}){if(!_n())return null;const{instance:n}=se(),[i,s]=R("default"),c=Y(),[a,p]=R(!1),[r,o]=R(!1),l=Y();Q(()=>{(async()=>{s("loading");try{const{subscription:h,backendSubscription:f}=await Vc();if(f!=null&&f.policy&&f.policy!=="none"){p(!0);const{alerts:d,policy:v}=f;l.current=v;const{elements:b}=c.current,w=b.namedItem("policy");w&&(w.value=v),Object.keys(d).forEach(k=>{const y=b.namedItem(k);(y==null?void 0:y.type)==="checkbox"&&(y.checked=!0)})}s("default")}catch(h){/outside.*authorized/i.test(h.message)?o(!0):alert((h==null?void 0:h.message)||h),s("error")}})()},[]);const m=i==="loading";return e("form",{ref:c,onChange:()=>{setTimeout(()=>{const h=Object.fromEntries(new FormData(c.current)),f=!!h["policy-allow"],d={data:{policy:h.policy,alerts:{mention:!!h.mention,favourite:!!h.favourite,reblog:!!h.reblog,follow:!!h.follow,follow_request:!!h.followRequest,poll:!!h.poll,update:!!h.update,status:!!h.status}}};let v=0;Object.keys(d.data.alerts).forEach(w=>{d.data.alerts[w]?v++:delete d.data.alerts[w]});const b=l.current!==d.data.policy;f&&v>0?b?wi().then(()=>{yi(d)}).catch(w=>{alert(g._({id:"I6pdY3"}))}):yi(d).catch(w=>{alert(g._({id:"I6pdY3"}))}):wi().catch(w=>{alert(g._({id:"q1zFd+"}))})},100)},children:[e("h3",{children:e(u,{id:"WUHLnz"})}),e("section",{children:e("ul",{children:e("li",{children:[e("label",{children:[e("input",{type:"checkbox",disabled:m||r,name:"policy-allow",checked:a,onChange:async h=>{const{checked:f}=h.target;if(f){const d=await Notification.requestPermission();d==="granted"?p(!0):(p(!1),d==="denied"&&alert(g._({id:"6LUsk7"})))}else p(!1)}})," ",e(u,{id:"qYNCa1",values:{0:[{value:"all",label:g._({id:"+niKJH"})},{value:"followed",label:g._({id:"x2NYtp"})},{value:"follower",label:g._({id:"PBFNgg"})}].map(h=>e("option",{value:h.value,children:h.label}))},components:{0:e("select",{name:"policy",disabled:m||r||!a})}})]}),e("div",{class:"shazam-container no-animation",style:{width:"100%"},hidden:!a,children:e("div",{class:"shazam-container-inner",children:e("div",{class:"sub-section",children:e("ul",{children:[{value:"mention",label:g._({id:"/bZzdR"})},{value:"favourite",label:g._({id:"zZOZj7"})},{value:"reblog",label:g._({id:"puY2t0"})},{value:"follow",label:g._({id:"aaJhcT"})},{value:"followRequest",label:g._({id:"6Fs1Ba"})},{value:"poll",label:g._({id:"wNExRS"})},{value:"update",label:g._({id:"K/EtE6"})},{value:"status",label:g._({id:"2yr1/p"})}].map(h=>e("li",{children:e("label",{children:[e("input",{type:"checkbox",name:h.value})," ",h.label]})}))})})})}),r&&e("div",{class:"sub-section",children:e("p",{children:e(u,{id:"8d0b8B",components:{0:e(de,{to:`/login?instance=${n}`,onClick:t}),1:e("b",{})}})})})]})})}),e("p",{class:"section-postnote",children:e("small",{children:e(u,{id:"z96cOX",components:{0:e("b",{})}})})})]})}const Pn=()=>{let t=setTimeout(()=>{if(!document.getElementById("columns")){const i=document.querySelectorAll("#modal-container > *");if(i!=null&&i.length){const p=i[i.length-1],r=p.querySelector('[tabindex="-1"]')||p;if(r){r.focus();return}}if(document.querySelector(".deck-backdrop"))return;const c=document.querySelectorAll(".deck-container"),a=c[c.length-1];a&&a.tabIndex===-1&&a.focus()}},100);return()=>clearTimeout(t)};function ps(t){if(!t)return;const n=jt(),i=Y(n.pathname);Q(()=>{i.current&&n.pathname!==i.current&&(t==null||t())},[n.pathname,t])}const ms=1e3*60,Qc=24*60*60*1e3,Nn=wt(async()=>{const{masto:t}=se(),n=await t.v1.lists.list();return n.sort((i,s)=>i.title.localeCompare(s.title)),n.length&&setTimeout(()=>{we.account.set("lists",{lists:n,updatedAt:Date.now()})},1),n},{maxAge:ms});async function sn(){try{const{lists:t,updatedAt:n}=we.account.get("lists")||{};return t!=null&&t.length?(Date.now()-n>Qc&&Nn(),t):await Nn()}catch{return[]}}const ea=wt(t=>{const{masto:n}=se();return n.v1.lists.$select(t).fetch()},{maxAge:ms});async function gs(t){const{lists:n}=we.account.get("lists")||{};if(n!=null&&n.length){const i=n.find(s=>s.id===t);if(i)return i}try{return ea(t)}catch{return null}}async function ta(t){const n=await gs(t);return(n==null?void 0:n.title)||""}function na(t){const{lists:n}=we.account.get("lists")||{};n!=null&&n.length&&(n.push(t),n.sort((i,s)=>i.title.localeCompare(s.title)),we.account.set("lists",{lists:n,updatedAt:Date.now()}))}function ia(t){const{lists:n}=we.account.get("lists")||{};if(n!=null&&n.length){const i=n.findIndex(s=>s.id===t.id);i!==-1&&(n[i]=t,n.sort((s,c)=>s.title.localeCompare(c.title)),we.account.set("lists",{lists:n,updatedAt:Date.now()}))}}function sa(t){const{lists:n}=we.account.get("lists")||{};if(n!=null&&n.length){const i=n.findIndex(s=>s.id===t);i!==-1&&(n.splice(i,1),we.account.set("lists",{lists:n,updatedAt:Date.now()}))}}function ti({list:t,onClose:n}){const{masto:i}=se(),[s,c]=R("default"),a=!!t,p=Y(),r=Y(),o=Y();Q(()=>{a&&(p.current.value=t.title,r.current.value=t.repliesPolicy,o.current&&(o.current.checked=t.exclusive))},[a]);const l=Ke("@mastodon/list-exclusive");return e("div",{class:"sheet",children:[!!n&&e("button",{type:"button",class:"sheet-close",onClick:n,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})})," ",e("header",{children:e("h2",{children:a?g._({id:"tuhghE"}):g._({id:"Sb2gYF"})})}),e("main",{children:e("form",{class:"list-form",onSubmit:m=>{m.preventDefault();const h=new FormData(m.target),f=h.get("title"),d=h.get("replies_policy"),v=h.get("exclusive")==="on";c("loading"),(async()=>{try{let b;a?b=await i.v1.lists.$select(t.id).update({title:f,replies_policy:d,exclusive:v}):b=await i.v1.lists.create({title:f,replies_policy:d,exclusive:v}),c("default"),n==null||n({state:"success",list:b}),setTimeout(()=>{a?ia(b):na(b)},1)}catch{c("error"),alert(a?g._({id:"R7ep1i"}):g._({id:"KPoj8w"}))}})()},children:[e("div",{class:"list-form-row",children:e("label",{for:"list-title",children:[e(u,{id:"6YtxFj"})," ",e("input",{ref:p,type:"text",id:"list-title",name:"title",required:!0,disabled:s==="loading",dir:"auto"})]})}),e("div",{class:"list-form-row",children:e("select",{ref:r,name:"replies_policy",required:!0,disabled:s==="loading",children:[e("option",{value:"list",children:e(u,{id:"ei6pnR"})}),e("option",{value:"followed",children:e(u,{id:"Mr53YX"})}),e("option",{value:"none",children:e(u,{id:"PM7llw"})})]})}),l&&e("div",{class:"list-form-row",children:e("label",{class:"label-block",children:[e("input",{ref:o,type:"checkbox",name:"exclusive",disabled:s==="loading"})," ",e(u,{id:"jxxYp0"})]})}),e("div",{class:"list-form-footer",children:[e("button",{type:"submit",disabled:s==="loading",children:a?g._({id:"tfDRzk"}):g._({id:"hYgDIe"})}),a&&e(ot,{disabled:s==="loading",align:"end",menuItemClassName:"danger",confirmLabel:g._({id:"+kQ/cY"}),onClick:()=>{c("loading"),(async()=>{try{await i.v1.lists.$select(t.id).remove(),c("default"),n==null||n({state:"deleted"}),setTimeout(()=>{sa(t.id)},1)}catch{c("error"),alert(g._({id:"tqUaGL"}))}})()},children:e("button",{type:"button",class:"light danger",disabled:s==="loading",children:e(u,{id:"Jb6/SB"})})})]})]})})]})}const ca=[60*5,60*30,60*60,60*60*6,60*60*24,60*60*24*3,60*60*24*7,0],Ot={0:{id:"9ZP9cc"},300:Xe(5,"minute"),1800:Xe(30,"minute"),3600:Xe(1,"hour"),21600:Xe(6,"hour"),86400:Xe(1,"day"),259200:Xe(3,"day"),604800:Xe(1,"week")},Si=80,bs=1e3*60*10;function aa(t,n){return n.v1.accounts.familiarFollowers.fetch({id:[t]})}const oa=wt(aa,{maxAge:bs});async function ra(t,n){const i=n.v1.accounts.$select(t).statuses.list({limit:20}).next(),{value:s}=await i,c={total:s.length,originals:0,replies:0,boosts:0};return s.forEach(a=>{a.reblog?c.boosts++:a.inReplyToId&&a.inReplyToAccountId!==a.account.id?c.replies++:c.originals++}),s.length&&(c.daysSinceLastPost=Math.ceil((Date.now()-new Date(s[s.length-1].createdAt))/864e5)),c}const la=wt(ra,{maxAge:bs});function vs({account:t,fetchAccount:n=()=>{},standalone:i,instance:s,authenticated:c}){const{i18n:a}=et(),{masto:p}=se({instance:s}),{masto:r,instance:o}=se(),[l,m]=R("default"),h=typeof t=="string",[f,d]=R(h?null:t),v=be(()=>s===o,[s,o]);Q(()=>{if(!h){d(t);return}m("loading"),(async()=>{try{const ne=await n();A.accounts[`${ne.id}@${s}`]=ne,d(ne),m("default")}catch{d(null),m("error")}})()},[h,t,n]);const{acct:b,avatar:w,avatarStatic:k,bot:y,createdAt:I,displayName:_,emojis:C,fields:T,followersCount:x,followingCount:U,group:M,id:D,lastStatusAt:j,locked:te,note:J,statusesCount:N,url:P,username:B,memorial:V,moved:F,roles:ee,hideCollections:z}=f||{};let ie=!1,{header:pe,headerStatic:ce}=f||{};(!pe||/missing\.png$/.test(pe))&&w&&!/missing\.png$/.test(w)&&(pe=w,ie=!0,k&&!/missing\.png$/.test(k)&&(ce=k));const he=be(()=>D===bt(),[D]);Q(()=>{const ne=!!(f!=null&&f.id&&(f!=null&&f.username)&&(f!=null&&f.acct)&&(f!=null&&f.avatar)&&(f!=null&&f.avatarStatic)&&(f!=null&&f.displayName)&&(f!=null&&f.url));if(he&&s&&ne){const Ee=we.local.getJSON("accounts");let $=!1;Ee.forEach(q=>{q.info.id===f.id&&q.instanceURL===s&&(q.info=f,$=!0)}),$&&we.local.setJSON("accounts",Ee)}},[he,f,s]);const ve=be(()=>P?Gt.toUnicode(URL.parse(P).hostname):null,[P]),[fe,_e]=R([]),$e=Y(),Me=Y([]);async function Ce(ne){var ae;(ne||!$e.current)&&($e.current=p.v1.accounts.$select(D).followers.list({limit:Si}));const Ee=await $e.current.next();if(he||!v)return Ee;const{value:$}=Ee;let q=[];if(ne){let Z=[];try{Z=await p.v1.accounts.familiarFollowers.fetch({id:[D]})}catch{}Me.current=((ae=Z==null?void 0:Z[0])==null?void 0:ae.accounts)||[],q=[...Me.current,...$.filter(W=>!Me.current.some(Se=>Se.id===W.id))]}else $!=null&&$.length&&(q=$.filter(Z=>!Me.current.some(W=>W.id===Z.id)));return{...Ee,value:q}}const De=Y();async function Oe(ne){return(ne||!De.current)&&(De.current=p.v1.accounts.$select(D).following.list({limit:Si})),await De.current.next()}const ye=i?"div":de,X=s?`/${s}/a/${D}`:`/a/${D}`,[me,Te]=R([]),[oe,E]=R(),[G,L]=R("default"),H=!!(oe!=null&&oe.total),K=async ne=>{try{const Ee=await oa(ne,r);Te(Ee[0].accounts.slice(0,da))}catch{}},ue=async()=>{if(D){L("loading");try{const ne=await la(D,p);E(ne),L("default")}catch{L("error")}}},Pe=at(({relationship:ne,currentID:Ee})=>{ne.following||(K(Ee),!i&&N>0&&ue())},[i,D,N]),Ze=at(ne=>{ne.id===D&&(d(ne),A.accounts[`${ne.id}@${s}`]=ne)},[D,s]);return e("div",{tabIndex:"-1",class:`account-container ${l==="loading"?"skeleton":""}`,style:{"--header-color-1":fe[0],"--header-color-2":fe[1],"--header-color-3":fe[2],"--header-color-4":fe[3]},children:[l==="error"&&e("div",{class:"ui-state",children:[e("p",{children:e(u,{id:"44hICK"})}),e("p",{children:e("a",{href:h?t:P,target:"_blank",rel:"noopener noreferrer",children:[e(u,{id:"Aadw0+"})," ",e(S,{icon:"external"})]})})]}),l==="loading"?e(O,{children:[e("header",{children:e(ct,{avatarSize:"xxxl",skeleton:!0})}),e("main",{children:[e("div",{class:"note",children:[e("p",{children:"███████ ████ ████"}),e("p",{children:"████ ████████ ██████ █████████ ████ ██"})]}),e("div",{class:"account-metadata-box",children:[e("div",{class:"profile-metadata",children:[e("div",{class:"profile-field",children:[e("b",{class:"more-insignificant",children:"███"}),e("p",{children:"██████"})]}),e("div",{class:"profile-field",children:[e("b",{class:"more-insignificant",children:"████"}),e("p",{children:"███████████"})]})]}),e("div",{class:"stats",children:[e("div",{children:[e("span",{children:"██"})," ",e(u,{id:"x5LEuB"})]}),e("div",{children:[e("span",{children:"██"})," ",e(u,{id:"y6sq5j"})]}),e("div",{children:[e("span",{children:"██"})," ",e(u,{id:"+owNNn"})]})]})]}),e("div",{class:"actions",children:[e("span",{}),e("span",{class:"buttons",children:e("button",{type:"button",class:"plain",disabled:!0,children:e(S,{icon:"more",size:"l",alt:a._({id:"2FYpfJ"})})})})]})]})]}):f&&e(O,{children:[!!F&&e("div",{class:"account-moved",children:[e("p",{children:e(u,{id:"C6cVP/",values:{displayName:_},components:{0:e("b",{})}})}),e(ct,{account:F,instance:s,onClick:ne=>{ne.stopPropagation(),A.showAccount=F}})]}),!!pe&&!/missing\.png$/.test(pe)&&e("img",{src:pe,alt:"",class:`header-banner ${ie?"header-is-avatar":""}`,onError:ne=>{ne.target.crossOrigin?ne.target.src!==ce?ne.target.src=ce:(ne.target.removeAttribute("crossorigin"),ne.target.src=pe):ne.target.src!==ce?ne.target.src=ce:ne.target.remove()},crossOrigin:"anonymous",onLoad:ne=>{ne.target.classList.add("loaded");try{const Ee=window.OffscreenCanvas?new OffscreenCanvas(1,1):document.createElement("canvas"),$=Ee.getContext("2d",{willReadFrequently:!0});Ee.width=ne.target.width,Ee.height=ne.target.height,$.imageSmoothingEnabled=!1,$.drawImage(ne.target,0,0);const q=10,Z=[$.getImageData(0,0,q,q).data,$.getImageData(ne.target.width-q,0,q,q).data,$.getImageData(0,ne.target.height-q,q,q).data,$.getImageData(ne.target.width-q,ne.target.height-q,q,q).data].map(W=>{let Se=0,xe=0,ke=0,Re=0;for(let re=0;re<W.length;re+=4)Se+=W[re],xe+=W[re+1],ke+=W[re+2],Re+=W[re+3];const Be=W.length/4;return[Se/Be,xe/Be,ke/Be,Re/Be]}).map(W=>{const[Se,xe,ke,Re]=ha(W);return`rgba(${Se}, ${xe}, ${ke}, ${Re})`});_e(Z)}catch{}}}),e("header",{children:i?e(it,{shift:window.matchMedia("(min-width: calc(40em))").matches?114:64,menuButton:e("div",{children:e(ct,{account:f,instance:s,avatarSize:"xxxl",onClick:()=>{}})}),children:[e("div",{class:"szh-menu__header",children:e(ya,{acct:b,instance:s})}),e(ge,{onClick:()=>{const ne=b.includes("@")?`@${b}`:`@${b}@${s}`;try{navigator.clipboard.writeText(ne),le(a._({id:"zJoEwS"}))}catch{le(a._({id:"BC0lSD"}))}},children:[e(S,{icon:"link"}),e("span",{children:e(u,{id:"27x6gl"})})]}),e(ge,{href:P,target:"_blank",children:[e(S,{icon:"external"}),e("span",{children:e(u,{id:"Bz5hLl"})})]}),e(je,{}),e(ze,{href:f.avatar,target:"_blank",children:[e(S,{icon:"user"}),e("span",{children:e(u,{id:"7WYl2I"})})]}),e(ze,{href:f.header,target:"_blank",children:[e(S,{icon:"media"}),e("span",{children:e(u,{id:"ZNme5R"})})]})]}):e(ct,{account:f,instance:s,avatarSize:"xxxl",internal:!0})}),e("div",{class:"faux-header-bg","aria-hidden":"true"}),e("main",{children:[!!V&&e("span",{class:"tag",children:e(u,{id:"prdIOK"})}),!!y&&e("span",{class:"tag",children:[e(S,{icon:"bot"})," ",e(u,{id:"9Vdq+j"})]}),!!M&&e("span",{class:"tag",children:[e(S,{icon:"group"})," ",e(u,{id:"L8fEEm"})]}),ee==null?void 0:ee.map(ne=>e("span",{class:"tag",children:[ne.name,!!ve&&e(O,{children:[" ",e("span",{class:"more-insignificant",children:ve})]})]})),e("div",{class:"note",dir:"auto",onClick:Xi({instance:o}),dangerouslySetInnerHTML:{__html:$n(J,{emojis:C})}}),e("div",{class:"account-metadata-box",children:[(T==null?void 0:T.length)>0&&e("div",{class:"profile-metadata",children:T.map(({name:ne,value:Ee,verifiedAt:$},q)=>e("div",{class:`profile-field ${$?"profile-verified":""}`,dir:"auto",children:[e("b",{children:[e(Qi,{text:ne,emojis:C})," ",!!$&&e(S,{icon:"check-circle",size:"s",alt:a._({id:"QDEWii"})})]}),e("p",{dangerouslySetInnerHTML:{__html:$n(Ee,{emojis:C})}})]},ne+q))}),e("div",{class:"stats",children:[e(ye,{tabIndex:0,to:X,onClick:()=>{setTimeout(()=>{A.showGenericAccounts={id:"followers",heading:a._({id:"x5LEuB"}),fetchAccounts:Ce,instance:s,excludeRelationshipAttrs:he?["followedBy"]:[],blankCopy:z?a._({id:"BRV/wh"}):void 0}},0)},children:[!!me.length&&e("span",{class:"shazam-container-horizontal",children:e("span",{class:"shazam-container-inner stats-avatars-bunch",children:me.map(ne=>e(rt,{url:ne.avatarStatic,size:"s",alt:`${ne.displayName} @${ne.acct}`,squircle:ne==null?void 0:ne.bot}))})}),e("span",{title:x,children:Ve(x)})," ",e(u,{id:"x5LEuB"})]}),e(ye,{class:"insignificant",tabIndex:0,to:X,onClick:()=>{setTimeout(()=>{A.showGenericAccounts={heading:a._({id:"y6sq5j"}),fetchAccounts:Oe,instance:s,excludeRelationshipAttrs:he?["following"]:[],blankCopy:z?a._({id:"BRV/wh"}):void 0}},0)},children:[e("span",{title:U,children:Ve(U)})," ",e(u,{id:"y6sq5j"}),e("br",{})]}),e(ye,{class:"insignificant",to:X,children:[e("span",{title:N,children:Ve(N)})," ",e(u,{id:"+owNNn"})]}),!!I&&e("div",{class:"insignificant",children:e(u,{id:"PCcEFZ",values:{0:pt(I,{hideTime:!0})},components:{0:e("time",{datetime:I})}})})]})]}),!!oe&&e(ye,{to:X,class:"account-metadata-box",children:e("div",{class:"shazam-container",children:e("div",{class:"shazam-container-inner",children:H?e("div",{class:"posting-stats",title:a._({id:"wiuWLe",values:{0:(oe.originals/oe.total).toLocaleString(a.locale||void 0,{style:"percent"}),1:(oe.replies/oe.total).toLocaleString(a.locale||void 0,{style:"percent"}),2:(oe.boosts/oe.total).toLocaleString(a.locale||void 0,{style:"percent"})}}),children:[e("div",{children:oe.daysSinceLastPost<365?a._({id:"oZUtTk",values:{0:oe.total,1:oe.daysSinceLastPost,2:oe.daysSinceLastPost,3:oe.daysSinceLastPost,4:oe.total,5:oe.total,6:oe.daysSinceLastPost}}):a._({id:"JvA7Mo",values:{0:oe.total,1:oe.total}})}),e("div",{class:"posting-stats-bar",style:{"--originals-percentage":`${oe.originals/oe.total*100}%`,"--replies-percentage":`${(oe.originals+oe.replies)/oe.total*100}%`}}),e("div",{class:"posting-stats-legends",children:[e("span",{class:"ib",children:[e("span",{class:"posting-stats-legend-item posting-stats-legend-item-originals"})," ",e(u,{id:"HxF6Fk"})]})," ",e("span",{class:"ib",children:[e("span",{class:"posting-stats-legend-item posting-stats-legend-item-replies"})," ",e(u,{id:"N8UzTV"})]})," ",e("span",{class:"ib",children:[e("span",{class:"posting-stats-legend-item posting-stats-legend-item-boosts"})," ",e(u,{id:"puY2t0"})]})]})]}):e("div",{class:"posting-stats",children:e(u,{id:"vl3XTJ"})})})})}),!F&&e("div",{class:"account-metadata-box",children:e("div",{class:"shazam-container no-animation",hidden:!!oe,children:e("div",{class:"shazam-container-inner",children:e("button",{type:"button",class:"posting-stats-button",disabled:G==="loading",onClick:()=>{ue()},children:[e("div",{class:`posting-stats-bar posting-stats-icon ${G==="loading"?"loading":""}`,style:{"--originals-percentage":"33%","--replies-percentage":"66%"}}),e(u,{id:"PjP87f"})," "]})})})})]}),e("footer",{children:e(ua,{info:f,instance:s,standalone:i,authenticated:c,onRelationshipChange:Pe,onProfileUpdate:Ze})})]})]})}const da=3;function ua({info:t,instance:n,standalone:i,authenticated:s,onRelationshipChange:c=()=>{},onProfileUpdate:a=()=>{}}){var oe;if(!t)return null;const{_:p}=et(),{masto:r,instance:o,authenticated:l}=se(),m=n===o,[h,f]=R("default"),[d,v]=R(null),{id:b,acct:w,url:k,username:y,locked:I,lastStatusAt:_,note:C,fields:T,moved:x}=t,U=Y(b),{following:M,showingReblogs:D,notifying:j,followedBy:te,blocking:J,blockedBy:N,muting:P,mutingNotifications:B,requested:V,domainBlocking:F,endorsed:ee,note:z}=d||{},[ie,pe]=R(null),[ce,he]=R(!1),ve=w.includes("@")?w:`${w}@${n}`;Q(()=>{if(t){const E=bt();let G;(async()=>{if(m&&s)G=b;else if(!m&&l){const H=t.acct.includes("@");try{const K=await r.v2.search.fetch({q:H?t.acct:`${t.username}@${n}`,type:"accounts",limit:1,resolve:!0});K.accounts.length&&(G=K.accounts[0].id,pe(K.accounts[0]))}catch{}}if(!G)return;if(E===G){he(!0);return}U.current=G,f("loading");const L=r.v1.accounts.relationships.fetch({id:[G]});try{const H=await L;if(f("default"),H.length){const K=H[0];v(K),c({relationship:K,currentID:G})}}catch{f("error")}})()}},[t,s]),Q(()=>{t&&ce&&Ys(t)},[t,ce]);const fe=h==="loading",[_e,$e]=R(!1),[Me,Ce]=R(!1),[De,Oe]=R(!1),[ye,X]=R(!1),[me,Te]=R([]);return e(O,{children:[e("div",{class:"actions",children:[e("span",{children:[te?e("span",{class:"tag",children:e(u,{id:"p3UO/y"})}):_?e("small",{class:"insignificant",children:e(u,{id:"F3cM1G",values:{0:pt(_,{hideTime:!0})},components:{0:e("span",{class:"ib"})}})}):e("span",{}),P&&e("span",{class:"tag danger",children:e(u,{id:"+IJm1Z"})}),J&&e("span",{class:"tag danger",children:e(u,{id:"32TndD"})})]})," ",e("span",{class:"buttons",children:[!!z&&e("button",{type:"button",class:"private-note-tag",title:g._({id:"zxFxcH"}),onClick:()=>{Oe(!0)},dir:"auto",children:e("span",{children:z})}),e(it,{portal:{target:document.body},containerProps:{style:{zIndex:1001}},align:"center",position:"anchor",overflow:"auto",menuButton:e("button",{type:"button",class:"plain",disabled:fe,children:e(S,{icon:"more",size:"l",alt:g._({id:"2FYpfJ"})})}),onMenuChange:E=>{M&&E.open&&(async()=>{try{const G=await r.v1.accounts.$select(U.current).lists.list();Te(G)}catch{}})()},children:[l&&!ce&&e(O,{children:[e(ge,{onClick:()=>{ac({draftStatus:{status:`@${(ie==null?void 0:ie.acct)||w} `}})},children:[e(S,{icon:"at"}),e("span",{children:e(u,{id:"La94SU",values:{username:y}})})]}),e(ge,{onClick:()=>{$e(!0)},children:[e(S,{icon:"translate"}),e("span",{children:e(u,{id:"R8mSiS"})})]}),Ke("@mastodon/profile-private-note")&&e(ge,{onClick:()=>{Oe(!0)},children:[e(S,{icon:"pencil"}),e("span",{children:z?g._({id:"U+Gokq"}):g._({id:"VcQzRi"})})]}),M&&!!d&&e(O,{children:[e(ge,{onClick:()=>{f("loading"),(async()=>{try{const E=await r.v1.accounts.$select(U.current).follow({notify:!j});E&&v(E),f("default"),le(E.notifying?g._({id:"jL3N0G",values:{username:y}}):g._({id:"WBugD/",values:{username:y}}))}catch(E){alert(E),f("error")}})()},children:[e(S,{icon:"notification"}),e("span",{children:j?g._({id:"osJmEN"}):g._({id:"I92Z+b"})})]}),e(ge,{onClick:()=>{f("loading"),(async()=>{try{const E=await r.v1.accounts.$select(U.current).follow({reblogs:!D});E&&v(E),f("default"),le(E.showingReblogs?g._({id:"0X2KC8",values:{username:y}}):g._({id:"cXWjH0",values:{username:y}}))}catch(E){alert(E),f("error")}})()},children:[e(S,{icon:"rocket"}),e("span",{children:D?g._({id:"GRUr8d"}):g._({id:"uREpT3"})})]})]}),M&&e(ge,{onClick:()=>{Ce(!0)},children:[e(S,{icon:"list"}),me.length?e(O,{children:[e("small",{class:"menu-grow",children:[e(u,{id:"sJ2yQc"}),e("br",{}),e("span",{class:"more-insignificant",children:me.map(E=>E.title).join(", ")})]}),e("small",{class:"more-insignificant",children:me.length})]}):e("span",{children:e(u,{id:"sJ2yQc"})})]}),e(je,{})]}),e(ge,{onClick:()=>{const E=`@${(ie==null?void 0:ie.acct)||ve}`;try{navigator.clipboard.writeText(E),le(g._({id:"zJoEwS"}))}catch{le(g._({id:"BC0lSD"}))}},children:[e(S,{icon:"copy"}),e("small",{children:[e(u,{id:"27x6gl"}),e("br",{}),e("span",{class:"more-insignificant bidi-isolate",children:["@",(ie==null?void 0:ie.acct)||ve]})]})]}),e(ge,{href:k,target:"_blank",children:[e(S,{icon:"external"}),e("small",{class:"menu-double-lines",children:fa(k)})]}),e("div",{class:"menu-horizontal",children:[e(ge,{onClick:()=>{try{navigator.clipboard.writeText(k),le(g._({id:"edWbV6"}))}catch{le(g._({id:"W1ewR0"}))}},children:[e(S,{icon:"link"}),e("span",{children:e(u,{id:"he3ygx"})})]}),(navigator==null?void 0:navigator.share)&&((oe=navigator==null?void 0:navigator.canShare)==null?void 0:oe.call(navigator,{url:k}))&&e(ge,{onClick:()=>{try{navigator.share({url:k})}catch{alert(g._({id:"TtG3Uh"}))}},children:[e(S,{icon:"share"}),e("span",{children:e(u,{id:"LFKLqp"})})]})]}),!!d&&e(O,{children:[e(je,{}),P?e(ge,{onClick:()=>{f("loading"),(async()=>{try{const E=await r.v1.accounts.$select((ie==null?void 0:ie.id)||b).unmute();v(E),f("default"),le(g._({id:"B4Xkly",values:{username:y}})),A.reloadGenericAccounts.id="mute",A.reloadGenericAccounts.counter++}catch{f("error")}})()},children:[e(S,{icon:"unmute"}),e("span",{children:e(u,{id:"xFiD9U",values:{username:y}})})]}):e(gn,{menuClassName:"menu-blur",openTrigger:"clickOnly",direction:"bottom",overflow:"auto",shift:16,label:e(O,{children:[e(S,{icon:"mute"}),e("span",{class:"menu-grow",children:e(u,{id:"cW6rdy",values:{username:y}})}),e("span",{style:{textOverflow:"clip"},children:[e(S,{icon:"time"}),e(S,{icon:"chevron-right"})]})]}),children:e("div",{class:"menu-wrap",children:ca.map(E=>e(ge,{onClick:()=>{f("loading"),(async()=>{try{const G=await r.v1.accounts.$select((ie==null?void 0:ie.id)||b).mute({duration:E});v(G),f("default"),le(g._({id:"/plB9m",values:{0:typeof Ot[E]=="function"?Ot[E]():p(Ot[E]),username:y}})),A.reloadGenericAccounts.id="mute",A.reloadGenericAccounts.counter++}catch{f("error"),le(g._({id:"vWGBjT",values:{username:y}}))}})()},children:typeof Ot[E]=="function"?Ot[E]():p(Ot[E])}))})}),te&&e(ot,{subMenu:!0,menuItemClassName:"danger",confirmLabel:e(O,{children:[e(S,{icon:"user-x"}),e("span",{children:e(u,{id:"aVZM3d",values:{username:y}})})]}),onClick:()=>{f("loading"),(async()=>{try{const E=await r.v1.accounts.$select((ie==null?void 0:ie.id)||b).removeFromFollowers();v(E),f("default"),le(g._({id:"AgkcM/",values:{username:y}})),A.reloadGenericAccounts.id="followers",A.reloadGenericAccounts.counter++}catch{f("error")}})()},children:[e(S,{icon:"user-x"}),e("span",{children:e(u,{id:"VCZ0OT"})})]}),e(ot,{subMenu:!0,confirm:!J,confirmLabel:e(O,{children:[e(S,{icon:"block"}),e("span",{children:e(u,{id:"4b8/Za",values:{username:y}})})]}),menuItemClassName:"danger",onClick:()=>{f("loading"),(async()=>{try{if(J){const E=await r.v1.accounts.$select((ie==null?void 0:ie.id)||b).unblock();v(E),f("default"),le(g._({id:"sI9N29",values:{username:y}}))}else{const E=await r.v1.accounts.$select((ie==null?void 0:ie.id)||b).block();v(E),f("default"),le(g._({id:"uYcYzu",values:{username:y}}))}A.reloadGenericAccounts.id="block",A.reloadGenericAccounts.counter++}catch{f("error"),J?le(g._({id:"0tG4wG",values:{username:y}})):le(g._({id:"pA+qEx",values:{username:y}}))}})()},children:J?e(O,{children:[e(S,{icon:"unblock"}),e("span",{children:e(u,{id:"FJliVl",values:{username:y}})})]}):e(O,{children:[e(S,{icon:"block"}),e("span",{children:e(u,{id:"gkTaTJ",values:{username:y}})})]})}),e(ge,{className:"danger",onClick:()=>{A.showReportModal={account:ie||t}},children:[e(S,{icon:"flag"}),e("span",{children:e(u,{id:"lMVo32",values:{username:y}})})]})]}),l&&ce&&i&&Ke("@mastodon/profile-edit")&&e(O,{children:[e(je,{}),e(ge,{onClick:()=>{X(!0)},children:[e(S,{icon:"pencil"}),e("span",{children:e(u,{id:"9OpVZg"})})]})]}),!1]}),!d&&h==="loading"&&e(Le,{abrupt:!0}),!!d&&!x&&e(ot,{confirm:M||V,confirmLabel:e("span",{children:V?g._({id:"e7qQIH"}):g._({id:"eYsAQr",values:{0:t.acct||t.username}})}),menuItemClassName:"danger",align:"end",disabled:fe,onClick:()=>{f("loading"),(async()=>{try{let E;M||V?E=await r.v1.accounts.$select(U.current).unfollow():E=await r.v1.accounts.$select(U.current).follow(),E&&v(E),f("default")}catch(E){alert(E),f("error")}})()},children:e("button",{type:"button",class:`${M||V?"light swap":""}`,"data-swap-state":M||V?"danger":"",disabled:fe,children:M?e(O,{children:[e("span",{children:e(u,{id:"y6sq5j"})}),e("span",{children:e(u,{id:"HKrBPX"})})]}):V?e(O,{children:[e("span",{children:e(u,{id:"Yx0Ud8"})}),e("span",{children:e(u,{id:"yTVtKs"})})]}):I?e(O,{children:[e(S,{icon:"lock"})," ",e("span",{children:e(u,{id:"MKEPCY"})})]}):g._({id:"MKEPCY"})})})]})]}),!!_e&&e(Ne,{onClose:()=>{$e(!1)},children:e(pa,{note:C,fields:T,onClose:()=>$e(!1)})}),!!Me&&e(Ne,{onClose:()=>{Ce(!1)},children:e(ma,{accountID:U.current,onClose:()=>Ce(!1)})}),!!De&&e(Ne,{onClose:()=>{Oe(!1)},children:e(ga,{account:t,note:z,onRelationshipChange:E=>{v(E)},onClose:()=>Oe(!1)})}),!!ye&&e(Ne,{onClose:()=>{X(!1)},children:e(ba,{onClose:({state:E,account:G}={})=>{X(!1),E==="success"&&G&&a(G)}})})]})}function ha([t,n,i]){const s=.2126*t+.7152*n+.0722*i;let c;return s>=220?c=1:s<=50?c=.1:c=s/255,c=Math.min(1,c),[t,n,i,c]}function fa(t){if(!t)return;const n=URL.parse(t),{host:i,pathname:s}=n,c=s.replace(/\/$/,"").replace(/^\//,"");return e(O,{children:[e("span",{class:"more-insignificant",children:[Gt.toUnicode(i),"/"]}),e("wbr",{}),e("span",{children:c})]})}function pa({note:t,fields:n,onClose:i}){const s=(n==null?void 0:n.map(({name:a,value:p})=>`${a}
${pi(p)}`).join(`

`))||"",c=pi(t)+(s?`

${s}`:"");return e("div",{class:"sheet",children:[!!i&&e("button",{type:"button",class:"sheet-close",onClick:i,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(u,{id:"9groMz"})})}),e("main",{children:[e("p",{style:{whiteSpace:"pre-wrap"},children:c}),e(es,{forceTranslate:!0,text:c})]})]})}function ma({accountID:t,onClose:n}){const{masto:i}=se(),[s,c]=R("default"),[a,p]=R([]),[r,o]=R([]),[l,m]=Lt(d=>d+1,0);Q(()=>{c("loading"),(async()=>{try{const d=await sn();p(d);const v=await i.v1.accounts.$select(t).lists.list();o(v),c("default")}catch{c("error")}})()},[l]);const[h,f]=R(!1);return e("div",{class:"sheet",id:"list-add-remove-container",children:[!!n&&e("button",{type:"button",class:"sheet-close",onClick:n,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(u,{id:"sJ2yQc"})})}),e("main",{children:[a.length>0?e("ul",{class:"list-add-remove",children:a.map(d=>{const v=r.some(b=>b.id===d.id);return e("li",{children:e("button",{type:"button",class:`light ${v?"checked":""}`,disabled:s==="loading",onClick:()=>{c("loading"),(async()=>{try{v?await i.v1.lists.$select(d.id).accounts.remove({accountIds:[t]}):await i.v1.lists.$select(d.id).accounts.create({accountIds:[t]}),m()}catch{c("error"),alert(v?g._({id:"7KnEYa"}):g._({id:"Tba8uO"}))}})()},children:[e(S,{icon:"check-circle",alt:"☑️"}),e("span",{children:d.title})]})})})}):s==="loading"?e("p",{class:"ui-state",children:e(Le,{abrupt:!0})}):s==="error"?e("p",{class:"ui-state",children:e(u,{id:"v/l5uA"})}):e("p",{class:"ui-state",children:e(u,{id:"/MJ7gZ"})}),e("button",{type:"button",class:"plain2",onClick:()=>f(!0),disabled:s!=="default",children:[e(S,{icon:"plus",size:"l"})," ",e("span",{children:e(u,{id:"Sb2gYF"})})]})]}),h&&e(Ne,{onClick:d=>{d.target===d.currentTarget&&f(!1)},children:e(ti,{list:h==null?void 0:h.list,onClose:d=>{d.state==="success"&&m(),f(!1)}})})]})}function ga({account:t,note:n,onRelationshipChange:i=()=>{},onClose:s=()=>{}}){const{masto:c}=se(),[a,p]=R("default"),r=Y(null);return Q(()=>{let o;return r.current&&!n&&(o=setTimeout(()=>{var l,m;(m=(l=r.current).focus)==null||m.call(l)},100)),()=>{clearTimeout(o)}},[]),e("div",{class:"sheet",id:"private-note-container",children:[!!s&&e("button",{type:"button",class:"sheet-close",onClick:s,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:e("b",{children:e(u,{id:"F4lRiZ",values:{0:(t==null?void 0:t.username)||(t==null?void 0:t.acct)}})})}),e("main",{children:e("form",{onSubmit:o=>{o.preventDefault();const m=new FormData(o.target).get("note");(m==null?void 0:m.trim())!==(n==null?void 0:n.trim())&&(p("loading"),(async()=>{try{const h=await c.v1.accounts.$select(t==null?void 0:t.id).note.create({comment:m});p("default"),i(h),s()}catch(h){p("error"),alert((h==null?void 0:h.message)||g._({id:"ot8LpF"}))}})())},children:[e("textarea",{ref:r,name:"note",disabled:a==="loading",dir:"auto",children:n}),e("footer",{children:[e("button",{type:"button",class:"light",disabled:a==="loading",onClick:()=>{s==null||s()},children:e(u,{id:"dEgA5A"})}),e("span",{children:[e(Le,{abrupt:!0,hidden:a!=="loading"}),e("button",{disabled:a==="loading",type:"submit",children:e(u,{id:"SrwrEj"})})]})]})]})})]})}function ba({onClose:t=()=>{}}){const{masto:n}=se(),[i,s]=R("loading"),[c,a]=R(null);Q(()=>{(async()=>{try{const h=await n.v1.accounts.verifyCredentials();a(h),s("default")}catch{s("error")}})()},[]);const{displayName:p,source:r}=c||{},{note:o,fields:l}=r||{},m=Y(null);return e("div",{class:"sheet",id:"edit-profile-container",children:[!!t&&e("button",{type:"button",class:"sheet-close",onClick:t,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:e("b",{children:e(u,{id:"9OpVZg"})})}),e("main",{children:i==="loading"?e("p",{class:"ui-state",children:e(Le,{abrupt:!0})}):e("form",{onSubmit:h=>{h.preventDefault();const f=new FormData(h.target),d=f.get("display_name"),v=f.get("note"),b=m.current.querySelectorAll('input[name^="fields_attributes"]'),w=[];b.forEach(k=>{const y=k.name,[I,_,C]=y.match(/fields_attributes\[(\d+)\]\[(.+)\]/)||[],T=k.value?k.value.trim():"";_&&C&&T&&(w[_]||(w[_]={}),w[_][C]=T)}),w.forEach(k=>{k.name&&!k.value&&(k.value="")}),(async()=>{try{const k=await n.v1.accounts.updateCredentials({displayName:d,note:v,fieldsAttributes:w});t==null||t({state:"success",account:k})}catch(k){alert((k==null?void 0:k.message)||g._({id:"FwMMx0"}))}})()},children:[e("p",{children:e("label",{children:["Name"," ",e("input",{type:"text",name:"display_name",defaultValue:p,maxLength:30,disabled:i==="loading",dir:"auto"})]})}),e("p",{children:e("label",{children:[e(u,{id:"E+oKCO"}),e("textarea",{defaultValue:o,name:"note",maxLength:500,rows:"5",disabled:i==="loading",dir:"auto"})]})}),e("p",{children:e(u,{id:"T4I119"})}),e("table",{ref:m,children:[e("thead",{children:e("tr",{children:[e("th",{children:e(u,{id:"87a/t/"})}),e("th",{children:e(u,{id:"4b3oEV"})})]})}),e("tbody",{children:Array.from({length:Math.max(4,l.length)}).map((h,f)=>{const{name:d="",value:v=""}=l[f]||{};return e(va,{name:d,value:v,index:f,disabled:i==="loading"},f)})})]}),e("footer",{children:[e("button",{type:"button",class:"light",disabled:i==="loading",onClick:()=>{t==null||t()},children:e(u,{id:"dEgA5A"})}),e("button",{type:"submit",disabled:i==="loading",children:e(u,{id:"tfDRzk"})})]})]})})]})}function va({name:t,value:n,disabled:i,index:s}){const[c,a]=R(!!n);return e("tr",{children:[e("td",{children:e("input",{type:"text",name:`fields_attributes[${s}][name]`,defaultValue:t,disabled:i,maxLength:255,required:c,dir:"auto"})}),e("td",{children:e("input",{type:"text",name:`fields_attributes[${s}][value]`,defaultValue:n,disabled:i,maxLength:255,onChange:p=>a(!!p.currentTarget.value),dir:"auto"})})]})}function ya({acct:t,instance:n}){let[i,s]=t.split("@");return s||(s=n),e("div",{class:"handle-info",children:[e("span",{class:"handle-handle",children:[e("b",{class:"handle-username",children:i}),e("span",{class:"handle-at",children:"@"}),e("b",{class:"handle-server",children:s})]}),e("div",{class:"handle-legend",children:[e("span",{class:"ib",children:[e("span",{class:"handle-legend-icon username"})," ",e(u,{id:"silO9A"})]})," ",e("span",{class:"ib",children:[e("span",{class:"handle-legend-icon server"})," ",e(u,{id:"rZgCpJ"})]})]})]})}function wa({account:t,instance:n,onClose:i}){const{masto:s,instance:c,authenticated:a}=se({instance:n}),p=typeof t=="string";return Q(()=>{p||(A.accounts[`${t.id}@${c}`]=t)},[t]),ps(i),e("div",{class:"sheet",children:[!!i&&e("button",{type:"button",class:"sheet-close outer",onClick:i,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e(vs,{instance:c,authenticated:a,account:t,fetchAccount:async()=>{if(p)try{return await s.v1.accounts.lookup({acct:t,skip_webfinger:!1})}catch{const o=await s.v2.search.fetch({q:t,type:"accounts",limit:1,resolve:a});if(o.accounts.length)return o.accounts[0];if(/https?:\/\/[^/]+\/@/.test(t)){const l=URL.parse(t),{hostname:m,pathname:h}=l,f=h.replace(/^\//,"").replace(/\/$/,"")+"@"+m,d=await s.v2.search.fetch({q:f,type:"accounts",limit:1,resolve:a});if(d.accounts.length)return d.accounts[0]}}else return t}})]})}function ka({onClose:t}){const{masto:n}=se(),[i,s]=R("default"),[c,a]=R([]),[p,r]=Lt(l=>l+1,0);Q(()=>{s("loading"),(async()=>{try{const l=await lt.drafts.keys();if(l.length){const m=mn(),h=l.filter(f=>f.startsWith(m));if(h.length){const f=await lt.drafts.getMany(h);f.sort((d,v)=>new Date(v.updatedAt).getTime()-new Date(d.updatedAt).getTime()),a(f)}else a([])}else a([]);s("default")}catch{s("error")}})()},[p]);const o=(c==null?void 0:c.length)>0;return e("div",{class:"sheet",children:[!!t&&e("button",{type:"button",class:"sheet-close",onClick:t,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:[e("h2",{children:[e(u,{id:"krk5ws"})," ",e(Le,{abrupt:!0,hidden:i!=="loading"})]}),o&&e("div",{class:"insignificant",children:e(u,{id:"Ap/10+"})})]}),e("main",{children:o?e(O,{children:[e("ul",{class:"drafts-list",children:c.map(l=>{const{updatedAt:m,key:h,draftStatus:f,replyTo:d}=l,v=new Date(m);return e("li",{children:[e("div",{class:"mini-draft-meta",children:[e("b",{children:[e(S,{icon:d?"reply":"quill",size:"s"})," ",e("time",{children:[!!d&&e(O,{children:["@",d.account.acct,e("br",{})]}),pt(v)]})]}),e(ot,{confirmLabel:e("span",{children:e(u,{id:"/W5yFF"})}),menuItemClassName:"danger",align:"end",disabled:i==="loading",onClick:()=>{(async()=>{try{await lt.drafts.del(h),r()}catch{alert(g._({id:"rEYoku"}))}})()},children:e("button",{type:"button",class:"small light",disabled:i==="loading",children:e(u,{id:"Jb6/SB"})})})]}),e("button",{type:"button",disabled:i==="loading",class:"draft-item",onClick:async()=>{let b;if(d){s("loading");try{b=await n.v1.statuses.$select(d.id).fetch()}catch{alert(g._({id:"tMwimH"})),s("default");return}s("default")}window.__COMPOSE__={draftStatus:f,replyToStatus:b},A.showCompose=!0,A.showDrafts=!1},children:e(_a,{draft:l})})]},m)})}),c.length>1&&e("p",{children:e(ot,{confirmLabel:e("span",{children:e(u,{id:"3IakFR"})}),menuItemClassName:"danger",disabled:i==="loading",onClick:()=>{(async()=>{s("loading");try{await lt.drafts.delMany(c.map(l=>l.key)),s("default"),r()}catch{alert(g._({id:"0J4sZq"})),s("error")}})()},children:e("button",{type:"button",class:"light danger",disabled:i==="loading",children:e(u,{id:"hOg+Mt"})})})})]}):e("p",{children:e(u,{id:"8iQ+jk"})})})]})}function _a({draft:t}){var h;const{draftStatus:n,replyTo:i}=t,{status:s,spoilerText:c,poll:a,mediaAttachments:p}=n,r=((h=a==null?void 0:a.options)==null?void 0:h.length)>0,o=(p==null?void 0:p.length)>0,l=r||o,m=be(()=>{if(!o)return;const f=p.find(b=>/image/.test(b.type));if(!f)return;const{file:d}=f;return URL.createObjectURL(d)},[o,p]);return e(O,{children:e("div",{class:"mini-draft",children:[l&&e("div",{class:`mini-draft-aside ${m?"has-image":""}`,style:m?{"--bg-image":`url(${m})`}:{},children:[r&&e(S,{icon:"poll",alt:g._({id:"4WUbF1"})}),o&&e("span",{children:[e(S,{icon:"attachment",alt:g._({id:"xYilR2"})})," ",e("small",{children:p==null?void 0:p.length})]})]}),e("div",{class:"mini-draft-main",children:[!!c&&e("div",{class:"mini-draft-spoiler",children:c}),!!s&&e("div",{class:"mini-draft-status",children:s})]})]})})}function Sa({html:t,url:n,width:i,height:s,onClose:c=()=>{}}){return e("div",{class:"embed-modal-container",children:[e("div",{class:"top-controls",children:[e("button",{type:"button",class:"light",onClick:()=>c(),children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),n&&e("a",{href:n,target:"_blank",rel:"noopener noreferrer",class:"button plain",children:[e("span",{children:e(u,{id:"4/RpOy"})})," ",e(S,{icon:"external"})]})]}),e("div",{class:"embed-content",dangerouslySetInnerHTML:{__html:t},style:{"--width":i+"px","--height":s+"px","--aspect-ratio":`${i}/${s}`}})]})}function Ia({instance:t,excludeRelationshipAttrs:n=[],postID:i,onClose:s=()=>{},blankCopy:c=g._({id:"10OlfF"})}){const{masto:a,instance:p}=se(),r=t?t===p:!0,o=Fe(A),[l,m]=R("default"),[h,f]=R([]),[d,v]=R(!1);if(ps(s),!o.showGenericAccounts)return null;const{id:b,heading:w,fetchAccounts:k,accounts:y,showReactions:I}=o.showGenericAccounts,[_,C]=R({}),T=async D=>{if(!(D!=null&&D.length)||!r)return;const j=await Yn(D,_);j&&C({..._,...j})},x=D=>{k&&(D&&f([]),m("loading"),(async()=>{try{const{done:j,value:te}=await k(D);if(Array.isArray(te)){if(D){const J=[];for(let N=0;N<te.length;N++){const P=te[N],B=J.find((V,F)=>V.id===P.id&&N!==F);B?B._types.push(...P._types):J.push({_types:[],...P})}f(J)}else f(J=>{const N=J;for(const P of te){const B=N.find(V=>V.id===P.id);B?B._types.push(...P._types):N.push(P)}return N});v(!j),T(te)}else v(!1);m("default")}catch{m("error")}})())},U=Y(!0);Q(()=>{(y==null?void 0:y.length)>0?(f(y),T(y)):(x(!0),U.current=!1)},[y,k]),Q(()=>{var D;U.current||((D=o.reloadGenericAccounts)==null?void 0:D.id)===b&&x(!0)},[o.reloadGenericAccounts.counter]);const M=A.statuses[i];return e("div",{id:"generic-accounts-container",class:"sheet",tabindex:"-1",children:[e("button",{type:"button",class:"sheet-close",onClick:s,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:w||g._({id:"bPwFdf"})})}),e("main",{children:[M&&e(de,{to:`/${t||p}/s/${M.id}`,class:"post-preview",children:e(qe,{status:M,size:"s",readOnly:!0})}),h.length>0?e(O,{children:[e("ul",{class:"accounts-list",children:h.map(D=>{var J,N;const j=_[D.id],te=`${D.id}-${((J=D._types)==null?void 0:J.length)||""}`;return e("li",{children:[I&&((N=D._types)==null?void 0:N.length)>0&&e("div",{class:"reactions-block",children:D._types.map(P=>e(S,{icon:{reblog:"rocket",favourite:"heart"}[P],class:`${P}-icon`}))}),e("div",{class:"account-relationships",children:e(ct,{account:D,showStats:!0,relationship:j,excludeRelationshipAttrs:n})})]},te)})}),l==="default"?d?e(yt,{onChange:D=>{D&&x()},children:e("button",{type:"button",class:"plain block",onClick:()=>x(),children:e(u,{id:"uXRAkV"})})}):e("p",{class:"ui-state insignificant",children:e(u,{id:"2EYeAZ"})}):l==="loading"&&e("p",{class:"ui-state",children:e(Le,{abrupt:!0})})]}):l==="loading"?e("p",{class:"ui-state",children:e(Le,{abrupt:!0})}):l==="error"?e("p",{class:"ui-state",children:e(u,{id:"AThL/k"})}):e("p",{class:"ui-state insignificant",children:c})]})]})}function Ca({alt:t,lang:n,onClose:i}){const s=Fe(A),[c,a]=R(!1),p=Ji(!0),r=s.settings.contentTranslationHideLanguages||[],o=!!n&&n!==p&&!ri([n],[p])&&!r.find(l=>n===l||ri([n],[l]));return e("div",{class:"sheet",tabindex:"-1",children:[!!i&&e("button",{type:"button",class:"sheet-close outer",onClick:i,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{class:"header-grid",children:[e("h2",{children:e(u,{id:"5gfDMm"})}),e("div",{class:"header-side",children:e(it,{align:"end",menuButton:e("button",{type:"button",class:"plain4",children:e(S,{icon:"more",alt:g._({id:"2FYpfJ"}),size:"xl"})}),children:[e(ge,{disabled:c,onClick:()=>{a(!0)},children:[e(S,{icon:"translate"}),e("span",{children:e(u,{id:"pi8x/S"})})]}),oc&&e(ge,{onClick:()=>{rc(t,n)},children:[e(S,{icon:"speak"}),e("span",{children:e(u,{id:"yIBLq8"})})]})]})})]}),e("main",{lang:n,dir:"auto",children:[e("p",{style:{whiteSpace:"pre-wrap",textWrap:"pretty"},children:t}),(o||c)&&e(es,{forceTranslate:c,sourceLanguage:n,text:t})]})]})}function Cn(t,n,i){return Math.max(Math.min(t,i),n)}const Tn=t=>t>=.04045?Math.pow((t+.055)/1.055,2.4):t/12.92,xn=t=>t>=.0031308?1.055*Math.pow(t,1/2.4)-.055:12.92*t;function ni([t,n,i]){t=Tn(t/255),n=Tn(n/255),i=Tn(i/255);var s=.4122214708*t+.5363325363*n+.0514459929*i,c=.2119034982*t+.6806995451*n+.1073969566*i,a=.0883024619*t+.2817188376*n+.6299787005*i;return s=Math.cbrt(s),c=Math.cbrt(c),a=Math.cbrt(a),[s*.2104542553+c*.793617785+a*-.0040720468,s*1.9779984951+c*-2.428592205+a*.4505937099,s*.0259040371+c*.7827717662+a*-.808675766]}function ii([t,n,o]){var s=t+n*.3963377774+o*.2158037573,c=t+n*-.1055613458+o*-.0638541728,a=t+n*-.0894841775+o*-1.291485548;s=s**3,c=c**3,a=a**3;var p=s*4.0767416621+c*-3.3077115913+a*.2309699292,r=s*-1.2684380046+c*2.6097574011+a*-.3413193965,o=s*-.0041960863+c*-.7034186147+a*1.707614701;return p=255*xn(p),r=255*xn(r),o=255*xn(o),p=Cn(p,0,255),r=Cn(r,0,255),o=Cn(o,0,255),p=Math.round(p),r=Math.round(r),o=Math.round(o),[p,r,o]}var Ta={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Blaede Phanpy",PHANPY_DEFAULT_INSTANCE:"mastodon.blaede.family",PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:"https://mastodon.blaede.family/auth/sign_up",PHANPY_GIPHY_API_KEY:"48JGsrSS1XE5w4nWe9c9hqxPbsfRWR0e",PHANPY_LINGVA_INSTANCES:"lingva.phanpy.social lingva.lunar.icu lingva.garudalinux.org translate.plausibility.cloud",PHANPY_PRIVACY_POLICY_URL:"https://mastodon.blaede.family/privacy-policy",PHANPY_WEBSITE:"https://phanpy.blaede.family",PROD:!0,SSR:!1,VITE_APP_ENV:"production"};const{PHANPY_IMG_ALT_API_URL:cl}=Ta;function ys({mediaAttachments:t,statusID:n,instance:i,lang:s,index:c=0,onClose:a=()=>{}}){var y,I;const[p,r]=R("default"),o=Y(null),[l,m]=R(c),h=Y(null);vt(()=>{var _;(_=h.current)==null||_.scrollIntoView()},[]);const f=Y(n);Q(()=>{const _=c*o.current.clientWidth,C=f.current!==n;C&&(f.current=n),o.current.scrollTo({left:_*(xt()?-1:1),behavior:C?"auto":"smooth"}),o.current.focus()},[c,n]);const[d,v]=R(!0);Q(()=>{let _=()=>{a()};return o.current&&o.current.addEventListener("swiped-down",_),()=>{o.current&&o.current.removeEventListener("swiped-down",_)}},[]),Ue("esc",a,{ignoreEventWhen:_=>!!document.querySelector("#modal-container > *")},[a]),Q(()=>{let _=()=>{const{clientWidth:C,scrollLeft:T}=o.current,x=Math.round(Math.abs(T)/C);m(x)};return o.current&&o.current.addEventListener("scroll",_,{passive:!0}),()=>{o.current&&o.current.removeEventListener("scroll",_)}},[]),Q(()=>{let _=setTimeout(()=>{var C,T;(T=(C=o.current)==null?void 0:C.focus)==null||T.call(C)},100);return()=>clearTimeout(_)},[]);const b=be(()=>t==null?void 0:t.map(_=>{const{blurhash:C}=_;if(C){const T=jn(C),x=ni(T);return ii([.6,x[1],x[2]])}return null}),[t]),w=be(()=>{var T;const C=100/b.length;return((T=b==null?void 0:b.map((x,U)=>{const M=U*C+5,D=(U+1)*C-5;return x?`
            rgba(${x==null?void 0:x.join(",")}, 0.4) ${M}%,
            rgba(${x==null?void 0:x.join(",")}, 0.4) ${D}%
          `:`
            transparent ${M}%,
            transparent ${D}%
          `}))==null?void 0:T.join(", "))||"transparent"},[b]);let k=Y(null);return Q(()=>()=>{var _,C;(C=(_=k.current)==null?void 0:_.hideToast)==null||C.call(_)},[]),e("div",{class:`media-modal-container media-modal-count-${t==null?void 0:t.length}`,children:[e("div",{ref:o,tabIndex:"0","data-swipe-threshold":"44",class:"carousel",onClick:_=>{(_.target.classList.contains("carousel-item")||_.target.classList.contains("media")||_.target.classList.contains("media-zoom"))&&a()},style:t.length>1?{backgroundAttachment:"local",backgroundImage:`linear-gradient(
            to ${xt()?"left":"right"}, ${w})`}:{},children:t==null?void 0:t.map((_,C)=>{const T=t.length===1?b[C]:null;return e("div",{class:"carousel-item",style:T?{"--accent-color":`rgb(${T==null?void 0:T.join(",")})`,"--accent-alpha-color":`rgba(${T==null?void 0:T.join(",")}, 0.4)`}:{},tabindex:"0",ref:C===l?h:null,onClick:x=>{x.target.classList.contains("media")||v(!d)},children:[!!_.description&&e("button",{type:"button",class:"media-alt",hidden:!d,onClick:()=>{A.showMediaAlt={alt:_.description,lang:s}},children:[e("span",{class:"alt-badge",children:"ALT"}),e("span",{class:"media-alt-desc",lang:s,dir:"auto",children:_.description})]}),e(ts,{media:_,showOriginal:!0,lang:s})]},_.id)})}),e("div",{class:"carousel-top-controls",hidden:!d,children:[e("span",{children:e("button",{type:"button",class:"carousel-button",onClick:()=>a(),children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})})}),(t==null?void 0:t.length)>1?e("span",{class:"carousel-dots",children:t==null?void 0:t.map((_,C)=>e("button",{type:"button",disabled:C===l,class:`carousel-dot ${C===l?"active":""}`,onClick:T=>{T.preventDefault(),T.stopPropagation();const x=o.current.clientWidth*C*(xt()?-1:1);o.current.scrollTo({left:x,behavior:"smooth"}),o.current.focus()},children:e(S,{icon:"round",size:"s",alt:"⸱"})},_.id))}):e("span",{}),e("span",{children:[e(it,{overflow:"auto",align:"end",position:"anchor",gap:4,menuClassName:"glass-menu",menuButton:e("button",{type:"button",class:"carousel-button",children:e(S,{icon:"more",alt:g._({id:"2FYpfJ"})})}),children:[e(ze,{href:((y=t[l])==null?void 0:y.remoteUrl)||((I=t[l])==null?void 0:I.url),class:"carousel-button",target:"_blank",title:g._({id:"5hXGws"}),children:[e(S,{icon:"popout"}),e("span",{children:e(u,{id:"aDr7Vc"})})]}),!1]})," ",e(de,{to:`${i?`/${i}`:""}/s/${n}${window.matchMedia("(min-width: calc(40em + 350px))").matches?`?media=${l+1}`:""}`,class:"button carousel-button media-post-link",children:[e("span",{class:"button-label",children:[e(u,{id:"ISg5SQ"})," "]}),"»"]})]})]}),(t==null?void 0:t.length)>1&&e("div",{class:"carousel-controls",hidden:!d,children:[e("button",{type:"button",class:"carousel-button",hidden:l===0,onClick:_=>{_.preventDefault(),_.stopPropagation(),o.current.focus(),o.current.scrollTo({left:o.current.clientWidth*(l-1)*(xt()?-1:1),behavior:"smooth"})},children:e(S,{icon:"arrow-left",alt:g._({id:"DHhJ7s"})})}),e("button",{type:"button",class:"carousel-button",hidden:l===t.length-1,onClick:_=>{_.preventDefault(),_.stopPropagation(),o.current.focus(),o.current.scrollTo({left:o.current.clientWidth*(l+1)*(xt()?-1:1),behavior:"smooth"})},children:e(S,{icon:"arrow-right",alt:g._({id:"hXzOVo"})})})]})]})}const xa=[,"spam","legal","violation","other"],Wt={spam:{label:{id:"t8dIOP"},description:{id:"csQin/"}},legal:{label:{id:"IjKdHM"},description:{id:"e6tGFu"}},violation:{label:{id:"KPFHM2"},description:{id:"fpotTF"},stampLabel:{id:"iuLUuH"}},other:{label:{id:"/IX/7x"},description:{id:"kxiG8g"},excludeStamp:!0}};function Aa({account:t,post:n,onClose:i}){const{_:s}=et(),{masto:c}=se(),[a,p]=R("default"),[r,o]=t.acct.split("@"),[l,m]=be(()=>{const{rules:y,domain:I}=Vi();return[y||[],I]}),[h,f]=R(null),[d,v]=R(!1),b=Y(null),[w,k]=R(!1);return e("div",{class:"report-modal-container",children:[e("div",{class:"top-controls",children:[e("h1",{children:n?g._({id:"muLhL3"}):g._({id:"ACul2G",values:{username:r}})}),e("button",{type:"button",class:"plain4 small",disabled:a==="loading",onClick:()=>i(),children:e(S,{icon:"x",size:"xl",alt:g._({id:"yz7wBu"})})})]}),e("main",{children:[e("div",{class:"report-preview",children:n?e(qe,{status:n,size:"s",previewMode:!0}):e(ct,{account:t,avatarSize:"xxl",useAvatarStatic:!0,showStats:!0,showActivity:!0})}),!!h&&!Wt[h].excludeStamp&&e("span",{class:"rubber-stamp","aria-hidden":"true",children:[s(Wt[h].stampLabel||s(Wt[h].label)),e("small",{children:e(u,{id:"2WtL62"})})]},h),e("form",{onSubmit:y=>{y.preventDefault();const I=new FormData(y.target),_=Object.fromEntries(I.entries());let{category:C,comment:T,forward:x}=_;T||(T=void 0),x==="on"&&(x=!0);const U=C==="violation"?Object.entries(_).filter(([D])=>D.startsWith("rule_ids")).map(([D,j])=>j):void 0,M={category:C,comment:T,forward:x,ruleIds:U};p("loading"),(async()=>{try{await c.v1.reports.create({accountId:t.id,statusIds:n!=null&&n.id?[n.id]:void 0,category:C,comment:T,ruleIds:U,forward:x}),p("success"),le(n?g._({id:"y3ou+8"}):g._({id:"R9kjEL"})),i()}catch(D){p("error"),le((D==null?void 0:D.message)||(n?g._({id:"+3FjPq"}):g._({id:"oEQq5w"})))}})()},children:[e("p",{children:n?g._({id:"L9fUm+"}):g._({id:"rSLkfe"})}),e("section",{class:"report-categories",children:xa.map(y=>y==="violation"&&!(l!=null&&l.length)?null:e(O,{children:[e("label",{class:"report-category",children:[e("input",{type:"radio",name:"category",value:y,required:!0,disabled:a==="loading",onChange:I=>{f(I.target.value),v(I.target.value==="violation")}}),e("span",{children:[s(Wt[y].label),"  ",e("small",{class:"ib insignificant",children:s(Wt[y].description)})]})]}),y==="violation"&&!!(l!=null&&l.length)&&e("div",{class:"shazam-container no-animation",hidden:!d,children:e("div",{class:"shazam-container-inner",children:e("div",{class:"report-rules",ref:b,children:l.map((I,_)=>e("label",{class:"report-rule",children:[e("input",{type:"checkbox",name:`rule_ids[${_}]`,value:I.id,required:d&&!w,disabled:a==="loading",onChange:C=>{const{checked:T}=C.target;T?k(!0):b.current.querySelectorAll("input:checked").length||k(!1)}}),e("span",{children:I.text})]},I.id))})})})]},y))}),e("section",{class:"report-comment",children:[e("p",{children:e("label",{for:"report-comment",children:e(u,{id:"ecVtjm"})})}),e("textarea",{maxlength:"1000",rows:"1",name:"comment",id:"report-comment",disabled:a==="loading"})]}),!!o&&o!==m&&e("section",{children:e("p",{children:e("label",{children:[e("input",{type:"checkbox",switch:!0,name:"forward",disabled:a==="loading"})," ",e("span",{children:e(u,{id:"cyjS8M",values:{domain:o},components:{0:e("i",{})}})})]})})}),e("footer",{children:[e("button",{type:"submit",disabled:a==="loading",children:e(u,{id:"4cijjm"})})," ",e("button",{type:"submit",class:"plain2",disabled:a==="loading",onClick:async()=>{try{await c.v1.accounts.$select(t.id).mute(),le(g._({id:"/BGBeF",values:{username:r}}))}catch{le(g._({id:"v02K7/",values:{username:r}}))}},children:e(u,{id:"caeqw/",components:{0:e("small",{class:"ib"})}})})," ",e("button",{type:"submit",class:"plain2",disabled:a==="loading",onClick:async()=>{try{await c.v1.accounts.$select(t.id).block(),le(g._({id:"kjUejn",values:{username:r}}))}catch{le(g._({id:"pMcdDp",values:{username:r}}))}},children:e(u,{id:"JybQca",components:{0:e("small",{class:"ib"})}})}),e(Le,{hidden:a!=="loading"})]})]})]})]})}var si={exports:{}},al=si.exports;(function(t){var n=function(){var i=String.fromCharCode,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",a={};function p(o,l){if(!a[o]){a[o]={};for(var m=0;m<o.length;m++)a[o][o.charAt(m)]=m}return a[o][l]}var r={compressToBase64:function(o){if(o==null)return"";var l=r._compress(o,6,function(m){return s.charAt(m)});switch(l.length%4){default:case 0:return l;case 1:return l+"===";case 2:return l+"==";case 3:return l+"="}},decompressFromBase64:function(o){return o==null?"":o==""?null:r._decompress(o.length,32,function(l){return p(s,o.charAt(l))})},compressToUTF16:function(o){return o==null?"":r._compress(o,15,function(l){return i(l+32)})+" "},decompressFromUTF16:function(o){return o==null?"":o==""?null:r._decompress(o.length,16384,function(l){return o.charCodeAt(l)-32})},compressToUint8Array:function(o){for(var l=r.compress(o),m=new Uint8Array(l.length*2),h=0,f=l.length;h<f;h++){var d=l.charCodeAt(h);m[h*2]=d>>>8,m[h*2+1]=d%256}return m},decompressFromUint8Array:function(o){if(o==null)return r.decompress(o);for(var l=new Array(o.length/2),m=0,h=l.length;m<h;m++)l[m]=o[m*2]*256+o[m*2+1];var f=[];return l.forEach(function(d){f.push(i(d))}),r.decompress(f.join(""))},compressToEncodedURIComponent:function(o){return o==null?"":r._compress(o,6,function(l){return c.charAt(l)})},decompressFromEncodedURIComponent:function(o){return o==null?"":o==""?null:(o=o.replace(/ /g,"+"),r._decompress(o.length,32,function(l){return p(c,o.charAt(l))}))},compress:function(o){return r._compress(o,16,function(l){return i(l)})},_compress:function(o,l,m){if(o==null)return"";var h,f,d={},v={},b="",w="",k="",y=2,I=3,_=2,C=[],T=0,x=0,U;for(U=0;U<o.length;U+=1)if(b=o.charAt(U),Object.prototype.hasOwnProperty.call(d,b)||(d[b]=I++,v[b]=!0),w=k+b,Object.prototype.hasOwnProperty.call(d,w))k=w;else{if(Object.prototype.hasOwnProperty.call(v,k)){if(k.charCodeAt(0)<256){for(h=0;h<_;h++)T=T<<1,x==l-1?(x=0,C.push(m(T)),T=0):x++;for(f=k.charCodeAt(0),h=0;h<8;h++)T=T<<1|f&1,x==l-1?(x=0,C.push(m(T)),T=0):x++,f=f>>1}else{for(f=1,h=0;h<_;h++)T=T<<1|f,x==l-1?(x=0,C.push(m(T)),T=0):x++,f=0;for(f=k.charCodeAt(0),h=0;h<16;h++)T=T<<1|f&1,x==l-1?(x=0,C.push(m(T)),T=0):x++,f=f>>1}y--,y==0&&(y=Math.pow(2,_),_++),delete v[k]}else for(f=d[k],h=0;h<_;h++)T=T<<1|f&1,x==l-1?(x=0,C.push(m(T)),T=0):x++,f=f>>1;y--,y==0&&(y=Math.pow(2,_),_++),d[w]=I++,k=String(b)}if(k!==""){if(Object.prototype.hasOwnProperty.call(v,k)){if(k.charCodeAt(0)<256){for(h=0;h<_;h++)T=T<<1,x==l-1?(x=0,C.push(m(T)),T=0):x++;for(f=k.charCodeAt(0),h=0;h<8;h++)T=T<<1|f&1,x==l-1?(x=0,C.push(m(T)),T=0):x++,f=f>>1}else{for(f=1,h=0;h<_;h++)T=T<<1|f,x==l-1?(x=0,C.push(m(T)),T=0):x++,f=0;for(f=k.charCodeAt(0),h=0;h<16;h++)T=T<<1|f&1,x==l-1?(x=0,C.push(m(T)),T=0):x++,f=f>>1}y--,y==0&&(y=Math.pow(2,_),_++),delete v[k]}else for(f=d[k],h=0;h<_;h++)T=T<<1|f&1,x==l-1?(x=0,C.push(m(T)),T=0):x++,f=f>>1;y--,y==0&&(y=Math.pow(2,_),_++)}for(f=2,h=0;h<_;h++)T=T<<1|f&1,x==l-1?(x=0,C.push(m(T)),T=0):x++,f=f>>1;for(;;)if(T=T<<1,x==l-1){C.push(m(T));break}else x++;return C.join("")},decompress:function(o){return o==null?"":o==""?null:r._decompress(o.length,32768,function(l){return o.charCodeAt(l)})},_decompress:function(o,l,m){var h=[],f,d=4,v=4,b=3,w="",k=[],y,I,_,C,T,x,U,M={val:m(0),position:l,index:1};for(y=0;y<3;y+=1)h[y]=y;for(_=0,T=Math.pow(2,2),x=1;x!=T;)C=M.val&M.position,M.position>>=1,M.position==0&&(M.position=l,M.val=m(M.index++)),_|=(C>0?1:0)*x,x<<=1;switch(f=_){case 0:for(_=0,T=Math.pow(2,8),x=1;x!=T;)C=M.val&M.position,M.position>>=1,M.position==0&&(M.position=l,M.val=m(M.index++)),_|=(C>0?1:0)*x,x<<=1;U=i(_);break;case 1:for(_=0,T=Math.pow(2,16),x=1;x!=T;)C=M.val&M.position,M.position>>=1,M.position==0&&(M.position=l,M.val=m(M.index++)),_|=(C>0?1:0)*x,x<<=1;U=i(_);break;case 2:return""}for(h[3]=U,I=U,k.push(U);;){if(M.index>o)return"";for(_=0,T=Math.pow(2,b),x=1;x!=T;)C=M.val&M.position,M.position>>=1,M.position==0&&(M.position=l,M.val=m(M.index++)),_|=(C>0?1:0)*x,x<<=1;switch(U=_){case 0:for(_=0,T=Math.pow(2,8),x=1;x!=T;)C=M.val&M.position,M.position>>=1,M.position==0&&(M.position=l,M.val=m(M.index++)),_|=(C>0?1:0)*x,x<<=1;h[v++]=i(_),U=v-1,d--;break;case 1:for(_=0,T=Math.pow(2,16),x=1;x!=T;)C=M.val&M.position,M.position>>=1,M.position==0&&(M.position=l,M.val=m(M.index++)),_|=(C>0?1:0)*x,x<<=1;h[v++]=i(_),U=v-1,d--;break;case 2:return k.join("")}if(d==0&&(d=Math.pow(2,b),b++),h[U])w=h[U];else if(U===v)w=I+I.charAt(0);else return null;k.push(w),h[v++]=I+w.charAt(0),d--,I=w,d==0&&(d=Math.pow(2,b),b++)}}};return r}();t!=null?t.exports=n:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return n})})(si);var Ii=si.exports;const Ea="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20fill='none'%20viewBox='0%200%2084%2062'%3e%3crect%20width='64'%20height='48'%20x='18'%20y='2'%20fill='%23fff'%20stroke='%23999'%20stroke-width='3'%20rx='4'/%3e%3crect%20width='32'%20height='48'%20x='2'%20y='12'%20fill='%23fff'%20stroke='%23999'%20stroke-width='3'%20rx='4'/%3e%3cpath%20fill='%234169E1'%20d='M14%2052a4%204%200%201%201-8%200%204%204%200%200%201%208%200Zm64-42a4%204%200%201%201-8%200%204%204%200%200%201%208%200Z'/%3e%3c/svg%3e",Ra="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20fill='none'%20viewBox='0%200%2082%2062'%3e%3crect%20width='78'%20height='58'%20x='2'%20y='2'%20fill='%23999'%20fill-opacity='.3'%20stroke='%23999'%20stroke-width='3'%20rx='4'/%3e%3crect%20width='18'%20height='46'%20x='8'%20y='8'%20fill='%23fff'%20stroke='%23999'%20stroke-width='2'%20rx='1'/%3e%3crect%20width='18'%20height='46'%20x='32'%20y='8'%20fill='%23fff'%20stroke='%23999'%20stroke-width='2'%20rx='1'/%3e%3crect%20width='18'%20height='46'%20x='56'%20y='8'%20fill='%23fff'%20stroke='%23999'%20stroke-width='2'%20rx='1'/%3e%3c/svg%3e",La="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20fill='none'%20viewBox='0%200%2084%2062'%3e%3crect%20width='64'%20height='48'%20x='18'%20y='2'%20fill='%23fff'%20stroke='%23999'%20stroke-width='3'%20rx='4'/%3e%3cpath%20fill='%23999'%20fill-opacity='.3'%20d='M19%203h62v10H19z'/%3e%3cpath%20stroke='%234169E1'%20stroke-width='2'%20d='M43%208a2%202%200%201%201-4%200%202%202%200%200%201%204%200Z'/%3e%3cpath%20stroke='%23999'%20stroke-width='2'%20d='M52%208a2%202%200%201%201-4%200%202%202%200%200%201%204%200Zm9%200a2%202%200%201%201-4%200%202%202%200%200%201%204%200Z'/%3e%3crect%20width='32'%20height='48'%20x='2'%20y='12'%20fill='%23fff'%20stroke='%23999'%20stroke-width='3'%20rx='4'/%3e%3cpath%20fill='%23999'%20fill-opacity='.3'%20d='M3%2049h30v10H3z'/%3e%3cpath%20stroke='%234169E1'%20stroke-width='2'%20d='M11%2054a2%202%200%201%201-4%200%202%202%200%200%201%204%200Z'/%3e%3cpath%20stroke='%23999'%20stroke-width='2'%20d='M20%2054a2%202%200%201%201-4%200%202%202%200%200%201%204%200Zm9%200a2%202%200%201%201-4%200%202%202%200%200%201%204%200Z'/%3e%3c/svg%3e",$a=200,Ma=10;async function yn(){const{masto:t}=se(),n=t.v1.followedTags.list({limit:$a}),i=[];let s=0;do{const{value:c,done:a}=await n.next();if(a||(c==null?void 0:c.length)===0)break;i.push(...c),s++}while(s<Ma);return i.sort((c,a)=>c.name.localeCompare(a.name)),i.length&&setTimeout(()=>{we.account.set("followedTags",{tags:i,updatedAt:Date.now()})},1),i}const Da=24*60*60*1e3;async function Pa(){try{const{tags:t,updatedAt:n}=we.account.get("followedTags")||{};return t!=null&&t.length?(Date.now()-n>Da&&yn(),t):await yn()}catch{return[]}}const Ci=document.createElement("div"),Na=t=>{if(!t)return[];if(t.indexOf("#")===-1)return[];Ci.innerHTML=t;const n=Ci.querySelectorAll("a.hashtag");return n.length?Array.from(n).map(i=>i.innerText.trim().replace(/^[^#]*#+/,"")):[]};function dn({children:t}){if(typeof t=="string")return t;const[n,i]=R("");return Q(()=>{Promise.resolve(t).then(i)},[t]),n}const gt=9,Oa=["following","mentions","notifications","list","public","trending","search","hashtag","bookmarks","favourites"],ws={following:{id:"7ZJHdw"},notifications:{id:"iDNBZe"},list:{id:"h16FyT"},public:{id:"tXgQpk"},search:{id:"A1taO8"},"account-statuses":{id:"AeXO77"},bookmarks:{id:"7Ff7ia"},favourites:{id:"zZOZj7"},hashtag:{id:"GP8RLS"},trending:{id:"4/iCqx"},mentions:{id:"/bZzdR"}},un={list:[{text:{id:"DUMt1y"},name:"id",notRequired:!0}],public:[{text:{id:"OgyJSr"},name:"local",type:"checkbox"},{text:{id:"kyAi7k"},name:"instance",type:"text",placeholder:{id:"7defFj"},notRequired:!0}],trending:[{text:{id:"kyAi7k"},name:"instance",type:"text",placeholder:{id:"7defFj"},notRequired:!0}],search:[{text:{id:"dmloPh"},name:"query",type:"text",placeholder:{id:"UHDQDE"},notRequired:!0}],"account-statuses":[{text:"@",name:"id",type:"text",placeholder:"cheeaun@mastodon.social"}],hashtag:[{text:"#",name:"hashtag",type:"text",placeholder:{id:"a6oTWs"},pattern:"[^#]+"},{text:{id:"eK4SL/"},name:"media",type:"checkbox"},{text:{id:"kyAi7k"},name:"instance",type:"text",placeholder:{id:"7defFj"},notRequired:!0}]},za=wt(async({id:t})=>{const n=await se().masto.v1.accounts.$select(t).fetch();return n.username||n.acct||n.displayName}),wn={following:{id:"home",title:(t,n)=>n===0?g._({id:"i0qMbr"}):g._({id:"y6sq5j"}),path:"/",icon:"home"},mentions:{id:"mentions",title:{id:"/bZzdR"},path:"/mentions",icon:"at"},notifications:{id:"notifications",title:{id:"iDNBZe"},path:"/notifications",icon:"notification"},list:{id:({id:t})=>t?"list":"lists",title:({id:t})=>t?ta(t):g._({id:"h16FyT"}),path:({id:t})=>t?`/l/${t}`:"/l",icon:"list",excludeViewMode:({id:t})=>t?[]:["multi-column"]},public:{id:"public",title:({local:t})=>t?g._({id:"d5zxa4"}):g._({id:"4ERYY7"}),subtitle:({instance:t})=>t||se().instance,path:({local:t,instance:n})=>`/${n}/p${t?"/l":""}`,icon:({local:t})=>t?"building":"earth"},trending:{id:"trending",title:{id:"4/iCqx"},subtitle:({instance:t})=>t||se().instance,path:({instance:t})=>`/${t}/trending`,icon:"chart"},search:{id:"search",title:({query:t})=>t?`“${t}”`:g._({id:"A1taO8"}),path:({query:t})=>t?`/search?q=${encodeURIComponent(t)}&type=statuses`:"/search",icon:"search",excludeViewMode:({query:t})=>t?[]:["multi-column"]},"account-statuses":{id:"account-statuses",title:za,path:({id:t})=>`/a/${t}`,icon:"user"},bookmarks:{id:"bookmarks",title:{id:"7Ff7ia"},path:"/b",icon:"bookmark"},favourites:{id:"favourites",title:{id:"zZOZj7"},path:"/f",icon:"heart"},hashtag:{id:"hashtag",title:({hashtag:t})=>t,subtitle:({instance:t})=>t||se().instance,path:({hashtag:t,instance:n,media:i})=>`${n?`/${n}`:""}/t/${t.split(/\s+/).join("+")}${i?"?media=1":""}`,icon:"hashtag"}};function Ua({onClose:t}){const{_:n}=et(),i=Fe(A),{shortcuts:s}=i,[c,a]=R(!1),[p,r]=R(!1),[o]=Jn();return e("div",{id:"shortcuts-settings-container",class:"sheet",tabindex:"-1",children:[!!t&&e("button",{type:"button",class:"sheet-close",onClick:t,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:[e(S,{icon:"shortcut"})," ",e(u,{id:"CTqTgr"})," ",e("sup",{style:{fontSize:12,opacity:.5,textTransform:"uppercase"},children:e(u,{id:"A1As8l"})})]})}),e("main",{children:[e("p",{children:e(u,{id:"CIHAsy"})}),e("div",{class:"shortcuts-view-mode",children:[{value:"float-button",label:g._({id:"qwdOim"}),imgURL:Ea},{value:"tab-menu-bar",label:g._({id:"UxBoCm"}),imgURL:La},{value:"multi-column",label:g._({id:"uvDfdW"}),imgURL:Ra}].map(({value:l,label:m,imgURL:h})=>{const f=i.settings.shortcutsViewMode===l||l==="float-button"&&!i.settings.shortcutsViewMode;return e("label",{class:f?"checked":"",children:[e("input",{type:"radio",name:"shortcuts-view-mode",value:l,checked:f,onChange:d=>{A.settings.shortcutsViewMode=d.target.value}})," ",e("img",{src:h,alt:"",width:"80",height:"58"})," ",e("span",{children:m})]},l)})}),s.length>0?e(O,{children:[e("ol",{class:"shortcuts-list",ref:o,children:s.filter(Boolean).map((l,m)=>{const h=Object.values(l).join("-"),{type:f}=l;if(!wn[f])return null;let{icon:d,title:v,subtitle:b,excludeViewMode:w}=wn[f];typeof v=="function"?v=v(l,m):v=n(v),typeof b=="function"?b=b(l,m):b=n(b),typeof d=="function"&&(d=d(l,m)),typeof w=="function"&&(w=w(l,m));const k=w==null?void 0:w.includes(i.settings.shortcutsViewMode);return e("li",{children:[e(S,{icon:d}),e("span",{class:"shortcut-text",children:[e(dn,{children:v}),b&&e(O,{children:[" ",e("small",{class:"ib insignificant",children:b})]}),k&&e("span",{class:"tag",children:e(u,{id:"5KJFnN"})})]}),e("span",{class:"shortcut-actions",children:[e("button",{type:"button",class:"plain small",disabled:m===0,onClick:()=>{const y=Array.from(A.shortcuts);if(m>0){const I=A.shortcuts[m-1];y[m-1]=l,y[m]=I,A.shortcuts=y}},children:e(S,{icon:"arrow-up",alt:g._({id:"QyioBP"})})}),e("button",{type:"button",class:"plain small",disabled:m===s.length-1,onClick:()=>{const y=Array.from(A.shortcuts);if(m<A.shortcuts.length-1){const I=A.shortcuts[m+1];y[m+1]=l,y[m]=I,A.shortcuts=y}},children:e(S,{icon:"arrow-down",alt:g._({id:"3Ib6FN"})})}),e("button",{type:"button",class:"plain small",onClick:()=>{a({shortcut:l,shortcutIndex:m})},children:e(S,{icon:"pencil",alt:g._({id:"ePK91l"})})})]})]},h)})}),s.length===1&&i.settings.shortcutsViewMode!=="float-button"&&e("div",{class:"ui-state insignificant",children:[e(S,{icon:"info"})," ",e("small",{children:e(u,{id:"3Xq4Zi"})})]})]}):e("div",{class:"ui-state insignificant",children:[e("p",{children:i.settings.shortcutsViewMode==="multi-column"?g._({id:"3xIN+E"}):g._({id:"vLxvHT"})}),e("p",{children:e(u,{id:"Fq4zw3",components:{0:e("br",{}),1:e("a",{href:"#",onClick:l=>{l.preventDefault(),A.shortcuts=[{type:"following"},{type:"notifications"}]}})}})})]}),e("p",{class:"insignificant",children:s.length>=gt&&(i.settings.shortcutsViewMode==="multi-column"?g._({id:"RqXfsz",values:{SHORTCUTS_LIMIT:gt}}):g._({id:"EVRO/o",values:{SHORTCUTS_LIMIT:gt}}))}),e("p",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e("button",{type:"button",class:"light",onClick:()=>r(!0),children:e(u,{id:"bgVLbt"})}),e("button",{type:"button",disabled:s.length>=gt,onClick:()=>a(!0),children:[e(S,{icon:"plus"})," ",e("span",{children:i.settings.shortcutsViewMode==="multi-column"?g._({id:"Vh3ADI"}):g._({id:"9tmn6W"})})]})]})]}),c&&e(Ne,{onClick:l=>{l.target===l.currentTarget&&a(!1)},children:e(Fa,{shortcut:c.shortcut,shortcutIndex:c.shortcutIndex,onSubmit:({result:l,mode:m})=>{m==="edit"?A.shortcuts[c.shortcutIndex]=l:A.shortcuts.push(l)},onClose:()=>a(!1)})}),p&&e(Ne,{onClick:l=>{l.target===l.currentTarget&&r(!1)},children:e(Ba,{shortcuts:s,onClose:()=>r(!1)})})]})}const Ti={list:{id:"1qL+L+"},search:{id:"dmTmkQ"},hashtag:{id:"E8laYz"}};function Fa({onSubmit:t,disabled:n,shortcut:i,shortcutIndex:s,onClose:c}){var w,k;const{_:a}=et(),p=!!i,[r,o]=R((i==null?void 0:i.type)||null),[l,m]=R("default"),[h,f]=R([]),[d,v]=R([]);Q(()=>{(async()=>{if(r==="list")try{m("loading");const y=await sn();f(y),m("default")}catch{m("error")}})(),(async()=>{if(r==="hashtag")try{const y=await yn();v(y)}catch{}})()},[r]);const b=Y();return Q(()=>{if(p&&r&&un[r]){const y=b.current;un[r].forEach(({name:I,type:_})=>{const C=y.querySelector(`[name="${I}"]`);C&&i[I]&&(_==="checkbox"?C.checked=i[I]==="on":C.value=i[I])})}},[p,r]),e("div",{id:"shortcut-settings-form",class:"sheet",children:[!!c&&e("button",{type:"button",class:"sheet-close",onClick:c,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:p?g._({id:"pe1jog"}):g._({id:"Lsxpe5"})})}),e("main",{tabindex:"-1",children:e("form",{ref:b,onSubmit:y=>{y.preventDefault();const I=new FormData(y.target),_={};I.forEach((C,T)=>{_[T]=C==null?void 0:C.trim(),T==="instance"&&(_[T]=_[T].replace(/^https?:\/\//,"").replace(/\/+$/,""),_[T]=_[T].replace(/^@?[^@]+@/,""))}),_.type&&(t({result:_,mode:p?"edit":"add"}),y.target.reset(),o(null),c==null||c())},children:[e("p",{children:e("label",{children:[e("span",{children:e(u,{id:"cklVjM"})}),e("select",{required:!0,disabled:n,onChange:y=>{o(y.target.value)},defaultValue:p?i.type:void 0,name:"type",dir:"auto",children:[e("option",{}),Oa.map(y=>e("option",{value:y,children:a(ws[y])}))]})]})}),(k=(w=un[r])==null?void 0:w.map)==null?void 0:k.call(w,({text:y,name:I,type:_,placeholder:C,pattern:T,notRequired:x})=>r==="list"?e("p",{children:e("label",{children:[e("span",{children:e(u,{id:"2BBAbc"})}),e("select",{name:"id",required:!x,disabled:n||l==="loading",defaultValue:p?i.id:void 0,dir:"auto",children:[e("option",{value:""}),h.map(U=>e("option",{value:U.id,children:U.title}))]})]})}):e("p",{children:e("label",{children:[e("span",{children:a(y)})," ",e("input",{type:_,switch:_==="checkbox"||void 0,name:I,placeholder:a(C),required:_==="text"&&!x,disabled:n,list:r==="hashtag"?"followed-hashtags-datalist":null,autocorrect:"off",autocapitalize:"off",spellCheck:!1,pattern:T,dir:"auto"}),r==="hashtag"&&d.length>0&&e("datalist",{id:"followed-hashtags-datalist",children:d.map(U=>e("option",{value:U.name}))})]})})),!!Ti[r]&&e("p",{class:"form-note insignificant",children:[e(S,{icon:"info"}),a(Ti[r])]}),e("footer",{children:[e("button",{type:"submit",class:"block",disabled:n||l==="loading",children:p?g._({id:"tfDRzk"}):g._({id:"m16xKo"})}),p&&e("button",{type:"button",class:"light danger",onClick:()=>{A.shortcuts.splice(s,1),c==null||c()},children:e(u,{id:"t/YqKh"})})]})]})})]})}function Ba({shortcuts:t,onClose:n}){var f;const{_:i}=et(),{masto:s}=se(),c=be(()=>!t||!t.filter(Boolean).length?"":Ii.compressToEncodedURIComponent(JSON.stringify(t.filter(Boolean))),[t]),[a,p]=R(""),[r,o]=R("default"),l=be(()=>{if(!a)return o("default"),null;try{const d=JSON.parse(Ii.decompressFromEncodedURIComponent(a));if(!Array.isArray(d))throw new Error("Not an array");return o("default"),d}catch{try{const v=JSON.parse(a);if(!Array.isArray(v))throw new Error("Not an array");return o("default"),v}catch{return o("error"),null}}},[a]),m=A.shortcuts.length>0,h=Y();return e("div",{id:"import-export-container",class:"sheet",children:[!!n&&e("button",{type:"button",class:"sheet-close",onClick:n,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(u,{id:"OOa7/5",components:{0:e("small",{class:"ib insignificant"})}})})}),e("main",{tabindex:"-1",children:[e("section",{children:[e("h3",{children:[e(S,{icon:"arrow-down-circle",size:"l",class:"insignificant"})," ",e("span",{children:e(u,{id:"l3s5ri"})})]}),e("p",{class:"field-button",children:[e("input",{ref:h,type:"text",name:"import",placeholder:g._({id:"tBmklN"}),class:"block",onInput:d=>{p(d.target.value)},dir:"auto"}),A.settings.shortcutSettingsCloudImportExport&&e("button",{type:"button",class:"plain2 small",disabled:r==="cloud-downloading",onClick:async()=>{o("cloud-downloading");const d=bt();le(g._({id:"HLqLGx"}));try{const b=(await s.v1.accounts.relationships.fetch({id:[d]}))[0];if(b){const{note:w=""}=b;if(/<phanpy-shortcuts-settings>(.*)<\/phanpy-shortcuts-settings>/.test(w)){const k=w.match(/<phanpy-shortcuts-settings>(.*)<\/phanpy-shortcuts-settings>/)[1],{v:y,dt:I,data:_}=JSON.parse(k);h.current.value=_,h.current.dispatchEvent(new Event("input"))}}o("default")}catch{o("error"),le(g._({id:"gCDfX+"}))}},title:g._({id:"B6cG3J"}),children:[e(S,{icon:"cloud"}),e(S,{icon:"arrow-down"})]})]}),!!l&&Array.isArray(l)&&e(O,{children:[e("p",{children:[e("b",{children:l.length})," shortcut",l.length>1?"s":""," ",e("small",{class:"insignificant",children:["(",a.length," characters)"]})]}),e("ol",{class:"import-settings-list",children:l.map(d=>{var v,b;return e("li",{children:[e("span",{style:{opacity:t.some(w=>Object.keys(w).every(k=>w[k]===d[k]))?1:0},children:"*"}),e("span",{children:[i(ws[d.type]),d.type==="list"&&" ⚠️"," ",(b=(v=un[d.type])==null?void 0:v.map)==null?void 0:b.call(v,({text:w,name:k,type:y})=>d[k]?e(O,{children:[e("span",{class:"tag collapsed insignificant",children:[w,":"," ",y==="checkbox"?d[k]==="on"?"✅":"❌":d[k]]})," "]}):null)]})]})})}),e("p",{children:[e("small",{children:e(u,{id:"o6sElH"})}),e("br",{}),e("small",{children:["⚠️"," ",e(u,{id:"N4z4P/"})]})]})]}),r==="error"&&e("p",{class:"error",children:e("small",{children:["⚠️ ",e(u,{id:"ZhsPEb"})]})}),e("p",{children:[m&&e(O,{children:[e(ot,{confirmLabel:g._({id:"6MzUUU"}),menuFooter:e("div",{class:"footer",children:e(u,{id:"nl8sCE"})}),onClick:()=>{const d=l.filter(w=>!A.shortcuts.some(k=>Object.keys(k).every(y=>k[y]===w[y])));if(!d.length){le(g._({id:"o6L30P"}));return}let v=[...A.shortcuts,...d];const b=v.length>gt;b&&(v=v.slice(0,gt)),A.shortcuts=v,le(b?g._({id:"SBmqmC",values:{SHORTCUTS_LIMIT:gt}}):g._({id:"QO9uTx"})),n==null||n()},children:e("button",{type:"button",class:"plain2",disabled:!l,children:e(u,{id:"c89gCv"})})})," "]}),e(ot,{confirmLabel:m?g._({id:"6ZjzWP"}):g._({id:"DWumLi"}),menuItemClassName:m?"danger":void 0,onClick:()=>{A.shortcuts=l,le(g._({id:"QO9uTx"})),n==null||n()},children:e("button",{type:"button",class:"plain2",disabled:!l,children:m?g._({id:"uIp8WL"}):g._({id:"Sjnlwj"})})})]})]}),e("section",{children:[e("h3",{children:[e(S,{icon:"arrow-up-circle",size:"l",class:"insignificant"})," ",e("span",{children:e(u,{id:"GS+Mus"})})]}),e("p",{children:e("input",{style:{width:"100%"},type:"text",value:c,readOnly:!0,onClick:d=>{if(d.target.value){d.target.select();try{navigator.clipboard.writeText(d.target.value),le(g._({id:"cWtH+v"}))}catch{le(g._({id:"yUWyHa"}))}}},dir:"auto"})}),e("p",{children:[e("button",{type:"button",class:"plain2",disabled:!c,onClick:()=>{try{navigator.clipboard.writeText(c),le(g._({id:"+Kq2vY"}))}catch{le(g._({id:"tFvxZF"}))}},children:[e(S,{icon:"clipboard"})," ",e("span",{children:e(u,{id:"he3ygx"})})]})," ",(navigator==null?void 0:navigator.share)&&((f=navigator==null?void 0:navigator.canShare)==null?void 0:f.call(navigator,{text:c}))&&e("button",{type:"button",class:"plain2",disabled:!c,onClick:()=>{try{navigator.share({text:c})}catch{alert(g._({id:"TtG3Uh"}))}},children:[e(S,{icon:"share"})," ",e("span",{children:e(u,{id:"Z8lGw6"})})]})," ",A.settings.shortcutSettingsCloudImportExport&&e("button",{type:"button",class:"plain2",disabled:r==="cloud-uploading",onClick:async()=>{o("cloud-uploading");const d=bt();try{const b=(await s.v1.accounts.relationships.fetch({id:[d]}))[0];if(b){const{note:w=""}=b;let k="";const y=JSON.stringify({v:"1",dt:Date.now(),data:c});/<phanpy-shortcuts-settings>(.*)<\/phanpy-shortcuts-settings>/.test(w)?k=w.replace(/<phanpy-shortcuts-settings>(.*)<\/phanpy-shortcuts-settings>/,`<phanpy-shortcuts-settings>${y}</phanpy-shortcuts-settings>`):k=`${w}


<phanpy-shortcuts-settings>${y}</phanpy-shortcuts-settings>`,le(g._({id:"9ZYiLz"})),await s.v1.accounts.$select(d).note.create({comment:k}),o("default"),le(g._({id:"5w02SH"}))}}catch{o("error"),le(g._({id:"aVsTYo"}))}},title:g._({id:"gWd6Cu"}),children:[e(S,{icon:"cloud"}),e(S,{icon:"arrow-up"})]})," ",c.length>0&&e("small",{class:"insignificant ib",children:e(u,{id:"IPXOXm",values:{0:c.length}})})]}),!!c&&e("details",{children:[e("summary",{class:"insignificant",children:e("small",{children:e(u,{id:"e5E+WH"})})}),e("textarea",{style:{width:"100%"},rows:10,readOnly:!0,children:JSON.stringify(t.filter(Boolean),null,2)})]})]}),A.settings.shortcutSettingsCloudImportExport&&e("footer",{children:e("p",{children:[e(S,{icon:"cloud"})," ",e(u,{id:"C4T6O/"})]})})]})]})}Gi(A,t=>{for(const[n,i,s,c]of t)/^show/i.test(i)&&!s&&Pn()});function qa(){var s,c,a,p,r,o,l,m;const t=Fe(A),n=Wi(),i=jt();return Q(()=>{setTimeout(js,1e3)},[]),e(O,{children:[!!t.showCompose&&e(Ne,{class:`solid ${t.composerState.minimized?"min":""}`,minimized:!!t.composerState.minimized,children:e(Vs,{replyToStatus:typeof t.showCompose!="boolean"?t.showCompose.replyToStatus:((s=window.__COMPOSE__)==null?void 0:s.replyToStatus)||null,editStatus:((c=A.showCompose)==null?void 0:c.editStatus)||((a=window.__COMPOSE__)==null?void 0:a.editStatus)||null,draftStatus:((p=A.showCompose)==null?void 0:p.draftStatus)||((r=window.__COMPOSE__)==null?void 0:r.draftStatus)||null,onClose:h=>{const{newStatus:f,instance:d,type:v}=h||{};A.showCompose=!1,window.__COMPOSE__=null,f&&(A.reloadStatusPage++,le({text:{post:g._({id:"aTyHBW"}),reply:g._({id:"lZdBKl"}),edit:g._({id:"a5BN7l"})}[v||"post"],delay:1e3,duration:1e4,onClick:b=>{b.hideToast(),A.prevLocation=i,n(d?`/${d}/s/${f.id}`:`/s/${f.id}`)}}))}})}),!!t.showSettings&&e(Ne,{onClose:()=>{A.showSettings=!1},children:e(Jc,{onClose:()=>{A.showSettings=!1}})}),!!t.showAccounts&&e(Ne,{onClose:()=>{A.showAccounts=!1},children:e(Bc,{onClose:()=>{A.showAccounts=!1}})}),!!t.showAccount&&e(Ne,{onClose:()=>{A.showAccount=!1},children:e(wa,{account:((o=t.showAccount)==null?void 0:o.account)||t.showAccount,instance:(l=t.showAccount)==null?void 0:l.instance,onClose:({destination:h}={})=>{A.showAccount=!1}})}),!!t.showDrafts&&e(Ne,{onClose:()=>{A.showDrafts=!1},children:e(ka,{onClose:()=>A.showDrafts=!1})}),!!t.showMediaModal&&e(Ne,{onClick:h=>{(h.target===h.currentTarget||h.target.classList.contains("media"))&&(A.showMediaModal=!1)},children:e(ys,{mediaAttachments:t.showMediaModal.mediaAttachments,instance:t.showMediaModal.instance,index:t.showMediaModal.index,statusID:t.showMediaModal.statusID,onClose:()=>{A.showMediaModal=!1}})}),!!t.showShortcutsSettings&&e(Ne,{onClose:()=>{A.showShortcutsSettings=!1},children:e(Ua,{onClose:()=>A.showShortcutsSettings=!1})}),!!t.showGenericAccounts&&e(Ne,{onClose:()=>{A.showGenericAccounts=!1},children:e(Ia,{instance:t.showGenericAccounts.instance,excludeRelationshipAttrs:t.showGenericAccounts.excludeRelationshipAttrs,postID:t.showGenericAccounts.postID,onClose:()=>A.showGenericAccounts=!1,blankCopy:t.showGenericAccounts.blankCopy})}),!!t.showMediaAlt&&e(Ne,{onClose:h=>{A.showMediaAlt=!1},children:e(Ca,{alt:t.showMediaAlt.alt||t.showMediaAlt,lang:(m=t.showMediaAlt)==null?void 0:m.lang,onClose:()=>{A.showMediaAlt=!1}})}),!!t.showEmbedModal&&e(Ne,{class:"solid",onClose:()=>{A.showEmbedModal=!1},children:e(Sa,{html:t.showEmbedModal.html,url:t.showEmbedModal.url,width:t.showEmbedModal.width,height:t.showEmbedModal.height,onClose:()=>{A.showEmbedModal=!1}})}),!!t.showReportModal&&e(Ne,{onClose:()=>{A.showReportModal=!1},children:e(Aa,{account:t.showReportModal.account,post:t.showReportModal.post,onClose:()=>{A.showReportModal=!1}})})]})}function On({accountID:t,onChange:n}){const{masto:i}=se(),[s,c]=R("default"),[a,p]=R(null),[r,o]=R(null),l=r!==null;return e("p",{class:"follow-request-buttons",children:[e("button",{type:"button",disabled:s==="loading"||l,onClick:()=>{c("loading"),p("accept"),(async()=>{try{const m=await i.v1.followRequests.$select(t).authorize();if(!(m!=null&&m.followedBy))throw new Error("Follow request not accepted");o(m),n()}catch{}c("default")})()},children:e(u,{id:"g3UF2V"})})," ",e("button",{type:"button",disabled:s==="loading"||l,class:"light danger",onClick:()=>{c("loading"),p("reject"),(async()=>{try{const m=await i.v1.followRequests.$select(t).reject();if(m!=null&&m.followedBy)throw new Error("Follow request not rejected");o(m),n()}catch{c("default")}})()},children:e(u,{id:"1t/NnN"})}),e("span",{class:"follow-request-states",children:l&&a?a==="accept"?e(S,{icon:"check-circle",alt:g._({id:"bzMKg7"}),class:"follow-accepted"}):e(S,{icon:"x-circle",alt:g._({id:"ekCRTP"}),class:"follow-rejected"}):e(Le,{hidden:s!=="loading"})})]})}const xi={mention:"comment",status:"notification",reblog:"rocket",follow:"follow",follow_request:"follow-add",favourite:"heart",poll:"poll",update:"pencil","admin.signup":"account-edit","admin.report":"account-warning",severed_relationships:"heart-break",moderation_warning:"alert",emoji_reaction:"emoji2","pleroma:emoji_reaction":"emoji2"};function Ai({account:t,emoji:n,emoji_url:i}){let s,c;typeof i=="string"?s=i:(s=i==null?void 0:i.url,c=i==null?void 0:i.staticUrl);const a=s?e(lc,{url:s,staticUrl:c,alt:n}):n;return e(u,{id:"i5uN6K",values:{account:t,emojiObject:a}})}const An={status:({account:t})=>e(u,{id:"idiIxW",values:{account:t}}),reblog:({count:t,account:n,postsCount:i,postType:s,components:{Subject:c}})=>e(u,{id:"kAldDH",values:{0:Ve(t),1:Ve(t),count:t,postsCount:i,postType:s,account:n},components:{0:e(c,{clickable:t>1}),1:e("span",{title:t}),2:e(c,{clickable:t>1}),3:e("span",{title:t})}}),follow:({account:t,count:n,components:{Subject:i}})=>e(u,{id:"04C2II",values:{0:Ve(n),count:n,account:t},components:{0:e(i,{clickable:n>1}),1:e("span",{title:n})}}),follow_request:({account:t})=>e(u,{id:"eh6NHW",values:{account:t}}),favourite:({account:t,count:n,postsCount:i,postType:s,components:{Subject:c}})=>e(u,{id:"6bBzBd",values:{0:Ve(n),1:Ve(n),count:n,postsCount:i,postType:s,account:t},components:{0:e(c,{clickable:n>1}),1:e("span",{title:n}),2:e(c,{clickable:n>1}),3:e("span",{title:n})}}),poll:()=>g._({id:"kIlJaS"}),"poll-self":()=>g._({id:"kpjzdN"}),"poll-voted":()=>g._({id:"moT7M8"}),update:()=>g._({id:"uzt17m"}),"favourite+reblog":({count:t,account:n,postsCount:i,postType:s,components:{Subject:c}})=>e(u,{id:"MJ69Yc",values:{0:Ve(t),1:Ve(t),count:t,postsCount:i,postType:s,account:n},components:{0:e(c,{clickable:t>1}),1:e("span",{title:t}),2:e(c,{clickable:t>1}),3:e("span",{title:t})}}),"admin.sign_up":({account:t})=>e(u,{id:"fJCCpx",values:{account:t}}),"admin.report":({account:t,targetAccount:n})=>e(u,{id:"eNfCmq",values:{account:t,targetAccount:n}}),severed_relationships:({name:t})=>e(u,{id:"Xl9v6+",values:{name:t},components:{0:e("i",{})}}),moderation_warning:()=>e("b",{children:e(u,{id:"YqffEv"})}),emoji_reaction:Ai,"pleroma:emoji_reaction":Ai},Ha={account_suspension:({from:t,targetName:n})=>e(u,{id:"uRkcgw",values:{from:t,targetName:n},components:{0:e("i",{}),1:e("i",{})}}),domain_block:({from:t,targetName:n,followersCount:i,followingCount:s})=>e(u,{id:"Q3yArs",values:{from:t,targetName:n,followersCount:i,followingCount:s},components:{0:e("i",{}),1:e("i",{})}}),user_domain_block:({targetName:t,followersCount:n,followingCount:i})=>e(u,{id:"RQKWUa",values:{targetName:t,followersCount:n,followingCount:i},components:{0:e("i",{})}})},Ya={none:{id:"ipnHrn"},disable:{id:"jw0eSZ"},mark_statuses_as_sensitive:{id:"v9jO+F"},delete_statuses:{id:"raUMBQ"},sensitive:{id:"w2OpMr"},silence:{id:"mlycBx"},suspend:{id:"Fz4lZ1"}},En=30;function ja({notification:t,instance:n,isStatic:i,disableContextMenu:s}){var N,P,B,V,F,ee;const{_:c}=et(),{id:a,status:p,account:r,report:o,event:l,moderation_warning:m,_ids:h,_accounts:f,_statuses:d,sampleAccounts:v,notificationsCount:b}=t;let{type:w}=t;if(w==="mention"&&!p)return null;const k=(p==null?void 0:p.reblog)||p,y=k==null?void 0:k.id,I=bt(),_=I===(r==null?void 0:r.id),C=(N=p==null?void 0:p.poll)==null?void 0:N.voted,T=!!(p!=null&&p.inReplyToAccountId)&&(p==null?void 0:p.inReplyToAccountId)!==I&&((P=p==null?void 0:p.account)==null?void 0:P.id)===I;let x=0,U=0;if(w==="favourite+reblog"){if(f)for(const z of f)(B=z._types)!=null&&B.includes("favourite")&&x++,(V=z._types)!=null&&V.includes("reblog")&&U++;!U&&x&&(w="favourite"),!x&&U&&(w="reblog")}let M;w==="poll"?M=An[_?"poll-self":C?"poll-voted":"poll"]:An[w]?M=An[w]:M=g._({id:"ODqZt1",values:{type:w}});const D=({clickable:z,...ie})=>z?e("b",{tabIndex:"0",onClick:J,...ie}):e("b",{...ie});if(typeof M=="function"){const z=(f==null?void 0:f.length)||(v==null?void 0:v.length)||(r?1:0),ie=(d==null?void 0:d.length)||0;if(w==="admin.report"){const pe=o==null?void 0:o.targetAccount;pe&&(M=M({account:e(At,{account:r,showAvatar:!0}),targetAccount:e(At,{account:pe,showAvatar:!0})}))}else if(w==="severed_relationships"){const pe=l==null?void 0:l.targetName;pe&&(M=M({name:pe}))}else if((w==="emoji_reaction"||w==="pleroma:emoji_reaction")&&t.emoji){const pe=t.emoji_url||((ee=(F=p==null?void 0:p.emojis)==null?void 0:F.find)==null?void 0:ee.call(F,ce=>(ce==null?void 0:ce.shortcode)===t.emoji.replace(/^:/,"").replace(/:$/,"")));M=M({emoji:t.emoji,emojiURL:pe})}else M=M({account:r&&e(At,{account:r,showAvatar:!0}),count:z,postsCount:ie,postType:T?"reply":"post",components:{Subject:D}})}const j=t.createdAt&&new Date(t.createdAt).toLocaleString(),te={"favourite+reblog":g._({id:"+XOeb+"}),favourite:g._({id:"LQFF6J"}),reblog:g._({id:"phQpSa"}),follow:g._({id:"Ih01jh"})}[w]||g._({id:"bPwFdf"}),J=()=>{A.showGenericAccounts={heading:te,accounts:f,showReactions:w==="favourite+reblog",excludeRelationshipAttrs:w==="follow"?["followedBy"]:[],postID:nt(y,n)}};return e("div",{class:`notification notification-${w}`,"data-notification-id":h||a,tabIndex:"0",children:[e("div",{class:`notification-type notification-${w}`,title:j,children:w==="favourite+reblog"?e(O,{children:[e(S,{icon:"rocket",size:"xl",alt:w,class:"reblog-icon"}),e(S,{icon:"heart",size:"xl",alt:w,class:"favourite-icon"})]}):e(S,{icon:xi[w]||"notification",size:"xl",alt:w})}),e("div",{class:"notification-content",children:[w!=="mention"&&e(O,{children:[e("p",{children:M}),w==="follow_request"&&e(On,{accountID:r.id}),w==="severed_relationships"&&e("div",{children:[Ha[l.type]({from:n,...l}),e("br",{}),e("a",{href:`https://${n}/severed_relationships`,target:"_blank",rel:"noopener noreferrer",children:e(u,{id:"YL6Y8P",components:{0:e(S,{icon:"external",size:"s"})}})}),"."]}),w==="moderation_warning"&&!!m&&e("div",{children:[c(Ya[m.action]()),e("br",{}),e("a",{href:`/disputes/strikes/${m.id}`,target:"_blank",rel:"noopener noreferrer",children:e(u,{id:"YL6Y8P",components:{0:e(S,{icon:"external",size:"s"})}})})]})]}),(f==null?void 0:f.length)>1&&e("p",{class:"avatars-stack",children:[f.slice(0,En).map(z=>e(O,{children:[e("a",{href:z.url,rel:"noopener noreferrer",class:"account-avatar-stack",onClick:ie=>{ie.preventDefault(),A.showAccount=z},children:[e(rt,{url:z.avatarStatic,size:f.length<=10?"xxl":f.length<20?"xl":"l",alt:`${z.displayName} @${z.acct}`,squircle:z==null?void 0:z.bot},z.id),w==="favourite+reblog"&&e("div",{class:"account-sub-icons",children:z._types.map(ie=>e(S,{icon:xi[ie],size:"s",class:`${ie}-icon`}))})]},z.id)," "]},z.id)),e("button",{type:"button",class:"small plain",onClick:J,children:[f.length>En&&`+${f.length-En}`,e(S,{icon:"chevron-down"})]})]}),!(f!=null&&f.length)&&(v==null?void 0:v.length)>1&&e("p",{class:"avatars-stack",children:[v.map(z=>e(O,{children:[e("a",{href:z.url,rel:"noopener noreferrer",class:"account-avatar-stack",onClick:ie=>{ie.preventDefault(),A.showAccount=z},children:e(rt,{url:z.avatarStatic,size:"xxl",alt:`${z.displayName} @${z.acct}`,squircle:z==null?void 0:z.bot},z.id)},z.id)," "]},z.id)),b>v.length&&e(de,{to:n?`/${n}/s/${p.id}`:`/s/${p.id}`,class:"button small plain centered",children:["+",b-v.length,e(S,{icon:"chevron-right"})]})]}),(d==null?void 0:d.length)>1&&e("ul",{class:"notification-group-statuses",children:d.map(z=>e("li",{children:e(Ei,{class:`status-link status-type-${w}`,to:n?`/${n}/s/${z.id}`:`/s/${z.id}`,children:e(qe,{status:z,size:"s",previewMode:!0,allowContextMenu:!0})})},z.id))}),p&&(!(d!=null&&d.length)||(d==null?void 0:d.length)<=1)&&e(Ei,{class:`status-link status-type-${w}`,to:n?`/${n}/s/${y}`:`/s/${y}`,onContextMenu:s?void 0:z=>{const ie=z.target.querySelector(".status");if(ie){if(z.metaKey)return;z.preventDefault(),ie.dispatchEvent(new MouseEvent("contextmenu",{clientX:z.clientX,clientY:z.clientY}))}},children:i?e(qe,{status:k,size:"s",readOnly:!0,allowContextMenu:!0}):e(qe,{statusID:y,size:"s",readOnly:!0,allowContextMenu:!0})})]})]})}function Ei(t){const n=dc();return e(de,{...t,"data-read-more":g._({id:"8fZueG"}),ref:n})}const Sn=st(ja,(t,n)=>{var i,s;return((i=t.notification)==null?void 0:i.id)===((s=n.notification)==null?void 0:s.id)});"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",t=>{const{type:n,id:i,accessToken:s}=(t==null?void 0:t.data)||{};n==="notification"&&(A.routeNotification={id:i,accessToken:s})});const Va=st(function(){if(!("serviceWorker"in navigator))return null;const n=Fe(A),{routeNotification:i}=n,{id:s,accessToken:c}=i||{},[a,p]=R(!1);vt(()=>{if(!s||!c)return;const{instance:o}=se(),{masto:l,instance:m}=se({accessToken:c}),h=o===m,f=c?Gs(c):Ft();(async()=>{const d=await l.v1.notifications.$select(s).fetch();if(d&&f){const v=f.instanceURL,{type:b,status:w,account:k}=d,y=!!document.querySelector("#modal-container > *"),I=b==="follow"&&!!(k!=null&&k.id),_=!!(k!=null&&k.id),C=!!(w!=null&&w.id);I&&h?A.showAccount={account:k,instance:v}:y||!h||_&&C?p({id:s,account:f,notification:d,sameInstance:h}):C?location.hash=`/${o}/s/${w.id}`:I?location.hash=`/${o}/a/${k.id}`:location.hash="/notifications"}})()},[s,c]),vt(()=>{navigator!=null&&navigator.clearAppBadge&&navigator.clearAppBadge()},[]),Bt(o=>{o&&(navigator!=null&&navigator.clearAppBadge)&&navigator.clearAppBadge()});const r=()=>{p(!1),A.routeNotification=null,/\/notifications\?id=/i.test(location.hash)&&(location.hash="/notifications")};if(a){const{id:o,account:l,notification:m,sameInstance:h}=a;return e(Ne,{onClick:f=>{f.target===f.currentTarget&&r()},children:e("div",{class:"sheet",tabIndex:"-1",children:[e("button",{type:"button",class:"sheet-close",onClick:r,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:e("b",{children:e(u,{id:"5+87Pq"})})}),e("main",{children:[!h&&e("p",{children:e(u,{id:"k9N0Xk"})}),e("div",{class:"notification-peek",onClick:f=>{const{target:d}=f;(f.target.tagName==="BUTTON"||f.target.tagName==="A")&&r()},children:e(Sn,{instance:l.instanceURL,notification:m,isStatic:!0})}),e("div",{style:{textAlign:"end"},children:e(de,{to:"/notifications",class:"button light",onClick:r,children:[e("span",{children:e(u,{id:"/WA/tl"})})," ",e(S,{icon:"arrow-right"})]})})]})]})})}return null}),ks=Ks((t,n)=>{const{instance:i}=se(),[s,c]=dt(),[a,p]=R(!1),[r,o]=R(s.get("q")||""),l=s.get("type"),m=Y(null),h=Y(null);return Ws(n,()=>({setValue:f=>{o(f)},focus:()=>{h.current.focus()},select:()=>{h.current.select()},blur:()=>{h.current.blur()}})),e("form",{ref:m,class:"search-popover-container",onSubmit:f=>{var v;if(f.preventDefault(),/\/search/.test(location.hash))if(r){const b={q:r};l&&(b.type=l),c(b)}else c({});else r?location.hash=`/search?q=${encodeURIComponent(r)}${l?`&type=${l}`:""}`:location.hash="/search";(v=t==null?void 0:t.onSubmit)==null||v.call(t,f)},children:[e("input",{ref:h,value:r,name:"q",type:"search",placeholder:g._({id:"A1taO8"}),dir:"auto",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellCheck:"false",onSearch:f=>{f.target.value||c({})},onInput:f=>{o(f.target.value),p(!0)},onFocus:()=>{var f,d;p(!0),(d=(f=m.current)==null?void 0:f.querySelector(".search-popover-item"))==null||d.classList.add("focus")},onBlur:()=>{var f,d;setTimeout(()=>{p(!1)},100),(d=(f=m.current)==null?void 0:f.querySelector(".search-popover-item.focus"))==null||d.classList.remove("focus")},onKeyDown:f=>{var v;const{key:d}=f;switch(d){case"Escape":p(!1);break;case"Down":case"ArrowDown":if(f.preventDefault(),a){const b=m.current.querySelector(".search-popover-item.focus");if(b){let w=b.nextElementSibling;for(;w&&w.hidden;)w=w.nextElementSibling;w&&(w.classList.add("focus"),Array.from(w.parentElement.children).filter(y=>y!==w).forEach(y=>{y.classList.remove("focus")}))}else{const w=m.current.querySelector(".search-popover-item");w&&w.classList.add("focus")}}break;case"Up":case"ArrowUp":if(f.preventDefault(),a){const b=document.querySelector(".search-popover-item.focus");if(b){let w=b.previousElementSibling;for(;w&&w.hidden;)w=w.previousElementSibling;w&&(w.classList.add("focus"),Array.from(w.parentElement.children).filter(y=>y!==w).forEach(y=>{y.classList.remove("focus")}))}else{const w=document.querySelector(".search-popover-item:last-child");w&&w.classList.add("focus")}}break;case"Enter":if(a){const b=document.querySelector(".search-popover-item.focus");b&&(f.preventDefault(),b.click()),p(!1),(v=t==null?void 0:t.onSubmit)==null||v.call(t,f)}break}}}),e("div",{class:"search-popover",hidden:!a||!r,children:!!r&&[{label:e(u,{id:"48oDit",values:{query:r},components:{0:e("small",{class:"insignificant"})}}),to:`/search?q=${encodeURIComponent(r)}`,top:!l&&!/\s/.test(r),hidden:!!l},{label:e(u,{id:"o1mMWT",values:{query:r},components:{0:e("q",{})}}),to:`/search?q=${encodeURIComponent(r)}&type=statuses`,hidden:/^https?:/.test(r),top:/\s/.test(r),icon:"document",queryType:"statuses"},{label:e(u,{id:"YAZw8D",values:{0:r.replace(/^#/,"")},components:{0:e("mark",{})}}),to:`/${i}/t/${r.replace(/^#/,"")}`,hidden:/^@/.test(r)||/^https?:/.test(r)||/\s/.test(r),top:/^#/.test(r),type:"link",icon:"hashtag",queryType:"hashtags"},{label:e(u,{id:"gEoOUj",values:{query:r},components:{0:e("mark",{})}}),to:`/${r}`,hidden:!/^https?:/.test(r),top:/^https?:/.test(r),type:"link"},{label:e(u,{id:"cDoNQr",values:{query:r},components:{0:e("q",{})}}),to:`/search?q=${encodeURIComponent(r)}&type=accounts`,icon:"group",queryType:"accounts"}].sort((f,d)=>{if(l){if(f.queryType===l)return-1;if(d.queryType===l)return 1}return f.top&&!d.top?-1:!f.top&&d.top?1:0}).filter(({hidden:f})=>!f).map(({label:f,to:d,icon:v,type:b},w)=>e(de,{to:d,class:`search-popover-item ${w===0?"focus":""}`,onClick:k=>{var y;(y=t==null?void 0:t.onSubmit)==null||y.call(t,k)},children:[e(S,{icon:v||(b==="link"?"arrow-right":"search"),class:"more-insignificant"}),e("span",{children:f})," "]}))})]})}),Ga=st(function({onClose:n=()=>{}}){const[i,s]=R(!1),c=Y(null);Ue(["Slash","/"],p=>{s(!0),setTimeout(()=>{var r,o,l,m;(o=(r=c.current)==null?void 0:r.focus)==null||o.call(r),(m=(l=c.current)==null?void 0:l.select)==null||m.call(l)},0)},{preventDefault:!0,ignoreEventWhen:p=>{const r=/\/search/.test(location.hash),o=!!document.querySelector("#modal-container > *");return r||o}});const a=()=>{s(!1),n()};return Ue("esc",p=>{var r,o;(o=(r=c.current)==null?void 0:r.blur)==null||o.call(r),a()},{enabled:i,enableOnFormTags:!0,preventDefault:!0}),e("div",{id:"search-command-container",hidden:!i,onClick:p=>{p.target===p.currentTarget&&a()},children:e(ks,{ref:c,onSubmit:()=>{a()}})})});function Wa(){const{_:t}=et(),{instance:n}=se(),i=Fe(A),{shortcuts:s,settings:c}=i;if(!s.length||c.shortcutsViewMode==="multi-column"||!c.shortcutsViewMode&&c.shortcutsColumnsMode)return null;const a=Y(),p=Y(!1),r=s.map((h,f)=>{const{type:d,...v}=h;if(!wn[d])return null;let{id:b,path:w,title:k,subtitle:y,icon:I}=wn[d];return typeof b=="function"&&(b=b(v,f)),typeof w=="function"&&(w=w({...v,instance:v.instance||n},f)),typeof k=="function"?k=k(v,f):k=t(k),typeof y=="function"?y=y(v,f):y=t(y),typeof I=="function"&&(I=I(v,f)),b==="lists"&&(p.current=!0),{id:b,path:w,title:k,subtitle:y,icon:I}}).filter(Boolean),o=Wi();Ue(["1","2","3","4","5","6","7","8","9"],(h,f)=>{var v,b;const d=parseInt(f.keys[0],10)-1;if(d<r.length){const{path:w}=r[d];w&&(o(w),(b=(v=a.current)==null?void 0:v.closeMenu)==null||b.call(v))}});const[l,m]=R([]);return e("div",{id:"shortcuts",children:i.settings.shortcutsViewMode==="tab-menu-bar"?e("nav",{class:"tab-bar",onContextMenu:h=>{h.preventDefault(),A.showShortcutsSettings=!0},children:e("ul",{children:r.map(({id:h,path:f,title:d,subtitle:v,icon:b},w)=>e("li",{children:e(de,{class:v?"has-subtitle":"",to:f,onClick:k=>{if(k.target.classList.contains("is-active")){k.preventDefault();const y=document.getElementById(`${h}-page`);if(y){y.scrollTop=0;const I=y.querySelector(".updates-button");I&&I.click()}}},children:[e(S,{icon:b,size:"xl",alt:d}),e("span",{children:[e(dn,{children:d}),v&&e(O,{children:[e("br",{}),e("small",{children:v})]})]})]})},`${w}-${h}-${d}-${v}-${f}`))})}):e(it,{instanceRef:a,overflow:"auto",viewScroll:"close",menuClassName:"glass-menu shortcuts-menu",gap:8,position:"anchor",onMenuChange:h=>{h.open&&p.current&&sn().then(m)},menuButton:e("button",{type:"button",id:"shortcuts-button",class:"plain",onContextMenu:h=>{h.preventDefault(),A.showShortcutsSettings=!0},onTransitionStart:h=>{var f,d;try{const{target:v}=h;getComputedStyle(v).pointerEvents==="none"&&((d=(f=a.current)==null?void 0:f.closeMenu)==null||d.call(f))}catch{}},children:e(S,{icon:"shortcut",size:"xl",alt:g._({id:"CTqTgr"})})}),children:r.map(({id:h,path:f,title:d,subtitle:v,icon:b},w)=>h==="lists"?e(gn,{menuClassName:"glass-menu",overflow:"auto",gap:-8,label:e(O,{children:[e(S,{icon:b,size:"l"}),e("span",{class:"menu-grow",children:e(dn,{children:d})}),e(S,{icon:"chevron-right"})]}),children:[e(ze,{to:"/l",children:e("span",{children:e(u,{id:"BHWx+g"})})}),e(je,{}),l==null?void 0:l.map(k=>e(ze,{to:`/l/${k.id}`,children:e("span",{children:k.title})},k.id))]}):e(ze,{to:f,class:"glass-menu-item",children:[e(S,{icon:b,size:"l"})," ",e("span",{class:"menu-grow",children:[e("span",{children:e(dn,{children:d})}),v&&e(O,{children:[" ",e("small",{class:"more-insignificant",children:v})]})]}),e("span",{class:"menu-shortcut hide-until-focus-visible",children:w+1})]},`${w}-${h}-${d}-${v}-${f}`))})})}const Ka=st(Wa);function Za(t){var c;let n=[],i=[],s=0;for(let a=0;a<t.length;a++){const p=t[a];p.reblog&&!((c=p.account)!=null&&c.group)?(i.push(p),s++):(n.push(p),s<3&&(s=0))}if(t.length>10&&(i.length>t.length/4||s>=3)){const a=i.map(p=>p.id);if(i.length>t.length*3/4)n=[...n,{id:a,items:i,type:"boosts"}];else{const p=Math.floor(n.length/2);n=[...n.slice(0,p),{id:a,items:i,type:"boosts"},...n.slice(p)]}return n}else return t}function Ri(t,n){const i=we.account.get("boostedStatusIDs")||{},s=t.filter(a=>{if(!a.reblog)return!0;const p=`${n}-${a.reblog.id}`,r=i[p];return r&&r!==a.id?!1:(i[p]=a.id,!0)}),c=Object.keys(i);return c.length>50&&c.slice(0,c.length-50).forEach(a=>{delete i[a]}),we.account.set("boostedStatusIDs",i),s}function Ja(t,n){const i=[];let s=0;t.forEach(r=>{for(let l=0;l<i.length;l++){if(i[l].find(m=>m.id===r.id))return;if(i[l].find(m=>m.id===r.inReplyToId)||i[l].find(m=>m.inReplyToId===r.id)){i[l].push(r);return}}const o=t.find(l=>l.id===r.inReplyToId);o&&(i[s++]=[r,o])});for(let r=0;r<i.length;r++)for(let o=r+1;o<i.length;o++)i[r].find(m=>i[o].includes(m))&&(i[r]=[...i[r],...i[o]],i[r]=i[r].filter((m,h,f)=>f.findIndex(d=>d.id===m.id)===h),i.splice(o,1),o--);i.forEach(r=>{r.sort((o,l)=>!o.inReplyToId&&!l.inReplyToId?new Date(o.createdAt)-new Date(l.createdAt):o.inReplyToId===l.id?1:l.inReplyToId===o.id||!o.inReplyToId?-1:l.inReplyToId?new Date(o.createdAt)-new Date(l.createdAt):1)}),i.forEach(r=>{const o=r[0].account.id;r.forEach(l=>{l.account.id!==o&&(l._differentAuthor=!0)})}),i.length;const c=[],a=[],p=[];return t.forEach(r=>{if(r.reblog){c.push(r);return}for(let o=0;o<i.length;o++)if(i[o].find(l=>l.id===r.id)){if(a.includes(o))return;const l=i[o];l.sort((h,f)=>{const d=new Date(h.createdAt),v=new Date(f.createdAt);return d-v});const m=l[0].account.id;c.push({id:l.map(h=>h.id),items:l,type:l.every(h=>h.account.id===m)?"thread":"conversation"}),a.push(o);return}if(r.inReplyToId&&r.inReplyToAccountId!==r.account.id){const o=nt(r.id,n);A.statusReply[o]||p.push({sKey:o,inReplyToId:r.inReplyToId})}c.push(r)}),p!=null&&p.length&&queueMicrotask(()=>{const{masto:r}=se({instance:n});async function o(){for(let l=0;l<p.length;l++){const{sKey:m,inReplyToId:h}=p[l];try{const f=await Xa(h,r);Ge(f,n,{skipThreading:!0}),A.statusReply[m]={id:f.id,instance:n},await new Promise(d=>setTimeout(d,1e3))}catch{}}}if(Ke("@mastodon/fetch-multiple-statuses")){const l=p.map(({inReplyToId:m})=>m);(async()=>{var m;try{const h=await r.v1.statuses.list({id:l});if(h!=null&&h.length)for(const f of h){Ge(f,n,{skipThreading:!0});const d=(m=p.find(({inReplyToId:v})=>v===f.id))==null?void 0:m.sKey;d&&(A.statusReply[d]={id:f.id,instance:n})}else o()}catch{o()}})()}else o()}),c}const Xa=wt((t,n)=>n.v1.statuses.$select(t).fetch());async function _s(t,n){const i=await Pa();if(!i.length)return;const{statusFollowedTags:s}=A,c=[];if(t.forEach(a=>{var f;if(a.reblog)return;const{id:p,content:r,tags:o=[]}=a,l=nt(p,n);if((f=s[l])!=null&&f.length)return;const m=Na(r);if(!m.length&&!o.length)return;const h=i.reduce((d,v)=>((m.some(b=>b.toLowerCase()===v.name.toLowerCase())||o.some(b=>b.name.toLowerCase()===v.name.toLowerCase()))&&d.push(v.name),d),[]);h.length&&c.push({item:a,sKey:l,followedTags:h})}),c.length){const a=c.map(r=>r.item.account),p=await Yn(a);if(!p)return;c.forEach(r=>{const{item:o,sKey:l,followedTags:m}=r,h=p[o.account.id];h&&!h.following&&(s[l]=m)})}}function Qa(){A.statusFollowedTags={}}function eo({scrollableRef:t,distanceFromStart:n=1,distanceFromEnd:i=1,scrollThresholdStart:s=10,scrollThresholdEnd:c=10,direction:a="vertical",distanceFromStartPx:p,distanceFromEndPx:r}={}){const[o,l]=R(null),[m,h]=R(!1),[f,d]=R(!1),[v,b]=R(!1),[w,k]=R(!1),y=a==="vertical";return vt(()=>{const I=t.current;if(!I)return{};let _=y?I.scrollTop:I.scrollLeft;function C(){const{scrollTop:T,scrollLeft:x,scrollHeight:U,scrollWidth:M,clientHeight:D,clientWidth:j}=I,te=y?T:x,J=y?U:M,N=y?D:j,P=Math.abs(te-_),B=p||Math.min(N*n,J,te),V=r||Math.min(N*i,J,J-te-N);P>=(_<te?c:s)&&(l(_<te?"end":"start"),_=te),h(te<=0),d(te+N>=J),b(te<=B),k(te+N>=J-V)}return I.addEventListener("scroll",C,{passive:!0}),()=>I.removeEventListener("scroll",C)},[n,i,s,c]),{scrollDirection:o,reachStart:m,reachEnd:f,nearReachStart:v,nearReachEnd:w,init:()=>{t.current&&t.current.dispatchEvent(new Event("scroll"))}}}function to({scrollableRef:t,distanceFromStart:n=1,distanceFromEnd:i=1,scrollThresholdStart:s=10,scrollThresholdEnd:c=10,direction:a="vertical",distanceFromStartPx:p,distanceFromEndPx:r,init:o}={},l,m){if(!l)return;const h=a==="vertical",f=Y(null),d=Y(null),v=uc(()=>{let b=!1,w=!1,k=!1,y=!1;const I=t.current,{scrollTop:_,scrollLeft:C,scrollHeight:T,scrollWidth:x,clientHeight:U,clientWidth:M}=I,D=h?_:C,j=h?T:x,te=h?U:M,J=Math.abs(D-f.current),N=p||Math.min(te*n,j,D),P=r||Math.min(te*i,j,j-D-te);J>=(f.current<D?c:s)&&(d.current=f.current<D?"end":"start",f.current=D),b=D<=0,w=D+te>=j,k=D<=N,y=D+te>=j-P,l({scrollDirection:d.current,reachStart:b,reachEnd:w,nearReachStart:k,nearReachEnd:y})},500);vt(()=>{const b=t.current;return b?(f.current=b[h?"scrollTop":"scrollLeft"],b.addEventListener("scroll",v,{passive:!0}),()=>b.removeEventListener("scroll",v)):{}},[n,i,s,c,...m]),Q(()=>{o&&t.current&&queueMicrotask(()=>{t.current.dispatchEvent(new Event("scroll"))})},[o])}function no({class:t,statusID:n,status:i,instance:s,parent:c,onMediaClick:a}){let p=nt(n,s);const r=Fe(A);if(i||(i=r.statuses[p]||r.statuses[n],p=nt(i==null?void 0:i.id,s)),!i)return null;const{account:{acct:o,avatar:l,avatarStatic:m,id:h,url:f,displayName:d,username:v,emojis:b,bot:w,group:k},id:y,repliesCount:I,reblogged:_,reblogsCount:C,favourited:T,favouritesCount:x,bookmarked:U,poll:M,muted:D,sensitive:j,spoilerText:te,visibility:J,language:N,editedAt:P,filtered:B,card:V,createdAt:F,inReplyToId:ee,inReplyToAccountId:z,content:ie,mentions:pe,mediaAttachments:ce,reblog:he,uri:ve,url:fe,emojis:_e,_deleted:$e,_pinned:Me}=i;if(!(ce!=null&&ce.length))return null;const Ce=G=>{G.shiftKey},De=be(()=>bt(),[]),Oe=be(()=>De&&De===h,[h,De]),ye=Zs(ns),X=!Oe&&en(B,ye);if((X==null?void 0:X.action)==="hide")return null;const me=j,oe=be(()=>{var L;return((L=(we.account.get("preferences")||{})["reading:expand:media"])==null?void 0:L.toLowerCase())||"default"},[])==="show_all",E=c||"div";return ce.map((G,L)=>{const H=`${p}-${G.id}`,K=X==null?void 0:X.titlesStr;return e(E,{"data-state-post-id":p,onMouseEnter:Ce,"data-spoiler-text":te||(j?g._({id:"FKojeB"}):void 0),"data-filtered-text":X?K?g._({id:"7FGvtQ",values:{filterTitleStr:K}}):g._({id:"03Qqf9"}):void 0,class:`
          media-post
          ${X?"filtered":""}
          ${me?"has-spoiler":""}
          ${oe?"show-media":""}
        `,children:e(ts,{class:t,media:G,lang:N,to:`/${s}/s/${y}?media-only=${L+1}`,onClick:a?ue=>a(ue,L,G,i):void 0})},H)})}const Li=st(no);function io(t){var C,T,x,U,M;const n=Fe(A),{masto:i,instance:s,authenticated:c}=se(),[a,p]=be(()=>{const D=we.local.getJSON("accounts")||[];return[D.find(te=>te.info.id===bt())||D[0],D.length>1]},[]),r=(n.settings.shortcutsViewMode==="multi-column"||!n.settings.shortcutsViewMode&&n.settings.shortcutsColumnsMode)&&!n.shortcuts.find(D=>D.type==="following"),o=hc(()=>{A.showAccounts=!0},{threshold:600,detect:"touch",cancelOnMovement:!0}),l=Y(),[m,h]=R(void 0),f=fc([0,0,n.settings.shortcutsViewMode==="tab-menu-bar"?50:0,0]),d=Y();async function v(D){return(D||!d.current)&&(d.current=i.v1.mutes.list({limit:80})),await d.current.next()}const b=Y();async function w(D){return(D||!b.current)&&(b.current=i.v1.blocks.list({limit:80})),await b.current.next()}const k=Ke("@mastodon/lists"),[y,I]=R([]);Q(()=>{k&&m==="open"&&sn().then(I)},[m==="open"]);const _=Y();return e(O,{children:[e("button",{ref:l,type:"button",class:`button plain nav-menu-button ${p?"with-avatar":""} ${m==="open"?"active":""}`,style:{position:"relative"},onClick:()=>{_.current=Date.now(),h(D=>D?void 0:"open")},onContextMenu:D=>{D.preventDefault(),A.showAccounts=!0},...o(),children:[p&&e(rt,{url:((C=a==null?void 0:a.info)==null?void 0:C.avatar)||((T=a==null?void 0:a.info)==null?void 0:T.avatarStatic),size:"l",squircle:(x=a==null?void 0:a.info)==null?void 0:x.bot}),e(S,{icon:"menu",size:p?"s":"l",alt:g._({id:"zucql+"})})]}),e(is,{menuClassName:"nav-menu",state:m,anchorRef:l,onClose:()=>{h(void 0)},containerProps:{style:{zIndex:10},onClick:()=>{Date.now()-_.current<300}},portal:{target:document.body},...t,overflow:"auto",viewScroll:"close",position:"anchor",align:"center",boundingBoxPadding:f,unmountOnClose:!0,children:[!!((U=n.appVersion)!=null&&U.commitHash)&&n.appVersion.commitHash!=="bff9a84"&&e("div",{class:"top-menu",children:[e(ge,{onClick:()=>{confirm(g._({id:"Djbaby"}))&&(async()=>{try{location.reload()}catch{}})()},children:[e(S,{icon:"sparkles",class:"sparkle-icon",size:"l"})," ",e("span",{children:e(u,{id:"95IFnD"})})]}),e(je,{})]}),e("section",{children:[e(ze,{to:"/",children:[e(S,{icon:"home",size:"l"})," ",e("span",{children:e(u,{id:"i0qMbr"})})]}),c?e(O,{children:[r&&e(ze,{to:"/following",children:[e(S,{icon:"following",size:"l"})," ",e("span",{children:e(u,{id:"y6sq5j"})})]}),e(ze,{to:"/catchup",children:[e(S,{icon:"history2",size:"l"}),e("span",{children:e(u,{id:"xrl8fj"})})]}),Ke("@mastodon/mentions")&&e(ze,{to:"/mentions",children:[e(S,{icon:"at",size:"l"})," ",e("span",{children:e(u,{id:"/bZzdR"})})]}),e(ze,{to:"/notifications",children:[e(S,{icon:"notification",size:"l"})," ",e("span",{children:e(u,{id:"iDNBZe"})}),n.notificationsShowNew&&e("sup",{title:g._({id:"isRobC"}),style:{opacity:.5},children:[" ","•"]})]}),e(je,{}),((M=a==null?void 0:a.info)==null?void 0:M.id)&&e(ze,{to:`/${s}/a/${a.info.id}`,children:[e(S,{icon:"user",size:"l"})," ",e("span",{children:e(u,{id:"vERlcd"})})]}),(y==null?void 0:y.length)>0?e(gn,{menuClassName:"nav-submenu",overflow:"auto",gap:-8,label:e(O,{children:[e(S,{icon:"list",size:"l"}),e("span",{class:"menu-grow",children:e(u,{id:"h16FyT"})}),e(S,{icon:"chevron-right"})]}),children:[e(ze,{to:"/l",children:e("span",{children:e(u,{id:"BHWx+g"})})}),(y==null?void 0:y.length)>0&&e(O,{children:[e(je,{}),y.map(D=>e(ze,{to:`/l/${D.id}`,children:e("span",{children:D.title})},D.id))]})]}):k&&e(ze,{to:"/l",children:[e(S,{icon:"list",size:"l"}),e("span",{children:e(u,{id:"h16FyT"})})]}),e(ze,{to:"/b",children:[e(S,{icon:"bookmark",size:"l"})," ",e("span",{children:e(u,{id:"7Ff7ia"})})]}),e(gn,{menuClassName:"nav-submenu",overflow:"auto",gap:-8,label:e(O,{children:[e(S,{icon:"more",size:"l"}),e("span",{class:"menu-grow",children:e(u,{id:"24misb"})}),e(S,{icon:"chevron-right"})]}),children:[e(ze,{to:"/f",children:[e(S,{icon:"heart",size:"l"})," ",e("span",{children:e(u,{id:"zZOZj7"})})]}),e(ze,{to:"/fh",children:[e(S,{icon:"hashtag",size:"l"})," ",e("span",{children:e(u,{id:"Xi1/bw"})})]}),e(je,{}),Ke("@mastodon/filters")&&e(ze,{to:"/ft",children:[e(S,{icon:"filters",size:"l"}),e(u,{id:"cSev+j"})]}),e(ge,{onClick:()=>{A.showGenericAccounts={id:"mute",heading:g._({id:"sOKhEA"}),fetchAccounts:v,excludeRelationshipAttrs:["muting"]}},children:[e(S,{icon:"mute",size:"l"})," ",e(u,{id:"n1sANU"})]}),e(ge,{onClick:()=>{A.showGenericAccounts={id:"block",heading:g._({id:"nL8nlr"}),fetchAccounts:w,excludeRelationshipAttrs:["blocking"]}},children:[e(S,{icon:"block",size:"l"}),e(u,{id:"r3RRWo"})]})," "]}),e(je,{}),e(ge,{onClick:()=>{A.showAccounts=!0},children:[e(S,{icon:"group",size:"l"})," ",e("span",{children:e(u,{id:"7e0O8Z"})})]})]}):e(O,{children:[e(je,{}),e(ze,{to:"/login",children:[e(S,{icon:"user",size:"l"})," ",e("span",{children:e(u,{id:"sQia9P"})})]})]})]}),e("section",{children:[e(je,{}),e(ze,{to:"/search",children:[e(S,{icon:"search",size:"l"})," ",e("span",{children:e(u,{id:"A1taO8"})})]}),e(ze,{to:`/${s}/trending`,children:[e(S,{icon:"chart",size:"l"})," ",e("span",{children:e(u,{id:"4/iCqx"})})]}),e(ze,{to:`/${s}/p/l`,children:[e(S,{icon:"building",size:"l"})," ",e("span",{children:e(u,{id:"d5zxa4"})})]}),e(ze,{to:`/${s}/p`,children:[e(S,{icon:"earth",size:"l"})," ",e("span",{children:e(u,{id:"4ERYY7"})})]}),c?e(O,{children:[e(je,{className:"divider-grow"}),e(ge,{onClick:()=>{A.showKeyboardShortcutsHelp=!0},children:[e(S,{icon:"keyboard",size:"l"})," ",e("span",{children:e(u,{id:"77Emn0"})})]}),e(ge,{onClick:()=>{A.showShortcutsSettings=!0},children:[e(S,{icon:"shortcut",size:"l"})," ",e("span",{children:e(u,{id:"8Kudkr"})})]}),e(ge,{onClick:()=>{A.showSettings=!0},children:[e(S,{icon:"gear",size:"l"})," ",e("span",{children:e(u,{id:"uVbUP8"})})]})]}):e(O,{children:[e(je,{}),e(ge,{onClick:()=>{A.showSettings=!0},children:[e(S,{icon:"gear",size:"l"})," ",e("span",{children:e(u,{id:"uVbUP8"})})]})]})]})]})]})}const Dt=st(io),an={block:"nearest",inline:"center",behavior:"smooth"};function kt({title:t,titleComponent:n,id:i,instance:s,emptyText:c,errorText:a,useItemID:p,boostsCarousel:r,fetchItems:o=()=>{},checkForUpdates:l=()=>{},checkForUpdatesInterval:m=15e3,headerStart:h,headerEnd:f,timelineStart:d,refresh:v,view:b,filterContext:w,showFollowedTags:k,showReplyParent:y,clearWhenRefresh:I}){const _=Fe(A),[C,T]=R([]),[x,U]=R("start"),[M,D]=R(!1),[j,te]=R(!1),[J,N]=R(!0),P=Y(),B=be(()=>Bn(),[]),V=b!=="media",F=Y(0),ee=pc(X=>{te(!1),U("loading"),(async()=>{try{const me=F.current=Date.now();let{done:Te,value:oe}=await o(X);if(me!==F.current)return;if(Array.isArray(oe)){const[E,G]=oe.reduce((L,H)=>(H._pinned?L[0].push(H):L[1].push(H),L),[[],[]]);oe=G,V&&(r&&(oe=Za(oe)),oe=Ja(oe,s)),E.length&&(oe=E.concat(oe)),T(X?oe:L=>[...L,...oe]),oe.length||(Te=!0),D(!Te)}else D(!1);U("default")}catch{U("error")}finally{ee.cancel()}})()},1e3,{leading:!0}),z=".timeline-item, .timeline-item-alt",ie=Ue("j, shift+j",(X,me)=>{const Te=document.activeElement.closest(z),oe=Te==null?void 0:Te.getBoundingClientRect(),E=Array.from(P.current.querySelectorAll(z));if(Te&&oe.top<P.current.clientHeight&&oe.bottom>0){const G=E.indexOf(Te);let L=E[G+1];me.shift&&(L=E.find((H,K)=>K>G&&!H.classList.contains("timeline-item-alt"))),L&&(L.focus(),L.scrollIntoView(an))}else{const G=E.find(L=>{const H=L.getBoundingClientRect();return H.top>=44&&H.left>=0});G&&(G.focus(),G.scrollIntoView(an))}}),pe=Ue("k, shift+k",(X,me)=>{const Te=document.activeElement.closest(z),oe=Te==null?void 0:Te.getBoundingClientRect(),E=Array.from(P.current.querySelectorAll(z));if(Te&&oe.top<P.current.clientHeight&&oe.bottom>0){const G=E.indexOf(Te);let L=E[G-1];me.shift&&(L=E.findLast((H,K)=>K<G&&!H.classList.contains("timeline-item-alt"))),L&&(L.focus(),L.scrollIntoView(an))}else{const G=E.find(L=>{const H=L.getBoundingClientRect();return H.top>=44&&H.left>=0});G&&(G.focus(),G.scrollIntoView(an))}}),ce=Ue(["enter","o"],()=>{const X=document.activeElement;X!=null&&X.matches(z)&&X.click()}),he=C.length>0&&x!=="loading"&&j,ve=at(()=>{var X;he&&ee(!0),(X=P.current)==null||X.scrollTo({top:0,behavior:"smooth"})},[ee,he]),fe=Ue(".",ve),_e=Y(),[$e,Me]=R(!1);to({scrollableRef:P,distanceFromEnd:2,scrollThresholdStart:44},({scrollDirection:X,nearReachStart:me,reachStart:Te})=>{if(_e.current){const oe=X==="end"&&!me;_e.current.hidden=oe}Me(me),Te&&ee(!0)},[]),Q(()=>{var X;(X=P.current)==null||X.scrollTo({top:0}),ee(!0)},[]);const Ce=Y(!0);Q(()=>{var X;if(Ce.current){Ce.current=!1;return}I&&(C!=null&&C.length)&&((X=ee.cancel)==null||X.call(ee),T([])),ee(!0)},[I,v]);const De=Y(b);Q(()=>{De.current!==b&&(De.current=b,T([]))},[b]);const Oe=at(async({disableIdleCheck:X=!1}={})=>{const me=P.current?getComputedStyle(P.current).pointerEvents==="none":!1;_.settings.autoRefresh&&P.current.scrollTop<16&&(X||window.__IDLE__)&&!oo()&&!me?ee(!0):await l()&&te(!0)},[i,ee,l,_.settings.autoRefresh]),ye=Y();return Bt(X=>{if(X){const me=Date.now()-ye.current;(!ye.current||me>1e3*3)&&Oe({disableIdleCheck:!0})}else ye.current=Date.now();N(X)},[l,Oe,_.settings.autoRefresh]),Hn(Oe,J&&!j?m*($e?1:2):null),e(ns.Provider,{value:w,children:e("div",{id:`${i}-page`,class:`deck-container ${B?"deck-container-media-first":""}`,ref:X=>{P.current=X,ie.current=X,pe.current=X,ce.current=X,fe.current=X},tabIndex:"-1",onClick:X=>{_e.current&&X.target.closest(".timeline-item, .timeline-item-alt")&&setTimeout(()=>{_e.current.hidden=!1},250)},children:e("div",{class:"timeline-deck deck",children:[e("header",{ref:_e,onClick:X=>{var me;X.target.closest("a, button")||(me=P.current)==null||me.scrollTo({top:0,behavior:"smooth"})},onDblClick:X=>{X.target.closest("a, button")||ee(!0)},class:x==="loading"?"loading":"",children:[e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Dt,{}),h??e(de,{to:"/",class:"button plain home-button",children:e(S,{icon:"home",size:"l",alt:g._({id:"i0qMbr"})})})]}),t&&(n||e("h1",{children:t})),e("div",{class:"header-side",children:!!f&&f})]}),he&&e("button",{class:"updates-button shiny-pill",type:"button",onClick:ve,children:[e(S,{icon:"arrow-up"})," ",e(u,{id:"2yr1/p"})]})]}),!!d&&e("div",{class:`timeline-start ${x==="loading"?"loading":""}`,children:d}),C.length?e(O,{children:[e("ul",{class:`timeline ${b?`timeline-${b}`:""}`,children:[C.map(X=>e(so,{status:X,instance:s,useItemID:p,filterContext:w,view:b,showFollowedTags:k,showReplyParent:y,mediaFirst:B},X.id+(X==null?void 0:X._pinned)+b)),M&&x==="loading"&&(b==="media"?null:e(O,{children:[e("li",{style:{height:"20vh"},children:e(qe,{skeleton:!0,mediaFirst:B})}),e("li",{style:{height:"25vh"},children:e(qe,{skeleton:!0,mediaFirst:B})})]}))]}),x==="default"&&(M?e(yt,{root:P.current,rootMargin:`0px 0px ${screen.height*1.5}px 0px`,onChange:X=>{X&&ee()},children:e("button",{type:"button",class:"plain block",onClick:()=>ee(),style:{marginBlockEnd:"6em"},children:e(u,{id:"uXRAkV"})})}):e("p",{class:"ui-state insignificant",children:e(u,{id:"2EYeAZ"})}))]}):x==="loading"?e("ul",{class:"timeline",children:Array.from({length:5}).map((X,me)=>b==="media"?e("div",{style:{height:"50vh"}}):e("li",{children:e(qe,{skeleton:!0,mediaFirst:B})},me))}):x!=="error"&&x!=="start"&&e("p",{class:"ui-state",children:c}),x==="error"&&e("p",{class:"ui-state",children:[a,e("br",{}),e("br",{}),e("button",{type:"button",onClick:()=>ee(!C.length),children:e(u,{id:"KDw4GX"})})]})]})})})}const so=st(({status:t,instance:n,useItemID:i,filterContext:s,view:c,showFollowedTags:a,showReplyParent:p,mediaFirst:r})=>{const{id:o,reblog:l,items:m,type:h,_pinned:f}=t;f&&(i=!1);const d=(l==null?void 0:l.id)||o,v=n?`/${n}/s/${d}`:`/s/${d}`;if(m){let w=Et(m,s),k="";if(h==="boosts"?k=`${w.length} Boosts`:h==="pinned"&&(k="Pinned posts"),h==="boosts"||h==="pinned"){const _=new Set;if(w.sort((C,T)=>{const x=en(C.filtered,s),U=en(T.filtered,s);return x&&_.add(C.id),U&&_.add(T.id),x&&!U?1:!x&&U?-1:0}),_.size>=2){const T=[],x=[];w.forEach(M=>{_.has(M.id)?x.push(M):T.push(M)});const U=[];for(let M=0;M<x.length;M+=5)U.push({_grouped:!0,posts:x.slice(M,M+5)});w=T.concat(U)}return e("li",{class:"timeline-item-carousel",children:e(co,{title:k,class:`${h}-carousel`,children:w.map(C=>{const{id:T,reblog:x,_pinned:U,_grouped:M}=C;if(M)return e("li",{class:"timeline-item-carousel-group",children:C.posts.map(te=>{const{id:J,reblog:N,_pinned:P}=te,B=(N==null?void 0:N.id)||J,V=n?`/${n}/s/${B}`:`/s/${B}`;return P&&(i=!1),e(de,{class:"status-carousel-link timeline-item-alt",to:V,children:i?e(qe,{statusID:J,instance:n,size:"s"}):e(qe,{status:te,instance:n,size:"s"})})})},T);const D=(x==null?void 0:x.id)||T,j=n?`/${n}/s/${D}`:`/s/${D}`;return U&&(i=!1),e("li",{children:e(de,{class:"status-carousel-link timeline-item-alt",to:j,children:i?e(qe,{statusID:T,instance:n,size:"s",contentTextWeight:!0,enableCommentHint:!0,mediaFirst:r}):e(qe,{status:C,instance:n,size:"s",contentTextWeight:!0,enableCommentHint:!0,mediaFirst:r})})},T)})})},`timeline-${o}`)}const I=w.length>3;return w.map((_,C)=>{const{id:T,_differentAuthor:x}=_,U=n?`/${n}/s/${T}`:`/s/${T}`,M=C>0&&C<w.length-1,D=_.sensitive&&!!_.spoilerText,j=!x&&D&&C>0||I&&M&&(h==="thread"||h==="conversation"&&!x&&!w[C-1]._differentAuthor&&!w[C+1]._differentAuthor),te=C===0,J=C===w.length-1;return e("li",{class:`timeline-item-container timeline-item-container-type-${h} timeline-item-container-${te?"start":J?"end":"middle"} ${x?"timeline-item-diff-author":""}`,children:e(de,{class:"status-link timeline-item",to:U,children:j?e(ao,{status:_,instance:n,filterContext:s}):i?e(qe,{statusID:T,instance:n,enableCommentHint:J,showFollowedTags:a}):e(qe,{status:_,instance:n,enableCommentHint:J,showFollowedTags:a})})},`timeline-${T}`)})}const b=`timeline-${o+f}`;return c==="media"?i?e(Li,{class:"timeline-item",parent:"li",statusID:o,instance:n},b):e(Li,{class:"timeline-item",parent:"li",status:t,instance:n},b):e("li",{children:e(de,{class:"status-link timeline-item",to:v,children:i?e(qe,{statusID:o,instance:n,enableCommentHint:!0,showFollowedTags:a,showReplyParent:p,mediaFirst:r}):e(qe,{status:t,instance:n,enableCommentHint:!0,showFollowedTags:a,showReplyParent:p,mediaFirst:r})})},b)},(t,n)=>{var c,a;const i=(((c=t.status)==null?void 0:c.id)||"").toString(),s=(((a=n.status)==null?void 0:a.id)||"").toString();return i===s&&t.instance===n.instance&&t.view===n.view});function co({title:t,class:n,children:i}){const s=Y(),c=Y(),a=Y(),[p,r]=R(!1);return Q(()=>{setTimeout(()=>{r(!0)},1)},[]),e("div",{class:`status-carousel ${n}`,children:[e("header",{children:[e("h3",{children:t}),e("span",{children:[e("button",{ref:c,type:"button",class:"small plain2",onClick:()=>{var l,m;const o=Math.min(320,(l=s.current)==null?void 0:l.offsetWidth)*(xt()?1:-1);(m=s.current)==null||m.scrollBy({left:o,behavior:"smooth"})},children:e(S,{icon:"chevron-left",alt:g._({id:"DHhJ7s"})})})," ",e("button",{ref:a,type:"button",class:"small plain2",onClick:()=>{var l,m;const o=Math.min(320,(l=s.current)==null?void 0:l.offsetWidth)*(xt()?-1:1);(m=s.current)==null||m.scrollBy({left:o,behavior:"smooth"})},children:e(S,{icon:"chevron-right",alt:g._({id:"hXzOVo"})})})]})]}),e("ul",{ref:s,children:[e(yt,{class:"status-carousel-beacon",onChange:o=>{c.current&&(c.current.disabled=o)}}),i[0],p&&i.slice(1),e(yt,{class:"status-carousel-beacon",onChange:o=>{a.current&&(a.current.disabled=o)}})]})]})}function ao({status:t,instance:n,filterContext:i}){const s=Fe(A),{id:c,visibility:a,language:p}=t,r=Vn(t),o=nt(c,n),l=en(t.filtered,i);return e("article",{class:`status compact-thread ${a==="direct"?"visibility-direct":""}`,tabindex:"-1",children:[s.statusThreadNumber[o]?e("div",{class:"status-thread-badge",children:[e(S,{icon:"thread",size:"s",alt:g._({id:"e66y2Z"})}),s.statusThreadNumber[o]?` ${s.statusThreadNumber[o]}/X`:""]}):e("div",{class:"status-thread-badge",children:e(S,{icon:"thread",size:"s",alt:g._({id:"e66y2Z"})})}),e("div",{class:"content-compact",title:r,lang:p,dir:"auto",children:l?e("b",{class:"status-filtered-badge badge-meta horizontal",title:(l==null?void 0:l.titlesStr)||"",children:l!=null&&l.titlesStr?e(u,{id:"sr6maL",values:{0:l.titlesStr},components:{0:e("span",{}),1:e("span",{})}}):e("span",{children:e(u,{id:"03Qqf9"})})}):e(O,{children:[r,t.sensitive&&t.spoilerText&&e(O,{children:[" ",e("span",{class:"spoiler-badge",children:e(S,{icon:"eye-close",size:"s",alt:g._({id:"gnKo7f"})})})]})]})})]})}function oo(){return!!document.querySelector(".deck-backdrop, #modal-container > *")}const zt=20,ci=1983,$i=`${ci}-01`,ro=(()=>{try{const t=document.createElement("input");return t.setAttribute("type","month"),t.type==="month"}catch{return!1}})();async function lo(t){var s;const{masto:n}=se({instance:t}),i=await n.v2.search.fetch({q:"from:me",type:"statuses",limit:1});return!!((s=i==null?void 0:i.statuses)!=null&&s.length)}const uo=wt(lo);function ho(){const t=Fe(A),{id:n,...i}=$t(),[s,c]=dt(),a=s.get("month"),p=!s.get("replies"),r=!!s.get("boosts"),o=s.get("tagged"),l=!!s.get("media"),{masto:m,instance:h,authenticated:f}=se({instance:i.instance}),{masto:d,instance:v}=se(),b=Y(),w=[a,p,r,o,l],[k,y]=R(),I=Y(0);Q(()=>{I.current=0},w);const _=be(()=>Bn(),[]),C=be(()=>h===v,[h,v]),[T,x]=R(!1);Q(()=>{C&&k!=null&&k.acct&&(async()=>{const ce=await uo(h);x(ce)})()},[h,C,k==null?void 0:k.acct]);async function U(ce){var Me,Ce,De,Oe;const he=/^\d{4}-[01]\d$/.test(a),ve=((Ce=(Me=a==null?void 0:a.split)==null?void 0:Me.call(a,"-"))==null?void 0:Ce[0])>=ci;if(he&&ve){if(!k)return{value:[],done:!0};const[ye,X]=a.split("-"),me=parseInt(X,10)-1,Te=new Date(ye,me,0),oe=`${Te.getFullYear()}-${(Te.getMonth()+1).toString().padStart(2,"0")}-${Te.getDate().toString().padStart(2,"0")}`,E=new Date(ye,me+1,1),G=`${E.getFullYear()}-${(E.getMonth()+1).toString().padStart(2,"0")}-${E.getDate().toString().padStart(2,"0")}`;let L;ce?(L=zt+1,I.current=0):(L=zt+I.current+1,I.current+=zt);const H=await m.v2.search.fetch({q:`from:${k.acct} after:${oe} before:${G}`,type:"statuses",limit:L,offset:I.current});if((De=H==null?void 0:H.statuses)!=null&&De.length){const K=H.statuses.slice(0,zt);K.forEach(Pe=>{Ge(Pe,h)});const ue=H.statuses.length<=zt;return{value:K,done:ue}}else return{value:[],done:!0}}let fe=[];if(ce){const{value:ye}=await m.v1.accounts.$select(n).statuses.list({pinned:!0}).next();if(ye!=null&&ye.length&&!o&&!l){const X=ye.map(me=>(Ge(me,h),{...me,_pinned:!0}));if(X.length>=3){const me=X.map(Te=>Te.id);fe.push({id:me,items:X,type:"pinned"})}else fe.push(...X)}}(ce||!b.current)&&(b.current=m.v1.accounts.$select(n).statuses.list({limit:zt,exclude_replies:p,exclude_reblogs:r,only_media:l||void 0,tagged:o}));const{value:_e,done:$e}=await b.current.next();if(_e!=null&&_e.length){if(fe.length){let ye=[];((Oe=fe[0])==null?void 0:Oe.type)==="pinned"?ye=fe[0].id:ye=fe.filter(me=>me._pinned).map(me=>me.id),ye.every(me=>_e.some(Te=>Te.id===me))&&(fe=[])}fe.push(..._e),_e.forEach(ye=>{Ge(ye,h)})}return{value:fe,done:$e}}const[M,D]=R([]),{i18n:j}=et();let te=j._({id:"/cKnpj"});if(k!=null&&k.acct){const ce=/@/.test(k.acct)?"":"@"+k.acct,he=k!=null&&k.displayName?`${k.displayName} (${ce})`:`${ce}`;if(!p)te=j._({id:"hS1Opy",values:{accountDisplay:he}});else if(r)te=j._({id:"A/CX5F",values:{accountDisplay:he}});else if(o)te=j._({id:"QQrO94",values:{accountDisplay:he,tagged:o}});else if(l)te=j._({id:"NoG5wD",values:{accountDisplay:he}});else if(a){const ve=new Date(a).toLocaleString(j.locale,{month:"long",year:"numeric"});te=j._({id:"8GjLvB",values:{accountDisplay:he,monthYear:ve}})}else te=he}We(te,"/:instance?/a/:id");const J=Y(),N=at(()=>{const ce=J.current||m.v1.accounts.$select(n).fetch();return J.current=ce,ce},[n,m]);Q(()=>{(async()=>{try{const ce=await N();y(ce)}catch{}if(!_)try{const ce=await m.v1.accounts.$select(n).featuredTags.list();D(ce)}catch{}})()},[n,_]);const{displayName:P,acct:B,emojis:V}=k||{},F=Y(),ee=be(()=>{const ce=!p||r||o||l||!!a,he=t.accounts[`${n}@${h}`];return e(O,{children:[e(vs,{instance:h,account:he||n,fetchAccount:N,authenticated:f,standalone:!0}),!_&&e("div",{class:"filter-bar",ref:F,style:{position:"relative"},children:[ce?e(de,{to:`/${h}/a/${n}`,class:"insignificant filter-clear",title:j._({id:"u8JHrO"}),children:e(S,{icon:"x",size:"l",alt:j._({id:"xCJdfg"})})},"clear-filters"):e(S,{icon:"filter",class:"insignificant",size:"l",alt:j._({id:"cSev+j"})}),e(de,{to:`/${h}/a/${n}${p?"?replies=1":""}`,onClick:()=>{p&&le(j._({id:"PIWNSQ"}))},class:p?"":"is-active",children:e(u,{id:"5BFynH"})}),e(de,{to:`/${h}/a/${n}${r?"":"?boosts=0"}`,onClick:()=>{r||le(j._({id:"Qd13i0"}))},class:r?"is-active":"",children:e(u,{id:"usxQx0"})}),e(de,{to:`/${h}/a/${n}${l?"":"?media=1"}`,onClick:()=>{l||le(j._({id:"rKpfPY"}))},class:l?"is-active":"",children:e(u,{id:"xYilR2"})}),M.map(ve=>e(de,{to:`/${h}/a/${n}${o===ve.name?"":`?tagged=${encodeURIComponent(ve.name)}`}`,onClick:()=>{o!==ve.name&&le(j._({id:"L+HFfr",values:{0:ve.name}}))},class:o===ve.name?"is-active":"",children:e("span",{children:[e("span",{class:"more-insignificant",children:"#"}),ve.name]})},ve.id)),T&&(ro?e("label",{class:`filter-field ${a?"is-active":""}`,children:[e(S,{icon:"month",size:"l"}),e("input",{type:"month",disabled:!(k!=null&&k.acct),value:a||"",min:$i,max:new Date().toISOString().slice(0,7),onInput:ve=>{const{value:fe,validity:_e}=ve.currentTarget;if(!_e.valid)return;c(fe?{month:fe}:{});const[$e,Me]=fe.split("-"),Ce=parseInt(Me,10)-1,De=new Date($e,Ce);le(j._({id:"0WUFGD",values:{0:De.toLocaleString(j.locale,{month:"long",year:"numeric"})}}))}})]}):e(fo,{class:`filter-field ${a?"is-active":""}`,disabled:!(k!=null&&k.acct),value:a||"",min:$i,max:new Date().toISOString().slice(0,7),onInput:ve=>{const{value:fe,validity:_e}=ve;_e.valid&&c(fe?{month:fe}:{})}}))]})]})},[n,h,f,M,N,T,...w]);Q(()=>{var he;const ce=(he=F.current)==null?void 0:he.querySelector(".is-active");ce&&F.current.scrollTo({behavior:"smooth",left:ce.offsetLeft-(F.current.offsetWidth-ce.offsetWidth)/2})},[M,T,...w]);const z=be(()=>k!=null&&k.url?URL.parse(k.url).hostname:null,[k]),pe=!!k&&!(h===z);return e(kt,{title:`${k!=null&&k.acct?"@"+k.acct:j._({id:"+owNNn"})}`,titleComponent:e("h1",{class:"header-double-lines header-account",children:[e("b",{children:e(Qi,{text:P,emojis:V})}),e("div",{children:e("span",{children:["@",B]})})]}),id:"account-statuses",instance:h,emptyText:j._({id:"+k97fV"}),errorText:j._({id:"scd9lw"}),fetchItems:U,useItemID:!0,view:l||_?"media":void 0,boostsCarousel:t.settings.boostsCarousel,timelineStart:ee,refresh:[p,r,o,l,a+(k==null?void 0:k.acct)].toString(),headerEnd:e(it,{portal:!0,overflow:"auto",viewScroll:"close",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(S,{icon:"more",size:"l",alt:j._({id:"2FYpfJ"})})}),children:[e(ge,{disabled:!pe,onClick:()=>{(async()=>{try{const{masto:ce}=se({instance:z}),he=await ce.v1.accounts.lookup({acct:k.acct}),{id:ve}=he;location.hash=`/${z}/a/${ve}`}catch{alert(j._({id:"FgdLx0"}))}})()},children:[e(S,{icon:"transfer"})," ",e("small",{class:"menu-double-lines",children:e(u,{id:"/JFxxT",values:{0:z?e(O,{children:[" ","(",e("b",{children:Gt.toUnicode(z)}),")"]}):null}})})]}),!C&&e(ge,{onClick:()=>{(async()=>{try{const ce=await d.v1.accounts.lookup({acct:k.acct+"@"+h}),{id:he}=ce;location.hash=`/${v}/a/${he}`}catch{alert(j._({id:"FgdLx0"}))}})()},children:[e(S,{icon:"transfer"})," ",e("small",{class:"menu-double-lines",children:e(u,{id:"HkuyOu",values:{currentInstance:v},components:{0:e("b",{})}})})]})]})},n)}function fo(t){const{i18n:n}=et(),{class:i,disabled:s,value:c,min:a,max:p,onInput:r=()=>{}}=t,[o,l]=(c==null?void 0:c.split("-"))||[],m=Y(),h=Y(),f=(d,v)=>{const[b,w]=(a==null?void 0:a.split("-"))||[],[k,y]=(p==null?void 0:p.split("-"))||[];return!(v<b||v>k||v===b&&d<w||v===k&&d>y)};return e("div",{class:i,children:[e(S,{icon:"month",size:"l"}),e("select",{ref:m,disabled:s,value:l||"",onInput:d=>{const{value:v}=d.currentTarget,b=h.current.value;if(!f(v,b))return{value:"",validity:{valid:!1}};r({value:v?`${b}-${v}`:"",validity:{valid:!0}})},children:[e("option",{value:"",children:e(u,{id:"HajiZl"})}),e("option",{disabled:!0,children:"-----"}),Array.from({length:12},(d,v)=>e("option",{value:(v+1).toString().padStart(2,"0"),children:new Date(0,v).toLocaleString(n.locale,{month:"long"})},v))]})," ",e("input",{ref:h,type:"number",disabled:s,value:o||new Date().getFullYear(),min:(a==null?void 0:a.slice(0,4))||ci,max:(p==null?void 0:p.slice(0,4))||new Date().getFullYear(),onInput:d=>{const{value:v,validity:b}=d.currentTarget,w=m.current.value;if(!b.valid||!f(w,v))return{value:"",validity:{valid:!1}};r({value:v?`${v}-${w}`:"",validity:{valid:!0}})},style:{width:"4.5em"}})]})}const po=20;function Ss(){We(g._({id:"7Ff7ia"}),"/bookmarks");const{masto:t,instance:n}=se(),i=Y();async function s(c){return(c||!i.current)&&(i.current=t.v1.bookmarks.list({limit:po})),await i.current.next()}return e(kt,{title:g._({id:"7Ff7ia"}),id:"bookmarks",emptyText:"No bookmarks yet. Go bookmark something!",errorText:g._({id:"UoL+FC"}),instance:n,fetchItems:s})}const mo=""+new URL("catch-up-DuauQu-W.png",import.meta.url).href,go="home",tt=[{label:{id:"Ov9hfp"},value:1},{label:{id:"tVE2wM"},value:2},{label:{id:"8+HOWa"},value:3},{label:{id:"1o+mEC"},value:4},{label:{id:"dZZ8oA"},value:5},{label:{id:"lpPucp"},value:6},{label:{id:"r9r5X6"},value:7},{label:{id:"I9uBFA"},value:8},{label:{id:"pBYFlb"},value:9},{label:{id:"wvL7OJ"},value:10},{label:{id:"7Vb+qD"},value:11},{label:{id:"VU1Pnd"},value:12},{label:{id:"vpc27K"},value:13}],bo={original:{id:"HxF6Fk"},replies:{id:"N8UzTV"},boosts:{id:"puY2t0"},followedTags:{id:"lCLRBe"},groups:{id:"zhrjek"},filtered:{id:"03Qqf9"}},vo=["createdAt","repliesCount","favouritesCount","reblogsCount","density"],yo=[null,"account"],wo=Ki(t=>new Intl.DateTimeFormat(t||void 0,{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}));function ko(){const{i18n:t,_:n}=et(),i=wo(t.locale);We("Catch-up","/catchup");const{masto:s,instance:c}=se(),[a,p]=dt(),r=a.get("id"),[o,l]=R("start"),[m,h]=R(!1),f=be(()=>bt(),[]),d=$=>$===f,v=Ke("@pixelfed/home-include-reblogs");async function b({maxCreatedAt:$}){var W,Se,xe;const q=$?new Date($):null,ae=[],Z=s.v1.timelines.home.list({limit:40});e:for(;;)try{v&&Z.nextParams&&(typeof Z.nextParams=="string"?Z.nextParams+="&include_reblogs=true":Z.nextParams.include_reblogs=!0);const ke=await Z.next(),{value:Re}=ke;if(Re!=null&&Re.length){await _s(Re,c);let Be=!1;for(let re=0;re<Re.length;re++){const Ae=Re[re],ht=new Date(Ae.createdAt);if(!q||ht>=q){const He=!d(((Se=(W=Ae.reblog)==null?void 0:W.account)==null?void 0:Se.id)||Ae.account.id)&&en(((xe=Ae.reblog)==null?void 0:xe.filtered)||Ae.filtered,go);if((He==null?void 0:He.action)==="hide")continue;Ae._filtered=He;const ft=nt(Ae.id,c);Ae._followedTags=A.statusFollowedTags[ft]?[...A.statusFollowedTags[ft]]:[],ae.push(Ae),Be=!0}if(!Be)break e}}else break e;await new Promise(Be=>setTimeout(Be,1e3))}catch{break e}return ae.forEach(ke=>{if(ke!=null&&ke.inReplyToId){const Re=ae.find(Be=>Be.id===ke.inReplyToId);Re&&!Re.inReplyToId&&(Re._thread=!0)}}),ae}const[w,k]=R([]),y=Y(),I=Y(),_=be(()=>mn(),[]),C=at(async({duration:$}={})=>{const q=Date.now(),ae=$?q-$:null;l("loading");const Z=await b({maxCreatedAt:ae}),W=`${_}-${mc()}`;try{await lt.catchup.set(W,{id:W,posts:Z,count:Z.length,startAt:ae,endAt:q}),p({id:W})}catch{}},[]);Q(()=>{r?(async()=>{const $=await lt.catchup.get(r);$&&($.posts.sort((q,ae)=>q.createdAt>ae.createdAt?1:-1),k($.posts),l("results"))})():o==="results"&&(k([]),l("start"))},[r]);const[T,x]=Lt($=>$+1,0),[U,M]=R(null),[D,j]=R([]);Q(()=>{(async()=>{try{const $=await lt.catchup.keys();if($.length){const q=mn(),ae=$.filter(Z=>Z.startsWith(`${q}-`));if(ae.length){let Z=await lt.catchup.getMany(ae);Z.sort((ke,Re)=>Re.endAt-ke.endAt);let W=Z.slice(0,3),Se=Z.slice(3);const xe=W.map(ke=>{const{id:Re,count:Be,startAt:re,endAt:Ae}=ke;return{id:Re,count:Be,startAt:re,endAt:Ae}});j(xe),M(W[0].endAt),Z=null,W=null,queueMicrotask(()=>{Se.length&&lt.catchup.delMany(Se.map(ke=>ke.id)).then(()=>{Se=null}).catch(ke=>{})});return}}}catch{}j([])})()},[T]),Q(()=>{o==="start"&&x()},[o==="start"]);const[te,J]=be(()=>{var Re,Be,re,Ae,ht;let $=0,q=0,ae=0,Z=0,W=0,Se=0;const xe={};for(const Ie of w){Ie._filtered?($++,Ie.__FILTER="filtered"):Ie.group?(q++,Ie.__FILTER="groups"):Ie.reblog?(ae++,Ie.__FILTER="boosts"):(Re=Ie._followedTags)!=null&&Re.length?(W++,Ie.__FILTER="followedTags"):Ie.inReplyToId&&Ie.inReplyToAccountId!==((Be=Ie.account)==null?void 0:Be.id)?(Z++,Ie.__FILTER="replies"):(Se++,Ie.__FILTER="original");const He=Ie.reblog||Ie;if(Ie.__FILTER!=="filtered"&&((re=He.card)!=null&&re.url)&&((Ae=He.card)!=null&&Ae.image)&&((ht=He.card)==null?void 0:ht.type)==="link"){const{card:ft,favouritesCount:cn,reblogsCount:It}=He;let{url:Je}=ft;if(Je=Je.replace(/\/$/,""),!xe[Je])xe[Je]={postID:He.id,card:ft,shared:1,sharers:[Ie.account],likes:cn,boosts:It};else{if(xe[Je].sharers.find(Pt=>Pt.id===Ie.account.id))continue;xe[Je].shared++,xe[Je].sharers.push(Ie.account),xe[Je].postID!==He.id&&(xe[Je].likes+=cn,xe[Je].boosts+=It)}}}let ke=[];for(const Ie in xe)ke.push({url:Ie,...xe[Ie]});if(ke.sort((Ie,He)=>Ie.shared>He.shared?-1:Ie.shared<He.shared?1:Ie.boosts>He.boosts?-1:Ie.boosts<He.boosts?1:Ie.likes>He.likes?-1:Ie.likes<He.likes?1:0),ke.length>10)e:for(let Ie=10;Ie<ke.length;Ie++){const{shared:He}=ke[Ie];if(He<=1){ke=ke.slice(0,Ie);break e}}return[{filtered:$,groups:q,boosts:ae,replies:Z,followedTags:W,original:Se},ke]},[w]),[N,P]=R("all"),[B,V]=R(null),[F,ee]=R(1),[z,ie]=R("createdAt"),[pe,ce]=R("asc"),[he,ve]=R(null),[fe,_e,$e]=be(()=>{const $={},q=new Map;let ae=w.filter(W=>{const Se=N==="all"||W.__FILTER===N;return Se&&($[W.account.id]=W.account,q.set(W.account.id,(q.get(W.account.id)||0)+1)),Se});const Z={};return ae.forEach(W=>{W.reblog&&(Z[W.reblog.id]?(Z[W.reblog.id].__BOOSTERS?Z[W.reblog.id].__BOOSTERS.add(W.account):Z[W.reblog.id].__BOOSTERS=new Set([W.account]),W.__HIDDEN=!0):Z[W.reblog.id]=W)}),B&&q.has(B)&&(ae=ae.filter(W=>W.account.id===B||[...W.__BOOSTERS||[]].find(Se=>Se.id===B))),[ae,$,Object.fromEntries(q)]},[N,B,w]),Me=be(()=>{const $={};return fe.forEach(q=>{$[q.id]=q}),$},[fe]),Ce=be(()=>Object.keys($e).sort(($,q)=>$e[q]-$e[$]),[$e]),De=be(()=>{const $={};return Ce.forEach((q,ae)=>{$[q]=ae}),fe.filter(q=>!q.__HIDDEN).sort((q,ae)=>{if(he==="account"){const Z=q.account.id,W=ae.account.id,Se=$[Z],xe=$[W],ke=Se-xe;if(ke!==0)return ke}if(z!=="createdAt"&&(q=q.reblog||q,ae=ae.reblog||ae,z!=="density"&&q[z]===ae[z]))return q.createdAt>ae.createdAt?1:-1;if(z==="density"){const Z=Mi(q),W=Mi(ae);return pe==="asc"?Z>W?1:-1:W>Z?1:-1}return pe==="asc"?q[z]>ae[z]?1:-1:ae[z]>q[z]?1:-1})},[fe,z,pe,he,Ce]),Oe=Y(null),ye=Y(null),X=Y(!1);Q(()=>{w.length>100||X.current||ye.current&&(hs(ye.current,{duration:200}),X.current=!0)},[w,ye]);const me=w.length>160?"3d":"2d",Te=be(()=>me!=="2d"?null:w.map($=>{const q=Me[$.id];return e("span",{class:`post-dot ${q?"post-dot-highlight":""}`},$.id)}),[Me]),oe=be(()=>me!=="3d"||!(w!=null&&w.length)?null:Ao(w,"createdAt",320).map((q,ae)=>e("div",{class:"posts-bin",children:q.map(Z=>{const W=Me[Z.id];return e("span",{class:`post-dot ${W?"post-dot-highlight":""}`},Z.id)})},ae)),[Me]),E=Y(null),G=be(()=>U?(Date.now()-U)/1e3/60/60:null,[U,F]);Q(()=>{if(o!=="results")return;const $=B&&_e[B]?_e[B].username:"",q=pe==="asc"?0:1,ae={account:"authors"};let Z=le({duration:5e3,text:t._({id:"TLYeLT",values:{selectedFilterCategory:N,sortBy:z,sortOrder:pe,groupBy:he}})});return()=>{var W;(W=Z==null?void 0:Z.hideToast)==null||W.call(Z)}},[o,N,B,z,pe,he,_e]),Q(()=>{var $;if(B&&_e[B]){const q=ye.current.querySelector(`[data-author="${B}"]`),ae=($=ye.current)==null?void 0:$.getBoundingClientRect(),Z=q==null?void 0:q.getBoundingClientRect();Z.left<ae.left||Z.right>ae.right?q.scrollIntoView({block:"nearest",inline:"center",behavior:"smooth"}):Z.top<0&&q.scrollIntoView({block:"nearest",inline:"nearest",behavior:"smooth"})}},[B,_e]);const[L,H]=R(!1),K=".catchup-list > li > a",ue=Ue("j",()=>{const $=document.activeElement.closest(K),q=$==null?void 0:$.getBoundingClientRect(),ae=Array.from(E.current.querySelectorAll(K));if($&&q.top<E.current.clientHeight&&q.bottom>0){const Z=ae.indexOf($),W=ae[Z+1];W&&(W.focus(),W.scrollIntoView({block:"center",inline:"center",behavior:"smooth"}))}else{const Z=ae.find(W=>W.getBoundingClientRect().top>=0);Z&&(Z.focus(),Z.scrollIntoView({block:"nearest",inline:"center",behavior:"smooth"}))}},{preventDefault:!0,ignoreModifiers:!0}),Pe=Ue("k",()=>{const $=document.activeElement.closest(K),q=$==null?void 0:$.getBoundingClientRect(),ae=Array.from(E.current.querySelectorAll(K));if($&&q.top<E.current.clientHeight&&q.bottom>0){const Z=ae.indexOf($);let W=ae[Z-1];W&&(W.focus(),W.scrollIntoView({block:"center",inline:"center",behavior:"smooth"}))}else{const Z=ae.find(W=>{const Se=W.getBoundingClientRect();return Se.top>=44&&Se.left>=0});Z&&(Z.focus(),Z.scrollIntoView({block:"nearest",inline:"center",behavior:"smooth"}))}},{preventDefault:!0,ignoreModifiers:!0}),Ze=Ue("h, l",($,q)=>{var Z,W,Se;const ae=q.keys[0];if(B){const xe=Ce.indexOf(B);ae==="h"?xe>0&&xe<Ce.length&&(V(Ce[xe-1]),(Z=E.current)==null||Z.focus()):ae==="l"&&xe<Ce.length-1&&xe>=0&&(V(Ce[xe+1]),(W=E.current)==null||W.focus())}else ae==="l"&&(V(Ce[0]),(Se=E.current)==null||Se.focus())},{preventDefault:!0,ignoreModifiers:!0,enableOnFormTags:["input"]}),ne=Ue("esc",()=>{var $;V(null),($=E.current)==null||$.focus()},{preventDefault:!0,ignoreModifiers:!0,enableOnFormTags:["input"]}),Ee=Ue(".",()=>{var $;($=E.current)==null||$.scrollTo({top:0,behavior:"smooth"})},{preventDefault:!0,ignoreModifiers:!0,enableOnFormTags:["input"]});return e("div",{ref:$=>{E.current=$,ue.current=$,Pe.current=$,Ze.current=$,ne.current=$},id:"catchup-page",class:"deck-container",tabIndex:"-1",children:[e("div",{class:"timeline-deck deck wide",children:[e("header",{class:`${o==="loading"?"loading":""}`,onClick:$=>{var q;$.target.closest("a, button")||(q=E.current)==null||q.scrollTo({top:0,behavior:"smooth"})},children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Dt,{}),o==="results"&&e(de,{to:"/catchup",class:"button plain",children:e(S,{icon:"history2",size:"l",alt:t._({id:"xrl8fj"})})}),o==="start"&&e(de,{to:"/",class:"button plain",children:e(S,{icon:"home",size:"l",alt:t._({id:"i0qMbr"})})})]}),e("h1",{children:o!=="start"&&e(u,{id:"wyL/3/",components:{0:e("sup",{})}})}),e("div",{class:"header-side",children:o!=="start"&&o!=="loading"&&e("button",{type:"button",class:"plain",onClick:()=>{H(!0)},children:e(u,{id:"c3XJ18"})})})]})}),e("main",{children:[o==="start"&&e("div",{class:"catchup-start",children:[e("h1",{children:e(u,{id:"wyL/3/",components:{0:e("sup",{})}})}),e("details",{children:[e("summary",{children:e(u,{id:"CxKPv6"})}),e("p",{children:e(u,{id:"YMU1CK"})}),e("img",{src:mo,width:"1200",height:"900",alt:t._({id:"CeInO2"})}),e("p",{children:e("button",{type:"button",onClick:$=>{$.target.closest("details").open=!1},children:e(u,{id:"2jI8hh"})})})]}),e("p",{children:e(u,{id:"1RfGk7"})}),e("p",{children:e("b",{children:e(u,{id:"OOEonE"})})}),e("div",{class:"catchup-form",children:[e("input",{ref:y,type:"range",value:F,min:tt[0].value,max:tt[tt.length-1].value,step:"1",list:"catchup-ranges",onChange:$=>ee(+$.target.value)})," ",e("span",{style:{width:"8em"},children:[n(tt[F-1].label),e("br",{}),e("small",{class:"insignificant",children:F==tt[tt.length-1].value?t._({id:"NMNiaO"}):pt(new Date(Date.now()-F*60*60*1e3))})]}),e("datalist",{id:"catchup-ranges",children:tt.map(({label:$,value:q})=>e("option",{value:q,label:n($)}))})," ",e("button",{type:"button",onClick:()=>{var $;if(F<tt[tt.length-1].value){let q;F===tt[tt.length-1].value&&(($=I.current)!=null&&$.checked)?q=Date.now()-U:q=F*60*60*1e3,C({duration:q})}else C()},children:e(u,{id:"R0yu2l"})})]}),G&&F>G?e("p",{class:"catchup-info",children:[e(S,{icon:"info"})," ",e(u,{id:"AGyV7s"})]}):F===tt[tt.length-1].value&&U?e("p",{class:"catchup-info",children:e("label",{children:[e("input",{type:"checkbox",switch:!0,checked:!0,ref:I})," ",e(u,{id:"dDJEHI",values:{0:i.format(new Date(U))}})]})}):null,e("p",{class:"insignificant",children:e("small",{children:e(u,{id:"EAjFM0"})})}),!!(D!=null&&D.length)&&e("div",{class:"catchup-prev",children:[e("p",{children:e(u,{id:"Yfb9A8"})}),e("ul",{children:D.map($=>e("li",{children:[e(de,{to:`/catchup?id=${$.id}`,children:[e(S,{icon:"history2"})," ",e("span",{children:$.startAt?i.formatRange(new Date($.startAt),new Date($.endAt)):`… – ${i.format(new Date($.endAt))}`})]})," ",e("span",{children:[e("small",{class:"ib insignificant",children:e(u,{id:"S6XZwv",values:{0:$.count}})})," ",e("button",{type:"button",class:"light danger small",onClick:async()=>{var ae;if(confirm(t._({id:"D9CmP2"}))){let Z=le(Z`Removing Catch-up ${$.id}`);await lt.catchup.del($.id),(ae=Z==null?void 0:Z.hideToast)==null||ae.call(Z),le(Z`Catch-up ${$.id} removed`),x()}},children:e(S,{icon:"x",alt:t._({id:"t/YqKh"})})})]})]},$.id))}),D.length>=3&&e("p",{children:e("small",{children:e(u,{id:"sXmrl4"})})})]})]}),o==="loading"&&e("div",{class:"ui-state catchup-start",children:[e(Le,{abrupt:!0}),e("p",{class:"insignificant",children:e(u,{id:"rbUTzD"})}),e("p",{class:"insignificant",children:e(u,{id:"q9urQO"})})]}),o==="results"&&e(O,{children:[e("div",{class:"catchup-header",children:[w.length>0&&e("p",{children:e("b",{class:"ib",children:i.formatRange(new Date(w[0].createdAt),new Date(w[w.length-1].createdAt))})}),e("aside",{children:[e("button",{hidden:N==="all"&&!B&&z==="createdAt"&&pe==="asc",type:"button",class:"plain4 small",onClick:()=>{P("all"),V(null),ie("createdAt"),ve(null),ce("asc")},children:e(u,{id:"I9EnzM"})}),(J==null?void 0:J.length)>0&&e("button",{type:"button",class:"plain small",onClick:()=>h(!m),children:[e(u,{id:"EIZREX"})," ",e(S,{icon:"chevron-down",style:{transform:m?"rotate(180deg)":"rotate(0deg)"}})]})]})]}),e("div",{class:"shazam-container no-animation",hidden:!m,children:e("div",{class:"shazam-container-inner",children:e("div",{class:"catchup-top-links links-bar",children:J.map($=>{const{card:q,shared:ae,sharers:Z,likes:W,boosts:Se}=$,{blurhash:xe,title:ke,description:Re,url:Be,image:re,imageDescription:Ae,language:ht,width:Ie,height:He,publishedAt:ft}=q,cn=Gt.toUnicode(URL.parse(Be).hostname.replace(/^www\./,"").replace(/\/$/,""));let It;if(xe){const Je=jn(xe),Pt=ni(Je);It=ii([.6,Pt[1],Pt[2]])}return e("a",{href:Be,target:"_blank",rel:"noopener noreferrer",style:It?{"--accent-color":`rgb(${It.join(",")})`,"--accent-alpha-color":`rgba(${It.join(",")}, 0.4)`}:{},children:e("article",{children:[e("figure",{children:e("img",{src:re,alt:Ae,width:Ie,height:He,loading:"lazy"})}),e("div",{class:"article-body",children:[e("header",{children:[e("div",{class:"article-meta",children:[e("span",{class:"domain",children:cn})," ",!!ft&&e(O,{children:"· "}),!!ft&&e(O,{children:e(Vt,{datetime:ft,format:"micro"})})]}),!!ke&&e("h1",{class:"title",lang:ht,dir:"auto",title:ke,children:ke})]}),!!Re&&e("p",{class:"description",lang:ht,dir:"auto",title:Re,children:Re}),e("hr",{}),e("p",{style:{whiteSpace:"nowrap"},children:e(u,{id:"bfSr6z",values:{0:Z.map(Je=>{const{avatarStatic:Pt,displayName:Fs}=Je;return e(rt,{url:Pt,size:"s",alt:Fs})})}})})]})]})},Be)})})})}),w.length>=5&&(me==="3d"?e("div",{class:"catchup-posts-viz-time-bar",children:oe}):e("div",{class:"catchup-posts-viz-bar",children:Te})),w.length>=2&&e("div",{class:"catchup-filters",children:[e("label",{class:"filter-cat",children:[e("input",{type:"radio",name:"filter-cat",checked:N.toLowerCase()==="all",onChange:()=>{P("all")}}),e(u,{id:"N40H+G"})," ",e("span",{class:"count",children:w.length})]}),Object.entries(bo).map(([$,q])=>!!te[$]&&e("label",{class:"filter-cat",title:(te[$]/w.length*100).toFixed(2)+"%",children:[e("input",{type:"radio",name:"filter-cat",checked:N.toLowerCase()===$.toLowerCase(),onChange:()=>{P($),$==="boosts"&&(ie("reblogsCount"),ce("desc"),ve(null))}}),n(q)," ",e("span",{class:"count",children:te[$]})]},n(q)))]}),w.length>=2&&!!$e&&e("div",{class:"catchup-filters authors-filters",ref:ye,children:[Ce.map($=>e("label",{class:"filter-author","data-author":$,children:[e("input",{type:"radio",name:"filter-author",checked:B===$,onChange:()=>{V($)},onClick:()=>{B===$&&V(null)}}),e(rt,{url:_e[$].avatarStatic||_e[$].avatar,size:"xxl",alt:`${_e[$].displayName} (@${_e[$].acct})`})," ",e("span",{class:"count",children:$e[$]}),e("span",{class:"username",children:_e[$].username})]},`${$}-${$e[$]}`)),Ce.length>5&&e("small",{style:{whiteSpace:"nowrap",paddingInline:"1em",opacity:.33},children:e(u,{id:"HHtYi7",values:{0:Ce.length}})},"authors-count")]}),w.length>=2&&e("div",{class:"catchup-filters",children:[e("span",{class:"filter-label",children:e(u,{id:"f6Hub0"})})," ",e("fieldset",{class:"radio-field-group",children:vo.map($=>e("label",{class:"filter-sort",onClick:q=>{z===$&&(q.preventDefault(),q.stopPropagation(),ce(pe==="asc"?"desc":"asc"))},children:[e("input",{type:"radio",name:"filter-sort-cat",checked:z===$,onChange:()=>{ie($);const q=/(replies|favourites|reblogs)/.test($)?"desc":"asc";ce(q)}}),{createdAt:t._({id:"mYGY3B"}),repliesCount:t._({id:"N8UzTV"}),favouritesCount:t._({id:"zZOZj7"}),reblogsCount:t._({id:"puY2t0"}),density:t._({id:"0tQ7AD"})}[$],z===$&&(pe==="asc"?" ↑":" ↓")]},$))}),e("span",{class:"filter-label",children:e(u,{id:"L8fEEm"})})," ",e("fieldset",{class:"radio-field-group",children:yo.map($=>e("label",{class:"filter-group",children:[e("input",{type:"radio",name:"filter-group",checked:he===$,onChange:()=>{ve($)},disabled:$==="account"&&B}),{account:t._({id:"dpqPBg"})}[$]||t._({id:"EdQY6l"})]},$||"none"))}),B&&Ce.length>1?e("button",{type:"button",class:"plain6 small",onClick:()=>{V(null)},style:{whiteSpace:"nowrap"},children:e(u,{id:"/dlmrZ"})}):null]}),e("ul",{class:`catchup-list catchup-filter-${N||""} ${z?`catchup-sort-${z}`:""} ${B&&_e[B]?"catchup-selected-author":""} ${he?`catchup-group-${he}`:""}`,children:De.map(($,q)=>{var W;const ae=((W=$.reblog)==null?void 0:W.id)||$.id;let Z=!1;return he==="account"&&(Oe.current&&$.account.id!==Oe.current&&q>0&&(Z=!0),Oe.current=$.account.id),e(O,{children:[Z&&e("li",{class:"separator"}),e(So,{to:`/${c}/s/${ae}`,post:$,root:E.current})]},`${$.id}-${Z}`)})}),e("footer",{children:fe.length>5&&e("p",{children:[N==="boosts"?t._({id:"eVosYr"}):t._({id:"rhmyFK"})," ",e("button",{type:"button",class:"textual",onClick:()=>{E.current.scrollTop=0},children:e(u,{id:"0MgdN+"})}),"."]})})]})]})]}),L&&e(Ne,{onClose:()=>H(!1),children:e("div",{class:"sheet",id:"catchup-help-sheet",children:[e("button",{type:"button",class:"sheet-close",onClick:()=>H(!1),children:e(S,{icon:"x",alt:t._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(u,{id:"c3XJ18"})})}),e("main",{children:e("dl",{children:[e("dt",{children:e(u,{id:"EIZREX"})}),e("dd",{children:e(u,{id:"YmGrIy"})}),e("dt",{children:e(u,{id:"coaNtr"})}),e("dd",{children:e(u,{id:"UUrqX1"})}),e("dt",{children:e(u,{id:"ScQBC/"})}),e("dd",{children:e(u,{id:"srocAr"})}),e("dt",{children:e(u,{id:"77Emn0"})}),e("dd",{children:e("table",{children:e("tbody",{children:[e("tr",{children:[e("td",{children:e(u,{id:"Gy9P9T"})}),e("td",{children:e("kbd",{children:"j"})})]}),e("tr",{children:[e("td",{children:e(u,{id:"6XYpYY"})}),e("td",{children:e("kbd",{children:"k"})})]}),e("tr",{children:[e("td",{children:e(u,{id:"f5dduh"})}),e("td",{children:e("kbd",{children:"l"})})]}),e("tr",{children:[e("td",{children:e(u,{id:"rj0vxZ"})}),e("td",{children:e("kbd",{children:"h"})})]}),e("tr",{children:[e("td",{children:e(u,{id:"jsFF8C"})}),e("td",{children:e("kbd",{children:"Enter"})})]}),e("tr",{children:[e("td",{children:e(u,{id:"bUUv3P"})}),e("td",{children:e("kbd",{children:"."})})]})]})})})]})})]})})]})}const _o=st(function({post:t}){const{id:n,account:i,group:s,reblog:c,inReplyToId:a,inReplyToAccountId:p,_followedTags:r,_filtered:o,visibility:l,__BOOSTERS:m}=t,h=a&&p!==i.id,f=!!o,d=v=>{v.shiftKey};return e("article",{class:`post-line ${s?"group":c?"reblog":r!=null&&r.length?"followed-tags":""} ${h?"reply-to":""} ${f?"filtered":""} visibility-${l}`,onMouseEnter:d,children:[e("span",{class:"post-author",children:c?e("span",{class:"post-reblog-avatar",children:[e(rt,{url:i.avatarStatic||i.avatar,squircle:i.bot}),(m==null?void 0:m.size)>0?[...m].map(v=>e(rt,{url:v.avatarStatic||v.avatar,squircle:v.bot})):""," ",e(S,{icon:"rocket"})," ",e(At,{account:c.account,showAvatar:!0})]}):e(At,{account:i,showAvatar:!0})}),e(To,{post:c||t,filterInfo:o}),e("span",{class:"post-meta",children:[e(xo,{post:c||t})," ",e(Vt,{datetime:new Date((c==null?void 0:c.createdAt)||t.createdAt),format:"micro"})]})]})},(t,n)=>{var i,s;return((i=t==null?void 0:t.post)==null?void 0:i.id)===((s=n==null?void 0:n.post)==null?void 0:s.id)}),So=({root:t,to:n,...i})=>{const s=Y(),[c,a]=R(!1);return Q(()=>{const p=new IntersectionObserver(r=>{r[0].isIntersecting&&(queueMicrotask(()=>a(!0)),p.unobserve(s.current))},{root:t,rootMargin:`${Math.max(320,screen.height*.75)}px`});return s.current&&p.observe(s.current),()=>{s.current&&p.unobserve(s.current)}},[]),c?e("li",{children:e(de,{to:n,children:e(_o,{...i})})}):e("li",{ref:s,style:{height:"4em"}})},Io=8,Co=8;function Mi(t){var o;const{spoilerText:n,content:i,poll:s,mediaAttachments:c,card:a}=t,p=(o=s==null?void 0:s.options)!=null&&o.length?s.options.reduce((l,m)=>l+m.title,""):"";return(n.length+ss(i)+p.length)/140+(c!=null&&c.length?Io*c.length:a!=null&&a.image?Co:0)}const _t=48;function To({post:t,filterInfo:n}){var y;const{spoilerText:i,sensitive:s,content:c,emojis:a,poll:p,mediaAttachments:r,card:o,inReplyToId:l,inReplyToAccountId:m,account:h,_thread:f}=t,d=l&&m===h.id||!!f,v=be(()=>!!(we.account.get("preferences")||{})["reading:expand:spoilers"],[]),b=v||!i&&!s,w=c?Vn(t):"",k=!i||v;return e("div",{class:"post-peek",title:i?"":w,children:[e("span",{class:"post-peek-content",children:[d&&!k&&e(O,{children:[e("span",{class:"post-peek-tag post-peek-thread",children:"Thread"})," "]}),n?e("span",{class:"post-peek-filtered",children:n!=null&&n.titlesStr?g._({id:"suKjh3",values:{0:n.titlesStr}}):g._({id:"03Qqf9"})}):e(O,{children:[!!i&&e("span",{class:"post-peek-spoiler",children:[e(S,{icon:`${v?"eye-open":"eye-close"}`})," ",i]}),k&&e("div",{class:"post-peek-html",children:[d&&e(O,{children:[e("span",{class:"post-peek-tag post-peek-thread",children:e(u,{id:"e66y2Z"})})," "]}),!!c&&e("div",{dangerouslySetInnerHTML:{__html:gc(c,a)}}),!!((y=p==null?void 0:p.options)!=null&&y.length)&&p.options.map(I=>e("div",{children:[p.multiple?"▪️":"•"," ",I.title]})),!c&&(r==null?void 0:r.length)===1&&r[0].description&&e(O,{children:[e("span",{class:"post-peek-tag post-peek-alt",children:"ALT"})," ",e("div",{children:r[0].description})]})]})]})]}),!n&&e("span",{class:"post-peek-post-content",children:[!!p&&e("span",{class:"post-peek-tag post-peek-poll",children:[e(S,{icon:"poll",size:"s"}),e(u,{id:"4WUbF1"})]}),r!=null&&r.length?r.map(I=>{var U,M,D,j,te,J,N,P,B,V;const _=I.previewUrl||I.url,C=I.previewRemoteUrl||I.remoteUrl,T=(U=I.meta)!=null&&U.original?I.meta.original.width:((D=(M=I.meta)==null?void 0:M.small)==null?void 0:D.width)||((te=(j=I.meta)==null?void 0:j.original)==null?void 0:te.width),x=(J=I.meta)!=null&&J.original?I.meta.original.height:((P=(N=I.meta)==null?void 0:N.small)==null?void 0:P.height)||((V=(B=I.meta)==null?void 0:B.original)==null?void 0:V.height);return e("span",{class:"post-peek-media",children:{image:(_||C)&&b?e("img",{src:_,width:_t,height:_t,alt:I.description,loading:"lazy",onError:F=>{const{src:ee}=F.target;ee===_&&(F.target.src=C)},style:{"--anim-duration":`${Math.min(Math.max(Math.max(T,x)/100,5),120)}s`}}):e("span",{class:"post-peek-faux-media",children:"🖼"}),gifv:(_||C)&&b?e("img",{src:_,width:_t,height:_t,alt:I.description,loading:"lazy",onError:F=>{const{src:ee}=F.target;ee===_&&(F.target.src=C)}}):e("span",{class:"post-peek-faux-media",children:"🎞️"}),video:(_||C)&&b?e("img",{src:_,width:_t,height:_t,alt:I.description,loading:"lazy",onError:F=>{const{src:ee}=F.target;ee===_&&(F.target.src=C)}}):e("span",{class:"post-peek-faux-media",children:"📹"}),audio:e("span",{class:"post-peek-faux-media",children:"🎵"})}[I.type]||null},I.id)}):!!o&&o.image&&b&&e("span",{class:`post-peek-media post-peek-card card-${o.type||""}`,children:o.image?e("img",{src:o.image,width:_t,height:_t,alt:o.title||o.description||o.imageDescription,loading:"lazy",style:{"--anim-duration":o.width&&o.height&&`${Math.min(Math.max(Math.max(o.width,o.height)/100,5),120)}s`}}):e("span",{class:"post-peek-faux-media",children:"🔗"})})]})]})}function xo({post:t}){const{reblogsCount:n,repliesCount:i,favouritesCount:s}=t;return e("span",{class:"post-stats",children:[i>0&&e("span",{class:"post-stat-replies",children:[e(S,{icon:"comment2",size:"s",alt:g._({id:"N8UzTV"})})," ",Ve(i)]}),s>0&&e("span",{class:"post-stat-likes",children:[e(S,{icon:"heart",size:"s",alt:g._({id:"zZOZj7"})})," ",Ve(s)]}),n>0&&e("span",{class:"post-stat-boosts",children:[e(S,{icon:"rocket",size:"s",alt:g._({id:"puY2t0"})})," ",Ve(n)]})]})}function Ao(t,n,i){const s=t.map(o=>new Date(o[n])),c=s.reduce((o,l)=>l<o?l:o,s[0]),p=s.reduce((o,l)=>l>o?l:o,s[0]).getTime()-c.getTime(),r=Array.from({length:i},()=>[]);return t.forEach(o=>{const m=(new Date(o[n]).getTime()-c.getTime())/p,h=Math.floor(m*(i-1));r[h].push(o)}),r}const Eo=20;function Is(){We(g._({id:"zZOZj7"}),"/favourites");const{masto:t,instance:n}=se(),i=Y();async function s(c){return(c||!i.current)&&(i.current=t.v1.favourites.list({limit:Eo})),await i.current.next()}return e(kt,{title:g._({id:"zZOZj7"}),id:"favourites",emptyText:"No likes yet. Go like something!",errorText:g._({id:"khVljG"}),instance:n,fetchItems:s})}const Ro=["home","public","notifications","thread","account"],Di=["notifications","thread","account"],Lo={home:{id:"Buy2bt"},notifications:{id:"iDNBZe"},public:{id:"RO10dm"},thread:{id:"EnJuK0"},account:{id:"vrQQgz"}},$o=[0,30*60,60*60,6*60*60,12*60*60,60*60*24,60*60*24*7,60*60*24*30],Rn={0:{id:"qqeAJM"},1800:Xe(30,"minute"),3600:Xe(1,"hour"),21600:Xe(6,"hour"),43200:Xe(12,"hour"),86400:Xe(24,"hour"),604800:Xe(7,"day"),2592e3:Xe(30,"day")};function Mo(){const{masto:t}=se();We(g._({id:"cSev+j"}),"/ft");const[n,i]=R("default"),[s,c]=R(!1),[a,p]=Lt(l=>l+1,0),[r,o]=R([]);return Q(()=>{i("loading"),(async()=>{try{const l=await t.v2.filters.list();l.sort((m,h)=>m.title.localeCompare(h.title)),l.forEach(m=>{var h;(h=m.keywords)!=null&&h.length&&m.keywords.sort((f,d)=>f.id-d.id)}),o(l),i("default")}catch{i("error")}})()},[a]),e("div",{id:"filters-page",class:"deck-container",tabIndex:"-1",children:[e("div",{class:"timeline-deck deck",children:[e("header",{children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Dt,{}),e(de,{to:"/",class:"button plain",children:e(S,{icon:"home",size:"l",alt:g._({id:"i0qMbr"})})})]}),e("h1",{children:e(u,{id:"cSev+j"})}),e("div",{class:"header-side",children:e("button",{type:"button",class:"plain",onClick:()=>{c(!0)},children:e(S,{icon:"plus",size:"l",alt:g._({id:"yFfBdX"})})})})]})}),e("main",{children:r.length>0?e(O,{children:[e("ul",{class:"filters-list",children:r.map(l=>{const{id:m,title:h,expiresAt:f,keywords:d}=l;return e("li",{children:[e("div",{children:[e("h2",{children:h}),(d==null?void 0:d.length)>0&&e("div",{children:d.map(v=>e(O,{children:[e("span",{class:"tag collapsed insignificant",children:v.wholeWord?`“${v.keyword}”`:v.keyword})," "]}))}),e("small",{class:"insignificant",children:e(Cs,{expiresAt:f})})]}),e("button",{type:"button",class:"plain",onClick:()=>{c({filter:l})},children:e(S,{icon:"pencil",size:"l",alt:"Edit filter"})})]},m)})}),r.length>1&&e("footer",{class:"ui-state",children:e("small",{class:"insignificant",children:e(u,{id:"5vzJxv",values:{0:r.length}})})})]}):n==="loading"?e("p",{class:"ui-state",children:e(Le,{})}):n==="error"?e("p",{class:"ui-state",children:e(u,{id:"qcAUwp"})}):e("p",{class:"ui-state",children:e(u,{id:"cWIHTt"})})})]}),!!s&&e(Ne,{title:g._({id:"vCSBPD"}),onClose:()=>{c(!1)},children:e(No,{filter:s==null?void 0:s.filter,onClose:l=>{l.state==="success"&&p(),c(!1)}})})]})}let Do=1;const Po=()=>Do++;function No({filter:t,onClose:n}){const{_:i}=et(),{masto:s}=se(),[c,a]=R("default"),p=!!t,{context:r,expiresAt:o,id:l,keywords:m,title:h,filterAction:f}=t||{},d=!!o,v=d&&new Date(o),[b,w]=R(m||[]),k=Y(),[y,I]=R([]),[_,C]=R([]),T=b.filter(x=>!y.includes(x.id)&&!_.includes(x._id));return e("div",{class:"sheet",id:"filters-add-edit-modal",children:[!!n&&e("button",{type:"button",class:"sheet-close",onClick:n,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:p?g._({id:"3mOee6"}):g._({id:"yFfBdX"})})}),e("main",{children:e("form",{onSubmit:x=>{x.preventDefault();const U=new FormData(x.target),M=U.get("title"),D=U.getAll("keyword_attributes[][id]"),j=U.getAll("keyword_attributes[][keyword]"),te=[...k.current.querySelectorAll('input[name="keyword_attributes[][whole_word]"]')].map(V=>V.checked),J=j.map((V,F)=>({id:D[F]||void 0,keyword:V,wholeWord:te[F]}));p&&(y!=null&&y.length)&&y.forEach(V=>{J.push({id:V,_destroy:!0})});const N=U.getAll("context");let P=U.get("expires_in");const B=U.get("filter_action");!M||!(N!=null&&N.length)||(a("loading"),(async()=>{try{let V;p?(P===""||P===null?d?P=Math.floor((v-new Date)/1e3):P=null:P==="0"||P===0?P=null:P=+P,V=await s.v2.filters.$select(l).update({title:M,context:N,expiresIn:P,keywordsAttributes:J,filterAction:B})):(P=+P||null,V=await s.v2.filters.create({title:M,context:N,expiresIn:P,keywordsAttributes:J,filterAction:B})),a("default"),n==null||n({state:"success",filter:V})}catch{a("error"),alert(p?g._({id:"H8RP+h"}):g._({id:"Fr0hAN"}))}})())},children:[e("div",{class:"filter-form-row",children:e("label",{children:[e("b",{children:e(u,{id:"MHrjPM"})}),e("input",{type:"text",name:"title",defaultValue:h,disabled:c==="loading",dir:"auto",required:!0})]})}),e("div",{class:"filter-form-keywords",ref:k,children:[T.length?e("ul",{class:"filter-keywords",children:T.map(x=>{const{id:U,keyword:M,wholeWord:D,_id:j}=x;return e("li",{children:[e("input",{type:"hidden",name:"keyword_attributes[][id]",value:U}),e("input",{name:"keyword_attributes[][keyword]",type:"text",defaultValue:M,disabled:c==="loading",required:!0,dir:"auto"}),e("div",{class:"filter-keyword-actions",children:[e("label",{children:[e("input",{name:"keyword_attributes[][whole_word]",type:"checkbox",value:U,defaultChecked:D,disabled:c==="loading"})," ",e(u,{id:"/7UQ7y"})]}),e("button",{type:"button",class:"light danger small",disabled:c==="loading",onClick:()=>{U?(y.push(U),I([...y])):j&&(_.push(j),C([..._]))},children:e(S,{icon:"x",alt:g._({id:"t/YqKh"})})})]})]},`${U}-${j}`)})}):e("div",{class:"filter-keywords",children:e("div",{class:"insignificant",children:e(u,{id:"SYKm3p"})})}),e("footer",{class:"filter-keywords-footer",children:[e("button",{type:"button",class:"light",onClick:()=>{w([...b,{_id:Po(),keyword:"",wholeWord:!0}]),setTimeout(()=>{var U,M;const x=k.current.querySelectorAll('input[type="text"]');(M=(U=x[x.length-1])==null?void 0:U.focus)==null||M.call(U)},10)},children:e(u,{id:"qn5Dbn"})})," ",(T==null?void 0:T.length)>1&&e("small",{class:"insignificant",children:e(u,{id:"1JZ175",values:{0:T.length}})})]})]}),e("div",{class:"filter-form-cols",children:[e("div",{class:"filter-form-col",children:[e("div",{children:e("b",{children:e(u,{id:"uqf7Yq"})})}),Ro.map(x=>e("div",{children:[e("label",{class:Di.includes(x)?"insignificant":"",children:[e("input",{type:"checkbox",name:"context",value:x,defaultChecked:r?r.includes(x):!0,disabled:c==="loading"})," ",i(Lo[x]),Di.includes(x)?"*":""]})," "]})),e("p",{children:e("small",{class:"insignificant",children:e(u,{id:"m0G499"})})})]}),e("div",{class:"filter-form-col",children:[p&&e(u,{id:"ucJk3m",components:{0:e("b",{}),1:e(Cs,{expiresAt:o,showNeverExpires:!0})}}),e("div",{children:[e("label",{for:"filters-expires_in",children:p?g._({id:"BcNdg+"}):g._({id:"agO/T/"})}),e("select",{id:"filters-expires_in",name:"expires_in",disabled:c==="loading",defaultValue:p?void 0:0,children:[p&&e("option",{}),$o.map(x=>e("option",{value:x,children:typeof Rn[x]=="function"?Rn[x]():i(Rn[x])}))]})]}),e("p",{children:[e(u,{id:"blQMpa"}),e("br",{}),e("label",{class:"ib",children:[e("input",{type:"radio",name:"filter_action",value:"warn",defaultChecked:f==="warn"||!p,disabled:c==="loading"})," ",e(u,{id:"jbreWy"})]})," ",e("label",{class:"ib",children:[e("input",{type:"radio",name:"filter_action",value:"hide",defaultChecked:f==="hide",disabled:c==="loading"})," ",e(u,{id:"zNCBmf"})]})]})]})]}),e("footer",{class:"filter-form-footer",children:[e("span",{children:[e("button",{type:"submit",disabled:c==="loading",children:p?g._({id:"tfDRzk"}):g._({id:"hYgDIe"})})," ",e(Le,{abrupt:!0,hidden:c!=="loading"})]}),p&&e(ot,{disabled:c==="loading",align:"end",menuItemClassName:"danger",confirmLabel:g._({id:"BPjyR2"}),onClick:()=>{a("loading"),(async()=>{try{await s.v2.filters.$select(l).remove(),a("default"),n==null||n({state:"success"})}catch{a("error"),alert(g._({id:"4Dh9J1"}))}})()},children:e("button",{type:"button",class:"light danger",onClick:()=>{},disabled:c==="loading",children:e(u,{id:"Jb6/SB"})})})]})]})})]})}function Cs({expiresAt:t,showNeverExpires:n}){const i=!!t,s=i&&new Date(t),c=i&&s<=new Date,[a,p]=Lt(r=>r+1,0);return Hn(p,c||3e4),c?g._({id:"M1RnFv"}):i?e(u,{id:"urGtsw",components:{0:e(Vt,{datetime:s})}}):n&&g._({id:"O1Aswy"})}function Oo(){const{masto:t,instance:n}=se();We(g._({id:"Xi1/bw"}),"/fh");const[i,s]=R("default"),[c,a]=R([]);return Q(()=>{s("loading"),(async()=>{try{const p=await yn();a(p),s("default")}catch{s("error")}})()},[]),e("div",{id:"followed-hashtags-page",class:"deck-container",tabIndex:"-1",children:e("div",{class:"timeline-deck deck",children:[e("header",{children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Dt,{}),e(de,{to:"/",class:"button plain",children:e(S,{icon:"home",size:"l",alt:g._({id:"i0qMbr"})})})]}),e("h1",{children:e(u,{id:"Xi1/bw"})}),e("div",{class:"header-side"})]})}),e("main",{children:c.length>0?e(O,{children:[e("ul",{class:"link-list",children:c.map(p=>e("li",{children:e(de,{to:n?`/${n}/t/${p.name}`:`/t/${p.name}`,children:[e(S,{icon:"hashtag",alt:"#"})," ",e("span",{children:p.name})]})}))}),c.length>1&&e("footer",{class:"ui-state",children:e("small",{class:"insignificant",children:e(u,{id:"2S/uvJ",values:{0:c.length}})})})]}):i==="loading"?e("p",{class:"ui-state",children:e(Le,{abrupt:!0})}):i==="error"?e("p",{class:"ui-state",children:e(u,{id:"2AeREO"})}):e("p",{class:"ui-state",children:e(u,{id:"vKsGhk"})})})]})})}const zo=20;function ai({title:t,path:n,id:i,...s}){We(t||g._({id:"y6sq5j"}),n||"/following");const{masto:c,streaming:a,instance:p}=se(),r=Fe(A),o=Y(),l=Y(),m=Ke("@pixelfed/home-include-reblogs");async function h(d){var w;(d||!o.current)&&(o.current=c.v1.timelines.home.list({limit:zo})),m&&((w=o.current)!=null&&w.nextParams)&&(typeof o.current.nextParams=="string"?o.current.nextParams+="&include_reblogs=true":o.current.nextParams.include_reblogs=!0);const v=await o.current.next();let{value:b}=v;if(b!=null&&b.length){let k=!1;d&&(b[0].id!==l.current&&(k=!0),l.current=b[0].id),b.forEach(y=>{Ge(y,p)}),b=Ri(b,p),d&&k&&Qa(),_s(b,p),b.sort((y,I)=>{const _=new Date(y.createdAt);return new Date(I.createdAt)-_})}return{...v,value:b}}async function f(){var d;try{const v={limit:5,since_id:l.current};Ke("@pixelfed/home-include-reblogs")&&(v.include_reblogs=!0);const b=await c.v1.timelines.home.list(v).next();let{value:w}=b;const k=((d=w[0])==null?void 0:d.id)===l.current;return!!(w!=null&&w.length&&!k&&(l.current=w[0].id,w=Ri(w,p),w=Et(w,"home"),w.some(y=>!y.reblog)))}catch{return!1}}return Q(()=>{let d;return(async()=>{if(a){d=a.user.subscribe();for await(const v of d){if(!d)break;if(v.event==="status.update"){const b=v.payload;Ge(b,p)}else if(v.event==="delete"){const b=v.payload,w=Zi(b,p);w&&(w._deleted=!0)}}}})(),()=>{var v;(v=d==null?void 0:d.unsubscribe)==null||v.call(d),d=null}},[a]),e(kt,{title:t||g._({id:"y6sq5j"}),id:i||"following",emptyText:g._({id:"nJEKbY"}),errorText:g._({id:"7QSeK6"}),instance:p,fetchItems:h,checkForUpdates:f,useItemID:!0,boostsCarousel:r.settings.boostsCarousel,...s,filterContext:"home",showFollowedTags:!0,showReplyParent:!0})}const Uo=20,Fo=4,Pi=Fo+1;function Ts({media:t,columnMode:n,...i}){let{hashtag:s,...c}=n?{}:$t();i.hashtag&&(s=i.hashtag);let a=s.trim().split(/[\s+]+/);a.sort(),s=a[0];const[p,r]=dt(),o=t||!!p.get("media"),l=o?"?media=1":"",{masto:m,instance:h,authenticated:f}=se({instance:(i==null?void 0:i.instance)||c.instance}),{masto:d,instance:v,authenticated:b}=se(),w=a.map(F=>`#${F}`).join(" "),k=h?o?g._({id:"kH0rA0",values:{hashtagTitle:w,instance:h}}):g._({id:"IK0zKi",values:{hashtagTitle:w,instance:h}}):o?g._({id:"hHSI3w",values:{hashtagTitle:w}}):g._({id:"+ZzjRY",values:{hashtagTitle:w}});We(k,"/:instance?/t/:hashtag");const y=Y(),I=be(()=>Bn(),[]),_=Y(void 0);async function C(F){const ee=await m.v1.timelines.tag.$select(s).list({limit:Uo,any:a.slice(1),maxId:F?void 0:_.current,onlyMedia:o?!0:void 0}).next();let{value:z}=ee;return z!=null&&z.length&&(F&&(y.current=z[0].id),z.forEach(ie=>{Ge(ie,h,{skipThreading:o||I})}),_.current=z[z.length-1].id),{...ee,value:z}}async function T(){var F;try{const ee=await m.v1.timelines.tag.$select(s).list({limit:1,any:a.slice(1),since_id:y.current,onlyMedia:o}).next();let{value:z}=ee;const ie=((F=z[0])==null?void 0:F.id)===y.current;return z!=null&&z.length&&!ie?(z=Et(z,"public"),!0):!1}catch{return!1}}const[x,U]=R("default"),[M,D]=R();Q(()=>{(async()=>{try{const F=await m.v1.tags.$select(s).fetch();D(F)}catch{}})()},[s]);const j=a.length>=Pi,[te,J]=R("default"),[N,P]=R([]),[B,V]=R(!1);return Q(()=>{f&&(async()=>{try{const F=await m.v1.featuredTags.list();P(F),V(F.some(ee=>ee.name.toLowerCase()===s.toLowerCase()))}catch{}})()},[]),e(kt,{title:k,titleComponent:!!h&&e("h1",{class:"header-double-lines",children:[e("b",{dir:"auto",children:w}),e("div",{children:h})]}),id:"hashtag",instance:h,emptyText:g._({id:"CNSLAW"}),errorText:g._({id:"yjj6Ll"}),fetchItems:C,checkForUpdates:T,useItemID:!0,view:o||I?"media":void 0,refresh:o,filterContext:"public",headerEnd:e(it,{portal:!0,setDownOverflow:!0,overflow:"auto",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(S,{icon:"more",size:"l",alt:g._({id:"2FYpfJ"})})}),children:[!!M&&a.length===1&&e(O,{children:[e(ot,{subMenu:!0,confirm:M.following,confirmLabel:`Unfollow #${s}?`,disabled:x==="loading"||!f,onClick:()=>{U("loading"),M.following?m.v1.tags.$select(s).unfollow().then(()=>{D({...M,following:!1}),le(g._({id:"doK/ij",values:{hashtag:s}}))}).catch(F=>{alert(F)}).finally(()=>{U("default")}):m.v1.tags.$select(s).follow().then(()=>{D({...M,following:!0}),le(g._({id:"R9+aEN",values:{hashtag:s}}))}).catch(F=>{alert(F)}).finally(()=>{U("default")})},children:M.following?e(O,{children:[e(S,{icon:"check-circle"})," ",e("span",{children:e(u,{id:"HOSk7R"})})]}):e(O,{children:[e(S,{icon:"plus"})," ",e("span",{children:e(u,{id:"MKEPCY"})})]})}),e(ge,{type:"checkbox",checked:B,disabled:te==="loading"||!f,onClick:()=>{if(J("loading"),B){const F=N.find(ee=>ee.name.toLowerCase()===s.toLowerCase()).id;F?m.v1.featuredTags.$select(F).remove().then(()=>{V(!1),le(g._({id:"VH+Tf9"})),P(N.filter(ee=>ee.id!==F))}).catch(ee=>{}).finally(()=>{J("default")}):le(g._({id:"3OLv47"}))}else m.v1.featuredTags.create({name:s}).then(F=>{V(!0),le(g._({id:"9ra4hn"})),P(N.concat(F))}).catch(F=>{}).finally(()=>{J("default")})},children:B?e(O,{children:[e(S,{icon:"check-circle"}),e("span",{children:e(u,{id:"9ra4hn"})})]}):e(O,{children:[e(S,{icon:"check-circle"}),e("span",{children:e(u,{id:"UlJ3QN"})})]})}),e(je,{})]}),!I&&e(O,{children:[e(cs,{className:"plain",children:e(u,{id:"cSev+j"})}),e(ge,{type:"checkbox",checked:!!o,onClick:()=>{o?p.delete("media"):p.set("media","1"),r(p)},children:[e(S,{icon:"check-circle",alt:"☑️"})," ",e("span",{class:"menu-grow",children:e(u,{id:"eK4SL/"})})]}),e(je,{})]}),e(bc,{className:"menu-field",disabled:j,children:({ref:F})=>e("form",{onSubmit:ee=>{var ie,pe;ee.preventDefault();const z=(pe=(ie=ee.target[0].value)==null?void 0:ie.trim)==null?void 0:pe.call(ie);z&&!a.some(ce=>ce.toLowerCase()===z.toLowerCase())&&(a.push(z),a.sort(),location.hash=h?`/${h}/t/${a.join("+")}`:`/t/${a.join("+")}${l}`)},children:[e(S,{icon:"hashtag"}),e("input",{ref:F,type:"text",placeholder:j?g._({id:"ouWc/D",values:{TOTAL_TAGS_LIMIT:Pi}}):g._({id:"cxL5F9"}),required:!0,autocorrect:"off",autocapitalize:"off",spellCheck:!1,pattern:"[^#][^\\s#]+[^#]",disabled:j,dir:"auto"})]})}),e(vc,{takeOverflow:!0,children:a.map((F,ee)=>e(ge,{disabled:a.length===1,onClick:z=>{a.splice(ee,1),a.sort(),location.hash=h?`/${h}/t/${a.join("+")}${l}`:`/t/${a.join("+")}${l}`},children:[e(S,{icon:"x",alt:g._({id:"OISAkj"}),class:"danger-icon"}),e("span",{class:"bidi-isolate",children:[e("span",{class:"more-insignificant",children:"#"}),F]})]},F))}),e(je,{}),e(ge,{disabled:!b,onClick:()=>{if(A.shortcuts.length>=gt){alert(g._({id:"XN1xAY",values:{SHORTCUTS_LIMIT:gt}}));return}const F={type:"hashtag",hashtag:a.join(" "),instance:h,media:o?"on":void 0};A.shortcuts.some(z=>z.type===F.type&&z.hashtag.split(/[\s+]+/).sort().join(" ")===F.hashtag.split(/[\s+]+/).sort().join(" ")&&(z.instance?z.instance===F.instance:!0)&&(z.media?!!z.media==!!F.media:!0))?alert(g._({id:"kfeQnS"})):(A.shortcuts.push(F),le(g._({id:"MIhb91"})))},children:[e(S,{icon:"shortcut"})," ",e("span",{children:e(u,{id:"i02Lq/"})})]}),e(ge,{onClick:()=>{let F=prompt(g._({id:"2MQ2cd"}));if(!/\./.test(F)){F&&alert(g._({id:"7WddtO"}));return}F&&(F=F.toLowerCase().trim(),location.hash=`/${F}/t/${a.join("+")}${l}`)},children:[e(S,{icon:"bus"})," ",e("span",{children:e(u,{id:"Sq04Yc"})})]}),v!==h&&e(ge,{onClick:()=>{location.hash=`/${v}/t/${a.join("+")}${l}`},children:[e(S,{icon:"bus"})," ",e("small",{class:"menu-double-lines",children:e(u,{id:"iAzCp4",values:{currentInstance:v},components:{0:e("b",{})}})})]})]})},h+w)}const Bo=20;function xs(t){var k;const n=Fe(A),{masto:i,instance:s}=se(),c=(t==null?void 0:t.id)||((k=$t())==null?void 0:k.id),a=Y(),p=Y();async function r(y){(y||!p.current)&&(p.current=i.v1.timelines.list.$select(c).list({limit:Bo}));const I=await p.current.next();let{value:_}=I;return _!=null&&_.length&&(y&&(a.current=_[0].id),_.forEach(C=>{Ge(C,s)})),{...I,value:_}}async function o(){var y;try{const I=await i.v1.timelines.list.$select(c).list({limit:1,since_id:a.current});let{value:_}=I;const C=((y=_[0])==null?void 0:y.id)===a.current;return _!=null&&_.length&&!C?(_=Et(_,"home"),!0):!1}catch{return!1}}const[l,m]=R([]);Q(()=>{sn().then(m)},[]);const[h,f]=R({title:"List"});We(h.title,"/l/:id"),Q(()=>{(async()=>{try{const y=await gs(c);f(y)}catch{}})()},[c]);const[d,v]=R(!1),[b,w]=R(!1);return e(O,{children:[e(kt,{title:h.title,id:"list",emptyText:g._({id:"KkDhfU"}),errorText:g._({id:"7QSeK6"}),instance:s,fetchItems:r,checkForUpdates:o,useItemID:!0,boostsCarousel:n.settings.boostsCarousel,filterContext:"home",showReplyParent:!0,headerStart:e(it,{overflow:"auto",menuButton:e("button",{type:"button",class:"plain",children:[e(S,{icon:"list",size:"l",alt:g._({id:"h16FyT"})}),e(S,{icon:"chevron-down",size:"s"})]}),children:[e(ze,{to:"/l",children:e("span",{children:e(u,{id:"BHWx+g"})})}),(l==null?void 0:l.length)>0&&e(O,{children:[e(je,{}),l.map(y=>e(ze,{to:`/l/${y.id}`,children:e("span",{children:y.title})},y.id))]})]}),headerEnd:e(it,{portal:!0,setDownOverflow:!0,overflow:"auto",viewScroll:"close",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(S,{icon:"more",size:"l",alt:g._({id:"2FYpfJ"})})}),children:[e(ge,{onClick:()=>v({list:h}),children:[e(S,{icon:"pencil",size:"l"}),e("span",{children:e(u,{id:"ePK91l"})})]}),e(ge,{onClick:()=>w(!0),children:[e(S,{icon:"group",size:"l"}),e("span",{children:e(u,{id:"hB02vO"})})]})]})},c),d&&e(Ne,{onClick:y=>{y.target===y.currentTarget&&v(!1)},children:e(ti,{list:d==null?void 0:d.list,onClose:y=>{y.state==="success"&&y.list?f(y.list):y.state==="deleted"&&(location.hash="/l"),v(!1)}})}),b&&e(Ne,{onClick:y=>{y.target===y.currentTarget&&w(!1)},children:e(Ho,{listID:c,onClose:()=>w(!1)})})]})}const qo=40;function Ho({listID:t,onClose:n}){const{masto:i,instance:s}=se(),[c,a]=R([]),[p,r]=R("default"),[o,l]=R(!1),m=Y();async function h(f){l(!1),r("loading"),(async()=>{try{(f||!m.current)&&(m.current=i.v1.lists.$select(t).accounts.list({limit:qo}));const d=await m.current.next();let{done:v,value:b}=d;b!=null&&b.length?(a(f?b:c.concat(b)),l(!v)):l(!1),r("default")}catch{r("error")}})()}return Q(()=>{h(!0)},[]),e("div",{class:"sheet",id:"list-manage-members-container",children:[!!n&&e("button",{type:"button",class:"sheet-close",onClick:n,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(u,{id:"hB02vO"})})}),e("main",{children:e("ul",{children:[c.map(f=>e("li",{children:[e(ct,{account:f,instance:s}),e(Yo,{account:f,listID:t})]},f.id)),o&&p==="default"&&e(yt,{as:"li",onChange:f=>f&&h(),children:e("button",{type:"button",class:"light block",onClick:h,children:e(u,{id:"uXRAkV"})})})]})})]})}function Yo({account:t,listID:n}){const{masto:i}=se(),[s,c]=R("default"),[a,p]=R(!1);return e(ot,{confirm:!a,confirmLabel:e("span",{children:e(u,{id:"em8i38",values:{0:t.username}})}),align:"end",menuItemClassName:"danger",onClick:()=>{a?(c("loading"),(async()=>{try{await i.v1.lists.$select(n).accounts.create({accountIds:[t.id]}),c("default"),p(!1)}catch{c("error")}})()):(c("loading"),(async()=>{try{await i.v1.lists.$select(n).accounts.remove({accountIds:[t.id]}),c("default"),p(!0)}catch{c("error")}})())},children:e("button",{type:"button",class:`light ${a?"":"danger"}`,disabled:s==="loading",children:a?g._({id:"m16xKo"}):g._({id:"MWIaew"})})})}const jo={mention:["account","status"],status:["account","status"],reblog:["account","status"],follow:["account"],follow_request:["account"],favourite:["account","status"],poll:["status"],update:["status"]};function As(t){return t.filter(n=>{const{type:i,id:s,createdAt:c}=n;if(!i)return!1;const a=jo[i];return a!=null&&a.length?a.every(p=>!!n[p]):!0})}function Es(t){if(t!=null&&t.notificationGroups){const{accounts:n=[],notificationGroups:i=[],statuses:s=[]}=t;return i.map(c=>{const{sampleAccountIds:a,statusId:p}=c,r=(a==null?void 0:a.map(l=>n.find(m=>m.id===l)))||[],o=(s==null?void 0:s.find(l=>l.id===p))||null;return{...c,sampleAccounts:r,status:o}})}return t}function Vo(t){const n=t.map(c=>{const{latestPageNotificationAt:a,mostRecentNotificationId:p,sampleAccounts:r,notificationsCount:o}=c;return{id:""+p,createdAt:a,account:r[0],...c}}),i={},s=[];for(let c=0;c<n.length;c++){const a=n[c],{type:p,account:r,_accounts:o,sampleAccounts:l,createdAt:m}=a,h=m?new Date(m).toLocaleDateString():"",f=(l==null?void 0:l.length)===1||(o==null?void 0:o.length)===1;if((p==="favourite"||p==="reblog")&&f){const d=`${r==null?void 0:r.id}-${p}-${h}`,v=i[d];if(v)v._statuses.push(a.status),v._ids+=`-${a.id}`;else{let b=i[d]={...a,type:p,_ids:a.id,_statuses:[a.status]};s.push(b)}}else s.push(a)}return s}function Go(t){t=As(t);const n={},i=[];for(let a=0,p=0;a<t.length;a++){const r=t[a],{id:o,status:l,account:m,type:h,createdAt:f}=r,d=f?new Date(f).toLocaleDateString():"";let v=h;(h==="favourite"||h==="reblog")&&(v="favourite+reblog");const b=`${l==null?void 0:l.id}-${v}-${d}`,w=n[b];if(v==="follow_request")i[p++]=r;else if(w!=null&&w.account){const k=w._accounts.find(y=>y.id===m.id);k?(k._types.push(h),k._types.sort().reverse(),w._ids+=`-${o}`):(m._types=[h],w._accounts.push(m),w._ids+=`-${o}`)}else{m&&(m._types=[h]);let k=n[b]={...r,type:v,_ids:o,_accounts:m?[m]:[]};i[p++]=k}}const s={},c=[];for(let a=0,p=0;a<i.length;a++){const r=i[a],{id:o,account:l,_accounts:m,type:h,createdAt:f}=r,d=f?new Date(f).toLocaleDateString():"";if(h==="favourite+reblog"&&l&&m.length===1){const v=`${l==null?void 0:l.id}-${h}-${d}`,b=s[v];if(b)b._statuses.push(r.status),b._ids+=`-${o}`;else{let w=s[v]={...r,type:h,_ids:o,_statuses:[r.status]};c[p++]=w}}else c[p++]=r}return c}const Ni=20,Wo=new URLSearchParams;function Rs({columnMode:t,...n}){const{masto:i,instance:s}=se(),[c]=t?[Wo]:dt(),[a,p]=R(null),r=(n==null?void 0:n.type)||c.get("type")||a;We(r==="private"?g._({id:"2BApYc"}):g._({id:"/bZzdR"}),"/mentions");const o=Y(),l=Y();async function m(k){(k||!o.current)&&(o.current=i.v1.notifications.list({limit:Ni,types:["mention"]}));const y=await o.current.next();let{value:I}=y;return I!=null&&I.length&&(I=As(I),k&&(l.current=I[0].id),I.forEach(({status:_})=>{Ge(_,s)})),{...y,value:I==null?void 0:I.map(_=>_.status)}}const h=Y(),f=Y();async function d(k){(k||!h.current)&&(h.current=i.v1.conversations.list({limit:Ni}));const y=await h.current.next();let{value:I}=y;return I=I==null?void 0:I.filter(_=>_.lastStatus),I!=null&&I.length&&(k&&(f.current=I[0].lastStatus.id),I.forEach(({lastStatus:_})=>{Ge(_,s)})),{...y,value:I==null?void 0:I.map(_=>_.lastStatus)}}function v(...k){return r==="private"?d(...k):m(...k)}async function b(){var k;if(r==="private")try{const y=await i.v1.conversations.list({limit:1,since_id:f.current}).next();let{value:I}=y;const _=((k=I[0])==null?void 0:k.id)===f.current;return I!=null&&I.length&&!_?(f.current=I[0].lastStatus.id,!0):!1}catch{return!1}else try{const y=await i.v1.notifications.list({limit:1,types:["mention"],since_id:l.current}).next();let{value:I}=y;return I!=null&&I.length?(l.current=I[0].id,!0):!1}catch{return!1}}const w=be(()=>e("div",{class:"filter-bar centered",children:[e(de,{to:"/mentions",class:r?"":"is-active",onClick:k=>{t&&(k.preventDefault(),p(null))},children:e(u,{id:"N40H+G"})}),e(de,{to:"/mentions?type=private",class:r==="private"?"is-active":"",onClick:k=>{t&&(k.preventDefault(),p("private"))},children:e(u,{id:"zwBp5t"})})]}),[r]);return e(kt,{title:g._({id:"/bZzdR"}),id:"mentions",emptyText:g._({id:"03jFGT"}),errorText:g._({id:"pqR9KF"}),instance:s,fetchItems:v,checkForUpdates:b,useItemID:!0,timelineStart:w,refresh:r})}const Ko=80,Zo=20,Jo=new URLSearchParams,on={block:"center",inline:"center",behavior:"smooth"},Ls=Ki(()=>Ke("@mastodon/grouped-notifications"),{maxAge:1e3*60*5});function $s(t={}){const{masto:n}=se();return A.settings.groupedNotificationsAlpha&&Ls()?n.v2_alpha.notifications.list({limit:Zo,...t}):n.v1.notifications.list({limit:Ko,...t})}function Ms(t){return A.settings.groupedNotificationsAlpha&&Ls()?Vo(t):Go(t)}function Xo({columnMode:t}){var oe;We(g._({id:"iDNBZe"}),"/notifications");const{masto:n,instance:i}=se(),s=Fe(A),[c,a]=R("default"),[p]=t?[Jo]:dt(),r=p.get("id"),o=p.get("access_token"),[l,m]=R(!1),[h,f]=R(!1),d=Y(),{nearReachEnd:v,scrollDirection:b,reachStart:w,nearReachStart:k}=eo({scrollableRef:d}),y=b==="end"&&!k,[I,_]=R([]),[C,T]=R([]),x=Y();async function U(E){var H;if((E||!x.current)&&(x.current=$s({excludeTypes:["follow_request"]})),/max_id=($|&)/i.test((H=x.current)==null?void 0:H.nextParams))return{done:!0};const G=await x.current.next(),L=Es(G.value);if(L!=null&&L.length){L.forEach(ue=>{Ge(ue.status,i,{skipThreading:!0})});const K=Ms(L);E?(A.notificationsLast=K[0],A.notifications=K,n.v1.markers.create({notifications:{lastReadId:K[0].id}}).catch(()=>{})):A.notifications.push(...K)}return A.notificationsShowNew=!1,A.notificationsLastFetchTime=Date.now(),G}async function M(){try{return await n.v1.followRequests.list({limit:80})}catch{return[]}}const D=()=>{a("loading"),(async()=>{try{const E=await M();_(E),a("default")}catch{a("error")}})()};async function j(){try{return await n.v1.announcements.list()}catch{return[]}}const te=Ke("@mastodon/filtered-notifications"),[J,N]=R(!1),[P,B]=R({});function V(){return n.v1.notifications.policy.fetch().catch(()=>{})}function F(){V().then(E=>{B(E)}).catch(()=>{})}const[ee,z]=R(null);function ie(){return n.v1.notifications.requests.list()}const pe=E=>{he(!1),a("loading"),(async()=>{try{const G=U(E);E&&(j().then(H=>{H.sort((K,ue)=>{const Pe=new Date(K.updatedAt||K.createdAt);return new Date(ue.updatedAt||ue.createdAt)-Pe}),T(H)}).catch(()=>{}),M().then(H=>{_(H)}).catch(()=>{}),te&&F());const{done:L}=await G;m(!L),a("default")}catch{a("error")}})()};Q(()=>{pe(!0)},[]),Q(()=>{w&&pe(!0)},[w]);const[ce,he]=R(!1),ve=at(({disableIdleCheck:E=!1}={})=>{var G;c!=="loading"&&s.settings.autoRefresh&&((G=d.current)==null?void 0:G.scrollTop)<16&&(E||window.__IDLE__)&&!Qo()&&pe(!0)},[s.notificationsShowNew,s.settings.autoRefresh,c]),fe=Y();Bt(E=>{if(E){const G=Date.now()-fe.current;!fe.current||G>1e3*3?ve({disableIdleCheck:!0}):fe.current=Date.now()}});const _e=Y(!0);Q(()=>{let E=Js(A,"notificationsShowNew",G=>{if(_e.current){_e.current=!1;return}c!=="loading"&&(G&&ve(),he(G))});return()=>E==null?void 0:E()},[]);const $e=new Date,Me=new Date($e-24*60*60*1e3);let Ce=new Date;const De=!s.notifications.some(E=>new Date(E.createdAt).toDateString()===$e.toDateString()),Oe=Y();Q(()=>{r&&(A.routeNotification={id:r,accessToken:atob(o)})},[r,o]);const ye=".notification",X=Ue("j",()=>{const E=document.activeElement.closest(ye),G=E==null?void 0:E.getBoundingClientRect(),L=Array.from(d.current.querySelectorAll(ye));if(E&&G.top<d.current.clientHeight&&G.bottom>0){const H=L.indexOf(E);let K=L[H+1];K&&(K.focus(),K.scrollIntoView(on))}else{const H=L.find(K=>{const ue=K.getBoundingClientRect();return ue.top>=44&&ue.left>=0});H&&(H.focus(),H.scrollIntoView(on))}}),me=Ue("k",()=>{const E=document.activeElement.closest(ye),G=E==null?void 0:E.getBoundingClientRect(),L=Array.from(d.current.querySelectorAll(ye));if(E&&G.top<d.current.clientHeight&&G.bottom>0){const H=L.indexOf(E);let K=L[H-1];K&&(K.focus(),K.scrollIntoView(on))}else{const H=L.find(K=>{const ue=K.getBoundingClientRect();return ue.top>=44&&ue.left>=0});H&&(H.focus(),H.scrollIntoView(on))}}),Te=Ue(["enter","o"],()=>{const E=document.activeElement.closest(ye),G=E==null?void 0:E.querySelector(".status-link");G&&G.click()});return e("div",{id:"notifications-page",class:"deck-container",ref:E=>{d.current=E,X.current=E,me.current=E,Te.current=E},tabIndex:"-1",children:[e("div",{class:`timeline-deck deck ${h?"only-mentions":""}`,children:[e("header",{hidden:y,onClick:E=>{var G;E.target.closest("a, button")||(G=d.current)==null||G.scrollTo({top:0,behavior:"smooth"})},onDblClick:E=>{E.target.closest("a, button")||pe(!0)},class:c==="loading"?"loading":"",children:[e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Dt,{}),e(de,{to:"/",class:"button plain",children:e(S,{icon:"home",size:"l",alt:g._({id:"i0qMbr"})})})]}),e("h1",{children:e(u,{id:"iDNBZe"})}),e("div",{class:"header-side",children:te&&e("button",{type:"button",class:"button plain4",onClick:()=>{N(!0)},children:e(S,{icon:"settings",size:"l",alt:g._({id:"a/+arl"})})})})]}),ce&&c!=="loading"&&e("button",{class:"updates-button shiny-pill",type:"button",onClick:()=>{var E;pe(!0),(E=d.current)==null||E.scrollTo({top:0,behavior:"smooth"})},children:[e(S,{icon:"arrow-up"})," ",e(u,{id:"Jy9RU/"})]})]}),C.length>0&&e("div",{class:"shazam-container",children:e("div",{class:"shazam-container-inner",children:e("details",{class:"announcements",children:[e("summary",{children:[e("span",{children:[e(S,{icon:"announce",class:"announcement-icon",size:"l"})," ",e(u,{id:"0whvLM",values:{0:C.length}})," ",e("small",{class:"insignificant",children:i})]}),C.length>1&&e("span",{class:"announcements-nav-buttons",children:C.map((E,G)=>e("button",{type:"button",class:"plain2 small",onClick:()=>{var L;(L=Oe.current)==null||L.children[G].scrollIntoView({behavior:"smooth",block:"nearest"})},children:G+1}))})]}),e("ul",{class:`announcements-list-${C.length>1?"multiple":"single"}`,ref:Oe,children:C.map(E=>e("li",{children:e(er,{announcement:E})}))})]})})}),I.length>0&&e("div",{class:"follow-requests",children:[e("h2",{class:"timeline-header",children:e(u,{id:"6Fs1Ba"})}),I.length>5?e("details",{children:[e("summary",{children:e(u,{id:"7dHKu4",values:{0:I.length}})}),e("ul",{children:I.map(E=>e("li",{children:[e(ct,{account:E}),e(On,{accountID:E.id,onChange:()=>{}})]},E.id))})]}):e("ul",{children:I.map(E=>e("li",{children:[e(ct,{account:E}),e(On,{accountID:E.id,onChange:()=>{}})]},E.id))})]}),te&&((oe=P==null?void 0:P.summary)==null?void 0:oe.pendingRequestsCount)>0&&e("div",{class:"shazam-container",children:e("div",{class:"shazam-container-inner",children:e("div",{class:"filtered-notifications",children:e("details",{onToggle:async E=>{const{open:G}=E.target;if(G){const L=await ie();z(L)}},children:[e("summary",{children:e(u,{id:"N3Bq0f",values:{0:P.summary.pendingRequestsCount}})}),ee?(ee==null?void 0:ee.length)>0&&e("ul",{children:ee.map(E=>{var G,L;return e("li",{children:[e("div",{class:"request-notifcations",children:[!((G=E.lastStatus)!=null&&G.id)&&e(ct,{useAvatarStatic:!0,showStats:!0,account:E.account}),((L=E.lastStatus)==null?void 0:L.id)&&e("div",{class:"last-post",children:e(de,{class:"status-link",to:`/${i}/s/${E.lastStatus.id}`,children:e(qe,{status:E.lastStatus,size:"s",readOnly:!0})})}),e(nr,{request:E})]}),e(ir,{request:E,onChange:()=>{pe(!0)}})]},E.id)})}):e("p",{class:"ui-state",children:e(Le,{abrupt:!0})})]})})})}),e("div",{id:"mentions-option",children:e("label",{children:[e("input",{type:"checkbox",checked:h,onChange:E=>{f(E.target.checked)}})," ",e(u,{id:"0udtPI"})]})}),e("h2",{class:"timeline-header",children:e(u,{id:"ecUA8p"})}),De&&e("p",{class:"ui-state insignificant",children:c==="default"?g._({id:"KS7iJH"}):e(O,{children:"…"})}),s.notifications.length?e(O,{children:s.notifications.filter(E=>E.type!=="follow_request").map(E=>{if(h&&E.type!=="mention")return null;const G=new Date(E.createdAt),L=G.toDateString()!==Ce.toDateString();L&&(Ce=G);const H=G.toDateString()===Me.toDateString()?g._({id:"y/0uwd"}):pt(Ce,{hideTime:!0});return e(O,{children:[L&&e("h2",{class:"timeline-header",children:H}),e(Sn,{instance:i,notification:E},E._ids||E.id)]},E._ids||E.id)})}):e(O,{children:[c==="loading"&&e(O,{children:e("ul",{class:"timeline flat",children:Array.from({length:5}).map((E,G)=>e("li",{class:"notification skeleton",children:[e("div",{class:"notification-type",children:e(S,{icon:"notification",size:"xl"})}),e("div",{class:"notification-content",children:e("p",{children:"███████████ ████"})})]}))})}),c==="error"&&e("p",{class:"ui-state",children:[e(u,{id:"gjzl8E"}),e("br",{}),e("br",{}),e("button",{type:"button",onClick:()=>pe(!0),children:e(u,{id:"KDw4GX"})})]})]}),l&&e(yt,{onChange:E=>{E&&pe()},children:e("button",{type:"button",class:"plain block",disabled:c==="loading",onClick:()=>pe(),style:{marginBlockEnd:"6em"},children:c==="loading"?e(Le,{abrupt:!0}):e(u,{id:"uXRAkV"})})})]}),te&&J&&e(Ne,{onClick:E=>{E.target===E.currentTarget&&N(!1)},children:e("div",{class:"sheet",id:"notifications-settings",tabIndex:"-1",children:[e("button",{type:"button",class:"sheet-close",onClick:()=>N(!1),children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(u,{id:"a/+arl"})})}),e("main",{children:e("form",{onSubmit:E=>{E.preventDefault();const{filterNotFollowing:G,filterNotFollowers:L,filterNewAccounts:H,filterPrivateMentions:K}=E.target,ue={filterNotFollowing:G.checked,filterNotFollowers:L.checked,filterNewAccounts:H.checked,filterPrivateMentions:K.checked};B({...P,...ue}),N(!1),(async()=>{try{await n.v1.notifications.policy.update(ue),le(g._({id:"4+7X9i"}))}catch{}})()},children:[e("p",{children:e(u,{id:"WrkPTf"})}),e("p",{children:e("label",{children:[e("input",{type:"checkbox",switch:!0,defaultChecked:P.filterNotFollowing,name:"filterNotFollowing"})," ",e(u,{id:"d+hDoa"})]})}),e("p",{children:e("label",{children:[e("input",{type:"checkbox",switch:!0,defaultChecked:P.filterNotFollowers,name:"filterNotFollowers"})," ",e(u,{id:"oAwuQj"})]})}),e("p",{children:e("label",{children:[e("input",{type:"checkbox",switch:!0,defaultChecked:P.filterNewAccounts,name:"filterNewAccounts"})," ",e(u,{id:"Srs8u7"})]})}),e("p",{children:e("label",{children:[e("input",{type:"checkbox",switch:!0,defaultChecked:P.filterPrivateMentions,name:"filterPrivateMentions"})," ",e(u,{id:"IDC5Uw"})]})}),e("p",{children:e("button",{type:"submit",children:e(u,{id:"tfDRzk"})})})]})})]})})]})}function Qo(){return!!document.querySelector(".deck-backdrop, #modal-container > *")}function er({announcement:t}){const{instance:n}=se(),{contact:i}=Vi(),s=i==null?void 0:i.account,{id:c,content:a,startsAt:p,endsAt:r,published:o,allDay:l,publishedAt:m,updatedAt:h,read:f,mentions:d,statuses:v,tags:b,emojis:w,reactions:k}=t,y=new Date(m),I=pt(y),_=new Date(h),C=pt(_);return e("div",{class:"announcement-block",children:[e(ct,{account:s}),e("div",{class:"announcement-content",onClick:Xi({mentions:d,instance:n}),dangerouslySetInnerHTML:{__html:$n(a,{emojis:w})}}),e("p",{class:"insignificant",children:[e("time",{datetime:y.toISOString(),children:pt(y)}),h&&C!==I&&e(O,{children:[" ","•"," ",e("span",{class:"ib",children:e(u,{id:"TbFrLc",values:{0:pt(_)},components:{0:e("time",{datetime:_.toISOString()})}})})]})]}),e("div",{class:"announcement-reactions",hidden:!0,children:k.map(T=>{const{name:x,count:U,me:M,staticUrl:D,url:j}=T;return e("button",{type:"button",class:`plain4 small ${M?"reacted":""}`,children:[j||D?e("img",{src:j||D,alt:x,width:"16",height:"16"}):e("span",{children:x})," ",e("span",{class:"count",children:Ve(U)})]})})})]})}function tr(t){const{masto:n}=se();return n.v1.notifications.list({accountID:t})}function nr({request:t}){var h;const{instance:n}=se(),[i,s]=R("loading"),{account:c,lastStatus:a}=t,[p,r]=R(!1),[o,l]=R([]);function m(){r(!1)}return Q(()=>{var f;(f=t==null?void 0:t.account)!=null&&f.id&&p&&(s("loading"),(async()=>{const d=await tr(t.account.id);l(d||[]),s("default")})())},[p,(h=t==null?void 0:t.account)==null?void 0:h.id]),e(O,{children:[e("button",{type:"button",class:"plain4 request-notifications-account",onClick:()=>{r(!0)},children:[e(S,{icon:"notification",class:"more-insignificant"})," ",e("small",{children:e(u,{id:"tflYwj",values:{0:c.username}})})," ",e(S,{icon:"chevron-down"})]}),p&&e(Ne,{onClick:f=>{f.target===f.currentTarget&&m()},children:e("div",{class:"sheet",tabIndex:"-1",children:[e("button",{type:"button",class:"sheet-close",onClick:m,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:e("b",{children:e(u,{id:"rpFxNc",values:{0:c.username}})})}),e("main",{children:i==="loading"?e("p",{class:"ui-state",children:e(Le,{abrupt:!0})}):o.map(f=>e("div",{class:"notification-peek",onClick:d=>{const{target:v}=d;(d.target.tagName==="BUTTON"||d.target.tagName==="A")&&m()},children:e(Sn,{instance:n,notification:f,isStatic:!0})}))})]})})]})}function ir({request:t,onChange:n}){const{masto:i}=se(),[s,c]=R("default"),[a,p]=R(null),r=a!==null;return e("p",{class:"notification-request-buttons",children:[e("button",{type:"button",disabled:s==="loading"||r,onClick:()=>{c("loading"),(async()=>{try{await i.v1.notifications.requests.$select(t.id).accept(),p("accept"),c("default"),n({request:t,state:"accept"}),le(g._({id:"ZtBMwU",values:{0:t.account.username}}))}catch{c("error"),le(g._({id:"S92JKG"}))}})()},children:e(u,{id:"h7peZQ"})})," ",e("button",{type:"button",disabled:s==="loading"||r,class:"light danger",onClick:()=>{c("loading"),(async()=>{try{await i.v1.notifications.requests.$select(t.id).dismiss(),p("dismiss"),c("default"),n({request:t,state:"dismiss"}),le(g._({id:"ibBDry",values:{0:t.account.username}}))}catch{c("error"),le(g._({id:"S5aemF"}))}})()},children:e(u,{id:"1QfxQT"})}),e("span",{class:"notification-request-states",children:s==="loading"?e(Le,{abrupt:!0}):a==="accept"?e(S,{icon:"check-circle",alt:g._({id:"bzMKg7"}),class:"notification-accepted"}):a==="dismiss"&&e(S,{icon:"x-circle",alt:g._({id:"J6hrEy"}),class:"notification-dismissed"})})]})}const Ds=st(Xo),sr=20;function zn({local:t,columnMode:n,...i}){const s=Fe(A),c=!!t,a=n?{}:$t(),{masto:p,instance:r}=se({instance:(i==null?void 0:i.instance)||a.instance}),{masto:o,instance:l}=se(),m=c?g._({id:"u96B/B",values:{instance:r}}):g._({id:"PgVqvd",values:{instance:r}});We(m,c?"/:instance?/p/l":"/:instance?/p");const h=Y(),f=Y();async function d(b){if(b||!f.current){const y={limit:sr,local:c||void 0};!c&&Ke("@pixelfed/global-feed")&&(y.remote=!0),f.current=p.v1.timelines.public.list(y)}const w=await f.current.next();let{value:k}=w;return k!=null&&k.length&&(b&&(h.current=k[0].id),k.forEach(y=>{Ge(y,r)})),{...w,value:k}}async function v(){var b;try{const w=await p.v1.timelines.public.list({limit:1,local:c,since_id:h.current}).next();let{value:k}=w;const y=((b=k[0])==null?void 0:b.id)===h.current;return k!=null&&k.length&&!y?(k=Et(k,"public"),!0):!1}catch{return!1}}return e(kt,{title:m,titleComponent:e("h1",{class:"header-double-lines",children:[e("b",{children:c?g._({id:"pJQgQV"}):g._({id:"cg0I+x"})}),e("div",{children:r})]}),id:"public",instance:r,emptyText:g._({id:"BiZJ6G"}),errorText:g._({id:"scd9lw"}),fetchItems:d,checkForUpdates:v,useItemID:!0,headerStart:e(O,{}),boostsCarousel:s.settings.boostsCarousel,filterContext:"public",headerEnd:e(it,{portal:!0,overflow:"auto",viewScroll:"close",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(S,{icon:"more",size:"l",alt:g._({id:"2FYpfJ"})})}),children:[e(ge,{href:c?`/#/${r}/p`:`/#/${r}/p/l`,children:c?e(O,{children:[e(S,{icon:"transfer"})," ",e("span",{children:e(u,{id:"dXMiUw"})})]}):e(O,{children:[e(S,{icon:"transfer"})," ",e("span",{children:e(u,{id:"t2B/we"})})]})}),e(je,{}),e(ge,{onClick:()=>{let b=prompt(g._({id:"2MQ2cd"}));if(!/\./.test(b)){b&&alert(g._({id:"7WddtO"}));return}b&&(b=b.toLowerCase().trim(),location.hash=c?`/${b}/p/l`:`/${b}/p`)},children:[e(S,{icon:"bus"})," ",e("span",{children:e(u,{id:"Sq04Yc"})})]}),l!==r&&e(ge,{onClick:()=>{location.hash=c?`/${l}/p/l`:`/${l}/p`},children:[e(S,{icon:"bus"})," ",e("small",{class:"menu-double-lines",children:e(u,{id:"iAzCp4",values:{currentInstance:l},components:{0:e("b",{})}})})]})]})},r+c)}const rn=5,Ln=40,cr=new URLSearchParams;function Ps({columnMode:t,...n}){const i=t?{}:$t(),{masto:s,instance:c,authenticated:a}=se({instance:i.instance}),[p,r]=R("default"),[o]=t?[cr]:dt(),l=Y(),m=(n==null?void 0:n.query)||o.get("q"),h=t?"statuses":(n==null?void 0:n.type)||o.get("type");let f=g._({id:"A1taO8"});if(m)switch(h){case"statuses":f=g._({id:"6YeoAt",values:{q:m}});break;case"accounts":f=g._({id:"fpgumQ",values:{q:m}});break;case"hashtags":f=g._({id:"AuiMZZ",values:{q:m}});break;default:f=g._({id:"wr3GZI",values:{q:m}})}We(f,"/search");const[d,v]=R(!1),b=Y(0);Q(()=>{b.current=0},[m,h]);const w=Y();vt(()=>{var N,P;(P=(N=w.current)==null?void 0:N.scrollTo)==null||P.call(N,0,0)},[m,h]);const[k,y]=R([]),[I,_]=R([]),[C,T]=R([]);Q(()=>{y([]),_([]),T([])},[m]);const x={statuses:y,accounts:_,hashtags:T},[U,M]=R({}),D=async N=>{if(!(N!=null&&N.length))return;const P=await Yn(N,U);P&&M({...U,...P})};function j(N){N&&(b.current=0),!(!N&&!a)&&(r("loading"),N&&!h&&(y(k.slice(0,rn)),_(I.slice(0,rn)),T(C.slice(0,rn))),(async()=>{var B,V;const P={q:m,resolve:a,limit:rn};h&&(P.limit=Ln,P.type=h,a&&(P.offset=b.current));try{const F=await s.v2.search.fetch(P);if(h)if(N){x[h](F[h]);const ee=(B=F[h])==null?void 0:B.length;b.current=Ln,v(!!ee)}else{x[h](z=>[...z,...F[h]]);const ee=(V=F[h])==null?void 0:V.length;b.current=b.current+Ln,v(!!ee)}else y(F.statuses||[]),_(F.accounts||[]),T(F.hashtags||[]),b.current=0,v(!1);D(F.accounts),r("default")}catch{r("error")}})())}const te=Y();Bt(N=>{var B;const P=((B=w.current)==null?void 0:B.scrollTop)===0;if(N&&P){const V=Date.now()-te.current;!te.current||V>1e3*3?j(!0):te.current=Date.now()}}),Q(()=>{var N,P,B,V;(P=(N=l.current)==null?void 0:N.setValue)==null||P.call(N,m||""),m?j(!0):(V=(B=l.current)==null?void 0:B.focus)==null||V.call(B)},[m,h,c]),Ue(["/","Slash"],N=>{var P,B,V,F;(B=(P=l.current)==null?void 0:P.focus)==null||B.call(P),(F=(V=l.current)==null?void 0:V.select)==null||F.call(V)},{preventDefault:!0});const[J]=Jn();return e("div",{id:"search-page",class:"deck-container",ref:w,children:e("div",{class:"timeline-deck deck",children:[e("header",{class:p==="loading"?"loading":"",children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:e(Dt,{})}),e(ks,{ref:l}),e("div",{class:"header-side",children:e("button",{type:"button",class:"plain",onClick:()=>{j(!0)},disabled:p==="loading",children:e(S,{icon:"search",size:"l",alt:g._({id:"A1taO8"})})})})]})}),e("main",{children:[!!m&&!t&&e("div",{ref:J,class:`filter-bar ${p==="loading"?"loading":""}`,children:[!!h&&e(de,{to:`/search${m?`?q=${encodeURIComponent(m)}`:""}`,children:[e(S,{icon:"chevron-left"})," ",e(u,{id:"N40H+G"})]}),[{label:g._({id:"bPwFdf"}),type:"accounts",to:`/search?q=${encodeURIComponent(m)}&type=accounts`},{label:g._({id:"VwUsHI"}),type:"hashtags",to:`/search?q=${encodeURIComponent(m)}&type=hashtags`},{label:g._({id:"+owNNn"}),type:"statuses",to:`/search?q=${encodeURIComponent(m)}&type=statuses`}].sort((N,P)=>N.type===h?-1:P.type===h?1:0).map(N=>e(de,{to:N.to,children:N.label},N.type))]}),m?e(O,{children:[(!h||h==="accounts")&&e(O,{children:[h!=="accounts"&&e("h2",{class:"timeline-header",children:[e(u,{id:"bPwFdf"})," ",e(de,{to:`/search?q=${encodeURIComponent(m)}&type=accounts`,children:e(S,{icon:"arrow-right",size:"l",alt:g._({id:"V1fa9u"})})})]}),I.length>0?e(O,{children:[e("ul",{class:"timeline flat accounts-list",children:I.map(N=>e("li",{children:e(ct,{account:N,instance:c,showStats:!0,relationship:U[N.id]})},N.id))}),h!=="accounts"&&e("div",{class:"ui-state",children:e(de,{class:"plain button",to:`/search?q=${encodeURIComponent(m)}&type=accounts`,children:[e(u,{id:"BMmtZ8"})," ",e(S,{icon:"arrow-right"})]})})]}):!h&&(p==="loading"?e("p",{class:"ui-state",children:e(Le,{abrupt:!0})}):e("p",{class:"ui-state",children:e(u,{id:"YYB61U"})}))]}),(!h||h==="hashtags")&&e(O,{children:[h!=="hashtags"&&e("h2",{class:"timeline-header",children:[e(u,{id:"VwUsHI"})," ",e(de,{to:`/search?q=${encodeURIComponent(m)}&type=hashtags`,children:e(S,{icon:"arrow-right",size:"l",alt:g._({id:"V1fa9u"})})})]}),C.length>0?e(O,{children:[e("ul",{class:"link-list hashtag-list",children:C.map(N=>{var F;const{name:P,history:B}=N,V=(F=B==null?void 0:B.reduce)==null?void 0:F.call(B,(ee,z)=>ee+ +z.uses,0);return e("li",{children:e(de,{to:c?`/${c}/t/${P}`:`/t/${P}`,children:[e(S,{icon:"hashtag",alt:"#"}),e("span",{children:P}),!!V&&e("span",{class:"count",children:Ve(V)})]})},`${P}-${V}`)})}),h!=="hashtags"&&e("div",{class:"ui-state",children:e(de,{class:"plain button",to:`/search?q=${encodeURIComponent(m)}&type=hashtags`,children:[e(u,{id:"Nc/W5J"})," ",e(S,{icon:"arrow-right"})]})})]}):!h&&(p==="loading"?e("p",{class:"ui-state",children:e(Le,{abrupt:!0})}):e("p",{class:"ui-state",children:e(u,{id:"4MFM3P"})}))]}),(!h||h==="statuses")&&e(O,{children:[h!=="statuses"&&e("h2",{class:"timeline-header",children:[e(u,{id:"+owNNn"})," ",e(de,{to:`/search?q=${encodeURIComponent(m)}&type=statuses`,children:e(S,{icon:"arrow-right",size:"l",alt:g._({id:"V1fa9u"})})})]}),k.length>0?e(O,{children:[e("ul",{class:"timeline",children:k.map(N=>e("li",{children:e(de,{class:"status-link",to:c?`/${c}/s/${N.id}`:`/s/${N.id}`,children:e(qe,{status:N})})},N.id))}),h!=="statuses"&&e("div",{class:"ui-state",children:e(de,{class:"plain button",to:`/search?q=${encodeURIComponent(m)}&type=statuses`,children:[e(u,{id:"LYCgej"})," ",e(S,{icon:"arrow-right"})]})})]}):!h&&(p==="loading"?e("p",{class:"ui-state",children:e(Le,{abrupt:!0})}):e("p",{class:"ui-state",children:e(u,{id:"Hzi9AA"})}))]}),!!h&&(p==="default"?d?e(yt,{onChange:N=>{N&&j()},children:e("button",{type:"button",class:"plain block",onClick:()=>j(),style:{marginBlockEnd:"6em"},children:e(u,{id:"uXRAkV"})})}):e("p",{class:"ui-state insignificant",children:e(u,{id:"2EYeAZ"})}):p==="loading"&&e("p",{class:"ui-state",children:e(Le,{abrupt:!0})}))]}):p==="loading"?e("p",{class:"ui-state",children:e(Le,{abrupt:!0})}):e("p",{class:"ui-state",children:e(u,{id:"fGn1Hk"})})]})]})})}const ar=20,Ns=10*60*1e3,or=wt(t=>t.v1.trends.links.list().next(),{maxAge:Ns}),rr=wt(t=>t.v1.trends.tags.list().next(),{maxAge:Ns});function lr(t){return Ke("@pixelfed/trending")?t.pixelfed.v2.discover.posts.trending.list({range:"daily"}):t.v1.trends.statuses.list({limit:ar})}function dr(t,n){return t.v1.timelines.link.list(n)}function Os({columnMode:t,...n}){const i=Fe(A),s=t?{}:$t(),{masto:c,instance:a}=se({instance:(n==null?void 0:n.instance)||s.instance}),{masto:p,instance:r}=se(),o=g._({id:"cI3UEs",values:{instance:a}});We(o,"/:instance?/trending");const l=Y(),m=a===r,[h,f]=R([]),[d,v]=R([]),b=Y();async function w(J){var B;if(J||!b.current){if(b.current=lr(c),Ke("@mastodon/trending-hashtags"))try{const{value:V}=await rr(c);V!=null&&V.length&&f(V)}catch{}if(Ke("@mastodon/trending-links"))try{const{value:V}=await or(c,a),F=(B=V==null?void 0:V.filter)==null?void 0:B.call(V,ee=>ee.type==="link");F!=null&&F.length&&v(F)}catch{}}const N=await b.current.next();let{value:P}=N;return P!=null&&P.length&&(J&&(l.current=P[0].id),P.forEach(V=>{Ge(V,a)})),{...N,value:P}}const[k,y]=R(!1),I=Y(),[_,C]=R(null),T=!!_,x=Y(),U=m&&Ke("@mastodon/trending-hashtags");Q(()=>{_&&x.current&&x.current.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})},[_]);const M=Y();async function D(J){(J||!I.current)&&(y(!0),I.current=dr(c,{url:_})),M.current=_;const N=await I.current.next();let{value:P}=N;return P!=null&&P.length&&(P=Et(P,"public"),P.forEach(B=>{Ge(B,a)})),M.current===_&&y(!1),{...N,value:P}}async function j(){try{const J=await c.v1.trends.statuses.list({limit:1}).next();let{value:N}=J;return N=Et(N,"public"),N!=null&&N.length&&N[0].id!==l.current?(l.current=N[0].id,!0):!1}catch{return!1}}const te=be(()=>e(O,{children:[!!h.length&&e("div",{class:"filter-bar expandable",children:[e(S,{icon:"chart",class:"insignificant",size:"l"}),h.map((J,N)=>{const{name:P,history:B}=J,V=B.reduce((F,ee)=>F+ +ee.uses,0);return e(de,{to:`/${a}/t/${P}`,children:[e("span",{dir:"auto",children:[e("span",{class:"more-insignificant",children:"#"}),P]}),e("span",{class:"filter-count",children:Ve(V)})]},P)})]}),!!d.length&&e("div",{class:"links-bar",children:[e("header",{children:e("h3",{children:e(u,{id:"9veeTb"})})}),d.map(J=>{const{authorName:N,authorUrl:P,blurhash:B,description:V,height:F,image:ee,imageDescription:z,language:ie,providerName:pe,providerUrl:ce,publishedAt:he,title:ve,url:fe,width:_e}=J,$e=Gt.toUnicode(URL.parse(fe).hostname.replace(/^www\./,"").replace(/\/$/,""));let Me;if(B){const Ce=jn(B),De=ni(Ce);Me=ii([.6,De[1],De[2]])}return e("div",{children:[e("a",{ref:_===fe?x:null,href:fe,target:"_blank",rel:"noopener noreferrer",class:T?_===fe?"active":"inactive":"",style:Me?{"--accent-color":`rgb(${Me.join(",")})`,"--accent-alpha-color":`rgba(${Me.join(",")}, 0.4)`}:{},children:e("article",{children:[e("figure",{children:e("img",{src:ee,alt:z,width:_e,height:F,loading:"lazy"})}),e("div",{class:"article-body",children:[e("header",{children:[e("div",{class:"article-meta",children:[e("span",{class:"domain",children:$e})," ",!!he&&e(O,{children:"· "}),!!he&&e(O,{children:e(Vt,{datetime:he,format:"micro"})})]}),!!ve&&e("h1",{class:"title",lang:ie,dir:"auto",title:ve,children:ve})]}),!!V&&e("p",{class:"description",lang:ie,dir:"auto",title:V,children:V})]})]})}),U&&e("button",{type:"button",class:"small plain4 block",onClick:()=>{C(fe)},disabled:fe===_,children:[e(S,{icon:"comment2"})," ",e("span",{children:e(u,{id:"/bZzdR"})})," ",e(S,{icon:"chevron-down"})]})]},fe)})]}),U&&!!d.length&&e("div",{class:`timeline-header-block ${T?"blended":""}`,children:T?e(O,{children:[e("div",{style:{width:50,flexShrink:0,textAlign:"center"},children:k?e(Le,{abrupt:!0}):e("button",{type:"button",class:"light",onClick:()=>{C(null)},children:e(S,{icon:"x",alt:g._({id:"9Q/4xJ"})})})}),e("p",{children:e(u,{id:"BATCqf",values:{0:_.replace(/^https?:\/\/(www\.)?/i,"").replace(/\/$/,"")},components:{0:e("span",{class:"link-text"})}})})]}):e("p",{class:"insignificant",children:e(u,{id:"Vosm4k"})})})]}),[h,d,_,k]);return e(kt,{title:o,titleComponent:e("h1",{class:"header-double-lines",children:[e("b",{children:e(u,{id:"4/iCqx"})}),e("div",{children:a})]}),id:"trending",instance:a,emptyText:g._({id:"6HA9+s"}),errorText:g._({id:"scd9lw"}),fetchItems:T?D:w,checkForUpdates:T?void 0:j,checkForUpdatesInterval:5*60*1e3,useItemID:!0,headerStart:e(O,{}),boostsCarousel:i.settings.boostsCarousel,filterContext:"public",timelineStart:te,refresh:_,clearWhenRefresh:!0,view:T?"link-mentions":void 0,headerEnd:e(it,{portal:!0,overflow:"auto",viewScroll:"close",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(S,{icon:"more",size:"l",alt:g._({id:"2FYpfJ"})})}),children:[e(ge,{onClick:()=>{let J=prompt(g._({id:"2MQ2cd"}));if(!/\./.test(J)){J&&alert(g._({id:"7WddtO"}));return}J&&(J=J.toLowerCase().trim(),location.hash=`/${J}/trending`)},children:[e(S,{icon:"bus"})," ",e("span",{children:e(u,{id:"Sq04Yc"})})]}),r!==a&&e(ge,{onClick:()=>{location.hash=`/${r}/trending`},children:[e(S,{icon:"bus"})," ",e("small",{class:"menu-double-lines",children:e(u,{id:"iAzCp4",values:{currentInstance:r},components:{0:e("b",{})}})})]})]})},a)}function ur(){We(g._({id:"i0qMbr"}),"/");const t=Fe(A),{shortcuts:n}=t,i=n.map(s=>{if(!s)return null;const{type:c,...a}=s,p={following:ai,notifications:Ds,list:xs,public:zn,bookmarks:Ss,favourites:Is,hashtag:Ts,mentions:Rs,trending:Os,search:Ps}[c];return!p||c==="search"&&!a.query||c==="list"&&!a.id?null:e(p,{...a,columnMode:!0},c+JSON.stringify(a))});return Ue(["1","2","3","4","5","6","7","8","9"],(s,c)=>{try{const a=parseInt(c.keys[0],10)-1;document.querySelectorAll("#columns > *")[a].focus()}catch{}}),e("div",{id:"columns",onContextMenu:s=>{s.target.closest(".deck > header")&&!s.target.closest("a")&&!s.target.closest("button")&&(s.preventDefault(),A.showShortcutsSettings=!0)},children:i})}function hr(){var n;const t=Fe(A);return Q(()=>{(async()=>{const i=await lt.drafts.keys();if(i.length){const s=mn();i.filter(a=>a.startsWith(s)).length&&(A.showDrafts=!0)}})()},[]),e(O,{children:(t.settings.shortcutsViewMode==="multi-column"||!t.settings.shortcutsViewMode&&t.settings.shortcutsColumnsMode)&&((n=t.shortcuts)!=null&&n.length)?e(ur,{}):e(ai,{title:g._({id:"i0qMbr"}),path:"/",id:"home",headerStart:!1,headerEnd:e(fr,{})})})}function fr(){const t=Fe(A),n=Y(),[i,s]=R(void 0);return e(O,{children:[e(de,{ref:n,to:"/notifications",class:`button plain notifications-button ${t.notificationsShowNew?"has-badge":""} ${i||""}`,onClick:c=>{c.stopPropagation(),window.matchMedia("(min-width: calc(40em))").matches&&(c.preventDefault(),s(a=>a?void 0:"open"))},children:e(S,{icon:"notification",size:"l",alt:g._({id:"iDNBZe"})})}),e(mr,{state:i,anchorRef:n,onClose:()=>s(void 0)})]})}const pr=5;function mr({anchorRef:t,state:n,onClose:i}){const{masto:s,instance:c}=se(),a=Fe(A),[p,r]=R("default"),o=$s();async function l(){const b=await o.next(),w=Es(b.value);if(w!=null&&w.length){w.forEach(y=>{Ge(y.status,c,{skipThreading:!0})});const k=Ms(w);A.notificationsLast=k[0],A.notifications=k,s.v1.markers.create({notifications:{lastReadId:k[0].id}}).catch(()=>{})}return A.notificationsShowNew=!1,A.notificationsLastFetchTime=Date.now(),b}const[m,h]=R(!1);function f(){return s.v1.followRequests.list({limit:1})}function d(){r("loading"),(async()=>{try{await l();const b=await f();h(!!(b!=null&&b.length)),r("default")}catch{r("error")}})()}Q(()=>{n==="open"&&d()},[n]);const v=Y();return e(is,{ref:v,menuClassName:"notifications-menu",state:n,anchorRef:t,onClose:i,portal:{target:document.body},containerProps:{onClick:()=>{var b,w;(w=(b=v.current)==null?void 0:b.closeMenu)==null||w.call(b)}},overflow:"auto",viewScroll:"close",position:"anchor",align:"center",boundingBoxPadding:"8 8 8 8",children:[e("header",{children:e("h2",{children:e(u,{id:"iDNBZe"})})}),e("main",{children:a.notifications.length?e(O,{children:a.notifications.slice(0,pr).map(b=>e(Sn,{instance:c,notification:b,disableContextMenu:!0},b._ids||b.id))}):p==="loading"?e("div",{class:"ui-state",children:e(Le,{abrupt:!0})}):p==="error"&&e("div",{class:"ui-state",children:[e("p",{children:e(u,{id:"5GFQTh"})}),e("p",{children:e("button",{type:"button",onClick:d,children:e(u,{id:"KDw4GX"})})})]})}),e("footer",{children:[e(de,{to:"/mentions",class:"button plain",children:[e(S,{icon:"at"})," ",e("span",{children:e(u,{id:"/bZzdR"})})]}),e(de,{to:"/notifications",class:"button plain2",children:[m?e(u,{id:"OdVhdR",components:{0:e("span",{class:"tag collapsed"}),1:e("span",{})}}):e("b",{children:e(u,{id:"gukqfD"})})," ",e(S,{icon:"arrow-right"})]})]})]})}const gr=st(hr),br=[/^\/@[^@\/]+\/(?:statuses|posts)\/([^\/]+)/i,/\/notes\/([^\/]+)/i,/^\/(?:notice|objects)\/([a-z0-9-]+)/i,/\/@[^@\/]+@?[^\/]+?\/([^\/]+)/i,/^\/p\/[^\/]+\/([^\/]+)/i];function zs(t){const{hostname:n,pathname:i}=URL.parse(t);for(const s of br){const[,c]=i.match(s)||[];if(c)return{instance:n,id:c}}return{}}function vr(t){const{instance:n,id:i}=zs(t);return n&&i?`/${n}/s/${i}`:null}function yr(){const n=jt().pathname.replace(/^\//,""),i=zs(n),s=i!=null&&i.instance?`/${i.instance}/s/${i.id}`:null,[c,a]=R("loading");return vt(()=>{a("loading"),(async()=>{try{const{instance:p,id:r}=i;if(r){const{masto:o}=se({instance:p});if(await o.v1.statuses.$select(r).fetch()){window.location.hash=s+"?view=full";return}}}catch{}{const{masto:p,instance:r}=se(),o=await p.v2.search.fetch({q:n,limit:1,resolve:!0});if(o.statuses.length){const l=o.statuses[0];window.location.hash=`/${r}/s/${l.id}?view=full`}else if(o.accounts.length){const l=o.accounts[0];window.location.hash=`/${r}/a/${l.id}`}else s?window.location.hash=s+"?view=full":a("error")}})()},[s]),e("div",{class:"ui-state",tabIndex:"-1",children:[c==="loading"?e(O,{children:[e(Le,{abrupt:!0}),e("h2",{children:e(u,{id:"RTAr/z"})}),e("p",{children:e("a",{href:n,target:"_blank",rel:"noopener noreferrer",children:n})})]}):e(O,{children:[e("h2",{children:e(u,{id:"ufzZSJ"})}),e("p",{children:e("a",{href:n,target:"_blank",rel:"noopener noreferrer",children:n})})]}),e("hr",{}),e("p",{children:e(de,{to:"/",children:e(u,{id:"iWpEwy"})})})]})}function wr(){We(g._({id:"h16FyT"}),"/l");const[t,n]=R("default"),[i,s]=Lt(o=>o+1,0),[c,a]=R([]);Q(()=>{n("loading"),(async()=>{try{const o=await Nn();a(o),n("default")}catch{n("error")}})()},[i]);const[p,r]=R(!1);return e("div",{id:"lists-page",class:"deck-container",tabIndex:"-1",children:[e("div",{class:"timeline-deck deck",children:[e("header",{children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Dt,{}),e(de,{to:"/",class:"button plain",children:e(S,{icon:"home",size:"l"})})]}),e("h1",{children:e(u,{id:"h16FyT"})}),e("div",{class:"header-side",children:e("button",{type:"button",class:"plain",onClick:()=>r(!0),children:e(S,{icon:"plus",size:"l",alt:g._({id:"Sb2gYF"})})})})]})}),e("main",{children:c.length>0?e(O,{children:[e("ul",{class:"link-list",children:c.map(o=>e("li",{children:e(de,{to:`/l/${o.id}`,children:e("span",{children:[e(S,{icon:"list"})," ",e("span",{children:o.title})]})})}))}),c.length>1&&e("footer",{class:"ui-state",children:e("small",{class:"insignificant",children:e(u,{id:"8prZNK",values:{0:c.length}})})})]}):t==="loading"?e("p",{class:"ui-state",children:e(Le,{})}):t==="error"?e("p",{class:"ui-state",children:e(u,{id:"v/l5uA"})}):e("p",{class:"ui-state",children:e(u,{id:"IvPikw"})})})]}),p&&e(Ne,{onClick:o=>{o.target===o.currentTarget&&r(!1)},children:e(ti,{list:p==null?void 0:p.list,onClose:o=>{o.state==="success"&&s(),r(!1)}})})]})}const kr=""+new URL("instances-MzK7fGXv.json",import.meta.url).href;var _r={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Blaede Phanpy",PHANPY_DEFAULT_INSTANCE:"mastodon.blaede.family",PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:"https://mastodon.blaede.family/auth/sign_up",PHANPY_GIPHY_API_KEY:"48JGsrSS1XE5w4nWe9c9hqxPbsfRWR0e",PHANPY_LINGVA_INSTANCES:"lingva.phanpy.social lingva.lunar.icu lingva.garudalinux.org translate.plausibility.cloud",PHANPY_PRIVACY_POLICY_URL:"https://mastodon.blaede.family/privacy-policy",PHANPY_WEBSITE:"https://phanpy.blaede.family",PROD:!0,SSR:!1,VITE_APP_ENV:"production"};const{PHANPY_CLIENT_NAME:Sr,PHANPY_WEBSITE:Ir}=_r,oi="read write follow push";async function Cr({instanceURL:t}){const n=new URLSearchParams({client_name:Sr,redirect_uris:location.origin+location.pathname,scopes:oi,website:Ir});return await(await fetch(`https://${t}/api/v1/apps`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:n.toString()})).json()}async function Tr({instanceURL:t,client_id:n}){const i=new URLSearchParams({client_id:n,scope:oi,redirect_uri:location.origin+location.pathname,response_type:"code"});return`https://${t}/oauth/authorize?${i.toString()}`}async function xr({instanceURL:t,client_id:n,client_secret:i,code:s}){const c=new URLSearchParams({client_id:n,client_secret:i,redirect_uri:location.origin+location.pathname,grant_type:"authorization_code",code:s,scope:oi});return await(await fetch(`https://${t}/oauth/token`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:c.toString()})).json()}var Ar={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Blaede Phanpy",PHANPY_DEFAULT_INSTANCE:"mastodon.blaede.family",PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:"https://mastodon.blaede.family/auth/sign_up",PHANPY_GIPHY_API_KEY:"48JGsrSS1XE5w4nWe9c9hqxPbsfRWR0e",PHANPY_LINGVA_INSTANCES:"lingva.phanpy.social lingva.lunar.icu lingva.garudalinux.org translate.plausibility.cloud",PHANPY_PRIVACY_POLICY_URL:"https://mastodon.blaede.family/privacy-policy",PHANPY_WEBSITE:"https://phanpy.blaede.family",PROD:!0,SSR:!1,VITE_APP_ENV:"production"};const{PHANPY_DEFAULT_INSTANCE:Er}=Ar;function Rr(){var y,I;We("Log in");const t=Y(),n=we.local.get("instanceURL"),[i,s]=R("default"),[c]=dt(),a=c.get("instance"),p=c.get("submit"),[r,o]=R(a||(n==null?void 0:n.toLowerCase())||""),[l,m]=R([]),h=Y();Q(()=>{(async()=>{try{const C=await(await fetch(kr)).json();m(C),h.current=new yc(C)}catch{}})()},[]);const f=_=>{_&&(we.local.set("instanceURL",_),(async()=>{s("loading");try{const{client_id:C,client_secret:T,vapid_key:x}=await Cr({instanceURL:_});C&&T?(we.session.set("clientID",C),we.session.set("clientSecret",T),we.session.set("vapidKey",x),location.href=await Tr({instanceURL:_,client_id:C})):alert("Failed to register application"),s("default")}catch{s("error")}})())},d=r?r.replace(/^https?:\/\//,"").replace(/\/+$/,"").replace(/^@?[^@]+@/,"").trim():null,v=/[^\s\r\n\t\/\\]+\.[^\s\r\n\t\/\\]+/.test(d)&&!/[\s\/\\@]/.test(d),b=d?(I=(y=h.current)==null?void 0:y.search(d,{limit:10}))==null?void 0:I.map(_=>_.item):[],w=v?d:b!=null&&b.length?b[0]:r?l.find(_=>_.includes(r)):null,k=_=>{_.preventDefault(),f(w)};return p&&Q(()=>{f(a||w)},[]),e("main",{id:"login",style:{textAlign:"center"},children:e("form",{onSubmit:k,children:[e("h1",{children:[e("img",{src:Xn,alt:"",width:"80",height:"80"}),e("br",{}),e(u,{id:"sQia9P"})]}),e("label",{children:[e("p",{children:e(u,{id:"kyAi7k"})}),e("input",{value:r,required:!0,type:"text",class:"large",id:"instanceURL",ref:t,disabled:i==="loading",autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellCheck:!1,placeholder:"instance domain",onInput:_=>{o(_.target.value)},dir:"auto"}),(b==null?void 0:b.length)>0?e("ul",{id:"instances-suggestions",children:b.map((_,C)=>e("li",{children:e("button",{type:"button",class:"plain5",onClick:()=>{f(_)},children:_})}))}):e("div",{id:"instances-eg",children:e(u,{id:"/OvbEC"})})]}),i==="error"&&e("p",{class:"error",children:e(u,{id:"cGQUvw"})}),e("div",{children:[e("button",{disabled:i==="loading"||!r||!w,children:w?g._({id:"2xahsi",values:{selectedInstanceText:w}}):g._({id:"xGVfLh"})})," "]}),e(Le,{hidden:i!=="loading"}),e("hr",{}),!Er&&e("p",{children:e("a",{href:"https://joinmastodon.org/servers",target:"_blank",children:e(u,{id:"LcOiWS"})})}),e("p",{children:e(de,{to:"/",children:e(u,{id:"iWpEwy"})})}),e(Qn,{})]})})}const ln=40,Lr=10,$r=5;let Un={},hn={},fn={};function pn(t){delete hn[t],delete fn[t]}const Kt={block:"nearest",inline:"center",behavior:"smooth"},Oi=".status-link:not(details:not([open]) > summary ~ *, details:not([open]) > summary ~ * *), .status-focus:not(details:not([open]) > summary ~ *, details:not([open]) > summary ~ * *)",zi=/\/s\//i;function Mr(t){var _;const{id:n}=t,{masto:i,instance:s}=se({instance:t.instance}),c=Fe(A),[a,p]=dt(),r=a.get("media"),o=a.get("media-only"),l=parseInt(r||o,10);let m=l>0;const h=a.get("mediaStatusID"),f=Zi(h,s);h&&!f&&(m=!1);const d=m&&!!o,v=nt(n,s),[b,w]=R(A.statuses[v]);Q(()=>{A.statuses[v]&&w(A.statuses[v])},[v]);const k=be(()=>{const{prevLocation:C}=A,T=((C==null?void 0:C.pathname)||"")+((C==null?void 0:C.search)||""),x=Qt("/:instance/s/:id",T)||Qt("/s/:id",T);return!T||x?"/":T},[]);Q(()=>{!b&&m&&(async()=>{try{const C=await i.v1.statuses.$select(n).fetch();Ge(C,s),w(C)}catch{alert("Unable to load post."),location.hash=k}})()},[m]);const y=h?(_=c.statuses[nt(h,s)])==null?void 0:_.mediaAttachments:b==null?void 0:b.mediaAttachments,I=at(()=>{!window.matchMedia("(min-width: calc(40em + 350px))").matches&&c.prevLocation?history.back():d?location.hash=k:(a.delete("media"),a.delete("mediaStatusID"),p(a))},[d,k,c.prevLocation]);return Q(()=>{let C=setTimeout(()=>{const T=document.querySelector(".carousel");T&&T.focus()},100);return()=>clearTimeout(C)},[d]),Q(()=>{const C=document.querySelectorAll(".deck-container");return C.forEach(T=>{T.setAttribute("inert","")}),()=>{C.forEach(T=>{T.removeAttribute("inert")})}},[]),e("div",{class:"deck-backdrop",children:[m?y!=null&&y.length?e(ys,{mediaAttachments:y,statusID:h||n,instance:s,lang:b==null?void 0:b.language,index:l-1,onClose:I}):e("div",{class:"media-modal-container loading",children:e(Le,{abrupt:!0})}):e(de,{to:k}),!d&&e(Pr,{id:n,instance:t.instance,closeLink:k})]})}function Dr(t){const{linkable:n,to:i,onClick:s,...c}=t;return n?e(de,{class:"status-link",to:i,onClick:s,...c}):e("div",{class:"status-focus",tabIndex:0,...c})}function Pr({id:t,closeLink:n="/",instance:i}){var E,G;const[s,c]=dt(),a=s.get("media"),p=s.get("mediaStatusID"),r=parseInt(a,10)>0,o=Y(!A.prevLocation&&(history.length===1||"navigation"in window&&((G=(E=navigation==null?void 0:navigation.entries)==null?void 0:E.call(navigation))==null?void 0:G.length)===1)),[l,m]=R(s.get("view")||o.current?"full":null),h=!!parseInt(s.get("translate")),{masto:f,instance:d}=se({instance:i}),{masto:v,instance:b,authenticated:w}=se(),k=d===b,y=Fe(A),[I,_]=R([]),[C,T]=R("default"),x=Y(),U=nt(t,d),M=Y(0),D=Y();Q(()=>{var L;(L=D.current)==null||L.focus()},[]),Q(()=>{var H;const L=as(()=>{if(!D.current)return;const{scrollTop:K}=D.current;C!=="loading"&&(fn[t]=K)},50);return(H=D.current)==null||H.addEventListener("scroll",L,{passive:!0}),L(),()=>{var K;L.cancel(),(K=D.current)==null||K.removeEventListener("scroll",L)}},[t,C!=="loading"]);const j=Y(),te=Y(),J=({reloadHero:L}={})=>{T("loading");let H;const K=hn[t];if(K){const ue=K.filter(Pe=>A.statuses[U]);_(ue)}else _([{id:t}]);return(async()=>{var Ee,$;const ue=()=>mi(()=>f.v1.statuses.$select(t).fetch(),{retries:4}),Pe=mi(()=>f.v1.statuses.$select(t).context.fetch(),{retries:8}),Ze=!!y.statuses[U];let ne=y.statuses[U];if(!(Ze&&!L))try{ne=await ue(),Ge(ne,d),await new Promise(q=>{setTimeout(q,100)})}catch{T("error");return}try{let q=function(re){return re==null?void 0:re.map(Ae=>({id:Ae.id,account:Ae.account,repliesCount:Ae.repliesCount,content:Ae.content,weight:Xt(Ae),replies:q(Ae.__replies)}))};const ae=await Pe,{ancestors:Z,descendants:W}=ae;M.current=(W==null?void 0:W.length)||0;const Se=new Set;Z.forEach(re=>{Ge(re,d,{skipThreading:!0}),re.inReplyToId&&!Z.find(Ae=>Ae.id===re.inReplyToId)&&Se.add(re.inReplyToId)});const xe=Z.every(re=>re.account.id===ne.account.id),ke=[];W.forEach(re=>{if(Ge(re,d,{skipThreading:!0}),re.inReplyToId&&!W.find(Ae=>Ae.id===re.inReplyToId)&&re.inReplyToId!==ne.id&&Se.add(re.inReplyToId),re.inReplyToAccountId===re.account.id)ke.push(re);else if(re.inReplyToId===ne.id)ke.push(re);else if(!re.inReplyToAccountId&&ke.find(Ae=>Ae.id===re.inReplyToId)&&re.account.id===ne.account.id)ke.push(re);else{const Ae=W.find(ht=>ht.id===re.inReplyToId);Ae&&(Ae.__replies||(Ae.__replies=[]),Ae.__replies.push(re))}}),Se.size;const Re=[...Z.map(re=>({id:re.id,ancestor:!0,isThread:xe,accountID:re.account.id,account:re.account,repliesCount:re.repliesCount,weight:Xt(re)})),{id:t,accountID:ne.account.id,weight:Xt(ne)},...ke.map(re=>({id:re.id,account:re.account,accountID:re.account.id,descendant:!0,thread:re.account.id===ne.account.id,weight:Xt(re),replies:q(re.__replies)}))];T("default"),j.current={offsetTop:(Ee=x.current)==null?void 0:Ee.offsetTop,scrollTop:($=D.current)==null?void 0:$.scrollTop};const Be=Re.findIndex(re=>re.id===t);Be>=ie&&pe(Be+1),_(Re),hn[t]=Re,Xs(ne,d)}catch{T("error")}})(),te.current=Date.now(),()=>{clearTimeout(H)}};Q(J,[t,f]);const[N,P]=R(!1);Q(()=>{let L=setInterval(()=>{const H=Date.now();te.current&&H-te.current>=6e4&&P(!0)},6e4);return()=>{clearInterval(L)}},[]),vt(()=>{var H,K;if(!I.length)return;const L=fn[t];if(L)D.current.scrollTop=L;else if(j.current){const ue={offsetTop:(H=x.current)==null?void 0:H.offsetTop,scrollTop:(K=D.current)==null?void 0:K.scrollTop},Pe=ue.offsetTop-j.current.offsetTop+ue.scrollTop;D.current.scrollTop=Pe}else I.length===1&&(D.current.scrollTop=0);j.current=null},[I]),Q(()=>{y.reloadStatusPage<=0||(async()=>{try{const{instanceURL:L}=Ft(),H=`https://${L}/api/v1/statuses/${t}/context`;return await(await caches.open("api")).delete(H,{ignoreVary:!0}),J({reloadHero:!0})}catch{}})()},[y.reloadStatusPage]),Q(()=>()=>{fn={},A.reloadStatusPage=0,hn={},Un={},Fn.clear()},[]);const B=y.statuses[U]||y.statuses[t],V=be(()=>{if(!B)return"";const{account:L}=B,H=document.createElement("div");return H.innerHTML=L.displayName,H.innerText.trim()},[B]),F=be(()=>{if(!B)return"";let L=Vn(B);return L.length>64&&(L=L.slice(0,64)+"…"),L},[B]);We(V&&F?`${V}: "${F}"`:g._({id:"y28hnO"}),"/:instance?/s/:id");const ee=be(()=>{if(!B)return;const{url:L}=B;if(L)return URL.parse(L).hostname},[B]),z=be(()=>{if(ee)return ee===d},[ee,d]),[ie,pe]=R(ln),ce=be(()=>I.length-ie,[I.length,ie]),he=I.some(L=>L.descendant),ve=I.filter(L=>L.ancestor),[fe,_e]=R(!0),$e=be(()=>{if(!x.current||fe)return null;const{top:L}=x.current.getBoundingClientRect();return L>0?"down":"up"},[fe]);Ue("esc",()=>{location.hash=n},{enabled:!r,ignoreEventWhen:L=>!!document.querySelector("#modal-container > *")}),Ue("backspace",()=>{location.hash=n}),Ue("j",()=>{const L=document.activeElement.closest(".status-link, .status-focus"),H=L==null?void 0:L.getBoundingClientRect(),K=Array.from(D.current.querySelectorAll(Oi));if(L&&H.top<D.current.clientHeight&&H.bottom>0){const ue=K.indexOf(L);let Pe=K[ue+1];Pe&&(Pe.focus(),Pe.scrollIntoView(Kt))}else{const ue=K.find(Pe=>{const Ze=Pe.getBoundingClientRect();return Ze.top>=44&&Ze.left>=0});ue&&(ue.focus(),ue.scrollIntoView(Kt))}}),Ue("k",()=>{const L=document.activeElement.closest(".status-link, .status-focus"),H=L==null?void 0:L.getBoundingClientRect(),K=Array.from(D.current.querySelectorAll(Oi));if(L&&H.top<D.current.clientHeight&&H.bottom>0){const ue=K.indexOf(L);let Pe=K[ue-1];Pe&&(Pe.focus(),Pe.scrollIntoView(Kt))}else{const ue=K.find(Pe=>{const Ze=Pe.getBoundingClientRect();return Ze.top>=44&&Ze.left>=0});ue&&(ue.focus(),ue.scrollIntoView(Kt))}}),Ue("x",()=>{const L=document.activeElement.closest(".status-link, .status-focus");if(L){const H=L.nextElementSibling;H&&H.tagName.toLowerCase()==="details"&&(H.open=!H.open)}});const[Me,Ce]=R(!1),De=Y(r?"media+status":"status"),Oe=at((L,H,K,ue)=>{L.preventDefault(),L.stopPropagation(),c({media:H+1,mediaStatusID:ue.id})},[t]),ye=at((L,H)=>{pn(H.id)},[]);Q(()=>{let L;return p&&r&&(L=setTimeout(()=>{var K;const H=(K=D.current)==null?void 0:K.querySelector(`.status-link[href*="/${p}"]`);H&&H.scrollIntoView(Kt)},400)),()=>{clearTimeout(L)}},[p,r]);const X=at((L,H)=>{const{id:K,ancestor:ue,isThread:Pe,descendant:Ze,thread:ne,replies:Ee,repliesCount:$,weight:q}=L,ae=K===t;return e("li",{ref:ae?x:null,class:`${ue?"ancestor":""} ${Ze?"descendant":""} ${ne?"thread":""} ${ae?"hero":""}`,children:[ae?e(O,{children:[e(yt,{threshold:.1,onChange:W=>{queueMicrotask(()=>{requestAnimationFrame(()=>{_e(W)})})},class:"status-focus",tabIndex:0,children:e(qe,{statusID:K,instance:d,withinContext:!0,size:"l",enableTranslate:!0,forceTranslate:h})}),C!=="loading"&&!w?e("div",{class:"post-status-banner",children:[e("p",{children:e(u,{id:"Vyeh4F"})}),e(de,{to:"/login",class:"button",children:e(u,{id:"sQia9P"})})]}):!k&&e("div",{class:"post-status-banner",children:[e("p",{children:e(u,{id:"j5roNG",values:{instance:d},components:{0:e("b",{})}})}),e("button",{type:"button",disabled:C==="loading",onClick:()=>{T("loading"),(async()=>{try{const W=await v.v2.search.fetch({q:B.url,type:"statuses",resolve:!0,limit:1});if(W.statuses.length){const Se=W.statuses[0];location.hash=b?`/${b}/s/${Se.id}`:`/s/${Se.id}`}else throw new Error("No results")}catch(W){T("default"),alert(g._({id:"DnepCE",values:{e:W}}))}})()},children:[e(S,{icon:"transfer"})," ",e(u,{id:"ejAVrO"})]})]})]}):e(Dr,{linkable:Pe||ue,to:d?`/${d}/s/${K}`:`/s/${K}`,onClick:()=>{pn(K)},children:[H===0&&ue?e(yt,{threshold:.5,onChange:W=>{queueMicrotask(()=>{requestAnimationFrame(()=>{Ce(W)})})},children:e(qe,{statusID:K,instance:d,withinContext:!0,size:ne||ue?"m":"s",enableTranslate:!0,onMediaClick:Oe,onStatusLinkClick:ye})}):e(qe,{statusID:K,instance:d,withinContext:!0,size:ne||ue?"m":"s",enableTranslate:!0,onMediaClick:Oe,onStatusLinkClick:ye,showActionsBar:!!Ze}),ue&&$>1&&e("div",{class:"replies-link",children:[e(S,{icon:"comment2",alt:g._({id:"N8UzTV"})})," ",e("span",{title:$,children:Ve($)})]})," "]}),Ze&&(Ee==null?void 0:Ee.length)>0&&e(Us,{instance:d,replies:Ee,hasParentThread:ne,level:1,accWeight:q,openAll:M.current<Lr,parentLink:{to:d?`/${d}/s/${K}`:`/s/${K}`,onClick:()=>pn(K)}}),C==="loading"&&ae&&!!(B!=null&&B.repliesCount)&&!he&&e("div",{class:"status-loading",children:e(Le,{abrupt:B.repliesCount>=3})}),C==="error"&&ae&&!!(B!=null&&B.repliesCount)&&!he&&e("div",{class:"status-error",children:[e(u,{id:"HQJU6W"}),e("br",{}),e("button",{type:"button",class:"plain",onClick:()=>{A.reloadStatusPage++},children:e(u,{id:"KDw4GX"})})]})]},K)},[t,d,C,w,k,h,Oe,ye,he]),me=be(()=>{var L;if("navigation"in window&&(navigation!=null&&navigation.entries)){const H=navigation.entries()[navigation.currentEntry.index-1];if(H!=null&&H.url)return zi.test(H.url)}return zi.test((L=A.prevLocation)==null?void 0:L.pathname)},[U]),Te=be(()=>{if(!ce)return[];const L=[];function H(K){L.push(K.id),K.replies&&K.replies.forEach(H)}return I.slice(ie).forEach(H),L.map(K=>nt(K,d))},[ce,I,ie,d]),oe=be(()=>I.slice(0,ie).map(X),[I,ie,X]);return Q(()=>{let L=setTimeout(()=>{if(!x.current)return;const H=x.current.querySelector(".spoiler-button:not(.spoiling), .spoiler-media-button:not(.spoiling)");H&&H.click()},1e3);return()=>clearTimeout(L)},[t]),e("div",{tabIndex:"-1",ref:D,class:`status-deck deck contained ${I.length>1?"padded-bottom":""} ${De.current==="status"&&!o.current?"slide-in":""} ${l?`deck-view-${l}`:""}`,onAnimationEnd:L=>{De.current==="status"&&(De.current=null)},children:[e("header",{class:`${C==="loading"?"loading":""}`,onDblClick:L=>{A.reloadStatusPage++},children:e("div",{class:"header-grid header-grid-2",children:[e("h1",{children:[me&&e("button",{type:"button",class:"plain deck-back",onClick:()=>{history.back()},children:e(S,{icon:"chevron-left",size:"xl",alt:g._({id:"iH8pgl"})})}),!fe&&B&&C!=="loading"?e(O,{children:[e("span",{class:"hero-heading",children:[e(At,{account:B.account,instance:d,showAvatar:!0,short:!0})," ",e("span",{class:"insignificant",children:["•"," ",e(Vt,{datetime:B.createdAt,format:"micro"})]})]})," ",e("button",{type:"button",class:"ancestors-indicator light small",onClick:L=>{L.preventDefault(),L.stopPropagation(),x.current.scrollIntoView({behavior:"smooth",block:"start"})},title:g._({id:"NCy+Nw"}),children:e(S,{icon:$e==="down"?"arrow-down":"arrow-up"})})]}):e(O,{children:["Post"," ",e("button",{type:"button",class:"ancestors-indicator light small",onClick:L=>{L.preventDefault(),L.stopPropagation(),D.current.scrollTo({top:0,behavior:"smooth"})},hidden:!ve.length||Me,title:g._({id:"R8CUl0",values:{0:ve.length}}),children:[e(S,{icon:"arrow-up"}),ve.filter((L,H,K)=>K.findIndex(ue=>ue.accountID===L.accountID)===H).slice(0,3).map(L=>e(rt,{url:L.account.avatar,alt:L.account.displayName},L.account.id)),ve.length>3&&e(O,{children:[" ",e("span",{class:"insignificant",children:Ve(ve.length)})]})]})]})]}),e("div",{class:"header-side",children:[e("button",{type:"button",class:"plain4 button-switch-view",style:{display:l==="full"?"":"none"},onClick:()=>{m(null),s.delete("media"),s.delete("media-only"),s.delete("view"),c(s)},title:g._({id:"+/xYEI"}),children:e(S,{icon:"layout4",size:"l"})}),N&&e("button",{type:"button",class:"plain button-refresh",onClick:()=>{A.reloadStatusPage++,P(!1)},children:e(S,{icon:"refresh",size:"l",alt:g._({id:"lCF0wC"})})}),e(it,{align:"end",portal:{target:D.current},menuButton:e("button",{type:"button",class:"button plain4",children:e(S,{icon:"more",alt:g._({id:"2FYpfJ"}),size:"xl"})}),children:[e(ge,{disabled:C==="loading",onClick:()=>{A.reloadStatusPage++},children:[e(S,{icon:"refresh"}),e("span",{children:e(u,{id:"lCF0wC"})})]}),e(ge,{className:"menu-switch-view",onClick:()=>{m(l==="full"?null:"full"),s.delete("media"),s.delete("media-only"),l==="full"?s.delete("view"):s.set("view","full"),c(s)},children:[e(S,{icon:{"":"layout5",full:"layout4"}[l||""]}),e("span",{children:l==="full"?g._({id:"+/xYEI"}):g._({id:"2LiWsE"})})]}),e(ge,{onClick:()=>{Array.from(D.current.querySelectorAll(".spoiler-button:not(.spoiling), .spoiler-media-button:not(.spoiling)")).forEach(H=>{H.click()})},children:[e(S,{icon:"eye-open"})," ",e("span",{children:e(u,{id:"8r8KmB"})})]}),e(je,{}),e(cs,{className:"plain",children:e(u,{id:"Rsjgm0"})}),e(ge,{disabled:!ee||z,onClick:()=>{const L=vr(B.url);L?location.hash=L:alert(g._({id:"9J6biQ"}))},children:[e(S,{icon:"transfer"}),e("small",{class:"menu-double-lines",children:ee?g._({id:"Kp9SAs",values:{0:Gt.toUnicode(ee)}}):g._({id:"lb07+k"})})]})]}),e(de,{class:"button plain deck-close",to:n,children:e(S,{icon:"x",size:"xl",alt:g._({id:"yz7wBu"})})})]})]})}),I.length&&B?e("ul",{class:`timeline flat contextual grow ${C==="loading"?"loading":""}`,children:[oe,ce>0&&e("li",{children:e("button",{type:"button",class:"plain block show-more",disabled:C==="loading",onClick:()=>pe(L=>L+ln),style:{marginBlockEnd:"6em"},"data-state-post-ids":Te.join(" "),children:[e("div",{class:"ib avatars-bunch",children:I.slice(ie,ie+5).map(L=>e(rt,{url:L.account.avatarStatic},L.id))})," ",e("div",{class:"ib",children:[e(u,{id:"uXRAkV"})," ",e("span",{class:"tag",children:ce>ln?`${ln}+`:ce})]})]})})]}):e(O,{children:[C==="loading"&&e("ul",{class:"timeline flat contextual grow loading",children:e("li",{children:e(qe,{skeleton:!0,size:"l"})})}),C==="error"&&e("p",{class:"ui-state",children:[e(u,{id:"JWxodU"}),e("br",{}),e("br",{}),e("button",{type:"button",onClick:()=>{A.reloadStatusPage++},children:e(u,{id:"KDw4GX"})})]})]})]})}function Us({replies:t,instance:n,hasParentThread:i,level:s,accWeight:c,openAll:a,parentLink:p}){const[r,o]=dt(),l=y=>y.reduce((I,_)=>{const{repliesCount:C,replies:T}=_,x=(T==null?void 0:T.length)||C;return I+x+l(T||[])},0),m=t.length+l(t),h=t.length===m,f=t.map(y=>y.account).filter((y,I,_)=>_.findIndex(C=>C.id===y.id)===I).slice(0,3),d=be(()=>t==null?void 0:t.reduce((y,I)=>y+(I==null?void 0:I.weight),c),[c,t==null?void 0:t.length]);let v=!1;(a||d<=$r||!i&&m===1&&Xt(t[0])<2)&&(v=!0);const b=Un[t[0].id],w=at((y,I,_,C)=>{y.preventDefault(),y.stopPropagation(),o({media:I+1,mediaStatusID:C.id})},[]),k=Y();return vt(()=>{var I;function y(_){_.target.dataset.scrollLeft=_.target.scrollLeft}return(I=k.current)==null||I.addEventListener("scroll",y,{passive:!0}),()=>{var _;(_=k.current)==null||_.removeEventListener("scroll",y)}},[]),e("details",{ref:k,class:"replies",open:b||v,onToggle:y=>{const{open:I}=y.target;Un[t[0].id]=I},style:{"--comments-level":s},"data-comments-level":s,"data-comments-level-overflow":s>4,children:[e("summary",{class:"replies-summary",hidden:v,children:[e("span",{class:"avatars",children:f.map(y=>e(rt,{url:y.avatarStatic,title:`${y.displayName} @${y.username}`,squircle:y==null?void 0:y.bot},y.id))}),e("span",{class:"replies-counts",children:[e("b",{children:e(u,{id:"DOQUen",values:{0:t.length,1:Ve(t.length)},components:{0:e("span",{title:t.length})}})}),!h&&m>1&&e(O,{children:[" ","·"," ",e("span",{children:e(u,{id:"qSQQSe",values:{0:Ve(m),totalComments:m},components:{0:e("span",{title:m})}})})]})]}),e(S,{icon:"chevron-down",class:"replies-summary-chevron"}),!!p&&e(de,{class:"replies-parent-link",to:p.to,onClick:p.onClick,title:g._({id:"ZlV82A"}),children:"»"})]}),e("ul",{children:t.map(y=>{var I,_;return e("li",{children:[e("div",{class:"status-focus",tabIndex:0,children:[e(qe,{statusID:y.id,instance:n,withinContext:!0,size:"s",enableTranslate:!0,onMediaClick:w,showActionsBar:!0}),!((I=y.replies)!=null&&I.length)&&y.repliesCount>0&&e("div",{class:"replies-link",children:[e(S,{icon:"comment2",alt:g._({id:"N8UzTV"})})," ",e("span",{title:y.repliesCount,children:Ve(y.repliesCount)})]})]}),((_=y.replies)==null?void 0:_.length)&&e(Us,{instance:n,replies:y.replies,level:s+1,accWeight:v?d:y.weight,openAll:a,parentLink:{to:n?`/${n}/s/${y.id}`:`/s/${y.id}`,onClick:()=>{pn(y.id)}}})]},y.id)})})]})}const Nr=140,Or=35,zr=70,Ur=140,Fn=new Map;function Xt(t){var d,v;const n=Fn.get(t.id);if(n)return n;const{spoilerText:i,content:s,mediaAttachments:c,poll:a,card:p}=t,r=ss(i+s),o=c!=null&&c.length?Nr:0,l=(((d=a==null?void 0:a.options)==null?void 0:d.length)||0)*Or,m=p&&(c!=null&&c.length||(v=a==null?void 0:a.options)!=null&&v.length)?0:zr,f=(r+o+l+m)/Ur;return Fn.set(t.id,f),f}const Fr=st(Mr);function Br(){const t=$t(),{id:n,instance:i}=t;return e(Fr,{id:n,instance:i})}const qr=""+new URL("boosts-carousel-YjmjXTE6.jpg",import.meta.url).href,Hr=""+new URL("grouped-notifications-xYMFVY91.jpg",import.meta.url).href,Yr=""+new URL("multi-column-ETnJNDVb.jpg",import.meta.url).href,jr=""+new URL("multi-hashtag-timeline-x-SDVR4g.jpg",import.meta.url).href,Vr=""+new URL("nested-comments-thread-Ib-fZGS3.jpg",import.meta.url).href,Gr="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20fill-rule='evenodd'%20stroke-linejoin='round'%20stroke-miterlimit='2'%20clip-rule='evenodd'%20viewBox='0%200%20102%2028'%3e%3cpath%20fill='none'%20d='M0%200h101.5v27.5H0z'/%3e%3cg%20fill-rule='nonzero'%3e%3cpath%20fill='url(%23a)'%20d='M2.32%2021.85c1.4%200%202.21-.85%202.21-2.3v-4.64H8.5c4.45%200%207.54-2.9%207.54-7.24%200-4.35-2.98-7.24-7.32-7.24h-6.4C.93.43.11%201.28.11%202.73v16.82c0%201.45.82%202.3%202.21%202.3Zm2.21-10.4V3.94h3c2.54%200%204%201.34%204%203.75s-1.47%203.76-4%203.76h-3Z'/%3e%3cpath%20fill='url(%23b)'%20d='M20.52%2021.88c1.25%200%202.13-.76%202.13-2.23v-7.04c0-2.07%201.2-3.49%203.21-3.49%201.95%200%202.95%201.23%202.95%203.25v7.28c0%201.47.89%202.23%202.13%202.23%201.26%200%202.14-.76%202.14-2.23v-8.18c0-3.64-1.99-5.9-5.48-5.9-2.38%200-4.1%201.12-4.93%203.1h-.09V2.3c0-1.38-.78-2.2-2.1-2.2-1.31%200-2.1.82-2.1%202.2v17.34c0%201.47.9%202.23%202.14%202.23Z'/%3e%3cpath%20fill='url(%23c)'%20d='M40.45%2021.82c1.96%200%203.93-.98%204.8-2.65h.1v.8c.08%201.27.89%201.91%202.05%201.91%201.21%200%202.08-.73%202.08-2.15v-8.95c0-3.17-2.63-5.25-6.65-5.25-3.26%200-5.78%201.16-6.5%203.04-.15.32-.23.63-.23.96%200%20.97.75%201.64%201.79%201.64.69%200%201.23-.26%201.7-.79.95-1.23%201.74-1.65%203.04-1.65%201.62%200%202.64.85%202.64%202.31v1.04l-3.95.24c-3.93.23-6.13%201.88-6.13%204.74%200%202.83%202.27%204.76%205.26%204.76Zm1.4-3.09c-1.43%200-2.4-.73-2.4-1.9%200-1.12.91-1.83%202.51-1.95l3.31-.2v1.14c0%201.7-1.54%202.91-3.41%202.91Z'/%3e%3cpath%20fill='url(%23d)'%20d='M54.37%2021.88c1.26%200%202.14-.76%202.14-2.23v-7.09c0-2.03%201.21-3.44%203.13-3.44s2.89%201.17%202.89%203.22v7.31c0%201.47.88%202.23%202.14%202.23%201.24%200%202.13-.76%202.13-2.23v-8.2c0-3.68-1.96-5.87-5.45-5.87-2.41%200-4%201.07-4.83%203.01h-.09v-.87c0-1.35-.85-2.17-2.14-2.17-1.28%200-2.06.82-2.06%202.15v11.95c0%201.47.9%202.23%202.14%202.23Z'/%3e%3cpath%20fill='url(%23e)'%20d='M71.65%2027.17c1.26%200%202.14-.76%202.14-2.23v-6h.09a5.15%205.15%200%200%200%204.88%202.88c3.92%200%206.35-3.05%206.35-8.1%200-5.07-2.44-8.1-6.43-8.1a5.12%205.12%200%200%200-4.86%202.99h-.09v-.85c0-1.45-.88-2.21-2.1-2.21-1.24%200-2.11.76-2.11%202.2v17.2c0%201.46.89%202.22%202.13%202.22Zm5.6-8.8c-2.1%200-3.47-1.8-3.47-4.65%200-2.81%201.37-4.67%203.47-4.67%202.14%200%203.49%201.83%203.49%204.67%200%202.86-1.35%204.66-3.5%204.66Z'/%3e%3cpath%20fill='url(%23f)'%20d='M89.61%2027.39c3.44%200%205.26-1.5%206.73-5.55l4.81-13.1a4%204%200%200%200%20.24-1.26c0-1.13-.85-1.93-2.08-1.93-1.1%200-1.71.51-2.07%201.7l-3.4%2010.9h-.08L90.35%207.28c-.36-1.25-.94-1.73-2.07-1.73-1.26%200-2.21.83-2.21%201.99%200%20.35.09.82.25%201.26l5%2013.21-.21.56c-.52%201.1-1.32%201.42-2.07%201.42l-.75-.01c-.96%200-1.56.54-1.56%201.4%200%201.29%201%202%202.88%202Z'/%3e%3c/g%3e%3cdefs%3e%3cradialGradient%20id='a'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3cradialGradient%20id='b'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3cradialGradient%20id='c'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3cradialGradient%20id='d'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3cradialGradient%20id='e'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3cradialGradient%20id='f'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3c/defs%3e%3c/svg%3e";var Wr={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Blaede Phanpy",PHANPY_DEFAULT_INSTANCE:"mastodon.blaede.family",PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:"https://mastodon.blaede.family/auth/sign_up",PHANPY_GIPHY_API_KEY:"48JGsrSS1XE5w4nWe9c9hqxPbsfRWR0e",PHANPY_LINGVA_INSTANCES:"lingva.phanpy.social lingva.lunar.icu lingva.garudalinux.org translate.plausibility.cloud",PHANPY_PRIVACY_POLICY_URL:"https://mastodon.blaede.family/privacy-policy",PHANPY_WEBSITE:"https://phanpy.blaede.family",PROD:!0,SSR:!1,VITE_APP_ENV:"production"};const{PHANPY_DEFAULT_INSTANCE:Zt,PHANPY_WEBSITE:Ui,PHANPY_PRIVACY_POLICY_URL:Kr,PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:Fi}=Wr,Bi=Ui?Ui.replace(/https?:\/\//g,"").replace(/\/$/,""):null,qi=`${"2024-08-13T20:03:18.539Z".slice(0,10).replace(/-/g,".")}.bff9a84`;function Hi(){return We(null,["/","/welcome"]),e("main",{id:"welcome",children:[e("div",{class:"hero-container",children:[e("div",{class:"hero-content",children:[e("h1",{children:[e("img",{src:Xn,alt:"",width:"160",height:"160",style:{aspectRatio:"1/1",marginBlockEnd:-16}}),e("img",{src:Gr,alt:"Phanpy",width:"200"})]}),e("p",{class:"desc",children:e(u,{id:"Ogtv0V"})}),e("p",{children:e(de,{to:Zt?`/login?instance=${Zt}&submit=1`:"/login",class:"button",children:Zt?g._({id:"sQia9P"}):g._({id:"ZLoGls"})})}),Zt&&Fi&&e("p",{children:e("a",{href:Fi,class:"button plain5",children:e(u,{id:"e+RpCP"})})}),!Zt&&e("p",{class:"insignificant",children:e("small",{children:e(u,{id:"fvAsUK",components:{0:e("br",{})}})})})]}),(Bi||qi)&&e("p",{class:"app-site-version",children:e("small",{children:[Bi," ",qi]})}),e("p",{children:e(u,{id:"BskFI2",components:{0:e("a",{href:"https://github.com/cheeaun/phanpy",target:"_blank"}),1:e("a",{href:"https://mastodon.social/@cheeaun",target:"_blank",onClick:t=>{t.preventDefault(),A.showAccount="cheeaun@mastodon.social"}}),2:e("a",{href:Kr,target:"_blank"})}})}),e(Qn,{})]}),e("div",{id:"why-container",children:e("div",{class:"sections",children:[e("section",{children:[e("img",{src:qr,alt:g._({id:"S5cYrQ"}),loading:"lazy"}),e("h4",{children:e(u,{id:"Tu+sCN"})}),e("p",{children:e(u,{id:"e2uVlo"})})]}),e("section",{children:[e("img",{src:Vr,alt:g._({id:"CGQ27z"}),loading:"lazy"}),e("h4",{children:e(u,{id:"cYE45+"})}),e("p",{children:e(u,{id:"Pc7QKh"})})]}),e("section",{children:[e("img",{src:Hr,alt:g._({id:"rnrM7k"}),loading:"lazy"}),e("h4",{children:e(u,{id:"4RRMre"})}),e("p",{children:e(u,{id:"8GMtDr"})})]}),e("section",{children:[e("img",{src:Yr,alt:g._({id:"VLKtvP"}),loading:"lazy"}),e("h4",{children:e(u,{id:"pEkad9"})}),e("p",{children:e(u,{id:"t7Py5R"})})]}),e("section",{children:[e("img",{src:jr,alt:g._({id:"wOax6E"}),loading:"lazy"}),e("h4",{children:e(u,{id:"Wi1Ov0"})}),e("p",{children:e(u,{id:"tS2i+h"})})]})]})})]})}const Zr=window.alert;window.__nativeAlert||(window.__nativeAlert=Zr);window.alert=function(t){t instanceof Error&&(t!=null&&t.message)&&(t=t.message),typeof t!="string"&&(t=JSON.stringify(t));const n=wc({text:t,className:"alert",gravity:"top",position:"center",duration:1e4,offset:{y:48},onClick:()=>{n.hideToast()}});n.showToast()};window.__STATES__=A;window.__STATES_STATS__=()=>{const t=["statuses","accounts","spoilers","unfurledLinks","statusQuotes"],n={};t.forEach(c=>{n[c]=Object.keys(A[c]).length});const{statuses:i}=A,s=[];for(const c in i)document.querySelector(`[data-state-post-id~="${c}"], [data-state-post-ids~="${c}"]`)||s.push(c)};setInterval(()=>{if(!window.__IDLE__)return;const{statuses:t,unfurledLinks:n,notifications:i}=A;let s=0;const{instance:c}=se();for(const a in t){if(!window.__IDLE__)break;try{const p=document.querySelector(`[data-state-post-id~="${a}"], [data-state-post-ids~="${a}"]`),r=i.some(o=>{var l;return a===nt((l=o.status)==null?void 0:l.id,c)});if(!p&&!r){delete A.statuses[a],delete A.statusQuotes[a];for(const o in n){const l=n[o];if(nt(l.id,l.instance)===a){delete A.unfurledLinks[o];break}}s++}}catch{}}},15*60*1e3);setTimeout(()=>{for(const t in Nt)setTimeout(()=>{var n,i,s,c,a,p;Array.isArray(Nt[t])?(i=(n=Nt[t])[0])==null||i.call(n):typeof Nt[t]=="object"?(c=(s=Nt[t]).module)==null||c.call(s):(p=(a=Nt)[t])==null||p.call(a)},1)},5e3);(()=>{window.__IDLE__=!0;const t=["mousemove","mousedown","resize","keydown","touchstart","pointerdown","pointermove","wheel"],n=()=>{window.__IDLE__=!0},s=as(n,3e3),c=()=>{window.__IDLE__=!1,s()};t.forEach(a=>{window.addEventListener(a,c,{passive:!0,capture:!0})}),window.addEventListener("blur",n,{passive:!0}),document.documentElement.addEventListener("mouseleave",a=>{!a.relatedTarget&&!a.toElement&&n()},{passive:!0})})();const Jr=/iPad|iPhone|iPod/.test(navigator.userAgent);Jr&&document.addEventListener("visibilitychange",()=>{if(document.visibilityState==="visible"){const t=we.local.get("theme");let n;if(t){if(n=document.querySelector('meta[name="theme-color"][data-theme-setting="manual"]'),n){const i=n.content,s=t==="light"?n.dataset.themeLightColorTemp:n.dataset.themeDarkColorTemp;n.content=s||"",setTimeout(()=>{n.content=i},10)}}else{const i=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";if(n=document.querySelector(`meta[name="theme-color"][media*="${i}"]`),n){const s=n.dataset.content,c=n.dataset.contentTemp;n.content=c||"",setTimeout(()=>{n.content=s},10)}}}});{const t=we.local.get("theme");if(t){document.documentElement.classList.add(`is-${t}`),document.querySelector('meta[name="color-scheme"]').setAttribute("content",t||"dark light");const i=document.querySelector('meta[data-theme-setting="manual"]');i&&(i.name="theme-color",i.content=t==="light"?i.dataset.themeLightColor:i.dataset.themeDarkColor),document.querySelectorAll('meta[data-theme-setting="auto"]').forEach(c=>{c.name=""})}const n=we.local.get("textSize");n&&document.documentElement.style.setProperty("--text-size",`${n}px`)}Gi(A,t=>{var n;for(const[i,s,c,a]of t){if(s.join(".")==="settings.shortcutsViewMode"){const p=document.getElementById("app");p&&(p.dataset.shortcutsViewMode=(n=A.shortcuts)!=null&&n.length?c:"")}s.join(".")==="settings.cloakMode"&&document.body.classList.toggle("cloak",c)}});function Xr(){const[t,n]=R(!1),[i,s]=R("loading");et(),Q(()=>{const a=we.local.get("instanceURL"),p=decodeURIComponent((window.location.search.match(/code=([^&]+)/)||[,""])[1]);if(p){window.history.replaceState({},document.title,window.location.pathname||"/");const r=we.session.get("clientID"),o=we.session.get("clientSecret"),l=we.session.get("vapidKey");(async()=>{s("loading");const{access_token:m}=await xr({instanceURL:a,client_id:r,client_secret:o,code:p}),h=Qs({instance:a,accessToken:m});await Promise.allSettled([li(h),di(h,a),ec(h,a,m,l)]),ui(),n(!0),s("default")})()}else{window.__IGNORE_GET_ACCOUNT_ERROR__=!0;const r=Ft();if(r){ji(r.info.id);const{client:o}=se({account:r}),{instance:l}=o;ui(),s("loading"),(async()=>{try{await li(o),await di(o,l)}catch{}finally{n(!0),s("default")}})()}else s("default")}},[]);let c=jt();return A.currentLocation=c.pathname,Q(Pn,[c,t]),/\/https?:/.test(c.pathname)?e(yr,{}):e(O,{children:[e(Qr,{isLoggedIn:t,loading:i==="loading"}),e(el,{isLoggedIn:t}),i==="default"&&e(qn,{children:e(Ye,{path:"/:instance?/s/:id",element:e(Br,{})})}),t&&e(Cc,{}),t&&e(Ka,{}),e(qa,{}),t&&e(Va,{}),e(Ic,{isLoggedIn:t}),i!=="loading"&&e(Ga,{onClose:Pn}),e(Tc,{})]})}function Qr({isLoggedIn:t,loading:n}){const i=jt(),s=be(()=>{const{pathname:c}=i;return!/^\/(login|welcome)/i.test(c)},[i]);return e(qn,{location:s||i,children:[e(Ye,{path:"/",element:t?e(gr,{}):n?e(Le,{id:"loader-root"}):e(Hi,{})}),e(Ye,{path:"/login",element:e(Rr,{})}),e(Ye,{path:"/welcome",element:e(Hi,{})})]})}function Yi(){return A.prevLocation||null}function el({isLoggedIn:t}){const n=jt(),i=Y(Yi());return be(()=>Qt("/:instance/s/:id",n.pathname)||Qt("/s/:id",n.pathname),[n.pathname,Qt])?i.current||(i.current=Yi()):i.current=null,e(qn,{location:i.current||n,children:[t&&e(O,{children:[e(Ye,{path:"/notifications",element:e(Ds,{})}),e(Ye,{path:"/mentions",element:e(Rs,{})}),e(Ye,{path:"/following",element:e(ai,{})}),e(Ye,{path:"/b",element:e(Ss,{})}),e(Ye,{path:"/f",element:e(Is,{})}),e(Ye,{path:"/l",children:[e(Ye,{index:!0,element:e(wr,{})}),e(Ye,{path:":id",element:e(xs,{})})]}),e(Ye,{path:"/fh",element:e(Oo,{})}),e(Ye,{path:"/ft",element:e(Mo,{})}),e(Ye,{path:"/catchup",element:e(ko,{})})]}),e(Ye,{path:"/:instance?/t/:hashtag",element:e(Ts,{})}),e(Ye,{path:"/:instance?/a/:id",element:e(ho,{})}),e(Ye,{path:"/:instance?/p",children:[e(Ye,{index:!0,element:e(zn,{})}),e(Ye,{path:"l",element:e(zn,{local:!0})})]}),e(Ye,{path:"/:instance?/trending",element:e(Os,{})}),e(Ye,{path:"/:instance?/search",element:e(Ps,{})})]})}tc();sc(e(nc,{i18n:g,children:e(ic,{children:e(Xr,{})})}),document.getElementById("app"));setTimeout(()=>{try{Object.keys(localStorage).forEach(t=>{t.startsWith("iconify")&&localStorage.removeItem(t)}),Object.keys(sessionStorage).forEach(t=>{t.startsWith("iconify")&&sessionStorage.removeItem(t)}),localStorage.removeItem("settings:boostsCarousel")}catch{}},5e3);window.__CLOAK__=()=>{document.body.classList.toggle("cloak")};
//# sourceMappingURL=main-B2BmzGL6.js.map
