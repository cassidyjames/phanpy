import{A as q,y as se,h as L,s as x,a as ae,b as We,i as g,C as st,u as Ye,c as e,T as u,d as be,g as wt,p as $t,e as yn,f as z,j as Qe,k as Mn,L as ao,l as ke,D as ro,m as lo,o as qn,q as Gt,r as kt,t as ct,v as uo,w as De,x as vn,z as ki,_ as gt,B as cs,E as nd,F as as,G as rs,H as ho,I as fo,J as it,K as po,M as ei,N as ft,O as mo,P as go,Q as bo,R as ti,S as Mt,U as Xe,V as ls,W as ds,X as yo,Y as tn,Z as vo,$ as wo,a0 as Nn,a1 as Pn,a2 as _o,a3 as Si,a4 as ko,a5 as So,a6 as Co,a7 as ni,a8 as Ve,a9 as Io,aa as To,ab as Ao,ac as xo}from"./useTitle-YmXTaQ62.js";import{u as ii,s as ue,a as Ue,o as Ci,b as Eo,I as S,M as Fe,A as dt,N as mt,c as at,d as _e,e as Be,f as Ge,g as lt,L as he,l as It,h as us,t as Ii,i as Ze,R as Kt,p as sd,j as tt,k as Nt,m as rt,n as hs,q as jn,E as fs,r as Ke,v as ht,w as Ro,S as Tn,x as Ti,T as ps,y as ut,z as si,B as qe,C as _t,D as Lo,F as $o,G as Et,H as oi,J as ms,K as Mo,O as Ht,P as No,Q as Po,U as gs,V as Do,W as Oo,X as bs,Y as zo,Z as Rt,_ as ci,$ as Uo,a0 as ys,a1 as Bo,a2 as vs,a3 as Fo,a4 as Ho,a5 as Yo,a6 as Ai,a7 as qo,a8 as zt}from"./fuse-C_SMhnfT.js";var ws=jo;function jo(t,n,i){var s=null,o=null,a=function(){s&&(clearTimeout(s),o=null,s=null)},h=function(){var c=o;a(),c&&c()},r=function(){if(!n)return t.apply(this,arguments);var c=this,l=arguments,p=i&&!s;if(a(),o=function(){t.apply(c,l)},s=setTimeout(function(){if(s=null,!p){var f=o;return o=null,f()}},n),p)return o()};return r.cancel=a,r.flush=h,r}/*!
 * swiped-events.js - v@version@
 * Pure JavaScript swipe events
 * https://github.com/john-doherty/swiped-events
 * @inspiration https://stackoverflow.com/questions/16348031/disable-scrolling-when-touch-moving-certain-element
 * @author John Doherty <www.johndoherty.info>
 * @license MIT
 */(function(t,n){"use strict";typeof t.CustomEvent!="function"&&(t.CustomEvent=function(d,y){y=y||{bubbles:!1,cancelable:!1,detail:void 0};var b=n.createEvent("CustomEvent");return b.initCustomEvent(d,y.bubbles,y.cancelable,y.detail),b},t.CustomEvent.prototype=t.Event.prototype),n.addEventListener("touchstart",p,!1),n.addEventListener("touchmove",f,!1),n.addEventListener("touchend",l,!1);var i=null,s=null,o=null,a=null,h=null,r=null,c=0;function l(d){if(r===d.target){var y=parseInt(m(r,"data-swipe-threshold","20"),10),b=m(r,"data-swipe-unit","px"),v=parseInt(m(r,"data-swipe-timeout","500"),10),w=Date.now()-h,_="",C=d.changedTouches||d.touches||[];if(b==="vh"&&(y=Math.round(y/100*n.documentElement.clientHeight)),b==="vw"&&(y=Math.round(y/100*n.documentElement.clientWidth)),Math.abs(o)>Math.abs(a)?Math.abs(o)>y&&w<v&&(o>0?_="swiped-left":_="swiped-right"):Math.abs(a)>y&&w<v&&(a>0?_="swiped-up":_="swiped-down"),_!==""){var I={dir:_.replace(/swiped-/,""),touchType:(C[0]||{}).touchType||"direct",fingers:c,xStart:parseInt(i,10),xEnd:parseInt((C[0]||{}).clientX||-1,10),yStart:parseInt(s,10),yEnd:parseInt((C[0]||{}).clientY||-1,10)};r.dispatchEvent(new CustomEvent("swiped",{bubbles:!0,cancelable:!0,detail:I})),r.dispatchEvent(new CustomEvent(_,{bubbles:!0,cancelable:!0,detail:I}))}i=null,s=null,h=null}}function p(d){d.target.getAttribute("data-swipe-ignore")!=="true"&&(r=d.target,h=Date.now(),i=d.touches[0].clientX,s=d.touches[0].clientY,o=0,a=0,c=d.touches.length)}function f(d){if(!(!i||!s)){var y=d.touches[0].clientX,b=d.touches[0].clientY;o=i-y,a=s-b}}function m(d,y,b){for(;d&&d!==n.documentElement;){var v=d.getAttribute(y);if(v)return v;d=d.parentNode}return b}})(window,document);function Yt(t=()=>{},n=[]){const i=q(t);se(()=>{i.current=t},[n]),se(()=>{const s=()=>{const o=document.hidden||document.visibilityState==="hidden";i.current(!o)};return document.addEventListener("visibilitychange",s),()=>document.removeEventListener("visibilitychange",s)},[])}const Vo=1e3*3,xi=2e4,Go=st(function({isLoggedIn:n}){const[i,s]=L(!0),o=q();Yt(c=>{clearTimeout(o.current),c?s(!0):o.current=setTimeout(()=>{s(!1)},xi)});const a=async(c,l,p)=>{var f;if(x.notificationsLast){const m=c.v1.notifications.list({limit:1,sinceId:x.notificationsLast.id}),{value:d}=await m.next();if(d!=null&&d.length)if(p)x.notificationsShowNew=!0;else{let y;try{const b=await c.v1.markers.fetch({timeline:"notifications"});y=(f=b==null?void 0:b.notifications)==null?void 0:f.lastReadId}catch{}y?x.notificationsShowNew=d[0].id!==y:x.notificationsShowNew=!0}}};se(()=>{let c,l,p;if(n&&i){const{masto:f,streaming:m,instance:d}=ae();(async()=>{await a(f,d);let y=!1;m&&(l=setTimeout(()=>{(async()=>{try{y=!0,c=m.user.notification.subscribe();for await(const b of c){if(!c||!i)break;b.event==="notification"&&We(b.payload,d,{skipThreading:!0}),x.notificationsShowNew=!0}}catch{y=!1}y||(p=setInterval(()=>{a(f,d,!0)},xi))})()},Vo))})()}return()=>{var f;(f=c==null?void 0:c.unsubscribe)==null||f.call(c),c=null,clearTimeout(l),clearInterval(p)}},[i,n]);const h=q(),r=()=>{h.current=Date.now(),fetch("./version.json").then(c=>c.json()).then(c=>{c&&(x.appVersion=c)}).catch(c=>{})};return ii(r,i&&1e3*60*30),Yt(c=>{c&&(h.current?Date.now()-h.current>1e3*60*60&&r():r())}),Ue("shift+alt+k",()=>{const c=x.settings.cloakMode;x.settings.cloakMode=!c,ue({text:c?g._({id:"oguMwa"}):g._({id:"IXZLPs"})})}),null});function Ko(){const t=Ye(x);function n(i){if(t.composerState.minimized){x.composerState.minimized=!1,Ci();return}i.shiftKey?Eo()||(x.showCompose=!0):(Ci(),x.showCompose=!0)}return Ue("c, shift+c",n,{ignoreEventWhen:i=>!!document.querySelector("#modal-container > *")}),e("button",{type:"button",id:"compose-button",onClick:n,class:`${t.composerState.minimized?"min":""} ${t.composerState.publishing?"loading":""} ${t.composerState.publishingError?"error":""}`,children:e(S,{icon:"quill",size:"xl",alt:g._({id:"QOhkyl"})})})}const Wo=st(function(){const n=Ye(x);function i(){x.showKeyboardShortcutsHelp=!1}return Ue("?, shift+?, shift+slash",s=>{x.showKeyboardShortcutsHelp=!0},{ignoreEventWhen:s=>!!document.querySelector("#modal-container > *")}),!!n.showKeyboardShortcutsHelp&&e(Fe,{onClose:i,children:e("div",{id:"keyboard-shortcuts-help-container",class:"sheet",tabindex:"-1",children:[e("button",{type:"button",class:"sheet-close",onClick:i,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(u,{id:"77Emn0"})})}),e("main",{children:e("table",{children:e("tbody",{children:[{action:g._({id:"ulXSNi"}),keys:e("kbd",{children:"?"})},{action:g._({id:"Gy9P9T"}),keys:e("kbd",{children:"j"})},{action:g._({id:"6XYpYY"}),keys:e("kbd",{children:"k"})},{action:g._({id:"DYowFe"}),keys:e(u,{id:"mzjGX4",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:g._({id:"S5ez7Y"}),keys:e(u,{id:"Fd8FaU",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:g._({id:"VkLESX"}),keys:e("kbd",{children:"."})},{action:g._({id:"jsFF8C"}),keys:e(u,{id:"80sOCm",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:e(u,{id:"41gejM",components:{0:e("br",{})}}),keys:e("kbd",{children:"x"})},{action:g._({id:"jAj8rv"}),keys:e(u,{id:"evz6c6",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:g._({id:"duF1lx"}),keys:e(u,{id:"nhpsIN",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:g._({id:"YrR3Co"}),keys:e("kbd",{children:"]"})},{action:g._({id:"noxAFR"}),keys:e("kbd",{children:"["})},{action:g._({id:"AIa/f7"}),keys:e("kbd",{children:"c"})},{action:g._({id:"snPx8X"}),className:"insignificant",keys:e(u,{id:"+Cxvld",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:g._({id:"1pKapz"}),keys:e(u,{id:"py67WT",components:{0:e("kbd",{}),1:e("kbd",{}),2:e("kbd",{}),3:e("kbd",{})}})},{action:g._({id:"A1taO8"}),keys:e("kbd",{children:"/"})},{action:g._({id:"ImOQa9"}),keys:e("kbd",{children:"r"})},{action:g._({id:"KFs8c6"}),className:"insignificant",keys:e(u,{id:"XpQLJF",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:g._({id:"cqi4Mx"}),keys:e(u,{id:"84WuL2",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:g._({id:"kulphB"}),keys:e(u,{id:"yrz6Ck",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:g._({id:"PZlHt8"}),keys:e("kbd",{children:"d"})},{action:g._({id:"C7ujRh"}),keys:e(u,{id:"v4TbMP",components:{0:e("kbd",{}),1:e("kbd",{}),2:e("kbd",{})}})}].map(({action:s,className:o,keys:a})=>e("tr",{children:[e("th",{class:o,children:s}),e("td",{children:a})]},s))})})})]})})}),_s=new Set,nt=new WeakMap,qt=new WeakMap,Lt=new WeakMap,Vn=new WeakMap,Zo=new WeakMap,jt=new WeakMap,wn=new WeakMap,Qt=new WeakSet;let Tt,ai=0,ri=0;const yt="__aa_tgt",nn="__aa_del",_n="__aa_new",Xo=t=>{const n=ic(t);n&&n.forEach(i=>sc(i))},Jo=t=>{t.forEach(n=>{n.target===Tt&&ec(),nt.has(n.target)&&Pt(n.target)})};function Qo(t){const n=Vn.get(t);n==null||n.disconnect();let i=nt.get(t),s=0;const o=5;i||(i=Vt(t),nt.set(t,i));const{offsetWidth:a,offsetHeight:h}=Tt,c=[i.top-o,a-(i.left+o+i.width),h-(i.top+o+i.height),i.left-o].map(p=>`${-1*Math.floor(p)}px`).join(" "),l=new IntersectionObserver(()=>{++s>1&&Pt(t)},{root:Tt,threshold:1,rootMargin:c});l.observe(t),Vn.set(t,l)}function Pt(t){clearTimeout(wn.get(t));const n=An(t),i=sn(n)?500:n.duration;wn.set(t,setTimeout(async()=>{const s=Lt.get(t);try{await(s==null?void 0:s.finished),nt.set(t,Vt(t)),Qo(t)}catch{}},i))}function ec(){clearTimeout(wn.get(Tt)),wn.set(Tt,setTimeout(()=>{_s.forEach(t=>Is(t,n=>ks(()=>Pt(n))))},100))}function tc(t){setTimeout(()=>{Zo.set(t,setInterval(()=>ks(Pt.bind(null,t)),2e3))},Math.round(2e3*Math.random()))}function ks(t){typeof requestIdleCallback=="function"?requestIdleCallback(()=>t()):requestAnimationFrame(()=>t())}let Gn,Ft;const nc=typeof window<"u"&&"ResizeObserver"in window;nc&&(Tt=document.documentElement,Gn=new MutationObserver(Xo),Ft=new ResizeObserver(Jo),window.addEventListener("scroll",()=>{ri=window.scrollY,ai=window.scrollX}),Ft.observe(Tt));function ic(t){return t.reduce((s,o)=>[...s,...Array.from(o.addedNodes),...Array.from(o.removedNodes)],[]).every(s=>s.nodeName==="#comment")?!1:t.reduce((s,o)=>{if(s===!1)return!1;if(o.target instanceof Element){if(Dn(o.target),!s.has(o.target)){s.add(o.target);for(let a=0;a<o.target.children.length;a++){const h=o.target.children.item(a);if(h){if(nn in h)return!1;Dn(o.target,h),s.add(h)}}}if(o.removedNodes.length)for(let a=0;a<o.removedNodes.length;a++){const h=o.removedNodes[a];if(nn in h)return!1;h instanceof Element&&(s.add(h),Dn(o.target,h),qt.set(h,[o.previousSibling,o.nextSibling]))}}return s},new Set)}function Dn(t,n){!n&&!(yt in t)?Object.defineProperty(t,yt,{value:t}):n&&!(yt in n)&&Object.defineProperty(n,yt,{value:t})}function sc(t){var n;const i=t.isConnected,s=nt.has(t);i&&qt.has(t)&&qt.delete(t),Lt.has(t)&&((n=Lt.get(t))===null||n===void 0||n.cancel()),_n in t?Ei(t):s&&i?cc(t):s&&!i?ac(t):Ei(t)}function pt(t){return Number(t.replace(/[^0-9.\-]/g,""))}function oc(t){let n=t.parentElement;for(;n;){if(n.scrollLeft||n.scrollTop)return{x:n.scrollLeft,y:n.scrollTop};n=n.parentElement}return{x:0,y:0}}function Vt(t){const n=t.getBoundingClientRect(),{x:i,y:s}=oc(t);return{top:n.top+s,left:n.left+i,width:n.width,height:n.height}}function Ss(t,n,i){let s=n.width,o=n.height,a=i.width,h=i.height;const r=getComputedStyle(t);if(r.getPropertyValue("box-sizing")==="content-box"){const l=pt(r.paddingTop)+pt(r.paddingBottom)+pt(r.borderTopWidth)+pt(r.borderBottomWidth),p=pt(r.paddingLeft)+pt(r.paddingRight)+pt(r.borderRightWidth)+pt(r.borderLeftWidth);s-=p,a-=p,o-=l,h-=l}return[s,a,o,h].map(Math.round)}function An(t){return yt in t&&jt.has(t[yt])?jt.get(t[yt]):{duration:250,easing:"ease-in-out"}}function Cs(t){if(yt in t)return t[yt]}function li(t){const n=Cs(t);return n?Qt.has(n):!1}function Is(t,...n){n.forEach(i=>i(t,jt.has(t)));for(let i=0;i<t.children.length;i++){const s=t.children.item(i);s&&n.forEach(o=>o(s,jt.has(s)))}}function di(t){return Array.isArray(t)?t:[t]}function sn(t){return typeof t=="function"}function cc(t){const n=nt.get(t),i=Vt(t);if(!li(t))return nt.set(t,i);let s;if(!n)return;const o=An(t);if(typeof o!="function"){const a=n.left-i.left,h=n.top-i.top,[r,c,l,p]=Ss(t,n,i),f={transform:`translate(${a}px, ${h}px)`},m={transform:"translate(0, 0)"};r!==c&&(f.width=`${r}px`,m.width=`${c}px`),l!==p&&(f.height=`${l}px`,m.height=`${p}px`),s=t.animate([f,m],{duration:o.duration,easing:o.easing})}else{const[a]=di(o(t,"remain",n,i));s=new Animation(a),s.play()}Lt.set(t,s),nt.set(t,i),s.addEventListener("finish",Pt.bind(null,t))}function Ei(t){_n in t&&delete t[_n];const n=Vt(t);nt.set(t,n);const i=An(t);if(!li(t))return;let s;if(typeof i!="function")s=t.animate([{transform:"scale(.98)",opacity:0},{transform:"scale(0.98)",opacity:0,offset:.5},{transform:"scale(1)",opacity:1}],{duration:i.duration*1.5,easing:"ease-in"});else{const[o]=di(i(t,"add",n));s=new Animation(o),s.play()}Lt.set(t,s),s.addEventListener("finish",Pt.bind(null,t))}function Ri(t,n){var i;t.remove(),nt.delete(t),qt.delete(t),Lt.delete(t),(i=Vn.get(t))===null||i===void 0||i.disconnect(),setTimeout(()=>{if(nn in t&&delete t[nn],Object.defineProperty(t,_n,{value:!0,configurable:!0}),n&&t instanceof HTMLElement)for(const s in n)t.style[s]=""},0)}function ac(t){var n;if(!qt.has(t)||!nt.has(t))return;const[i,s]=qt.get(t);Object.defineProperty(t,nn,{value:!0,configurable:!0});const o=window.scrollX,a=window.scrollY;if(s&&s.parentNode&&s.parentNode instanceof Element?s.parentNode.insertBefore(t,s):i&&i.parentNode?i.parentNode.appendChild(t):(n=Cs(t))===null||n===void 0||n.appendChild(t),!li(t))return Ri(t);const[h,r,c,l]=lc(t),p=An(t),f=nt.get(t);(o!==ai||a!==ri)&&rc(t,o,a,p);let m,d={position:"absolute",top:`${h}px`,left:`${r}px`,width:`${c}px`,height:`${l}px`,margin:"0",pointerEvents:"none",transformOrigin:"center",zIndex:"100"};if(!sn(p))Object.assign(t.style,d),m=t.animate([{transform:"scale(1)",opacity:1},{transform:"scale(.98)",opacity:0}],{duration:p.duration,easing:"ease-out"});else{const[y,b]=di(p(t,"remove",f));(b==null?void 0:b.styleReset)!==!1&&(d=(b==null?void 0:b.styleReset)||d,Object.assign(t.style,d)),m=new Animation(y),m.play()}Lt.set(t,m),m.addEventListener("finish",Ri.bind(null,t,d))}function rc(t,n,i,s){const o=ai-n,a=ri-i,h=document.documentElement.style.scrollBehavior;if(getComputedStyle(Tt).scrollBehavior==="smooth"&&(document.documentElement.style.scrollBehavior="auto"),window.scrollTo(window.scrollX+o,window.scrollY+a),!t.parentElement)return;const c=t.parentElement;let l=c.clientHeight,p=c.clientWidth;const f=performance.now();function m(){requestAnimationFrame(()=>{if(!sn(s)){const d=l-c.clientHeight,y=p-c.clientWidth;f+s.duration>performance.now()?(window.scrollTo({left:window.scrollX-y,top:window.scrollY-d}),l=c.clientHeight,p=c.clientWidth,m()):document.documentElement.style.scrollBehavior=h}})}m()}function lc(t){const n=nt.get(t),[i,,s]=Ss(t,n,Vt(t));let o=t.parentElement;for(;o&&(getComputedStyle(o).position==="static"||o instanceof HTMLBodyElement);)o=o.parentElement;o||(o=document.body);const a=getComputedStyle(o),h=nt.get(o)||Vt(o),r=Math.round(n.top-h.top)-pt(a.borderTopWidth),c=Math.round(n.left-h.left)-pt(a.borderLeftWidth);return[r,c,i,s]}function Ts(t,n={}){return Gn&&Ft&&(window.matchMedia("(prefers-reduced-motion: reduce)").matches&&!sn(n)&&!n.disrespectUserMotionPreference||(Qt.add(t),getComputedStyle(t).position==="static"&&Object.assign(t.style,{position:"relative"}),Is(t,Pt,tc,o=>Ft==null?void 0:Ft.observe(o)),sn(n)?jt.set(t,n):jt.set(t,{duration:250,easing:"ease-in-out",...n}),Gn.observe(t,{childList:!0}),_s.add(t))),Object.freeze({parent:t,enable:()=>{Qt.add(t)},disable:()=>{Qt.delete(t)},isEnabled:()=>Qt.has(t)})}function ui(t){const n=q(null),[i,s]=L(),o=a=>{i&&(a?i.enable():i.disable())};return se(()=>{n.current instanceof HTMLElement&&s(Ts(n.current,t||{}))},[]),[n,o]}const dc=window.matchMedia("(display-mode: standalone)").matches;function uc({onClose:t}){const{masto:n}=ae(),i=be.local.getJSON("accounts"),s=wt(),o=i.length>1,[a,h]=$t(c=>c+1,0),[r]=ui();return e("div",{id:"accounts-container",class:"sheet",tabIndex:"-1",children:[!!t&&e("button",{type:"button",class:"sheet-close",onClick:t,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{class:"header-grid",children:e("h2",{children:e(u,{id:"bPwFdf"})})}),e("main",{children:e("section",{children:[e("ul",{class:"accounts-list",ref:r,children:i.map((c,l)=>{const p=c.info.id===s,f=l===0;return e("li",{children:[e("div",{children:[o&&e("span",{class:`current ${p?"is-current":""}`,children:e(S,{icon:"check-circle",alt:g._({id:"Hp1l6f"})})}),e(dt,{url:c.info.avatarStatic,size:"xxl",onDblClick:async()=>{if(p)try{const m=await n.v1.accounts.$select(c.info.id).fetch();c.info=m,be.local.setJSON("accounts",i),h()}catch{}}}),e(mt,{account:o?{...c.info,acct:/@/.test(c.info.acct)?c.info.acct:`${c.info.acct}@${c.instanceURL}`}:c.info,showAcct:!0,onClick:()=>{p?x.showAccount=`${c.info.username}@${c.instanceURL}`:(yn(c.info.id),location.reload())}})]}),e("div",{class:"actions",children:[f&&o&&e(z,{children:[e("span",{class:"tag",children:e(u,{id:"ovBPCi"})})," "]}),e(at,{align:"end",menuButton:e("button",{type:"button",class:"plain more-button",children:e(S,{icon:"more",size:"l",alt:g._({id:"2FYpfJ"})})}),children:[o&&e(z,{children:[e(_e,{disabled:p,onClick:()=>{yn(c.info.id),location.reload()},children:[e(S,{icon:"transfer"})," ",e(u,{id:"3t/Nrv"})]}),!dc&&!p&&e(Be,{href:`./?account=${c.info.id}`,target:"_blank",children:[e(S,{icon:"external"}),e("span",{children:e(u,{id:"PZgZtY"})})]}),e(Ge,{})]}),e(_e,{onClick:()=>{x.showAccount=`${c.info.username}@${c.instanceURL}`},children:[e(S,{icon:"user"}),e("span",{children:e(u,{id:"40z2Fm"})})]}),e(Ge,{}),o&&e(_e,{disabled:f,onClick:()=>{i.splice(l,1),i.unshift(c),be.local.setJSON("accounts",i),h()},children:[e(S,{icon:"check-circle"}),e("span",{children:e(u,{id:"PPcets"})})]}),e(lt,{subMenu:!0,confirmLabel:e(z,{children:[e(S,{icon:"exit"}),e("span",{children:e(u,{id:"k08LxG",values:{0:c.info.acct},components:{0:e("span",{class:"bidi-isolate"})}})})]}),disabled:!p,menuItemClassName:"danger",onClick:()=>{i.splice(l,1),be.local.setJSON("accounts",i),location.href=location.pathname||"/"},children:[e(S,{icon:"exit"}),e("span",{children:e(u,{id:"CXk1bI"})})]})]})]})]},c.info.id)})}),e("p",{children:e(he,{to:"/login",class:"button plain2",onClick:t,children:[e(S,{icon:"plus"})," ",e("span",{children:e(u,{id:"Is7/PB"})})]})}),o&&e("p",{children:e("small",{children:e(u,{id:"52x24e",components:{0:e("i",{})}})})})]})})]})}const hi="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20fill-rule='evenodd'%20stroke-linejoin='round'%20stroke-miterlimit='2'%20clip-rule='evenodd'%20viewBox='0%200%2064%2064'%3e%3cpath%20fill='none'%20d='M0%200h63.994v63.994H0z'/%3e%3cpath%20fill='%23a4bff7'%20d='M37.774%2011.471c14.639%203.752%2019.034%2016.557%2015.889%2031.304-.696%203.261-2.563%206.661-6.356%208.693-3.204%201.717-8.07%202.537-15.338.55l-9.634-2.404C11.651%2046.992%208.378%2038.733%2010.027%2031.823c3.627-15.201%2015.543-23.48%2027.747-20.352Z'/%3e%3cpath%20fill='%23d8e7fe'%20d='M36.76%2015.429c12.289%203.15%2015.547%2014.114%2012.907%2026.493-.947%204.44-4.937%209.365-16.664%206.143l-9.684-2.417c-7.854-1.923-10.53-7.8-9.318-12.877%203.016-12.639%2012.611-19.943%2022.759-17.342Z'/%3e%3cpath%20fill='%236081e6'%20d='M27.471%2024.991c-1.457-.698-7.229%203.213-7.663%208.926-.182%202.39%204.55%203.237%205.071-.169.725-4.743%203.715-8.218%202.592-8.757Zm10.746%202.005c-2.083.327-.382%205.901-.595%2010.727-.123%202.8%204.388%203.464%204.703%202.011%201.098-5.073-2.066-13.058-4.108-12.738Z'/%3e%3c/svg%3e",hc={"zh-CN":"zh-Hans","zh-TW":"zh-Hant","pt-BR":"pt-BR"};function fi(){const{i18n:t}=Qe(),n=ke(()=>ao.map(i=>{var h,r;const s=hc[i]||i.replace(/-[a-z]+$/i,""),o=It({code:s,locale:i,fallback:(h=Mn.find(c=>c.code===i))==null?void 0:h.nativeName}),a=It({code:s,locale:t.locale,fallback:(r=Mn.find(c=>c.code===i))==null?void 0:r.name});return{code:i,regionlessCode:s,_common:a,native:o}}).sort((i,s)=>{const o=i._common.localeCompare(s._common,t.locale);return o!==0?o:i.code<s.code?-1:i.code>s.code?1:0}),[]);return e("label",{class:"lang-selector",children:["ðŸŒ"," ",e("select",{class:"small",value:t.locale||ro,onChange:i=>{be.local.set("lang",i.target.value),lo(i.target.value)},children:[n.map(({code:i,regionlessCode:s,native:o})=>{var r;const a=It({code:s,locale:t.locale,fallback:(r=Mn.find(c=>c.code===i))==null?void 0:r.name});return e("option",{value:i,"data-regionless-code":s,children:!!a&&a!==o?`${o} - ${a}`:o},i)}),void 0]})]})}function Li(t){const{masto:n}=ae();return n.v1.push.subscription.create(t)}function fc(){const{masto:t}=ae();return t.v1.push.subscription.fetch()}function pc(t){const{masto:n}=ae();return n.v1.push.subscription.update(t)}function mc(){const{masto:t}=ae();return t.v1.push.subscription.remove()}function xn(){return"serviceWorker"in navigator&&"PushManager"in window}function gc(){return navigator.serviceWorker.getRegistration()}async function pi(){const t=await gc(),n=t?await t.pushManager.getSubscription():void 0;return{registration:t,subscription:n}}function As(t){const n="=".repeat((4-t.length%4)%4),i=`${t}${n}`.replace(/-/g,"+").replace(/_/g,"/"),s=window.atob(i),o=new Uint8Array(s.length);for(let a=0;a<s.length;++a)o[a]=s.charCodeAt(a);return o}async function bc(){if(!xn())return;const{subscription:t}=await pi();let n=null;try{n=await fc()}catch(i){if(!/(not found|unknown)/i.test(i.message))throw i}if(n&&t){const i=n.endpoint===t.endpoint,s=qn(),o=n.serverKey===s;if(!i)throw new Error("Backend subscription endpoint changed");if(!o)throw new Error("Backend subscription key and vapid key changed")}if(t&&!n){const i=qn();if(i){const{applicationServerKey:s}=t.options,o=As(i).toString(),a=new Uint8Array(s).toString();if(!(o===a))throw await t.unsubscribe(),new Error("Subscription key and vapid key changed")}}return{subscription:t,backendSubscription:n}}async function $i({data:t,policy:n}){if(!xn())return;let{registration:i,subscription:s}=await pi(),o=null;if(s)try{o=await pc({data:t,policy:n})}catch{o=await Li({subscription:s,data:t,policy:n})}else{const a=qn();if(!a)throw new Error("No server key found");s=await i.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:As(a)}),o=await Li({subscription:s,data:t,policy:n})}return{subscription:s,backendSubscription:o}}async function Mi(){if(!xn())return;const{subscription:t}=await pi();t&&(await mc(),await t.unsubscribe())}const yc={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Blaede Phanpy",PHANPY_DEFAULT_INSTANCE:"mastodon.blaede.family",PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:"https://mastodon.blaede.family/auth/sign_up",PHANPY_GIPHY_API_KEY:"48JGsrSS1XE5w4nWe9c9hqxPbsfRWR0e",PHANPY_LINGVA_INSTANCES:"lingva.phanpy.social lingva.lunar.icu lingva.garudalinux.org translate.plausibility.cloud",PHANPY_PRIVACY_POLICY_URL:"https://mastodon.blaede.family/privacy-policy",PHANPY_WEBSITE:"https://phanpy.blaede.family",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},Ni=16,xt=[14,15,16,17,18,19,20],{PHANPY_WEBSITE:Pi,PHANPY_PRIVACY_POLICY_URL:vc,PHANPY_IMG_ALT_API_URL:wc,PHANPY_GIPHY_API_KEY:_c}=yc;function kc({onClose:t}){const n=Ye(x),i=be.local.get("theme")||"auto",s=q(),o=n.settings.contentTranslationTargetLanguage||null,a=us(),h=It(a),r=be.local.get("textSize")||Ni,[c,l]=L(be.account.get("preferences")||{}),{masto:p,authenticated:f,instance:m}=ae();return e("div",{id:"settings-container",class:"sheet",tabIndex:"-1",style:{"--current-text-size":`${r}px`},children:[!!t&&e("button",{type:"button",class:"sheet-close",onClick:t,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(u,{id:"Tz0i8g"})})}),e("main",{children:[e("section",{children:e("ul",{children:[e("li",{children:[e("div",{children:e("label",{children:e(u,{id:"aAIQg2"})})}),e("div",{children:e("form",{ref:s,onInput:d=>{d.preventDefault();const b=new FormData(s.current).get("theme"),v=document.documentElement;if(b==="auto"){v.classList.remove("is-light","is-dark");const w=document.querySelector('meta[data-theme-setting="manual"]');w&&(w.name=""),document.querySelectorAll('meta[data-theme-setting="auto"]').forEach(C=>{C.name="theme-color"})}else{v.classList.toggle("is-light",b==="light"),v.classList.toggle("is-dark",b==="dark");const w=document.querySelector('meta[data-theme-setting="manual"]');w&&(w.name="theme-color",w.content=b==="light"?w.dataset.themeLightColor:w.dataset.themeDarkColor),document.querySelectorAll('meta[data-theme-setting="auto"]').forEach(C=>{C.name=""})}document.querySelector('meta[name="color-scheme"]').setAttribute("content",b==="auto"?"dark light":b),b==="auto"?be.local.del("theme"):be.local.set("theme",b)},children:e("div",{class:"radio-group",children:[e("label",{children:[e("input",{type:"radio",name:"theme",value:"light",defaultChecked:i==="light"}),e("span",{children:e(u,{id:"1njn7W"})})]}),e("label",{children:[e("input",{type:"radio",name:"theme",value:"dark",defaultChecked:i==="dark"}),e("span",{children:e(u,{id:"pvnfJD"})})]}),e("label",{children:[e("input",{type:"radio",name:"theme",value:"auto",defaultChecked:i!=="light"&&i!=="dark"}),e("span",{children:e(u,{id:"R9Khdg"})})]})]})})})]}),e("li",{children:[e("div",{children:e("label",{children:e(u,{id:"7r6sCa"})})}),e("div",{class:"range-group",children:[e("span",{style:{fontSize:xt[0]},children:e(u,{id:"J6ypuD"})})," ",e("input",{type:"range",min:xt[0],max:xt[xt.length-1],step:"1",value:r,list:"sizes",onChange:d=>{const y=parseInt(d.target.value,10);document.documentElement.style.setProperty("--text-size",`${y}px`),y===Ni?be.local.del("textSize"):be.local.set("textSize",d.target.value)}})," ",e("span",{style:{fontSize:xt[xt.length-1]},children:e(u,{id:"J6ypuD"})}),e("datalist",{id:"sizes",children:xt.map(d=>e("option",{value:d}))})]})]}),e("li",{children:[e("span",{children:[e("label",{children:e(u,{id:"CeJHfb"})}),e("br",{}),e("small",{children:e("a",{href:"https://crowdin.com/project/phanpy",target:"_blank",rel:"noopener noreferrer",children:e(u,{id:"FFmj1D"})})})]}),e(fi,{})]})]})}),f&&e(z,{children:[e("h3",{children:e(u,{id:"PcoS3v"})}),e("section",{children:e("ul",{children:e("li",{children:[e("div",{children:e("label",{for:"posting-privacy-field",children:[e(u,{id:"NAjVvt"})," ",e(S,{icon:"cloud",alt:g._({id:"N2FcBE"}),class:"synced-icon"})]})}),e("div",{children:e("select",{id:"posting-privacy-field",value:c["posting:default:visibility"]||"public",onChange:d=>{const{value:y}=d.target;(async()=>{try{await p.v1.accounts.updateCredentials({source:{privacy:y}}),l({...c,"posting:default:visibility":y}),be.account.set("preferences",{...c,"posting:default:visibility":y})}catch{alert(g._({id:"Oa+KBY"}))}})()},children:[e("option",{value:"public",children:e(u,{id:"7d1a0d"})}),e("option",{value:"unlisted",children:e(u,{id:"WDcQq9"})}),e("option",{value:"private",children:e(u,{id:"o34OrG"})})]})})]})})}),e("p",{class:"section-postnote",children:[e(S,{icon:"cloud",alt:g._({id:"N2FcBE"}),class:"synced-icon"})," ",e("small",{children:e(u,{id:"xlsg7n",values:{instance:m},components:{0:e("a",{href:`https://${m}/`,target:"_blank",rel:"noopener noreferrer"})}})})]})]}),e("h3",{children:e(u,{id:"ivdhsq"})}),e("section",{children:e("ul",{children:[e("li",{class:"block",children:e("label",{children:[e("input",{type:"checkbox",checked:n.settings.autoRefresh,onChange:d=>{x.settings.autoRefresh=d.target.checked}})," ",e(u,{id:"0mC0SF"})]})}),e("li",{class:"block",children:e("label",{children:[e("input",{type:"checkbox",checked:n.settings.boostsCarousel,onChange:d=>{x.settings.boostsCarousel=d.target.checked}})," ",e(u,{id:"TSbnoW"})]})}),e("li",{class:"block",children:[e("label",{children:[e("input",{type:"checkbox",checked:n.settings.contentTranslation,onChange:d=>{const{checked:y}=d.target;x.settings.contentTranslation=y,y||(x.settings.contentTranslationTargetLanguage=null)}})," ",e(u,{id:"0SdaOt"})]}),e("div",{class:`sub-section ${n.settings.contentTranslation?"":"more-insignificant"}`,children:[e("div",{children:e("label",{children:[e(u,{id:"rJ8YHs"})," ",e("select",{value:o||"",disabled:!n.settings.contentTranslation,style:{width:"10em"},onChange:d=>{x.settings.contentTranslationTargetLanguage=d.target.value||null},children:[e("option",{value:"",children:e(u,{id:"jNCSyx",values:{systemTargetLanguageText:h}})}),e("option",{disabled:!0,children:"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"}),Ii.map(d=>{const y=It({code:d.code,fallback:d.name}),b=It({code:d.code,locale:d.code}),v=y!==b;return e("option",{value:d.code,children:v?`${b} - ${y}`:y})})]})]})}),e("hr",{}),e("div",{class:"checkbox-fieldset",children:[e(u,{id:"cc0NrU",values:{0:n.settings.contentTranslationHideLanguages.length}}),e("div",{class:"checkbox-fields",children:Ii.map(d=>{const y=It({code:d.code,fallback:d.name}),b=It({code:d.code,locale:d.code}),v=y!==b;return e("label",{children:[e("input",{type:"checkbox",checked:n.settings.contentTranslationHideLanguages.includes(d.code),onChange:w=>{const{checked:_}=w.target;_?x.settings.contentTranslationHideLanguages.push(d.code):x.settings.contentTranslationHideLanguages=n.settings.contentTranslationHideLanguages.filter(C=>C!==d.code)}})," ",v?e("span",{children:[b," ",e("span",{class:"insignificant",children:["- ",y]})]}):y]})})})]}),e("p",{class:"insignificant",children:e("small",{children:e(u,{id:"xpF+wU",components:{0:e("a",{href:"https://github.com/cheeaun/lingva-api",target:"_blank",rel:"noopener noreferrer"}),1:e("a",{href:"https://github.com/thedaviddelta/lingva-translate",target:"_blank",rel:"noopener noreferrer"})}})})}),e("hr",{}),e("div",{children:[e("label",{children:[e("input",{type:"checkbox",checked:n.settings.contentTranslationAutoInline,disabled:!n.settings.contentTranslation,onChange:d=>{x.settings.contentTranslationAutoInline=d.target.checked}})," ",e(u,{id:"gURvmk"})]}),e("p",{class:"insignificant",children:e("small",{children:e(u,{id:"PbHARL",components:{0:e("b",{})}})})})]})]})]}),!!_c&&f&&e("li",{class:"block",children:[e("label",{children:[e("input",{type:"checkbox",checked:n.settings.composerGIFPicker,onChange:d=>{x.settings.composerGIFPicker=d.target.checked}})," ",e(u,{id:"D7/2jB"})]}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(u,{id:"/CLBTL",components:{0:e("a",{href:"https://developers.giphy.com/",target:"_blank",rel:"noopener noreferrer"})}})})})]}),!!wc&&f&&e("li",{class:"block",children:[e("label",{children:[e("input",{type:"checkbox",checked:n.settings.mediaAltGenerator,onChange:d=>{x.settings.mediaAltGenerator=d.target.checked}})," ",e(u,{id:"9q5uor"})," ",e(S,{icon:"sparkles2",class:"more-insignificant"})]}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(u,{id:"faZ9RI"})})}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(u,{id:"fHZgvt",components:{0:e("a",{href:"https://github.com/cheeaun/img-alt-api",target:"_blank",rel:"noopener noreferrer"})}})})})]}),f&&Ze("@mastodon/grouped-notifications")&&e("li",{class:"block",children:[e("label",{children:[e("input",{type:"checkbox",checked:n.settings.groupedNotificationsAlpha,onChange:d=>{x.settings.groupedNotificationsAlpha=d.target.checked}})," ",e(u,{id:"aGziA/"})]}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(u,{id:"X17jCM"})})})]}),f&&e("li",{class:"block",children:[e("label",{children:[e("input",{type:"checkbox",checked:n.settings.shortcutSettingsCloudImportExport,onChange:d=>{x.settings.shortcutSettingsCloudImportExport=d.target.checked}})," ",e(u,{id:"570qTm"})," ",e(S,{icon:"cloud",class:"more-insignificant"})]}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(u,{id:"0tZAhT",components:{0:e("br",{})}})})}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(u,{id:"fHf1v/"})})})]}),e("li",{class:"block",children:[e("label",{children:[e("input",{type:"checkbox",checked:n.settings.cloakMode,onChange:d=>{x.settings.cloakMode=d.target.checked}})," ",e(u,{id:"lxYe+I",components:{0:e("span",{class:"insignificant"}),1:e("samp",{}),2:e("samp",{})}})]}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(u,{id:"T/hglb"})})})]}),f&&e("li",{children:e("button",{type:"button",class:"light",onClick:()=>{x.showDrafts=!0,x.showSettings=!1},children:e(u,{id:"krk5ws"})})})]})}),f&&e(Sc,{onClose:t}),e("h3",{children:e(u,{id:"uyJsf6"})}),e("section",{children:[e("div",{style:{display:"flex",flexWrap:"wrap",gap:8,lineHeight:1.25,alignItems:"center",marginTop:8},children:[e("img",{src:hi,alt:"",width:"64",height:"64",style:{aspectRatio:"1/1",verticalAlign:"middle",background:"#b7cdf9",borderRadius:12}}),e("div",{children:[e("b",{children:"Phanpy"})," ",e("a",{href:"https://hachyderm.io/@phanpy",rel:"noopener noreferrer",onClick:d=>{d.preventDefault(),x.showAccount="phanpy@hachyderm.io"},children:"@phanpy"}),e("br",{}),e(u,{id:"AZ2EoP",components:{0:e("a",{href:"https://github.com/cheeaun/phanpy",target:"_blank",rel:"noopener noreferrer"}),1:e("a",{href:"https://mastodon.social/@cheeaun",rel:"noopener noreferrer",onClick:d=>{d.preventDefault(),x.showAccount="cheeaun@mastodon.social"}})}})]})]}),e("p",{children:[e("a",{href:"https://github.com/sponsors/cheeaun",target:"_blank",rel:"noopener noreferrer",children:e(u,{id:"O4cLCR"})})," ","Â·"," ",e("a",{href:"https://www.buymeacoffee.com/cheeaun",target:"_blank",rel:"noopener noreferrer",children:e(u,{id:"Ng063n"})})," ","Â·"," ",e("a",{href:"https://patreon.com/cheeaun",target:"_blank",rel:"noopener noreferrer",children:"Patreon"})," ","Â·"," ",e("a",{href:vc,target:"_blank",rel:"noopener noreferrer",children:e(u,{id:"LcET2C"})})]}),e("p",{children:[Pi&&e(z,{children:[e(u,{id:"pFnMHn",values:{0:Pi.replace(/https?:\/\//g,"").replace(/\/$/,"")},components:{0:e("span",{class:"insignificant"})}}),e("br",{})]}),e(u,{id:"6KkH+2",values:{0:e("span",{class:"ib insignificant",children:["(",e("a",{href:"https://github.com/cheeaun/phanpy/commit/edb2281",target:"_blank",rel:"noopener noreferrer",children:e(Kt,{datetime:new Date("2024-11-21T20:47:04.719Z")})}),")"]})},components:{0:e("span",{class:"insignificant"}),1:e("input",{type:"text",class:"version-string",readOnly:!0,size:"18",value:`${"2024-11-21T20:47:04.719Z".slice(0,10).replace(/-/g,".")}.edb2281`,onClick:d=>{d.target.select();try{navigator.clipboard.writeText(d.target.value),ue(g._({id:"PiPfua"}))}catch{ue(g._({id:"gdxreD"}))}}})}})]})]}),void 0]})]})}function Sc({onClose:t}){if(!xn())return null;const{instance:n}=ae(),[i,s]=L("default"),o=q(),[a,h]=L(!1),[r,c]=L(!1),l=q();se(()=>{(async()=>{s("loading");try{const{subscription:f,backendSubscription:m}=await bc();if(m!=null&&m.policy&&m.policy!=="none"){h(!0);const{alerts:d,policy:y}=m;l.current=y;const{elements:b}=o.current,v=b.namedItem("policy");v&&(v.value=y),Object.keys(d).forEach(w=>{const _=b.namedItem(w);(_==null?void 0:_.type)==="checkbox"&&(_.checked=!0)})}s("default")}catch(f){/outside.*authorized/i.test(f.message)?c(!0):alert((f==null?void 0:f.message)||f),s("error")}})()},[]);const p=i==="loading";return e("form",{ref:o,onChange:()=>{setTimeout(()=>{const f=Object.fromEntries(new FormData(o.current)),m=!!f["policy-allow"],d={data:{policy:f.policy,alerts:{mention:!!f.mention,favourite:!!f.favourite,reblog:!!f.reblog,follow:!!f.follow,follow_request:!!f.followRequest,poll:!!f.poll,update:!!f.update,status:!!f.status}}};let y=0;Object.keys(d.data.alerts).forEach(v=>{d.data.alerts[v]?y++:delete d.data.alerts[v]});const b=l.current!==d.data.policy;m&&y>0?b?Mi().then(()=>{$i(d)}).catch(v=>{alert(g._({id:"I6pdY3"}))}):$i(d).catch(v=>{alert(g._({id:"I6pdY3"}))}):Mi().catch(v=>{alert(g._({id:"q1zFd+"}))})},100)},children:[e("h3",{children:e(u,{id:"WUHLnz"})}),e("section",{children:e("ul",{children:e("li",{children:[e("label",{children:[e("input",{type:"checkbox",disabled:p||r,name:"policy-allow",checked:a,onChange:async f=>{const{checked:m}=f.target;if(m){const d=await Notification.requestPermission();d==="granted"?h(!0):(h(!1),d==="denied"&&alert(g._({id:"6LUsk7"})))}else h(!1)}})," ",e(u,{id:"qYNCa1",values:{0:[{value:"all",label:g._({id:"+niKJH"})},{value:"followed",label:g._({id:"x2NYtp"})},{value:"follower",label:g._({id:"PBFNgg"})}].map(f=>e("option",{value:f.value,children:f.label}))},components:{0:e("select",{name:"policy",disabled:p||r||!a})}})]}),e("div",{class:"shazam-container no-animation",style:{width:"100%"},hidden:!a,children:e("div",{class:"shazam-container-inner",children:e("div",{class:"sub-section",children:e("ul",{children:[{value:"mention",label:g._({id:"/bZzdR"})},{value:"favourite",label:g._({id:"zZOZj7"})},{value:"reblog",label:g._({id:"puY2t0"})},{value:"follow",label:g._({id:"aaJhcT"})},{value:"followRequest",label:g._({id:"6Fs1Ba"})},{value:"poll",label:g._({id:"wNExRS"})},{value:"update",label:g._({id:"K/EtE6"})},{value:"status",label:g._({id:"2yr1/p"})}].map(f=>e("li",{children:e("label",{children:[e("input",{type:"checkbox",name:f.value})," ",f.label]})}))})})})}),r&&e("div",{class:"sub-section",children:e("p",{children:e(u,{id:"8d0b8B",components:{0:e(he,{to:`/login?instance=${n}`,onClick:t}),1:e("b",{})}})})})]})})}),e("p",{class:"section-postnote",children:e("small",{children:e(u,{id:"z96cOX",components:{0:e("b",{})}})})})]})}const Kn=()=>{let t=setTimeout(()=>{var i,s;const n=document.getElementById("columns");if(n){const o=n.querySelector(".deck-container.focus");if(o)o.focus();else{const a=n.querySelectorAll(".deck-container").find(h=>h.getBoundingClientRect().left>=0);a?a.focus():(s=(i=n.querySelector(".deck-container"))==null?void 0:i.focus)==null||s.call(i)}}else{const o=document.querySelectorAll("#modal-container > *");if(o!=null&&o.length){const c=o[o.length-1],l=c.querySelector('[tabindex="-1"]')||c;if(l){l.focus();return}}if(document.querySelector(".deck-backdrop"))return;const h=document.querySelectorAll(".deck-container"),r=h[h.length-1];r&&r.tabIndex===-1&&r.focus()}},100);return()=>clearTimeout(t)};function xs(t){if(!t)return;const n=Gt(),i=q(n.pathname);se(()=>{i.current&&n.pathname!==i.current&&(t==null||t())},[n.pathname,t])}const Es=1e3*60,Cc=24*60*60*1e3,Wn=kt(async()=>{const{masto:t}=ae(),n=await t.v1.lists.list();return n.sort((i,s)=>i.title.localeCompare(s.title)),n.length&&setTimeout(()=>{be.account.set("lists",{lists:n,updatedAt:Date.now()})},1),n},{maxAge:Es});async function on(){try{const{lists:t,updatedAt:n}=be.account.get("lists")||{};return t!=null&&t.length?(Date.now()-n>Cc&&Wn(),t):await Wn()}catch{return[]}}const Ic=kt(t=>{const{masto:n}=ae();return n.v1.lists.$select(t).fetch()},{maxAge:Es});async function Rs(t){const{lists:n}=be.account.get("lists")||{};if(n!=null&&n.length){const i=n.find(s=>s.id===t);if(i)return i}try{return Ic(t)}catch{return null}}async function Tc(t){const n=await Rs(t);return(n==null?void 0:n.title)||""}function Ac(t){const{lists:n}=be.account.get("lists")||{};n!=null&&n.length&&(n.push(t),n.sort((i,s)=>i.title.localeCompare(s.title)),be.account.set("lists",{lists:n,updatedAt:Date.now()}))}function xc(t){const{lists:n}=be.account.get("lists")||{};if(n!=null&&n.length){const i=n.findIndex(s=>s.id===t.id);i!==-1&&(n[i]=t,n.sort((s,o)=>s.title.localeCompare(o.title)),be.account.set("lists",{lists:n,updatedAt:Date.now()}))}}function Ec(t){const{lists:n}=be.account.get("lists")||{};if(n!=null&&n.length){const i=n.findIndex(s=>s.id===t);i!==-1&&(n.splice(i,1),be.account.set("lists",{lists:n,updatedAt:Date.now()}))}}function mi({list:t,onClose:n}){const{masto:i}=ae(),[s,o]=L("default"),a=!!t,h=q(),r=q(),c=q();se(()=>{a&&(h.current.value=t.title,r.current.value=t.repliesPolicy,c.current&&(c.current.checked=t.exclusive))},[a]);const l=Ze("@mastodon/list-exclusive")||Ze("@gotosocial/list-exclusive");return e("div",{class:"sheet",children:[!!n&&e("button",{type:"button",class:"sheet-close",onClick:n,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})})," ",e("header",{children:e("h2",{children:a?g._({id:"tuhghE"}):g._({id:"Sb2gYF"})})}),e("main",{children:e("form",{class:"list-form",onSubmit:p=>{p.preventDefault();const f=new FormData(p.target),m=f.get("title"),d=f.get("replies_policy"),y=f.get("exclusive")==="on";o("loading"),(async()=>{try{let b;a?b=await i.v1.lists.$select(t.id).update({title:m,replies_policy:d,exclusive:y}):b=await i.v1.lists.create({title:m,replies_policy:d,exclusive:y}),o("default"),n==null||n({state:"success",list:b}),setTimeout(()=>{a?xc(b):Ac(b)},1)}catch{o("error"),alert(a?g._({id:"R7ep1i"}):g._({id:"KPoj8w"}))}})()},children:[e("div",{class:"list-form-row",children:e("label",{for:"list-title",children:[e(u,{id:"6YtxFj"})," ",e("input",{ref:h,type:"text",id:"list-title",name:"title",required:!0,disabled:s==="loading",dir:"auto"})]})}),e("div",{class:"list-form-row",children:e("select",{ref:r,name:"replies_policy",required:!0,disabled:s==="loading",children:[e("option",{value:"list",children:e(u,{id:"ei6pnR"})}),e("option",{value:"followed",children:e(u,{id:"Mr53YX"})}),e("option",{value:"none",children:e(u,{id:"PM7llw"})})]})}),l&&e("div",{class:"list-form-row",children:e("label",{class:"label-block",children:[e("input",{ref:c,type:"checkbox",name:"exclusive",disabled:s==="loading"})," ",e(u,{id:"jxxYp0"})]})}),e("div",{class:"list-form-footer",children:[e("button",{type:"submit",disabled:s==="loading",children:a?g._({id:"tfDRzk"}):g._({id:"hYgDIe"})}),a&&e(lt,{disabled:s==="loading",align:"end",menuItemClassName:"danger",confirmLabel:g._({id:"+kQ/cY"}),onClick:()=>{o("loading"),(async()=>{try{await i.v1.lists.$select(t.id).remove(),o("default"),n==null||n({state:"deleted"}),setTimeout(()=>{Ec(t.id)},1)}catch{o("error"),alert(g._({id:"tqUaGL"}))}})()},children:e("button",{type:"button",class:"light danger",disabled:s==="loading",children:e(u,{id:"Jb6/SB"})})})]})]})})]})}const Rc=[60*5,60*30,60*60,60*60*6,60*60*24,60*60*24*3,60*60*24*7,60*60*24*30,0],Ut={0:{id:"9ZP9cc"},300:tt(5,"minute"),1800:tt(30,"minute"),3600:tt(1,"hour"),21600:tt(6,"hour"),86400:tt(1,"day"),259200:tt(3,"day"),604800:tt(1,"week"),2592e3:tt(30,"day")},Di=80,Ls=1e3*60*10;function Lc(t,n){return n.v1.accounts.familiarFollowers.fetch({id:[t]})}const $c=kt(Lc,{maxAge:Ls});async function Mc(t,n){const i=n.v1.accounts.$select(t).statuses.list({limit:20}).next(),{value:s}=await i,o={total:s.length,originals:0,replies:0,boosts:0};return s.forEach(a=>{a.reblog?o.boosts++:a.inReplyToId&&a.inReplyToAccountId!==a.account.id?o.replies++:o.originals++}),s.length&&(o.daysSinceLastPost=Math.ceil((Date.now()-new Date(s[s.length-1].createdAt))/864e5)),o}const Nc=kt(Mc,{maxAge:Ls});function $s({account:t,fetchAccount:n=()=>{},standalone:i,instance:s,authenticated:o}){const{i18n:a}=Qe(),{masto:h}=ae({instance:s}),{masto:r,instance:c}=ae(),[l,p]=L("default"),f=typeof t=="string",[m,d]=L(f?null:t),y=ke(()=>s===c,[s,c]);se(()=>{if(!f){d(t);return}p("loading"),(async()=>{try{const J=await n();x.accounts[`${J.id}@${s}`]=J,d(J),p("default")}catch{d(null),p("error")}})()},[f,t,n]);const{acct:b,avatar:v,avatarStatic:w,bot:_,createdAt:C,displayName:I,emojis:T,fields:k,followersCount:A,followingCount:M,group:P,id:N,lastStatusAt:V,locked:G,note:X,statusesCount:j,url:U,username:Y,memorial:ie,moved:$,roles:F,hideCollections:B}=m||{};let K=!1,{header:de,headerStatic:te}=m||{};(!de||/missing\.png$/.test(de))&&v&&!/missing\.png$/.test(v)&&(de=v,K=!0,w&&!/missing\.png$/.test(w)&&(te=w));const fe=ke(()=>N===wt(),[N]);se(()=>{const J=!!(m!=null&&m.id&&(m!=null&&m.username)&&(m!=null&&m.acct)&&(m!=null&&m.avatar)&&(m!=null&&m.avatarStatic)&&(m!=null&&m.displayName)&&(m!=null&&m.url));if(fe&&s&&J){const $e=be.local.getJSON("accounts");let Oe=!1;$e.forEach(R=>{R.info.id===m.id&&R.instanceURL===s&&(R.info=m,Oe=!0)}),Oe&&be.local.setJSON("accounts",$e)}},[fe,m,s]);const ye=ke(()=>U?Nt.toUnicode(URL.parse(U).hostname):null,[U]),[H,ce]=L([]),Se=q(),Ee=q([]);async function Re(J){var Q;(J||!Se.current)&&(Se.current=h.v1.accounts.$select(N).followers.list({limit:Di}));const $e=await Se.current.next();if(fe||!y)return $e;const{value:Oe}=$e;let R=[];if(J){let oe=[];try{oe=await h.v1.accounts.familiarFollowers.fetch({id:[N]})}catch{}Ee.current=((Q=oe==null?void 0:oe[0])==null?void 0:Q.accounts)||[],R=[...Ee.current,...Oe.filter(W=>!Ee.current.some(ne=>ne.id===W.id))]}else Oe!=null&&Oe.length&&(R=Oe.filter(oe=>!Ee.current.some(W=>W.id===oe.id)));return{...$e,value:R}}const Le=q();async function Pe(J){return(J||!Le.current)&&(Le.current=h.v1.accounts.$select(N).following.list({limit:Di})),await Le.current.next()}const ve=i?"div":he,ee=s?`/${s}/a/${N}`:`/a/${N}`,[ge,Ae]=L([]),[le,Z]=L(),[me,D]=L("default"),E=!!(le!=null&&le.total),O=async J=>{try{const $e=await $c(J,r);Ae($e[0].accounts.slice(0,Pc))}catch{}},re=async()=>{if(N){D("loading");try{const J=await Nc(N,h);Z(J),D("default")}catch{D("error")}}},we=ct(({relationship:J,currentID:$e})=>{J.following||(O($e),!i&&j>0&&re())},[i,N,j]),Ie=ct(J=>{J.id===N&&(d(J),x.accounts[`${J.id}@${s}`]=J)},[N,s]);return e("div",{tabIndex:"-1",class:`account-container ${l==="loading"?"skeleton":""}`,style:{"--header-color-1":H[0],"--header-color-2":H[1],"--header-color-3":H[2],"--header-color-4":H[3]},children:[l==="error"&&e("div",{class:"ui-state",children:[e("p",{children:e(u,{id:"44hICK"})}),e("p",{children:e("a",{href:f?t:U,target:"_blank",rel:"noopener noreferrer",children:[e(u,{id:"Aadw0+"})," ",e(S,{icon:"external"})]})})]}),l==="loading"?e(z,{children:[e("header",{children:e(rt,{avatarSize:"xxxl",skeleton:!0})}),e("main",{children:[e("div",{class:"note",children:[e("p",{children:"â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ"}),e("p",{children:"â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆ"})]}),e("div",{class:"account-metadata-box",children:[e("div",{class:"profile-metadata",children:[e("div",{class:"profile-field",children:[e("b",{class:"more-insignificant",children:"â–ˆâ–ˆâ–ˆ"}),e("p",{children:"â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ"})]}),e("div",{class:"profile-field",children:[e("b",{class:"more-insignificant",children:"â–ˆâ–ˆâ–ˆâ–ˆ"}),e("p",{children:"â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ"})]})]}),e("div",{class:"stats",children:[e("div",{children:[e("span",{children:"â–ˆâ–ˆ"})," ",e(u,{id:"x5LEuB"})]}),e("div",{children:[e("span",{children:"â–ˆâ–ˆ"})," ",e(u,{id:"following.stats"})]}),e("div",{children:[e("span",{children:"â–ˆâ–ˆ"})," ",e(u,{id:"+owNNn"})]})]})]}),e("div",{class:"actions",children:[e("span",{}),e("span",{class:"buttons",children:e("button",{type:"button",class:"plain",disabled:!0,children:e(S,{icon:"more",size:"l",alt:a._({id:"2FYpfJ"})})})})]})]})]}):m&&e(z,{children:[!!$&&e("div",{class:"account-moved",children:[e("p",{children:e(u,{id:"C6cVP/",values:{displayName:I},components:{0:e("b",{})}})}),e(rt,{account:$,instance:s,onClick:J=>{J.stopPropagation(),x.showAccount=$}})]}),!!de&&!/missing\.png$/.test(de)&&e("img",{src:de,alt:"",class:`header-banner ${K?"header-is-avatar":""}`,onError:J=>{J.target.crossOrigin?J.target.src!==te?J.target.src=te:(J.target.removeAttribute("crossorigin"),J.target.src=de):J.target.src!==te?J.target.src=te:J.target.remove()},crossOrigin:"anonymous",onLoad:J=>{J.target.classList.add("loaded");try{const $e=window.OffscreenCanvas?new OffscreenCanvas(1,1):document.createElement("canvas"),Oe=$e.getContext("2d",{willReadFrequently:!0});$e.width=J.target.width,$e.height=J.target.height,Oe.imageSmoothingEnabled=!1,Oe.drawImage(J.target,0,0);const R=10,oe=[Oe.getImageData(0,0,R,R).data,Oe.getImageData(J.target.width-R,0,R,R).data,Oe.getImageData(0,J.target.height-R,R,R).data,Oe.getImageData(J.target.width-R,J.target.height-R,R,R).data].map(W=>{let ne=0,Me=0,Te=0,xe=0;for(let He=0;He<W.length;He+=4)ne+=W[He],Me+=W[He+1],Te+=W[He+2],xe+=W[He+3];const ze=W.length/4;return[ne/ze,Me/ze,Te/ze,xe/ze]}).map(W=>{const[ne,Me,Te,xe]=Oc(W);return`rgba(${ne}, ${Me}, ${Te}, ${xe})`});ce(oe)}catch{}}}),e("header",{children:i?e(at,{shift:window.matchMedia("(min-width: calc(40em))").matches?114:64,menuButton:e("div",{children:e(rt,{account:m,instance:s,avatarSize:"xxxl",onClick:()=>{}})}),children:[e("div",{class:"szh-menu__header",children:e(qc,{acct:b,instance:s})}),e(_e,{onClick:()=>{const J=b.includes("@")?`@${b}`:`@${b}@${s}`;try{navigator.clipboard.writeText(J),ue(a._({id:"zJoEwS"}))}catch{ue(a._({id:"BC0lSD"}))}},children:[e(S,{icon:"link"}),e("span",{children:e(u,{id:"27x6gl"})})]}),e(_e,{href:U,target:"_blank",children:[e(S,{icon:"external"}),e("span",{children:e(u,{id:"Bz5hLl"})})]}),e(Ge,{}),e(Be,{href:m.avatar,target:"_blank",children:[e(S,{icon:"user"}),e("span",{children:e(u,{id:"7WYl2I"})})]}),e(Be,{href:m.header,target:"_blank",children:[e(S,{icon:"media"}),e("span",{children:e(u,{id:"ZNme5R"})})]})]}):e(rt,{account:m,instance:s,avatarSize:"xxxl",internal:!0})}),e("div",{class:"faux-header-bg","aria-hidden":"true"}),e("main",{children:[!!ie&&e("span",{class:"tag",children:e(u,{id:"prdIOK"})}),!!_&&e("span",{class:"tag",children:[e(S,{icon:"bot"})," ",e(u,{id:"9Vdq+j"})]}),!!P&&e("span",{class:"tag",children:[e(S,{icon:"group"})," ",e(u,{id:"L8fEEm"})]}),F==null?void 0:F.map(J=>e("span",{class:"tag",children:[J.name,!!ye&&e(z,{children:[" ",e("span",{class:"more-insignificant",children:ye})]})]})),e("div",{class:"note",dir:"auto",onClick:hs({instance:c}),dangerouslySetInnerHTML:{__html:jn(X,{emojis:T})}}),e("div",{class:"account-metadata-box",children:[(k==null?void 0:k.length)>0&&e("div",{class:"profile-metadata",children:k.map(({name:J,value:$e,verifiedAt:Oe},R)=>e("div",{class:`profile-field ${Oe?"profile-verified":""}`,dir:"auto",children:[e("b",{children:[e(fs,{text:J,emojis:T})," ",!!Oe&&e(S,{icon:"check-circle",size:"s",alt:a._({id:"QDEWii"})})]}),e("p",{dangerouslySetInnerHTML:{__html:jn($e,{emojis:T})}})]},J+R))}),e("div",{class:"stats",children:[e(ve,{tabIndex:0,to:ee,onClick:()=>{setTimeout(()=>{x.showGenericAccounts={id:"followers",heading:a._({id:"x5LEuB"}),fetchAccounts:Re,instance:s,excludeRelationshipAttrs:fe?["followedBy"]:[],blankCopy:B?a._({id:"BRV/wh"}):void 0}},0)},children:[!!ge.length&&e("span",{class:"shazam-container-horizontal",children:e("span",{class:"shazam-container-inner stats-avatars-bunch",children:ge.map(J=>e(dt,{url:J.avatarStatic,size:"s",alt:`${J.displayName} @${J.acct}`,squircle:J==null?void 0:J.bot}))})}),e("span",{title:A,children:Ke(A)})," ",e(u,{id:"x5LEuB"})]}),e(ve,{class:"insignificant",tabIndex:0,to:ee,onClick:()=>{setTimeout(()=>{x.showGenericAccounts={heading:a._({id:"following.stats"}),fetchAccounts:Pe,instance:s,excludeRelationshipAttrs:fe?["following"]:[],blankCopy:B?a._({id:"BRV/wh"}):void 0}},0)},children:[e("span",{title:M,children:Ke(M)})," ",e(u,{id:"following.stats"}),e("br",{})]}),e(ve,{class:"insignificant",to:ee,children:[e("span",{title:j,children:Ke(j)})," ",e(u,{id:"+owNNn"})]}),!!C&&e("div",{class:"insignificant",children:e(u,{id:"PCcEFZ",values:{0:ht(C,{hideTime:!0})},components:{0:e("time",{datetime:C})}})})]})]}),!!le&&e(ve,{to:ee,class:"account-metadata-box",children:e("div",{class:"shazam-container",children:e("div",{class:"shazam-container-inner",children:E?e("div",{class:"posting-stats",title:a._({id:"wiuWLe",values:{0:(le.originals/le.total).toLocaleString(a.locale||void 0,{style:"percent"}),1:(le.replies/le.total).toLocaleString(a.locale||void 0,{style:"percent"}),2:(le.boosts/le.total).toLocaleString(a.locale||void 0,{style:"percent"})}}),children:[e("div",{children:le.daysSinceLastPost<365?a._({id:"oZUtTk",values:{0:le.total,1:le.daysSinceLastPost,2:le.daysSinceLastPost,3:le.daysSinceLastPost,4:le.total,5:le.total,6:le.daysSinceLastPost}}):a._({id:"JvA7Mo",values:{0:le.total,1:le.total}})}),e("div",{class:"posting-stats-bar",style:{"--originals-percentage":`${le.originals/le.total*100}%`,"--replies-percentage":`${(le.originals+le.replies)/le.total*100}%`}}),e("div",{class:"posting-stats-legends",children:[e("span",{class:"ib",children:[e("span",{class:"posting-stats-legend-item posting-stats-legend-item-originals"})," ",e(u,{id:"HxF6Fk"})]})," ",e("span",{class:"ib",children:[e("span",{class:"posting-stats-legend-item posting-stats-legend-item-replies"})," ",e(u,{id:"N8UzTV"})]})," ",e("span",{class:"ib",children:[e("span",{class:"posting-stats-legend-item posting-stats-legend-item-boosts"})," ",e(u,{id:"puY2t0"})]})]})]}):e("div",{class:"posting-stats",children:e(u,{id:"vl3XTJ"})})})})}),!$&&e("div",{class:"account-metadata-box",children:e("div",{class:"shazam-container no-animation",hidden:!!le,children:e("div",{class:"shazam-container-inner",children:e("button",{type:"button",class:"posting-stats-button",disabled:me==="loading",onClick:()=>{re()},children:[e("div",{class:`posting-stats-bar posting-stats-icon ${me==="loading"?"loading":""}`,style:{"--originals-percentage":"33%","--replies-percentage":"66%"}}),e(u,{id:"PjP87f"})," "]})})})})]}),e("footer",{children:e(Dc,{info:m,instance:s,standalone:i,authenticated:o,onRelationshipChange:we,onProfileUpdate:Ie})})]})]})}const Pc=3;function Dc({info:t,instance:n,standalone:i,authenticated:s,onRelationshipChange:o=()=>{},onProfileUpdate:a=()=>{}}){var le;if(!t)return null;const{_:h}=Qe(),{masto:r,instance:c,authenticated:l}=ae(),p=n===c,[f,m]=L("default"),[d,y]=L(null),{id:b,acct:v,url:w,username:_,locked:C,lastStatusAt:I,note:T,fields:k,moved:A}=t,M=q(b),{following:P,showingReblogs:N,notifying:V,followedBy:G,blocking:X,blockedBy:j,muting:U,mutingNotifications:Y,requested:ie,domainBlocking:$,endorsed:F,note:B}=d||{},[K,de]=L(null),[te,fe]=L(!1),ye=v.includes("@")?v:`${v}@${n}`;se(()=>{if(t){const Z=wt();let me;(async()=>{if(p&&s)me=b;else if(!p&&l){const E=t.acct.includes("@");try{const O=await r.v2.search.fetch({q:E?t.acct:`${t.username}@${n}`,type:"accounts",limit:1,resolve:!0});O.accounts.length&&(me=O.accounts[0].id,de(O.accounts[0]))}catch{}}if(!me)return;if(Z===me){fe(!0);return}M.current=me,m("loading");const D=r.v1.accounts.relationships.fetch({id:[me]});try{const E=await D;if(m("default"),E.length){const O=E[0];y(O),o({relationship:O,currentID:me})}}catch{m("error")}})()}},[t,s]),se(()=>{t&&te&&uo(t)},[t,te]);const H=f==="loading",[ce,Se]=L(!1),[Ee,Re]=L(!1),[Le,Pe]=L(!1),[ve,ee]=L(!1),[ge,Ae]=L([]);return e(z,{children:[e("div",{class:"actions",children:[e("span",{children:[G?e("span",{class:"tag",children:e(u,{id:"p3UO/y"})}):I?e("small",{class:"insignificant",children:e(u,{id:"F3cM1G",values:{0:ht(I,{hideTime:!0})},components:{0:e("span",{class:"ib"})}})}):e("span",{}),U&&e("span",{class:"tag danger",children:e(u,{id:"+IJm1Z"})}),X&&e("span",{class:"tag danger",children:e(u,{id:"32TndD"})})]})," ",e("span",{class:"buttons",children:[!!B&&e("button",{type:"button",class:"private-note-tag",title:g._({id:"zxFxcH"}),onClick:()=>{Pe(!0)},dir:"auto",children:e("span",{children:B})}),e(at,{portal:{target:document.body},containerProps:{style:{zIndex:1001}},align:"center",position:"anchor",overflow:"auto",menuButton:e("button",{type:"button",class:"plain",disabled:H,children:e(S,{icon:"more",size:"l",alt:g._({id:"2FYpfJ"})})}),onMenuChange:Z=>{P&&Z.open&&(async()=>{try{const me=await r.v1.accounts.$select(M.current).lists.list();Ae(me)}catch{}})()},children:[l&&!te&&e(z,{children:[e(_e,{onClick:()=>{Ro({draftStatus:{status:`@${(K==null?void 0:K.acct)||v} `}})},children:[e(S,{icon:"at"}),e("span",{children:e(u,{id:"3LkfZu",values:{username:_},components:{0:e("span",{class:"bidi-isolate"})}})})]}),e(_e,{onClick:()=>{Se(!0)},children:[e(S,{icon:"translate"}),e("span",{children:e(u,{id:"R8mSiS"})})]}),Ze("@mastodon/profile-private-note")&&e(_e,{onClick:()=>{Pe(!0)},children:[e(S,{icon:"pencil"}),e("span",{children:B?g._({id:"U+Gokq"}):g._({id:"VcQzRi"})})]}),P&&!!d&&e(z,{children:[e(_e,{onClick:()=>{m("loading"),(async()=>{try{const Z=await r.v1.accounts.$select(M.current).follow({notify:!V});Z&&y(Z),m("default"),ue(Z.notifying?g._({id:"jL3N0G",values:{username:_}}):g._({id:"WBugD/",values:{username:_}}))}catch(Z){alert(Z),m("error")}})()},children:[e(S,{icon:"notification"}),e("span",{children:V?g._({id:"osJmEN"}):g._({id:"I92Z+b"})})]}),e(_e,{onClick:()=>{m("loading"),(async()=>{try{const Z=await r.v1.accounts.$select(M.current).follow({reblogs:!N});Z&&y(Z),m("default"),ue(Z.showingReblogs?g._({id:"0X2KC8",values:{username:_}}):g._({id:"cXWjH0",values:{username:_}}))}catch(Z){alert(Z),m("error")}})()},children:[e(S,{icon:"rocket"}),e("span",{children:N?g._({id:"GRUr8d"}):g._({id:"uREpT3"})})]})]}),P&&e(_e,{onClick:()=>{Re(!0)},children:[e(S,{icon:"list"}),ge.length?e(z,{children:[e("small",{class:"menu-grow",children:[e(u,{id:"sJ2yQc"}),e("br",{}),e("span",{class:"more-insignificant",children:ge.map(Z=>Z.title).join(", ")})]}),e("small",{class:"more-insignificant",children:ge.length})]}):e("span",{children:e(u,{id:"sJ2yQc"})})]}),e(Ge,{})]}),e(_e,{onClick:()=>{const Z=`@${(K==null?void 0:K.acct)||ye}`;try{navigator.clipboard.writeText(Z),ue(g._({id:"zJoEwS"}))}catch{ue(g._({id:"BC0lSD"}))}},children:[e(S,{icon:"copy"}),e("small",{children:[e(u,{id:"27x6gl"}),e("br",{}),e("span",{class:"more-insignificant bidi-isolate",children:["@",(K==null?void 0:K.acct)||ye]})]})]}),e(_e,{href:w,target:"_blank",children:[e(S,{icon:"external"}),e("small",{class:"menu-double-lines",children:zc(w)})]}),e("div",{class:"menu-horizontal",children:[e(_e,{onClick:()=>{try{navigator.clipboard.writeText(w),ue(g._({id:"edWbV6"}))}catch{ue(g._({id:"W1ewR0"}))}},children:[e(S,{icon:"link"}),e("span",{children:e(u,{id:"he3ygx"})})]}),(navigator==null?void 0:navigator.share)&&((le=navigator==null?void 0:navigator.canShare)==null?void 0:le.call(navigator,{url:w}))&&e(_e,{onClick:()=>{try{navigator.share({url:w})}catch{alert(g._({id:"TtG3Uh"}))}},children:[e(S,{icon:"share"}),e("span",{children:e(u,{id:"LFKLqp"})})]})]}),!!d&&e(z,{children:[e(Ge,{}),U?e(_e,{onClick:()=>{m("loading"),(async()=>{try{const Z=await r.v1.accounts.$select((K==null?void 0:K.id)||b).unmute();y(Z),m("default"),ue(g._({id:"B4Xkly",values:{username:_}})),x.reloadGenericAccounts.id="mute",x.reloadGenericAccounts.counter++}catch{m("error")}})()},children:[e(S,{icon:"unmute"}),e("span",{children:e(u,{id:"Q/HUhC",values:{username:_},components:{0:e("span",{class:"bidi-isolate"})}})})]}):e(Tn,{menuClassName:"menu-blur",openTrigger:"clickOnly",direction:"bottom",overflow:"auto",shift:16,label:e(z,{children:[e(S,{icon:"mute"}),e("span",{class:"menu-grow",children:e(u,{id:"xhPEH3",values:{username:_},components:{0:e("span",{class:"bidi-isolate"})}})}),e("span",{style:{textOverflow:"clip"},children:[e(S,{icon:"time"}),e(S,{icon:"chevron-right"})]})]}),children:e("div",{class:"menu-wrap",children:Rc.map(Z=>e(_e,{onClick:()=>{m("loading"),(async()=>{try{const me=await r.v1.accounts.$select((K==null?void 0:K.id)||b).mute({duration:Z});y(me),m("default"),ue(g._({id:"/plB9m",values:{0:typeof Ut[Z]=="function"?Ut[Z]():h(Ut[Z]),username:_}})),x.reloadGenericAccounts.id="mute",x.reloadGenericAccounts.counter++}catch{m("error"),ue(g._({id:"vWGBjT",values:{username:_}}))}})()},children:typeof Ut[Z]=="function"?Ut[Z]():h(Ut[Z])}))})}),G&&e(lt,{subMenu:!0,menuItemClassName:"danger",confirmLabel:e(z,{children:[e(S,{icon:"user-x"}),e("span",{children:e(u,{id:"unyq2W",values:{username:_},components:{0:e("span",{class:"bidi-isolate"})}})})]}),onClick:()=>{m("loading"),(async()=>{try{const Z=await r.v1.accounts.$select((K==null?void 0:K.id)||b).removeFromFollowers();y(Z),m("default"),ue(g._({id:"AgkcM/",values:{username:_}})),x.reloadGenericAccounts.id="followers",x.reloadGenericAccounts.counter++}catch{m("error")}})()},children:[e(S,{icon:"user-x"}),e("span",{children:e(u,{id:"VCZ0OT"})})]}),e(lt,{subMenu:!0,confirm:!X,confirmLabel:e(z,{children:[e(S,{icon:"block"}),e("span",{children:e(u,{id:"aforS9",values:{username:_},components:{0:e("span",{class:"bidi-isolate"})}})})]}),itemProps:{className:"danger"},menuItemClassName:"danger",onClick:()=>{m("loading"),(async()=>{try{if(X){const Z=await r.v1.accounts.$select((K==null?void 0:K.id)||b).unblock();y(Z),m("default"),ue(g._({id:"sI9N29",values:{username:_}}))}else{const Z=await r.v1.accounts.$select((K==null?void 0:K.id)||b).block();y(Z),m("default"),ue(g._({id:"uYcYzu",values:{username:_}}))}x.reloadGenericAccounts.id="block",x.reloadGenericAccounts.counter++}catch{m("error"),X?ue(g._({id:"0tG4wG",values:{username:_}})):ue(g._({id:"pA+qEx",values:{username:_}}))}})()},children:X?e(z,{children:[e(S,{icon:"unblock"}),e("span",{children:e(u,{id:"/3LJfX",values:{username:_},components:{0:e("span",{class:"bidi-isolate"})}})})]}):e(z,{children:[e(S,{icon:"block"}),e("span",{children:e(u,{id:"JRswkR",values:{username:_},components:{0:e("span",{class:"bidi-isolate"})}})})]})}),e(_e,{className:"danger",onClick:()=>{x.showReportModal={account:K||t}},children:[e(S,{icon:"flag"}),e("span",{children:e(u,{id:"qTJgpR",values:{username:_},components:{0:e("span",{class:"bidi-isolate"})}})})]})]}),l&&te&&i&&Ze("@mastodon/profile-edit")&&e(z,{children:[e(Ge,{}),e(_e,{onClick:()=>{ee(!0)},children:[e(S,{icon:"pencil"}),e("span",{children:e(u,{id:"9OpVZg"})})]})]}),!1]}),!d&&f==="loading"&&e(De,{abrupt:!0}),!!d&&!A&&e(lt,{confirm:P||ie,confirmLabel:e("span",{children:ie?g._({id:"e7qQIH"}):g._({id:"eYsAQr",values:{0:t.acct||t.username}})}),menuItemClassName:"danger",align:"end",disabled:H,onClick:()=>{m("loading"),(async()=>{try{let Z;P||ie?Z=await r.v1.accounts.$select(M.current).unfollow():Z=await r.v1.accounts.$select(M.current).follow(),Z&&y(Z),m("default")}catch(Z){alert(Z),m("error")}})()},children:e("button",{type:"button",class:`${P||ie?"light swap":""}`,"data-swap-state":P||ie?"danger":"",disabled:H,children:P?e(z,{children:[e("span",{children:e(u,{id:"y6sq5j"})}),e("span",{children:e(u,{id:"HKrBPX"})})]}):ie?e(z,{children:[e("span",{children:e(u,{id:"Yx0Ud8"})}),e("span",{children:e(u,{id:"yTVtKs"})})]}):C?e(z,{children:[e(S,{icon:"lock"})," ",e("span",{children:e(u,{id:"MKEPCY"})})]}):g._({id:"MKEPCY"})})})]})]}),!!ce&&e(Fe,{onClose:()=>{Se(!1)},children:e(Uc,{note:T,fields:k,onClose:()=>Se(!1)})}),!!Ee&&e(Fe,{onClose:()=>{Re(!1)},children:e(Bc,{accountID:M.current,onClose:()=>Re(!1)})}),!!Le&&e(Fe,{onClose:()=>{Pe(!1)},children:e(Fc,{account:t,note:B,onRelationshipChange:Z=>{y(Z)},onClose:()=>Pe(!1)})}),!!ve&&e(Fe,{onClose:()=>{ee(!1)},children:e(Hc,{onClose:({state:Z,account:me}={})=>{ee(!1),Z==="success"&&me&&a(me)}})})]})}function Oc([t,n,i]){const s=.2126*t+.7152*n+.0722*i;let o;return s>=220?o=1:s<=50?o=.1:o=s/255,o=Math.min(1,o),[t,n,i,o]}function zc(t){if(!t)return;const n=URL.parse(t),{host:i,pathname:s}=n,o=s.replace(/\/$/,"").replace(/^\//,"");return e(z,{children:[e("span",{class:"more-insignificant",children:[Nt.toUnicode(i),"/"]}),e("wbr",{}),e("span",{children:o})]})}function Uc({note:t,fields:n,onClose:i}){const s=(n==null?void 0:n.map(({name:a,value:h})=>`${a}
${Ti(h)}`).join(`

`))||"",o=Ti(t)+(s?`

${s}`:"");return e("div",{class:"sheet",children:[!!i&&e("button",{type:"button",class:"sheet-close",onClick:i,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(u,{id:"9groMz"})})}),e("main",{children:[e("p",{style:{whiteSpace:"pre-wrap"},children:o}),e(ps,{forceTranslate:!0,text:o})]})]})}function Bc({accountID:t,onClose:n}){const{masto:i}=ae(),[s,o]=L("default"),[a,h]=L([]),[r,c]=L([]),[l,p]=$t(d=>d+1,0);se(()=>{o("loading"),(async()=>{try{const d=await on();h(d);const y=await i.v1.accounts.$select(t).lists.list();c(y),o("default")}catch{o("error")}})()},[l]);const[f,m]=L(!1);return e("div",{class:"sheet",id:"list-add-remove-container",children:[!!n&&e("button",{type:"button",class:"sheet-close",onClick:n,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(u,{id:"sJ2yQc"})})}),e("main",{children:[a.length>0?e("ul",{class:"list-add-remove",children:a.map(d=>{const y=r.some(b=>b.id===d.id);return e("li",{children:e("button",{type:"button",class:`light ${y?"checked":""}`,disabled:s==="loading",onClick:()=>{o("loading"),(async()=>{try{y?await i.v1.lists.$select(d.id).accounts.remove({accountIds:[t]}):await i.v1.lists.$select(d.id).accounts.create({accountIds:[t]}),p()}catch{o("error"),alert(y?g._({id:"7KnEYa"}):g._({id:"Tba8uO"}))}})()},children:[e(S,{icon:"check-circle",alt:"â˜‘ï¸"}),e("span",{children:d.title})]})})})}):s==="loading"?e("p",{class:"ui-state",children:e(De,{abrupt:!0})}):s==="error"?e("p",{class:"ui-state",children:e(u,{id:"v/l5uA"})}):e("p",{class:"ui-state",children:e(u,{id:"/MJ7gZ"})}),e("button",{type:"button",class:"plain2",onClick:()=>m(!0),disabled:s!=="default",children:[e(S,{icon:"plus",size:"l"})," ",e("span",{children:e(u,{id:"Sb2gYF"})})]})]}),f&&e(Fe,{onClick:d=>{d.target===d.currentTarget&&m(!1)},children:e(mi,{list:f==null?void 0:f.list,onClose:d=>{d.state==="success"&&p(),m(!1)}})})]})}function Fc({account:t,note:n,onRelationshipChange:i=()=>{},onClose:s=()=>{}}){const{masto:o}=ae(),[a,h]=L("default"),r=q(null);return se(()=>{let c;return r.current&&!n&&(c=setTimeout(()=>{var l,p;(p=(l=r.current).focus)==null||p.call(l)},100)),()=>{clearTimeout(c)}},[]),e("div",{class:"sheet",id:"private-note-container",children:[!!s&&e("button",{type:"button",class:"sheet-close",onClick:s,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:e("b",{children:e(u,{id:"DYqYm5",values:{0:(t==null?void 0:t.username)||(t==null?void 0:t.acct)},components:{0:e("span",{class:"bidi-isolate"})}})})}),e("main",{children:e("form",{onSubmit:c=>{c.preventDefault();const p=new FormData(c.target).get("note");(p==null?void 0:p.trim())!==(n==null?void 0:n.trim())&&(h("loading"),(async()=>{try{const f=await o.v1.accounts.$select(t==null?void 0:t.id).note.create({comment:p});h("default"),i(f),s()}catch(f){h("error"),alert((f==null?void 0:f.message)||g._({id:"ot8LpF"}))}})())},children:[e("textarea",{ref:r,name:"note",disabled:a==="loading",dir:"auto",children:n}),e("footer",{children:[e("button",{type:"button",class:"light",disabled:a==="loading",onClick:()=>{s==null||s()},children:e(u,{id:"dEgA5A"})}),e("span",{children:[e(De,{abrupt:!0,hidden:a!=="loading"}),e("button",{disabled:a==="loading",type:"submit",children:e(u,{id:"SrwrEj"})})]})]})]})})]})}function Hc({onClose:t=()=>{}}){const{masto:n}=ae(),[i,s]=L("loading"),[o,a]=L(null);se(()=>{(async()=>{try{const f=await n.v1.accounts.verifyCredentials();a(f),s("default")}catch{s("error")}})()},[]);const{displayName:h,source:r}=o||{},{note:c,fields:l}=r||{},p=q(null);return e("div",{class:"sheet",id:"edit-profile-container",children:[!!t&&e("button",{type:"button",class:"sheet-close",onClick:t,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:e("b",{children:e(u,{id:"9OpVZg"})})}),e("main",{children:i==="loading"?e("p",{class:"ui-state",children:e(De,{abrupt:!0})}):e("form",{onSubmit:f=>{f.preventDefault();const m=new FormData(f.target),d=m.get("display_name"),y=m.get("note"),b=p.current.querySelectorAll('input[name^="fields_attributes"]'),v=[];b.forEach(w=>{const _=w.name,[C,I,T]=_.match(/fields_attributes\[(\d+)\]\[(.+)\]/)||[],k=w.value?w.value.trim():"";I&&T&&k&&(v[I]||(v[I]={}),v[I][T]=k)}),v.forEach(w=>{w.name&&!w.value&&(w.value="")}),(async()=>{try{const w=await n.v1.accounts.updateCredentials({displayName:d,note:y,fieldsAttributes:v});t==null||t({state:"success",account:w})}catch(w){alert((w==null?void 0:w.message)||g._({id:"FwMMx0"}))}})()},children:[e("p",{children:e("label",{children:[e(u,{id:"6YtxFj"})," ",e("input",{type:"text",name:"display_name",defaultValue:h,maxLength:30,disabled:i==="loading",dir:"auto"})]})}),e("p",{children:e("label",{children:[e(u,{id:"E+oKCO"}),e("textarea",{defaultValue:c,name:"note",maxLength:500,rows:"5",disabled:i==="loading",dir:"auto"})]})}),e("p",{children:e(u,{id:"T4I119"})}),e("table",{ref:p,children:[e("thead",{children:e("tr",{children:[e("th",{children:e(u,{id:"87a/t/"})}),e("th",{children:e(u,{id:"4b3oEV"})})]})}),e("tbody",{children:Array.from({length:Math.max(4,l.length)}).map((f,m)=>{const{name:d="",value:y=""}=l[m]||{};return e(Yc,{name:d,value:y,index:m,disabled:i==="loading"},m)})})]}),e("footer",{children:[e("button",{type:"button",class:"light",disabled:i==="loading",onClick:()=>{t==null||t()},children:e(u,{id:"dEgA5A"})}),e("button",{type:"submit",disabled:i==="loading",children:e(u,{id:"tfDRzk"})})]})]})})]})}function Yc({name:t,value:n,disabled:i,index:s}){const[o,a]=L(!!n);return e("tr",{children:[e("td",{children:e("input",{type:"text",name:`fields_attributes[${s}][name]`,defaultValue:t,disabled:i,maxLength:255,required:o,dir:"auto"})}),e("td",{children:e("input",{type:"text",name:`fields_attributes[${s}][value]`,defaultValue:n,disabled:i,maxLength:255,onChange:h=>a(!!h.currentTarget.value),dir:"auto"})})]})}function qc({acct:t,instance:n}){let[i,s]=t.split("@");s||(s=n);const o=Nt.toASCII(t);return e("div",{class:"handle-info",children:[e("span",{class:"handle-handle",title:o,children:[e("b",{class:"handle-username",children:i}),e("span",{class:"handle-at",children:"@"}),e("b",{class:"handle-server",children:s})]}),e("div",{class:"handle-legend",children:[e("span",{class:"ib",children:[e("span",{class:"handle-legend-icon username"})," ",e(u,{id:"silO9A"})]})," ",e("span",{class:"ib",children:[e("span",{class:"handle-legend-icon server"})," ",e(u,{id:"rZgCpJ"})]})]})]})}function jc({account:t,instance:n,onClose:i}){const{masto:s,instance:o,authenticated:a}=ae({instance:n}),h=typeof t=="string";return se(()=>{h||(x.accounts[`${t.id}@${o}`]=t)},[t]),xs(i),e("div",{class:"sheet",children:[!!i&&e("button",{type:"button",class:"sheet-close outer",onClick:i,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e($s,{instance:o,authenticated:a,account:t,fetchAccount:async()=>{if(h)try{return await s.v1.accounts.lookup({acct:t,skip_webfinger:!1})}catch{const c=await s.v2.search.fetch({q:t,type:"accounts",limit:1,resolve:a});if(c.accounts.length)return c.accounts[0];if(/https?:\/\/[^/]+\/@/.test(t)){const l=URL.parse(t),{hostname:p,pathname:f}=l,m=f.replace(/^\//,"").replace(/\/$/,"")+"@"+p,d=await s.v2.search.fetch({q:m,type:"accounts",limit:1,resolve:a});if(d.accounts.length)return d.accounts[0]}}else return t}})]})}function Vc({onClose:t}){const{masto:n}=ae(),[i,s]=L("default"),[o,a]=L([]),[h,r]=$t(l=>l+1,0);se(()=>{s("loading"),(async()=>{try{const l=await ut.drafts.keys();if(l.length){const p=vn(),f=l.filter(m=>m.startsWith(p));if(f.length){const m=await ut.drafts.getMany(f);m.sort((d,y)=>new Date(y.updatedAt).getTime()-new Date(d.updatedAt).getTime()),a(m)}else a([])}else a([]);s("default")}catch{s("error")}})()},[h]);const c=(o==null?void 0:o.length)>0;return e("div",{class:"sheet",children:[!!t&&e("button",{type:"button",class:"sheet-close",onClick:t,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:[e("h2",{children:[e(u,{id:"krk5ws"})," ",e(De,{abrupt:!0,hidden:i!=="loading"})]}),c&&e("div",{class:"insignificant",children:e(u,{id:"Ap/10+"})})]}),e("main",{children:c?e(z,{children:[e("ul",{class:"drafts-list",children:o.map(l=>{const{updatedAt:p,key:f,draftStatus:m,replyTo:d}=l,y=new Date(p);return e("li",{children:[e("div",{class:"mini-draft-meta",children:[e("b",{children:[e(S,{icon:d?"reply":"quill",size:"s"})," ",e("time",{children:[!!d&&e(z,{children:[e("span",{class:"bidi-isolate",children:["@",d.account.acct]}),e("br",{})]}),ht(y)]})]}),e(lt,{confirmLabel:e("span",{children:e(u,{id:"/W5yFF"})}),menuItemClassName:"danger",align:"end",disabled:i==="loading",onClick:()=>{(async()=>{try{await ut.drafts.del(f),r()}catch{alert(g._({id:"rEYoku"}))}})()},children:e("button",{type:"button",class:"small light",disabled:i==="loading",children:e(u,{id:"Jb6/SB"})})})]}),e("button",{type:"button",disabled:i==="loading",class:"draft-item",onClick:async()=>{let b;if(d){s("loading");try{b=await n.v1.statuses.$select(d.id).fetch()}catch{alert(g._({id:"tMwimH"})),s("default");return}s("default")}window.__COMPOSE__={draftStatus:m,replyToStatus:b},x.showCompose=!0,x.showDrafts=!1},children:e(Gc,{draft:l})})]},p)})}),o.length>1&&e("p",{children:e(lt,{confirmLabel:e("span",{children:e(u,{id:"3IakFR"})}),menuItemClassName:"danger",disabled:i==="loading",onClick:()=>{(async()=>{s("loading");try{await ut.drafts.delMany(o.map(l=>l.key)),s("default"),r()}catch{alert(g._({id:"0J4sZq"})),s("error")}})()},children:e("button",{type:"button",class:"light danger",disabled:i==="loading",children:e(u,{id:"hOg+Mt"})})})})]}):e("p",{children:e(u,{id:"8iQ+jk"})})})]})}function Gc({draft:t}){var f;const{draftStatus:n,replyTo:i}=t,{status:s,spoilerText:o,poll:a,mediaAttachments:h}=n,r=((f=a==null?void 0:a.options)==null?void 0:f.length)>0,c=(h==null?void 0:h.length)>0,l=r||c,p=ke(()=>{if(!c)return;const m=h.find(b=>/image/.test(b.type));if(!m)return;const{file:d}=m;return URL.createObjectURL(d)},[c,h]);return e(z,{children:e("div",{class:"mini-draft",children:[l&&e("div",{class:`mini-draft-aside ${p?"has-image":""}`,style:p?{"--bg-image":`url(${p})`}:{},children:[r&&e(S,{icon:"poll",alt:g._({id:"4WUbF1"})}),c&&e("span",{children:[e(S,{icon:"attachment",alt:g._({id:"xYilR2"})})," ",e("small",{children:h==null?void 0:h.length})]})]}),e("div",{class:"mini-draft-main",children:[!!o&&e("div",{class:"mini-draft-spoiler",children:o}),!!s&&e("div",{class:"mini-draft-status",children:s})]})]})})}function Kc({html:t,url:n,width:i,height:s,onClose:o=()=>{}}){return e("div",{class:"embed-modal-container",children:[e("div",{class:"top-controls",children:[e("button",{type:"button",class:"light",onClick:()=>o(),children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),n&&e("a",{href:n,target:"_blank",rel:"noopener noreferrer",class:"button plain",children:[e("span",{children:e(u,{id:"4/RpOy"})})," ",e(S,{icon:"external"})]})]}),e("div",{class:"embed-content",dangerouslySetInnerHTML:{__html:t},style:{"--width":i+"px","--height":s+"px","--aspect-ratio":`${i}/${s}`}})]})}function Wc({instance:t,excludeRelationshipAttrs:n=[],postID:i,onClose:s=()=>{},blankCopy:o=g._({id:"10OlfF"})}){const{masto:a,instance:h}=ae(),r=t?t===h:!0,c=Ye(x),[l,p]=L("default"),[f,m]=L([]),[d,y]=L(!1);if(xs(s),!c.showGenericAccounts)return null;const{id:b,heading:v,fetchAccounts:w,accounts:_,showReactions:C}=c.showGenericAccounts,[I,T]=L({}),k=async N=>{if(!(N!=null&&N.length)||!r)return;const V=await si(N,I);V&&T({...I,...V})},A=N=>{w&&(N&&m([]),p("loading"),(async()=>{try{const{done:V,value:G}=await w(N);if(Array.isArray(G)){if(N){const X=[];for(let j=0;j<G.length;j++){const U=G[j],Y=X.find((ie,$)=>ie.id===U.id&&j!==$);Y?Y._types.push(...U._types):X.push({_types:[],...U})}m(X)}else m(X=>{const j=X;for(const U of G){const Y=j.find(ie=>ie.id===U.id);Y?Y._types.push(...U._types):j.push(U)}return j});y(!V),k(G)}else y(!1);p("default")}catch{p("error")}})())},M=q(!0);se(()=>{(_==null?void 0:_.length)>0?(m(_),k(_)):(A(!0),M.current=!1)},[_,w]),se(()=>{var N;M.current||((N=c.reloadGenericAccounts)==null?void 0:N.id)===b&&A(!0)},[c.reloadGenericAccounts.counter]);const P=x.statuses[i];return e("div",{id:"generic-accounts-container",class:"sheet",tabindex:"-1",children:[e("button",{type:"button",class:"sheet-close",onClick:s,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:v||g._({id:"bPwFdf"})})}),e("main",{children:[P&&e(he,{to:`/${t||h}/s/${P.id}`,class:"post-preview",children:e(qe,{status:P,size:"s",readOnly:!0})}),f.length>0?e(z,{children:[e("ul",{class:"accounts-list",children:f.map(N=>{var X,j;const V=I[N.id],G=`${N.id}-${((X=N._types)==null?void 0:X.length)||""}`;return e("li",{children:[C&&((j=N._types)==null?void 0:j.length)>0&&e("div",{class:"reactions-block",children:N._types.map(U=>e(S,{icon:{reblog:"rocket",favourite:"heart"}[U],class:`${U}-icon`}))}),e("div",{class:"account-relationships",children:e(rt,{account:N,showStats:!0,relationship:V,excludeRelationshipAttrs:n})})]},G)})}),l==="default"?d?e(_t,{onChange:N=>{N&&A()},children:e("button",{type:"button",class:"plain block",onClick:()=>A(),children:e(u,{id:"uXRAkV"})})}):e("p",{class:"ui-state insignificant",children:e(u,{id:"2EYeAZ"})}):l==="loading"&&e("p",{class:"ui-state",children:e(De,{abrupt:!0})})]}):l==="loading"?e("p",{class:"ui-state",children:e(De,{abrupt:!0})}):l==="error"?e("p",{class:"ui-state",children:e(u,{id:"AThL/k"})}):e("p",{class:"ui-state insignificant",children:o})]})]})}function Zc({alt:t,lang:n,onClose:i}){const s=Ye(x),[o,a]=L(!1),h=us(!0),r=s.settings.contentTranslationHideLanguages||[],c=!!n&&n!==h&&!ki([n],[h])&&!r.find(l=>n===l||ki([n],[l]));return e("div",{class:"sheet",tabindex:"-1",children:[!!i&&e("button",{type:"button",class:"sheet-close outer",onClick:i,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{class:"header-grid",children:[e("h2",{children:e(u,{id:"5gfDMm"})}),e("div",{class:"header-side",children:e(at,{align:"end",menuButton:e("button",{type:"button",class:"plain4",children:e(S,{icon:"more",alt:g._({id:"2FYpfJ"}),size:"xl"})}),children:[e(_e,{disabled:o,onClick:()=>{a(!0)},children:[e(S,{icon:"translate"}),e("span",{children:e(u,{id:"pi8x/S"})})]}),Lo&&e(_e,{onClick:()=>{$o(t,n)},children:[e(S,{icon:"speak"}),e("span",{children:e(u,{id:"yIBLq8"})})]})]})})]}),e("main",{lang:n,dir:"auto",children:[e("p",{style:{whiteSpace:"pre-wrap",textWrap:"pretty"},children:t}),(c||o)&&e(ps,{forceTranslate:o,sourceLanguage:n,text:t})]})]})}const{min:od,max:cd}=Math;const Ms={};for(let t of["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"])Ms[`[object ${t}]`]=t.toLowerCase();function Xc(t){return Ms[Object.prototype.toString.call(t)]||"object"}const Wt=(t,n=null)=>t.length>=3?Array.prototype.slice.call(t):Xc(t[0])=="object"&&n?n.split("").filter(i=>t[0][i]!==void 0).map(i=>t[0][i]):t[0].slice(0);const{PI:En,min:ad,max:rd}=Math;const ld=En*2,dd=En/3,Jc=En/180,Qc=180/En;function kn(t,n){let i=t.length;Array.isArray(t[0])||(t=[t]),Array.isArray(n[0])||(n=n.map(h=>[h]));let s=n[0].length,o=n[0].map((h,r)=>n.map(c=>c[r])),a=t.map(h=>o.map(r=>Array.isArray(h)?h.reduce((c,l,p)=>c+l*(r[p]||0),0):r.reduce((c,l)=>c+l*h,0)));return i===1&&(a=a[0]),s===1?a.map(h=>h[0]):a}const Ns={Kn:18,labWhitePoint:"d65",Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452,kE:216/24389,kKE:8,kK:24389/27,RefWhiteRGB:{X:.95047,Y:1,Z:1.08883},MtxRGB2XYZ:{m00:.4124564390896922,m01:.21267285140562253,m02:.0193338955823293,m10:.357576077643909,m11:.715152155287818,m12:.11919202588130297,m20:.18043748326639894,m21:.07217499330655958,m22:.9503040785363679},MtxXYZ2RGB:{m00:3.2404541621141045,m01:-.9692660305051868,m02:.055643430959114726,m10:-1.5371385127977166,m11:1.8760108454466942,m12:-.2040259135167538,m20:-.498531409556016,m21:.041556017530349834,m22:1.0572251882231791},As:.9414285350000001,Bs:1.040417467,Cs:1.089532651,MtxAdaptMa:{m00:.8951,m01:-.7502,m02:.0389,m10:.2664,m11:1.7135,m12:-.0685,m20:-.1614,m21:.0367,m22:1.0296},MtxAdaptMaI:{m00:.9869929054667123,m01:.43230526972339456,m02:-.008528664575177328,m10:-.14705425642099013,m11:.5183602715367776,m12:.04004282165408487,m20:.15996265166373125,m21:.0492912282128556,m22:.9684866957875502}};const On=t=>{const n=Math.sign(t);return t=Math.abs(t),(t<=.0031308?t*12.92:1.055*Math.pow(t,1/2.4)-.055)*n},ea=(t,n,i)=>{const{MtxAdaptMa:s,MtxAdaptMaI:o,MtxXYZ2RGB:a,RefWhiteRGB:h,Xn:r,Yn:c,Zn:l}=Ns,p=r*s.m00+c*s.m10+l*s.m20,f=r*s.m01+c*s.m11+l*s.m21,m=r*s.m02+c*s.m12+l*s.m22,d=h.X*s.m00+h.Y*s.m10+h.Z*s.m20,y=h.X*s.m01+h.Y*s.m11+h.Z*s.m21,b=h.X*s.m02+h.Y*s.m12+h.Z*s.m22,v=(t*s.m00+n*s.m10+i*s.m20)*(d/p),w=(t*s.m01+n*s.m11+i*s.m21)*(y/f),_=(t*s.m02+n*s.m12+i*s.m22)*(b/m),C=v*o.m00+w*o.m10+_*o.m20,I=v*o.m01+w*o.m11+_*o.m21,T=v*o.m02+w*o.m12+_*o.m22,k=On(C*a.m00+I*a.m10+T*a.m20),A=On(C*a.m01+I*a.m11+T*a.m21),M=On(C*a.m02+I*a.m12+T*a.m22);return[k*255,A*255,M*255]},gi=(...t)=>{t=Wt(t,"lab");const[n,i,s,...o]=t,[a,h,r]=ta([n,i,s]),[c,l,p]=ea(a,h,r);return[c,l,p,...o.length>0&&o[0]<1?[o[0]]:[]]};function ta(t){var n=[[1.2268798758459243,-.5578149944602171,.2813910456659647],[-.0405757452148008,1.112286803280317,-.0717110580655164],[-.0763729366746601,-.4214933324022432,1.5869240198367816]],i=[[1,.3963377773761749,.2158037573099136],[1,-.1055613458156586,-.0638541728258133],[1,-.0894841775298119,-1.2914855480194092]],s=kn(i,t);return kn(n,s.map(o=>o**3))}function zn(t){const n=Math.sign(t);return t=Math.abs(t),(t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4))*n}const na=(t,n,i)=>{t=zn(t/255),n=zn(n/255),i=zn(i/255);const{MtxRGB2XYZ:s,MtxAdaptMa:o,MtxAdaptMaI:a,Xn:h,Yn:r,Zn:c,As:l,Bs:p,Cs:f}=Ns;let m=t*s.m00+n*s.m10+i*s.m20,d=t*s.m01+n*s.m11+i*s.m21,y=t*s.m02+n*s.m12+i*s.m22;const b=h*o.m00+r*o.m10+c*o.m20,v=h*o.m01+r*o.m11+c*o.m21,w=h*o.m02+r*o.m12+c*o.m22;let _=m*o.m00+d*o.m10+y*o.m20,C=m*o.m01+d*o.m11+y*o.m21,I=m*o.m02+d*o.m12+y*o.m22;return _*=b/l,C*=v/p,I*=w/f,m=_*a.m00+C*a.m10+I*a.m20,d=_*a.m01+C*a.m11+I*a.m21,y=_*a.m02+C*a.m12+I*a.m22,[m,d,y]},bi=(...t)=>{const[n,i,s,...o]=Wt(t,"rgb"),a=na(n,i,s);return[...ia(a),...o.length>0&&o[0]<1?[o[0]]:[]]};function ia(t){const n=[[.819022437996703,.3619062600528904,-.1288737815209879],[.0329836539323885,.9292868615863434,.0361446663506424],[.0481771893596242,.2642395317527308,.6335478284694309]],i=[[.210454268309314,.7936177747023054,-.0040720430116193],[1.9779985324311684,-2.42859224204858,.450593709617411],[.0259040424655478,.7827717124575296,-.8086757549230774]],s=kn(n,t);return kn(i,s.map(o=>Math.cbrt(o)))}const{sin:sa,cos:oa}=Math,ca=(...t)=>{let[n,i,s]=Wt(t,"lch");return isNaN(s)&&(s=0),s=s*Jc,[n,oa(s)*i,sa(s)*i]},Un=(...t)=>{t=Wt(t,"lch");const[n,i,s,...o]=t,[a,h,r]=ca(n,i,s),[c,l,p]=gi(a,h,r);return[c,l,p,...o.length>0&&o[0]<1?[o[0]]:[]]},{sqrt:aa,atan2:ra,round:la}=Math,da=(...t)=>{const[n,i,s]=Wt(t,"lab"),o=aa(i*i+s*s);let a=(ra(s,i)*Qc+360)%360;return la(o*1e4)===0&&(a=Number.NaN),[n,o,a]},ua=(...t)=>{const[n,i,s,...o]=Wt(t,"rgb"),[a,h,r]=bi(n,i,s),[c,l,p]=da(a,h,r);return[c,l,p,...o.length>0&&o[0]<1?[o[0]]:[]]},ha={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Blaede Phanpy",PHANPY_DEFAULT_INSTANCE:"mastodon.blaede.family",PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:"https://mastodon.blaede.family/auth/sign_up",PHANPY_GIPHY_API_KEY:"48JGsrSS1XE5w4nWe9c9hqxPbsfRWR0e",PHANPY_LINGVA_INSTANCES:"lingva.phanpy.social lingva.lunar.icu lingva.garudalinux.org translate.plausibility.cloud",PHANPY_PRIVACY_POLICY_URL:"https://mastodon.blaede.family/privacy-policy",PHANPY_WEBSITE:"https://phanpy.blaede.family",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},{PHANPY_IMG_ALT_API_URL:ud}=ha;function Ps({mediaAttachments:t,statusID:n,instance:i,lang:s,index:o=0,onClose:a=()=>{}}){var C,I;const[h,r]=L("default"),c=q(null),[l,p]=L(o),f=q(null);gt(()=>{var T;(T=f.current)==null||T.scrollIntoView()},[]);const m=q(n);se(()=>{const T=o*c.current.clientWidth,k=m.current!==n;k&&(m.current=n),c.current.focus(),c.current.scrollTo({left:T*(Et()?-1:1),behavior:k?"auto":"smooth"})},[o,n]);const[d,y]=L(!0);se(()=>{let T=()=>{a()};return c.current&&c.current.addEventListener("swiped-down",T),()=>{c.current&&c.current.removeEventListener("swiped-down",T)}},[]),Ue("esc",a,{ignoreEventWhen:T=>!!document.querySelector("#modal-container > *")},[a]),se(()=>{let T=()=>{const{clientWidth:k,scrollLeft:A}=c.current,M=Math.round(Math.abs(A)/k);p(M)};return c.current&&c.current.addEventListener("scroll",T,{passive:!0}),()=>{c.current&&c.current.removeEventListener("scroll",T)}},[]),se(()=>{let T=setTimeout(()=>{var k,A;(A=(k=c.current)==null?void 0:k.focus)==null||A.call(k)},100);return()=>clearTimeout(T)},[]);const b=ke(()=>t==null?void 0:t.map(T=>{const{blurhash:k}=T;if(k){const A=oi(k);return ua(A)}return null}),[t]),v=ke(()=>b==null?void 0:b.map(T=>T?{light:Un([.95,.01,T[2]]),dark:Un([.35,.01,T[2]]),default:Un([.6,T[1],T[2]])}:null)),w=ke(()=>{const k=100/v.length,A=v.map((N,V)=>{var j,U,Y,ie;const G=V*k+5,X=(V+1)*k-5;return N!=null&&N.light&&(N!=null&&N.dark)?{light:`
                rgb(${(j=N.light)==null?void 0:j.join(",")}) ${G}%, 
                rgb(${(U=N.light)==null?void 0:U.join(",")}) ${X}%
              `,dark:`
                rgb(${(Y=N.dark)==null?void 0:Y.join(",")}) ${G}%, 
                rgb(${(ie=N.dark)==null?void 0:ie.join(",")}) ${X}%
              `}:{light:`
              transparent ${G}%, 
              transparent ${X}%
            `,dark:`
              transparent ${G}%, 
              transparent ${X}%
            `}}),M=A.map(N=>N.light).join(", "),P=A.map(N=>N.dark).join(", ");return{light:M,dark:P}},[v]);let _=q(null);return se(()=>()=>{var T,k;(k=(T=_.current)==null?void 0:T.hideToast)==null||k.call(T)},[]),gt(()=>{const T=v[l];let k,A;if(T){const M=be.local.get("theme");if(M){const P=`rgb(${T[M].join(",")})`;k=document.querySelector('meta[name="theme-color"][data-theme-setting="manual"]'),k&&(A=k.content,k.content=P)}else{const P=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",N=`rgb(${T[P].join(",")})`;k=document.querySelector(`meta[name="theme-color"][media*="${P}"]`),k&&(A=k.content,k.content=N)}}return()=>{k&&A&&(k.content=A)}},[l,v]),e("div",{class:`media-modal-container media-modal-count-${t==null?void 0:t.length}`,children:[e("div",{ref:c,tabIndex:"0","data-swipe-threshold":"44",class:"carousel",onClick:T=>{(T.target.classList.contains("carousel-item")||T.target.classList.contains("media")||T.target.classList.contains("media-zoom"))&&a()},style:t.length>1?{backgroundAttachment:"local","--accent-gradient-light":w==null?void 0:w.light,"--accent-gradient-dark":w==null?void 0:w.dark}:{},children:t==null?void 0:t.map((T,k)=>{var M,P;const A=t.length===1?v[k]:null;return e("div",{class:"carousel-item",style:A?{"--accent-color":`rgb(${A.default.join(",")})`,"--accent-light-color":`rgb(${(M=A.light)==null?void 0:M.join(",")})`,"--accent-dark-color":`rgb(${(P=A.dark)==null?void 0:P.join(",")})`,"--accent-alpha-color":`rgba(${A.default.join(",")}, 0.4)`}:{},tabindex:"0",ref:k===l?f:null,onClick:N=>{N.target.classList.contains("media")||y(!d)},children:[!!T.description&&e("button",{type:"button",class:"media-alt",hidden:!d,onClick:()=>{x.showMediaAlt={alt:T.description,lang:s}},children:[e("span",{class:"alt-badge",children:"ALT"}),e("span",{class:"media-alt-desc",lang:s,dir:"auto",children:T.description})]}),e(ms,{media:T,showOriginal:!0,lang:s})]},T.id)})}),e("div",{class:"carousel-top-controls",hidden:!d,children:[e("span",{children:e("button",{type:"button",class:"carousel-button",onClick:()=>a(),children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})})}),(t==null?void 0:t.length)>1?e("span",{class:"carousel-dots",children:t==null?void 0:t.map((T,k)=>e("button",{type:"button",disabled:k===l,class:`carousel-dot ${k===l?"active":""}`,onClick:A=>{A.preventDefault(),A.stopPropagation();const M=c.current.clientWidth*k*(Et()?-1:1);c.current.focus(),c.current.scrollTo({left:M,behavior:"smooth"})},children:e(S,{icon:"round",size:"s",alt:"â¸±"})},T.id))}):e("span",{}),e("span",{children:[e(at,{overflow:"auto",align:"end",position:"anchor",gap:4,menuClassName:"glass-menu",menuButton:e("button",{type:"button",class:"carousel-button",children:e(S,{icon:"more",alt:g._({id:"2FYpfJ"})})}),children:[e(Be,{href:((C=t[l])==null?void 0:C.remoteUrl)||((I=t[l])==null?void 0:I.url),class:"carousel-button",target:"_blank",title:g._({id:"5hXGws"}),children:[e(S,{icon:"popout"}),e("span",{children:e(u,{id:"aDr7Vc"})})]}),!1]})," ",e(he,{to:`${i?`/${i}`:""}/s/${n}${window.matchMedia("(min-width: calc(40em + 350px))").matches?`?media=${l+1}`:""}`,class:"button carousel-button media-post-link",children:[e("span",{class:"button-label",children:[e(u,{id:"ISg5SQ"})," "]}),"Â»"]})]})]}),(t==null?void 0:t.length)>1&&e("div",{class:"carousel-controls",hidden:!d,children:[e("button",{type:"button",class:"carousel-button",hidden:l===0,onClick:T=>{T.preventDefault(),T.stopPropagation(),c.current.focus(),c.current.scrollTo({left:c.current.clientWidth*(l-1)*(Et()?-1:1),behavior:"smooth"})},children:e(S,{icon:"arrow-left",alt:g._({id:"DHhJ7s"})})}),e("button",{type:"button",class:"carousel-button",hidden:l===t.length-1,onClick:T=>{T.preventDefault(),T.stopPropagation(),c.current.focus(),c.current.scrollTo({left:c.current.clientWidth*(l+1)*(Et()?-1:1),behavior:"smooth"})},children:e(S,{icon:"arrow-right",alt:g._({id:"hXzOVo"})})})]})]})}const fa=[,"spam","legal","violation","other"],Zt={spam:{label:{id:"t8dIOP"},description:{id:"csQin/"}},legal:{label:{id:"IjKdHM"},description:{id:"e6tGFu"}},violation:{label:{id:"KPFHM2"},description:{id:"fpotTF"},stampLabel:{id:"iuLUuH"}},other:{label:{id:"/IX/7x"},description:{id:"kxiG8g"},excludeStamp:!0}};function pa({account:t,post:n,onClose:i}){const{_:s}=Qe(),{masto:o}=ae(),[a,h]=L("default"),[r,c]=t.acct.split("@"),[l,p]=ke(()=>{const{rules:_,domain:C}=cs();return[_||[],C]}),[f,m]=L(null),[d,y]=L(!1),b=q(null),[v,w]=L(!1);return e("div",{class:"report-modal-container",children:[e("div",{class:"top-controls",children:[e("h1",{children:n?g._({id:"muLhL3"}):g._({id:"ACul2G",values:{username:r}})}),e("button",{type:"button",class:"plain4 small",disabled:a==="loading",onClick:()=>i(),children:e(S,{icon:"x",size:"xl",alt:g._({id:"yz7wBu"})})})]}),e("main",{children:[e("div",{class:"report-preview",children:n?e(qe,{status:n,size:"s",previewMode:!0}):e(rt,{account:t,avatarSize:"xxl",useAvatarStatic:!0,showStats:!0,showActivity:!0})}),!!f&&!Zt[f].excludeStamp&&e("span",{class:"rubber-stamp","aria-hidden":"true",children:[s(Zt[f].stampLabel||s(Zt[f].label)),e("small",{children:e(u,{id:"2WtL62"})})]},f),e("form",{onSubmit:_=>{_.preventDefault();const C=new FormData(_.target),I=Object.fromEntries(C.entries());let{category:T,comment:k,forward:A}=I;k||(k=void 0),A==="on"&&(A=!0);const M=T==="violation"?Object.entries(I).filter(([N])=>N.startsWith("rule_ids")).map(([N,V])=>V):void 0,P={category:T,comment:k,forward:A,ruleIds:M};h("loading"),(async()=>{try{await o.v1.reports.create({accountId:t.id,statusIds:n!=null&&n.id?[n.id]:void 0,category:T,comment:k,ruleIds:M,forward:A}),h("success"),ue(n?g._({id:"y3ou+8"}):g._({id:"R9kjEL"})),i()}catch(N){h("error"),ue((N==null?void 0:N.message)||(n?g._({id:"+3FjPq"}):g._({id:"oEQq5w"})))}})()},children:[e("p",{children:n?g._({id:"L9fUm+"}):g._({id:"rSLkfe"})}),e("section",{class:"report-categories",children:fa.map(_=>_==="violation"&&!(l!=null&&l.length)?null:e(z,{children:[e("label",{class:"report-category",children:[e("input",{type:"radio",name:"category",value:_,required:!0,disabled:a==="loading",onChange:C=>{m(C.target.value),y(C.target.value==="violation")}}),e("span",{children:[s(Zt[_].label)," Â ",e("small",{class:"ib insignificant",children:s(Zt[_].description)})]})]}),_==="violation"&&!!(l!=null&&l.length)&&e("div",{class:"shazam-container no-animation",hidden:!d,children:e("div",{class:"shazam-container-inner",children:e("div",{class:"report-rules",ref:b,children:l.map((C,I)=>e("label",{class:"report-rule",children:[e("input",{type:"checkbox",name:`rule_ids[${I}]`,value:C.id,required:d&&!v,disabled:a==="loading",onChange:T=>{const{checked:k}=T.target;k?w(!0):b.current.querySelectorAll("input:checked").length||w(!1)}}),e("span",{children:C.text})]},C.id))})})})]},_))}),e("section",{class:"report-comment",children:[e("p",{children:e("label",{for:"report-comment",children:e(u,{id:"ecVtjm"})})}),e("textarea",{maxlength:"1000",rows:"1",name:"comment",id:"report-comment",disabled:a==="loading",required:!n})]}),!!c&&c!==p&&e("section",{children:e("p",{children:e("label",{children:[e("input",{type:"checkbox",switch:!0,name:"forward",disabled:a==="loading"})," ",e("span",{children:e(u,{id:"cyjS8M",values:{domain:c},components:{0:e("i",{})}})})]})})}),e("footer",{children:[e("button",{type:"submit",disabled:a==="loading",children:e(u,{id:"4cijjm"})})," ",e("button",{type:"submit",class:"plain2",disabled:a==="loading",onClick:async()=>{try{await o.v1.accounts.$select(t.id).mute(),ue(g._({id:"/BGBeF",values:{username:r}}))}catch{ue(g._({id:"v02K7/",values:{username:r}}))}},children:e(u,{id:"caeqw/",components:{0:e("small",{class:"ib"})}})})," ",e("button",{type:"submit",class:"plain2",disabled:a==="loading",onClick:async()=>{try{await o.v1.accounts.$select(t.id).block(),ue(g._({id:"kjUejn",values:{username:r}}))}catch{ue(g._({id:"pMcdDp",values:{username:r}}))}},children:e(u,{id:"JybQca",components:{0:e("small",{class:"ib"})}})}),e(De,{hidden:a!=="loading"})]})]})]})]})}var yi={exports:{}},hd=yi.exports;(function(t){var n=function(){var i=String.fromCharCode,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",a={};function h(c,l){if(!a[c]){a[c]={};for(var p=0;p<c.length;p++)a[c][c.charAt(p)]=p}return a[c][l]}var r={compressToBase64:function(c){if(c==null)return"";var l=r._compress(c,6,function(p){return s.charAt(p)});switch(l.length%4){default:case 0:return l;case 1:return l+"===";case 2:return l+"==";case 3:return l+"="}},decompressFromBase64:function(c){return c==null?"":c==""?null:r._decompress(c.length,32,function(l){return h(s,c.charAt(l))})},compressToUTF16:function(c){return c==null?"":r._compress(c,15,function(l){return i(l+32)})+" "},decompressFromUTF16:function(c){return c==null?"":c==""?null:r._decompress(c.length,16384,function(l){return c.charCodeAt(l)-32})},compressToUint8Array:function(c){for(var l=r.compress(c),p=new Uint8Array(l.length*2),f=0,m=l.length;f<m;f++){var d=l.charCodeAt(f);p[f*2]=d>>>8,p[f*2+1]=d%256}return p},decompressFromUint8Array:function(c){if(c==null)return r.decompress(c);for(var l=new Array(c.length/2),p=0,f=l.length;p<f;p++)l[p]=c[p*2]*256+c[p*2+1];var m=[];return l.forEach(function(d){m.push(i(d))}),r.decompress(m.join(""))},compressToEncodedURIComponent:function(c){return c==null?"":r._compress(c,6,function(l){return o.charAt(l)})},decompressFromEncodedURIComponent:function(c){return c==null?"":c==""?null:(c=c.replace(/ /g,"+"),r._decompress(c.length,32,function(l){return h(o,c.charAt(l))}))},compress:function(c){return r._compress(c,16,function(l){return i(l)})},_compress:function(c,l,p){if(c==null)return"";var f,m,d={},y={},b="",v="",w="",_=2,C=3,I=2,T=[],k=0,A=0,M;for(M=0;M<c.length;M+=1)if(b=c.charAt(M),Object.prototype.hasOwnProperty.call(d,b)||(d[b]=C++,y[b]=!0),v=w+b,Object.prototype.hasOwnProperty.call(d,v))w=v;else{if(Object.prototype.hasOwnProperty.call(y,w)){if(w.charCodeAt(0)<256){for(f=0;f<I;f++)k=k<<1,A==l-1?(A=0,T.push(p(k)),k=0):A++;for(m=w.charCodeAt(0),f=0;f<8;f++)k=k<<1|m&1,A==l-1?(A=0,T.push(p(k)),k=0):A++,m=m>>1}else{for(m=1,f=0;f<I;f++)k=k<<1|m,A==l-1?(A=0,T.push(p(k)),k=0):A++,m=0;for(m=w.charCodeAt(0),f=0;f<16;f++)k=k<<1|m&1,A==l-1?(A=0,T.push(p(k)),k=0):A++,m=m>>1}_--,_==0&&(_=Math.pow(2,I),I++),delete y[w]}else for(m=d[w],f=0;f<I;f++)k=k<<1|m&1,A==l-1?(A=0,T.push(p(k)),k=0):A++,m=m>>1;_--,_==0&&(_=Math.pow(2,I),I++),d[v]=C++,w=String(b)}if(w!==""){if(Object.prototype.hasOwnProperty.call(y,w)){if(w.charCodeAt(0)<256){for(f=0;f<I;f++)k=k<<1,A==l-1?(A=0,T.push(p(k)),k=0):A++;for(m=w.charCodeAt(0),f=0;f<8;f++)k=k<<1|m&1,A==l-1?(A=0,T.push(p(k)),k=0):A++,m=m>>1}else{for(m=1,f=0;f<I;f++)k=k<<1|m,A==l-1?(A=0,T.push(p(k)),k=0):A++,m=0;for(m=w.charCodeAt(0),f=0;f<16;f++)k=k<<1|m&1,A==l-1?(A=0,T.push(p(k)),k=0):A++,m=m>>1}_--,_==0&&(_=Math.pow(2,I),I++),delete y[w]}else for(m=d[w],f=0;f<I;f++)k=k<<1|m&1,A==l-1?(A=0,T.push(p(k)),k=0):A++,m=m>>1;_--,_==0&&(_=Math.pow(2,I),I++)}for(m=2,f=0;f<I;f++)k=k<<1|m&1,A==l-1?(A=0,T.push(p(k)),k=0):A++,m=m>>1;for(;;)if(k=k<<1,A==l-1){T.push(p(k));break}else A++;return T.join("")},decompress:function(c){return c==null?"":c==""?null:r._decompress(c.length,32768,function(l){return c.charCodeAt(l)})},_decompress:function(c,l,p){var f=[],m,d=4,y=4,b=3,v="",w=[],_,C,I,T,k,A,M,P={val:p(0),position:l,index:1};for(_=0;_<3;_+=1)f[_]=_;for(I=0,k=Math.pow(2,2),A=1;A!=k;)T=P.val&P.position,P.position>>=1,P.position==0&&(P.position=l,P.val=p(P.index++)),I|=(T>0?1:0)*A,A<<=1;switch(m=I){case 0:for(I=0,k=Math.pow(2,8),A=1;A!=k;)T=P.val&P.position,P.position>>=1,P.position==0&&(P.position=l,P.val=p(P.index++)),I|=(T>0?1:0)*A,A<<=1;M=i(I);break;case 1:for(I=0,k=Math.pow(2,16),A=1;A!=k;)T=P.val&P.position,P.position>>=1,P.position==0&&(P.position=l,P.val=p(P.index++)),I|=(T>0?1:0)*A,A<<=1;M=i(I);break;case 2:return""}for(f[3]=M,C=M,w.push(M);;){if(P.index>c)return"";for(I=0,k=Math.pow(2,b),A=1;A!=k;)T=P.val&P.position,P.position>>=1,P.position==0&&(P.position=l,P.val=p(P.index++)),I|=(T>0?1:0)*A,A<<=1;switch(M=I){case 0:for(I=0,k=Math.pow(2,8),A=1;A!=k;)T=P.val&P.position,P.position>>=1,P.position==0&&(P.position=l,P.val=p(P.index++)),I|=(T>0?1:0)*A,A<<=1;f[y++]=i(I),M=y-1,d--;break;case 1:for(I=0,k=Math.pow(2,16),A=1;A!=k;)T=P.val&P.position,P.position>>=1,P.position==0&&(P.position=l,P.val=p(P.index++)),I|=(T>0?1:0)*A,A<<=1;f[y++]=i(I),M=y-1,d--;break;case 2:return w.join("")}if(d==0&&(d=Math.pow(2,b),b++),f[M])v=f[M];else if(M===y)v=C+C.charAt(0);else return null;w.push(v),f[y++]=C+v.charAt(0),d--,C=v,d==0&&(d=Math.pow(2,b),b++)}}};return r}();t!=null?t.exports=n:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return n})})(yi);var Oi=yi.exports;const ma="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20fill='none'%20viewBox='0%200%2084%2062'%3e%3crect%20width='64'%20height='48'%20x='18'%20y='2'%20fill='%23fff'%20stroke='%23999'%20stroke-width='3'%20rx='4'/%3e%3crect%20width='32'%20height='48'%20x='2'%20y='12'%20fill='%23fff'%20stroke='%23999'%20stroke-width='3'%20rx='4'/%3e%3cpath%20fill='%234169E1'%20d='M14%2052a4%204%200%201%201-8%200%204%204%200%200%201%208%200Zm64-42a4%204%200%201%201-8%200%204%204%200%200%201%208%200Z'/%3e%3c/svg%3e",ga="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20fill='none'%20viewBox='0%200%2082%2062'%3e%3crect%20width='78'%20height='58'%20x='2'%20y='2'%20fill='%23999'%20fill-opacity='.3'%20stroke='%23999'%20stroke-width='3'%20rx='4'/%3e%3crect%20width='18'%20height='46'%20x='8'%20y='8'%20fill='%23fff'%20stroke='%23999'%20stroke-width='2'%20rx='1'/%3e%3crect%20width='18'%20height='46'%20x='32'%20y='8'%20fill='%23fff'%20stroke='%23999'%20stroke-width='2'%20rx='1'/%3e%3crect%20width='18'%20height='46'%20x='56'%20y='8'%20fill='%23fff'%20stroke='%23999'%20stroke-width='2'%20rx='1'/%3e%3c/svg%3e",ba="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20fill='none'%20viewBox='0%200%2084%2062'%3e%3crect%20width='64'%20height='48'%20x='18'%20y='2'%20fill='%23fff'%20stroke='%23999'%20stroke-width='3'%20rx='4'/%3e%3cpath%20fill='%23999'%20fill-opacity='.3'%20d='M19%203h62v10H19z'/%3e%3cpath%20stroke='%234169E1'%20stroke-width='2'%20d='M43%208a2%202%200%201%201-4%200%202%202%200%200%201%204%200Z'/%3e%3cpath%20stroke='%23999'%20stroke-width='2'%20d='M52%208a2%202%200%201%201-4%200%202%202%200%200%201%204%200Zm9%200a2%202%200%201%201-4%200%202%202%200%200%201%204%200Z'/%3e%3crect%20width='32'%20height='48'%20x='2'%20y='12'%20fill='%23fff'%20stroke='%23999'%20stroke-width='3'%20rx='4'/%3e%3cpath%20fill='%23999'%20fill-opacity='.3'%20d='M3%2049h30v10H3z'/%3e%3cpath%20stroke='%234169E1'%20stroke-width='2'%20d='M11%2054a2%202%200%201%201-4%200%202%202%200%200%201%204%200Z'/%3e%3cpath%20stroke='%23999'%20stroke-width='2'%20d='M20%2054a2%202%200%201%201-4%200%202%202%200%200%201%204%200Zm9%200a2%202%200%201%201-4%200%202%202%200%200%201%204%200Z'/%3e%3c/svg%3e",ya=200,va=10;async function Sn(){const{masto:t}=ae(),n=t.v1.followedTags.list({limit:ya}),i=[];let s=0;do{const{value:o,done:a}=await n.next();if(a||(o==null?void 0:o.length)===0)break;i.push(...o),s++}while(s<va);return i.sort((o,a)=>o.name.localeCompare(a.name)),i.length&&setTimeout(()=>{be.account.set("followedTags",{tags:i,updatedAt:Date.now()})},1),i}const wa=24*60*60*1e3;async function _a(){try{const{tags:t,updatedAt:n}=be.account.get("followedTags")||{};return t!=null&&t.length?(Date.now()-n>wa&&Sn(),t):await Sn()}catch{return[]}}const zi=document.createElement("div"),ka=t=>{if(!t)return[];if(t.indexOf("#")===-1)return[];zi.innerHTML=t;const n=zi.querySelectorAll("a.hashtag");return n.length?Array.from(n).map(i=>i.innerText.trim().replace(/^[^#]*#+/,"")):[]};function fn({children:t}){if(typeof t=="string")return t;const[n,i]=L("");return se(()=>{Promise.resolve(t).then(i)},[t]),n}const vt=9,Sa=["following","mentions","notifications","list","public","trending","search","hashtag","bookmarks","favourites"],Ds={following:{id:"7ZJHdw"},notifications:{id:"iDNBZe"},list:{id:"h16FyT"},public:{id:"tXgQpk"},search:{id:"A1taO8"},"account-statuses":{id:"AeXO77"},bookmarks:{id:"7Ff7ia"},favourites:{id:"zZOZj7"},hashtag:{id:"GP8RLS"},trending:{id:"4/iCqx"},mentions:{id:"/bZzdR"}},pn={list:[{text:{id:"DUMt1y"},name:"id",notRequired:!0}],public:[{text:{id:"OgyJSr"},name:"local",type:"checkbox"},{text:{id:"kyAi7k"},name:"instance",type:"text",placeholder:{id:"7defFj"},notRequired:!0}],trending:[{text:{id:"kyAi7k"},name:"instance",type:"text",placeholder:{id:"7defFj"},notRequired:!0}],search:[{text:{id:"dmloPh"},name:"query",type:"text",placeholder:{id:"UHDQDE"},notRequired:!0}],"account-statuses":[{text:"@",name:"id",type:"text",placeholder:"cheeaun@mastodon.social"}],hashtag:[{text:"#",name:"hashtag",type:"text",placeholder:{id:"a6oTWs"},pattern:"[^#]+"},{text:{id:"eK4SL/"},name:"media",type:"checkbox"},{text:{id:"kyAi7k"},name:"instance",type:"text",placeholder:{id:"7defFj"},notRequired:!0}]},Ca=kt(async({id:t})=>{const n=await ae().masto.v1.accounts.$select(t).fetch();return n.username||n.acct||n.displayName}),Cn={following:{id:"home",title:(t,n)=>n===0?g._({id:"i0qMbr"}):g._({id:"following.title"}),path:"/",icon:"home"},mentions:{id:"mentions",title:{id:"/bZzdR"},path:"/mentions",icon:"at"},notifications:{id:"notifications",title:{id:"iDNBZe"},path:"/notifications",icon:"notification"},list:{id:({id:t})=>t?"list":"lists",title:({id:t})=>t?Tc(t):g._({id:"h16FyT"}),path:({id:t})=>t?`/l/${t}`:"/l",icon:"list",excludeViewMode:({id:t})=>t?[]:["multi-column"]},public:{id:"public",title:({local:t})=>t?g._({id:"d5zxa4"}):g._({id:"4ERYY7"}),subtitle:({instance:t})=>t||ae().instance,path:({local:t,instance:n})=>`/${n}/p${t?"/l":""}`,icon:({local:t})=>t?"building":"earth"},trending:{id:"trending",title:{id:"4/iCqx"},subtitle:({instance:t})=>t||ae().instance,path:({instance:t})=>`/${t}/trending`,icon:"chart"},search:{id:"search",title:({query:t})=>t?`â€œ${t}â€`:g._({id:"A1taO8"}),path:({query:t})=>t?`/search?q=${encodeURIComponent(t)}&type=statuses`:"/search",icon:"search",excludeViewMode:({query:t})=>t?[]:["multi-column"]},"account-statuses":{id:"account-statuses",title:Ca,path:({id:t})=>`/a/${t}`,icon:"user"},bookmarks:{id:"bookmarks",title:{id:"7Ff7ia"},path:"/b",icon:"bookmark"},favourites:{id:"favourites",title:{id:"zZOZj7"},path:"/f",icon:"heart"},hashtag:{id:"hashtag",title:({hashtag:t})=>t,subtitle:({instance:t})=>t||ae().instance,path:({hashtag:t,instance:n,media:i})=>`${n?`/${n}`:""}/t/${t.split(/\s+/).join("+")}${i?"?media=1":""}`,icon:"hashtag"}};function Ia({onClose:t}){const{_:n}=Qe(),i=Ye(x),{shortcuts:s}=i,[o,a]=L(!1),[h,r]=L(!1),[c]=ui();return e("div",{id:"shortcuts-settings-container",class:"sheet",tabindex:"-1",children:[!!t&&e("button",{type:"button",class:"sheet-close",onClick:t,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:[e(S,{icon:"shortcut"})," ",e(u,{id:"CTqTgr"})," ",e("sup",{style:{fontSize:12,opacity:.5,textTransform:"uppercase"},children:e(u,{id:"A1As8l"})})]})}),e("main",{children:[e("p",{children:e(u,{id:"CIHAsy"})}),e("div",{class:"shortcuts-view-mode",children:[{value:"float-button",label:g._({id:"qwdOim"}),imgURL:ma},{value:"tab-menu-bar",label:g._({id:"UxBoCm"}),imgURL:ba},{value:"multi-column",label:g._({id:"uvDfdW"}),imgURL:ga}].map(({value:l,label:p,imgURL:f})=>{const m=i.settings.shortcutsViewMode===l||l==="float-button"&&!i.settings.shortcutsViewMode;return e("label",{class:m?"checked":"",children:[e("input",{type:"radio",name:"shortcuts-view-mode",value:l,checked:m,onChange:d=>{x.settings.shortcutsViewMode=d.target.value}})," ",e("img",{src:f,alt:"",width:"80",height:"58"})," ",e("span",{children:p})]},l)})}),s.length>0?e(z,{children:[e("ol",{class:"shortcuts-list",ref:c,children:s.filter(Boolean).map((l,p)=>{const f=Object.values(l).join("-"),{type:m}=l;if(!Cn[m])return null;let{icon:d,title:y,subtitle:b,excludeViewMode:v}=Cn[m];typeof y=="function"?y=y(l,p):y=n(y),typeof b=="function"?b=b(l,p):b=n(b),typeof d=="function"&&(d=d(l,p)),typeof v=="function"&&(v=v(l,p));const w=v==null?void 0:v.includes(i.settings.shortcutsViewMode);return e("li",{children:[e(S,{icon:d}),e("span",{class:"shortcut-text",children:[e(fn,{children:y}),b&&e(z,{children:[" ",e("small",{class:"ib insignificant",children:b})]}),w&&e("span",{class:"tag",children:e(u,{id:"5KJFnN"})})]}),e("span",{class:"shortcut-actions",children:[e("button",{type:"button",class:"plain small",disabled:p===0,onClick:()=>{const _=Array.from(x.shortcuts);if(p>0){const C=x.shortcuts[p-1];_[p-1]=l,_[p]=C,x.shortcuts=_}},children:e(S,{icon:"arrow-up",alt:g._({id:"QyioBP"})})}),e("button",{type:"button",class:"plain small",disabled:p===s.length-1,onClick:()=>{const _=Array.from(x.shortcuts);if(p<x.shortcuts.length-1){const C=x.shortcuts[p+1];_[p+1]=l,_[p]=C,x.shortcuts=_}},children:e(S,{icon:"arrow-down",alt:g._({id:"3Ib6FN"})})}),e("button",{type:"button",class:"plain small",onClick:()=>{a({shortcut:l,shortcutIndex:p})},children:e(S,{icon:"pencil",alt:g._({id:"ePK91l"})})})]})]},f)})}),s.length===1&&i.settings.shortcutsViewMode!=="float-button"&&e("div",{class:"ui-state insignificant",children:[e(S,{icon:"info"})," ",e("small",{children:e(u,{id:"3Xq4Zi"})})]})]}):e("div",{class:"ui-state insignificant",children:[e("p",{children:i.settings.shortcutsViewMode==="multi-column"?g._({id:"3xIN+E"}):g._({id:"vLxvHT"})}),e("p",{children:e(u,{id:"Fq4zw3",components:{0:e("br",{}),1:e("a",{href:"#",onClick:l=>{l.preventDefault(),x.shortcuts=[{type:"following"},{type:"notifications"}]}})}})})]}),e("p",{class:"insignificant",children:s.length>=vt&&(i.settings.shortcutsViewMode==="multi-column"?g._({id:"RqXfsz",values:{SHORTCUTS_LIMIT:vt}}):g._({id:"EVRO/o",values:{SHORTCUTS_LIMIT:vt}}))}),e("p",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e("button",{type:"button",class:"light",onClick:()=>r(!0),children:e(u,{id:"bgVLbt"})}),e("button",{type:"button",disabled:s.length>=vt,onClick:()=>a(!0),children:[e(S,{icon:"plus"})," ",e("span",{children:i.settings.shortcutsViewMode==="multi-column"?g._({id:"Vh3ADI"}):g._({id:"9tmn6W"})})]})]})]}),o&&e(Fe,{onClick:l=>{l.target===l.currentTarget&&a(!1)},children:e(Ta,{shortcut:o.shortcut,shortcutIndex:o.shortcutIndex,onSubmit:({result:l,mode:p})=>{p==="edit"?x.shortcuts[o.shortcutIndex]=l:x.shortcuts.push(l)},onClose:()=>a(!1)})}),h&&e(Fe,{onClick:l=>{l.target===l.currentTarget&&r(!1)},children:e(Aa,{shortcuts:s,onClose:()=>r(!1)})})]})}const Ui={list:{id:"1qL+L+"},search:{id:"dmTmkQ"},hashtag:{id:"E8laYz"}};function Ta({onSubmit:t,disabled:n,shortcut:i,shortcutIndex:s,onClose:o}){var v,w;const{_:a}=Qe(),h=!!i,[r,c]=L((i==null?void 0:i.type)||null),[l,p]=L("default"),[f,m]=L([]),[d,y]=L([]);se(()=>{(async()=>{if(r==="list")try{p("loading");const _=await on();m(_),p("default")}catch{p("error")}})(),(async()=>{if(r==="hashtag")try{const _=await Sn();y(_)}catch{}})()},[r]);const b=q();return se(()=>{if(h&&r&&pn[r]){const _=b.current;pn[r].forEach(({name:C,type:I})=>{const T=_.querySelector(`[name="${C}"]`);T&&i[C]&&(I==="checkbox"?T.checked=i[C]==="on":T.value=i[C])})}},[h,r]),e("div",{id:"shortcut-settings-form",class:"sheet",children:[!!o&&e("button",{type:"button",class:"sheet-close",onClick:o,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:h?g._({id:"pe1jog"}):g._({id:"Lsxpe5"})})}),e("main",{tabindex:"-1",children:e("form",{ref:b,onSubmit:_=>{_.preventDefault();const C=new FormData(_.target),I={};C.forEach((T,k)=>{I[k]=T==null?void 0:T.trim(),k==="instance"&&(I[k]=I[k].replace(/^https?:\/\//,"").replace(/\/+$/,""),I[k]=I[k].replace(/^@?[^@]+@/,""))}),I.type&&(t({result:I,mode:h?"edit":"add"}),_.target.reset(),c(null),o==null||o())},children:[e("p",{children:e("label",{children:[e("span",{children:e(u,{id:"cklVjM"})}),e("select",{required:!0,disabled:n,onChange:_=>{c(_.target.value)},defaultValue:h?i.type:void 0,name:"type",dir:"auto",children:[e("option",{}),Sa.map(_=>e("option",{value:_,children:a(Ds[_])}))]})]})}),(w=(v=pn[r])==null?void 0:v.map)==null?void 0:w.call(v,({text:_,name:C,type:I,placeholder:T,pattern:k,notRequired:A})=>r==="list"?e("p",{children:e("label",{children:[e("span",{children:e(u,{id:"2BBAbc"})}),e("select",{name:"id",required:!A,disabled:n||l==="loading",defaultValue:h?i.id:void 0,dir:"auto",children:[e("option",{value:""}),f.map(M=>e("option",{value:M.id,children:M.title}))]})]})}):e("p",{children:e("label",{children:[e("span",{children:a(_)})," ",e("input",{type:I,switch:I==="checkbox"||void 0,name:C,placeholder:a(T),required:I==="text"&&!A,disabled:n,list:r==="hashtag"?"followed-hashtags-datalist":null,autocorrect:"off",autocapitalize:"off",spellCheck:!1,pattern:k,dir:"auto"}),r==="hashtag"&&d.length>0&&e("datalist",{id:"followed-hashtags-datalist",children:d.map(M=>e("option",{value:M.name}))})]})})),!!Ui[r]&&e("p",{class:"form-note insignificant",children:[e(S,{icon:"info"}),a(Ui[r])]}),e("footer",{children:[e("button",{type:"submit",class:"block",disabled:n||l==="loading",children:h?g._({id:"tfDRzk"}):g._({id:"m16xKo"})}),h&&e("button",{type:"button",class:"light danger",onClick:()=>{x.shortcuts.splice(s,1),o==null||o()},children:e(u,{id:"t/YqKh"})})]})]})})]})}function Aa({shortcuts:t,onClose:n}){var m;const{_:i}=Qe(),{masto:s}=ae(),o=ke(()=>!t||!t.filter(Boolean).length?"":Oi.compressToEncodedURIComponent(JSON.stringify(t.filter(Boolean))),[t]),[a,h]=L(""),[r,c]=L("default"),l=ke(()=>{if(!a)return c("default"),null;try{const d=JSON.parse(Oi.decompressFromEncodedURIComponent(a));if(!Array.isArray(d))throw new Error("Not an array");return c("default"),d}catch{try{const y=JSON.parse(a);if(!Array.isArray(y))throw new Error("Not an array");return c("default"),y}catch{return c("error"),null}}},[a]),p=x.shortcuts.length>0,f=q();return e("div",{id:"import-export-container",class:"sheet",children:[!!n&&e("button",{type:"button",class:"sheet-close",onClick:n,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(u,{id:"OOa7/5",components:{0:e("small",{class:"ib insignificant"})}})})}),e("main",{tabindex:"-1",children:[e("section",{children:[e("h3",{children:[e(S,{icon:"arrow-down-circle",size:"l",class:"insignificant"})," ",e("span",{children:e(u,{id:"l3s5ri"})})]}),e("p",{class:"field-button",children:[e("input",{ref:f,type:"text",name:"import",placeholder:g._({id:"tBmklN"}),class:"block",onInput:d=>{h(d.target.value)},dir:"auto"}),x.settings.shortcutSettingsCloudImportExport&&e("button",{type:"button",class:"plain2 small",disabled:r==="cloud-downloading",onClick:async()=>{c("cloud-downloading");const d=wt();ue(g._({id:"HLqLGx"}));try{const b=(await s.v1.accounts.relationships.fetch({id:[d]}))[0];if(b){const{note:v=""}=b;if(/<phanpy-shortcuts-settings>(.*)<\/phanpy-shortcuts-settings>/.test(v)){const w=v.match(/<phanpy-shortcuts-settings>(.*)<\/phanpy-shortcuts-settings>/)[1],{v:_,dt:C,data:I}=JSON.parse(w);f.current.value=I,f.current.dispatchEvent(new Event("input"))}}c("default")}catch{c("error"),ue(g._({id:"gCDfX+"}))}},title:g._({id:"B6cG3J"}),children:[e(S,{icon:"cloud"}),e(S,{icon:"arrow-down"})]})]}),!!l&&Array.isArray(l)&&e(z,{children:[e("p",{children:[e("b",{children:l.length})," shortcut",l.length>1?"s":""," ",e("small",{class:"insignificant",children:["(",a.length," characters)"]})]}),e("ol",{class:"import-settings-list",children:l.map(d=>{var y,b;return e("li",{children:[e("span",{style:{opacity:t.some(v=>Object.keys(v).every(w=>v[w]===d[w]))?1:0},children:"*"}),e("span",{children:[i(Ds[d.type]),d.type==="list"&&" âš ï¸"," ",(b=(y=pn[d.type])==null?void 0:y.map)==null?void 0:b.call(y,({text:v,name:w,type:_})=>d[w]?e(z,{children:[e("span",{class:"tag collapsed insignificant",children:[v,":"," ",_==="checkbox"?d[w]==="on"?"âœ…":"âŒ":d[w]]})," "]}):null)]})]})})}),e("p",{children:[e("small",{children:e(u,{id:"o6sElH"})}),e("br",{}),e("small",{children:["âš ï¸"," ",e(u,{id:"N4z4P/"})]})]})]}),r==="error"&&e("p",{class:"error",children:e("small",{children:["âš ï¸ ",e(u,{id:"ZhsPEb"})]})}),e("p",{children:[p&&e(z,{children:[e(lt,{confirmLabel:g._({id:"6MzUUU"}),menuFooter:e("div",{class:"footer",children:e(u,{id:"nl8sCE"})}),onClick:()=>{const d=l.filter(v=>!x.shortcuts.some(w=>Object.keys(w).every(_=>w[_]===v[_])));if(!d.length){ue(g._({id:"o6L30P"}));return}let y=[...x.shortcuts,...d];const b=y.length>vt;b&&(y=y.slice(0,vt)),x.shortcuts=y,ue(b?g._({id:"SBmqmC",values:{SHORTCUTS_LIMIT:vt}}):g._({id:"QO9uTx"})),n==null||n()},children:e("button",{type:"button",class:"plain2",disabled:!l,children:e(u,{id:"c89gCv"})})})," "]}),e(lt,{confirmLabel:p?g._({id:"6ZjzWP"}):g._({id:"DWumLi"}),menuItemClassName:p?"danger":void 0,onClick:()=>{x.shortcuts=l,ue(g._({id:"QO9uTx"})),n==null||n()},children:e("button",{type:"button",class:"plain2",disabled:!l,children:p?g._({id:"uIp8WL"}):g._({id:"Sjnlwj"})})})]})]}),e("section",{children:[e("h3",{children:[e(S,{icon:"arrow-up-circle",size:"l",class:"insignificant"})," ",e("span",{children:e(u,{id:"GS+Mus"})})]}),e("p",{children:e("input",{style:{width:"100%"},type:"text",value:o,readOnly:!0,onClick:d=>{if(d.target.value){d.target.select();try{navigator.clipboard.writeText(d.target.value),ue(g._({id:"cWtH+v"}))}catch{ue(g._({id:"yUWyHa"}))}}},dir:"auto"})}),e("p",{children:[e("button",{type:"button",class:"plain2",disabled:!o,onClick:()=>{try{navigator.clipboard.writeText(o),ue(g._({id:"+Kq2vY"}))}catch{ue(g._({id:"tFvxZF"}))}},children:[e(S,{icon:"clipboard"})," ",e("span",{children:e(u,{id:"he3ygx"})})]})," ",(navigator==null?void 0:navigator.share)&&((m=navigator==null?void 0:navigator.canShare)==null?void 0:m.call(navigator,{text:o}))&&e("button",{type:"button",class:"plain2",disabled:!o,onClick:()=>{try{navigator.share({text:o})}catch{alert(g._({id:"TtG3Uh"}))}},children:[e(S,{icon:"share"})," ",e("span",{children:e(u,{id:"Z8lGw6"})})]})," ",x.settings.shortcutSettingsCloudImportExport&&e("button",{type:"button",class:"plain2",disabled:r==="cloud-uploading",onClick:async()=>{c("cloud-uploading");const d=wt();try{const b=(await s.v1.accounts.relationships.fetch({id:[d]}))[0];if(b){const{note:v=""}=b;let w="";const _=JSON.stringify({v:"1",dt:Date.now(),data:o});/<phanpy-shortcuts-settings>(.*)<\/phanpy-shortcuts-settings>/.test(v)?w=v.replace(/<phanpy-shortcuts-settings>(.*)<\/phanpy-shortcuts-settings>/,`<phanpy-shortcuts-settings>${_}</phanpy-shortcuts-settings>`):w=`${v}


<phanpy-shortcuts-settings>${_}</phanpy-shortcuts-settings>`,ue(g._({id:"9ZYiLz"})),await s.v1.accounts.$select(d).note.create({comment:w}),c("default"),ue(g._({id:"5w02SH"}))}}catch{c("error"),ue(g._({id:"aVsTYo"}))}},title:g._({id:"gWd6Cu"}),children:[e(S,{icon:"cloud"}),e(S,{icon:"arrow-up"})]})," ",o.length>0&&e("small",{class:"insignificant ib",children:e(u,{id:"IPXOXm",values:{0:o.length}})})]}),!!o&&e("details",{children:[e("summary",{class:"insignificant",children:e("small",{children:e(u,{id:"e5E+WH"})})}),e("textarea",{style:{width:"100%"},rows:10,readOnly:!0,children:JSON.stringify(t.filter(Boolean),null,2)})]})]}),x.settings.shortcutSettingsCloudImportExport&&e("footer",{children:e("p",{children:[e(S,{icon:"cloud"})," ",e(u,{id:"C4T6O/"})]})})]})]})}as(x,t=>{for(const[n,i,s,o]of t)/^show/i.test(i)&&!s&&Kn()});function xa(){var s,o,a,h,r,c,l,p;const t=Ye(x),n=rs(),i=Gt();return se(()=>{setTimeout(ho,1e3)},[]),e(z,{children:[!!t.showCompose&&e(Fe,{class:`solid ${t.composerState.minimized?"min":""}`,minimized:!!t.composerState.minimized,children:e(fo,{replyToStatus:typeof t.showCompose!="boolean"?t.showCompose.replyToStatus:((s=window.__COMPOSE__)==null?void 0:s.replyToStatus)||null,editStatus:((o=x.showCompose)==null?void 0:o.editStatus)||((a=window.__COMPOSE__)==null?void 0:a.editStatus)||null,draftStatus:((h=x.showCompose)==null?void 0:h.draftStatus)||((r=window.__COMPOSE__)==null?void 0:r.draftStatus)||null,onClose:f=>{const{newStatus:m,instance:d,type:y}=f||{};x.showCompose=!1,window.__COMPOSE__=null,m&&(x.reloadStatusPage++,ue({text:{post:g._({id:"aTyHBW"}),reply:g._({id:"lZdBKl"}),edit:g._({id:"a5BN7l"})}[y||"post"],delay:1e3,duration:1e4,onClick:b=>{b.hideToast(),x.prevLocation=i,n(d?`/${d}/s/${m.id}`:`/s/${m.id}`)}}))}})}),!!t.showSettings&&e(Fe,{onClose:()=>{x.showSettings=!1},children:e(kc,{onClose:()=>{x.showSettings=!1}})}),!!t.showAccounts&&e(Fe,{onClose:()=>{x.showAccounts=!1},children:e(uc,{onClose:()=>{x.showAccounts=!1}})}),!!t.showAccount&&e(Fe,{onClose:()=>{x.showAccount=!1},children:e(jc,{account:((c=t.showAccount)==null?void 0:c.account)||t.showAccount,instance:(l=t.showAccount)==null?void 0:l.instance,onClose:({destination:f}={})=>{x.showAccount=!1}})}),!!t.showDrafts&&e(Fe,{onClose:()=>{x.showDrafts=!1},children:e(Vc,{onClose:()=>x.showDrafts=!1})}),!!t.showMediaModal&&e(Fe,{onClick:f=>{(f.target===f.currentTarget||f.target.classList.contains("media"))&&(x.showMediaModal=!1)},children:e(Ps,{mediaAttachments:t.showMediaModal.mediaAttachments,instance:t.showMediaModal.instance,index:t.showMediaModal.index,statusID:t.showMediaModal.statusID,onClose:()=>{x.showMediaModal=!1}})}),!!t.showShortcutsSettings&&e(Fe,{onClose:()=>{x.showShortcutsSettings=!1},children:e(Ia,{onClose:()=>x.showShortcutsSettings=!1})}),!!t.showGenericAccounts&&e(Fe,{onClose:()=>{x.showGenericAccounts=!1},children:e(Wc,{instance:t.showGenericAccounts.instance,excludeRelationshipAttrs:t.showGenericAccounts.excludeRelationshipAttrs,postID:t.showGenericAccounts.postID,onClose:()=>x.showGenericAccounts=!1,blankCopy:t.showGenericAccounts.blankCopy})}),!!t.showMediaAlt&&e(Fe,{onClose:f=>{x.showMediaAlt=!1},children:e(Zc,{alt:t.showMediaAlt.alt||t.showMediaAlt,lang:(p=t.showMediaAlt)==null?void 0:p.lang,onClose:()=>{x.showMediaAlt=!1}})}),!!t.showEmbedModal&&e(Fe,{class:"solid",onClose:()=>{x.showEmbedModal=!1},children:e(Kc,{html:t.showEmbedModal.html,url:t.showEmbedModal.url,width:t.showEmbedModal.width,height:t.showEmbedModal.height,onClose:()=>{x.showEmbedModal=!1}})}),!!t.showReportModal&&e(Fe,{onClose:()=>{x.showReportModal=!1},children:e(pa,{account:t.showReportModal.account,post:t.showReportModal.post,onClose:()=>{x.showReportModal=!1}})})]})}function Zn({accountID:t,onChange:n}){const{masto:i}=ae(),[s,o]=L("default"),[a,h]=L(null),[r,c]=L(null),l=r!==null;return e("p",{class:"follow-request-buttons",children:[e("button",{type:"button",disabled:s==="loading"||l,onClick:()=>{o("loading"),h("accept"),(async()=>{try{const p=await i.v1.followRequests.$select(t).authorize();if(!(p!=null&&p.followedBy))throw new Error("Follow request not accepted");c(p),n()}catch{}o("default")})()},children:e(u,{id:"g3UF2V"})})," ",e("button",{type:"button",disabled:s==="loading"||l,class:"light danger",onClick:()=>{o("loading"),h("reject"),(async()=>{try{const p=await i.v1.followRequests.$select(t).reject();if(p!=null&&p.followedBy)throw new Error("Follow request not rejected");c(p),n()}catch{o("default")}})()},children:e(u,{id:"1t/NnN"})}),e("span",{class:"follow-request-states",children:l&&a?a==="accept"?e(S,{icon:"check-circle",alt:g._({id:"bzMKg7"}),class:"follow-accepted"}):e(S,{icon:"x-circle",alt:g._({id:"ekCRTP"}),class:"follow-rejected"}):e(De,{hidden:s!=="loading"})})]})}const Bi={mention:"comment",status:"notification",reblog:"rocket",follow:"follow",follow_request:"follow-add",favourite:"heart",poll:"poll",update:"pencil","admin.signup":"account-edit","admin.report":"account-warning",severed_relationships:"heart-break",moderation_warning:"alert",emoji_reaction:"emoji2","pleroma:emoji_reaction":"emoji2"};function Fi({account:t,emoji:n,emoji_url:i}){let s,o;typeof i=="string"?s=i:(s=i==null?void 0:i.url,o=i==null?void 0:i.staticUrl);const a=s?e(Mo,{url:s,staticUrl:o,alt:n}):n;return e(u,{id:"i5uN6K",values:{account:t,emojiObject:a}})}const Bn={status:({account:t})=>e(u,{id:"idiIxW",values:{account:t}}),reblog:({count:t,account:n,postsCount:i,postType:s,components:{Subject:o}})=>e(u,{id:"jkt9P5",values:{0:Ke(t),1:Ke(t),count:t,postsCount:i,postType:s,account:n},components:{0:e(o,{clickable:t>1}),1:e("span",{title:t}),2:e(o,{clickable:t>1}),3:e("span",{title:t})}}),follow:({account:t,count:n,components:{Subject:i}})=>e(u,{id:"+71G9C",values:{0:Ke(n),count:n,account:t},components:{0:e(i,{clickable:n>1}),1:e("span",{title:n})}}),follow_request:({account:t})=>e(u,{id:"eh6NHW",values:{account:t}}),favourite:({account:t,count:n,postsCount:i,postType:s,components:{Subject:o}})=>e(u,{id:"RqX1mR",values:{0:Ke(n),1:Ke(n),count:n,postsCount:i,postType:s,account:t},components:{0:e(o,{clickable:n>1}),1:e("span",{title:n}),2:e(o,{clickable:n>1}),3:e("span",{title:n})}}),poll:()=>g._({id:"kIlJaS"}),"poll-self":()=>g._({id:"kpjzdN"}),"poll-voted":()=>g._({id:"moT7M8"}),update:()=>g._({id:"uzt17m"}),"favourite+reblog":({count:t,account:n,postsCount:i,postType:s,components:{Subject:o}})=>e(u,{id:"NunZZQ",values:{0:Ke(t),1:Ke(t),count:t,postsCount:i,postType:s,account:n},components:{0:e(o,{clickable:t>1}),1:e("span",{title:t}),2:e(o,{clickable:t>1}),3:e("span",{title:t})}}),"admin.sign_up":({account:t})=>e(u,{id:"fJCCpx",values:{account:t}}),"admin.report":({account:t,targetAccount:n})=>e(u,{id:"eNfCmq",values:{account:t,targetAccount:n}}),severed_relationships:({name:t})=>e(u,{id:"Xl9v6+",values:{name:t},components:{0:e("i",{})}}),moderation_warning:()=>e("b",{children:e(u,{id:"YqffEv"})}),emoji_reaction:Fi,"pleroma:emoji_reaction":Fi},Ea={account_suspension:({from:t,targetName:n})=>e(u,{id:"uRkcgw",values:{from:t,targetName:n},components:{0:e("i",{}),1:e("i",{})}}),domain_block:({from:t,targetName:n,followersCount:i,followingCount:s})=>e(u,{id:"Q3yArs",values:{from:t,targetName:n,followersCount:i,followingCount:s},components:{0:e("i",{}),1:e("i",{})}}),user_domain_block:({targetName:t,followersCount:n,followingCount:i})=>e(u,{id:"RQKWUa",values:{targetName:t,followersCount:n,followingCount:i},components:{0:e("i",{})}})},Ra={none:{id:"ipnHrn"},disable:{id:"jw0eSZ"},mark_statuses_as_sensitive:{id:"v9jO+F"},delete_statuses:{id:"raUMBQ"},sensitive:{id:"w2OpMr"},silence:{id:"mlycBx"},suspend:{id:"Fz4lZ1"}},Fn=30;function La({notification:t,instance:n,isStatic:i,disableContextMenu:s}){var F,B,K,de,te,fe,ye;const{_:o}=Qe(),{masto:a}=ae(),{id:h,status:r,account:c,report:l,event:p,moderation_warning:f,_ids:m,_accounts:d,_statuses:y,_groupKeys:b,sampleAccounts:v,notificationsCount:w,groupKey:_}=t;let{type:C}=t;if(C==="mention"&&!r)return null;const I=(r==null?void 0:r.reblog)||r,T=I==null?void 0:I.id,k=wt(),A=k===(c==null?void 0:c.id),M=(F=r==null?void 0:r.poll)==null?void 0:F.voted,P=!!(r!=null&&r.inReplyToAccountId)&&(r==null?void 0:r.inReplyToAccountId)!==k&&((B=r==null?void 0:r.account)==null?void 0:B.id)===k;let N=0,V=0;if(C==="favourite+reblog"){if(d)for(const H of d)(K=H._types)!=null&&K.includes("favourite")&&N++,(de=H._types)!=null&&de.includes("reblog")&&V++;!V&&N&&(C="favourite"),!N&&V&&(C="reblog")}let G;C==="poll"?G=Bn[A?"poll-self":M?"poll-voted":"poll"]:Bn[C]?G=Bn[C]:G=g._({id:"ODqZt1",values:{type:C}});const X=({clickable:H,...ce})=>H?e("b",{tabIndex:"0",onClick:Y,...ce}):e("b",{...ce});if(typeof G=="function"){const H=(d==null?void 0:d.length)||(v==null?void 0:v.length)||(c?1:0),ce=(y==null?void 0:y.length)||(r?1:0);if(C==="admin.report"){const Se=l==null?void 0:l.targetAccount;Se&&(G=G({account:e(mt,{account:c,showAvatar:!0}),targetAccount:e(mt,{account:Se,showAvatar:!0})}))}else if(C==="severed_relationships"){const Se=p==null?void 0:p.targetName;Se&&(G=G({name:Se}))}else if((C==="emoji_reaction"||C==="pleroma:emoji_reaction")&&t.emoji){const Se=t.emoji_url||((fe=(te=r==null?void 0:r.emojis)==null?void 0:te.find)==null?void 0:fe.call(te,Ee=>(Ee==null?void 0:Ee.shortcode)===t.emoji.replace(/^:/,"").replace(/:$/,"")));G=G({account:e(mt,{account:c,showAvatar:!0}),emoji:t.emoji,emojiURL:Se})}else G=G({account:c?e(mt,{account:c,showAvatar:!0}):(v==null?void 0:v[0])&&e(mt,{account:v[0],showAvatar:!0}),count:H,postsCount:ce,postType:P?"reply":"post",components:{Subject:X}})}const j=t.createdAt&&new Date(t.createdAt).toLocaleString(),U={"favourite+reblog":g._({id:"+XOeb+"}),favourite:g._({id:"LQFF6J"}),reblog:g._({id:"phQpSa"}),follow:g._({id:"Ih01jh"})}[C]||g._({id:"bPwFdf"}),Y=()=>{x.showGenericAccounts={heading:U,accounts:d,showReactions:C==="favourite+reblog",excludeRelationshipAttrs:C==="follow"?["followedBy"]:[],postID:it(T,n)}},$=w>0&&w>(v==null?void 0:v.length)?"remote":"local";if(r!=null&&r.filtered){const H=((ye=r==null?void 0:r.account)==null?void 0:ye.id)===k,ce=Ht(r.filtered,"notifications");if(!A&&!H&&(ce==null?void 0:ce.action)==="hide")return null}return e("div",{class:`notification notification-${C}`,"data-notification-id":m||h,"data-group-key":(b==null?void 0:b.join(" "))||_,tabIndex:"0",children:[e("div",{class:`notification-type notification-${C}`,title:j,children:C==="favourite+reblog"?e(z,{children:[e(S,{icon:"rocket",size:"xl",alt:C,class:"reblog-icon"}),e(S,{icon:"heart",size:"xl",alt:C,class:"favourite-icon"})]}):e(S,{icon:Bi[C]||"notification",size:"xl",alt:C})}),e("div",{class:"notification-content",children:[C!=="mention"&&e(z,{children:[e("p",{children:G}),C==="follow_request"&&e(Zn,{accountID:c.id}),C==="severed_relationships"&&e("div",{children:[Ea[p.type]({from:n,...p}),e("br",{}),e("a",{href:`https://${n}/severed_relationships`,target:"_blank",rel:"noopener noreferrer",children:e(u,{id:"YL6Y8P",components:{0:e(S,{icon:"external",size:"s"})}})}),"."]}),C==="moderation_warning"&&!!f&&e("div",{children:[o(Ra[f.action]()),e("br",{}),e("a",{href:`/disputes/strikes/${f.id}`,target:"_blank",rel:"noopener noreferrer",children:e(u,{id:"YL6Y8P",components:{0:e(S,{icon:"external",size:"s"})}})})]})]}),(d==null?void 0:d.length)>1&&e("p",{class:"avatars-stack",children:[d.slice(0,Fn).map(H=>e(z,{children:[e("a",{href:H.url,rel:"noopener noreferrer",class:"account-avatar-stack",onClick:ce=>{ce.preventDefault(),x.showAccount=H},children:[e(dt,{url:H.avatarStatic,size:d.length<=10?"xxl":d.length<20?"xl":"l",alt:`${H.displayName} @${H.acct}`,squircle:H==null?void 0:H.bot},H.id),C==="favourite+reblog"&&e("div",{class:"account-sub-icons",children:H._types.map(ce=>e(S,{icon:Bi[ce],size:"s",class:`${ce}-icon`}))})]},H.id)," "]},H.id)),C==="favourite+reblog"&&$==="remote"?e("button",{type:"button",class:"small plain","data-group-keys":b==null?void 0:b.join(" "),onClick:()=>{x.showGenericAccounts={heading:U,fetchAccounts:async()=>{const H=await Promise.allSettled(b.map(async Se=>{const Ee=a.v2.notifications.$select(Se).accounts.list();return[Se,(await Ee.next()).value]})),ce=[];for(const Se of H){const[Ee,Re]=Se.value,Le=/^favourite/.test(Ee)?"favourite":/^reblog/.test(Ee)?"reblog":null;if(Le)for(const Pe of Re){const ve=ce.find(ee=>ee.id===Pe.id);ve?ve._types.push(Le):(Pe._types=[Le],ce.push(Pe))}}return{done:!0,value:ce}},showReactions:!0,postID:it(T,n)}},children:e(S,{icon:"chevron-down"})}):e("button",{type:"button",class:"small plain",onClick:Y,children:[d.length>Fn&&`+${d.length-Fn}`,e(S,{icon:"chevron-down"})]})]}),!(d!=null&&d.length)&&(v==null?void 0:v.length)>1&&e("p",{class:"avatars-stack",children:[v.map(H=>e(z,{children:[e("a",{href:H.url,rel:"noopener noreferrer",class:"account-avatar-stack",onClick:ce=>{ce.preventDefault(),x.showAccount=H},children:e(dt,{url:H.avatarStatic,size:"xxl",alt:`${H.displayName} @${H.acct}`,squircle:H==null?void 0:H.bot},H.id)},H.id)," "]},H.id)),w>v.length&&e(he,{to:n?`/${n}/s/${r.id}`:`/s/${r.id}`,class:"button small plain centered",children:["+",w-v.length,e(S,{icon:"chevron-right"})]})]}),(y==null?void 0:y.length)>1&&e("ul",{class:"notification-group-statuses",children:y.map(H=>e("li",{children:e(Hi,{class:`status-link status-type-${C}`,to:n?`/${n}/s/${H.id}`:`/s/${H.id}`,children:e(qe,{status:H,size:"s",previewMode:!0,allowContextMenu:!0})})},H.id))}),r&&(!(y!=null&&y.length)||(y==null?void 0:y.length)<=1)&&e(Hi,{class:`status-link status-type-${C}`,to:n?`/${n}/s/${T}`:`/s/${T}`,onContextMenu:s?void 0:H=>{const ce=H.target.querySelector(".status");if(ce){if(H.metaKey)return;H.preventDefault(),ce.dispatchEvent(new MouseEvent("contextmenu",{clientX:H.clientX,clientY:H.clientY}))}},children:i?e(qe,{status:I,size:"s",readOnly:!0,allowContextMenu:!0}):e(qe,{statusID:T,size:"s",readOnly:!0,allowContextMenu:!0})})]})]})}function Hi(t){const n=No();return e(he,{...t,"data-read-more":g._({id:"8fZueG"}),ref:n})}const Rn=st(La,(t,n)=>{var i,s;return((i=t.notification)==null?void 0:i.id)===((s=n.notification)==null?void 0:s.id)});"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",t=>{const{type:n,id:i,accessToken:s}=(t==null?void 0:t.data)||{};n==="notification"&&(x.routeNotification={id:i,accessToken:s})});const $a=st(function(){if(!("serviceWorker"in navigator))return null;const n=Ye(x),{routeNotification:i}=n,{id:s,accessToken:o}=i||{},[a,h]=L(!1);gt(()=>{if(!s||!o)return;const{instance:c}=ae(),{masto:l,instance:p}=ae({accessToken:o}),f=c===p,m=o?po(o):ei();(async()=>{const d=await l.v1.notifications.$select(s).fetch();if(d&&m){const y=m.instanceURL,{type:b,status:v,account:w}=d,_=!!document.querySelector("#modal-container > *"),C=b==="follow"&&!!(w!=null&&w.id),I=!!(w!=null&&w.id),T=!!(v!=null&&v.id);C&&f?x.showAccount={account:w,instance:y}:_||!f||I&&T?h({id:s,account:m,notification:d,sameInstance:f}):T?location.hash=`/${c}/s/${v.id}`:C?location.hash=`/${c}/a/${w.id}`:location.hash="/notifications"}})()},[s,o]),gt(()=>{navigator!=null&&navigator.clearAppBadge&&navigator.clearAppBadge()},[]),Yt(c=>{c&&(navigator!=null&&navigator.clearAppBadge)&&navigator.clearAppBadge()});const r=()=>{h(!1),x.routeNotification=null,/\/notifications\?id=/i.test(location.hash)&&(location.hash="/notifications")};if(a){const{id:c,account:l,notification:p,sameInstance:f}=a;return e(Fe,{onClick:m=>{m.target===m.currentTarget&&r()},children:e("div",{class:"sheet",tabIndex:"-1",children:[e("button",{type:"button",class:"sheet-close",onClick:r,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:e("b",{children:e(u,{id:"5+87Pq"})})}),e("main",{children:[!f&&e("p",{children:e(u,{id:"k9N0Xk"})}),e("div",{class:"notification-peek",onClick:m=>{const{target:d}=m;(m.target.tagName==="BUTTON"||m.target.tagName==="A")&&r()},children:e(Rn,{instance:l.instanceURL,notification:p,isStatic:!0})}),e("div",{style:{textAlign:"end"},children:e(he,{to:"/notifications",class:"button light",onClick:r,children:[e("span",{children:e(u,{id:"/WA/tl"})})," ",e(S,{icon:"arrow-right"})]})})]})]})})}return null}),Os=go((t,n)=>{const{instance:i}=ae(),[s,o]=ft(),[a,h]=L(!1),[r,c]=L(s.get("q")||""),l=s.get("type"),p=q(null),f=q(null);return mo(n,()=>({setValue:m=>{c(m)},focus:()=>{f.current.focus()},select:()=>{f.current.select()},blur:()=>{f.current.blur()}})),e("form",{ref:p,class:"search-popover-container",onSubmit:m=>{var y;if(m.preventDefault(),/\/search/.test(location.hash))if(r){const b={q:r};l&&(b.type=l),o(b)}else o({});else r?location.hash=`/search?q=${encodeURIComponent(r)}${l?`&type=${l}`:""}`:location.hash="/search";(y=t==null?void 0:t.onSubmit)==null||y.call(t,m)},children:[e("input",{ref:f,value:r,name:"q",type:"search",placeholder:g._({id:"A1taO8"}),dir:"auto",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellCheck:"false",onSearch:m=>{m.target.value||o({})},onInput:m=>{c(m.target.value),h(!0)},onFocus:()=>{var m,d;h(!0),(d=(m=p.current)==null?void 0:m.querySelector(".search-popover-item"))==null||d.classList.add("focus")},onBlur:()=>{var m,d;setTimeout(()=>{h(!1)},100),(d=(m=p.current)==null?void 0:m.querySelector(".search-popover-item.focus"))==null||d.classList.remove("focus")},onKeyDown:m=>{var y;const{key:d}=m;switch(d){case"Escape":h(!1);break;case"Down":case"ArrowDown":if(m.preventDefault(),a){const b=p.current.querySelector(".search-popover-item.focus");if(b){let v=b.nextElementSibling;for(;v&&v.hidden;)v=v.nextElementSibling;v&&(v.classList.add("focus"),Array.from(v.parentElement.children).filter(_=>_!==v).forEach(_=>{_.classList.remove("focus")}))}else{const v=p.current.querySelector(".search-popover-item");v&&v.classList.add("focus")}}break;case"Up":case"ArrowUp":if(m.preventDefault(),a){const b=document.querySelector(".search-popover-item.focus");if(b){let v=b.previousElementSibling;for(;v&&v.hidden;)v=v.previousElementSibling;v&&(v.classList.add("focus"),Array.from(v.parentElement.children).filter(_=>_!==v).forEach(_=>{_.classList.remove("focus")}))}else{const v=document.querySelector(".search-popover-item:last-child");v&&v.classList.add("focus")}}break;case"Enter":if(a){const b=document.querySelector(".search-popover-item.focus");b&&(m.preventDefault(),b.click()),h(!1),(y=t==null?void 0:t.onSubmit)==null||y.call(t,m)}break}}}),e("div",{class:"search-popover",hidden:!a||!r,children:!!r&&[{label:e(u,{id:"48oDit",values:{query:r},components:{0:e("small",{class:"insignificant"})}}),to:`/search?q=${encodeURIComponent(r)}`,top:!l&&!/\s/.test(r),hidden:!!l},{label:e(u,{id:"o1mMWT",values:{query:r},components:{0:e("q",{})}}),to:`/search?q=${encodeURIComponent(r)}&type=statuses`,hidden:/^https?:/.test(r),top:/\s/.test(r),icon:"document",queryType:"statuses"},{label:e(u,{id:"YAZw8D",values:{0:r.replace(/^#/,"")},components:{0:e("mark",{})}}),to:`/${i}/t/${r.replace(/^#/,"")}`,hidden:/^@/.test(r)||/^https?:/.test(r)||/\s/.test(r),top:/^#/.test(r),type:"link",icon:"hashtag",queryType:"hashtags"},{label:e(u,{id:"gEoOUj",values:{query:r},components:{0:e("mark",{})}}),to:`/${r}`,hidden:!/^https?:/.test(r),top:/^https?:/.test(r),type:"link"},{label:e(u,{id:"cDoNQr",values:{query:r},components:{0:e("q",{})}}),to:`/search?q=${encodeURIComponent(r)}&type=accounts`,icon:"group",queryType:"accounts"}].sort((m,d)=>{if(l){if(m.queryType===l)return-1;if(d.queryType===l)return 1}return m.top&&!d.top?-1:!m.top&&d.top?1:0}).filter(({hidden:m})=>!m).map(({label:m,to:d,icon:y,type:b},v)=>e(he,{to:d,class:`search-popover-item ${v===0?"focus":""}`,onClick:w=>{var _;(_=t==null?void 0:t.onSubmit)==null||_.call(t,w)},children:[e(S,{icon:y||(b==="link"?"arrow-right":"search"),class:"more-insignificant"}),e("span",{children:m})," "]}))})]})}),Ma=st(function({onClose:n=()=>{}}){const[i,s]=L(!1),o=q(null);Ue(["Slash","/"],h=>{s(!0),setTimeout(()=>{var r,c,l,p;(c=(r=o.current)==null?void 0:r.focus)==null||c.call(r),(p=(l=o.current)==null?void 0:l.select)==null||p.call(l)},0)},{preventDefault:!0,ignoreEventWhen:h=>{const r=/\/search/.test(location.hash),c=!!document.querySelector("#modal-container > *");return r||c}});const a=()=>{s(!1),n()};return Ue("esc",h=>{var r,c;(c=(r=o.current)==null?void 0:r.blur)==null||c.call(r),a()},{enabled:i,enableOnFormTags:!0,preventDefault:!0}),e("div",{id:"search-command-container",hidden:!i,onClick:h=>{h.target===h.currentTarget&&a()},children:e(Os,{ref:o,onSubmit:()=>{a()}})})});function Na(){const{_:t}=Qe(),{instance:n}=ae(),i=Ye(x),{shortcuts:s,settings:o}=i;if(!s.length)return null;const a=o.shortcutsViewMode==="multi-column"||!o.shortcutsViewMode&&o.shortcutsColumnsMode;if(a)return null;const h=q(),r=q(!1),c=s.map((m,d)=>{const{type:y,...b}=m;if(!Cn[y])return null;let{id:v,path:w,title:_,subtitle:C,icon:I}=Cn[y];return typeof v=="function"&&(v=v(b,d)),typeof w=="function"&&(w=w({...b,instance:b.instance||n},d)),typeof _=="function"?_=_(b,d):_=t(_),typeof C=="function"?C=C(b,d):C=t(C),typeof I=="function"&&(I=I(b,d)),v==="lists"&&(r.current=!0),{id:v,path:w,title:_,subtitle:C,icon:I}}).filter(Boolean),l=rs();Ue(["1","2","3","4","5","6","7","8","9"],(m,d)=>{var b,v;const y=parseInt(d.keys[0],10)-1;if(y<c.length){const{path:w}=c[y];w&&(l(w),(v=(b=h.current)==null?void 0:b.closeMenu)==null||v.call(b))}},{enabled:!a});const[p,f]=L([]);return e("div",{id:"shortcuts",children:i.settings.shortcutsViewMode==="tab-menu-bar"?e("nav",{class:"tab-bar",onContextMenu:m=>{m.preventDefault(),x.showShortcutsSettings=!0},children:e("ul",{children:c.map(({id:m,path:d,title:y,subtitle:b,icon:v},w)=>e("li",{children:e(he,{class:b?"has-subtitle":"",to:d,onClick:_=>{if(_.target.classList.contains("is-active")){_.preventDefault();const C=document.getElementById(`${m}-page`);if(C){C.scrollTop=0;const I=C.querySelector(".updates-button");I&&I.click()}}},children:[e(S,{icon:v,size:"xl",alt:y}),e("span",{children:[e(fn,{children:y}),b&&e(z,{children:[e("br",{}),e("small",{children:b})]})]})]})},`${w}-${m}-${y}-${b}-${d}`))})}):e(at,{instanceRef:h,overflow:"auto",viewScroll:"close",menuClassName:"glass-menu shortcuts-menu",gap:8,position:"anchor",onMenuChange:m=>{m.open&&r.current&&on().then(f)},menuButton:e("button",{type:"button",id:"shortcuts-button",class:"plain",onContextMenu:m=>{m.preventDefault(),x.showShortcutsSettings=!0},onTransitionStart:m=>{var d,y;try{const{target:b}=m;getComputedStyle(b).pointerEvents==="none"&&((y=(d=h.current)==null?void 0:d.closeMenu)==null||y.call(d))}catch{}},children:e(S,{icon:"shortcut",size:"xl",alt:g._({id:"CTqTgr"})})}),children:c.map(({id:m,path:d,title:y,subtitle:b,icon:v},w)=>m==="lists"?e(Tn,{menuClassName:"glass-menu",overflow:"auto",gap:-8,label:e(z,{children:[e(S,{icon:v,size:"l"}),e("span",{class:"menu-grow",children:e(fn,{children:y})}),e(S,{icon:"chevron-right"})]}),children:[e(Be,{to:"/l",children:e("span",{children:e(u,{id:"BHWx+g"})})}),e(Ge,{}),p==null?void 0:p.map(_=>e(Be,{to:`/l/${_.id}`,children:e("span",{children:_.title})},_.id))]}):e(Be,{to:d,class:"glass-menu-item",children:[e(S,{icon:v,size:"l"})," ",e("span",{class:"menu-grow",children:[e("span",{children:e(fn,{children:y})}),b&&e(z,{children:[" ",e("small",{class:"more-insignificant",children:b})]})]}),e("span",{class:"menu-shortcut hide-until-focus-visible",children:w+1})]},`${w}-${m}-${y}-${b}-${d}`))})})}const Pa=st(Na);function Da(t){var o;let n=[],i=[],s=0;for(let a=0;a<t.length;a++){const h=t[a];h.reblog&&!((o=h.account)!=null&&o.group)?(i.push(h),s++):(n.push(h),s<3&&(s=0))}if(t.length>10&&(i.length>t.length/4||s>=3)){const a=i.map(h=>h.id);if(i.length>t.length*3/4)n=[...n,{id:a,items:i,type:"boosts"}];else{const h=Math.floor(n.length/2);n=[...n.slice(0,h),{id:a,items:i,type:"boosts"},...n.slice(h)]}return n}else return t}function Yi(t,n){const i=be.account.get("boostedStatusIDs")||{},s=t.filter(a=>{if(!a.reblog)return!0;const h=`${n}-${a.reblog.id}`,r=i[h];return r&&r!==a.id?!1:(i[h]=a.id,!0)}),o=Object.keys(i);return o.length>50&&o.slice(0,o.length-50).forEach(a=>{delete i[a]}),be.account.set("boostedStatusIDs",i),s}function Oa(t,n){const i=[];let s=0;t.forEach(r=>{for(let l=0;l<i.length;l++){if(i[l].find(p=>p.id===r.id))return;if(i[l].find(p=>p.id===r.inReplyToId)||i[l].find(p=>p.inReplyToId===r.id)){i[l].push(r);return}}const c=t.find(l=>l.id===r.inReplyToId);c&&(i[s++]=[r,c])});for(let r=0;r<i.length;r++)for(let c=r+1;c<i.length;c++)i[r].find(p=>i[c].includes(p))&&(i[r]=[...i[r],...i[c]],i[r]=i[r].filter((p,f,m)=>m.findIndex(d=>d.id===p.id)===f),i.splice(c,1),c--);i.forEach(r=>{r.sort((c,l)=>!c.inReplyToId&&!l.inReplyToId?new Date(c.createdAt)-new Date(l.createdAt):c.inReplyToId===l.id?1:l.inReplyToId===c.id||!c.inReplyToId?-1:l.inReplyToId?new Date(c.createdAt)-new Date(l.createdAt):1)}),i.forEach(r=>{const c=r[0].account.id;r.forEach(l=>{l.account.id!==c&&(l._differentAuthor=!0)})}),i.length;const o=[],a=[],h=[];return t.forEach(r=>{if(r.reblog){o.push(r);return}for(let c=0;c<i.length;c++)if(i[c].find(l=>l.id===r.id)){if(a.includes(c))return;const l=i[c];l.sort((f,m)=>{const d=new Date(f.createdAt),y=new Date(m.createdAt);return d-y});const p=l[0].account.id;o.push({id:l.map(f=>f.id),items:l,type:l.every(f=>f.account.id===p)?"thread":"conversation"}),a.push(c);return}if(r.inReplyToId&&r.inReplyToAccountId!==r.account.id){const c=it(r.id,n);x.statusReply[c]||h.push({sKey:c,inReplyToId:r.inReplyToId})}o.push(r)}),h!=null&&h.length&&queueMicrotask(()=>{const{masto:r}=ae({instance:n});async function c(){for(let l=0;l<h.length;l++){const{sKey:p,inReplyToId:f}=h[l];try{const m=await za(f,r);We(m,n,{skipThreading:!0}),x.statusReply[p]={id:m.id,instance:n},await new Promise(d=>setTimeout(d,1e3))}catch{}}}if(Ze("@mastodon/fetch-multiple-statuses")){const l=h.map(({inReplyToId:p})=>p);(async()=>{var p;try{const f=await r.v1.statuses.list({id:l});if(f!=null&&f.length)for(const m of f){We(m,n,{skipThreading:!0});const d=(p=h.find(({inReplyToId:y})=>y===m.id))==null?void 0:p.sKey;d&&(x.statusReply[d]={id:m.id,instance:n})}else c()}catch{c()}})()}else c()}),o}const za=kt((t,n)=>n.v1.statuses.$select(t).fetch());async function zs(t,n){const i=await _a();if(!i.length)return;const{statusFollowedTags:s}=x,o=[];if(t.forEach(a=>{var m;if(a.reblog)return;const{id:h,content:r,tags:c=[]}=a,l=it(h,n);if((m=s[l])!=null&&m.length)return;const p=ka(r);if(!p.length&&!c.length)return;const f=i.reduce((d,y)=>((p.some(b=>b.toLowerCase()===y.name.toLowerCase())||c.some(b=>b.name.toLowerCase()===y.name.toLowerCase()))&&d.push(y.name),d),[]);f.length&&o.push({item:a,sKey:l,followedTags:f})}),o.length){const a=o.map(r=>r.item.account),h=await si(a);if(!h)return;o.forEach(r=>{const{item:c,sKey:l,followedTags:p}=r,f=h[c.account.id];f&&!f.following&&(s[l]=p)})}}function Ua(){x.statusFollowedTags={}}function Ba({scrollableRef:t,distanceFromStart:n=1,distanceFromEnd:i=1,scrollThresholdStart:s=10,scrollThresholdEnd:o=10,direction:a="vertical",distanceFromStartPx:h,distanceFromEndPx:r}={}){const[c,l]=L(null),[p,f]=L(!1),[m,d]=L(!1),[y,b]=L(!1),[v,w]=L(!1),_=a==="vertical";return gt(()=>{const C=t.current;if(!C)return{};let I=_?C.scrollTop:C.scrollLeft;function T(){const{scrollTop:k,scrollLeft:A,scrollHeight:M,scrollWidth:P,clientHeight:N,clientWidth:V}=C,G=_?k:A,X=_?M:P,j=_?N:V,U=Math.abs(G-I),Y=h||Math.min(j*n,X,G),ie=r||Math.min(j*i,X,X-G-j);U>=(I<G?o:s)&&(l(I<G?"end":"start"),I=G),f(G<=0),d(G+j>=X),b(G<=Y),w(G+j>=X-ie)}return C.addEventListener("scroll",T,{passive:!0}),()=>C.removeEventListener("scroll",T)},[n,i,s,o]),{scrollDirection:c,reachStart:p,reachEnd:m,nearReachStart:y,nearReachEnd:v,init:()=>{t.current&&t.current.dispatchEvent(new Event("scroll"))}}}function Fa({scrollableRef:t,distanceFromStart:n=1,distanceFromEnd:i=1,scrollThresholdStart:s=10,scrollThresholdEnd:o=10,direction:a="vertical",distanceFromStartPx:h,distanceFromEndPx:r,init:c}={},l,p){if(!l)return;const f=a==="vertical",m=q(null),d=q(null),y=Po(()=>{let b=!1,v=!1,w=!1,_=!1;const C=t.current,{scrollTop:I,scrollLeft:T,scrollHeight:k,scrollWidth:A,clientHeight:M,clientWidth:P}=C,N=f?I:T,V=f?k:A,G=f?M:P,X=Math.abs(N-m.current),j=h||Math.min(G*n,V,N),U=r||Math.min(G*i,V,V-N-G);X>=(m.current<N?o:s)&&(d.current=m.current<N?"end":"start",m.current=N),b=N<=0,v=N+G>=V,w=N<=j,_=N+G>=V-U,l({scrollDirection:d.current,reachStart:b,reachEnd:v,nearReachStart:w,nearReachEnd:_})},500);gt(()=>{const b=t.current;return b?(m.current=b[f?"scrollTop":"scrollLeft"],b.addEventListener("scroll",y,{passive:!0}),()=>b.removeEventListener("scroll",y)):{}},[n,i,s,o,...p]),se(()=>{c&&t.current&&queueMicrotask(()=>{t.current.dispatchEvent(new Event("scroll"))})},[c])}function Ha({class:t,statusID:n,status:i,instance:s,parent:o,onMediaClick:a}){let h=it(n,s);const r=Ye(x);if(i||(i=r.statuses[h]||r.statuses[n],h=it(i==null?void 0:i.id,s)),!i)return null;const{account:{acct:c,avatar:l,avatarStatic:p,id:f,url:m,displayName:d,username:y,emojis:b,bot:v,group:w},id:_,repliesCount:C,reblogged:I,reblogsCount:T,favourited:k,favouritesCount:A,bookmarked:M,poll:P,muted:N,sensitive:V,spoilerText:G,visibility:X,language:j,editedAt:U,filtered:Y,card:ie,createdAt:$,inReplyToId:F,inReplyToAccountId:B,content:K,mentions:de,mediaAttachments:te,reblog:fe,uri:ye,url:H,emojis:ce,_deleted:Se,_pinned:Ee}=i;if(!(te!=null&&te.length))return null;const Re=me=>{me.shiftKey},Le=ke(()=>wt(),[]),Pe=ke(()=>Le&&Le===f,[f,Le]),ve=bo(gs),ee=!Pe&&Ht(Y,ve);if((ee==null?void 0:ee.action)==="hide")return null;const ge=V,le=ke(()=>{var D;return((D=(be.account.get("preferences")||{})["reading:expand:media"])==null?void 0:D.toLowerCase())||"default"},[])==="show_all",Z=o||"div";return te.map((me,D)=>{const E=`${h}-${me.id}`,O=ee==null?void 0:ee.titlesStr;return e(Z,{"data-state-post-id":h,onMouseEnter:Re,"data-spoiler-text":G||(V?g._({id:"FKojeB"}):void 0),"data-filtered-text":ee?O?g._({id:"7FGvtQ",values:{filterTitleStr:O}}):g._({id:"03Qqf9"}):void 0,class:`
          media-post
          ${ee?"filtered":""}
          ${ge?"has-spoiler":""}
          ${le?"show-media":""}
        `,children:e(ms,{class:t,media:me,lang:j,to:`/${s}/s/${_}?media-only=${D+1}`,onClick:a?re=>a(re,D,me,i):void 0})},E)})}const qi=st(Ha);function Ya(t){var _,C,I,T,k;const n=Ye(x),{masto:i,instance:s,authenticated:o}=ae(),[a,h]=ke(()=>{const A=be.local.getJSON("accounts")||[];return[A.find(P=>P.info.id===wt())||A[0],A.length>1]},[]),r=(n.settings.shortcutsViewMode==="multi-column"||!n.settings.shortcutsViewMode&&n.settings.shortcutsColumnsMode)&&!n.shortcuts.find(A=>A.type==="following"),c=Do(()=>{x.showAccounts=!0},{threshold:600,detect:"touch",cancelOnMovement:!0}),l=q(),[p,f]=L(void 0),m=Oo([0,0,n.settings.shortcutsViewMode==="tab-menu-bar"?50:0,0]),d=q();async function y(A){return(A||!d.current)&&(d.current=i.v1.mutes.list({limit:80})),await d.current.next()}const b=q();async function v(A){return(A||!b.current)&&(b.current=i.v1.blocks.list({limit:80})),await b.current.next()}const w=q();return e(z,{children:[e("button",{ref:l,type:"button",class:`button plain nav-menu-button ${h?"with-avatar":""} ${p==="open"?"active":""}`,style:{position:"relative"},onClick:()=>{w.current=Date.now(),f(A=>A?void 0:"open")},onContextMenu:A=>{A.preventDefault(),x.showAccounts=!0},...c(),children:[h&&e(dt,{url:((_=a==null?void 0:a.info)==null?void 0:_.avatar)||((C=a==null?void 0:a.info)==null?void 0:C.avatarStatic),size:"l",squircle:(I=a==null?void 0:a.info)==null?void 0:I.bot}),e(S,{icon:"menu",size:h?"s":"l",alt:g._({id:"zucql+"})})]}),e(bs,{menuClassName:"nav-menu",state:p,anchorRef:l,onClose:()=>{f(void 0)},containerProps:{style:{zIndex:10},onClick:()=>{Date.now()-w.current<300}},portal:{target:document.body},...t,overflow:"auto",viewScroll:"close",position:"anchor",align:"center",boundingBoxPadding:m,unmountOnClose:!0,children:[!!((T=n.appVersion)!=null&&T.commitHash)&&n.appVersion.commitHash!=="edb2281"&&e("div",{class:"top-menu",children:[e(_e,{onClick:()=>{confirm(g._({id:"Djbaby"}))&&(async()=>{try{location.reload()}catch{}})()},children:[e(S,{icon:"sparkles",class:"sparkle-icon",size:"l"})," ",e("span",{children:e(u,{id:"95IFnD"})})]}),e(Ge,{})]}),e("section",{children:[e(Be,{to:"/",children:[e(S,{icon:"home",size:"l"})," ",e("span",{children:e(u,{id:"i0qMbr"})})]}),o?e(z,{children:[r&&e(Be,{to:"/following",children:[e(S,{icon:"following",size:"l"})," ",e("span",{children:e(u,{id:"following.title"})})]}),e(Be,{to:"/catchup",children:[e(S,{icon:"history2",size:"l"}),e("span",{children:e(u,{id:"xrl8fj"})})]}),Ze("@mastodon/mentions")&&e(Be,{to:"/mentions",children:[e(S,{icon:"at",size:"l"})," ",e("span",{children:e(u,{id:"/bZzdR"})})]}),e(Be,{to:"/notifications",children:[e(S,{icon:"notification",size:"l"})," ",e("span",{children:e(u,{id:"iDNBZe"})}),n.notificationsShowNew&&e("sup",{title:g._({id:"isRobC"}),style:{opacity:.5},children:[" ","â€¢"]})]}),e(Ge,{}),((k=a==null?void 0:a.info)==null?void 0:k.id)&&e(Be,{to:`/${s}/a/${a.info.id}`,children:[e(S,{icon:"user",size:"l"})," ",e("span",{children:e(u,{id:"vERlcd"})})]}),e(qa,{menuState:p}),e(Be,{to:"/b",children:[e(S,{icon:"bookmark",size:"l"})," ",e("span",{children:e(u,{id:"7Ff7ia"})})]}),e(Tn,{menuClassName:"nav-submenu",overflow:"auto",gap:-8,label:e(z,{children:[e(S,{icon:"more",size:"l"}),e("span",{class:"menu-grow",children:e(u,{id:"24misb"})}),e(S,{icon:"chevron-right"})]}),children:[e(Be,{to:"/f",children:[e(S,{icon:"heart",size:"l"})," ",e("span",{children:e(u,{id:"zZOZj7"})})]}),e(Be,{to:"/fh",children:[e(S,{icon:"hashtag",size:"l"})," ",e("span",{children:e(u,{id:"Xi1/bw"})})]}),e(Ge,{}),Ze("@mastodon/filters")&&e(Be,{to:"/ft",children:[e(S,{icon:"filters",size:"l"})," ",e("span",{children:e(u,{id:"cSev+j"})})]}),e(_e,{onClick:()=>{x.showGenericAccounts={id:"mute",heading:g._({id:"sOKhEA"}),fetchAccounts:y,excludeRelationshipAttrs:["muting"]}},children:[e(S,{icon:"mute",size:"l"})," ",e("span",{children:e(u,{id:"n1sANU"})})]}),e(_e,{onClick:()=>{x.showGenericAccounts={id:"block",heading:g._({id:"nL8nlr"}),fetchAccounts:v,excludeRelationshipAttrs:["blocking"]}},children:[e(S,{icon:"block",size:"l"})," ",e("span",{children:e(u,{id:"r3RRWo"})})]})," "]}),e(Ge,{}),e(_e,{onClick:()=>{x.showAccounts=!0},children:[e(S,{icon:"group",size:"l"})," ",e("span",{children:e(u,{id:"7e0O8Z"})})]})]}):e(z,{children:[e(Ge,{}),e(Be,{to:"/login",children:[e(S,{icon:"user",size:"l"})," ",e("span",{children:e(u,{id:"sQia9P"})})]})]})]}),e("section",{children:[e(Ge,{}),e(Be,{to:"/search",children:[e(S,{icon:"search",size:"l"})," ",e("span",{children:e(u,{id:"A1taO8"})})]}),e(Be,{to:`/${s}/trending`,children:[e(S,{icon:"chart",size:"l"})," ",e("span",{children:e(u,{id:"4/iCqx"})})]}),e(Be,{to:`/${s}/p/l`,children:[e(S,{icon:"building",size:"l"})," ",e("span",{children:e(u,{id:"d5zxa4"})})]}),e(Be,{to:`/${s}/p`,children:[e(S,{icon:"earth",size:"l"})," ",e("span",{children:e(u,{id:"4ERYY7"})})]}),o?e(z,{children:[e(Ge,{className:"divider-grow"}),e(_e,{onClick:()=>{x.showKeyboardShortcutsHelp=!0},children:[e(S,{icon:"keyboard",size:"l"})," ",e("span",{children:e(u,{id:"77Emn0"})})]}),e(_e,{onClick:()=>{x.showShortcutsSettings=!0},children:[e(S,{icon:"shortcut",size:"l"})," ",e("span",{children:e(u,{id:"8Kudkr"})})]}),e(_e,{onClick:()=>{x.showSettings=!0},children:[e(S,{icon:"gear",size:"l"})," ",e("span",{children:e(u,{id:"uVbUP8"})})]})]}):e(z,{children:[e(Ge,{}),e(_e,{onClick:()=>{x.showSettings=!0},children:[e(S,{icon:"gear",size:"l"})," ",e("span",{children:e(u,{id:"uVbUP8"})})]})]})]})]})]})}function qa({menuState:t}){const n=Ze("@mastodon/lists"),[i,s]=L([]);return se(()=>{n&&t==="open"&&on().then(s)},[t,n]),i.length>0?e(Tn,{menuClassName:"nav-submenu",overflow:"auto",gap:-8,label:e(z,{children:[e(S,{icon:"list",size:"l"}),e("span",{class:"menu-grow",children:e(u,{id:"h16FyT"})}),e(S,{icon:"chevron-right"})]}),children:[e(Be,{to:"/l",children:e("span",{children:e(u,{id:"BHWx+g"})})}),(i==null?void 0:i.length)>0&&e(z,{children:[e(Ge,{}),i.map(o=>e(Be,{to:`/l/${o.id}`,children:e("span",{children:o.title})},o.id))]})]}):n&&e(Be,{to:"/l",children:[e(S,{icon:"list",size:"l"}),e("span",{children:e(u,{id:"h16FyT"})})]})}const Dt=st(Ya),an={block:"nearest",inline:"center",behavior:"smooth"};function St({title:t,titleComponent:n,id:i,instance:s,emptyText:o,errorText:a,useItemID:h,boostsCarousel:r,fetchItems:c=()=>{},checkForUpdates:l=()=>{},checkForUpdatesInterval:p=15e3,headerStart:f,headerEnd:m,timelineStart:d,refresh:y,view:b,filterContext:v,showFollowedTags:w,showReplyParent:_,clearWhenRefresh:C}){const I=Ye(x),[T,k]=L([]),[A,M]=L("start"),[P,N]=L(!1),[V,G]=L(!1),[X,j]=L(!0),U=q();__BENCHMARK.start(`timeline-${i}-load`);const Y=ke(()=>ti(),[]),ie=b!=="media",$=q(0),F=zo(ee=>{G(!1),M("loading"),(async()=>{try{const ge=$.current=Date.now();let{done:Ae,value:le}=await c(ee);if(ge!==$.current)return;if(Array.isArray(le)){const[Z,me]=le.reduce((D,E)=>(E._pinned?D[0].push(E):D[1].push(E),D),[[],[]]);le=me,ie&&(r&&(le=Da(le)),le=Oa(le,s)),Z.length&&(le=Z.concat(le)),k(ee?le:D=>[...D,...le]),le.length||(Ae=!0),N(!Ae)}else N(!1);M("default"),__BENCHMARK.end(`timeline-${i}-load`)}catch{M("error"),ee&&!T.length&&a&&ue(a)}finally{F.cancel()}})()},1e3,{leading:!0}),B=".timeline-item, .timeline-item-alt",K=Ue("j, shift+j",(ee,ge)=>{const Ae=document.activeElement.closest(B),le=Ae==null?void 0:Ae.getBoundingClientRect(),Z=Array.from(U.current.querySelectorAll(B));if(Ae&&le.top<U.current.clientHeight&&le.bottom>0){const me=Z.indexOf(Ae);let D=Z[me+1];ge.shift&&(D=Z.find((E,O)=>O>me&&!E.classList.contains("timeline-item-alt"))),D&&(D.focus(),D.scrollIntoView(an))}else{const me=Z.find(D=>{const E=D.getBoundingClientRect();return E.top>=44&&E.left>=0});me&&(me.focus(),me.scrollIntoView(an))}}),de=Ue("k, shift+k",(ee,ge)=>{const Ae=document.activeElement.closest(B),le=Ae==null?void 0:Ae.getBoundingClientRect(),Z=Array.from(U.current.querySelectorAll(B));if(Ae&&le.top<U.current.clientHeight&&le.bottom>0){const me=Z.indexOf(Ae);let D=Z[me-1];ge.shift&&(D=Z.findLast((E,O)=>O<me&&!E.classList.contains("timeline-item-alt"))),D&&(D.focus(),D.scrollIntoView(an))}else{const me=Z.find(D=>{const E=D.getBoundingClientRect();return E.top>=44&&E.left>=0});me&&(me.focus(),me.scrollIntoView(an))}}),te=Ue(["enter","o"],()=>{const ee=document.activeElement;ee!=null&&ee.matches(B)&&ee.click()}),fe=T.length>0&&A!=="loading"&&V,ye=ct(()=>{var ee;fe&&F(!0),(ee=U.current)==null||ee.scrollTo({top:0,behavior:"smooth"})},[F,fe]),H=Ue(".",ye),ce=q(),[Se,Ee]=L(!1);Fa({scrollableRef:U,distanceFromEnd:2,scrollThresholdStart:44},({scrollDirection:ee,nearReachStart:ge,reachStart:Ae})=>{if(ce.current){const le=ee==="end"&&!ge;ce.current.hidden=le}Ee(ge),Ae&&F(!0)},[]),se(()=>{var ee;(ee=U.current)==null||ee.scrollTo({top:0}),F(!0)},[]);const Re=q(!0);se(()=>{var ee;if(Re.current){Re.current=!1;return}C&&(T!=null&&T.length)&&((ee=F.cancel)==null||ee.call(F),k([])),F(!0)},[C,y]);const Le=q(b);se(()=>{Le.current!==b&&(Le.current=b,k([]))},[b]);const Pe=ct(async({disableIdleCheck:ee=!1}={})=>{const ge=U.current?getComputedStyle(U.current).pointerEvents==="none":!1;I.settings.autoRefresh&&U.current.scrollTop<16&&(ee||window.__IDLE__)&&!Ka()&&!ge?F(!0):await l()&&G(!0)},[i,F,l,I.settings.autoRefresh]),ve=q();return Yt(ee=>{if(ee){const ge=Date.now()-ve.current;(!ve.current||ge>1e3*3)&&Pe({disableIdleCheck:!0})}else ve.current=Date.now();j(ee)},[l,Pe,I.settings.autoRefresh]),ii(Pe,X&&!V?p*(Se?1:2):null),e(gs.Provider,{value:v,children:e("div",{id:`${i}-page`,class:`deck-container ${Y?"deck-container-media-first":""}`,ref:ee=>{U.current=ee,K(ee),de(ee),te(ee),H(ee)},tabIndex:"-1",onClick:ee=>{ce.current&&ee.target.closest(".timeline-item, .timeline-item-alt")&&setTimeout(()=>{ce.current.hidden=!1},250)},children:e("div",{class:"timeline-deck deck",children:[e("header",{ref:ce,onClick:ee=>{var ge;ee.target.closest("a, button")||(ge=U.current)==null||ge.scrollTo({top:0,behavior:"smooth"})},onDblClick:ee=>{ee.target.closest("a, button")||F(!0)},class:A==="loading"?"loading":"",children:[e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Dt,{}),f??e(he,{to:"/",class:"button plain home-button",children:e(S,{icon:"home",size:"l",alt:g._({id:"i0qMbr"})})})]}),t&&(n||e("h1",{children:t})),e("div",{class:"header-side",children:!!m&&m})]}),fe&&e("button",{class:"updates-button shiny-pill",type:"button",onClick:ye,children:[e(S,{icon:"arrow-up"})," ",e(u,{id:"2yr1/p"})]})]}),!!d&&e("div",{class:`timeline-start ${A==="loading"?"loading":""}`,children:d}),T.length?e(z,{children:[e("ul",{class:`timeline ${b?`timeline-${b}`:""}`,children:[T.map(ee=>e(ja,{status:ee,instance:s,useItemID:h,filterContext:v,view:b,showFollowedTags:w,showReplyParent:_,mediaFirst:Y},ee.id+(ee==null?void 0:ee._pinned)+b)),P&&A==="loading"&&(b==="media"?null:e(z,{children:[e("li",{style:{height:"20vh"},children:e(qe,{skeleton:!0,mediaFirst:Y})}),e("li",{style:{height:"25vh"},children:e(qe,{skeleton:!0,mediaFirst:Y})})]}))]}),A==="default"&&(P?e(_t,{root:U.current,rootMargin:`0px 0px ${screen.height*1.5}px 0px`,onChange:ee=>{ee&&F()},children:e("button",{type:"button",class:"plain block",onClick:()=>F(),style:{marginBlockEnd:"6em"},children:e(u,{id:"uXRAkV"})})}):e("p",{class:"ui-state insignificant",children:e(u,{id:"2EYeAZ"})}))]}):A==="loading"?e("ul",{class:"timeline",children:Array.from({length:5}).map((ee,ge)=>b==="media"?e("div",{style:{height:"50vh"}}):e("li",{children:e(qe,{skeleton:!0,mediaFirst:Y})},ge))}):A!=="error"&&A!=="start"&&e("p",{class:"ui-state",children:o}),A==="error"&&e("p",{class:"ui-state",children:[a,e("br",{}),e("br",{}),e("button",{type:"button",onClick:()=>F(!T.length),children:e(u,{id:"KDw4GX"})})]})]})})})}const ja=st(({status:t,instance:n,useItemID:i,filterContext:s,view:o,showFollowedTags:a,showReplyParent:h,mediaFirst:r})=>{const{id:c,reblog:l,items:p,type:f,_pinned:m}=t;m&&(i=!1);const d=(l==null?void 0:l.id)||c,y=n?`/${n}/s/${d}`:`/s/${d}`;if(p){let v=Rt(p,s),w="";if(f==="boosts"?w=g._({id:"NuqppG",values:{0:v.length}}):f==="pinned"&&(w=g._({id:"GlfmCu"})),f==="boosts"||f==="pinned"){const I=new Set;if(v.sort((T,k)=>{const A=Ht(T.filtered,s),M=Ht(k.filtered,s);return A&&I.add(T.id),M&&I.add(k.id),A&&!M?1:!A&&M?-1:0}),I.size>=2){const k=[],A=[];v.forEach(P=>{I.has(P.id)?A.push(P):k.push(P)});const M=[];for(let P=0;P<A.length;P+=5)M.push({_grouped:!0,posts:A.slice(P,P+5)});v=k.concat(M)}return e("li",{class:"timeline-item-carousel",children:e(Va,{title:w,class:`${f}-carousel`,children:v.map(T=>{const{id:k,reblog:A,_pinned:M,_grouped:P}=T;if(P)return e("li",{class:"timeline-item-carousel-group",children:T.posts.map(G=>{const{id:X,reblog:j,_pinned:U}=G,Y=(j==null?void 0:j.id)||X,ie=n?`/${n}/s/${Y}`:`/s/${Y}`;return U&&(i=!1),e(he,{class:"status-carousel-link timeline-item-alt",to:ie,children:i?e(qe,{statusID:X,instance:n,size:"s"}):e(qe,{status:G,instance:n,size:"s"})})})},k);const N=(A==null?void 0:A.id)||k,V=n?`/${n}/s/${N}`:`/s/${N}`;return M&&(i=!1),e("li",{children:e(he,{class:"status-carousel-link timeline-item-alt",to:V,children:i?e(qe,{statusID:k,instance:n,size:"s",contentTextWeight:!0,enableCommentHint:!0,mediaFirst:r}):e(qe,{status:T,instance:n,size:"s",contentTextWeight:!0,enableCommentHint:!0,mediaFirst:r})})},k)})})},`timeline-${c}`)}const C=v.length>3;return v.map((I,T)=>{const{id:k,_differentAuthor:A}=I,M=n?`/${n}/s/${k}`:`/s/${k}`,P=T>0&&T<v.length-1,N=I.sensitive&&!!I.spoilerText,V=!A&&N&&T>0||C&&P&&(f==="thread"||f==="conversation"&&!A&&!v[T-1]._differentAuthor&&!v[T+1]._differentAuthor),G=T===0,X=T===v.length-1;return e("li",{class:`timeline-item-container timeline-item-container-type-${f} timeline-item-container-${G?"start":X?"end":"middle"} ${A?"timeline-item-diff-author":""}`,children:e(he,{class:"status-link timeline-item",to:M,children:V?e(Ga,{status:I,instance:n,filterContext:s}):i?e(qe,{statusID:k,instance:n,enableCommentHint:X,showFollowedTags:a}):e(qe,{status:I,instance:n,enableCommentHint:X,showFollowedTags:a})})},`timeline-${k}`)})}const b=`timeline-${c+m}`;return o==="media"?i?e(qi,{class:"timeline-item",parent:"li",statusID:c,instance:n},b):e(qi,{class:"timeline-item",parent:"li",status:t,instance:n},b):e("li",{children:e(he,{class:"status-link timeline-item",to:y,children:i?e(qe,{statusID:c,instance:n,enableCommentHint:!0,showFollowedTags:a,showReplyParent:h,mediaFirst:r}):e(qe,{status:t,instance:n,enableCommentHint:!0,showFollowedTags:a,showReplyParent:h,mediaFirst:r})})},b)},(t,n)=>{var o,a;const i=(((o=t.status)==null?void 0:o.id)||"").toString(),s=(((a=n.status)==null?void 0:a.id)||"").toString();return i===s&&t.instance===n.instance&&t.view===n.view});function Va({title:t,class:n,children:i}){const s=q(),o=q(),a=q(),[h,r]=L(!1);return se(()=>{setTimeout(()=>{r(!0)},1)},[]),e("div",{class:`status-carousel ${n}`,children:[e("header",{children:[e("h3",{children:t}),e("span",{children:[e("button",{ref:o,type:"button",class:"small plain2",onClick:()=>{var l,p;const c=Math.min(320,(l=s.current)==null?void 0:l.offsetWidth)*(Et()?1:-1);(p=s.current)==null||p.scrollBy({left:c,behavior:"smooth"})},children:e(S,{icon:"chevron-left",alt:g._({id:"DHhJ7s"})})})," ",e("button",{ref:a,type:"button",class:"small plain2",onClick:()=>{var l,p;const c=Math.min(320,(l=s.current)==null?void 0:l.offsetWidth)*(Et()?-1:1);(p=s.current)==null||p.scrollBy({left:c,behavior:"smooth"})},children:e(S,{icon:"chevron-right",alt:g._({id:"hXzOVo"})})})]})]}),e("ul",{ref:s,children:[e(_t,{class:"status-carousel-beacon",onChange:c=>{o.current&&(o.current.disabled=c)}}),i[0],h&&i.slice(1),e(_t,{class:"status-carousel-beacon",onChange:c=>{a.current&&(a.current.disabled=c)}})]})]})}function Ga({status:t,instance:n,filterContext:i}){const s=Ye(x),{id:o,visibility:a,language:h}=t,r=ci(t),c=it(o,n),l=Ht(t.filtered,i);return e("article",{class:`status compact-thread ${a==="direct"?"visibility-direct":""}`,tabindex:"-1",children:[s.statusThreadNumber[c]?e("div",{class:"status-thread-badge",children:[e(S,{icon:"thread",size:"s",alt:g._({id:"e66y2Z"})}),s.statusThreadNumber[c]?` ${s.statusThreadNumber[c]}/X`:""]}):e("div",{class:"status-thread-badge",children:e(S,{icon:"thread",size:"s",alt:g._({id:"e66y2Z"})})}),e("div",{class:"content-compact",title:r,lang:h,dir:"auto",children:l?e("b",{class:"status-filtered-badge badge-meta horizontal",title:(l==null?void 0:l.titlesStr)||"",children:l!=null&&l.titlesStr?e(u,{id:"sr6maL",values:{0:l.titlesStr},components:{0:e("span",{}),1:e("span",{})}}):e("span",{children:e(u,{id:"03Qqf9"})})}):e(z,{children:[r,t.sensitive&&t.spoilerText&&e(z,{children:[" ",e("span",{class:"spoiler-badge",children:e(S,{icon:"eye-close",size:"s",alt:g._({id:"gnKo7f"})})})]})]})})]})}function Ka(){return!!document.querySelector(".deck-backdrop, #modal-container > *")}const Bt=20,vi=1983,ji=`${vi}-01`,Wa=(()=>{try{const t=document.createElement("input");return t.setAttribute("type","month"),t.type==="month"}catch{return!1}})();async function Za(t){var s;const{masto:n}=ae({instance:t}),i=await n.v2.search.fetch({q:"from:me",type:"statuses",limit:1});return!!((s=i==null?void 0:i.statuses)!=null&&s.length)}const Xa=kt(Za);function Ja(){const t=Ye(x),{id:n,...i}=Mt(),[s,o]=ft(),a=s.get("month"),h=!s.get("replies"),r=!!s.get("boosts"),c=s.get("tagged"),l=!!s.get("media"),{masto:p,instance:f,authenticated:m}=ae({instance:i.instance}),{masto:d,instance:y}=ae(),b=q(),v=[a,h,r,c,l],[w,_]=L(),C=q(0);se(()=>{C.current=0},v);const I=ke(()=>ti(),[]),T=ke(()=>f===y,[f,y]),[k,A]=L(!1);se(()=>{T&&w!=null&&w.acct&&(async()=>{const te=await Xa(f);A(te)})()},[f,T,w==null?void 0:w.acct]);async function M(te){var Ee,Re,Le,Pe;const fe=/^\d{4}-[01]\d$/.test(a),ye=((Re=(Ee=a==null?void 0:a.split)==null?void 0:Ee.call(a,"-"))==null?void 0:Re[0])>=vi;if(fe&&ye){if(!w)return{value:[],done:!0};const[ve,ee]=a.split("-"),ge=parseInt(ee,10)-1,Ae=new Date(ve,ge,0),le=`${Ae.getFullYear()}-${(Ae.getMonth()+1).toString().padStart(2,"0")}-${Ae.getDate().toString().padStart(2,"0")}`,Z=new Date(ve,ge+1,1),me=`${Z.getFullYear()}-${(Z.getMonth()+1).toString().padStart(2,"0")}-${Z.getDate().toString().padStart(2,"0")}`;let D;te?(D=Bt+1,C.current=0):(D=Bt+C.current+1,C.current+=Bt);const E=await p.v2.search.fetch({q:`from:${w.acct} after:${le} before:${me}`,type:"statuses",limit:D,offset:C.current});if((Le=E==null?void 0:E.statuses)!=null&&Le.length){const O=E.statuses.slice(0,Bt);O.forEach(we=>{We(we,f)});const re=E.statuses.length<=Bt;return{value:O,done:re}}else return{value:[],done:!0}}let H=[];if(te){const{value:ve}=await p.v1.accounts.$select(n).statuses.list({pinned:!0}).next();if(ve!=null&&ve.length&&!c&&!l){const ee=ve.map(ge=>(We(ge,f),{...ge,_pinned:!0}));if(ee.length>=3){const ge=ee.map(Ae=>Ae.id);H.push({id:ge,items:ee,type:"pinned"})}else H.push(...ee)}}(te||!b.current)&&(b.current=p.v1.accounts.$select(n).statuses.list({limit:Bt,exclude_replies:h,exclude_reblogs:r,only_media:l||void 0,tagged:c}));const{value:ce,done:Se}=await b.current.next();if(ce!=null&&ce.length){if(H.length){let ve=[];((Pe=H[0])==null?void 0:Pe.type)==="pinned"?ve=H[0].id:ve=H.filter(ge=>ge._pinned).map(ge=>ge.id),ve.every(ge=>ce.some(Ae=>Ae.id===ge))&&(H=[])}H.push(...ce),ce.forEach(ve=>{We(ve,f)})}return{value:H,done:Se}}const[P,N]=L([]),{i18n:V}=Qe();let G=V._({id:"/cKnpj"});if(w!=null&&w.acct){const te=(/@/.test(w.acct)?"":"@")+w.acct,fe=w!=null&&w.displayName?`${w.displayName} (${te})`:`${te}`;if(!h)G=V._({id:"hS1Opy",values:{accountDisplay:fe}});else if(r)G=V._({id:"A/CX5F",values:{accountDisplay:fe}});else if(c)G=V._({id:"QQrO94",values:{accountDisplay:fe,tagged:c}});else if(l)G=V._({id:"NoG5wD",values:{accountDisplay:fe}});else if(a){const ye=new Date(a).toLocaleString(V.locale,{month:"long",year:"numeric"});G=V._({id:"8GjLvB",values:{accountDisplay:fe,monthYear:ye}})}else G=fe}Xe(G,"/:instance?/a/:id");const X=q(),j=ct(()=>{const te=X.current||p.v1.accounts.$select(n).fetch();return X.current=te,te},[n,p]);se(()=>{(async()=>{try{const te=await j();_(te)}catch{}if(!I)try{const te=await p.v1.accounts.$select(n).featuredTags.list();N(te)}catch{}})()},[n,I]);const{displayName:U,acct:Y,emojis:ie}=w||{},$=q(),F=ke(()=>{const te=!h||r||c||l||!!a,fe=t.accounts[`${n}@${f}`];return e(z,{children:[e($s,{instance:f,account:fe||n,fetchAccount:j,authenticated:m,standalone:!0}),!I&&e("div",{class:"filter-bar",ref:$,style:{position:"relative"},children:[te?e(he,{to:`/${f}/a/${n}`,class:"insignificant filter-clear",title:V._({id:"u8JHrO"}),children:e(S,{icon:"x",size:"l",alt:V._({id:"xCJdfg"})})},"clear-filters"):e(S,{icon:"filter",class:"insignificant",size:"l",alt:V._({id:"cSev+j"})}),e(he,{to:`/${f}/a/${n}${h?"?replies=1":""}`,onClick:()=>{h&&ue(V._({id:"PIWNSQ"}))},class:h?"":"is-active",children:e(u,{id:"5BFynH"})}),e(he,{to:`/${f}/a/${n}${r?"":"?boosts=0"}`,onClick:()=>{r||ue(V._({id:"Qd13i0"}))},class:r?"is-active":"",children:e(u,{id:"usxQx0"})}),e(he,{to:`/${f}/a/${n}${l?"":"?media=1"}`,onClick:()=>{l||ue(V._({id:"rKpfPY"}))},class:l?"is-active":"",children:e(u,{id:"xYilR2"})}),P.map(ye=>e(he,{to:`/${f}/a/${n}${c===ye.name?"":`?tagged=${encodeURIComponent(ye.name)}`}`,onClick:()=>{c!==ye.name&&ue(V._({id:"L+HFfr",values:{0:ye.name}}))},class:c===ye.name?"is-active":"",children:e("span",{children:[e("span",{class:"more-insignificant",children:"#"}),ye.name]})},ye.id)),k&&(Wa?e("label",{class:`filter-field ${a?"is-active":""}`,children:[e(S,{icon:"month",size:"l"}),e("input",{type:"month",disabled:!(w!=null&&w.acct),value:a||"",min:ji,max:new Date().toISOString().slice(0,7),onInput:ye=>{const{value:H,validity:ce}=ye.currentTarget;if(!ce.valid)return;o(H?{month:H}:{});const[Se,Ee]=H.split("-"),Re=parseInt(Ee,10)-1,Le=new Date(Se,Re);ue(V._({id:"0WUFGD",values:{0:Le.toLocaleString(V.locale,{month:"long",year:"numeric"})}}))}})]}):e(Qa,{class:`filter-field ${a?"is-active":""}`,disabled:!(w!=null&&w.acct),value:a||"",min:ji,max:new Date().toISOString().slice(0,7),onInput:ye=>{const{value:H,validity:ce}=ye;ce.valid&&o(H?{month:H}:{})}}))]})]})},[n,f,m,P,j,k,...v]);se(()=>{var fe;const te=(fe=$.current)==null?void 0:fe.querySelector(".is-active");te&&$.current.scrollTo({behavior:"smooth",left:te.offsetLeft-($.current.offsetWidth-te.offsetWidth)/2})},[P,k,...v]);const B=ke(()=>w!=null&&w.url?URL.parse(w.url).hostname:null,[w]),de=!!w&&!(f===B);return e(St,{title:`${w!=null&&w.acct?"@"+w.acct:V._({id:"+owNNn"})}`,titleComponent:e("h1",{class:"header-double-lines header-account",children:[e("b",{children:e(fs,{text:U,emojis:ie})}),e("div",{children:e("span",{class:"bidi-isolate",children:["@",Y]})})]}),id:"account-statuses",instance:f,emptyText:V._({id:"+k97fV"}),errorText:V._({id:"scd9lw"}),fetchItems:M,useItemID:!0,view:l||I?"media":void 0,boostsCarousel:t.settings.boostsCarousel,timelineStart:F,refresh:[h,r,c,l,a+(w==null?void 0:w.acct)].toString(),headerEnd:e(at,{portal:!0,overflow:"auto",viewScroll:"close",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(S,{icon:"more",size:"l",alt:V._({id:"2FYpfJ"})})}),children:[e(_e,{disabled:!de,onClick:()=>{(async()=>{try{const{masto:te}=ae({instance:B}),fe=await te.v1.accounts.lookup({acct:w.acct}),{id:ye}=fe;location.hash=`/${B}/a/${ye}`}catch{alert(V._({id:"FgdLx0"}))}})()},children:[e(S,{icon:"transfer"})," ",e("small",{class:"menu-double-lines",children:e(u,{id:"/JFxxT",values:{0:B?e(z,{children:[" ","(",e("b",{children:Nt.toUnicode(B)}),")"]}):null}})})]}),!T&&e(_e,{onClick:()=>{(async()=>{try{const te=await d.v1.accounts.lookup({acct:w.acct+"@"+f}),{id:fe}=te;location.hash=`/${y}/a/${fe}`}catch{alert(V._({id:"FgdLx0"}))}})()},children:[e(S,{icon:"transfer"})," ",e("small",{class:"menu-double-lines",children:e(u,{id:"HkuyOu",values:{currentInstance:y},components:{0:e("b",{})}})})]})]})},n)}function Qa(t){const{i18n:n}=Qe(),{class:i,disabled:s,value:o,min:a,max:h,onInput:r=()=>{}}=t,[c,l]=(o==null?void 0:o.split("-"))||[],p=q(),f=q(),m=(d,y)=>{const[b,v]=(a==null?void 0:a.split("-"))||[],[w,_]=(h==null?void 0:h.split("-"))||[];return!(y<b||y>w||y===b&&d<v||y===w&&d>_)};return e("div",{class:i,children:[e(S,{icon:"month",size:"l"}),e("select",{ref:p,disabled:s,value:l||"",onInput:d=>{const{value:y}=d.currentTarget,b=f.current.value;if(!m(y,b))return{value:"",validity:{valid:!1}};r({value:y?`${b}-${y}`:"",validity:{valid:!0}})},children:[e("option",{value:"",children:e(u,{id:"HajiZl"})}),e("option",{disabled:!0,children:"-----"}),Array.from({length:12},(d,y)=>e("option",{value:(y+1).toString().padStart(2,"0"),children:new Date(0,y).toLocaleString(n.locale,{month:"long"})},y))]})," ",e("input",{ref:f,type:"number",disabled:s,value:c||new Date().getFullYear(),min:(a==null?void 0:a.slice(0,4))||vi,max:(h==null?void 0:h.slice(0,4))||new Date().getFullYear(),onInput:d=>{const{value:y,validity:b}=d.currentTarget,v=p.current.value;if(!b.valid||!m(v,y))return{value:"",validity:{valid:!1}};r({value:y?`${y}-${v}`:"",validity:{valid:!0}})},style:{width:"4.5em"}})]})}const er=20;function Us(){Xe(g._({id:"7Ff7ia"}),"/bookmarks");const{masto:t,instance:n}=ae(),i=q();async function s(o){return(o||!i.current)&&(i.current=t.v1.bookmarks.list({limit:er})),await i.current.next()}return e(St,{title:g._({id:"7Ff7ia"}),id:"bookmarks",emptyText:g._({id:"8k2w6G"}),errorText:g._({id:"UoL+FC"}),instance:n,fetchItems:s})}const tr=""+new URL("catch-up-DuauQu-W.png",import.meta.url).href,nr="home",ot=[{label:{id:"Ov9hfp"},value:1},{label:{id:"tVE2wM"},value:2},{label:{id:"8+HOWa"},value:3},{label:{id:"1o+mEC"},value:4},{label:{id:"dZZ8oA"},value:5},{label:{id:"lpPucp"},value:6},{label:{id:"r9r5X6"},value:7},{label:{id:"I9uBFA"},value:8},{label:{id:"pBYFlb"},value:9},{label:{id:"wvL7OJ"},value:10},{label:{id:"7Vb+qD"},value:11},{label:{id:"VU1Pnd"},value:12},{label:{id:"vpc27K"},value:13}],ir={original:{id:"HxF6Fk"},replies:{id:"N8UzTV"},boosts:{id:"puY2t0"},followedTags:{id:"lCLRBe"},groups:{id:"zhrjek"},filtered:{id:"03Qqf9"}},sr=["createdAt","repliesCount","favouritesCount","reblogsCount","density"],or=[null,"account"],cr=ls(t=>new Intl.DateTimeFormat(t||void 0,{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}));function ar(){const{i18n:t,_:n}=Qe(),i=cr(t.locale);Xe("Catch-up","/catchup");const{masto:s,instance:o}=ae(),[a,h]=ft(),r=a.get("id"),[c,l]=L("start"),[p,f]=L(!1),m=ke(()=>wt(),[]),d=R=>R===m,y=Ze("@pixelfed/home-include-reblogs");async function b({maxCreatedAt:R}){var ne,Me,Te;const Q=R?new Date(R):null,oe=[],W=s.v1.timelines.home.list({limit:40});e:for(;;)try{y&&W.nextParams&&(typeof W.nextParams=="string"?W.nextParams+="&include_reblogs=true":W.nextParams.include_reblogs=!0);const xe=await W.next(),{value:ze}=xe;if(ze!=null&&ze.length){await zs(ze,o);let He=!1;for(let pe=0;pe<ze.length;pe++){const Ne=ze[pe],Je=new Date(Ne.createdAt);if(!Q||Je>=Q){const je=!d(((Me=(ne=Ne.reblog)==null?void 0:ne.account)==null?void 0:Me.id)||Ne.account.id)&&Ht(((Te=Ne.reblog)==null?void 0:Te.filtered)||Ne.filtered,nr);if((je==null?void 0:je.action)==="hide")continue;Ne._filtered=je;const bt=it(Ne.id,o);Ne._followedTags=x.statusFollowedTags[bt]?[...x.statusFollowedTags[bt]]:[],oe.push(Ne),He=!0}if(!He)break e}}else break e;await new Promise(He=>setTimeout(He,1e3))}catch{break e}return oe.forEach(xe=>{if(xe!=null&&xe.inReplyToId){const ze=oe.find(He=>He.id===xe.inReplyToId);ze&&!ze.inReplyToId&&(ze._thread=!0)}}),oe}const[v,w]=L([]),_=q(),C=q(),I=ke(()=>vn(),[]),T=ct(async({duration:R}={})=>{const Q=Date.now(),oe=R?Q-R:null;l("loading");const W=await b({maxCreatedAt:oe}),ne=`${I}-${Uo()}`;try{await ut.catchup.set(ne,{id:ne,posts:W,count:W.length,startAt:oe,endAt:Q}),h({id:ne})}catch{}},[]);se(()=>{r?(async()=>{const R=await ut.catchup.get(r);R&&(R.posts.sort((Q,oe)=>Q.createdAt>oe.createdAt?1:-1),w(R.posts),l("results"))})():c==="results"&&(w([]),l("start"))},[r]);const[k,A]=$t(R=>R+1,0),[M,P]=L(null),[N,V]=L([]);se(()=>{(async()=>{try{const R=await ut.catchup.keys();if(R.length){const Q=vn(),oe=R.filter(W=>W.startsWith(`${Q}-`));if(oe.length){let W=await ut.catchup.getMany(oe);W.sort((xe,ze)=>ze.endAt-xe.endAt);let ne=W.slice(0,3),Me=W.slice(3);const Te=ne.map(xe=>{const{id:ze,count:He,startAt:pe,endAt:Ne}=xe;return{id:ze,count:He,startAt:pe,endAt:Ne}});V(Te),P(ne[0].endAt),W=null,ne=null,queueMicrotask(()=>{Me.length&&ut.catchup.delMany(Me.map(xe=>xe.id)).then(()=>{Me=null}).catch(xe=>{})});return}}}catch{}V([])})()},[k]),se(()=>{c==="start"&&A()},[c==="start"]);const[G,X]=ke(()=>{var ze,He,pe,Ne,Je;let R=0,Q=0,oe=0,W=0,ne=0,Me=0;const Te={};for(const Ce of v){Ce._filtered?(R++,Ce.__FILTER="filtered"):Ce.group?(Q++,Ce.__FILTER="groups"):Ce.reblog?(oe++,Ce.__FILTER="boosts"):(ze=Ce._followedTags)!=null&&ze.length?(ne++,Ce.__FILTER="followedTags"):Ce.inReplyToId&&Ce.inReplyToAccountId!==((He=Ce.account)==null?void 0:He.id)?(W++,Ce.__FILTER="replies"):(Me++,Ce.__FILTER="original");const je=Ce.reblog||Ce;if(Ce.__FILTER!=="filtered"&&((pe=je.card)!=null&&pe.url)&&((Ne=je.card)!=null&&Ne.image)&&((Je=je.card)==null?void 0:Je.type)==="link"){const{card:bt,favouritesCount:cn,reblogsCount:At}=je;let{url:et}=bt;if(et=et.replace(/\/$/,""),!Te[et])Te[et]={postID:je.id,card:bt,shared:1,sharers:[Ce.account],likes:cn,boosts:At};else{if(Te[et].sharers.find(Ot=>Ot.id===Ce.account.id))continue;Te[et].shared++,Te[et].sharers.push(Ce.account),Te[et].postID!==je.id&&(Te[et].likes+=cn,Te[et].boosts+=At)}}}let xe=[];for(const Ce in Te)xe.push({url:Ce,...Te[Ce]});if(xe.sort((Ce,je)=>Ce.shared>je.shared?-1:Ce.shared<je.shared?1:Ce.boosts>je.boosts?-1:Ce.boosts<je.boosts?1:Ce.likes>je.likes?-1:Ce.likes<je.likes?1:0),xe.length>10)e:for(let Ce=10;Ce<xe.length;Ce++){const{shared:je}=xe[Ce];if(je<=1){xe=xe.slice(0,Ce);break e}}return[{filtered:R,groups:Q,boosts:oe,replies:W,followedTags:ne,original:Me},xe]},[v]),[j,U]=L("all"),[Y,ie]=L(null),[$,F]=L(1),[B,K]=L("createdAt"),[de,te]=L("asc"),[fe,ye]=L(null),[H,ce,Se]=ke(()=>{const R={},Q=new Map;let oe=v.filter(ne=>{const Me=j==="all"||ne.__FILTER===j;return Me&&(R[ne.account.id]=ne.account,Q.set(ne.account.id,(Q.get(ne.account.id)||0)+1)),Me});const W={};return oe.forEach(ne=>{ne.reblog&&(W[ne.reblog.id]?(W[ne.reblog.id].__BOOSTERS?W[ne.reblog.id].__BOOSTERS.add(ne.account):W[ne.reblog.id].__BOOSTERS=new Set([ne.account]),ne.__HIDDEN=!0):W[ne.reblog.id]=ne)}),Y&&Q.has(Y)&&(oe=oe.filter(ne=>ne.account.id===Y||[...ne.__BOOSTERS||[]].find(Me=>Me.id===Y))),[oe,R,Object.fromEntries(Q)]},[j,Y,v]),Ee=ke(()=>{const R={};return H.forEach(Q=>{R[Q.id]=Q}),R},[H]),Re=ke(()=>Object.keys(Se).sort((R,Q)=>Se[Q]-Se[R]),[Se]),Le=ke(()=>{const R={};return Re.forEach((Q,oe)=>{R[Q]=oe}),H.filter(Q=>!Q.__HIDDEN).sort((Q,oe)=>{if(fe==="account"){const W=Q.account.id,ne=oe.account.id,Me=R[W],Te=R[ne],xe=Me-Te;if(xe!==0)return xe}if(B!=="createdAt"&&(Q=Q.reblog||Q,oe=oe.reblog||oe,B!=="density"&&Q[B]===oe[B]))return Q.createdAt>oe.createdAt?1:-1;if(B==="density"){const W=Vi(Q),ne=Vi(oe);return de==="asc"?W>ne?1:-1:ne>W?1:-1}return de==="asc"?Q[B]>oe[B]?1:-1:oe[B]>Q[B]?1:-1})},[H,B,de,fe,Re]),Pe=q(null),ve=q(null),ee=q(!1);se(()=>{v.length>100||ee.current||ve.current&&(Ts(ve.current,{duration:200}),ee.current=!0)},[v,ve]);const ge=v.length>160?"3d":"2d",Ae=ke(()=>ge!=="2d"?null:v.map(R=>{const Q=Ee[R.id];return e("span",{class:`post-dot ${Q?"post-dot-highlight":""}`},R.id)}),[Ee]),le=ke(()=>ge!=="3d"||!(v!=null&&v.length)?null:pr(v,"createdAt",320).map((Q,oe)=>e("div",{class:"posts-bin",children:Q.map(W=>{const ne=Ee[W.id];return e("span",{class:`post-dot ${ne?"post-dot-highlight":""}`},W.id)})},oe)),[Ee]),Z=q(null),me=ke(()=>M?(Date.now()-M)/1e3/60/60:null,[M,$]);se(()=>{if(c!=="results")return;const R=Y&&ce[Y]?ce[Y].username:"",Q=de==="asc"?0:1,oe={account:"authors"};let W=ue({duration:5e3,text:t._({id:"TLYeLT",values:{selectedFilterCategory:j,sortBy:B,sortOrder:de,groupBy:fe}})});return()=>{var ne;(ne=W==null?void 0:W.hideToast)==null||ne.call(W)}},[c,j,Y,B,de,fe,ce]),se(()=>{var R;if(Y&&ce[Y]){const Q=ve.current.querySelector(`[data-author="${Y}"]`),oe=(R=ve.current)==null?void 0:R.getBoundingClientRect(),W=Q==null?void 0:Q.getBoundingClientRect();W.left<oe.left||W.right>oe.right?Q.scrollIntoView({block:"nearest",inline:"center",behavior:"smooth"}):W.top<0&&Q.scrollIntoView({block:"nearest",inline:"nearest",behavior:"smooth"})}},[Y,ce]);const[D,E]=L(!1),O=".catchup-list > li > a",re=Ue("j",()=>{const R=document.activeElement.closest(O),Q=R==null?void 0:R.getBoundingClientRect(),oe=Array.from(Z.current.querySelectorAll(O));if(R&&Q.top<Z.current.clientHeight&&Q.bottom>0){const W=oe.indexOf(R),ne=oe[W+1];ne&&(ne.focus(),ne.scrollIntoView({block:"center",inline:"center",behavior:"smooth"}))}else{const W=oe.find(ne=>ne.getBoundingClientRect().top>=0);W&&(W.focus(),W.scrollIntoView({block:"nearest",inline:"center",behavior:"smooth"}))}},{preventDefault:!0,ignoreModifiers:!0}),we=Ue("k",()=>{const R=document.activeElement.closest(O),Q=R==null?void 0:R.getBoundingClientRect(),oe=Array.from(Z.current.querySelectorAll(O));if(R&&Q.top<Z.current.clientHeight&&Q.bottom>0){const W=oe.indexOf(R);let ne=oe[W-1];ne&&(ne.focus(),ne.scrollIntoView({block:"center",inline:"center",behavior:"smooth"}))}else{const W=oe.find(ne=>{const Me=ne.getBoundingClientRect();return Me.top>=44&&Me.left>=0});W&&(W.focus(),W.scrollIntoView({block:"nearest",inline:"center",behavior:"smooth"}))}},{preventDefault:!0,ignoreModifiers:!0}),Ie=Ue("h, l",(R,Q)=>{var W,ne,Me;const oe=Q.keys[0];if(Y){const Te=Re.indexOf(Y);oe==="h"?Te>0&&Te<Re.length&&(ie(Re[Te-1]),(W=Z.current)==null||W.focus()):oe==="l"&&Te<Re.length-1&&Te>=0&&(ie(Re[Te+1]),(ne=Z.current)==null||ne.focus())}else oe==="l"&&(ie(Re[0]),(Me=Z.current)==null||Me.focus())},{preventDefault:!0,ignoreModifiers:!0,enableOnFormTags:["input"]}),J=Ue("esc",()=>{var R;ie(null),(R=Z.current)==null||R.focus()},{preventDefault:!0,ignoreModifiers:!0,enableOnFormTags:["input"]}),$e=Ue(".",()=>{var R;(R=Z.current)==null||R.scrollTo({top:0,behavior:"smooth"})},{preventDefault:!0,ignoreModifiers:!0,enableOnFormTags:["input"]}),Oe=ct(R=>{const Q=document.activeElement,oe=(Q==null?void 0:Q.tagName)==="INPUT"&&Q.type==="radio";if((R.key==="ArrowDown"||R.key==="ArrowUp"||R.key==="ArrowLeft"||R.key==="ArrowRight")&&oe){Q.blur();return}},[]);return e("div",{ref:R=>{Z.current=R,re(R),we(R),Ie(R),J(R)},id:"catchup-page",class:"deck-container",tabIndex:"-1",children:[e("div",{class:"timeline-deck deck wide",children:[e("header",{class:`${c==="loading"?"loading":""}`,onClick:R=>{var Q;R.target.closest("a, button")||(Q=Z.current)==null||Q.scrollTo({top:0,behavior:"smooth"})},children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Dt,{}),c==="results"&&e(he,{to:"/catchup",class:"button plain",children:e(S,{icon:"history2",size:"l",alt:t._({id:"xrl8fj"})})}),c==="start"&&e(he,{to:"/",class:"button plain",children:e(S,{icon:"home",size:"l",alt:t._({id:"i0qMbr"})})})]}),e("h1",{children:c!=="start"&&e(u,{id:"wyL/3/",components:{0:e("sup",{})}})}),e("div",{class:"header-side",children:c!=="start"&&c!=="loading"&&e("button",{type:"button",class:"plain",onClick:()=>{E(!0)},children:e(u,{id:"c3XJ18"})})})]})}),e("main",{onKeyDown:Oe,children:[c==="start"&&e("div",{class:"catchup-start",children:[e("h1",{children:e(u,{id:"wyL/3/",components:{0:e("sup",{})}})}),e("details",{children:[e("summary",{children:e(u,{id:"CxKPv6"})}),e("p",{children:e(u,{id:"YMU1CK"})}),e("img",{src:tr,width:"1200",height:"900",alt:t._({id:"CeInO2"})}),e("p",{children:e("button",{type:"button",onClick:R=>{R.target.closest("details").open=!1},children:e(u,{id:"2jI8hh"})})})]}),e("p",{children:e(u,{id:"1RfGk7"})}),e("p",{children:e("b",{children:e(u,{id:"OOEonE"})})}),e("div",{class:"catchup-form",children:[e("input",{ref:_,type:"range",value:$,min:ot[0].value,max:ot[ot.length-1].value,step:"1",list:"catchup-ranges",onChange:R=>F(+R.target.value)})," ",e("span",{style:{width:"8em"},children:[n(ot[$-1].label),e("br",{}),e("small",{class:"insignificant",children:$==ot[ot.length-1].value?t._({id:"NMNiaO"}):ht(new Date(Date.now()-$*60*60*1e3))})]}),e("datalist",{id:"catchup-ranges",children:ot.map(({label:R,value:Q})=>e("option",{value:Q,label:n(R)}))})," ",e("button",{type:"button",onClick:()=>{var R;if($<ot[ot.length-1].value){let Q;$===ot[ot.length-1].value&&((R=C.current)!=null&&R.checked)?Q=Date.now()-M:Q=$*60*60*1e3,T({duration:Q})}else T()},children:e(u,{id:"R0yu2l"})})]}),me&&$>me?e("p",{class:"catchup-info",children:[e(S,{icon:"info"})," ",e(u,{id:"AGyV7s"})]}):$===ot[ot.length-1].value&&M?e("p",{class:"catchup-info",children:e("label",{children:[e("input",{type:"checkbox",switch:!0,checked:!0,ref:C})," ",e(u,{id:"dDJEHI",values:{0:i.format(new Date(M))}})]})}):null,e("p",{class:"insignificant",children:e("small",{children:e(u,{id:"EAjFM0"})})}),!!(N!=null&&N.length)&&e("div",{class:"catchup-prev",children:[e("p",{children:e(u,{id:"Yfb9A8"})}),e("ul",{children:N.map(R=>e("li",{children:[e(he,{to:`/catchup?id=${R.id}`,children:[e(S,{icon:"history2"})," ",e("span",{children:R.startAt?i.formatRange(new Date(R.startAt),new Date(R.endAt)):`â€¦â€‰â€“â€‰${i.format(new Date(R.endAt))}`})]})," ",e("span",{children:[e("small",{class:"ib insignificant",children:e(u,{id:"S6XZwv",values:{0:R.count}})})," ",e("button",{type:"button",class:"light danger small",onClick:async()=>{var oe;if(confirm(t._({id:"D9CmP2"}))){let W=ue(t._({id:"xJUo4P",values:{0:R.id}}));await ut.catchup.del(R.id),(oe=W==null?void 0:W.hideToast)==null||oe.call(W),ue(t._({id:"1dyGG/",values:{0:R.id}})),A()}},children:e(S,{icon:"x",alt:t._({id:"t/YqKh"})})})]})]},R.id))}),N.length>=3&&e("p",{children:e("small",{children:e(u,{id:"sXmrl4"})})})]})]}),c==="loading"&&e("div",{class:"ui-state catchup-start",children:[e(De,{abrupt:!0}),e("p",{class:"insignificant",children:e(u,{id:"rbUTzD"})}),e("p",{class:"insignificant",children:e(u,{id:"q9urQO"})})]}),c==="results"&&e(z,{children:[e("div",{class:"catchup-header",children:[v.length>0&&e("p",{children:e("b",{class:"ib",children:i.formatRange(new Date(v[0].createdAt),new Date(v[v.length-1].createdAt))})}),e("aside",{children:[e("button",{hidden:j==="all"&&!Y&&B==="createdAt"&&de==="asc",type:"button",class:"plain4 small",onClick:()=>{U("all"),ie(null),K("createdAt"),ye(null),te("asc")},children:e(u,{id:"I9EnzM"})}),(X==null?void 0:X.length)>0&&e("button",{type:"button",class:"plain small",onClick:()=>f(!p),children:[e(u,{id:"EIZREX"})," ",e(S,{icon:"chevron-down",style:{transform:p?"rotate(180deg)":"rotate(0deg)"}})]})]})]}),e("div",{class:"shazam-container no-animation",hidden:!p,children:e("div",{class:"shazam-container-inner",children:e("div",{class:"catchup-top-links links-bar",children:X.map(R=>{const{card:Q,shared:oe,sharers:W,likes:ne,boosts:Me}=R,{blurhash:Te,title:xe,description:ze,url:He,image:pe,imageDescription:Ne,language:Je,width:Ce,height:je,publishedAt:bt}=Q,cn=Nt.toUnicode(URL.parse(He).hostname.replace(/^www\./,"").replace(/\/$/,""));let At;if(Te){const et=oi(Te),Ot=bi(et);At=gi([.6,Ot[1],Ot[2]])}return e("a",{href:He,target:"_blank",rel:"noopener noreferrer",class:"link-block",style:At?{"--accent-color":`rgb(${At.join(",")})`,"--accent-alpha-color":`rgba(${At.join(",")}, 0.4)`}:{},children:e("article",{children:[e("figure",{children:e("img",{src:pe,alt:Ne,width:Ce,height:je,loading:"lazy"})}),e("div",{class:"article-body",children:[e("header",{children:[e("div",{class:"article-meta",children:[e("span",{class:"domain",children:cn})," ",!!bt&&e(z,{children:"Â· "}),!!bt&&e(z,{children:e(Kt,{datetime:bt,format:"micro"})})]}),!!xe&&e("h1",{class:"title",lang:Je,dir:"auto",title:xe,children:xe})]}),!!ze&&e("p",{class:"description",lang:Je,dir:"auto",title:ze,children:ze}),e("hr",{}),e("p",{style:{whiteSpace:"nowrap"},children:e(u,{id:"bfSr6z",values:{0:W.map(et=>{const{avatarStatic:Ot,displayName:oo}=et;return e("button",{type:"button",class:"plain",style:{padding:0},onClick:_i=>{_i.preventDefault(),_i.stopPropagation();const{id:co}=et;ie(co),U("all")},children:e(dt,{url:Ot,size:"s",alt:oo})})})}})})]})]})},He)})})})}),v.length>=5&&(ge==="3d"?e("div",{class:"catchup-posts-viz-time-bar",children:le}):e("div",{class:"catchup-posts-viz-bar",children:Ae})),v.length>=2&&e("div",{class:"catchup-filters",children:[e("label",{class:"filter-cat",children:[e("input",{type:"radio",name:"filter-cat",checked:j.toLowerCase()==="all",onChange:()=>{U("all")}}),e(u,{id:"N40H+G"})," ",e("span",{class:"count",children:v.length})]}),Object.entries(ir).map(([R,Q])=>!!G[R]&&e("label",{class:"filter-cat",title:(G[R]/v.length*100).toFixed(2)+"%",children:[e("input",{type:"radio",name:"filter-cat",checked:j.toLowerCase()===R.toLowerCase(),onChange:()=>{U(R),R==="boosts"&&(K("reblogsCount"),te("desc"),ye(null))}}),n(Q)," ",e("span",{class:"count",children:G[R]})]},n(Q)))]}),v.length>=2&&!!Se&&e("div",{class:"catchup-filters authors-filters",ref:ve,children:[Re.map(R=>e("label",{class:"filter-author","data-author":R,children:[e("input",{type:"radio",name:"filter-author",checked:Y===R,onChange:()=>{ie(R)},onClick:()=>{Y===R&&ie(null)}}),e(dt,{url:ce[R].avatarStatic||ce[R].avatar,size:"xxl",alt:`${ce[R].displayName} (@${ce[R].acct})`})," ",e("span",{class:"count",children:Se[R]}),e("span",{class:"username",children:ce[R].username})]},`${R}-${Se[R]}`)),Re.length>5&&e("small",{style:{whiteSpace:"nowrap",paddingInline:"1em",opacity:.33},children:e(u,{id:"HHtYi7",values:{0:Re.length}})},"authors-count")]}),v.length>=2&&e("div",{class:"catchup-filters",children:[e("span",{class:"filter-label",children:e(u,{id:"f6Hub0"})})," ",e("fieldset",{class:"radio-field-group",children:sr.map(R=>e("label",{class:"filter-sort",onClick:Q=>{B===R&&(Q.preventDefault(),Q.stopPropagation(),te(de==="asc"?"desc":"asc"))},children:[e("input",{type:"radio",name:"filter-sort-cat",checked:B===R,onChange:()=>{K(R);const Q=/(replies|favourites|reblogs)/.test(R)?"desc":"asc";te(Q)}}),{createdAt:t._({id:"mYGY3B"}),repliesCount:t._({id:"N8UzTV"}),favouritesCount:t._({id:"zZOZj7"}),reblogsCount:t._({id:"puY2t0"}),density:t._({id:"0tQ7AD"})}[R],B===R&&(de==="asc"?" â†‘":" â†“")]},R))}),e("span",{class:"filter-label",children:e(u,{id:"group.filter"})})," ",e("fieldset",{class:"radio-field-group",children:or.map(R=>e("label",{class:"filter-group",children:[e("input",{type:"radio",name:"filter-group",checked:fe===R,onChange:()=>{ye(R)},disabled:R==="account"&&Y}),{account:t._({id:"dpqPBg"})}[R]||t._({id:"EdQY6l"})]},R||"none"))}),Y&&Re.length>1?e("button",{type:"button",class:"plain6 small",onClick:()=>{ie(null)},style:{whiteSpace:"nowrap"},children:e(u,{id:"/dlmrZ"})}):null]}),e("ul",{class:`catchup-list catchup-filter-${j||""} ${B?`catchup-sort-${B}`:""} ${Y&&ce[Y]?"catchup-selected-author":""} ${fe?`catchup-group-${fe}`:""}`,children:Le.map((R,Q)=>{var ne;const oe=((ne=R.reblog)==null?void 0:ne.id)||R.id;let W=!1;return fe==="account"&&(Pe.current&&R.account.id!==Pe.current&&Q>0&&(W=!0),Pe.current=R.account.id),e(z,{children:[W&&e("li",{class:"separator"}),e(lr,{to:`/${o}/s/${oe}`,post:R,root:Z.current})]},`${R.id}-${W}`)})}),e("footer",{children:H.length>5&&e("p",{children:[j==="boosts"?t._({id:"eVosYr"}):t._({id:"rhmyFK"})," ",e("button",{type:"button",class:"textual",onClick:()=>{Z.current.scrollTop=0},children:e(u,{id:"0MgdN+"})}),"."]})})]})]})]}),D&&e(Fe,{onClose:()=>E(!1),children:e("div",{class:"sheet",id:"catchup-help-sheet",children:[e("button",{type:"button",class:"sheet-close",onClick:()=>E(!1),children:e(S,{icon:"x",alt:t._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(u,{id:"c3XJ18"})})}),e("main",{children:e("dl",{children:[e("dt",{children:e(u,{id:"EIZREX"})}),e("dd",{children:e(u,{id:"YmGrIy"})}),e("dt",{children:e(u,{id:"coaNtr"})}),e("dd",{children:e(u,{id:"UUrqX1"})}),e("dt",{children:e(u,{id:"ScQBC/"})}),e("dd",{children:e(u,{id:"srocAr"})}),e("dt",{children:e(u,{id:"77Emn0"})}),e("dd",{children:e("table",{children:e("tbody",{children:[e("tr",{children:[e("td",{children:e(u,{id:"Gy9P9T"})}),e("td",{children:e("kbd",{children:"j"})})]}),e("tr",{children:[e("td",{children:e(u,{id:"6XYpYY"})}),e("td",{children:e("kbd",{children:"k"})})]}),e("tr",{children:[e("td",{children:e(u,{id:"f5dduh"})}),e("td",{children:e("kbd",{children:"l"})})]}),e("tr",{children:[e("td",{children:e(u,{id:"rj0vxZ"})}),e("td",{children:e("kbd",{children:"h"})})]}),e("tr",{children:[e("td",{children:e(u,{id:"jsFF8C"})}),e("td",{children:e("kbd",{children:"Enter"})})]}),e("tr",{children:[e("td",{children:e(u,{id:"bUUv3P"})}),e("td",{children:e("kbd",{children:"."})})]})]})})})]})})]})})]})}const rr=st(function({post:t}){const{id:n,account:i,group:s,reblog:o,inReplyToId:a,inReplyToAccountId:h,_followedTags:r,_filtered:c,visibility:l,__BOOSTERS:p}=t,f=a&&h!==i.id,m=!!c,d=y=>{y.shiftKey};return e("article",{class:`post-line ${s?"group":o?"reblog":r!=null&&r.length?"followed-tags":""} ${f?"reply-to":""} ${m?"filtered":""} visibility-${l}`,onMouseEnter:d,children:[e("span",{class:"post-author",children:o?e("span",{class:"post-reblog-avatar",children:[e(dt,{url:i.avatarStatic||i.avatar,squircle:i.bot}),(p==null?void 0:p.size)>0?[...p].map(y=>e(dt,{url:y.avatarStatic||y.avatar,squircle:y.bot})):""," ",e(S,{icon:"rocket"})," ",e(mt,{account:o.account,showAvatar:!0})]}):e(mt,{account:i,showAvatar:!0})}),e(hr,{post:o||t,filterInfo:c}),e("span",{class:"post-meta",children:[e(fr,{post:o||t})," ",e(Kt,{datetime:new Date((o==null?void 0:o.createdAt)||t.createdAt),format:"micro"})]})]})},(t,n)=>{var i,s;return((i=t==null?void 0:t.post)==null?void 0:i.id)===((s=n==null?void 0:n.post)==null?void 0:s.id)}),lr=({root:t,to:n,...i})=>{const s=q(),[o,a]=L(!1);return se(()=>{const h=new IntersectionObserver(r=>{r[0].isIntersecting&&(queueMicrotask(()=>a(!0)),h.unobserve(s.current))},{root:t,rootMargin:`${Math.max(320,screen.height*.75)}px`});return s.current&&h.observe(s.current),()=>{s.current&&h.unobserve(s.current)}},[]),o?e("li",{children:e(he,{to:n,children:e(rr,{...i})})}):e("li",{ref:s,style:{height:"4em"}})},dr=8,ur=8;function Vi(t){var c;const{spoilerText:n,content:i,poll:s,mediaAttachments:o,card:a}=t,h=(c=s==null?void 0:s.options)!=null&&c.length?s.options.reduce((l,p)=>l+p.title,""):"";return(n.length+ys(i)+h.length)/140+(o!=null&&o.length?dr*o.length:a!=null&&a.image?ur:0)}const Ct=48;function hr({post:t,filterInfo:n}){var _;const{spoilerText:i,sensitive:s,content:o,emojis:a,poll:h,mediaAttachments:r,card:c,inReplyToId:l,inReplyToAccountId:p,account:f,_thread:m}=t,d=l&&p===f.id||!!m,y=ke(()=>!!(be.account.get("preferences")||{})["reading:expand:spoilers"],[]),b=y||!i&&!s,v=o?ci(t):"",w=!i||y;return e("div",{class:"post-peek",title:i?"":v,children:[e("span",{class:"post-peek-content",children:[d&&!w&&e(z,{children:[e("span",{class:"post-peek-tag post-peek-thread",children:"Thread"})," "]}),n?e("span",{class:"post-peek-filtered",children:n!=null&&n.titlesStr?g._({id:"suKjh3",values:{0:n.titlesStr}}):g._({id:"03Qqf9"})}):e(z,{children:[!!i&&e("span",{class:"post-peek-spoiler",children:[e(S,{icon:`${y?"eye-open":"eye-close"}`})," ",i]}),w&&e("div",{class:"post-peek-html",children:[d&&e(z,{children:[e("span",{class:"post-peek-tag post-peek-thread",children:e(u,{id:"e66y2Z"})})," "]}),!!o&&e("div",{dangerouslySetInnerHTML:{__html:Bo(o,a)}}),!!((_=h==null?void 0:h.options)!=null&&_.length)&&h.options.map(C=>e("div",{children:[h.multiple?"â–ªï¸":"â€¢"," ",C.title]})),!o&&(r==null?void 0:r.length)===1&&r[0].description&&e(z,{children:[e("span",{class:"post-peek-tag post-peek-alt",children:"ALT"})," ",e("div",{children:r[0].description})]})]})]})]}),!n&&e("span",{class:"post-peek-post-content",children:[!!h&&e("span",{class:"post-peek-tag post-peek-poll",children:[e(S,{icon:"poll",size:"s"}),e(u,{id:"4WUbF1"})]}),r!=null&&r.length?r.map(C=>{var M,P,N,V,G,X,j,U,Y,ie;const I=C.previewUrl||C.url,T=C.previewRemoteUrl||C.remoteUrl,k=(M=C.meta)!=null&&M.original?C.meta.original.width:((N=(P=C.meta)==null?void 0:P.small)==null?void 0:N.width)||((G=(V=C.meta)==null?void 0:V.original)==null?void 0:G.width),A=(X=C.meta)!=null&&X.original?C.meta.original.height:((U=(j=C.meta)==null?void 0:j.small)==null?void 0:U.height)||((ie=(Y=C.meta)==null?void 0:Y.original)==null?void 0:ie.height);return e("span",{class:"post-peek-media",children:{image:(I||T)&&b?e("img",{src:I,width:Ct,height:Ct,alt:C.description,loading:"lazy",onError:$=>{const{src:F}=$.target;F===I&&($.target.src=T)},style:{"--anim-duration":`${Math.min(Math.max(Math.max(k,A)/100,5),120)}s`}}):e("span",{class:"post-peek-faux-media",children:"ðŸ–¼"}),gifv:(I||T)&&b?e("img",{src:I,width:Ct,height:Ct,alt:C.description,loading:"lazy",onError:$=>{const{src:F}=$.target;F===I&&($.target.src=T)}}):e("span",{class:"post-peek-faux-media",children:"ðŸŽžï¸"}),video:(I||T)&&b?e("img",{src:I,width:Ct,height:Ct,alt:C.description,loading:"lazy",onError:$=>{const{src:F}=$.target;F===I&&($.target.src=T)}}):e("span",{class:"post-peek-faux-media",children:"ðŸ“¹"}),audio:e("span",{class:"post-peek-faux-media",children:"ðŸŽµ"})}[C.type]||null},C.id)}):!!c&&c.image&&b&&e("span",{class:`post-peek-media post-peek-card card-${c.type||""}`,children:c.image?e("img",{src:c.image,width:Ct,height:Ct,alt:c.title||c.description||c.imageDescription,loading:"lazy",style:{"--anim-duration":c.width&&c.height&&`${Math.min(Math.max(Math.max(c.width,c.height)/100,5),120)}s`}}):e("span",{class:"post-peek-faux-media",children:"ðŸ”—"})})]})]})}function fr({post:t}){const{reblogsCount:n,repliesCount:i,favouritesCount:s}=t;return e("span",{class:"post-stats",children:[i>0&&e("span",{class:"post-stat-replies",children:[e(S,{icon:"comment2",size:"s",alt:g._({id:"N8UzTV"})})," ",Ke(i)]}),s>0&&e("span",{class:"post-stat-likes",children:[e(S,{icon:"heart",size:"s",alt:g._({id:"zZOZj7"})})," ",Ke(s)]}),n>0&&e("span",{class:"post-stat-boosts",children:[e(S,{icon:"rocket",size:"s",alt:g._({id:"puY2t0"})})," ",Ke(n)]})]})}function pr(t,n,i){const s=t.map(c=>new Date(c[n])),o=s.reduce((c,l)=>l<c?l:c,s[0]),h=s.reduce((c,l)=>l>c?l:c,s[0]).getTime()-o.getTime(),r=Array.from({length:i},()=>[]);return t.forEach(c=>{const p=(new Date(c[n]).getTime()-o.getTime())/h,f=Math.floor(p*(i-1));r[f].push(c)}),r}const mr=20;function Bs(){Xe(g._({id:"zZOZj7"}),"/favourites");const{masto:t,instance:n}=ae(),i=q();async function s(o){return(o||!i.current)&&(i.current=t.v1.favourites.list({limit:mr})),await i.current.next()}return e(St,{title:g._({id:"zZOZj7"}),id:"favourites",emptyText:g._({id:"PHIrMr"}),errorText:g._({id:"khVljG"}),instance:n,fetchItems:s})}const gr=["home","public","notifications","thread","account"],Gi=["notifications","thread","account"],br={home:{id:"Buy2bt"},notifications:{id:"iDNBZe"},public:{id:"RO10dm"},thread:{id:"EnJuK0"},account:{id:"vrQQgz"}},yr=[0,30*60,60*60,6*60*60,12*60*60,60*60*24,60*60*24*7,60*60*24*30],Hn={0:{id:"qqeAJM"},1800:tt(30,"minute"),3600:tt(1,"hour"),21600:tt(6,"hour"),43200:tt(12,"hour"),86400:tt(24,"hour"),604800:tt(7,"day"),2592e3:tt(30,"day")};function vr(){const{masto:t}=ae();Xe(g._({id:"cSev+j"}),"/ft");const[n,i]=L("default"),[s,o]=L(!1),[a,h]=$t(l=>l+1,0),[r,c]=L([]);return se(()=>{i("loading"),(async()=>{try{const l=await t.v2.filters.list();l.sort((p,f)=>p.title.localeCompare(f.title)),l.forEach(p=>{var f;(f=p.keywords)!=null&&f.length&&p.keywords.sort((m,d)=>m.id-d.id)}),c(l),i("default")}catch{i("error")}})()},[a]),e("div",{id:"filters-page",class:"deck-container",tabIndex:"-1",children:[e("div",{class:"timeline-deck deck",children:[e("header",{children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Dt,{}),e(he,{to:"/",class:"button plain",children:e(S,{icon:"home",size:"l",alt:g._({id:"i0qMbr"})})})]}),e("h1",{children:e(u,{id:"cSev+j"})}),e("div",{class:"header-side",children:e("button",{type:"button",class:"plain",onClick:()=>{o(!0)},children:e(S,{icon:"plus",size:"l",alt:g._({id:"yFfBdX"})})})})]})}),e("main",{children:r.length>0?e(z,{children:[e("ul",{class:"filters-list",children:r.map(l=>{const{id:p,title:f,expiresAt:m,keywords:d}=l;return e("li",{children:[e("div",{children:[e("h2",{children:f}),(d==null?void 0:d.length)>0&&e("div",{children:d.map(y=>e(z,{children:[e("span",{class:"tag collapsed insignificant",children:y.wholeWord?`â€œ${y.keyword}â€`:y.keyword})," "]}))}),e("small",{class:"insignificant",children:e(Fs,{expiresAt:m})})]}),e("button",{type:"button",class:"plain",onClick:()=>{o({filter:l})},children:e(S,{icon:"pencil",size:"l",alt:"Edit filter"})})]},p)})}),r.length>1&&e("footer",{class:"ui-state",children:e("small",{class:"insignificant",children:e(u,{id:"5vzJxv",values:{0:r.length}})})})]}):n==="loading"?e("p",{class:"ui-state",children:e(De,{})}):n==="error"?e("p",{class:"ui-state",children:e(u,{id:"qcAUwp"})}):e("p",{class:"ui-state",children:e(u,{id:"cWIHTt"})})})]}),!!s&&e(Fe,{title:g._({id:"vCSBPD"}),onClose:()=>{o(!1)},children:e(kr,{filter:s==null?void 0:s.filter,onClose:l=>{l.state==="success"&&h(),o(!1)}})})]})}let wr=1;const _r=()=>wr++;function kr({filter:t,onClose:n}){const{_:i}=Qe(),{masto:s}=ae(),[o,a]=L("default"),h=!!t,{context:r,expiresAt:c,id:l,keywords:p,title:f,filterAction:m}=t||{},d=!!c,y=d&&new Date(c),[b,v]=L(p||[]),w=q(),[_,C]=L([]),[I,T]=L([]),k=b.filter(A=>!_.includes(A.id)&&!I.includes(A._id));return e("div",{class:"sheet",id:"filters-add-edit-modal",children:[!!n&&e("button",{type:"button",class:"sheet-close",onClick:n,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:h?g._({id:"3mOee6"}):g._({id:"yFfBdX"})})}),e("main",{children:e("form",{onSubmit:A=>{A.preventDefault();const M=new FormData(A.target),P=M.get("title"),N=M.getAll("keyword_attributes[][id]"),V=M.getAll("keyword_attributes[][keyword]"),G=[...w.current.querySelectorAll('input[name="keyword_attributes[][whole_word]"]')].map(ie=>ie.checked),X=V.map((ie,$)=>({id:N[$]||void 0,keyword:ie,wholeWord:G[$]}));h&&(_!=null&&_.length)&&_.forEach(ie=>{X.push({id:ie,_destroy:!0})});const j=M.getAll("context");let U=M.get("expires_in");const Y=M.get("filter_action");!P||!(j!=null&&j.length)||(a("loading"),(async()=>{try{let ie;h?(U===""||U===null?d?U=Math.floor((y-new Date)/1e3):U=null:U==="0"||U===0?U=null:U=+U,ie=await s.v2.filters.$select(l).update({title:P,context:j,expiresIn:U,keywordsAttributes:X,filterAction:Y})):(U=+U||null,ie=await s.v2.filters.create({title:P,context:j,expiresIn:U,keywordsAttributes:X,filterAction:Y})),a("default"),n==null||n({state:"success",filter:ie})}catch{a("error"),alert(h?g._({id:"H8RP+h"}):g._({id:"Fr0hAN"}))}})())},children:[e("div",{class:"filter-form-row",children:e("label",{children:[e("b",{children:e(u,{id:"MHrjPM"})}),e("input",{type:"text",name:"title",defaultValue:f,disabled:o==="loading",dir:"auto",required:!0})]})}),e("div",{class:"filter-form-keywords",ref:w,children:[k.length?e("ul",{class:"filter-keywords",children:k.map(A=>{const{id:M,keyword:P,wholeWord:N,_id:V}=A;return e("li",{children:[e("input",{type:"hidden",name:"keyword_attributes[][id]",value:M}),e("input",{name:"keyword_attributes[][keyword]",type:"text",defaultValue:P,disabled:o==="loading",required:!0,dir:"auto"}),e("div",{class:"filter-keyword-actions",children:[e("label",{children:[e("input",{name:"keyword_attributes[][whole_word]",type:"checkbox",value:M,defaultChecked:N,disabled:o==="loading"})," ",e(u,{id:"/7UQ7y"})]}),e("button",{type:"button",class:"light danger small",disabled:o==="loading",onClick:()=>{M?(_.push(M),C([..._])):V&&(I.push(V),T([...I]))},children:e(S,{icon:"x",alt:g._({id:"t/YqKh"})})})]})]},`${M}-${V}`)})}):e("div",{class:"filter-keywords",children:e("div",{class:"insignificant",children:e(u,{id:"SYKm3p"})})}),e("footer",{class:"filter-keywords-footer",children:[e("button",{type:"button",class:"light",onClick:()=>{v([...b,{_id:_r(),keyword:"",wholeWord:!0}]),setTimeout(()=>{var M,P;const A=w.current.querySelectorAll('input[type="text"]');(P=(M=A[A.length-1])==null?void 0:M.focus)==null||P.call(M)},10)},children:e(u,{id:"qn5Dbn"})})," ",(k==null?void 0:k.length)>1&&e("small",{class:"insignificant",children:e(u,{id:"1JZ175",values:{0:k.length}})})]})]}),e("div",{class:"filter-form-cols",children:[e("div",{class:"filter-form-col",children:[e("div",{children:e("b",{children:e(u,{id:"uqf7Yq"})})}),gr.map(A=>e("div",{children:[e("label",{class:Gi.includes(A)?"insignificant":"",children:[e("input",{type:"checkbox",name:"context",value:A,defaultChecked:r?r.includes(A):!0,disabled:o==="loading"})," ",i(br[A]),Gi.includes(A)?"*":""]})," "]})),e("p",{children:e("small",{class:"insignificant",children:e(u,{id:"m0G499"})})})]}),e("div",{class:"filter-form-col",children:[h&&e(u,{id:"ucJk3m",components:{0:e("b",{}),1:e(Fs,{expiresAt:c,showNeverExpires:!0})}}),e("div",{children:[e("label",{for:"filters-expires_in",children:h?g._({id:"BcNdg+"}):g._({id:"agO/T/"})}),e("select",{id:"filters-expires_in",name:"expires_in",disabled:o==="loading",defaultValue:h?void 0:0,children:[h&&e("option",{}),yr.map(A=>e("option",{value:A,children:typeof Hn[A]=="function"?Hn[A]():i(Hn[A])}))]})]}),e("p",{children:[e(u,{id:"blQMpa"}),e("br",{}),e("label",{class:"ib",children:[e("input",{type:"radio",name:"filter_action",value:"warn",defaultChecked:m==="warn"||!h,disabled:o==="loading"})," ",e(u,{id:"jbreWy"})]})," ",e("label",{class:"ib",children:[e("input",{type:"radio",name:"filter_action",value:"hide",defaultChecked:m==="hide",disabled:o==="loading"})," ",e(u,{id:"zNCBmf"})]})]})]})]}),e("footer",{class:"filter-form-footer",children:[e("span",{children:[e("button",{type:"submit",disabled:o==="loading",children:h?g._({id:"tfDRzk"}):g._({id:"hYgDIe"})})," ",e(De,{abrupt:!0,hidden:o!=="loading"})]}),h&&e(lt,{disabled:o==="loading",align:"end",menuItemClassName:"danger",confirmLabel:g._({id:"BPjyR2"}),onClick:()=>{a("loading"),(async()=>{try{await s.v2.filters.$select(l).remove(),a("default"),n==null||n({state:"success"})}catch{a("error"),alert(g._({id:"4Dh9J1"}))}})()},children:e("button",{type:"button",class:"light danger",onClick:()=>{},disabled:o==="loading",children:e(u,{id:"Jb6/SB"})})})]})]})})]})}function Fs({expiresAt:t,showNeverExpires:n}){const i=!!t,s=i&&new Date(t),o=i&&s<=new Date,[a,h]=$t(r=>r+1,0);return ii(h,o||3e4),o?g._({id:"M1RnFv"}):i?e(u,{id:"urGtsw",components:{0:e(Kt,{datetime:s})}}):n&&g._({id:"O1Aswy"})}function Sr(){const{masto:t,instance:n}=ae();Xe(g._({id:"Xi1/bw"}),"/fh");const[i,s]=L("default"),[o,a]=L([]);return se(()=>{s("loading"),(async()=>{try{const h=await Sn();a(h),s("default")}catch{s("error")}})()},[]),e("div",{id:"followed-hashtags-page",class:"deck-container",tabIndex:"-1",children:e("div",{class:"timeline-deck deck",children:[e("header",{children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Dt,{}),e(he,{to:"/",class:"button plain",children:e(S,{icon:"home",size:"l",alt:g._({id:"i0qMbr"})})})]}),e("h1",{children:e(u,{id:"Xi1/bw"})}),e("div",{class:"header-side"})]})}),e("main",{children:o.length>0?e(z,{children:[e("ul",{class:"link-list",children:o.map(h=>e("li",{children:e(he,{to:n?`/${n}/t/${h.name}`:`/t/${h.name}`,children:[e(S,{icon:"hashtag",alt:"#"})," ",e("span",{children:h.name})]})}))}),o.length>1&&e("footer",{class:"ui-state",children:e("small",{class:"insignificant",children:e(u,{id:"2S/uvJ",values:{0:o.length}})})})]}):i==="loading"?e("p",{class:"ui-state",children:e(De,{abrupt:!0})}):i==="error"?e("p",{class:"ui-state",children:e(u,{id:"2AeREO"})}):e("p",{class:"ui-state",children:e(u,{id:"vKsGhk"})})})]})})}const Cr=20;function wi({title:t,path:n,id:i,...s}){Xe(t||g._({id:"following.title"}),n||"/following");const{masto:o,streaming:a,instance:h}=ae(),r=Ye(x),c=q(),l=q();__BENCHMARK.end("time-to-following");const p=Ze("@pixelfed/home-include-reblogs");async function f(d){var v;(d||!c.current)&&(__BENCHMARK.start("fetch-home-first"),c.current=o.v1.timelines.home.list({limit:Cr})),p&&((v=c.current)!=null&&v.nextParams)&&(typeof c.current.nextParams=="string"?c.current.nextParams+="&include_reblogs=true":c.current.nextParams.include_reblogs=!0);const y=await c.current.next();let{value:b}=y;if(b!=null&&b.length){let w=!1;d&&(b[0].id!==l.current&&(w=!0),l.current=b[0].id),b.forEach(_=>{We(_,h)}),b=Yi(b,h),d&&w&&Ua(),zs(b,h),b.sort((_,C)=>{const I=new Date(_.createdAt);return new Date(C.createdAt)-I})}return __BENCHMARK.end("fetch-home-first"),{...y,value:b}}async function m(){var d;try{const y={limit:5,since_id:l.current};Ze("@pixelfed/home-include-reblogs")&&(y.include_reblogs=!0);const b=await o.v1.timelines.home.list(y).next();let{value:v}=b;const w=((d=v[0])==null?void 0:d.id)===l.current;return!!(v!=null&&v.length&&!w&&(l.current=v[0].id,v=Yi(v,h),v=Rt(v,"home"),v.some(_=>!_.reblog)))}catch{return!1}}return se(()=>{let d;return(async()=>{if(a){d=a.user.subscribe();for await(const y of d){if(!d)break;if(y.event==="status.update"){const b=y.payload;We(b,h)}else if(y.event==="delete"){const b=y.payload,v=ds(b,h);v&&(v._deleted=!0)}}}})(),()=>{var y;(y=d==null?void 0:d.unsubscribe)==null||y.call(d),d=null}},[a]),e(St,{title:t||g._({id:"following.title"}),id:i||"following",emptyText:g._({id:"nJEKbY"}),errorText:g._({id:"7QSeK6"}),instance:h,fetchItems:f,checkForUpdates:m,useItemID:!0,boostsCarousel:r.settings.boostsCarousel,...s,filterContext:"home",showFollowedTags:!0,showReplyParent:!0})}const Ir=20,Tr=4,Ki=Tr+1;function Hs({media:t,columnMode:n,...i}){let{hashtag:s,...o}=n?{}:Mt();i.hashtag&&(s=i.hashtag);let a=s.trim().split(/[\s+]+/);a.sort(),s=a[0];const[h,r]=ft(),c=t||!!h.get("media"),l=c?"?media=1":"",{masto:p,instance:f,authenticated:m}=ae({instance:(i==null?void 0:i.instance)||o.instance}),{masto:d,instance:y,authenticated:b}=ae(),v=a.map($=>`#${$}`).join(" "),w=f?c?g._({id:"kH0rA0",values:{hashtagTitle:v,instance:f}}):g._({id:"IK0zKi",values:{hashtagTitle:v,instance:f}}):c?g._({id:"hHSI3w",values:{hashtagTitle:v}}):g._({id:"+ZzjRY",values:{hashtagTitle:v}});Xe(w,"/:instance?/t/:hashtag");const _=q(),C=ke(()=>ti(),[]),I=q(void 0);async function T($){const F=await p.v1.timelines.tag.$select(s).list({limit:Ir,any:a.slice(1),maxId:$?void 0:I.current,onlyMedia:c?!0:void 0}).next();let{value:B}=F;return B!=null&&B.length&&($&&(_.current=B[0].id),B.forEach(K=>{We(K,f,{skipThreading:c||C})}),I.current=B[B.length-1].id),{...F,value:B}}async function k(){var $;try{const F=await p.v1.timelines.tag.$select(s).list({limit:1,any:a.slice(1),since_id:_.current,onlyMedia:c}).next();let{value:B}=F;const K=(($=B[0])==null?void 0:$.id)===_.current;return B!=null&&B.length&&!K?(B=Rt(B,"public"),!0):!1}catch{return!1}}const[A,M]=L("default"),[P,N]=L();se(()=>{(async()=>{try{const $=await p.v1.tags.$select(s).fetch();N($)}catch{}})()},[s]);const V=a.length>=Ki,[G,X]=L("default"),[j,U]=L([]),[Y,ie]=L(!1);return se(()=>{m&&(async()=>{try{const $=await p.v1.featuredTags.list();U($),ie($.some(F=>F.name.toLowerCase()===s.toLowerCase()))}catch{}})()},[]),e(St,{title:w,titleComponent:!!f&&e("h1",{class:"header-double-lines",children:[e("b",{dir:"auto",children:v}),e("div",{children:f})]}),id:"hashtag",instance:f,emptyText:g._({id:"CNSLAW"}),errorText:g._({id:"yjj6Ll"}),fetchItems:T,checkForUpdates:k,useItemID:!0,view:c||C?"media":void 0,refresh:c,filterContext:"public",headerEnd:e(at,{portal:!0,setDownOverflow:!0,overflow:"auto",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(S,{icon:"more",size:"l",alt:g._({id:"2FYpfJ"})})}),children:[!!P&&a.length===1&&e(z,{children:[e(lt,{subMenu:!0,confirm:P.following,confirmLabel:g._({id:"ctJi7k",values:{hashtag:s}}),disabled:A==="loading"||!m,onClick:()=>{M("loading"),P.following?p.v1.tags.$select(s).unfollow().then(()=>{N({...P,following:!1}),ue(g._({id:"doK/ij",values:{hashtag:s}}))}).catch($=>{alert($)}).finally(()=>{M("default")}):p.v1.tags.$select(s).follow().then(()=>{N({...P,following:!0}),ue(g._({id:"R9+aEN",values:{hashtag:s}}))}).catch($=>{alert($)}).finally(()=>{M("default")})},children:P.following?e(z,{children:[e(S,{icon:"check-circle"})," ",e("span",{children:e(u,{id:"HOSk7R"})})]}):e(z,{children:[e(S,{icon:"plus"})," ",e("span",{children:e(u,{id:"MKEPCY"})})]})}),e(_e,{type:"checkbox",checked:Y,disabled:G==="loading"||!m,onClick:()=>{if(X("loading"),Y){const $=j.find(F=>F.name.toLowerCase()===s.toLowerCase()).id;$?p.v1.featuredTags.$select($).remove().then(()=>{ie(!1),ue(g._({id:"VH+Tf9"})),U(j.filter(F=>F.id!==$))}).catch(F=>{}).finally(()=>{X("default")}):ue(g._({id:"3OLv47"}))}else p.v1.featuredTags.create({name:s}).then($=>{ie(!0),ue(g._({id:"9ra4hn"})),U(j.concat($))}).catch($=>{}).finally(()=>{X("default")})},children:Y?e(z,{children:[e(S,{icon:"check-circle"}),e("span",{children:e(u,{id:"9ra4hn"})})]}):e(z,{children:[e(S,{icon:"check-circle"}),e("span",{children:e(u,{id:"UlJ3QN"})})]})}),e(Ge,{})]}),!C&&e(z,{children:[e(vs,{className:"plain",children:e(u,{id:"cSev+j"})}),e(_e,{type:"checkbox",checked:!!c,onClick:()=>{c?h.delete("media"):h.set("media","1"),r(h)},children:[e(S,{icon:"check-circle",alt:"â˜‘ï¸"})," ",e("span",{class:"menu-grow",children:e(u,{id:"eK4SL/"})})]}),e(Ge,{})]}),e(Fo,{className:"menu-field",disabled:V,children:({ref:$})=>e("form",{onSubmit:F=>{var K,de;F.preventDefault();const B=(de=(K=F.target[0].value)==null?void 0:K.trim)==null?void 0:de.call(K);B&&!a.some(te=>te.toLowerCase()===B.toLowerCase())&&(a.push(B),a.sort(),location.hash=f?`/${f}/t/${a.join("+")}`:`/t/${a.join("+")}${l}`)},children:[e(S,{icon:"hashtag"}),e("input",{ref:$,type:"text",placeholder:V?g._({id:"ouWc/D",values:{TOTAL_TAGS_LIMIT:Ki}}):g._({id:"cxL5F9"}),required:!0,autocorrect:"off",autocapitalize:"off",spellCheck:!1,pattern:"[^#][^\\s#]+[^#]",disabled:V,dir:"auto"})]})}),e(Ho,{takeOverflow:!0,children:a.map(($,F)=>e(_e,{disabled:a.length===1,onClick:B=>{a.splice(F,1),a.sort(),location.hash=f?`/${f}/t/${a.join("+")}${l}`:`/t/${a.join("+")}${l}`},children:[e(S,{icon:"x",alt:g._({id:"OISAkj"}),class:"danger-icon"}),e("span",{class:"bidi-isolate",children:[e("span",{class:"more-insignificant",children:"#"}),$]})]},$))}),e(Ge,{}),e(_e,{disabled:!b,onClick:()=>{if(x.shortcuts.length>=vt){alert(g._({id:"XN1xAY",values:{SHORTCUTS_LIMIT:vt}}));return}const $={type:"hashtag",hashtag:a.join(" "),instance:f,media:c?"on":void 0};x.shortcuts.some(B=>B.type===$.type&&B.hashtag.split(/[\s+]+/).sort().join(" ")===$.hashtag.split(/[\s+]+/).sort().join(" ")&&(B.instance?B.instance===$.instance:!0)&&(B.media?!!B.media==!!$.media:!0))?alert(g._({id:"kfeQnS"})):(x.shortcuts.push($),ue(g._({id:"MIhb91"})))},children:[e(S,{icon:"shortcut"})," ",e("span",{children:e(u,{id:"i02Lq/"})})]}),e(_e,{onClick:()=>{let $=prompt(g._({id:"2MQ2cd"}));if(!/\./.test($)){$&&alert(g._({id:"7WddtO"}));return}$&&($=$.toLowerCase().trim(),location.hash=`/${$}/t/${a.join("+")}${l}`)},children:[e(S,{icon:"bus"})," ",e("span",{children:e(u,{id:"Sq04Yc"})})]}),y!==f&&e(_e,{onClick:()=>{location.hash=`/${y}/t/${a.join("+")}${l}`},children:[e(S,{icon:"bus"})," ",e("small",{class:"menu-double-lines",children:e(u,{id:"iAzCp4",values:{currentInstance:y},components:{0:e("b",{})}})})]})]})},f+v)}const Ar=20;function Ys(t){var w;const n=Ye(x),{masto:i,instance:s}=ae(),o=(t==null?void 0:t.id)||((w=Mt())==null?void 0:w.id),a=q(),h=q();async function r(_){(_||!h.current)&&(h.current=i.v1.timelines.list.$select(o).list({limit:Ar}));const C=await h.current.next();let{value:I}=C;return I!=null&&I.length&&(_&&(a.current=I[0].id),I.forEach(T=>{We(T,s)})),{...C,value:I}}async function c(){var _;try{const C=await i.v1.timelines.list.$select(o).list({limit:1,since_id:a.current});let{value:I}=C;const T=((_=I[0])==null?void 0:_.id)===a.current;return I!=null&&I.length&&!T?(I=Rt(I,"home"),!0):!1}catch{return!1}}const[l,p]=L([]);se(()=>{on().then(p)},[]);const[f,m]=L({title:"List"});Xe(f.title,"/l/:id"),se(()=>{(async()=>{try{const _=await Rs(o);m(_)}catch{}})()},[o]);const[d,y]=L(!1),[b,v]=L(!1);return e(z,{children:[e(St,{title:f.title,id:"list",emptyText:g._({id:"KkDhfU"}),errorText:g._({id:"7QSeK6"}),instance:s,fetchItems:r,checkForUpdates:c,useItemID:!0,boostsCarousel:n.settings.boostsCarousel,filterContext:"home",showReplyParent:!0,headerStart:e(at,{overflow:"auto",menuButton:e("button",{type:"button",class:"plain",children:[e(S,{icon:"list",size:"l",alt:g._({id:"h16FyT"})}),e(S,{icon:"chevron-down",size:"s"})]}),children:[e(Be,{to:"/l",children:e("span",{children:e(u,{id:"BHWx+g"})})}),(l==null?void 0:l.length)>0&&e(z,{children:[e(Ge,{}),l.map(_=>e(Be,{to:`/l/${_.id}`,children:e("span",{children:_.title})},_.id))]})]}),headerEnd:e(at,{portal:!0,setDownOverflow:!0,overflow:"auto",viewScroll:"close",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(S,{icon:"more",size:"l",alt:g._({id:"2FYpfJ"})})}),children:[e(_e,{onClick:()=>y({list:f}),children:[e(S,{icon:"pencil",size:"l"}),e("span",{children:e(u,{id:"ePK91l"})})]}),e(_e,{onClick:()=>v(!0),children:[e(S,{icon:"group",size:"l"}),e("span",{children:e(u,{id:"hB02vO"})})]})]})},o),d&&e(Fe,{onClick:_=>{_.target===_.currentTarget&&y(!1)},children:e(mi,{list:d==null?void 0:d.list,onClose:_=>{_.state==="success"&&_.list?m(_.list):_.state==="deleted"&&(location.hash="/l"),y(!1)}})}),b&&e(Fe,{onClick:_=>{_.target===_.currentTarget&&v(!1)},children:e(Er,{listID:o,onClose:()=>v(!1)})})]})}const xr=40;function Er({listID:t,onClose:n}){const{masto:i,instance:s}=ae(),[o,a]=L([]),[h,r]=L("default"),[c,l]=L(!1),p=q();async function f(m){l(!1),r("loading"),(async()=>{try{(m||!p.current)&&(p.current=i.v1.lists.$select(t).accounts.list({limit:xr}));const d=await p.current.next();let{done:y,value:b}=d;b!=null&&b.length?(a(m?b:o.concat(b)),l(!y)):l(!1),r("default")}catch{r("error")}})()}return se(()=>{f(!0)},[]),e("div",{class:"sheet",id:"list-manage-members-container",children:[!!n&&e("button",{type:"button",class:"sheet-close",onClick:n,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(u,{id:"hB02vO"})})}),e("main",{children:e("ul",{children:[o.map(m=>e("li",{children:[e(rt,{account:m,instance:s}),e(Rr,{account:m,listID:t})]},m.id)),c&&h==="default"&&e(_t,{as:"li",onChange:m=>m&&f(),children:e("button",{type:"button",class:"light block",onClick:f,children:e(u,{id:"uXRAkV"})})})]})})]})}function Rr({account:t,listID:n}){const{masto:i}=ae(),[s,o]=L("default"),[a,h]=L(!1);return e(lt,{confirm:!a,confirmLabel:e("span",{children:e(u,{id:"j5n9Ry",values:{0:t.username},components:{0:e("span",{class:"bidi-isolate"})}})}),align:"end",menuItemClassName:"danger",onClick:()=>{a?(o("loading"),(async()=>{try{await i.v1.lists.$select(n).accounts.create({accountIds:[t.id]}),o("default"),h(!1)}catch{o("error")}})()):(o("loading"),(async()=>{try{await i.v1.lists.$select(n).accounts.remove({accountIds:[t.id]}),o("default"),h(!0)}catch{o("error")}})())},children:e("button",{type:"button",class:`light ${a?"":"danger"}`,disabled:s==="loading",children:a?g._({id:"m16xKo"}):g._({id:"MWIaew"})})})}const Lr={mention:["account","status"],status:["account","status"],reblog:["account","status"],follow:["account"],follow_request:["account"],favourite:["account","status"],poll:["status"],update:["status"]},$r=["favourite","reblog","follow"],qs=t=>$r.includes(t);function js(t){return t.filter(n=>{const{type:i,id:s,createdAt:o}=n;if(!i)return!1;const a=Lr[i];return a!=null&&a.length?a.every(h=>!!n[h]):!0})}function Vs(t){if(t!=null&&t.notificationGroups){const{accounts:n=[],notificationGroups:i=[],statuses:s=[]}=t;return i.map(o=>{const{sampleAccountIds:a,statusId:h}=o,r=(a==null?void 0:a.map(l=>n.find(p=>p.id===l)))||[],c=(s==null?void 0:s.find(l=>l.id===h))||null;return{...o,sampleAccounts:r,status:c}})}return t}function Mr(t){const n=t.map(h=>{const{latestPageNotificationAt:r,mostRecentNotificationId:c,sampleAccounts:l,notificationsCount:p}=h;return{id:""+c,createdAt:r,account:l[0],...h}}),i={},s=[];for(let h=0;h<n.length;h++){const r=n[h],{type:c,status:l,createdAt:p,notificationsCount:f,sampleAccounts:m,groupKey:d}=r,y=p?new Date(p).toLocaleDateString():"";let b=c;f>0&&(m==null||m.length),(c==="favourite"||c==="reblog")&&(b="favourite+reblog");const v=`${l==null?void 0:l.id}-${b}-${y}`,w=i[v];if(!qs(c))s.push(r);else if(w)m.forEach(_=>{const C=w.sampleAccounts.find(I=>I.id===_.id);C?(C._types.push(c),C._types.sort().reverse()):w.sampleAccounts.push({..._,_types:[c]})}),w.notificationsCount=Math.min(w.notificationsCount,f),w._notificationsCount.push(f),w._accounts=w.sampleAccounts,w._groupKeys.push(d);else{const _=m.map(C=>({...C,_types:[c]}));i[v]={...r,sampleAccounts:_,type:b,_accounts:_,_groupKeys:d?[d]:[],_notificationsCount:[f]},s.push(i[v])}}const o={},a=[];for(let h=0;h<s.length;h++){const r=s[h],{type:c,account:l,_accounts:p,sampleAccounts:f,createdAt:m,groupKey:d}=r,y=m?new Date(m).toLocaleDateString():"",b=(f==null?void 0:f.length)===1||(p==null?void 0:p.length)===1;if((c==="favourite"||c==="reblog"||c==="favourite+reblog")&&b){const v=`${l==null?void 0:l.id}-${c}-${y}`,w=o[v];if(w)w._statuses.push(r.status),w._ids+=`-${r.id}`,w._groupKeys.push(d);else{let _=o[v]={...r,type:c,_ids:r.id,_statuses:[r.status],_groupKeys:d?[d]:[]};a.push(_)}}else a.push(r)}return a}function Nr(t){t=js(t);const n={},i=[];for(let a=0,h=0;a<t.length;a++){const r=t[a],{id:c,status:l,account:p,type:f,createdAt:m}=r,d=m?new Date(m).toLocaleDateString():"";let y=f;(f==="favourite"||f==="reblog")&&(y="favourite+reblog");const b=`${l==null?void 0:l.id}-${y}-${d}`,v=n[b];if(!qs(f))i[h++]=r;else if(v!=null&&v.account){const w=v._accounts.find(_=>_.id===p.id);w?(w._types.push(f),w._types.sort().reverse(),v._ids+=`-${c}`):(p._types=[f],v._accounts.push(p),v._ids+=`-${c}`)}else{p&&(p._types=[f]);let w=n[b]={...r,type:y,_ids:c,_accounts:p?[p]:[]};i[h++]=w}}const s={},o=[];for(let a=0,h=0;a<i.length;a++){const r=i[a],{id:c,account:l,_accounts:p,type:f,createdAt:m}=r,d=m?new Date(m).toLocaleDateString():"";if(f==="favourite+reblog"&&l&&p.length===1){const y=`${l==null?void 0:l.id}-${f}-${d}`,b=s[y];if(b)b._statuses.push(r.status),b._ids+=`-${c}`;else{let v=s[y]={...r,type:f,_ids:c,_statuses:[r.status]};o[h++]=v}}else o[h++]=r}return o}const Wi=20,Pr=new URLSearchParams;function Gs({columnMode:t,...n}){const{masto:i,instance:s}=ae(),[o]=t?[Pr]:ft(),[a,h]=L(null),r=(n==null?void 0:n.type)||o.get("type")||a;Xe(r==="private"?g._({id:"2BApYc"}):g._({id:"/bZzdR"}),"/mentions");const c=q(),l=q();async function p(w){(w||!c.current)&&(c.current=i.v1.notifications.list({limit:Wi,types:["mention"]}));const _=await c.current.next();let{value:C}=_;return C!=null&&C.length&&(C=js(C),w&&(l.current=C[0].id),C.forEach(({status:I})=>{We(I,s)})),{..._,value:C==null?void 0:C.map(I=>I.status)}}const f=q(),m=q();async function d(w){(w||!f.current)&&(f.current=i.v1.conversations.list({limit:Wi}));const _=await f.current.next();let{value:C}=_;return C=C==null?void 0:C.filter(I=>I.lastStatus),C!=null&&C.length&&(w&&(m.current=C[0].lastStatus.id),C.forEach(({lastStatus:I})=>{We(I,s)})),{..._,value:C==null?void 0:C.map(I=>I.lastStatus)}}function y(...w){return r==="private"?d(...w):p(...w)}async function b(){var w;if(r==="private")try{const _=await i.v1.conversations.list({limit:1,since_id:m.current}).next();let{value:C}=_;const I=((w=C[0])==null?void 0:w.id)===m.current;return C!=null&&C.length&&!I?(m.current=C[0].lastStatus.id,!0):!1}catch{return!1}else try{const _=await i.v1.notifications.list({limit:1,types:["mention"],since_id:l.current}).next();let{value:C}=_;return C!=null&&C.length?(l.current=C[0].id,!0):!1}catch{return!1}}const v=ke(()=>e("div",{class:"filter-bar centered",children:[e(he,{to:"/mentions",class:r?"":"is-active",onClick:w=>{t&&(w.preventDefault(),h(null))},children:e(u,{id:"N40H+G"})}),e(he,{to:"/mentions?type=private",class:r==="private"?"is-active":"",onClick:w=>{t&&(w.preventDefault(),h("private"))},children:e(u,{id:"zwBp5t"})})]}),[r]);return e(St,{title:g._({id:"/bZzdR"}),id:"mentions",emptyText:g._({id:"03jFGT"}),errorText:g._({id:"pqR9KF"}),instance:s,fetchItems:y,checkForUpdates:b,useItemID:!0,timelineStart:v,refresh:r})}const Dr=80,Or=20,zr=new URLSearchParams,rn={block:"center",inline:"center",behavior:"smooth"},Ks=ls(()=>Ze("@mastodon/grouped-notifications"),{maxAge:1e3*60*5});function Ws(t={}){const{masto:n}=ae();return x.settings.groupedNotificationsAlpha&&Ks()?n.v2.notifications.list({limit:Or,...t}):n.v1.notifications.list({limit:Dr,...t})}function Zs(t){return x.settings.groupedNotificationsAlpha&&Ks()?Mr(t):Nr(t)}const Ur=["forNotFollowing","forNotFollowers","forNewAccounts","forPrivateMentions","forLimitedAccounts"],Br={forNotFollowing:{id:"d+hDoa"},forNotFollowers:{id:"oAwuQj"},forNewAccounts:{id:"Srs8u7"},forPrivateMentions:{id:"IDC5Uw"},forLimitedAccounts:{id:"XMGM2e"}};function Fr({columnMode:t}){var D;const{_:n}=Qe();Xe(g._({id:"iDNBZe"}),"/notifications");const{masto:i,instance:s}=ae(),o=Ye(x),[a,h]=L("default"),[r]=t?[zr]:ft(),c=r.get("id"),l=r.get("access_token"),[p,f]=L(!1),[m,d]=L(!1),y=q(),{nearReachEnd:b,scrollDirection:v,reachStart:w,nearReachStart:_}=Ba({scrollableRef:y}),C=v==="end"&&!_,[I,T]=L([]),[k,A]=L([]),M=q();async function P(E){var we;if((E||!M.current)&&(M.current=Ws({excludeTypes:["follow_request"]})),/max_id=($|&)/i.test((we=M.current)==null?void 0:we.nextParams))return{done:!0};const O=await M.current.next(),re=Vs(O.value);if(re!=null&&re.length){re.forEach(J=>{We(J.status,s,{skipThreading:!0})});const Ie=Zs(re);E?(x.notificationsLast=Ie[0],x.notifications=Ie,i.v1.markers.create({notifications:{lastReadId:Ie[0].id}}).catch(()=>{})):x.notifications.push(...Ie)}return x.notificationsShowNew=!1,x.notificationsLastFetchTime=Date.now(),O}async function N(){try{return await i.v1.followRequests.list({limit:80})}catch{return[]}}const V=()=>{h("loading"),(async()=>{try{const E=await N();T(E),h("default")}catch{h("error")}})()};async function G(){try{return await i.v1.announcements.list()}catch{return[]}}const X=Ze("@mastodon/filtered-notifications"),[j,U]=L(!1),[Y,ie]=L({});function $(){return i.v2.notifications.policy.fetch().catch(()=>{})}function F(){$().then(E=>{ie(E)}).catch(()=>{})}const[B,K]=L(null);function de(){return i.v1.notifications.requests.list()}const te=E=>{ye(!1),h("loading"),(async()=>{try{const O=P(E);E&&(G().then(we=>{we.sort((Ie,J)=>{const $e=new Date(Ie.updatedAt||Ie.createdAt);return new Date(J.updatedAt||J.createdAt)-$e}),A(we)}).catch(()=>{}),N().then(we=>{T(we)}).catch(()=>{}),X&&F());const{done:re}=await O;f(!re),h("default")}catch{h("error")}})()};se(()=>{te(!0)},[]),se(()=>{w&&te(!0)},[w]);const[fe,ye]=L(!1),H=ct(({disableIdleCheck:E=!1}={})=>{var O;a!=="loading"&&o.settings.autoRefresh&&((O=y.current)==null?void 0:O.scrollTop)<16&&(E||window.__IDLE__)&&!Hr()&&te(!0)},[o.notificationsShowNew,o.settings.autoRefresh,a]),ce=q();Yt(E=>{if(E){const O=Date.now()-ce.current;!ce.current||O>1e3*3?H({disableIdleCheck:!0}):ce.current=Date.now()}});const Se=q(!0);se(()=>{let E=yo(x,"notificationsShowNew",O=>{if(Se.current){Se.current=!1;return}a!=="loading"&&(O&&H(),ye(O))});return()=>E==null?void 0:E()},[]);const Ee=new Date,Re=new Date(Ee-24*60*60*1e3);let Le=new Date;const Pe=!o.notifications.some(E=>new Date(E.createdAt).toDateString()===Ee.toDateString()),ve=q();se(()=>{c&&(x.routeNotification={id:c,accessToken:atob(l)})},[c,l]);const ee=".notification",ge=Ue("j",()=>{const E=document.activeElement.closest(ee),O=E==null?void 0:E.getBoundingClientRect(),re=Array.from(y.current.querySelectorAll(ee));if(E&&O.top<y.current.clientHeight&&O.bottom>0){const we=re.indexOf(E);let Ie=re[we+1];Ie&&(Ie.focus(),Ie.scrollIntoView(rn))}else{const we=re.find(Ie=>{const J=Ie.getBoundingClientRect();return J.top>=44&&J.left>=0});we&&(we.focus(),we.scrollIntoView(rn))}}),Ae=Ue("k",()=>{const E=document.activeElement.closest(ee),O=E==null?void 0:E.getBoundingClientRect(),re=Array.from(y.current.querySelectorAll(ee));if(E&&O.top<y.current.clientHeight&&O.bottom>0){const we=re.indexOf(E);let Ie=re[we-1];Ie&&(Ie.focus(),Ie.scrollIntoView(rn))}else{const we=re.find(Ie=>{const J=Ie.getBoundingClientRect();return J.top>=44&&J.left>=0});we&&(we.focus(),we.scrollIntoView(rn))}}),le=Ue(["enter","o"],()=>{const E=document.activeElement.closest(ee),O=E==null?void 0:E.querySelector(".status-link");O&&O.click()}),Z=new Date,me=ke(()=>ht(Z,{forceOpts:{weekday:"long"}}),[Z]);return e("div",{id:"notifications-page",class:"deck-container",ref:E=>{y.current=E,ge(E),Ae(E),le(E)},tabIndex:"-1",children:[e("div",{class:`timeline-deck deck ${m?"only-mentions":""}`,children:[e("header",{hidden:C,onClick:E=>{var O;E.target.closest("a, button")||(O=y.current)==null||O.scrollTo({top:0,behavior:"smooth"})},onDblClick:E=>{E.target.closest("a, button")||te(!0)},class:a==="loading"?"loading":"",children:[e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Dt,{}),e(he,{to:"/",class:"button plain",children:e(S,{icon:"home",size:"l",alt:g._({id:"i0qMbr"})})})]}),e("h1",{children:e(u,{id:"iDNBZe"})}),e("div",{class:"header-side",children:X&&e("button",{type:"button",class:"button plain4",onClick:()=>{U(!0)},children:e(S,{icon:"settings",size:"l",alt:g._({id:"a/+arl"})})})})]}),fe&&a!=="loading"&&e("button",{class:"updates-button shiny-pill",type:"button",onClick:()=>{var E;te(!0),(E=y.current)==null||E.scrollTo({top:0,behavior:"smooth"})},children:[e(S,{icon:"arrow-up"})," ",e(u,{id:"Jy9RU/"})]})]}),k.length>0&&e("div",{class:"shazam-container",children:e("div",{class:"shazam-container-inner",children:e("details",{class:"announcements",children:[e("summary",{children:[e("span",{children:[e(S,{icon:"announce",class:"announcement-icon",size:"l"})," ",e(u,{id:"0whvLM",values:{0:k.length}})," ",e("small",{class:"insignificant",children:s})]}),k.length>1&&e("span",{class:"announcements-nav-buttons",children:k.map((E,O)=>e("button",{type:"button",class:"plain2 small",onClick:()=>{var re;(re=ve.current)==null||re.children[O].scrollIntoView({behavior:"smooth",block:"nearest"})},children:O+1}))})]}),e("ul",{class:`announcements-list-${k.length>1?"multiple":"single"}`,ref:ve,children:k.map(E=>e("li",{children:e(Yr,{announcement:E})}))})]})})}),I.length>0&&e("div",{class:"follow-requests",children:[e("h2",{class:"timeline-header",children:e(u,{id:"6Fs1Ba"})}),I.length>5?e("details",{children:[e("summary",{children:e(u,{id:"7dHKu4",values:{0:I.length}})}),e("ul",{children:I.map(E=>e("li",{children:[e(rt,{account:E}),e(Zn,{accountID:E.id,onChange:()=>{}})]},E.id))})]}):e("ul",{children:I.map(E=>e("li",{children:[e(rt,{account:E}),e(Zn,{accountID:E.id,onChange:()=>{}})]},E.id))})]}),X&&((D=Y==null?void 0:Y.summary)==null?void 0:D.pendingRequestsCount)>0&&e("div",{class:"shazam-container",children:e("div",{class:"shazam-container-inner",children:e("div",{class:"filtered-notifications",children:e("details",{onToggle:async E=>{const{open:O}=E.target;if(O){const re=await de();K(re)}},children:[e("summary",{children:e(u,{id:"N3Bq0f",values:{0:Y.summary.pendingRequestsCount}})}),B?(B==null?void 0:B.length)>0&&e("ul",{children:B.map(E=>{var O,re;return e("li",{children:[e("div",{class:"request-notifcations",children:[!((O=E.lastStatus)!=null&&O.id)&&e(rt,{useAvatarStatic:!0,showStats:!0,account:E.account}),((re=E.lastStatus)==null?void 0:re.id)&&e("div",{class:"last-post",children:e(he,{class:"status-link",to:`/${s}/s/${E.lastStatus.id}`,children:e(qe,{status:E.lastStatus,size:"s",readOnly:!0})})}),e(jr,{request:E})]}),e(Vr,{request:E,onChange:()=>{te(!0)}})]},E.id)})}):e("p",{class:"ui-state",children:e(De,{abrupt:!0})})]})})})}),e("div",{id:"mentions-option",children:e("label",{children:[e("input",{type:"checkbox",checked:m,onChange:E=>{d(E.target.checked)}})," ",e(u,{id:"0udtPI"})]})}),e("h2",{class:"timeline-header",children:[e(u,{id:"ecUA8p"})," ",e("small",{class:"insignificant bidi-isolate",children:me})]}),Pe&&e("p",{class:"ui-state insignificant",children:a==="default"?g._({id:"KS7iJH"}):e(z,{children:"â€¦"})}),o.notifications.length?e(z,{children:o.notifications.filter(E=>E.type!=="follow_request").map(E=>{if(m&&E.type!=="mention")return null;const O=new Date(E.createdAt),re=O.toDateString()!==Le.toDateString();re&&(Le=O);const we=O.toDateString()===Re.toDateString()?g._({id:"y/0uwd"}):ht(Le,{hideTime:!0}),Ie=ht(Le,{forceOpts:{weekday:"long"}});return e(z,{children:[re&&e("h2",{class:"timeline-header",children:[e("span",{children:we})," ",e("small",{class:"insignificant bidi-isolate",children:Ie})]}),e(Rn,{instance:s,notification:E},E._ids||E.id)]},E._ids||E.id)})}):e(z,{children:[a==="loading"&&e(z,{children:e("ul",{class:"timeline flat",children:Array.from({length:5}).map((E,O)=>e("li",{class:"notification skeleton",children:[e("div",{class:"notification-type",children:e(S,{icon:"notification",size:"xl"})}),e("div",{class:"notification-content",children:e("p",{children:"â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ"})})]}))})}),a==="error"&&e("p",{class:"ui-state",children:[e(u,{id:"gjzl8E"}),e("br",{}),e("br",{}),e("button",{type:"button",onClick:()=>te(!0),children:e(u,{id:"KDw4GX"})})]})]}),p&&e(_t,{onChange:E=>{E&&te()},children:e("button",{type:"button",class:"plain block",disabled:a==="loading",onClick:()=>te(),style:{marginBlockEnd:"6em"},children:a==="loading"?e(De,{abrupt:!0}):e(u,{id:"uXRAkV"})})})]}),X&&j&&e(Fe,{onClick:E=>{E.target===E.currentTarget&&U(!1)},children:e("div",{class:"sheet",id:"notifications-settings",tabIndex:"-1",children:[e("button",{type:"button",class:"sheet-close",onClick:()=>U(!1),children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(u,{id:"a/+arl"})})}),e("main",{children:e("form",{onSubmit:E=>{E.preventDefault();const{forNotFollowing:O,forNotFollowers:re,forNewAccounts:we,forPrivateMentions:Ie,forLimitedAccounts:J}=E.target,$e={...Y,forNotFollowing:O.value,forNotFollowers:re.value,forNewAccounts:we.value,forPrivateMentions:Ie.value,forLimitedAccounts:J.value};ie($e),U(!1),(async()=>{try{await i.v2.notifications.policy.update($e),ue(g._({id:"4+7X9i"}))}catch{}})()},children:[e("p",{children:e(u,{id:"WrkPTf"})}),e("div",{class:"notification-policy-fields",children:Ur.map(E=>{const O=Y[E];return e("div",{children:e("label",{children:[n(Br[E]),e("select",{name:E,defaultValue:O,class:"small",children:[e("option",{value:"accept",children:e(u,{id:"g3UF2V"})}),e("option",{value:"filter",children:e(u,{id:"o7J4JM"})}),e("option",{value:"drop",children:e(u,{id:"gbbkE7"})})]})]})},E)})}),e("p",{children:e("button",{type:"submit",children:e(u,{id:"tfDRzk"})})})]})})]})})]})}function Hr(){return!!document.querySelector(".deck-backdrop, #modal-container > *")}function Yr({announcement:t}){const{instance:n}=ae(),{contact:i}=cs(),s=i==null?void 0:i.account,{id:o,content:a,startsAt:h,endsAt:r,published:c,allDay:l,publishedAt:p,updatedAt:f,read:m,mentions:d,statuses:y,tags:b,emojis:v,reactions:w}=t,_=new Date(p),C=ht(_),I=new Date(f),T=ht(I);return e("div",{class:"announcement-block",children:[e(rt,{account:s}),e("div",{class:"announcement-content",onClick:hs({mentions:d,instance:n}),dangerouslySetInnerHTML:{__html:jn(a,{emojis:v})}}),e("p",{class:"insignificant",children:[e("time",{datetime:_.toISOString(),children:ht(_)}),f&&T!==C&&e(z,{children:[" ","â€¢"," ",e("span",{class:"ib",children:e(u,{id:"TbFrLc",values:{0:ht(I)},components:{0:e("time",{datetime:I.toISOString()})}})})]})]}),e("div",{class:"announcement-reactions",hidden:!0,children:w.map(k=>{const{name:A,count:M,me:P,staticUrl:N,url:V}=k;return e("button",{type:"button",class:`plain4 small ${P?"reacted":""}`,children:[V||N?e("img",{src:V||N,alt:A,width:"16",height:"16"}):e("span",{children:A})," ",e("span",{class:"count",children:Ke(M)})]})})})]})}function qr(t){const{masto:n}=ae();return n.v1.notifications.list({accountID:t})}function jr({request:t}){var f;const{instance:n}=ae(),[i,s]=L("loading"),{account:o,lastStatus:a}=t,[h,r]=L(!1),[c,l]=L([]);function p(){r(!1)}return se(()=>{var m;(m=t==null?void 0:t.account)!=null&&m.id&&h&&(s("loading"),(async()=>{const d=await qr(t.account.id);l(d||[]),s("default")})())},[h,(f=t==null?void 0:t.account)==null?void 0:f.id]),e(z,{children:[e("button",{type:"button",class:"plain4 request-notifications-account",onClick:()=>{r(!0)},children:[e(S,{icon:"notification",class:"more-insignificant"})," ",e("small",{children:e(u,{id:"H0wUNM",values:{0:o.username},components:{0:e("span",{class:"bidi-isolate"})}})})," ",e(S,{icon:"chevron-down"})]}),h&&e(Fe,{onClick:m=>{m.target===m.currentTarget&&p()},children:e("div",{class:"sheet",tabIndex:"-1",children:[e("button",{type:"button",class:"sheet-close",onClick:p,children:e(S,{icon:"x",alt:g._({id:"yz7wBu"})})}),e("header",{children:e("b",{children:e(u,{id:"MXOmPt",values:{0:o.username},components:{0:e("span",{class:"bidi-isolate"})}})})}),e("main",{children:i==="loading"?e("p",{class:"ui-state",children:e(De,{abrupt:!0})}):c.map(m=>e("div",{class:"notification-peek",onClick:d=>{const{target:y}=d;(d.target.tagName==="BUTTON"||d.target.tagName==="A")&&p()},children:e(Rn,{instance:n,notification:m,isStatic:!0})}))})]})})]})}function Vr({request:t,onChange:n}){const{masto:i}=ae(),[s,o]=L("default"),[a,h]=L(null),r=a!==null;return e("p",{class:"notification-request-buttons",children:[e("button",{type:"button",disabled:s==="loading"||r,onClick:()=>{o("loading"),(async()=>{try{await i.v1.notifications.requests.$select(t.id).accept(),h("accept"),o("default"),n({request:t,state:"accept"}),ue(g._({id:"ZtBMwU",values:{0:t.account.username}}))}catch{o("error"),ue(g._({id:"S92JKG"}))}})()},children:e(u,{id:"h7peZQ"})})," ",e("button",{type:"button",disabled:s==="loading"||r,class:"light danger",onClick:()=>{o("loading"),(async()=>{try{await i.v1.notifications.requests.$select(t.id).dismiss(),h("dismiss"),o("default"),n({request:t,state:"dismiss"}),ue(g._({id:"ibBDry",values:{0:t.account.username}}))}catch{o("error"),ue(g._({id:"S5aemF"}))}})()},children:e(u,{id:"1QfxQT"})}),e("span",{class:"notification-request-states",children:s==="loading"?e(De,{abrupt:!0}):a==="accept"?e(S,{icon:"check-circle",alt:g._({id:"bzMKg7"}),class:"notification-accepted"}):a==="dismiss"&&e(S,{icon:"x-circle",alt:g._({id:"J6hrEy"}),class:"notification-dismissed"})})]})}const Xs=st(Fr),Gr=20;function Xn({local:t,columnMode:n,...i}){const s=Ye(x),o=!!t,a=n?{}:Mt(),{masto:h,instance:r}=ae({instance:(i==null?void 0:i.instance)||a.instance}),{masto:c,instance:l}=ae(),p=o?g._({id:"u96B/B",values:{instance:r}}):g._({id:"PgVqvd",values:{instance:r}});Xe(p,o?"/:instance?/p/l":"/:instance?/p");const f=q(),m=q();async function d(b){if(b||!m.current){const _={limit:Gr,local:o||void 0};!o&&Ze("@pixelfed/global-feed")&&(_.remote=!0),m.current=h.v1.timelines.public.list(_)}const v=await m.current.next();let{value:w}=v;return w!=null&&w.length&&(b&&(f.current=w[0].id),w.forEach(_=>{We(_,r)})),{...v,value:w}}async function y(){var b;try{const v=await h.v1.timelines.public.list({limit:1,local:o,since_id:f.current}).next();let{value:w}=v;const _=((b=w[0])==null?void 0:b.id)===f.current;return w!=null&&w.length&&!_?(w=Rt(w,"public"),!0):!1}catch{return!1}}return e(St,{title:p,titleComponent:e("h1",{class:"header-double-lines",children:[e("b",{children:o?g._({id:"pJQgQV"}):g._({id:"cg0I+x"})}),e("div",{children:r})]}),id:"public",instance:r,emptyText:g._({id:"BiZJ6G"}),errorText:g._({id:"scd9lw"}),fetchItems:d,checkForUpdates:y,useItemID:!0,headerStart:e(z,{}),boostsCarousel:s.settings.boostsCarousel,filterContext:"public",headerEnd:e(at,{portal:!0,overflow:"auto",viewScroll:"close",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(S,{icon:"more",size:"l",alt:g._({id:"2FYpfJ"})})}),children:[e(_e,{href:o?`/#/${r}/p`:`/#/${r}/p/l`,children:o?e(z,{children:[e(S,{icon:"transfer"})," ",e("span",{children:e(u,{id:"dXMiUw"})})]}):e(z,{children:[e(S,{icon:"transfer"})," ",e("span",{children:e(u,{id:"t2B/we"})})]})}),e(Ge,{}),e(_e,{onClick:()=>{let b=prompt(g._({id:"2MQ2cd"}));if(!/\./.test(b)){b&&alert(g._({id:"7WddtO"}));return}b&&(b=b.toLowerCase().trim(),location.hash=o?`/${b}/p/l`:`/${b}/p`)},children:[e(S,{icon:"bus"})," ",e("span",{children:e(u,{id:"Sq04Yc"})})]}),l!==r&&e(_e,{onClick:()=>{location.hash=o?`/${l}/p/l`:`/${l}/p`},children:[e(S,{icon:"bus"})," ",e("small",{class:"menu-double-lines",children:e(u,{id:"iAzCp4",values:{currentInstance:l},components:{0:e("b",{})}})})]})]})},r+o)}const ln=5,Yn=40,Kr=new URLSearchParams,dn={block:"nearest",inline:"center",behavior:"smooth"};function Js({columnMode:t,...n}){const i=t?{}:Mt(),{masto:s,instance:o,authenticated:a}=ae({instance:i.instance}),[h,r]=L("default"),[c]=t?[Kr]:ft(),l=q(),p=(n==null?void 0:n.query)||c.get("q"),f=t?"statuses":(n==null?void 0:n.type)||c.get("type");let m=g._({id:"A1taO8"});if(p)switch(f){case"statuses":m=g._({id:"6YeoAt",values:{q:p}});break;case"accounts":m=g._({id:"fpgumQ",values:{q:p}});break;case"hashtags":m=g._({id:"AuiMZZ",values:{q:p}});break;default:m=g._({id:"wr3GZI",values:{q:p}})}Xe(m,"/search");const[d,y]=L(!1),b=q(0);se(()=>{b.current=0},[p,f]);const v=q();gt(()=>{var $,F;(F=($=v.current)==null?void 0:$.scrollTo)==null||F.call($,0,0)},[p,f]);const[w,_]=L([]),[C,I]=L([]),[T,k]=L([]);se(()=>{_([]),I([]),k([])},[p]);const A={statuses:w,accounts:C,hashtags:T},M={statuses:_,accounts:I,hashtags:k},[P,N]=L({}),V=async $=>{if(!($!=null&&$.length))return;const F=await si($,P);F&&N({...P,...F})};function G($){$&&(b.current=0),!(!$&&!a)&&(r("loading"),$&&!f&&(_(w.slice(0,ln)),I(C.slice(0,ln)),k(T.slice(0,ln))),(async()=>{var B,K,de,te,fe,ye;const F={q:p,resolve:a,limit:ln};f&&(F.limit=Yn,F.type=f,a&&(F.offset=b.current));try{const H=await s.v2.search.fetch(F);if(f)if($){M[f](H[f]);const ce=(B=H[f])==null?void 0:B.length;b.current=Yn,y(!!ce)}else if(((de=(K=H[f])==null?void 0:K[0])==null?void 0:de.id)===((fe=(te=A[f])==null?void 0:te[0])==null?void 0:fe.id))y(!1);else{M[f](Se=>[...Se,...H[f]]);const ce=(ye=H[f])==null?void 0:ye.length;b.current=b.current+Yn,y(!!ce)}else _(H.statuses||[]),I(H.accounts||[]),k(H.hashtags||[]),b.current=0,y(!1);V(H.accounts),r("default")}catch{r("error")}})())}const X=q();Yt($=>{var B;const F=((B=v.current)==null?void 0:B.scrollTop)===0;if($&&F){const K=Date.now()-X.current;!X.current||K>1e3*3?G(!0):X.current=Date.now()}}),se(()=>{var F,B;let $;return(B=(F=l.current)==null?void 0:F.setValue)==null||B.call(F,p||""),p?G(!0):$=setTimeout(()=>{var K,de;(de=(K=l.current)==null?void 0:K.focus)==null||de.call(K)},150),()=>clearTimeout($)},[p,f,o]),Ue(["/","Slash"],$=>{var F,B,K,de;(B=(F=l.current)==null?void 0:F.focus)==null||B.call(F),(de=(K=l.current)==null?void 0:K.select)==null||de.call(K)},{preventDefault:!0});const j=".timeline > li > a, .hashtag-list > li > a",U=Ue("j",()=>{const $=document.activeElement.closest(j),F=$==null?void 0:$.getBoundingClientRect(),B=Array.from(v.current.querySelectorAll(j));if($&&F.top<v.current.clientHeight&&F.bottom>0){const K=B.indexOf($);let de=B[K+1];de&&(de.focus(),de.scrollIntoView(dn))}else{const K=B.find(de=>{const te=de.getBoundingClientRect();return te.top>=44&&te.left>=0});K&&(K.focus(),K.scrollIntoView(dn))}}),Y=Ue("k",()=>{const $=document.activeElement.closest(j),F=$==null?void 0:$.getBoundingClientRect(),B=Array.from(v.current.querySelectorAll(j));if($&&F.top<v.current.clientHeight&&F.bottom>0){const K=B.indexOf($);let de=B[K-1];de&&(de.focus(),de.scrollIntoView(dn))}else{const K=B.find(de=>{const te=de.getBoundingClientRect();return te.top>=44&&te.left>=0});K&&(K.focus(),K.scrollIntoView(dn))}}),[ie]=ui();return e("div",{id:"search-page",class:"deck-container",tabIndex:"-1",ref:$=>{v.current=$,U($),Y($)},children:e("div",{class:"timeline-deck deck",children:[e("header",{class:h==="loading"?"loading":"",children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:e(Dt,{})}),e(Os,{ref:l}),e("div",{class:"header-side",children:e("button",{type:"button",class:"plain",onClick:()=>{G(!0)},disabled:h==="loading",children:e(S,{icon:"search",size:"l",alt:g._({id:"A1taO8"})})})})]})}),e("main",{children:[!!p&&!t&&e("div",{ref:ie,class:`filter-bar ${h==="loading"?"loading":""}`,children:[!!f&&e(he,{to:`/search${p?`?q=${encodeURIComponent(p)}`:""}`,children:[e(S,{icon:"chevron-left"})," ",e(u,{id:"N40H+G"})]}),[{label:g._({id:"bPwFdf"}),type:"accounts",to:`/search?q=${encodeURIComponent(p)}&type=accounts`},{label:g._({id:"VwUsHI"}),type:"hashtags",to:`/search?q=${encodeURIComponent(p)}&type=hashtags`},{label:g._({id:"+owNNn"}),type:"statuses",to:`/search?q=${encodeURIComponent(p)}&type=statuses`}].sort(($,F)=>$.type===f?-1:F.type===f?1:0).map($=>e(he,{to:$.to,children:$.label},$.type))]}),p?e(z,{children:[(!f||f==="accounts")&&e(z,{children:[f!=="accounts"&&e("h2",{class:"timeline-header",children:[e(u,{id:"bPwFdf"})," ",e(he,{to:`/search?q=${encodeURIComponent(p)}&type=accounts`,children:e(S,{icon:"arrow-right",size:"l",alt:g._({id:"V1fa9u"})})})]}),C.length>0?e(z,{children:[e("ul",{class:"timeline flat accounts-list",children:C.map($=>e("li",{children:e(rt,{account:$,instance:o,showStats:!0,relationship:P[$.id]})},$.id))}),f!=="accounts"&&e("div",{class:"ui-state",children:e(he,{class:"plain button",to:`/search?q=${encodeURIComponent(p)}&type=accounts`,children:[e(u,{id:"BMmtZ8"})," ",e(S,{icon:"arrow-right"})]})})]}):!f&&(h==="loading"?e("p",{class:"ui-state",children:e(De,{abrupt:!0})}):e("p",{class:"ui-state",children:e(u,{id:"YYB61U"})}))]}),(!f||f==="hashtags")&&e(z,{children:[f!=="hashtags"&&e("h2",{class:"timeline-header",children:[e(u,{id:"VwUsHI"})," ",e(he,{to:`/search?q=${encodeURIComponent(p)}&type=hashtags`,children:e(S,{icon:"arrow-right",size:"l",alt:g._({id:"V1fa9u"})})})]}),T.length>0?e(z,{children:[e("ul",{class:"link-list hashtag-list",children:T.map($=>{var de;const{name:F,history:B}=$,K=(de=B==null?void 0:B.reduce)==null?void 0:de.call(B,(te,fe)=>te+ +fe.uses,0);return e("li",{children:e(he,{to:o?`/${o}/t/${F}`:`/t/${F}`,children:[e(S,{icon:"hashtag",alt:"#"}),e("span",{children:F}),!!K&&e("span",{class:"count",children:Ke(K)})]})},`${F}-${K}`)})}),f!=="hashtags"&&e("div",{class:"ui-state",children:e(he,{class:"plain button",to:`/search?q=${encodeURIComponent(p)}&type=hashtags`,children:[e(u,{id:"Nc/W5J"})," ",e(S,{icon:"arrow-right"})]})})]}):!f&&(h==="loading"?e("p",{class:"ui-state",children:e(De,{abrupt:!0})}):e("p",{class:"ui-state",children:e(u,{id:"4MFM3P"})}))]}),(!f||f==="statuses")&&e(z,{children:[f!=="statuses"&&e("h2",{class:"timeline-header",children:[e(u,{id:"+owNNn"})," ",e(he,{to:`/search?q=${encodeURIComponent(p)}&type=statuses`,children:e(S,{icon:"arrow-right",size:"l",alt:g._({id:"V1fa9u"})})})]}),w.length>0?e(z,{children:[e("ul",{class:"timeline",children:w.map($=>e("li",{children:e(he,{class:"status-link",to:o?`/${o}/s/${$.id}`:`/s/${$.id}`,children:e(qe,{status:$})})},$.id))}),f!=="statuses"&&e("div",{class:"ui-state",children:e(he,{class:"plain button",to:`/search?q=${encodeURIComponent(p)}&type=statuses`,children:[e(u,{id:"LYCgej"})," ",e(S,{icon:"arrow-right"})]})})]}):!f&&(h==="loading"?e("p",{class:"ui-state",children:e(De,{abrupt:!0})}):e("p",{class:"ui-state",children:e(u,{id:"Hzi9AA"})}))]}),!!f&&(h==="default"?d?e(_t,{onChange:$=>{$&&G()},children:e("button",{type:"button",class:"plain block",onClick:()=>G(),style:{marginBlockEnd:"6em"},children:e(u,{id:"uXRAkV"})})}):e("p",{class:"ui-state insignificant",children:e(u,{id:"2EYeAZ"})}):h==="loading"&&e("p",{class:"ui-state",children:e(De,{abrupt:!0})}))]}):h==="loading"?e("p",{class:"ui-state",children:e(De,{abrupt:!0})}):e("p",{class:"ui-state",children:e(u,{id:"fGn1Hk"})})]})]})})}const Wr=20,Qs=10*60*1e3,Zr=kt(t=>t.v1.trends.links.list().next(),{maxAge:Qs}),Xr=kt(t=>t.v1.trends.tags.list().next(),{maxAge:Qs});function Jr(t){return Ze("@pixelfed/trending")?t.pixelfed.v2.discover.posts.trending.list({range:"daily"}):t.v1.trends.statuses.list({limit:Wr})}function Qr(t,n){return t.v1.timelines.link.list(n)}function eo({columnMode:t,...n}){const i=Ye(x),s=t?{}:Mt(),{masto:o,instance:a}=ae({instance:(n==null?void 0:n.instance)||s.instance}),{masto:h,instance:r}=ae(),c=g._({id:"cI3UEs",values:{instance:a}});Xe(c,"/:instance?/trending");const l=q(),p=a===r,[f,m]=L([]),[d,y]=L([]),b=q();async function v(X){var Y;if(X||!b.current){if(b.current=Jr(o),Ze("@mastodon/trending-hashtags"))try{const{value:ie}=await Xr(o);ie!=null&&ie.length&&m(ie)}catch{}if(Ze("@mastodon/trending-links"))try{const{value:ie}=await Zr(o,a),$=(Y=ie==null?void 0:ie.filter)==null?void 0:Y.call(ie,F=>F.type==="link");$!=null&&$.length&&y($)}catch{}}const j=await b.current.next();let{value:U}=j;return U!=null&&U.length&&(X&&(l.current=U[0].id),U.forEach(ie=>{We(ie,a)})),{...j,value:U}}const[w,_]=L(!1),C=q(),[I,T]=L(null),k=!!I,A=q(),M=p&&Ze("@mastodon/trending-link-posts");se(()=>{I&&A.current&&A.current.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})},[I]);const P=q();async function N(X){(X||!C.current)&&(_(!0),C.current=Qr(o,{url:I})),P.current=I;const j=await C.current.next();let{value:U}=j;return U!=null&&U.length&&(U=Rt(U,"public"),U.forEach(Y=>{We(Y,a)})),P.current===I&&_(!1),{...j,value:U}}async function V(){try{const X=await o.v1.trends.statuses.list({limit:1}).next();let{value:j}=X;return j=Rt(j,"public"),j!=null&&j.length&&j[0].id!==l.current?(l.current=j[0].id,!0):!1}catch{return!1}}const G=ke(()=>e(z,{children:[!!f.length&&e("div",{class:"filter-bar expandable",children:[e(S,{icon:"chart",class:"insignificant",size:"l"}),f.map((X,j)=>{const{name:U,history:Y}=X,ie=Y.reduce(($,F)=>$+ +F.uses,0);return e(he,{to:`/${a}/t/${U}`,children:[e("span",{dir:"auto",children:[e("span",{class:"more-insignificant",children:"#"}),U]}),e("span",{class:"filter-count",children:Ke(ie)})]},U)})]}),!!d.length&&e("div",{class:"links-bar",children:[e("header",{children:e("h3",{children:e(u,{id:"9veeTb"})})}),d.map(X=>{var ee,ge;const{authors:j,authorName:U,authorUrl:Y,blurhash:ie,description:$,height:F,image:B,imageDescription:K,language:de,providerName:te,providerUrl:fe,publishedAt:ye,title:H,url:ce,width:Se}=X,Ee=(ge=(ee=j==null?void 0:j[0])==null?void 0:ee.account)!=null&&ge.id?j[0].account:null,Re=H.length<30,Le=!!(U||Ee),Pe=Nt.toUnicode(URL.parse(ce).hostname.replace(/^www\./,"").replace(/\/$/,""));let ve;if(ie){const Ae=oi(ie),le=bi(Ae);ve=gi([.6,le[1],le[2]])}return e("div",{children:[e("a",{ref:I===ce?A:null,href:ce,target:"_blank",rel:"noopener noreferrer",class:`link-block ${k?I===ce?"active":"inactive":""}`,style:ve?{"--accent-color":`rgb(${ve.join(",")})`,"--accent-alpha-color":`rgba(${ve.join(",")}, 0.4)`}:{},children:e("article",{children:[e("figure",{children:e("img",{src:B,alt:K,width:Se,height:F,loading:"lazy"})}),e("div",{class:"article-body",children:[e("header",{children:[e("div",{class:"article-meta",children:[e("span",{class:"domain",children:Pe})," ",!!ye&&e(z,{children:"Â· "}),!!ye&&e(z,{children:e(Kt,{datetime:ye,format:"micro"})})]}),!!H&&e("h1",{class:"title",lang:de,dir:"auto",title:H,children:H})]}),!!$&&e("p",{class:`description ${Le&&!Re?"":"more-lines"}`,lang:de,dir:"auto",title:$,children:$}),Le&&e(z,{children:[e("hr",{}),e("p",{class:"byline",children:e("small",{children:e(u,{id:"aavdrC",values:{0:Ee?e(mt,{account:Ee,showAvatar:!0}):Y?e("a",{href:Y,target:"_blank",rel:"noopener noreferrer",children:U}):U}})})})]})]})]})}),M&&e("button",{type:"button",class:"small plain4 block",onClick:()=>{T(ce)},disabled:ce===I,children:[e(S,{icon:"comment2"})," ",e("span",{children:e(u,{id:"/bZzdR"})})," ",e(S,{icon:"chevron-down"})]})]},ce)})]}),M&&!!d.length&&e("div",{class:`timeline-header-block ${k?"blended":""}`,children:k?e(z,{children:[e("div",{style:{width:50,flexShrink:0,textAlign:"center"},children:w?e(De,{abrupt:!0}):e("button",{type:"button",class:"light",onClick:()=>{T(null)},children:e(S,{icon:"x",alt:g._({id:"9Q/4xJ"})})})}),e("p",{children:e(u,{id:"BATCqf",values:{0:I.replace(/^https?:\/\/(www\.)?/i,"").replace(/\/$/,"")},components:{0:e("span",{class:"link-text"})}})})]}):e("p",{class:"insignificant",children:e(u,{id:"Vosm4k"})})})]}),[f,d,I,w]);return e(St,{title:c,titleComponent:e("h1",{class:"header-double-lines",children:[e("b",{children:e(u,{id:"4/iCqx"})}),e("div",{children:a})]}),id:"trending",instance:a,emptyText:g._({id:"6HA9+s"}),errorText:g._({id:"scd9lw"}),fetchItems:k?N:v,checkForUpdates:k?void 0:V,checkForUpdatesInterval:5*60*1e3,useItemID:!0,headerStart:e(z,{}),boostsCarousel:i.settings.boostsCarousel,filterContext:"public",timelineStart:G,refresh:I,clearWhenRefresh:!0,view:k?"link-mentions":void 0,headerEnd:e(at,{portal:!0,overflow:"auto",viewScroll:"close",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(S,{icon:"more",size:"l",alt:g._({id:"2FYpfJ"})})}),children:[e(_e,{onClick:()=>{let X=prompt(g._({id:"2MQ2cd"}));if(!/\./.test(X)){X&&alert(g._({id:"7WddtO"}));return}X&&(X=X.toLowerCase().trim(),location.hash=`/${X}/trending`)},children:[e(S,{icon:"bus"})," ",e("span",{children:e(u,{id:"Sq04Yc"})})]}),r!==a&&e(_e,{onClick:()=>{location.hash=`/${r}/trending`},children:[e(S,{icon:"bus"})," ",e("small",{class:"menu-double-lines",children:e(u,{id:"iAzCp4",values:{currentInstance:r},components:{0:e("b",{})}})})]})]})},a)}const Zi={block:"nearest",inline:"nearest",behavior:"smooth"};function el(){Xe(g._({id:"i0qMbr"}),"/");const t=Ye(x),{shortcuts:n}=t,i=n.map(s=>{if(!s)return null;const{type:o,...a}=s,h={following:wi,notifications:Xs,list:Ys,public:Xn,bookmarks:Us,favourites:Bs,hashtag:Hs,mentions:Gs,trending:eo,search:Js}[o];return!h||o==="search"&&!a.query||o==="list"&&!a.id?null:e(h,{...a,columnMode:!0},o+JSON.stringify(a))});return Ue(["1","2","3","4","5","6","7","8","9"],(s,o)=>{try{const a=parseInt(o.keys[0],10)-1,h=document.querySelectorAll("#columns > *")[a];h&&(h.focus(),h.scrollIntoView(Zi))}catch{}}),Ue(["[","]"],(s,o)=>{const a=o.keys[0],h=document.activeElement.closest("#columns > *"),r=Et(),c=r?"]":"[",l=r?"[":"]";let p;a===c?p=h?h.previousElementSibling:document.querySelectorAll("#columns > *")[0]:a===l&&(p=h?h.nextElementSibling:document.querySelectorAll("#columns > *")[1]),p&&(p.focus(),p.scrollIntoView(Zi))}),e("div",{id:"columns",onContextMenu:s=>{s.target.closest(".deck > header")&&!s.target.closest("a")&&!s.target.closest("button")&&(s.preventDefault(),x.showShortcutsSettings=!0)},onFocus:()=>{const s=document.activeElement.closest("#columns > *");s&&document.querySelectorAll("#columns > *").forEach(o=>{o.classList.toggle("focus",o===s)})},children:i})}function tl(){var i;const{_:t}=Qe(),n=Ye(x);return __BENCHMARK.end("time-to-home"),se(()=>{(async()=>{const s=await ut.drafts.keys();if(s.length){const o=vn();s.filter(h=>h.startsWith(o)).length&&(x.showDrafts=!0)}})()},[]),e(z,{children:(n.settings.shortcutsViewMode==="multi-column"||!n.settings.shortcutsViewMode&&n.settings.shortcutsColumnsMode)&&((i=n.shortcuts)!=null&&i.length)?e(el,{}):e(wi,{title:t({id:"i0qMbr"}),path:"/",id:"home",headerStart:!1,headerEnd:e(nl,{})})})}function nl(){const t=Ye(x),n=q(),[i,s]=L(void 0);return e(z,{children:[e(he,{ref:n,to:"/notifications",class:`button plain notifications-button ${t.notificationsShowNew?"has-badge":""} ${i||""}`,onClick:o=>{o.stopPropagation(),window.matchMedia("(min-width: calc(40em))").matches&&(o.preventDefault(),s(a=>a?void 0:"open"))},children:e(S,{icon:"notification",size:"l",alt:g._({id:"iDNBZe"})})}),e(sl,{state:i,anchorRef:n,onClose:()=>s(void 0)})]})}const il=5;function sl({anchorRef:t,state:n,onClose:i}){const{masto:s,instance:o}=ae(),a=Ye(x),[h,r]=L("default"),c=Ws();async function l(){const b=await c.next(),v=Vs(b.value);if(v!=null&&v.length){v.forEach(_=>{We(_.status,o,{skipThreading:!0})});const w=Zs(v);x.notificationsLast=w[0],x.notifications=w,s.v1.markers.create({notifications:{lastReadId:w[0].id}}).catch(()=>{})}return x.notificationsShowNew=!1,x.notificationsLastFetchTime=Date.now(),b}const[p,f]=L(!1);function m(){return s.v1.followRequests.list({limit:1})}function d(){r("loading"),(async()=>{try{await l();const b=await m();f(!!(b!=null&&b.length)),r("default")}catch{r("error")}})()}se(()=>{n==="open"&&d()},[n]);const y=q();return e(bs,{ref:y,menuClassName:"notifications-menu",state:n,anchorRef:t,onClose:i,portal:{target:document.body},containerProps:{onClick:()=>{var b,v;(v=(b=y.current)==null?void 0:b.closeMenu)==null||v.call(b)}},overflow:"auto",viewScroll:"close",position:"anchor",align:"center",boundingBoxPadding:"8 8 8 8",children:[e("header",{children:e("h2",{children:e(u,{id:"iDNBZe"})})}),e("main",{children:a.notifications.length?e(z,{children:a.notifications.slice(0,il).map(b=>e(Rn,{instance:o,notification:b,disableContextMenu:!0},b._ids||b.id))}):h==="loading"?e("div",{class:"ui-state",children:e(De,{abrupt:!0})}):h==="error"&&e("div",{class:"ui-state",children:[e("p",{children:e(u,{id:"5GFQTh"})}),e("p",{children:e("button",{type:"button",onClick:d,children:e(u,{id:"KDw4GX"})})})]})}),e("footer",{children:[e(he,{to:"/mentions",class:"button plain",children:[e(S,{icon:"at"})," ",e("span",{children:e(u,{id:"/bZzdR"})})]}),e(he,{to:"/notifications",class:"button plain2",children:[p?e(u,{id:"OdVhdR",components:{0:e("span",{class:"tag collapsed"}),1:e("span",{})}}):e("b",{children:e(u,{id:"gukqfD"})})," ",e(S,{icon:"arrow-right"})]})]})]})}const ol=st(tl),cl=[/^\/@[^@\/]+\/(?:statuses|posts)\/([^\/]+)/i,/\/notes\/([^\/]+)/i,/^\/(?:notice|objects)\/([a-z0-9-]+)/i,/\/@[^@\/]+\/post\/([^\/]+)/i,/\/@[^@\/]+@?[^\/]+?\/([^\/]+)/i,/^\/p\/[^\/]+\/([^\/]+)/i];function to(t){const{hostname:n,pathname:i}=URL.parse(t);for(const s of cl){const[,o]=i.match(s)||[];if(o)return{instance:n,id:o}}return{}}function al(t){const{instance:n,id:i}=to(t);return n&&i?`/${n}/s/${i}`:null}function rl(){const n=Gt().pathname.replace(/^\//,""),i=to(n),s=i!=null&&i.instance?`/${i.instance}/s/${i.id}`:null,[o,a]=L("loading");return gt(()=>{a("loading"),(async()=>{try{const{instance:h,id:r}=i;if(r){const{masto:c}=ae({instance:h});if(await c.v1.statuses.$select(r).fetch()){window.location.hash=s+"?view=full";return}}}catch{}{const{masto:h,instance:r}=ae(),c=await h.v2.search.fetch({q:n,limit:1,resolve:!0});if(c.statuses.length){const l=c.statuses[0];window.location.hash=`/${r}/s/${l.id}?view=full`}else if(c.accounts.length){const l=c.accounts[0];window.location.hash=`/${r}/a/${l.id}`}else s?window.location.hash=s+"?view=full":a("error")}})()},[s]),e("div",{class:"ui-state",tabIndex:"-1",children:[o==="loading"?e(z,{children:[e(De,{abrupt:!0}),e("h2",{children:e(u,{id:"RTAr/z"})}),e("p",{children:e("a",{href:n,target:"_blank",rel:"noopener noreferrer",children:n})})]}):e(z,{children:[e("h2",{children:e(u,{id:"ufzZSJ"})}),e("p",{children:e("a",{href:n,target:"_blank",rel:"noopener noreferrer",children:n})})]}),e("hr",{}),e("p",{children:e(he,{to:"/",children:e(u,{id:"iWpEwy"})})})]})}function ll(){Xe(g._({id:"h16FyT"}),"/l");const[t,n]=L("default"),[i,s]=$t(c=>c+1,0),[o,a]=L([]);se(()=>{n("loading"),(async()=>{try{const c=await Wn();a(c),n("default")}catch{n("error")}})()},[i]);const[h,r]=L(!1);return e("div",{id:"lists-page",class:"deck-container",tabIndex:"-1",children:[e("div",{class:"timeline-deck deck",children:[e("header",{children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Dt,{}),e(he,{to:"/",class:"button plain",children:e(S,{icon:"home",size:"l"})})]}),e("h1",{children:e(u,{id:"h16FyT"})}),e("div",{class:"header-side",children:e("button",{type:"button",class:"plain",onClick:()=>r(!0),children:e(S,{icon:"plus",size:"l",alt:g._({id:"Sb2gYF"})})})})]})}),e("main",{children:o.length>0?e(z,{children:[e("ul",{class:"link-list",children:o.map(c=>e("li",{children:e(he,{to:`/l/${c.id}`,children:e("span",{children:[e(S,{icon:"list"})," ",e("span",{children:c.title})]})})}))}),o.length>1&&e("footer",{class:"ui-state",children:e("small",{class:"insignificant",children:e(u,{id:"8prZNK",values:{0:o.length}})})})]}):t==="loading"?e("p",{class:"ui-state",children:e(De,{})}):t==="error"?e("p",{class:"ui-state",children:e(u,{id:"v/l5uA"})}):e("p",{class:"ui-state",children:e(u,{id:"IvPikw"})})})]}),h&&e(Fe,{onClick:c=>{c.target===c.currentTarget&&r(!1)},children:e(mi,{list:h==null?void 0:h.list,onClose:c=>{c.state==="success"&&s(),r(!1)}})})]})}const dl=""+new URL("instances-CwO9tuGQ.json",import.meta.url).href;function ul(t){return("0"+t.toString(16)).slice(-2)}function hl(){var t=new Uint32Array(28);return window.crypto.getRandomValues(t),Array.from(t,ul).join("")}function fl(t){const i=new TextEncoder().encode(t);return window.crypto.subtle.digest("SHA-256",i)}function pl(t){let n="";const i=new Uint8Array(t),s=i.byteLength;for(var o=0;o<s;o++)n+=String.fromCharCode(i[o]);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function no(t){const n=await fl(t);return pl(n)}async function ml({instanceURL:t}){var n;if(!t)return!1;try{const i=await fetch(`https://${t}/.well-known/oauth-authorization-server`);return!i.ok||i.status!==200?!1:!!((n=(await i.json()).code_challenge_methods_supported)!=null&&n.includes("S256"))}catch{return!1}}window.__generateCodeChallenge=no;const gl={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Blaede Phanpy",PHANPY_DEFAULT_INSTANCE:"mastodon.blaede.family",PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:"https://mastodon.blaede.family/auth/sign_up",PHANPY_GIPHY_API_KEY:"48JGsrSS1XE5w4nWe9c9hqxPbsfRWR0e",PHANPY_LINGVA_INSTANCES:"lingva.phanpy.social lingva.lunar.icu lingva.garudalinux.org translate.plausibility.cloud",PHANPY_PRIVACY_POLICY_URL:"https://mastodon.blaede.family/privacy-policy",PHANPY_WEBSITE:"https://phanpy.blaede.family",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},{DEV:bl,PHANPY_CLIENT_NAME:yl,PHANPY_WEBSITE:In}=gl,Ln="read write follow push",vl=In?In.toLowerCase().includes(location.hostname):!1,wl=location.origin+location.pathname,$n=bl||!vl?wl:In;async function _l({instanceURL:t}){const n=new URLSearchParams({client_name:yl,redirect_uris:$n,scopes:Ln,website:In});return await(await fetch(`https://${t}/api/v1/apps`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:n.toString()})).json()}async function kl({instanceURL:t,client_id:n}){const i=hl(),s=await no(i),o=new URLSearchParams({client_id:n,code_challenge_method:"S256",code_challenge:s,redirect_uri:$n,response_type:"code",scope:Ln});return[`https://${t}/oauth/authorize?${o.toString()}`,i]}async function Sl({instanceURL:t,client_id:n}){const i=new URLSearchParams({client_id:n,scope:Ln,redirect_uri:$n,response_type:"code"});return`https://${t}/oauth/authorize?${i.toString()}`}async function Cl({instanceURL:t,client_id:n,client_secret:i,code:s,code_verifier:o}){const a=new URLSearchParams({client_id:n,redirect_uri:$n,grant_type:"authorization_code",code:s,scope:Ln});return i&&a.append("client_secret",i),o&&a.append("code_verifier",o),await(await fetch(`https://${t}/oauth/token`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:a.toString()})).json()}const Il={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Blaede Phanpy",PHANPY_DEFAULT_INSTANCE:"mastodon.blaede.family",PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:"https://mastodon.blaede.family/auth/sign_up",PHANPY_GIPHY_API_KEY:"48JGsrSS1XE5w4nWe9c9hqxPbsfRWR0e",PHANPY_LINGVA_INSTANCES:"lingva.phanpy.social lingva.lunar.icu lingva.garudalinux.org translate.plausibility.cloud",PHANPY_PRIVACY_POLICY_URL:"https://mastodon.blaede.family/privacy-policy",PHANPY_WEBSITE:"https://phanpy.blaede.family",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},{PHANPY_DEFAULT_INSTANCE:Tl}=Il;function Al(){var _,C;Xe("Log in");const t=q(),n=be.local.get("instanceURL"),[i,s]=L("default"),[o]=ft(),a=o.get("instance"),h=o.get("submit"),[r,c]=L(a||(n==null?void 0:n.toLowerCase())||""),[l,p]=L([]),f=q();se(()=>{(async()=>{try{const T=await(await fetch(dl)).json();p(T),f.current=new Yo(T)}catch{}})()},[]);const m=I=>{I&&(async()=>{try{const k=await(await fetch(`https://${I}/.well-known/host-meta`)).text(),N=new DOMParser().parseFromString(k,"text/xml").getElementsByTagName("Link")[0].getAttribute("template"),V=URL.parse(N),{host:G}=V;I!==G&&(I=G)}catch{}be.local.set("instanceURL",I),s("loading");try{const{client_id:T,client_secret:k,vapid_key:A}=await _l({instanceURL:I});if(await ml({instanceURL:I}))if(T&&k){be.sessionCookie.set("clientID",T),be.sessionCookie.set("clientSecret",k),be.sessionCookie.set("vapidKey",A);const[P,N]=await kl({instanceURL:I,client_id:T});be.sessionCookie.set("codeVerifier",N),location.href=P}else alert(g._({id:"ZP1FIA"}));else T&&k?(be.sessionCookie.set("clientID",T),be.sessionCookie.set("clientSecret",k),be.sessionCookie.set("vapidKey",A),location.href=await Sl({instanceURL:I,client_id:T})):alert(g._({id:"ZP1FIA"}));s("default")}catch{s("error")}})()},d=r?r.replace(/^https?:\/\//,"").replace(/\/+$/,"").replace(/^@?[^@]+@/,"").trim():null,y=/[^\s\r\n\t\/\\]+\.[^\s\r\n\t\/\\]+/.test(d)&&!/[\s\/\\@]/.test(d),b=d?(C=(_=f.current)==null?void 0:_.search(d,{limit:10}))==null?void 0:C.map(I=>I.item):[],v=y?d:b!=null&&b.length?b[0]:r?l.find(I=>I.includes(r)):null,w=I=>{I.preventDefault(),m(v)};return h&&se(()=>{m(a||v)},[]),e("main",{id:"login",style:{textAlign:"center"},children:e("form",{onSubmit:w,children:[e("h1",{children:[e("img",{src:hi,alt:"",width:"80",height:"80"}),e("br",{}),e(u,{id:"sQia9P"})]}),e("label",{children:[e("p",{children:e(u,{id:"kyAi7k"})}),e("input",{value:r,required:!0,type:"text",class:"large",id:"instanceURL",ref:t,disabled:i==="loading",autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellCheck:!1,placeholder:g._({id:"u3gOdY"}),onInput:I=>{c(I.target.value)},dir:"auto"}),(b==null?void 0:b.length)>0?e("ul",{id:"instances-suggestions",children:b.map((I,T)=>e("li",{children:e("button",{type:"button",class:"plain5",onClick:()=>{m(I)},children:I})}))}):e("div",{id:"instances-eg",children:e(u,{id:"/OvbEC"})})]}),i==="error"&&e("p",{class:"error",children:e(u,{id:"rmBHZn"})}),e("div",{children:[e("button",{disabled:i==="loading"||!r||!v,children:v?g._({id:"2xahsi",values:{selectedInstanceText:v}}):g._({id:"xGVfLh"})})," "]}),e(De,{hidden:i!=="loading"}),e("hr",{}),!Tl&&e("p",{children:e("a",{href:"https://joinmastodon.org/servers",target:"_blank",children:e(u,{id:"LcOiWS"})})}),e("p",{children:e(he,{to:"/",children:e(u,{id:"iWpEwy"})})}),e(fi,{})]})})}const xl={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Blaede Phanpy",PHANPY_DEFAULT_INSTANCE:"mastodon.blaede.family",PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:"https://mastodon.blaede.family/auth/sign_up",PHANPY_GIPHY_API_KEY:"48JGsrSS1XE5w4nWe9c9hqxPbsfRWR0e",PHANPY_LINGVA_INSTANCES:"lingva.phanpy.social lingva.lunar.icu lingva.garudalinux.org translate.plausibility.cloud",PHANPY_PRIVACY_POLICY_URL:"https://mastodon.blaede.family/privacy-policy",PHANPY_WEBSITE:"https://phanpy.blaede.family",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},{PHANPY_DEFAULT_INSTANCE:Xi}=xl,un=40,El=10,Rl=5;let Jn={},mn={},gn={};function bn(t){delete mn[t],delete gn[t]}const Xt={block:"nearest",inline:"center",behavior:"smooth"},Ji=".status-link:not(details:not([open]) > summary ~ *, details:not([open]) > summary ~ * *), .status-focus:not(details:not([open]) > summary ~ *, details:not([open]) > summary ~ * *)",Qi=/\/s\//i;function Ll(t){var I;const{id:n}=t,{masto:i,instance:s}=ae({instance:t.instance}),o=Ye(x),[a,h]=ft(),r=a.get("media"),c=a.get("media-only"),l=parseInt(r||c,10);let p=l>0;const f=a.get("mediaStatusID"),m=ds(f,s);f&&!m&&(p=!1);const d=p&&!!c,y=it(n,s),[b,v]=L(x.statuses[y]);se(()=>{x.statuses[y]&&v(x.statuses[y])},[y]);const w=ke(()=>{const{prevLocation:T}=x,k=((T==null?void 0:T.pathname)||"")+((T==null?void 0:T.search)||""),A=tn("/:instance/s/:id",k)||tn("/s/:id",k);return!k||A?"/":k},[]);se(()=>{!b&&p&&(async()=>{try{const T=await i.v1.statuses.$select(n).fetch();We(T,s),v(T)}catch{alert("Unable to load post."),location.hash=w}})()},[p]);const _=f?(I=o.statuses[it(f,s)])==null?void 0:I.mediaAttachments:b==null?void 0:b.mediaAttachments,C=ct(()=>{!window.matchMedia("(min-width: calc(40em + 350px))").matches&&o.prevLocation?history.back():d?location.hash=w:(a.delete("media"),a.delete("mediaStatusID"),h(a))},[d,w,o.prevLocation]);return se(()=>{let T=setTimeout(()=>{const k=document.querySelector(".carousel");k&&k.focus()},100);return()=>clearTimeout(T)},[d]),se(()=>{const T=document.querySelectorAll(".deck-container");return T.forEach(k=>{k.setAttribute("inert","")}),()=>{T.forEach(k=>{k.removeAttribute("inert")})}},[]),e("div",{class:"deck-backdrop",children:[p?_!=null&&_.length?e(Ps,{mediaAttachments:_,statusID:f||n,instance:s,lang:b==null?void 0:b.language,index:l-1,onClose:C}):e("div",{class:"media-modal-container loading",children:e(De,{abrupt:!0})}):e(he,{to:w}),!d&&e(Ml,{id:n,instance:t.instance,closeLink:w})]})}function $l(t){const{linkable:n,to:i,onClick:s,...o}=t;return n?e(he,{class:"status-link",to:i,onClick:s,...o}):e("div",{class:"status-focus",tabIndex:0,...o})}function es(t,n){return new Date(n.created_at)-new Date(t.created_at)}function Ml({id:t,closeLink:n="/",instance:i}){var Z,me;const[s,o]=ft(),a=s.get("media"),h=s.get("mediaStatusID"),r=parseInt(a,10)>0,c=q(!x.prevLocation&&(history.length===1||"navigation"in window&&((me=(Z=navigation==null?void 0:navigation.entries)==null?void 0:Z.call(navigation))==null?void 0:me.length)===1)),[l,p]=L(s.get("view")||c.current?"full":null),f=!!parseInt(s.get("translate")),{masto:m,instance:d}=ae({instance:i}),{masto:y,instance:b,authenticated:v}=ae(),w=d===b,_=Ye(x),[C,I]=L([]),[T,k]=L("default"),A=q(),M=it(t,d),P=q(0),N=q();se(()=>{var D;(D=N.current)==null||D.focus()},[]),se(()=>{var E;const D=ws(()=>{if(!N.current)return;const{scrollTop:O}=N.current;T!=="loading"&&(gn[t]=O)},50);return(E=N.current)==null||E.addEventListener("scroll",D,{passive:!0}),D(),()=>{var O;D.cancel(),(O=N.current)==null||O.removeEventListener("scroll",D)}},[t,T!=="loading"]);const V=q(),G=q(),X=({reloadHero:D}={})=>{k("loading");let E;const O=mn[t];if(O){const re=O.filter(we=>x.statuses[M]);I(re)}else I([{id:t}]);return(async()=>{var $e,Oe;const re=()=>Ai(()=>m.v1.statuses.$select(t).fetch(),{retries:4}),we=Ai(()=>m.v1.statuses.$select(t).context.fetch(),{retries:8}),Ie=!!_.statuses[M];let J=_.statuses[M];if(!(Ie&&!D))try{J=await re(),We(J,d),await new Promise(R=>{setTimeout(R,100)})}catch{k("error");return}try{let R=function(pe,Ne){const Je=Ne+1;return Je>xe&&(xe=Ne),pe==null?void 0:pe.map(Ce=>({id:Ce.id,account:Ce.account,repliesCount:Ce.repliesCount,content:Ce.content,weight:en(Ce),level:Je,replies:R(Ce.__replies,Je)}))};const Q=await we,{ancestors:oe,descendants:W}=Q;oe.sort(es),W.sort(es),P.current=(W==null?void 0:W.length)||0;const ne=new Set;oe.forEach(pe=>{We(pe,d,{skipThreading:!0}),pe.inReplyToId&&!oe.find(Ne=>Ne.id===pe.inReplyToId)&&ne.add(pe.inReplyToId)});const Me=oe.every(pe=>pe.account.id===J.account.id),Te=[];W.forEach(pe=>{if(We(pe,d,{skipThreading:!0}),pe.inReplyToId&&!W.find(Ne=>Ne.id===pe.inReplyToId)&&pe.inReplyToId!==J.id&&ne.add(pe.inReplyToId),pe.inReplyToAccountId===pe.account.id)Te.push(pe);else if(pe.inReplyToId===J.id)Te.push(pe);else if(!pe.inReplyToAccountId&&Te.find(Ne=>Ne.id===pe.inReplyToId&&Ne.account.id===J.account.id)&&pe.account.id===J.account.id)Te.push(pe);else{const Ne=W.find(Je=>Je.id===pe.inReplyToId);Ne&&(Ne.__replies||(Ne.__replies=[]),Ne.__replies.push(pe))}}),Te.sort((pe,Ne)=>{const Je=J.account.id;return pe.account.id===Je&&Ne.account.id!==Je?-1:Ne.account.id===Je&&pe.account.id!==Je?1:0}),ne.size;let xe=1;const ze=[...oe.map(pe=>({id:pe.id,ancestor:!0,isThread:Me,accountID:pe.account.id,account:pe.account,repliesCount:pe.repliesCount,weight:en(pe)})),{id:t,accountID:J.account.id,weight:en(J)},...Te.map(pe=>({id:pe.id,account:pe.account,accountID:pe.account.id,descendant:!0,thread:pe.account.id===J.account.id,weight:en(pe),level:1,replies:R(pe.__replies,1)}))];k("default"),V.current={offsetTop:($e=A.current)==null?void 0:$e.offsetTop,scrollTop:(Oe=N.current)==null?void 0:Oe.scrollTop};const He=oe.length||0;He>=K&&de(He+1),I(ze),mn[t]=ze,vo(J,d)}catch{k("error")}})(),G.current=Date.now(),()=>{clearTimeout(E)}};se(X,[t,m]);const[j,U]=L(!1);se(()=>{let D=setInterval(()=>{const E=Date.now();G.current&&E-G.current>=6e4&&U(!0)},6e4);return()=>{clearInterval(D)}},[]),gt(()=>{var E,O;if(!C.length)return;const D=gn[t];if(D)N.current.scrollTop=D;else if(V.current){const re={offsetTop:(E=A.current)==null?void 0:E.offsetTop,scrollTop:(O=N.current)==null?void 0:O.scrollTop},we=re.offsetTop-V.current.offsetTop+re.scrollTop;N.current.scrollTop=we}else C.length===1&&(N.current.scrollTop=0);V.current=null},[C]),se(()=>{_.reloadStatusPage<=0||(async()=>{try{const{instanceURL:D}=ei(),E=`https://${D}/api/v1/statuses/${t}/context`;return await(await caches.open("api")).delete(E,{ignoreVary:!0}),X({reloadHero:!0})}catch{}})()},[_.reloadStatusPage]),se(()=>()=>{gn={},x.reloadStatusPage=0,mn={},Jn={},Qn.clear()},[]);const Y=_.statuses[M]||_.statuses[t],ie=ke(()=>{if(!Y)return"";const{account:D}=Y,E=document.createElement("div");return E.innerHTML=D.displayName,E.innerText.trim()},[Y]),$=ke(()=>{if(!Y)return"";let D=ci(Y);return D.length>64&&(D=D.slice(0,64)+"â€¦"),D},[Y]);Xe(ie&&$?`${ie}: "${$}"`:g._({id:"post.title"}),"/:instance?/s/:id");const F=ke(()=>{if(!Y)return;const{url:D}=Y;if(D)return URL.parse(D).hostname},[Y]),B=ke(()=>{if(F)return F===d},[F,d]),[K,de]=L(un),te=ke(()=>C.length-K,[C.length,K]),fe=C.some(D=>D.descendant),ye=C.filter(D=>D.ancestor),[H,ce]=L(!0),Se=ke(()=>{if(!A.current||H)return null;const{top:D}=A.current.getBoundingClientRect();return D>0?"down":"up"},[H]);Ue("esc",()=>{location.hash=n},{enabled:!r,ignoreEventWhen:D=>!!document.querySelector("#modal-container > *")}),Ue("backspace",()=>{location.hash=n}),Ue("j",()=>{const D=document.activeElement.closest(".status-link, .status-focus"),E=D==null?void 0:D.getBoundingClientRect(),O=Array.from(N.current.querySelectorAll(Ji));if(D&&E.top<N.current.clientHeight&&E.bottom>0){const re=O.indexOf(D);let we=O[re+1];we&&(we.focus(),we.scrollIntoView(Xt))}else{const re=O.find(we=>{const Ie=we.getBoundingClientRect();return Ie.top>=44&&Ie.left>=0});re&&(re.focus(),re.scrollIntoView(Xt))}}),Ue("k",()=>{const D=document.activeElement.closest(".status-link, .status-focus"),E=D==null?void 0:D.getBoundingClientRect(),O=Array.from(N.current.querySelectorAll(Ji));if(D&&E.top<N.current.clientHeight&&E.bottom>0){const re=O.indexOf(D);let we=O[re-1];we&&(we.focus(),we.scrollIntoView(Xt))}else{const re=O.find(we=>{const Ie=we.getBoundingClientRect();return Ie.top>=44&&Ie.left>=0});re&&(re.focus(),re.scrollIntoView(Xt))}}),Ue("x",()=>{const D=document.activeElement.closest(".status-link, .status-focus");if(D){const E=D.nextElementSibling;E&&E.tagName.toLowerCase()==="details"&&(E.open=!E.open)}});const[Ee,Re]=L(!1),Le=q(r?"media+status":"status"),Pe=ct((D,E,O,re)=>{D.preventDefault(),D.stopPropagation(),o({media:E+1,mediaStatusID:re.id})},[t]),ve=ct((D,E)=>{bn(E.id)},[]);se(()=>{let D;return h&&r&&(D=setTimeout(()=>{var O;const E=(O=N.current)==null?void 0:O.querySelector(`.status-link[href*="/${h}"]`);E&&E.scrollIntoView(Xt)},400)),()=>{clearTimeout(D)}},[h,r]);const ee=ct((D,E)=>{const{id:O,ancestor:re,isThread:we,descendant:Ie,thread:J,replies:$e,repliesCount:Oe,weight:R,level:Q}=D,oe=O===t;return e("li",{ref:oe?A:null,class:`${re?"ancestor":""} ${Ie?"descendant":""} ${J?"thread":""} ${oe?"hero":""}`,children:[oe?e(z,{children:[e(_t,{threshold:.1,onChange:ne=>{queueMicrotask(()=>{requestAnimationFrame(()=>{ce(ne)})})},class:"status-focus",tabIndex:0,children:e(qe,{statusID:O,instance:d,withinContext:!0,size:"l",enableTranslate:!0,forceTranslate:f})}),T!=="loading"&&!v?e("div",{class:"post-status-banner",children:[e("p",{children:e(u,{id:"Vyeh4F"})}),e(he,{to:Xi?`/login?instance=${Xi}&submit=1`:"/login",class:"button",children:e(u,{id:"sQia9P"})})]}):!w&&e("div",{class:"post-status-banner",children:[e("p",{children:e(u,{id:"j5roNG",values:{instance:d},components:{0:e("b",{})}})}),e("button",{type:"button",disabled:T==="loading",onClick:()=>{k("loading"),(async()=>{try{const ne=await y.v2.search.fetch({q:Y.url,type:"statuses",resolve:!0,limit:1});if(ne.statuses.length){const Me=ne.statuses[0];location.hash=b?`/${b}/s/${Me.id}`:`/s/${Me.id}`}else throw new Error("No results")}catch(ne){k("default"),alert(g._({id:"DnepCE",values:{e:ne}}))}})()},children:[e(S,{icon:"transfer"})," ",e(u,{id:"ejAVrO"})]})]})]}):e($l,{linkable:we||re,to:d?`/${d}/s/${O}`:`/s/${O}`,onClick:()=>{bn(O)},children:[E===0&&re?e(_t,{threshold:.5,onChange:ne=>{queueMicrotask(()=>{requestAnimationFrame(()=>{Re(ne)})})},children:e(qe,{statusID:O,instance:d,withinContext:!0,size:J||re?"m":"s",enableTranslate:!0,onMediaClick:Pe,onStatusLinkClick:ve})}):e(qe,{statusID:O,instance:d,withinContext:!0,size:J||re?"m":"s",enableTranslate:!0,onMediaClick:Pe,onStatusLinkClick:ve,showActionsBar:!!Ie}),re&&Oe>1&&e("div",{class:"replies-link",children:[e(S,{icon:"comment2",alt:g._({id:"N8UzTV"})})," ",e("span",{title:Oe,children:Ke(Oe)})]})," "]}),Ie&&($e==null?void 0:$e.length)>0&&e(io,{instance:d,replies:$e,hasParentThread:J,level:Q,accWeight:R,openAll:P.current<El,parentLink:{to:d?`/${d}/s/${O}`:`/s/${O}`,onClick:()=>bn(O)}}),T==="loading"&&oe&&!!(Y!=null&&Y.repliesCount)&&!fe&&e("div",{class:"status-loading",children:e(De,{abrupt:Y.repliesCount>=3})}),T==="error"&&oe&&!!(Y!=null&&Y.repliesCount)&&!fe&&e("div",{class:"status-error",children:[e(u,{id:"HQJU6W"}),e("br",{}),e("button",{type:"button",class:"plain",onClick:()=>{x.reloadStatusPage++},children:e(u,{id:"KDw4GX"})})]})]},O)},[t,d,T,v,w,f,Pe,ve,fe]),ge=ke(()=>{var D;if("navigation"in window&&(navigation!=null&&navigation.entries)){const E=navigation.entries()[navigation.currentEntry.index-1];if(E!=null&&E.url)return Qi.test(E.url)}return Qi.test((D=x.prevLocation)==null?void 0:D.pathname)},[M]),Ae=ke(()=>{if(!te)return[];const D=[];function E(O){D.push(O.id),O.replies&&O.replies.forEach(E)}return C.slice(K).forEach(E),D.map(O=>it(O,d))},[te,C,K,d]),le=ke(()=>C.slice(0,K).map(ee),[C,K,ee]);return se(()=>{let D=setTimeout(()=>{if(!A.current)return;const E=A.current.querySelector(".spoiler-button:not(.spoiling), .spoiler-media-button:not(.spoiling)");E&&E.click()},1e3);return()=>clearTimeout(D)},[t]),e("div",{tabIndex:"-1",ref:N,class:`status-deck deck contained ${C.length>1?"padded-bottom":""} ${Le.current==="status"&&!c.current?"slide-in":""} ${l?`deck-view-${l}`:""}`,onAnimationEnd:D=>{Le.current==="status"&&(Le.current=null)},children:[e("header",{class:`${T==="loading"?"loading":""}`,onDblClick:D=>{x.reloadStatusPage++},children:e("div",{class:"header-grid header-grid-2",children:[e("h1",{children:[ge&&e("button",{type:"button",class:"plain deck-back",onClick:()=>{history.back()},children:e(S,{icon:"chevron-left",size:"xl",alt:g._({id:"iH8pgl"})})}),!H&&Y&&T!=="loading"?e(z,{children:[e("span",{class:"hero-heading",children:[e(mt,{account:Y.account,instance:d,showAvatar:!0,short:!0})," ",e("span",{class:"insignificant",children:["â€¢"," ",e(Kt,{datetime:Y.createdAt,format:"micro"})]})]})," ",e("button",{type:"button",class:"ancestors-indicator light small",onClick:D=>{D.preventDefault(),D.stopPropagation(),A.current.scrollIntoView({behavior:"smooth",block:"start"})},title:g._({id:"NCy+Nw"}),children:e(S,{icon:Se==="down"?"arrow-down":"arrow-up"})})]}):e(z,{children:[e(u,{id:"post.title"})," ",e("button",{type:"button",class:"ancestors-indicator light small",onClick:D=>{D.preventDefault(),D.stopPropagation(),N.current.scrollTo({top:0,behavior:"smooth"})},hidden:!ye.length||Ee,title:g._({id:"R8CUl0",values:{0:ye.length}}),children:[e(S,{icon:"arrow-up"}),ye.filter((D,E,O)=>O.findIndex(re=>re.accountID===D.accountID)===E).slice(0,3).map(D=>e(dt,{url:D.account.avatar,alt:D.account.displayName},D.account.id)),ye.length>3&&e(z,{children:[" ",e("span",{class:"insignificant",children:Ke(ye.length)})]})]})]})]}),e("div",{class:"header-side",children:[e("button",{type:"button",class:"plain4 button-switch-view",style:{display:l==="full"?"":"none"},onClick:()=>{p(null),s.delete("media"),s.delete("media-only"),s.delete("view"),o(s)},title:g._({id:"+/xYEI"}),children:e(S,{icon:"layout4",size:"l"})}),j&&e("button",{type:"button",class:"plain button-refresh",onClick:()=>{x.reloadStatusPage++,U(!1)},children:e(S,{icon:"refresh",size:"l",alt:g._({id:"lCF0wC"})})}),e(at,{align:"end",portal:{target:N.current},menuButton:e("button",{type:"button",class:"button plain4",children:e(S,{icon:"more",alt:g._({id:"2FYpfJ"}),size:"xl"})}),children:[e(_e,{disabled:T==="loading",onClick:()=>{x.reloadStatusPage++},children:[e(S,{icon:"refresh"}),e("span",{children:e(u,{id:"lCF0wC"})})]}),e(_e,{className:"menu-switch-view",onClick:()=>{p(l==="full"?null:"full"),s.delete("media"),s.delete("media-only"),l==="full"?s.delete("view"):s.set("view","full"),o(s)},children:[e(S,{icon:{"":"layout5",full:"layout4"}[l||""]}),e("span",{children:l==="full"?g._({id:"+/xYEI"}):g._({id:"2LiWsE"})})]}),e(_e,{onClick:()=>{Array.from(N.current.querySelectorAll(".spoiler-button:not(.spoiling), .spoiler-media-button:not(.spoiling)")).forEach(E=>{E.click()})},children:[e(S,{icon:"eye-open"})," ",e("span",{children:e(u,{id:"8r8KmB"})})]}),e(Ge,{}),e(vs,{className:"plain",children:e(u,{id:"Rsjgm0"})}),e(_e,{disabled:!F||B,onClick:()=>{const D=al(Y.url);D?location.hash=D:alert(g._({id:"9J6biQ"}))},children:[e(S,{icon:"transfer"}),e("small",{class:"menu-double-lines",children:F?g._({id:"Kp9SAs",values:{0:Nt.toUnicode(F)}}):g._({id:"lb07+k"})})]})]}),e(he,{class:"button plain deck-close",to:n,children:e(S,{icon:"x",size:"xl",alt:g._({id:"yz7wBu"})})})]})]})}),C.length&&Y?e("ul",{class:`timeline flat contextual grow ${T==="loading"?"loading":""}`,children:[le,te>0&&e("li",{children:e("button",{type:"button",class:"plain block show-more",disabled:T==="loading",onClick:()=>de(D=>D+un),style:{marginBlockEnd:"6em"},"data-state-post-ids":Ae.join(" "),children:[e("div",{class:"ib avatars-bunch",children:C.slice(K,K+5).map(D=>e(dt,{url:D.account.avatarStatic},D.id))})," ",e("div",{class:"ib",children:[e(u,{id:"uXRAkV"})," ",e("span",{class:"tag",children:te>un?`${un}+`:te})]})]})})]}):e(z,{children:[T==="loading"&&e("ul",{class:"timeline flat contextual grow loading",children:e("li",{children:e(qe,{skeleton:!0,size:"l"})})}),T==="error"&&e("p",{class:"ui-state",children:[e(u,{id:"JWxodU"}),e("br",{}),e("br",{}),e("button",{type:"button",onClick:()=>{x.reloadStatusPage++},children:e(u,{id:"KDw4GX"})})]})]})]})}function io({replies:t,instance:n,hasParentThread:i,level:s,accWeight:o,openAll:a,parentLink:h}){const[r,c]=ft(),l=k=>k.reduce((A,M)=>{const{repliesCount:P,replies:N}=M,V=(N==null?void 0:N.length)||P;return A+V+l(N||[])},0),p=t.length+l(t),f=t.length===p,m=t.map(k=>k.account).filter((k,A,M)=>M.findIndex(P=>P.id===k.id)===A).slice(0,3),d=ke(()=>t==null?void 0:t.reduce((k,A)=>k+(A==null?void 0:A.weight),o),[o,t==null?void 0:t.length]);let y=!1;(a||d<=Rl||!i&&p===1&&en(t[0])<2)&&(y=!0);const b=Jn[t[0].id],v=ct((k,A,M,P)=>{k.preventDefault(),k.stopPropagation(),c({media:A+1,mediaStatusID:P.id})},[]),w=q();gt(()=>{var A;function k(M){M.target.dataset.scrollLeft=M.target.scrollLeft}return(A=w.current)==null||A.addEventListener("scroll",k,{passive:!0}),()=>{var M;(M=w.current)==null||M.removeEventListener("scroll",k)}},[]);const[_,C]=L(b||y);se(()=>{let k;return!b&&!y&&(k=setTimeout(()=>C(!0),100)),()=>clearTimeout(k)},[b,y]);const I=y?"div":"details",T=I==="details";return e(I,{ref:w,class:"replies",open:T?b||y:void 0,onToggle:T?k=>{const{open:A}=k.target;Jn[t[0].id]=A}:void 0,style:{"--comments-level":s},"data-comments-level":s,"data-comments-level-overflow":s>4,children:[!y&&e("summary",{class:"replies-summary",hidden:y,children:[e("span",{class:"avatars",children:m.map(k=>e(dt,{url:k.avatarStatic,title:`${k.displayName} @${k.username}`,squircle:k==null?void 0:k.bot},k.id))}),e("span",{class:"replies-counts",children:[e("b",{children:e(u,{id:"DOQUen",values:{0:t.length,1:Ke(t.length)},components:{0:e("span",{title:t.length})}})}),!f&&p>1&&e(z,{children:[" ","Â·"," ",e("span",{children:e(u,{id:"qSQQSe",values:{0:Ke(p),totalComments:p},components:{0:e("span",{title:p})}})})]})]}),e(S,{icon:"chevron-down",class:"replies-summary-chevron"}),!!h&&e(he,{class:"replies-parent-link",to:h.to,onClick:h.onClick,title:g._({id:"ZlV82A"}),children:"Â»"})]}),_&&e("ul",{children:t.map(k=>{var A,M;return e("li",{children:[e("div",{class:"status-focus",tabIndex:0,children:[e(qe,{statusID:k.id,instance:n,withinContext:!0,size:"s",enableTranslate:!0,onMediaClick:v,showActionsBar:!0}),!((A=k.replies)!=null&&A.length)&&k.repliesCount>0&&e("div",{class:"replies-link",children:[e(S,{icon:"comment2",alt:g._({id:"N8UzTV"})})," ",e("span",{title:k.repliesCount,children:Ke(k.repliesCount)})]})]}),((M=k.replies)==null?void 0:M.length)&&e(io,{instance:n,replies:k.replies,level:k.level,accWeight:y?d:k.weight,openAll:a,parentLink:{to:n?`/${n}/s/${k.id}`:`/s/${k.id}`,onClick:()=>{bn(k.id)}}})]},k.id)})})]})}const Nl=140,Pl=35,Dl=70,Ol=140,Qn=new Map;function en(t){var d,y;const n=Qn.get(t.id);if(n)return n;const{spoilerText:i,content:s,mediaAttachments:o,poll:a,card:h}=t,r=ys(i+s),c=o!=null&&o.length?Nl:0,l=(((d=a==null?void 0:a.options)==null?void 0:d.length)||0)*Pl,p=h&&(o!=null&&o.length||(y=a==null?void 0:a.options)!=null&&y.length)?0:Dl,m=(r+c+l+p)/Ol;return Qn.set(t.id,m),m}const zl=st(Ll);function Ul(){const t=Mt(),{id:n,instance:i}=t;return e(zl,{id:n,instance:i})}const Bl=""+new URL("boosts-carousel-YjmjXTE6.jpg",import.meta.url).href,Fl=""+new URL("grouped-notifications-xYMFVY91.jpg",import.meta.url).href,Hl=""+new URL("multi-column-ETnJNDVb.jpg",import.meta.url).href,Yl=""+new URL("multi-hashtag-timeline-x-SDVR4g.jpg",import.meta.url).href,ql=""+new URL("nested-comments-thread-Ib-fZGS3.jpg",import.meta.url).href,jl="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20fill-rule='evenodd'%20stroke-linejoin='round'%20stroke-miterlimit='2'%20clip-rule='evenodd'%20viewBox='0%200%20102%2028'%3e%3cpath%20fill='none'%20d='M0%200h101.5v27.5H0z'/%3e%3cg%20fill-rule='nonzero'%3e%3cpath%20fill='url(%23a)'%20d='M2.32%2021.85c1.4%200%202.21-.85%202.21-2.3v-4.64H8.5c4.45%200%207.54-2.9%207.54-7.24%200-4.35-2.98-7.24-7.32-7.24h-6.4C.93.43.11%201.28.11%202.73v16.82c0%201.45.82%202.3%202.21%202.3Zm2.21-10.4V3.94h3c2.54%200%204%201.34%204%203.75s-1.47%203.76-4%203.76h-3Z'/%3e%3cpath%20fill='url(%23b)'%20d='M20.52%2021.88c1.25%200%202.13-.76%202.13-2.23v-7.04c0-2.07%201.2-3.49%203.21-3.49%201.95%200%202.95%201.23%202.95%203.25v7.28c0%201.47.89%202.23%202.13%202.23%201.26%200%202.14-.76%202.14-2.23v-8.18c0-3.64-1.99-5.9-5.48-5.9-2.38%200-4.1%201.12-4.93%203.1h-.09V2.3c0-1.38-.78-2.2-2.1-2.2-1.31%200-2.1.82-2.1%202.2v17.34c0%201.47.9%202.23%202.14%202.23Z'/%3e%3cpath%20fill='url(%23c)'%20d='M40.45%2021.82c1.96%200%203.93-.98%204.8-2.65h.1v.8c.08%201.27.89%201.91%202.05%201.91%201.21%200%202.08-.73%202.08-2.15v-8.95c0-3.17-2.63-5.25-6.65-5.25-3.26%200-5.78%201.16-6.5%203.04-.15.32-.23.63-.23.96%200%20.97.75%201.64%201.79%201.64.69%200%201.23-.26%201.7-.79.95-1.23%201.74-1.65%203.04-1.65%201.62%200%202.64.85%202.64%202.31v1.04l-3.95.24c-3.93.23-6.13%201.88-6.13%204.74%200%202.83%202.27%204.76%205.26%204.76Zm1.4-3.09c-1.43%200-2.4-.73-2.4-1.9%200-1.12.91-1.83%202.51-1.95l3.31-.2v1.14c0%201.7-1.54%202.91-3.41%202.91Z'/%3e%3cpath%20fill='url(%23d)'%20d='M54.37%2021.88c1.26%200%202.14-.76%202.14-2.23v-7.09c0-2.03%201.21-3.44%203.13-3.44s2.89%201.17%202.89%203.22v7.31c0%201.47.88%202.23%202.14%202.23%201.24%200%202.13-.76%202.13-2.23v-8.2c0-3.68-1.96-5.87-5.45-5.87-2.41%200-4%201.07-4.83%203.01h-.09v-.87c0-1.35-.85-2.17-2.14-2.17-1.28%200-2.06.82-2.06%202.15v11.95c0%201.47.9%202.23%202.14%202.23Z'/%3e%3cpath%20fill='url(%23e)'%20d='M71.65%2027.17c1.26%200%202.14-.76%202.14-2.23v-6h.09a5.15%205.15%200%200%200%204.88%202.88c3.92%200%206.35-3.05%206.35-8.1%200-5.07-2.44-8.1-6.43-8.1a5.12%205.12%200%200%200-4.86%202.99h-.09v-.85c0-1.45-.88-2.21-2.1-2.21-1.24%200-2.11.76-2.11%202.2v17.2c0%201.46.89%202.22%202.13%202.22Zm5.6-8.8c-2.1%200-3.47-1.8-3.47-4.65%200-2.81%201.37-4.67%203.47-4.67%202.14%200%203.49%201.83%203.49%204.67%200%202.86-1.35%204.66-3.5%204.66Z'/%3e%3cpath%20fill='url(%23f)'%20d='M89.61%2027.39c3.44%200%205.26-1.5%206.73-5.55l4.81-13.1a4%204%200%200%200%20.24-1.26c0-1.13-.85-1.93-2.08-1.93-1.1%200-1.71.51-2.07%201.7l-3.4%2010.9h-.08L90.35%207.28c-.36-1.25-.94-1.73-2.07-1.73-1.26%200-2.21.83-2.21%201.99%200%20.35.09.82.25%201.26l5%2013.21-.21.56c-.52%201.1-1.32%201.42-2.07%201.42l-.75-.01c-.96%200-1.56.54-1.56%201.4%200%201.29%201%202%202.88%202Z'/%3e%3c/g%3e%3cdefs%3e%3cradialGradient%20id='a'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3cradialGradient%20id='b'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3cradialGradient%20id='c'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3cradialGradient%20id='d'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3cradialGradient%20id='e'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3cradialGradient%20id='f'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3c/defs%3e%3c/svg%3e",Vl={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Blaede Phanpy",PHANPY_DEFAULT_INSTANCE:"mastodon.blaede.family",PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:"https://mastodon.blaede.family/auth/sign_up",PHANPY_GIPHY_API_KEY:"48JGsrSS1XE5w4nWe9c9hqxPbsfRWR0e",PHANPY_LINGVA_INSTANCES:"lingva.phanpy.social lingva.lunar.icu lingva.garudalinux.org translate.plausibility.cloud",PHANPY_PRIVACY_POLICY_URL:"https://mastodon.blaede.family/privacy-policy",PHANPY_WEBSITE:"https://phanpy.blaede.family",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},{PHANPY_DEFAULT_INSTANCE:Jt,PHANPY_WEBSITE:ts,PHANPY_PRIVACY_POLICY_URL:Gl,PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:ns}=Vl,is=ts?ts.replace(/https?:\/\//g,"").replace(/\/$/,""):null,ss=`${"2024-11-21T20:47:04.719Z".slice(0,10).replace(/-/g,".")}.edb2281`;function so(){return Xe(null,["/","/welcome"]),e("main",{id:"welcome",children:[e("div",{class:"hero-container",children:[e("div",{class:"hero-content",children:[e("h1",{children:[e("img",{src:hi,alt:"",width:"160",height:"160",style:{aspectRatio:"1/1",marginBlockEnd:-16}}),e("img",{src:jl,alt:"Phanpy",width:"200"})]}),e("p",{class:"desc",children:e(u,{id:"Ogtv0V"})}),e("p",{children:e(he,{to:Jt?`/login?instance=${Jt}&submit=1`:"/login",class:"button",children:Jt?g._({id:"sQia9P"}):g._({id:"ZLoGls"})})}),Jt&&ns&&e("p",{children:e("a",{href:ns,class:"button plain5",children:e(u,{id:"e+RpCP"})})}),!Jt&&e("p",{class:"insignificant",children:e("small",{children:e(u,{id:"fvAsUK",components:{0:e("br",{})}})})})]}),(is||ss)&&e("p",{class:"app-site-version",children:e("small",{children:[is," ",ss]})}),e("p",{children:e(u,{id:"BskFI2",components:{0:e("a",{href:"https://github.com/cheeaun/phanpy",target:"_blank"}),1:e("a",{href:"https://mastodon.social/@cheeaun",target:"_blank",onClick:t=>{t.preventDefault(),x.showAccount="cheeaun@mastodon.social"}}),2:e("a",{href:Gl,target:"_blank"})}})}),e("div",{children:e(fi,{})})]}),e("div",{id:"why-container",children:e("div",{class:"sections",children:[e("section",{children:[e("img",{src:Bl,alt:g._({id:"S5cYrQ"}),loading:"lazy"}),e("h4",{children:e(u,{id:"Tu+sCN"})}),e("p",{children:e(u,{id:"e2uVlo"})})]}),e("section",{children:[e("img",{src:ql,alt:g._({id:"CGQ27z"}),loading:"lazy"}),e("h4",{children:e(u,{id:"cYE45+"})}),e("p",{children:e(u,{id:"Pc7QKh"})})]}),e("section",{children:[e("img",{src:Fl,alt:g._({id:"rnrM7k"}),loading:"lazy"}),e("h4",{children:e(u,{id:"4RRMre"})}),e("p",{children:e(u,{id:"8GMtDr"})})]}),e("section",{children:[e("img",{src:Hl,alt:g._({id:"VLKtvP"}),loading:"lazy"}),e("h4",{children:e(u,{id:"pEkad9"})}),e("p",{children:e(u,{id:"t7Py5R"})})]}),e("section",{children:[e("img",{src:Yl,alt:g._({id:"wOax6E"}),loading:"lazy"}),e("h4",{children:e(u,{id:"Wi1Ov0"})}),e("p",{children:e(u,{id:"tS2i+h"})})]})]})})]})}const Kl=window.alert;window.__nativeAlert||(window.__nativeAlert=Kl);window.alert=function(t){t instanceof Error&&(t!=null&&t.message)&&(t=t.message),typeof t!="string"&&(t=JSON.stringify(t));const n=qo({text:t,className:"alert",gravity:"top",position:"center",duration:1e4,offset:{y:48},onClick:()=>{n.hideToast()}});n.showToast()};window.__STATES__=x;window.__STATES_STATS__=()=>{const t=["statuses","accounts","spoilers","unfurledLinks","statusQuotes"],n={};t.forEach(o=>{n[o]=Object.keys(x[o]).length});const{statuses:i}=x,s=[];for(const o in i)document.querySelector(`[data-state-post-id~="${o}"], [data-state-post-ids~="${o}"]`)||s.push(o)};setInterval(()=>{if(!window.__IDLE__)return;const{statuses:t,unfurledLinks:n,notifications:i}=x;let s=0;const{instance:o}=ae();for(const a in t){if(!window.__IDLE__)break;try{const h=document.querySelector(`[data-state-post-id~="${a}"], [data-state-post-ids~="${a}"]`),r=i.some(c=>{var l;return a===it((l=c.status)==null?void 0:l.id,o)});if(!h&&!r){delete x.statuses[a],delete x.statusQuotes[a];for(const c in n){const l=n[c];if(it(l.id,l.instance)===a){delete x.unfurledLinks[c];break}}s++}}catch{}}},15*60*1e3);setTimeout(()=>{for(const t in zt)setTimeout(()=>{var n,i,s,o,a,h;Array.isArray(zt[t])?(i=(n=zt[t])[0])==null||i.call(n):typeof zt[t]=="object"?(o=(s=zt[t]).module)==null||o.call(s):(h=(a=zt)[t])==null||h.call(a)},1)},5e3);(()=>{window.__IDLE__=!0;const t=["mousemove","mousedown","resize","keydown","touchstart","pointerdown","pointermove","wheel"],n=()=>{window.__IDLE__=!0},s=ws(n,3e3),o=()=>{window.__IDLE__=!1,s()};t.forEach(a=>{window.addEventListener(a,o,{passive:!0,capture:!0})}),window.addEventListener("blur",n,{passive:!0}),document.documentElement.addEventListener("mouseleave",a=>{!a.relatedTarget&&!a.toElement&&n()},{passive:!0})})();const Wl=/iPad|iPhone|iPod/.test(navigator.userAgent);Wl&&document.addEventListener("visibilitychange",()=>{if(document.visibilityState==="visible"){if(document.getElementsByClassName("media-modal-container").length>0)return;const n=be.local.get("theme");let i;if(n){if(i=document.querySelector('meta[name="theme-color"][data-theme-setting="manual"]'),i){const s=i.content,o=n==="light"?i.dataset.themeLightColorTemp:i.dataset.themeDarkColorTemp;i.content=o||"",setTimeout(()=>{i.content=s},10)}}else{const s=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";if(i=document.querySelector(`meta[name="theme-color"][media*="${s}"]`),i){const o=i.dataset.content,a=i.dataset.contentTemp;i.content=a||"",setTimeout(()=>{i.content=o},10)}}}});{const t=be.local.get("theme");if(t){document.documentElement.classList.add(`is-${t}`),document.querySelector('meta[name="color-scheme"]').setAttribute("content",t||"dark light");const i=document.querySelector('meta[data-theme-setting="manual"]');i&&(i.name="theme-color",i.content=t==="light"?i.dataset.themeLightColor:i.dataset.themeDarkColor),document.querySelectorAll('meta[data-theme-setting="auto"]').forEach(o=>{o.name=""})}const n=be.local.get("textSize");n&&document.documentElement.style.setProperty("--text-size",`${n}px`)}as(x,t=>{var n;for(const[i,s,o,a]of t){if(s.join(".")==="settings.shortcutsViewMode"){const h=document.getElementById("app");h&&(h.dataset.shortcutsViewMode=(n=x.shortcuts)!=null&&n.length?o:"")}s.join(".")==="settings.cloakMode"&&document.body.classList.toggle("cloak",o)}});const hn=new Map;window.__BENCH_RESULTS=new Map;window.__BENCHMARK={start(t){},end(t){}};function Zl(){const[t,n]=L(!1),[i,s]=L("loading");__BENCHMARK.start("app-init"),__BENCHMARK.start("time-to-following"),__BENCHMARK.start("time-to-home"),__BENCHMARK.start("time-to-isLoggedIn"),Qe(),se(()=>{const a=be.local.get("instanceURL"),h=decodeURIComponent((window.location.search.match(/code=([^&]+)/)||[,""])[1]);if(h){window.history.replaceState({},document.title,window.location.pathname||"/");const r=be.sessionCookie.get("clientID"),c=be.sessionCookie.get("clientSecret"),l=be.sessionCookie.get("vapidKey"),p=be.sessionCookie.get("codeVerifier");(async()=>{s("loading");const{access_token:f}=await Cl({instanceURL:a,client_id:r,client_secret:c,code:h,code_verifier:p||void 0});if(f){const m=wo({instance:a,accessToken:f});await Promise.allSettled([Nn(m),Pn(m,a),_o(m,a,f,l)]),Si(),window.__IGNORE_GET_ACCOUNT_ERROR__=!0,n(!0),s("default")}else s("error");__BENCHMARK.end("app-init")})()}else{window.__IGNORE_GET_ACCOUNT_ERROR__=!0;const r=decodeURIComponent((window.location.search.match(/account=([^&]+)/)||[,""])[1]);let c;if(r&&(c=ko(r),c&&(yn(c.info.id),window.history.replaceState({},document.title,window.location.pathname||"/"))),c||(c=ei()),c){yn(c.info.id);const{client:l}=ae({account:c}),{instance:p}=l;Si(),s("loading"),(async()=>{try{So()&&Co(p)?(Nn(l),Pn(l,p)):await Promise.allSettled([Nn(l),Pn(l,p)])}catch{}finally{n(!0),s("default"),__BENCHMARK.end("app-init")}})()}else s("default"),__BENCHMARK.end("app-init")}be.sessionCookie.del("clientID"),be.sessionCookie.del("clientSecret"),be.sessionCookie.del("codeVerifier")},[]);let o=Gt();return x.currentLocation=o.pathname,se(Kn,[o,t]),/\/https?:/.test(o.pathname)?e(rl,{}):i==="loading"?e(De,{id:"loader-root"}):e(z,{children:[e(Jl,{isLoggedIn:t}),e(Ql,{isLoggedIn:t}),e(ni,{children:e(Ve,{path:"/:instance?/s/:id",element:e(Ul,{})})}),t&&e(Ko,{}),t&&e(Pa,{}),e(xa,{}),t&&e($a,{}),e(Go,{isLoggedIn:t}),e(Ma,{onClose:Kn}),e(Wo,{})]})}function Xl({isLoggedIn:t}){return t&&__BENCHMARK.end("time-to-isLoggedIn"),t?e(ol,{}):e(so,{})}const Jl=st(({isLoggedIn:t})=>{const n=Gt(),i=ke(()=>{const{pathname:s}=n;return!/^\/(login|welcome)/i.test(s)},[n]);return e(ni,{location:i||n,children:[e(Ve,{path:"/",element:e(Xl,{isLoggedIn:t})}),e(Ve,{path:"/login",element:e(Al,{})}),e(Ve,{path:"/welcome",element:e(so,{})})]})});function os(){return x.prevLocation||null}function Ql({isLoggedIn:t}){const n=Gt(),i=q(os());return ke(()=>tn("/:instance/s/:id",n.pathname)||tn("/s/:id",n.pathname),[n.pathname,tn])?i.current||(i.current=os()):i.current=null,e(ni,{location:i.current||n,children:[t&&e(z,{children:[e(Ve,{path:"/notifications",element:e(Xs,{})}),e(Ve,{path:"/mentions",element:e(Gs,{})}),e(Ve,{path:"/following",element:e(wi,{})}),e(Ve,{path:"/b",element:e(Us,{})}),e(Ve,{path:"/f",element:e(Bs,{})}),e(Ve,{path:"/l",children:[e(Ve,{index:!0,element:e(ll,{})}),e(Ve,{path:":id",element:e(Ys,{})})]}),e(Ve,{path:"/fh",element:e(Sr,{})}),e(Ve,{path:"/ft",element:e(vr,{})}),e(Ve,{path:"/catchup",element:e(ar,{})})]}),e(Ve,{path:"/:instance?/t/:hashtag",element:e(Hs,{})}),e(Ve,{path:"/:instance?/a/:id",element:e(Ja,{})}),e(Ve,{path:"/:instance?/p",children:[e(Ve,{index:!0,element:e(Xn,{})}),e(Ve,{path:"l",element:e(Xn,{local:!0})})]}),e(Ve,{path:"/:instance?/trending",element:e(eo,{})}),e(Ve,{path:"/:instance?/search",element:e(Js,{})})]})}Io();xo(e(To,{i18n:g,children:e(Ao,{children:e(Zl,{})})}),document.getElementById("app"));setTimeout(()=>{try{Object.keys(localStorage).forEach(t=>{t.startsWith("iconify")&&localStorage.removeItem(t)}),Object.keys(sessionStorage).forEach(t=>{t.startsWith("iconify")&&sessionStorage.removeItem(t)}),localStorage.removeItem("settings:boostsCarousel")}catch{}},5e3);if("serviceWorker"in navigator&&typeof caches<"u"){const n=["icons"];let i=!1;const s=1e4,o=60*60*1e3;async function a(){if(window.__IDLE__)try{const h=await caches.keys();for(const r of h){if(n.includes(r))continue;const c=await caches.open(r),l=await c.keys();if(l.length>50){const p=l.slice(50);for(const f of p)await c.delete(f)}}i=!0}catch{}setTimeout(a,i?o:s)}setTimeout(a,s)}window.__CLOAK__=()=>{document.body.classList.toggle("cloak")};
//# sourceMappingURL=main-IyHcHPLt.js.map
