import{A as q,y as Q,M as ut,u as re,d as M,s as x,a as le,b as et,p as bt,c as We,q as it,g as kt,e,k as U,T as f,f as ri,h as Lt,i as qt,j as In,l as Ae,L as _o,C as Hn,D as Co,n as ze,o as Io,r as Tn,t as di,v as To,w as ui,x as Jt,z as pe,B as Ao,E as Be,F as An,G as xn,_ as St,H as vs,I as Ud,J as ws,K as ks,N as xo,O as Eo,P as rt,Q as Ro,R as hi,S as Lo,U as vt,V as Mo,W as $o,X as fi,Y as Mt,Z as tt,$ as Ss,a0 as _s,a1 as No,a2 as Cs,a3 as Po,a4 as Do,a5 as cn,a6 as Oo,a9 as zo,aa as Yn,ab as qn,ac as Uo,ad as Ni,ae as Bo,af as Fo,ag as Ko,ah as pi,ai as Xe,ak as Ho,al as Yo,am as qo,an as jo}from"./useTitle-ChYo3H7J.js";import{u as mi,w as Ye,s as fe,o as Pi,a as Vo,V as Is,b as Ts,I,C as gi,c as As,M as je,d as Ve,S as dn,e as ye,f as Pn,R as _t,n as ct,g as qe,A as mt,N as yt,h as dt,i as pt,L as ge,l as Et,j as Go,k as xs,p as Yd,m as Je,q as ot,r as un,t as ft,v as ei,x as Es,E as Rs,y as Qe,z as Di,T as Ls,B as Dn,D as gt,F as Ge,G as Tt,H as Wo,J as Zo,K as Ot,O as yi,P as Ms,Q as Xo,U as Vt,W as Jo,X as Qo,Y as On,Z as ec,_ as zt,$ as tc,a0 as $s,a1 as Ns,a2 as nc,a3 as bi,a4 as ic,a5 as sc,a6 as oc,a7 as cc,a8 as ac,a9 as lc,aa as Oi,ab as rc,ac as Kt}from"./ScheduledAtField-BYw03-pF.js";var Ps=dc;function dc(n,i,s){var o=null,c=null,l=function(){o&&(clearTimeout(o),c=null,o=null)},u=function(){var d=c;l(),d&&d()},r=function(){if(!i)return n.apply(this,arguments);var d=this,a=arguments,h=s&&!o;if(l(),c=function(){n.apply(d,a)},o=setTimeout(function(){if(o=null,!h){var p=c;return c=null,p()}},i),h)return c()};return r.cancel=l,r.flush=u,r}/*!
 * swiped-events.js - v@version@
 * Pure JavaScript swipe events
 * https://github.com/john-doherty/swiped-events
 * @inspiration https://stackoverflow.com/questions/16348031/disable-scrolling-when-touch-moving-certain-element
 * @author John Doherty <www.johndoherty.info>
 * @license MIT
 */(function(n,i){"use strict";typeof n.CustomEvent!="function"&&(n.CustomEvent=function(y,b){b=b||{bubbles:!1,cancelable:!1,detail:void 0};var w=i.createEvent("CustomEvent");return w.initCustomEvent(y,b.bubbles,b.cancelable,b.detail),w},n.CustomEvent.prototype=n.Event.prototype),i.addEventListener("touchstart",h,!1),i.addEventListener("touchmove",p,!1),i.addEventListener("touchend",a,!1);var s=null,o=null,c=null,l=null,u=null,r=null,d=0;function a(y){if(r===y.target){var b=parseInt(g(r,"data-swipe-threshold","20"),10),w=g(r,"data-swipe-unit","px"),v=parseInt(g(r,"data-swipe-timeout","500"),10),m=Date.now()-u,S="",C=y.changedTouches||y.touches||[];if(w==="vh"&&(b=Math.round(b/100*i.documentElement.clientHeight)),w==="vw"&&(b=Math.round(b/100*i.documentElement.clientWidth)),Math.abs(c)>Math.abs(l)?Math.abs(c)>b&&m<v&&(c>0?S="swiped-left":S="swiped-right"):Math.abs(l)>b&&m<v&&(l>0?S="swiped-up":S="swiped-down"),S!==""){var T={dir:S.replace(/swiped-/,""),touchType:(C[0]||{}).touchType||"direct",fingers:d,xStart:parseInt(s,10),xEnd:parseInt((C[0]||{}).clientX||-1,10),yStart:parseInt(o,10),yEnd:parseInt((C[0]||{}).clientY||-1,10)};r.dispatchEvent(new CustomEvent("swiped",{bubbles:!0,cancelable:!0,detail:T})),r.dispatchEvent(new CustomEvent(S,{bubbles:!0,cancelable:!0,detail:T}))}s=null,o=null,u=null}}function h(y){y.target.getAttribute("data-swipe-ignore")!=="true"&&(r=y.target,u=Date.now(),s=y.touches[0].clientX,o=y.touches[0].clientY,c=0,l=0,d=y.touches.length)}function p(y){if(!(!s||!o)){var b=y.touches[0].clientX,w=y.touches[0].clientY;c=s-b,l=o-w}}function g(y,b,w){for(;y&&y!==i.documentElement;){var v=y.getAttribute(b);if(v)return v;y=y.parentNode}return w}})(window,document);function Gt(n=()=>{},i=[]){const s=q(n);Q(()=>{s.current=n},[i]),Q(()=>{const o=()=>{const c=document.hidden||document.visibilityState==="hidden";s.current(!c)};return document.addEventListener("visibilitychange",o),()=>document.removeEventListener("visibilitychange",o)},[])}const uc=1e3*3,zi=2e4,hc=ut(function({isLoggedIn:i}){const{_:s}=re(),[o,c]=M(!0),l=q();Gt(a=>{clearTimeout(l.current),a?c(!0):l.current=setTimeout(()=>{c(!1)},zi)});const u=async(a,h,p)=>{var g;if(x.notificationsLast){const y=a.v1.notifications.list({limit:1,sinceId:x.notificationsLast.id}).values(),{value:b}=await y.next();if(b!=null&&b.length)if(p)x.notificationsShowNew=!0;else{let w;try{const v=await a.v1.markers.fetch({timeline:"notifications"});w=(g=v==null?void 0:v.notifications)==null?void 0:g.lastReadId}catch{}w?x.notificationsShowNew=b[0].id!==w:x.notificationsShowNew=!0}}};Q(()=>{let a,h,p;if(i&&o){const{masto:g,streaming:y,instance:b}=le();(async()=>{await u(g,b);let w=!1;y&&(h=setTimeout(()=>{(async()=>{try{w=!0,a=y.user.notification.subscribe();for await(const v of a){if(!a||!o)break;v.event==="notification"&&et(v.payload,b,{skipThreading:!0}),x.notificationsShowNew=!0}}catch{w=!1}w||(p=setInterval(()=>{u(g,b,!0)},zi))})()},uc))})()}return()=>{var g;(g=a==null?void 0:a.unsubscribe)==null||g.call(a),a=null,clearTimeout(h),clearInterval(p)}},[o,i]);const r=q(),d=()=>{r.current=Date.now(),fetch("./version.json").then(a=>a.json()).then(a=>{a&&(x.appVersion=a)}).catch(a=>{})};return mi(d,o&&1e3*60*30),Gt(a=>{a&&(r.current?Date.now()-r.current>1e3*60*60&&d():d())}),Ye("shift+alt+k",a=>{if(!a.shiftKey||!a.altKey)return;const h=x.settings.cloakMode;x.settings.cloakMode=!h,fe({text:s(h?{id:"oguMwa"}:{id:"IXZLPs"})})},{useKey:!0,ignoreEventWhen:a=>a.metaKey||a.ctrlKey}),null}),fc=bt(async(n,i)=>{const s=n.v1.accounts.$select(i).statuses.list({limit:3,exclude_replies:!0,exclude_reblogs:!0}).values(),{value:o}=await s.next();return o||[]},{maxAge:6e4});function pc(){const{_:n}=re(),i=We(x),{masto:s}=le(),[o,c]=M(!1),[l,u]=M([]),[r,d]=M(!1),a=q(null),h=q(null),p=i.settings.shortcutsViewMode==="multi-column";function g(v){if(v.key&&v.key.toLowerCase()!=="c")return;if(i.composerState.minimized){x.composerState.minimized=!1,Pi();return}const m=document.querySelectorAll("data.compose-data"),S=!p&&m.length===1?JSON.parse(m[0].value):void 0;v.shiftKey?Vo(S)||(x.showCompose=S||!0):(Pi(),x.showCompose=S||!0)}Ye("c, shift+c",g,{useKey:!0,ignoreEventWhen:v=>!!document.querySelector("#modal-container > *")||v.metaKey||v.ctrlKey||v.altKey});const y=Is(()=>{c(!0)},{threshold:600}),b=it(async()=>{try{d(!0);const v=kt();if(!v)return;const m=await fc(s,v);u(m)}catch{}finally{d(!1)}},[s]),w=it(v=>{Ts({replyToStatus:v}),c(!1)},[]);return Q(()=>{o&&b()},[b,o]),e(U,{children:[e("button",{ref:a,type:"button",id:"compose-button",onClick:g,onContextMenu:v=>{v.preventDefault(),c(!0)},...y(),class:`${i.composerState.minimized?"min":""} ${i.composerState.publishing?"loading":""} ${i.composerState.publishingError?"error":""}`,children:e(I,{icon:"quill",size:"xl",alt:n({id:"QOhkyl"})})}),e(gi,{ref:h,state:o?"open":void 0,anchorRef:a,onClose:()=>c(!1),direction:"top",gap:8,unmountOnClose:!0,portal:{target:document.body},boundingBoxPadding:As(),containerProps:{style:{zIndex:19},onClick:()=>{var v,m;(m=(v=h.current)==null?void 0:v.closeMenu)==null||m.call(v)}},submenuOpenDelay:600,children:[e(je,{to:"/sp",children:[e(I,{icon:"schedule"})," ",e("span",{children:e(f,{id:"+GkIdc"})})]}),e(Ve,{}),e(dn,{align:"end",direction:"top",shift:-8,disabled:r||l.length===0,label:e(U,{children:[e(I,{icon:"comment"})," ",e("span",{className:"menu-grow",children:e(f,{id:"LwOr4P"})}),r?"…":e(I,{icon:"chevron-right"})]}),children:l.length>0&&l.map(v=>{const m=new Date(v.createdAt),S=new Date().getTime()-m.getTime()<864e5;return e(ye,{onClick:()=>w(v),children:e("small",{children:[e("div",{class:"menu-post-text",children:Pn(v)}),e("span",{className:"more-insignificant",children:[S&&e(U,{children:[e(_t,{datetime:m,format:"micro"})," ","‒"," "]}),e("time",{className:"created",dateTime:m.toISOString(),title:m.toLocaleString(),children:ct(v.createdAt)})]})]})},v.id)})})]})]})}const mc=ut(function(){const{_:i}=re(),s=We(x);function o(){x.showKeyboardShortcutsHelp=!1}return Ye("?",()=>{x.showKeyboardShortcutsHelp=!0},{useKey:!0,ignoreEventWhen:c=>/\/catchup/i.test(location.hash)||c.metaKey||c.ctrlKey||c.altKey}),!!s.showKeyboardShortcutsHelp&&e(qe,{onClose:o,children:e("div",{id:"keyboard-shortcuts-help-container",class:"sheet",tabindex:"-1",children:[e("button",{type:"button",class:"sheet-close",onClick:o,children:e(I,{icon:"x",alt:i({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(f,{id:"77Emn0"})})}),e("main",{children:e("table",{children:e("tbody",{children:[{action:i({id:"ulXSNi"}),keys:e("kbd",{children:"?"})},{action:i({id:"Gy9P9T"}),keys:e("kbd",{children:"j"})},{action:i({id:"6XYpYY"}),keys:e("kbd",{children:"k"})},{action:i({id:"DYowFe"}),keys:e(f,{id:"mzjGX4",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"S5ez7Y"}),keys:e(f,{id:"Fd8FaU",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"VkLESX"}),keys:e("kbd",{children:"."})},{action:i({id:"jsFF8C"}),keys:e(f,{id:"80sOCm",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:e(f,{id:"41gejM",components:{0:e("br",{})}}),keys:e("kbd",{children:"x"})},{action:i({id:"jAj8rv"}),keys:e(f,{id:"evz6c6",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"duF1lx"}),keys:e(f,{id:"nhpsIN",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"YrR3Co"}),keys:e("kbd",{children:"]"})},{action:i({id:"noxAFR"}),keys:e("kbd",{children:"["})},{action:i({id:"AIa/f7"}),keys:e("kbd",{children:"c"})},{action:i({id:"snPx8X"}),className:"insignificant",keys:e(f,{id:"+Cxvld",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"1pKapz"}),keys:e(f,{id:"py67WT",components:{0:e("kbd",{}),1:e("kbd",{}),2:e("kbd",{}),3:e("kbd",{})}})},{action:i({id:"A1taO8"}),keys:e("kbd",{children:"/"})},{action:i({id:"ImOQa9"}),keys:e("kbd",{children:"r"})},{action:i({id:"KFs8c6"}),className:"insignificant",keys:e(f,{id:"XpQLJF",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"cqi4Mx"}),keys:e(f,{id:"84WuL2",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"kulphB"}),keys:e(f,{id:"yrz6Ck",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"PZlHt8"}),keys:e("kbd",{children:"d"})},{action:i({id:"C7ujRh"}),keys:e(f,{id:"v4TbMP",components:{0:e("kbd",{}),1:e("kbd",{}),2:e("kbd",{})}})}].map(({action:c,className:l,keys:u})=>e("tr",{children:[e("th",{class:l,children:c}),e("td",{children:u})]},c))})})})]})})}),Ds=new Set,lt=new WeakMap,Wt=new WeakMap,Ut=new WeakMap,ti=new WeakMap,gc=new WeakMap,Zt=new WeakMap,En=new WeakMap,sn=new WeakSet;let Rt,vi=0,wi=0;const Ct="__aa_tgt",an="__aa_del",Rn="__aa_new",yc=n=>{const i=_c(n);i&&i.forEach(s=>Cc(s))},bc=n=>{n.forEach(i=>{i.target===Rt&&wc(),lt.has(i.target)&&Ft(i.target)})};function vc(n){const i=ti.get(n);i==null||i.disconnect();let s=lt.get(n),o=0;const c=5;s||(s=Xt(n),lt.set(n,s));const{offsetWidth:l,offsetHeight:u}=Rt,d=[s.top-c,l-(s.left+c+s.width),u-(s.top+c+s.height),s.left-c].map(h=>`${-1*Math.floor(h)}px`).join(" "),a=new IntersectionObserver(()=>{++o>1&&Ft(n)},{root:Rt,threshold:1,rootMargin:d});a.observe(n),ti.set(n,a)}function Ft(n){clearTimeout(En.get(n));const i=zn(n),s=ln(i)?500:i.duration;En.set(n,setTimeout(async()=>{const o=Ut.get(n);try{await(o==null?void 0:o.finished),lt.set(n,Xt(n)),vc(n)}catch{}},s))}function wc(){clearTimeout(En.get(Rt)),En.set(Rt,setTimeout(()=>{Ds.forEach(n=>Bs(n,i=>Os(()=>Ft(i))))},100))}function kc(n){setTimeout(()=>{gc.set(n,setInterval(()=>Os(Ft.bind(null,n)),2e3))},Math.round(2e3*Math.random()))}function Os(n){typeof requestIdleCallback=="function"?requestIdleCallback(()=>n()):requestAnimationFrame(()=>n())}let ni,jt;const Sc=typeof window<"u"&&"ResizeObserver"in window;Sc&&(Rt=document.documentElement,ni=new MutationObserver(yc),jt=new ResizeObserver(bc),window.addEventListener("scroll",()=>{wi=window.scrollY,vi=window.scrollX}),jt.observe(Rt));function _c(n){return n.reduce((o,c)=>[...o,...Array.from(c.addedNodes),...Array.from(c.removedNodes)],[]).every(o=>o.nodeName==="#comment")?!1:n.reduce((o,c)=>{if(o===!1)return!1;if(c.target instanceof Element){if(jn(c.target),!o.has(c.target)){o.add(c.target);for(let l=0;l<c.target.children.length;l++){const u=c.target.children.item(l);if(u){if(an in u)return!1;jn(c.target,u),o.add(u)}}}if(c.removedNodes.length)for(let l=0;l<c.removedNodes.length;l++){const u=c.removedNodes[l];if(an in u)return!1;u instanceof Element&&(o.add(u),jn(c.target,u),Wt.set(u,[c.previousSibling,c.nextSibling]))}}return o},new Set)}function jn(n,i){!i&&!(Ct in n)?Object.defineProperty(n,Ct,{value:n}):i&&!(Ct in i)&&Object.defineProperty(i,Ct,{value:n})}function Cc(n){var i;const s=n.isConnected,o=lt.has(n);s&&Wt.has(n)&&Wt.delete(n),Ut.has(n)&&((i=Ut.get(n))===null||i===void 0||i.cancel()),Rn in n?Ui(n):o&&s?Tc(n):o&&!s?Ac(n):Ui(n)}function wt(n){return Number(n.replace(/[^0-9.\-]/g,""))}function Ic(n){let i=n.parentElement;for(;i;){if(i.scrollLeft||i.scrollTop)return{x:i.scrollLeft,y:i.scrollTop};i=i.parentElement}return{x:0,y:0}}function Xt(n){const i=n.getBoundingClientRect(),{x:s,y:o}=Ic(n);return{top:i.top+o,left:i.left+s,width:i.width,height:i.height}}function zs(n,i,s){let o=i.width,c=i.height,l=s.width,u=s.height;const r=getComputedStyle(n);if(r.getPropertyValue("box-sizing")==="content-box"){const a=wt(r.paddingTop)+wt(r.paddingBottom)+wt(r.borderTopWidth)+wt(r.borderBottomWidth),h=wt(r.paddingLeft)+wt(r.paddingRight)+wt(r.borderRightWidth)+wt(r.borderLeftWidth);o-=h,l-=h,c-=a,u-=a}return[o,l,c,u].map(Math.round)}function zn(n){return Ct in n&&Zt.has(n[Ct])?Zt.get(n[Ct]):{duration:250,easing:"ease-in-out"}}function Us(n){if(Ct in n)return n[Ct]}function ki(n){const i=Us(n);return i?sn.has(i):!1}function Bs(n,...i){i.forEach(s=>s(n,Zt.has(n)));for(let s=0;s<n.children.length;s++){const o=n.children.item(s);o&&i.forEach(c=>c(o,Zt.has(o)))}}function Si(n){return Array.isArray(n)?n:[n]}function ln(n){return typeof n=="function"}function Tc(n){const i=lt.get(n),s=Xt(n);if(!ki(n))return lt.set(n,s);let o;if(!i)return;const c=zn(n);if(typeof c!="function"){const l=i.left-s.left,u=i.top-s.top,[r,d,a,h]=zs(n,i,s),p={transform:`translate(${l}px, ${u}px)`},g={transform:"translate(0, 0)"};r!==d&&(p.width=`${r}px`,g.width=`${d}px`),a!==h&&(p.height=`${a}px`,g.height=`${h}px`),o=n.animate([p,g],{duration:c.duration,easing:c.easing})}else{const[l]=Si(c(n,"remain",i,s));o=new Animation(l),o.play()}Ut.set(n,o),lt.set(n,s),o.addEventListener("finish",Ft.bind(null,n))}function Ui(n){Rn in n&&delete n[Rn];const i=Xt(n);lt.set(n,i);const s=zn(n);if(!ki(n))return;let o;if(typeof s!="function")o=n.animate([{transform:"scale(.98)",opacity:0},{transform:"scale(0.98)",opacity:0,offset:.5},{transform:"scale(1)",opacity:1}],{duration:s.duration*1.5,easing:"ease-in"});else{const[c]=Si(s(n,"add",i));o=new Animation(c),o.play()}Ut.set(n,o),o.addEventListener("finish",Ft.bind(null,n))}function Bi(n,i){var s;n.remove(),lt.delete(n),Wt.delete(n),Ut.delete(n),(s=ti.get(n))===null||s===void 0||s.disconnect(),setTimeout(()=>{if(an in n&&delete n[an],Object.defineProperty(n,Rn,{value:!0,configurable:!0}),i&&n instanceof HTMLElement)for(const o in i)n.style[o]=""},0)}function Ac(n){var i;if(!Wt.has(n)||!lt.has(n))return;const[s,o]=Wt.get(n);Object.defineProperty(n,an,{value:!0,configurable:!0});const c=window.scrollX,l=window.scrollY;if(o&&o.parentNode&&o.parentNode instanceof Element?o.parentNode.insertBefore(n,o):s&&s.parentNode?s.parentNode.appendChild(n):(i=Us(n))===null||i===void 0||i.appendChild(n),!ki(n))return Bi(n);const[u,r,d,a]=Ec(n),h=zn(n),p=lt.get(n);(c!==vi||l!==wi)&&xc(n,c,l,h);let g,y={position:"absolute",top:`${u}px`,left:`${r}px`,width:`${d}px`,height:`${a}px`,margin:"0",pointerEvents:"none",transformOrigin:"center",zIndex:"100"};if(!ln(h))Object.assign(n.style,y),g=n.animate([{transform:"scale(1)",opacity:1},{transform:"scale(.98)",opacity:0}],{duration:h.duration,easing:"ease-out"});else{const[b,w]=Si(h(n,"remove",p));(w==null?void 0:w.styleReset)!==!1&&(y=(w==null?void 0:w.styleReset)||y,Object.assign(n.style,y)),g=new Animation(b),g.play()}Ut.set(n,g),g.addEventListener("finish",Bi.bind(null,n,y))}function xc(n,i,s,o){const c=vi-i,l=wi-s,u=document.documentElement.style.scrollBehavior;if(getComputedStyle(Rt).scrollBehavior==="smooth"&&(document.documentElement.style.scrollBehavior="auto"),window.scrollTo(window.scrollX+c,window.scrollY+l),!n.parentElement)return;const d=n.parentElement;let a=d.clientHeight,h=d.clientWidth;const p=performance.now();function g(){requestAnimationFrame(()=>{if(!ln(o)){const y=a-d.clientHeight,b=h-d.clientWidth;p+o.duration>performance.now()?(window.scrollTo({left:window.scrollX-b,top:window.scrollY-y}),a=d.clientHeight,h=d.clientWidth,g()):document.documentElement.style.scrollBehavior=u}})}g()}function Ec(n){const i=lt.get(n),[s,,o]=zs(n,i,Xt(n));let c=n.parentElement;for(;c&&(getComputedStyle(c).position==="static"||c instanceof HTMLBodyElement);)c=c.parentElement;c||(c=document.body);const l=getComputedStyle(c),u=lt.get(c)||Xt(c),r=Math.round(i.top-u.top)-wt(l.borderTopWidth),d=Math.round(i.left-u.left)-wt(l.borderLeftWidth);return[r,d,s,o]}function Fs(n,i={}){return ni&&jt&&(window.matchMedia("(prefers-reduced-motion: reduce)").matches&&!ln(i)&&!i.disrespectUserMotionPreference||(sn.add(n),getComputedStyle(n).position==="static"&&Object.assign(n.style,{position:"relative"}),Bs(n,Ft,kc,c=>jt==null?void 0:jt.observe(c)),ln(i)?Zt.set(n,i):Zt.set(n,{duration:250,easing:"ease-in-out",...i}),ni.observe(n,{childList:!0}),Ds.add(n))),Object.freeze({parent:n,enable:()=>{sn.add(n)},disable:()=>{sn.delete(n)},isEnabled:()=>sn.has(n)})}function _i(n){const i=q(null),[s,o]=M(),c=l=>{s&&(l?s.enable():s.disable())};return Q(()=>{i.current instanceof HTMLElement&&o(Fs(i.current,n||{}))},[]),[i,c]}function Rc(n){return("0"+n.toString(16)).slice(-2)}function Lc(){var n=new Uint32Array(28);return window.crypto.getRandomValues(n),Array.from(n,Rc).join("")}function Mc(n){const s=new TextEncoder().encode(n);return window.crypto.subtle.digest("SHA-256",s)}function $c(n){let i="";const s=new Uint8Array(n),o=s.byteLength;for(var c=0;c<o;c++)i+=String.fromCharCode(s[c]);return btoa(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ks(n){const i=await Mc(n);return $c(i)}async function Nc({instanceURL:n}){var i;if(!n)return!1;try{const s=await fetch(`https://${n}/.well-known/oauth-authorization-server`);return!s.ok||s.status!==200?!1:!!((i=(await s.json()).code_challenge_methods_supported)!=null&&i.includes("S256"))}catch{return!1}}window.__generateCodeChallenge=Ks;const Pc={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Blaede Phanpy",PHANPY_DEFAULT_INSTANCE:"mastodon.blaede.family",PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:"https://mastodon.blaede.family/auth/sign_up",PHANPY_GIPHY_API_KEY:"48JGsrSS1XE5w4nWe9c9hqxPbsfRWR0e",PHANPY_LINGVA_INSTANCES:"lingva.phanpy.social lingva.lunar.icu lingva.garudalinux.org translate.plausibility.cloud",PHANPY_PRIVACY_POLICY_URL:"https://mastodon.blaede.family/privacy-policy",PHANPY_TRANSLANG_INSTANCES:"translang.phanpy.social",PHANPY_WEBSITE:"https://phanpy.blaede.family",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},{DEV:Dc,PHANPY_CLIENT_NAME:Oc,PHANPY_WEBSITE:Ln}=Pc,Ci="read write follow push",zc=Ln?Ln.toLowerCase().includes(location.hostname):!1,Uc=location.origin+location.pathname,Un=Dc||!zc?Uc:Ln;async function Bc({instanceURL:n}){const i=new URLSearchParams({client_name:Oc,redirect_uris:Un,scopes:Ci,website:Ln});return await(await fetch(`https://${n}/api/v1/apps`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:i.toString()})).json()}async function Fc({instanceURL:n,client_id:i,forceLogin:s=!1}){const o=Lc(),c=await Ks(o),l=new URLSearchParams({client_id:i,code_challenge_method:"S256",code_challenge:c,redirect_uri:Un,response_type:"code",scope:Ci});return s&&l.append("force_login",!0),[`https://${n}/oauth/authorize?${l.toString()}`,o]}async function Kc({instanceURL:n,client_id:i,forceLogin:s=!1}){const o=new URLSearchParams({client_id:i,scope:Ci,redirect_uri:Un,response_type:"code"});return s&&o.append("force_login",!0),`https://${n}/oauth/authorize?${o.toString()}`}async function Hc({instanceURL:n,client_id:i,client_secret:s,code:o,code_verifier:c}){const l=new URLSearchParams({client_id:i,redirect_uri:Un,grant_type:"authorization_code",code:o});return s&&l.append("client_secret",s),c&&l.append("code_verifier",c),await(await fetch(`https://${n}/oauth/token`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:l.toString()})).json()}async function Yc({instanceURL:n,client_id:i,client_secret:s,token:o}){try{const c=new URLSearchParams({client_id:i,client_secret:s,token:o});return(await fetch(`https://${n}/oauth/revoke`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:c.toString(),keepalive:!0})).ok}catch(c){return console.erro("Error revoking token",c),!1}}const qc=window.matchMedia("(display-mode: standalone)").matches;function jc({onClose:n}){const{_:i}=re(),{masto:s}=le(),o=ri(),c=kt(),l=o.length>1,[u,r]=Lt(a=>a+1,0),[d]=_i();return e("div",{id:"accounts-container",class:"sheet",tabIndex:"-1",children:[!!n&&e("button",{type:"button",class:"sheet-close",onClick:n,children:e(I,{icon:"x",alt:i({id:"yz7wBu"})})}),e("header",{class:"header-grid",children:e("h2",{children:e(f,{id:"bPwFdf"})})}),e("main",{children:e("section",{children:[e("ul",{class:"accounts-list",ref:d,children:o.map((a,h)=>{const p=a.info.id===c,g=h===0;return e("li",{children:[e("div",{children:[l&&e("span",{class:`current ${p?"is-current":""}`,children:e(I,{icon:"check-circle",alt:i({id:"Hp1l6f"})})}),e(mt,{url:a.info.avatarStatic,size:"xxl",onDblClick:async()=>{if(p)try{const y=await s.v1.accounts.$select(a.info.id).fetch();a.info=y,qt(o),r()}catch{}}}),e(yt,{account:l?{...a.info,acct:/@/.test(a.info.acct)?a.info.acct:`${a.info.acct}@${a.instanceURL}`}:a.info,showAcct:!0,onClick:()=>{p?x.showAccount=`${a.info.username}@${a.instanceURL}`:(In(a.info.id),location.reload())}})]}),e("div",{class:"actions",children:[g&&l&&e(U,{children:[e("span",{class:"tag",children:e(f,{id:"ovBPCi"})})," "]}),e(dt,{align:"end",menuButton:e("button",{type:"button",class:"plain more-button",children:e(I,{icon:"more",size:"l",alt:i({id:"2FYpfJ"})})}),children:[l&&e(U,{children:[e(ye,{disabled:p,onClick:()=>{In(a.info.id),location.reload()},children:[e(I,{icon:"transfer"})," ",e(f,{id:"3t/Nrv"})]}),!qc&&!p&&e(je,{href:`./?account=${a.info.id}`,target:"_blank",children:[e(I,{icon:"external"}),e("span",{children:e(f,{id:"PZgZtY"})})]}),e(Ve,{})]}),e(ye,{onClick:()=>{x.showAccount=`${a.info.username}@${a.instanceURL}`},children:[e(I,{icon:"user"}),e("span",{children:e(f,{id:"40z2Fm"})})]}),e(Ve,{}),l&&e(U,{children:[e(ye,{disabled:g,onClick:()=>{o.splice(h,1),o.unshift(a),qt(o),r()},children:[e(I,{icon:"check-circle"}),e("span",{children:e(f,{id:"PPcets"})})]}),e(ye,{disabled:h<=1,onClick:()=>{o.splice(h,1),o.splice(h-1,0,a),qt(o),r()},children:[e(I,{icon:"arrow-up"}),e("span",{children:e(f,{id:"QyioBP"})})]}),e(ye,{disabled:h===0||h===o.length-1,onClick:()=>{o.splice(h,1),o.splice(h+1,0,a),qt(o),r()},children:[e(I,{icon:"arrow-down"}),e("span",{children:e(f,{id:"3Ib6FN"})})]}),e(Ve,{})]}),e(pt,{subMenu:!0,confirmLabel:e(U,{children:[e(I,{icon:"exit"}),e("span",{children:e(f,{id:"k08LxG",values:{0:a.info.acct},components:{0:e("span",{class:"bidi-isolate"})}})})]}),disabled:!p,menuItemClassName:"danger",onClick:async()=>{await Yc({instanceURL:a.instanceURL,client_id:a.clientId,client_secret:a.clientSecret,token:a.accessToken}),o.splice(h,1),qt(o),location.href=location.pathname||"/"},children:[e(I,{icon:"exit"}),e("span",{children:e(f,{id:"CXk1bI"})})]}),!!(a!=null&&a.createdAt)&&e("div",{class:"footer",children:[e(I,{icon:"account-add"}),e("span",{children:e(f,{id:"+9E7iR",values:{0:ct(a.createdAt)},components:{0:e(_t,{datetime:a.createdAt})}})})]})]})]})]},a.info.id)})}),e("p",{children:e(ge,{to:"/login",class:"button plain2",onClick:n,children:[e(I,{icon:"plus"})," ",e("span",{children:e(f,{id:"Is7/PB"})})]})}),l&&e("p",{children:e("small",{children:e(f,{id:"52x24e",components:{0:e("i",{})}})})})]})})]})}const Ii="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20fill-rule='evenodd'%20stroke-linejoin='round'%20stroke-miterlimit='2'%20clip-rule='evenodd'%20viewBox='0%200%2064%2064'%3e%3cpath%20fill='none'%20d='M0%200h63.994v63.994H0z'/%3e%3cpath%20fill='%23a4bff7'%20d='M37.774%2011.471c14.639%203.752%2019.034%2016.557%2015.889%2031.304-.696%203.261-2.563%206.661-6.356%208.693-3.204%201.717-8.07%202.537-15.338.55l-9.634-2.404C11.651%2046.992%208.378%2038.733%2010.027%2031.823c3.627-15.201%2015.543-23.48%2027.747-20.352Z'/%3e%3cpath%20fill='%23d8e7fe'%20d='M36.76%2015.429c12.289%203.15%2015.547%2014.114%2012.907%2026.493-.947%204.44-4.937%209.365-16.664%206.143l-9.684-2.417c-7.854-1.923-10.53-7.8-9.318-12.877%203.016-12.639%2012.611-19.943%2022.759-17.342Z'/%3e%3cpath%20fill='%236081e6'%20d='M27.471%2024.991c-1.457-.698-7.229%203.213-7.663%208.926-.182%202.39%204.55%203.237%205.071-.169.725-4.743%203.715-8.218%202.592-8.757Zm10.746%202.005c-2.083.327-.382%205.901-.595%2010.727-.123%202.8%204.388%203.464%204.703%202.011%201.098-5.073-2.066-13.058-4.108-12.738Z'/%3e%3c/svg%3e",Vc={"zh-CN":"zh-Hans","zh-TW":"zh-Hant","pt-BR":"pt-BR"};function Ti(){const{i18n:n}=re(),i=Ae(()=>_o.map(s=>{var u,r;const o=Vc[s]||s.replace(/-[a-z]+$/i,""),c=Et({code:o,locale:s,fallback:(u=Hn.find(d=>d.code===s))==null?void 0:u.nativeName}),l=Et({code:o,locale:n.locale,fallback:(r=Hn.find(d=>d.code===s))==null?void 0:r.name});return{code:s,regionlessCode:o,_common:l,native:c}}).sort((s,o)=>{const c=s._common.localeCompare(o._common,n.locale);return c!==0?c:s.code<o.code?-1:s.code>o.code?1:0}),[]);return e("label",{class:"lang-selector",children:["🌐"," ",e("select",{class:"small",value:n.locale||Co,onChange:s=>{ze.local.set("lang",s.target.value),Io(s.target.value)},children:[i.map(({code:s,regionlessCode:o,native:c})=>{var r;const l=Et({code:o,locale:n.locale,fallback:(r=Hn.find(d=>d.code===s))==null?void 0:r.name});return e("option",{value:s,"data-regionless-code":o,children:!!l&&l!==c?`${c} - ${l}`:c},s)}),void 0]})]})}function Fi(n){const{masto:i}=le();return i.v1.push.subscription.create(n)}function Gc(){const{masto:n}=le();return n.v1.push.subscription.fetch()}function Wc(n){const{masto:i}=le();return i.v1.push.subscription.update(n)}function Zc(){const{masto:n}=le();return n.v1.push.subscription.remove()}function Bn(){return"serviceWorker"in navigator&&"PushManager"in window}function Xc(){return navigator.serviceWorker.getRegistration()}async function Ai(){const n=await Xc(),i=n?await n.pushManager.getSubscription():void 0;return{registration:n,subscription:i}}function Hs(n){const i="=".repeat((4-n.length%4)%4),s=`${n}${i}`.replace(/-/g,"+").replace(/_/g,"/"),o=window.atob(s),c=new Uint8Array(o.length);for(let l=0;l<o.length;++l)c[l]=o.charCodeAt(l);return c}async function Jc(){if(!Bn())return;const{subscription:n}=await Ai();let i=null;try{i=await Gc()}catch(s){if(!/(not found|unknown)/i.test(s.message))throw s}if(i&&n){const s=i.endpoint===n.endpoint,o=Tn(),c=i.serverKey===o;if(!s)throw new Error("Backend subscription endpoint changed");if(!c)throw new Error("Backend subscription key and vapid key changed")}if(n&&!i){const s=Tn();if(s){const{applicationServerKey:o}=n.options,c=Hs(s).toString(),l=new Uint8Array(o).toString();if(!(c===l))throw await n.unsubscribe(),new Error("Subscription key and vapid key changed")}}return{subscription:n,backendSubscription:i}}async function Ki({data:n,policy:i}){if(!Bn())return;let{registration:s,subscription:o}=await Ai(),c=null;if(o)try{c=await Wc({data:n,policy:i})}catch{c=await Fi({subscription:o,data:n,policy:i})}else{const l=Tn();if(!l)throw new Error("No server key found");o=await s.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Hs(l)}),c=await Fi({subscription:o,data:n,policy:i})}return{subscription:o,backendSubscription:c}}async function Hi(){if(!Bn())return;const{subscription:n}=await Ai();n&&(await Zc(),await n.unsubscribe())}const Qc={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Blaede Phanpy",PHANPY_DEFAULT_INSTANCE:"mastodon.blaede.family",PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:"https://mastodon.blaede.family/auth/sign_up",PHANPY_GIPHY_API_KEY:"48JGsrSS1XE5w4nWe9c9hqxPbsfRWR0e",PHANPY_LINGVA_INSTANCES:"lingva.phanpy.social lingva.lunar.icu lingva.garudalinux.org translate.plausibility.cloud",PHANPY_PRIVACY_POLICY_URL:"https://mastodon.blaede.family/privacy-policy",PHANPY_TRANSLANG_INSTANCES:"translang.phanpy.social",PHANPY_WEBSITE:"https://phanpy.blaede.family",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},Yi=16,Dt=[14,15,16,17,18,19,20],{PHANPY_WEBSITE:qi,PHANPY_PRIVACY_POLICY_URL:ea,PHANPY_TRANSLANG_INSTANCES:ta,PHANPY_IMG_ALT_API_URL:na,PHANPY_GIPHY_API_KEY:ia}=Qc,ji=Object.entries(Go.tl).map(([n,i])=>({code:n,name:i})),sa="TransLang API";function oa({onClose:n}){var v;const{_:i}=re(),s=We(x),o=ze.local.get("theme")||"auto",c=q(),l=s.settings.contentTranslationTargetLanguage||null,u=xs(),r=Et(u),d=ze.local.get("textSize")||Yi,[a,h]=M(di()),{masto:p,authenticated:g,instance:y}=le(),[b,w]=M(ze.local.get("experiments-tabBarV2")??!1);return e("div",{id:"settings-container",class:"sheet",tabIndex:"-1",style:{"--current-text-size":`${d}px`},children:[!!n&&e("button",{type:"button",class:"sheet-close",onClick:n,children:e(I,{icon:"x",alt:i({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(f,{id:"Tz0i8g"})})}),e("main",{children:[e("section",{children:e("ul",{children:[e("li",{children:[e("div",{children:e("label",{children:e(f,{id:"aAIQg2"})})}),e("div",{children:e("form",{ref:c,onInput:m=>{m.preventDefault();const C=new FormData(c.current).get("theme"),T=document.documentElement;if(C==="auto"){T.classList.remove("is-light","is-dark");const A=document.querySelector('meta[data-theme-setting="manual"]');A&&(A.name=""),document.querySelectorAll('meta[data-theme-setting="auto"]').forEach(_=>{_.name="theme-color"})}else{T.classList.toggle("is-light",C==="light"),T.classList.toggle("is-dark",C==="dark");const A=document.querySelector('meta[data-theme-setting="manual"]');A&&(A.name="theme-color",A.content=C==="light"?A.dataset.themeLightColor:A.dataset.themeDarkColor),document.querySelectorAll('meta[data-theme-setting="auto"]').forEach(_=>{_.name=""})}document.querySelector('meta[name="color-scheme"]').setAttribute("content",C==="auto"?"dark light":C),C==="auto"?ze.local.del("theme"):ze.local.set("theme",C)},children:e("div",{class:"radio-group",children:[e("label",{children:[e("input",{type:"radio",name:"theme",value:"light",defaultChecked:o==="light"}),e("span",{children:e(f,{id:"1njn7W"})})]}),e("label",{children:[e("input",{type:"radio",name:"theme",value:"dark",defaultChecked:o==="dark"}),e("span",{children:e(f,{id:"pvnfJD"})})]}),e("label",{children:[e("input",{type:"radio",name:"theme",value:"auto",defaultChecked:o!=="light"&&o!=="dark"}),e("span",{children:e(f,{id:"R9Khdg"})})]})]})})})]}),e("li",{children:[e("div",{children:e("label",{children:e(f,{id:"7r6sCa"})})}),e("div",{class:"range-group",children:[e("span",{style:{fontSize:Dt[0]},children:e(f,{id:"J6ypuD"})})," ",e("input",{type:"range",min:Dt[0],max:Dt[Dt.length-1],step:"1",value:d,list:"sizes",onChange:m=>{const S=parseInt(m.target.value,10);document.documentElement.style.setProperty("--text-size",`${S}px`),S===Yi?ze.local.del("textSize"):ze.local.set("textSize",m.target.value)}})," ",e("span",{style:{fontSize:Dt[Dt.length-1]},children:e(f,{id:"J6ypuD"})}),e("datalist",{id:"sizes",children:Dt.map(m=>e("option",{value:m}))})]})]}),e("li",{children:[e("span",{children:[e("label",{children:e(f,{id:"CeJHfb"})}),e("br",{}),e("small",{children:e("a",{href:"https://crowdin.com/project/phanpy",target:"_blank",rel:"noopener",children:e(f,{id:"FFmj1D"})})})]}),e(Ti,{})]})]})}),g&&e(U,{children:[e("h3",{children:e(f,{id:"PcoS3v"})}),e("section",{children:e("ul",{children:e("li",{children:[e("div",{children:e("label",{for:"posting-privacy-field",children:[e(f,{id:"NAjVvt"})," ",e(I,{icon:"cloud",alt:i({id:"N2FcBE"}),class:"synced-icon"})]})}),e("div",{children:e("select",{id:"posting-privacy-field",value:a["posting:default:visibility"]||"public",onChange:m=>{const{value:S}=m.target;(async()=>{try{await p.v1.accounts.updateCredentials({source:{privacy:S}}),h({...a,"posting:default:visibility":S}),To({...a,"posting:default:visibility":S})}catch{alert(i({id:"Oa+KBY"}))}})()},children:[e("option",{value:"public",children:e(f,{id:"7d1a0d"})}),e("option",{value:"unlisted",children:e(f,{id:"WDcQq9"})}),e("option",{value:"private",children:e(f,{id:"o34OrG"})})]})})]})})}),e("p",{class:"section-postnote",children:[e(I,{icon:"cloud",alt:i({id:"N2FcBE"}),class:"synced-icon"})," ",e("small",{children:e(f,{id:"xlsg7n",values:{instance:y},components:{0:e("a",{href:`https://${y}/`,target:"_blank",rel:"noopener"})}})})]})]}),e("h3",{children:e(f,{id:"ivdhsq"})}),e("section",{children:e("ul",{children:[e("li",{class:"block",children:e("label",{children:[e("input",{type:"checkbox",checked:s.settings.autoRefresh,onChange:m=>{x.settings.autoRefresh=m.target.checked}})," ",e(f,{id:"0mC0SF"})]})}),e("li",{class:"block",children:e("label",{children:[e("input",{type:"checkbox",checked:s.settings.boostsCarousel,onChange:m=>{x.settings.boostsCarousel=m.target.checked}})," ",e(f,{id:"TSbnoW"})]})}),!!ta&&e("li",{class:"block",children:[e("label",{children:[e("input",{type:"checkbox",checked:s.settings.contentTranslation,onChange:m=>{const{checked:S}=m.target;x.settings.contentTranslation=S,S||(x.settings.contentTranslationTargetLanguage=null)}})," ",e(f,{id:"0SdaOt"})]}),e("div",{class:`sub-section ${s.settings.contentTranslation?"":"more-insignificant"}`,children:[e("div",{children:e("label",{children:[e(f,{id:"zXCa9e"})," ",e("select",{value:l||"",disabled:!s.settings.contentTranslation,style:{width:"10em"},onChange:m=>{x.settings.contentTranslationTargetLanguage=m.target.value||null},children:[e("option",{value:"",children:e(f,{id:"jNCSyx",values:{systemTargetLanguageText:r}})}),e("option",{disabled:!0,children:"──────────"}),ji.map(m=>{const S=Et({code:m.code,fallback:m.name}),C=Et({code:m.code,locale:m.code}),T=C&&S!==C;return e("option",{value:m.code,children:T?`${C} - ${S}`:S})})]})]})}),e("hr",{}),e("div",{class:"checkbox-fieldset",children:[e(f,{id:"cc0NrU",values:{0:s.settings.contentTranslationHideLanguages.length}}),e("div",{class:"checkbox-fields",children:ji.map(m=>{const S=Et({code:m.code,fallback:m.name}),C=Et({code:m.code,locale:m.code}),T=C&&S!==C;return e("label",{children:[e("input",{type:"checkbox",checked:s.settings.contentTranslationHideLanguages.includes(m.code),onChange:A=>{const{checked:k}=A.target;k?x.settings.contentTranslationHideLanguages.push(m.code):x.settings.contentTranslationHideLanguages=s.settings.contentTranslationHideLanguages.filter(_=>_!==m.code)}})," ",T?e("span",{children:[C," ",e("span",{class:"insignificant ib",children:["- ",S]})]}):S]})})})]}),e("p",{class:"insignificant",children:e("small",{children:e(f,{id:"7I3sDQ",values:{TRANSLATION_API_NAME:sa},components:{0:e("a",{href:"https://github.com/cheeaun/translang-api",target:"_blank",rel:"noopener"})}})})}),e("hr",{}),e("div",{children:[e("label",{children:[e("input",{type:"checkbox",checked:s.settings.contentTranslationAutoInline,disabled:!s.settings.contentTranslation,onChange:m=>{x.settings.contentTranslationAutoInline=m.target.checked}})," ",e(f,{id:"gURvmk"})]}),e("p",{class:"insignificant",children:e("small",{children:e(f,{id:"PbHARL",components:{0:e("b",{})}})})})]})]})]}),!!ia&&g&&e("li",{class:"block",children:[e("label",{children:[e("input",{type:"checkbox",checked:s.settings.composerGIFPicker,onChange:m=>{x.settings.composerGIFPicker=m.target.checked}})," ",e(f,{id:"D7/2jB"})]}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(f,{id:"/CLBTL",components:{0:e("a",{href:"https://developers.giphy.com/",target:"_blank",rel:"noopener"})}})})})]}),!!na&&g&&e("li",{class:"block",children:[e("label",{children:[e("input",{type:"checkbox",checked:s.settings.mediaAltGenerator,onChange:m=>{x.settings.mediaAltGenerator=m.target.checked}})," ",e(f,{id:"9q5uor"})," ",e(I,{icon:"sparkles2",class:"more-insignificant"})]}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(f,{id:"faZ9RI"})})}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(f,{id:"fHZgvt",components:{0:e("a",{href:"https://github.com/cheeaun/img-alt-api",target:"_blank",rel:"noopener"})}})})})]}),g&&((v=ui())==null?void 0:v.mastodon)>=2&&e("li",{class:"block",children:[e("label",{children:[e("input",{type:"checkbox",checked:s.settings.groupedNotificationsAlpha,onChange:m=>{x.settings.groupedNotificationsAlpha=m.target.checked}})," ",e(f,{id:"aGziA/"})]}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(f,{id:"X17jCM"})})})]}),g&&e("li",{class:"block",children:[e("label",{children:[e("input",{type:"checkbox",checked:s.settings.shortcutSettingsCloudImportExport,onChange:m=>{x.settings.shortcutSettingsCloudImportExport=m.target.checked}})," ",e(f,{id:"570qTm"})," ",e(I,{icon:"cloud",class:"more-insignificant"})]}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(f,{id:"0tZAhT",components:{0:e("br",{})}})})}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(f,{id:"fHf1v/"})})})]}),e("li",{class:"block",children:[e("label",{children:[e("input",{type:"checkbox",checked:s.settings.cloakMode,onChange:m=>{x.settings.cloakMode=m.target.checked}})," ",e(f,{id:"lxYe+I",components:{0:e("span",{class:"insignificant"}),1:e("samp",{}),2:e("samp",{})}})]}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(f,{id:"T/hglb"})})})]}),g&&e("li",{children:e("button",{type:"button",class:"light",onClick:()=>{x.showDrafts=!0,x.showSettings=!1},children:e(f,{id:"krk5ws"})})})]})}),g&&e(ca,{onClose:n}),e("h3",{children:e(f,{id:"uyJsf6"})}),e("section",{children:[e("div",{style:{display:"flex",flexWrap:"wrap",gap:8,lineHeight:1.25,alignItems:"center",marginTop:8},children:[e("img",{src:Ii,alt:"",width:"64",height:"64",style:{aspectRatio:"1/1",verticalAlign:"middle",background:"#b7cdf9",borderRadius:12}}),e("div",{children:[e("b",{children:"Phanpy"})," ",e("a",{href:"https://hachyderm.io/@phanpy",rel:"noopener",onClick:m=>{m.preventDefault(),x.showAccount="phanpy@hachyderm.io"},children:"@phanpy"}),e("br",{}),e(f,{id:"AZ2EoP",components:{0:e("a",{href:"https://github.com/cheeaun/phanpy",target:"_blank",rel:"noopener"}),1:e("a",{href:"https://mastodon.social/@cheeaun",rel:"noopener",onClick:m=>{m.preventDefault(),x.showAccount="cheeaun@mastodon.social"}})}})]})]}),e("p",{children:[e("a",{href:"https://github.com/sponsors/cheeaun",target:"_blank",rel:"noopener",children:e(f,{id:"O4cLCR"})})," ","·"," ",e("a",{href:"https://www.buymeacoffee.com/cheeaun",target:"_blank",rel:"noopener",children:e(f,{id:"Ng063n"})})," ","·"," ",e("a",{href:"https://patreon.com/cheeaun",target:"_blank",rel:"noopener",children:"Patreon"})," ","·"," ",e("a",{href:"https://github.com/cheeaun/phanpy/blob/main/CHANGELOG.md",target:"_blank",rel:"noopener",children:e(f,{id:"3ePd3I"})})," ","·"," ",e("a",{href:ea,target:"_blank",rel:"noopener",children:e(f,{id:"LcET2C"})})]}),e("p",{children:[qi&&e(U,{children:[e(f,{id:"pFnMHn",values:{0:qi.replace(/https?:\/\//g,"").replace(/\/$/,"")},components:{0:e("span",{class:"insignificant"})}}),e("br",{})]}),e(f,{id:"6KkH+2",values:{0:e("span",{class:"ib insignificant",children:["(",e("a",{href:"https://github.com/cheeaun/phanpy/commit/4758452",target:"_blank",rel:"noopener",children:e(_t,{datetime:new Date("2025-07-10T18:22:36.776Z")})}),")"]})},components:{0:e("span",{class:"insignificant"}),1:e("input",{type:"text",class:"version-string",readOnly:!0,size:"18",value:`${"2025-07-10T18:22:36.776Z".slice(0,10).replace(/-/g,".")}.4758452`,onClick:m=>{m.target.select();try{navigator.clipboard.writeText(m.target.value),fe(i({id:"PiPfua"}))}catch{fe(i({id:"gdxreD"}))}}})}})]})]}),void 0]})]})}function ca({onClose:n}){const{_:i}=re();if(!Bn())return null;const{instance:s}=le(),[o,c]=M("default"),l=q(),[u,r]=M(!1),[d,a]=M(!1),h=q();Q(()=>{(async()=>{c("loading");try{const{subscription:g,backendSubscription:y}=await Jc();if(y!=null&&y.policy&&y.policy!=="none"){r(!0);const{alerts:b,policy:w}=y;h.current=w;const{elements:v}=l.current,m=v.namedItem("policy");m&&(m.value=w),Object.entries(b).forEach(([S,C])=>{const T=v.namedItem(S);(T==null?void 0:T.type)==="checkbox"&&(T.checked=!!C)})}c("default")}catch(g){/outside.*authorized/i.test(g.message)?a(!0):alert((g==null?void 0:g.message)||g),c("error")}})()},[]);const p=o==="loading";return e("form",{ref:l,onChange:()=>{setTimeout(()=>{const g=Object.fromEntries(new FormData(l.current)),y=!!g["policy-allow"],b={data:{policy:g.policy,alerts:{mention:!!g.mention,favourite:!!g.favourite,reblog:!!g.reblog,follow:!!g.follow,follow_request:!!g.followRequest,poll:!!g.poll,update:!!g.update,status:!!g.status}}};let w=0;Object.keys(b.data.alerts).forEach(m=>{b.data.alerts[m]?w++:delete b.data.alerts[m]});const v=h.current!==b.data.policy;y&&w>0?v?Hi().then(()=>{Ki(b)}).catch(m=>{alert(i({id:"I6pdY3"}))}):Ki(b).catch(m=>{alert(i({id:"I6pdY3"}))}):Hi().catch(m=>{alert(i({id:"q1zFd+"}))})},100)},children:[e("h3",{children:e(f,{id:"WUHLnz"})}),e("section",{children:e("ul",{children:e("li",{children:[e("label",{children:[e("input",{type:"checkbox",disabled:p||d,name:"policy-allow",checked:u,onChange:async g=>{const{checked:y}=g.target;if(y){const b=await Notification.requestPermission();b==="granted"?r(!0):(r(!1),b==="denied"&&alert(i({id:"6LUsk7"})))}else r(!1)}})," ",e(f,{id:"qYNCa1",values:{0:[{value:"all",label:i({id:"+niKJH"})},{value:"followed",label:i({id:"x2NYtp"})},{value:"follower",label:i({id:"PBFNgg"})}].map(g=>e("option",{value:g.value,children:g.label}))},components:{0:e("select",{name:"policy",disabled:p||d||!u})}})]}),e("div",{class:"shazam-container no-animation",style:{width:"100%"},hidden:!u,children:e("div",{class:"shazam-container-inner",children:e("div",{class:"sub-section",children:e("ul",{children:[{value:"mention",label:i({id:"/bZzdR"})},{value:"favourite",label:i({id:"zZOZj7"})},{value:"reblog",label:i({id:"puY2t0"})},{value:"follow",label:i({id:"aaJhcT"})},{value:"followRequest",label:i({id:"6Fs1Ba"})},{value:"poll",label:i({id:"wNExRS"})},{value:"update",label:i({id:"K/EtE6"})},{value:"status",label:i({id:"2yr1/p"})}].map(g=>e("li",{children:e("label",{children:[e("input",{type:"checkbox",name:g.value})," ",g.label]})}))})})})}),d&&e("div",{class:"sub-section",children:e("p",{children:e(f,{id:"8d0b8B",components:{0:e(ge,{to:`/login?instance=${s}`,onClick:n}),1:e("b",{})}})})})]})})}),e("p",{class:"section-postnote",children:e("small",{children:e(f,{id:"z96cOX",components:{0:e("b",{})}})})})]})}const ii=()=>{let n=setTimeout(()=>{var s,o;const i=document.getElementById("columns");if(i){const c=i.querySelector(".deck-container.focus");if(c)c.focus();else{const l=Array.from(i.querySelectorAll(".deck-container")).find(u=>u.getBoundingClientRect().left>=0);l?l.focus():(o=(s=i.querySelector(".deck-container"))==null?void 0:s.focus)==null||o.call(s)}}else{const c=document.querySelectorAll("#modal-container > *");if(c!=null&&c.length){const d=c[c.length-1],a=d.querySelector('[tabindex="-1"]')||d;if(a){a.focus();return}}if(document.querySelector(".deck-backdrop"))return;const u=document.querySelectorAll(".deck-container"),r=u[u.length-1];r&&r.tabIndex===-1&&r.focus()}},100);return()=>clearTimeout(n)};function Ys(n){if(!n)return;const i=Jt(),s=q(i.pathname);Q(()=>{s.current&&i.pathname!==s.current&&(n==null||n())},[i.pathname,n])}const qs=1e3*60,aa=24*60*60*1e3,si=bt(async()=>{const{masto:n}=le(),i=await n.v1.lists.list();return i.sort((s,o)=>s.title.localeCompare(o.title)),i.length&&setTimeout(()=>{ze.account.set("lists",{lists:i,updatedAt:Date.now()})},1),i},{maxAge:qs});async function hn(){try{const{lists:n,updatedAt:i}=ze.account.get("lists")||{};return n!=null&&n.length?(Date.now()-i>aa&&si(),n):await si()}catch{return[]}}const la=bt(n=>{const{masto:i}=le();return i.v1.lists.$select(n).fetch()},{maxAge:qs});async function js(n){const{lists:i}=ze.account.get("lists")||{};if(i!=null&&i.length){const s=i.find(o=>o.id===n);if(s)return s}try{return la(n)}catch{return null}}async function ra(n){const i=await js(n);return(i==null?void 0:i.title)||""}function da(n){const{lists:i}=ze.account.get("lists")||{};i!=null&&i.length&&(i.push(n),i.sort((s,o)=>s.title.localeCompare(o.title)),ze.account.set("lists",{lists:i,updatedAt:Date.now()}))}function ua(n){const{lists:i}=ze.account.get("lists")||{};if(i!=null&&i.length){const s=i.findIndex(o=>o.id===n.id);s!==-1&&(i[s]=n,i.sort((o,c)=>o.title.localeCompare(c.title)),ze.account.set("lists",{lists:i,updatedAt:Date.now()}))}}function ha(n){const{lists:i}=ze.account.get("lists")||{};if(i!=null&&i.length){const s=i.findIndex(o=>o.id===n);s!==-1&&(i.splice(s,1),ze.account.set("lists",{lists:i,updatedAt:Date.now()}))}}function Bt({insignificant:n}){const{_:i}=re();return e(I,{icon:"filter",size:"xs",class:`list-exclusive-badge ${n?"insignificant":""}`,title:i({id:"FNptcJ"})})}function xi({list:n,onClose:i}){const{_:s}=re(),{masto:o}=le(),[c,l]=M("default"),u=!!n,r=q(),d=q(),a=q();Q(()=>{u&&(r.current.value=n.title,d.current.value=n.repliesPolicy,a.current&&(a.current.checked=n.exclusive))},[u]);const h=Je("@mastodon/list-exclusive")||Je("@gotosocial/list-exclusive");return e("div",{class:"sheet",children:[!!i&&e("button",{type:"button",class:"sheet-close",onClick:i,children:e(I,{icon:"x",alt:s({id:"yz7wBu"})})})," ",e("header",{children:e("h2",{children:s(u?{id:"tuhghE"}:{id:"Sb2gYF"})})}),e("main",{children:e("form",{class:"list-form",onSubmit:p=>{p.preventDefault();const g=new FormData(p.target),y=g.get("title"),b=g.get("replies_policy"),w=g.get("exclusive")==="on";l("loading"),(async()=>{try{let v;u?v=await o.v1.lists.$select(n.id).update({title:y,replies_policy:b,exclusive:w}):v=await o.v1.lists.create({title:y,replies_policy:b,exclusive:w}),l("default"),i==null||i({state:"success",list:v}),setTimeout(()=>{u?ua(v):da(v)},1)}catch{l("error"),alert(s(u?{id:"R7ep1i"}:{id:"KPoj8w"}))}})()},children:[e("div",{class:"list-form-row",children:e("label",{for:"list-title",children:[e(f,{id:"6YtxFj"})," ",e("input",{ref:r,type:"text",id:"list-title",name:"title",required:!0,disabled:c==="loading",dir:"auto"})]})}),e("div",{class:"list-form-row",children:e("select",{ref:d,name:"replies_policy",required:!0,disabled:c==="loading",children:[e("option",{value:"list",children:e(f,{id:"ei6pnR"})}),e("option",{value:"followed",children:e(f,{id:"Mr53YX"})}),e("option",{value:"none",children:e(f,{id:"PM7llw"})})]})}),h&&e("div",{class:"list-form-row",children:e("label",{class:"label-block",children:[e("input",{ref:a,type:"checkbox",name:"exclusive",disabled:c==="loading"})," ",e(Bt,{insignificant:!0})," ",e(f,{id:"jxxYp0"})]})}),e("div",{class:"list-form-footer",children:[e("button",{type:"submit",disabled:c==="loading",children:s(u?{id:"tfDRzk"}:{id:"hYgDIe"})}),u&&e(pt,{disabled:c==="loading",align:"end",menuItemClassName:"danger",confirmLabel:s({id:"+kQ/cY"}),onClick:()=>{l("loading"),(async()=>{try{await o.v1.lists.$select(n.id).remove(),l("default"),i==null||i({state:"deleted"}),setTimeout(()=>{ha(n.id)},1)}catch{l("error"),alert(s({id:"tqUaGL"}))}})()},children:e("button",{type:"button",class:"light danger",disabled:c==="loading",children:e(f,{id:"Jb6/SB"})})})]})]})})]})}const fa=[60*5,60*30,60*60,60*60*6,60*60*24,60*60*24*3,60*60*24*7,60*60*24*30,0],Ht={0:{id:"9ZP9cc"},300:ot(5,"minute"),1800:ot(30,"minute"),3600:ot(1,"hour"),21600:ot(6,"hour"),86400:ot(1,"day"),259200:ot(3,"day"),604800:ot(1,"week"),2592e3:ot(30,"day")},Vi=80,Vs=1e3*60*10;function pa(n,i){return i.v1.accounts.familiarFollowers.fetch({id:[n]})}const ma=bt(pa,{maxAge:Vs});async function ga(n,i){const s=i.v1.accounts.$select(n).statuses.list({limit:20}).values().next(),{value:o}=await s,c={total:o.length,originals:0,replies:0,boosts:0};return o.forEach(l=>{l.reblog?c.boosts++:l.inReplyToId&&l.inReplyToAccountId!==l.account.id?c.replies++:c.originals++}),o.length&&(c.daysSinceLastPost=Math.ceil((Date.now()-new Date(o[o.length-1].createdAt))/864e5)),c}const ya=bt(ga,{maxAge:Vs}),ba=80;function Gs({account:n,fetchAccount:i=()=>{},standalone:s,instance:o,authenticated:c,showEndorsements:l=!1}){const{i18n:u,_:r}=re(),{masto:d,authenticated:a}=le({instance:o}),{masto:h,instance:p}=le(),[g,y]=M("default"),b=typeof n=="string",[w,v]=M(b?null:n),m=Ae(()=>o===p,[o,p]);Q(()=>{if(!b){v(n);return}y("loading"),(async()=>{try{const z=await i();x.accounts[`${z.id}@${o}`]=z,v(z),y("default")}catch{v(null),y("error")}})()},[b,n,i]);const{acct:S,avatar:C,avatarStatic:T,bot:A,createdAt:k,displayName:_,emojis:E,fields:R,followersCount:F,followingCount:O,group:W,id:V,lastStatusAt:X,locked:Y,note:Z,statusesCount:B,url:ee,username:$,memorial:K,moved:j,roles:te,hideCollections:J}=w||{};let ue=!1,{header:he,headerStatic:ne}=w||{};(!he||/missing\.png$/.test(he))&&C&&!/missing\.png$/.test(C)&&(he=C,ue=!0,T&&!/missing\.png$/.test(T)&&(ne=T));const we=Ae(()=>V===kt(),[V]);Q(()=>{const z=!!(w!=null&&w.id&&(w!=null&&w.username)&&(w!=null&&w.acct)&&(w!=null&&w.avatar)&&(w!=null&&w.avatarStatic)&&(w!=null&&w.displayName)&&(w!=null&&w.url));if(we&&o&&z){const be=ri();let ve=!1;be.forEach(_e=>{_e.info.id===w.id&&_e.instanceURL===o&&(_e.info=w,ve=!0)}),ve&&qt(be)}},[we,w,o]);const Ce=Ae(()=>{var ve;if(!ee)return null;const z=(ve=URL.parse(ee))==null?void 0:ve.hostname;return z?un.toUnicode(z):null},[ee]),[se,Te]=M([]),Ie=q(),Pe=q([]);async function $e(z){var Ze;(z||!Ie.current)&&(Ie.current=d.v1.accounts.$select(V).followers.list({limit:Vi}).values());const be=await Ie.current.next();if(we||!m)return be;const{value:ve}=be;let _e=[];if(z){let Fe=[];try{Fe=await d.v1.accounts.familiarFollowers.fetch({id:[V]})}catch{}Pe.current=((Ze=Fe==null?void 0:Fe[0])==null?void 0:Ze.accounts)||[],_e=[...Pe.current,...ve.filter(de=>!Pe.current.some(Ue=>Ue.id===de.id))]}else ve!=null&&ve.length&&(_e=ve.filter(Fe=>!Pe.current.some(de=>de.id===Fe.id)));return{...be,value:_e}}const Ee=q();async function H(z){return(z||!Ee.current)&&(Ee.current=d.v1.accounts.$select(V).following.list({limit:Vi}).values()),await Ee.current.next()}const ke=s?"div":ge,De=o?`/${o}/a/${V}`:`/a/${V}`,[xe,Me]=M([]),[me,N]=M(),[D,oe]=M("default"),Le=!!(me!=null&&me.total),P=async z=>{try{const be=await ma(z,h);Me(be[0].accounts.slice(0,va))}catch{}},ce=async()=>{if(V){oe("loading");try{const z=await ya(V,d);N(z),oe("default")}catch{oe("error")}}},Se=it(({relationship:z,currentID:be})=>{z.following||(P(be),!s&&B>0&&ce())},[s,V,B]),Ne=it(z=>{z.id===V&&(v(z),x.accounts[`${z.id}@${o}`]=z)},[V,o]),Oe=b&&n&&/^https?:\/\//.test(n),[L,G]=M(!1),[ae,ie]=M(!1);return e(U,{children:[e("div",{tabIndex:"-1",class:`account-container ${g==="loading"?"skeleton":""}`,style:{"--header-color-1":se[0],"--header-color-2":se[1],"--header-color-3":se[2],"--header-color-4":se[3]},children:[g==="error"&&e("div",{class:"ui-state",children:[e("p",{children:e(f,{id:"44hICK"})}),b?e("p",{children:Oe?e("a",{href:n,target:"_blank",rel:"noopener",children:n}):e("code",{class:"insignificant",children:n})}):e("p",{children:e("a",{href:ee,target:"_blank",rel:"noopener",children:[e(f,{id:"Aadw0+"})," ",e(I,{icon:"external"})]})})]}),g==="loading"?e(U,{children:[e("header",{children:e(ft,{avatarSize:"xxxl",skeleton:!0})}),e("main",{children:[e("div",{class:"note",children:[e("p",{children:"███████ ████ ████"}),e("p",{children:"████ ████████ ██████ █████████ ████ ██"})]}),e("div",{class:"account-metadata-box",children:[e("div",{class:"profile-metadata",children:[e("div",{class:"profile-field",children:[e("b",{class:"more-insignificant",children:"███"}),e("p",{children:"██████"})]}),e("div",{class:"profile-field",children:[e("b",{class:"more-insignificant",children:"████"}),e("p",{children:"███████████"})]})]}),e("div",{class:"stats",children:[e("div",{children:[e("span",{children:"██"})," ",e(f,{id:"x5LEuB"})]}),e("div",{children:[e("span",{children:"██"})," ",e(f,{id:"following.stats"})]}),e("div",{children:[e("span",{children:"██"})," ",e(f,{id:"+owNNn"})]})]})]}),e("div",{class:"actions",children:[e("span",{}),e("span",{class:"buttons",children:e("button",{type:"button",class:"plain",disabled:!0,children:e(I,{icon:"more",size:"l",alt:r({id:"2FYpfJ"})})})})]})]})]}):w&&e(U,{children:[!!j&&e("div",{class:"account-moved",children:[e("p",{children:e(f,{id:"C6cVP/",values:{displayName:_},components:{0:e("b",{})}})}),e(ft,{account:j,instance:o,onClick:z=>{z.stopPropagation(),x.showAccount=j}})]}),!!he&&!/missing\.png$/.test(he)&&e("img",{src:he,alt:"",class:`header-banner ${ue?"header-is-avatar":""}`,onError:z=>{z.target.crossOrigin?z.target.src!==ne?z.target.src=ne:(z.target.removeAttribute("crossorigin"),z.target.src=he):z.target.src!==ne?z.target.src=ne:z.target.remove()},crossOrigin:"anonymous",onLoad:z=>{z.target.classList.add("loaded");try{const be=window.OffscreenCanvas?new OffscreenCanvas(1,1):document.createElement("canvas"),ve=be.getContext("2d",{willReadFrequently:!0});be.width=z.target.width,be.height=z.target.height,ve.imageSmoothingEnabled=!1,ve.drawImage(z.target,0,0);const _e=10,Fe=[ve.getImageData(0,0,_e,_e).data,ve.getImageData(z.target.width-_e,0,_e,_e).data,ve.getImageData(0,z.target.height-_e,_e,_e).data,ve.getImageData(z.target.width-_e,z.target.height-_e,_e,_e).data].map(de=>{let Ue=0,Ke=0,nt=0,Re=0;for(let at=0;at<de.length;at+=4)Ue+=de[at],Ke+=de[at+1],nt+=de[at+2],Re+=de[at+3];const He=de.length/4;return[Ue/He,Ke/He,nt/He,Re/He]}).map(de=>{const[Ue,Ke,nt,Re]=ka(de);return`rgba(${Ue}, ${Ke}, ${nt}, ${Re})`});Te(Fe)}catch{}}}),e("header",{children:s?e(dt,{shift:window.matchMedia("(min-width: calc(40em))").matches?114:64,menuButton:e("div",{children:e(ft,{account:w,instance:o,avatarSize:"xxxl",onClick:()=>{}})}),children:[e("div",{class:"szh-menu__header",children:e(Ea,{acct:S,instance:o})}),e(ye,{onClick:()=>{const z=S.includes("@")?`@${S}`:`@${S}@${o}`;try{navigator.clipboard.writeText(z),fe(r({id:"zJoEwS"}))}catch{fe(r({id:"BC0lSD"}))}},children:[e(I,{icon:"link"}),e("span",{children:e(f,{id:"27x6gl"})})]}),e(ye,{href:ee,target:"_blank",children:[e(I,{icon:"external"}),e("span",{children:e(f,{id:"Bz5hLl"})})]}),e(Ve,{}),e(ye,{onClick:()=>{x.showMediaModal={mediaAttachments:[{type:"image",url:T}]}},children:[e(I,{icon:"user"}),e("span",{children:e(f,{id:"7WYl2I"})})]}),!!ne&&!ue&&e(ye,{onClick:()=>{x.showMediaModal={mediaAttachments:[{type:"image",url:ne}]}},children:[e(I,{icon:"media"}),e("span",{children:e(f,{id:"ZNme5R"})})]}),a&&we&&Je("@mastodon/profile-edit")&&e(U,{children:[e(Ve,{}),e(ye,{onClick:()=>{G(!0)},children:[e(I,{icon:"pencil"}),e("span",{children:e(f,{id:"9OpVZg"})})]})]})]}):e(ft,{account:w,instance:o,avatarSize:"xxxl",internal:!0})}),e("div",{class:"faux-header-bg","aria-hidden":"true"}),e("main",{children:[!!K&&e("span",{class:"tag",children:e(f,{id:"prdIOK"})}),!!A&&e("span",{class:"tag",children:[e(I,{icon:"bot"})," ",e(f,{id:"9Vdq+j"})]}),!!W&&e("span",{class:"tag",children:[e(I,{icon:"group"})," ",e(f,{id:"L8fEEm"})]}),te==null?void 0:te.map(z=>e("span",{class:"tag",children:[z.name,!!Ce&&e(U,{children:[" ",e("span",{class:"more-insignificant",children:Ce})]})]})),e("div",{class:"note",dir:"auto",onClick:Es({instance:p}),dangerouslySetInnerHTML:{__html:ei(Z,{emojis:E})}}),e("div",{class:"account-metadata-box",children:[(R==null?void 0:R.length)>0&&e("div",{class:"profile-metadata",children:R.map(({name:z,value:be,verifiedAt:ve},_e)=>e("div",{class:`profile-field ${ve?"profile-verified":""}`,dir:"auto",children:[e("b",{children:[e(Rs,{text:z,emojis:E})," ",!!ve&&e(I,{icon:"check-circle",size:"s",alt:r({id:"QDEWii"})})]}),e("p",{dangerouslySetInnerHTML:{__html:ei(be,{emojis:E})}})]},z+_e))}),e("div",{class:"stats",children:[e(ke,{tabIndex:0,to:De,onClick:()=>{setTimeout(()=>{x.showGenericAccounts={id:"followers",heading:r({id:"x5LEuB"}),fetchAccounts:$e,instance:o,excludeRelationshipAttrs:we?["followedBy"]:[],blankCopy:J?r({id:"BRV/wh"}):void 0}},0)},children:[!!xe.length&&e("span",{class:"shazam-container-horizontal",children:e("span",{class:"shazam-container-inner stats-avatars-bunch",children:xe.map(z=>e(mt,{url:z.avatarStatic,size:"s",alt:`${z.displayName} @${z.acct}`,squircle:z==null?void 0:z.bot}))})}),e("span",{title:F,children:Qe(F)})," ",e(f,{id:"x5LEuB"})]}),e(ke,{class:"insignificant",tabIndex:0,to:De,onClick:()=>{setTimeout(()=>{x.showGenericAccounts={heading:r({id:"following.stats"}),fetchAccounts:H,instance:o,excludeRelationshipAttrs:we?["following"]:[],blankCopy:J?r({id:"BRV/wh"}):void 0}},0)},children:[e("span",{title:O,children:Qe(O)})," ",e(f,{id:"following.stats"}),e("br",{})]}),e(ke,{class:"insignificant",to:De,children:[e("span",{title:B,children:Qe(B)})," ",e(f,{id:"+owNNn"})]}),!!k&&e("div",{class:"insignificant",children:e(f,{id:"PCcEFZ",values:{0:ct(k,{hideTime:!0})},components:{0:e("time",{datetime:k})}})})]})]}),!!me&&e(ke,{to:De,class:"account-metadata-box",children:e("div",{class:"shazam-container",children:e("div",{class:"shazam-container-inner",children:Le?e("div",{class:"posting-stats",title:r({id:"wiuWLe",values:{0:(me.originals/me.total).toLocaleString(u.locale||void 0,{style:"percent"}),1:(me.replies/me.total).toLocaleString(u.locale||void 0,{style:"percent"}),2:(me.boosts/me.total).toLocaleString(u.locale||void 0,{style:"percent"})}}),children:[e("div",{children:me.daysSinceLastPost<365?pe._({id:"oZUtTk",values:{0:me.total,1:me.daysSinceLastPost,2:me.daysSinceLastPost,3:me.daysSinceLastPost,4:me.total,5:me.total,6:me.daysSinceLastPost}}):pe._({id:"JvA7Mo",values:{0:me.total,1:me.total}})}),e("div",{class:"posting-stats-bar",style:{"--originals-percentage":`${me.originals/me.total*100}%`,"--replies-percentage":`${(me.originals+me.replies)/me.total*100}%`}}),e("div",{class:"posting-stats-legends",children:[e("span",{class:"ib",children:[e("span",{class:"posting-stats-legend-item posting-stats-legend-item-originals"})," ",e(f,{id:"HxF6Fk"})]})," ",e("span",{class:"ib",children:[e("span",{class:"posting-stats-legend-item posting-stats-legend-item-replies"})," ",e(f,{id:"N8UzTV"})]})," ",e("span",{class:"ib",children:[e("span",{class:"posting-stats-legend-item posting-stats-legend-item-boosts"})," ",e(f,{id:"puY2t0"})]})]})]}):e("div",{class:"posting-stats",children:e(f,{id:"vl3XTJ"})})})})}),!j&&e("div",{class:"account-metadata-box",children:e("div",{class:"shazam-container no-animation",hidden:!!me,children:e("div",{class:"shazam-container-inner",children:e("button",{type:"button",class:"posting-stats-button",disabled:D==="loading",onClick:()=>{ce()},children:[e("div",{class:`posting-stats-bar posting-stats-icon ${D==="loading"?"loading":""}`,style:{"--originals-percentage":"33%","--replies-percentage":"66%"}}),e(f,{id:"PjP87f"})," "]})})})})]}),e("footer",{children:e(wa,{info:w,instance:o,standalone:s,authenticated:c,onRelationshipChange:Se,onProfileUpdate:Ne,setShowEditProfile:G,showEndorsements:l,renderEndorsements:ae,setRenderEndorsements:ie})}),e(Ra,{accountID:V,info:w,open:ae,onlyOpenIfHasEndorsements:ae==="onlyOpenIfHasEndorsements"})]})]}),!!L&&e(qe,{onClose:()=>{G(!1)},children:e(Aa,{onClose:({state:z,account:be}={})=>{G(!1),z==="success"&&be&&Ne(be)}})})]})}const va=3;function wa({info:n,instance:i,standalone:s,authenticated:o,onRelationshipChange:c=()=>{},onProfileUpdate:l=()=>{},setShowEditProfile:u=()=>{},showEndorsements:r=!1,renderEndorsements:d=!1,setRenderEndorsements:a=()=>{}}){var N;if(!n)return null;const{_:h,_:p}=re(),{masto:g,instance:y,authenticated:b}=le(),w=i===y,[v,m]=M("default"),[S,C]=M(null),{id:T,acct:A,url:k,username:_,locked:E,lastStatusAt:R,note:F,fields:O,moved:W}=n,V=q(T),{following:X,showingReblogs:Y,notifying:Z,followedBy:B,blocking:ee,blockedBy:$,muting:K,mutingNotifications:j,requested:te,domainBlocking:J,endorsed:ue,note:he}=S||{},[ne,we]=M(null),[Ce,se]=M(!1),Te=A.includes("@")?A:`${A}@${i}`,Ie=Je("@mastodon/endorsements");Q(()=>{if(n){const D=kt();let oe;(async()=>{if(w&&o)oe=T;else if(!w&&b){const P=n.acct.includes("@");try{const ce=await g.v2.search.list({q:P?n.acct:`${n.username}@${i}`,type:"accounts",limit:1,resolve:!0});ce.accounts.length&&(oe=ce.accounts[0].id,we(ce.accounts[0]))}catch{}}if(!oe)return;if(D===oe){se(!0);return}V.current=oe,m("loading");const Le=g.v1.accounts.relationships.fetch({id:[oe]});try{const P=await Le;if(m("default"),P.length){const ce=P[0];C(ce),c({relationship:ce,currentID:oe})}}catch{m("error")}})()}},[n,o]),Q(()=>{n&&Ce&&Ao(n)},[n,Ce]);const Pe=v==="loading",[$e,Ee]=M(!1),[H,ke]=M(!1),[De,xe]=M(!1),[Me,me]=M([]);return e(U,{children:[e("div",{class:"actions",children:[e("span",{children:[B?e("span",{class:"tag",children:e(f,{id:"p3UO/y"})}):R?e("small",{class:"insignificant",children:e(f,{id:"F3cM1G",values:{0:ct(R,{hideTime:!0})},components:{0:e("span",{class:"ib"})}})}):e("span",{}),K&&e("span",{class:"tag danger",children:e(f,{id:"+IJm1Z"})}),ee&&e("span",{class:"tag danger",children:e(f,{id:"32TndD"})})]})," ",e("span",{class:"buttons",children:[!!he&&e("button",{type:"button",class:"private-note-tag",title:p({id:"zxFxcH"}),onClick:()=>{xe(!0)},dir:"auto",children:e("span",{children:he})}),e(dt,{portal:{target:document.body},containerProps:{style:{zIndex:1001}},align:"center",position:"anchor",overflow:"auto",menuButton:e("button",{type:"button",class:"plain",disabled:Pe,children:e(I,{icon:"more",size:"l",alt:p({id:"2FYpfJ"})})}),onMenuChange:D=>{X&&D.open&&(async()=>{try{const oe=await g.v1.accounts.$select(V.current).lists.list();me(oe)}catch{}})()},children:[b&&!Ce?e(U,{children:[e(ye,{onClick:()=>{Ts({draftStatus:{status:`@${(ne==null?void 0:ne.acct)||A} `}})},children:[e(I,{icon:"at"}),e("span",{children:e(f,{id:"3LkfZu",values:{username:_},components:{0:e("span",{class:"bidi-isolate"})}})})]}),e(ye,{onClick:()=>{Ee(!0)},children:[e(I,{icon:"translate"}),e("span",{children:e(f,{id:"R8mSiS"})})]}),Je("@mastodon/profile-private-note")&&e(ye,{onClick:()=>{xe(!0)},children:[e(I,{icon:"pencil"}),e("span",{children:p(he?{id:"U+Gokq"}:{id:"VcQzRi"})})]}),X&&!!S&&e(U,{children:[e(ye,{onClick:()=>{m("loading"),(async()=>{try{const D=await g.v1.accounts.$select(V.current).follow({notify:!Z});D&&C(D),m("default"),fe(D.notifying?p({id:"jL3N0G",values:{username:_}}):p({id:"0h4/9h",values:{username:_}}))}catch(D){alert(D),m("error")}})()},children:[e(I,{icon:"notification"}),e("span",{children:p(Z?{id:"osJmEN"}:{id:"I92Z+b"})})]}),e(ye,{onClick:()=>{m("loading"),(async()=>{try{const D=await g.v1.accounts.$select(V.current).follow({reblogs:!Y});D&&C(D),m("default"),fe(D.showingReblogs?p({id:"0X2KC8",values:{username:_}}):p({id:"cXWjH0",values:{username:_}}))}catch(D){alert(D),m("error")}})()},children:[e(I,{icon:"rocket"}),e("span",{children:p(Y?{id:"GRUr8d"}:{id:"uREpT3"})})]})]}),Ie&&X&&e(ye,{onClick:()=>{m("loading"),(async()=>{try{if(ue){const D=await g.v1.accounts.$select((ne==null?void 0:ne.id)||T).unpin();C(D),m("default"),fe(p({id:"pWFLFk",values:{username:_}}))}else{const D=await g.v1.accounts.$select((ne==null?void 0:ne.id)||T).pin();C(D),m("default"),fe(p({id:"xhiXaF",values:{username:_}}))}}catch{m("error"),ue?fe(p({id:"xHq5L2",values:{username:_}})):fe(p({id:"Owr/5+",values:{username:_}}))}})()},children:[e(I,{icon:"endorsement"}),p(ue?{id:"S9JvjK"}:{id:"UlJ3QN"})]}),r&&Ie&&!d&&e(ye,{onClick:()=>a(!0),children:[e(I,{icon:"endorsement"}),e("span",{children:e(f,{id:"Qopbnd"})})]}),X&&e(ye,{onClick:()=>{ke(!0)},children:[e(I,{icon:"list"}),Me.length?e(U,{children:[e("small",{class:"menu-grow",children:[e(f,{id:"sJ2yQc"}),e("br",{}),e("span",{class:"more-insignificant",children:Me.map(D=>D.title).join(", ")})]}),e("small",{class:"more-insignificant",children:Me.length})]}):e("span",{children:e(f,{id:"sJ2yQc"})})]}),e(Ve,{})]}):Ie&&!d&&e(U,{children:[e(ye,{onClick:()=>a(!0),children:[e(I,{icon:"endorsement"}),"Show featured profiles"]}),e(Ve,{})]}),e(ye,{onClick:()=>{const D=`@${(ne==null?void 0:ne.acct)||Te}`;try{navigator.clipboard.writeText(D),fe(p({id:"zJoEwS"}))}catch{fe(p({id:"BC0lSD"}))}},children:[e(I,{icon:"copy"}),e("small",{children:[e(f,{id:"27x6gl"}),e("br",{}),e("span",{class:"more-insignificant bidi-isolate",children:["@",(ne==null?void 0:ne.acct)||Te]})]})]}),e(ye,{href:k,target:"_blank",children:[e(I,{icon:"external"}),e("small",{class:"menu-double-lines",children:Sa(k)})]}),e("div",{class:"menu-horizontal",children:[e(ye,{onClick:()=>{try{navigator.clipboard.writeText(k),fe(p({id:"edWbV6"}))}catch{fe(p({id:"W1ewR0"}))}},children:[e(I,{icon:"link"}),e("span",{children:e(f,{id:"he3ygx"})})]}),(navigator==null?void 0:navigator.share)&&((N=navigator==null?void 0:navigator.canShare)==null?void 0:N.call(navigator,{url:k}))&&e(ye,{onClick:()=>{try{navigator.share({url:k})}catch{alert(p({id:"TtG3Uh"}))}},children:[e(I,{icon:"share"}),e("span",{children:e(f,{id:"LFKLqp"})})]})]}),!!S&&e(U,{children:[e(Ve,{}),K?e(ye,{onClick:()=>{m("loading"),(async()=>{try{const D=await g.v1.accounts.$select((ne==null?void 0:ne.id)||T).unmute();C(D),m("default"),fe(p({id:"B4Xkly",values:{username:_}})),x.reloadGenericAccounts.id="mute",x.reloadGenericAccounts.counter++}catch{m("error")}})()},children:[e(I,{icon:"unmute"}),e("span",{children:e(f,{id:"Q/HUhC",values:{username:_},components:{0:e("span",{class:"bidi-isolate"})}})})]}):e(dn,{menuClassName:"menu-blur",openTrigger:"clickOnly",direction:"bottom",overflow:"auto",shift:16,label:e(U,{children:[e(I,{icon:"mute"}),e("span",{class:"menu-grow",children:e(f,{id:"xhPEH3",values:{username:_},components:{0:e("span",{class:"bidi-isolate"})}})}),e("span",{style:{textOverflow:"clip"},children:[e(I,{icon:"time"}),e(I,{icon:"chevron-right"})]})]}),children:e("div",{class:"menu-wrap",children:fa.map(D=>e(ye,{onClick:()=>{m("loading"),(async()=>{try{const oe=await g.v1.accounts.$select((ne==null?void 0:ne.id)||T).mute({duration:D});C(oe),m("default"),fe(p({id:"/plB9m",values:{0:typeof Ht[D]=="function"?Ht[D]():h(Ht[D]),username:_}})),x.reloadGenericAccounts.id="mute",x.reloadGenericAccounts.counter++}catch{m("error"),fe(p({id:"vWGBjT",values:{username:_}}))}})()},children:typeof Ht[D]=="function"?Ht[D]():h(Ht[D])}))})}),B&&e(pt,{subMenu:!0,menuItemClassName:"danger",confirmLabel:e(U,{children:[e(I,{icon:"user-x"}),e("span",{children:e(f,{id:"unyq2W",values:{username:_},components:{0:e("span",{class:"bidi-isolate"})}})})]}),onClick:()=>{m("loading"),(async()=>{try{const D=await g.v1.accounts.$select((ne==null?void 0:ne.id)||T).removeFromFollowers();C(D),m("default"),fe(p({id:"AgkcM/",values:{username:_}})),x.reloadGenericAccounts.id="followers",x.reloadGenericAccounts.counter++}catch{m("error")}})()},children:[e(I,{icon:"user-x"}),e("span",{children:e(f,{id:"VCZ0OT"})})]}),e(pt,{subMenu:!0,confirm:!ee,confirmLabel:e(U,{children:[e(I,{icon:"block"}),e("span",{children:e(f,{id:"aforS9",values:{username:_},components:{0:e("span",{class:"bidi-isolate"})}})})]}),itemProps:{className:"danger"},menuItemClassName:"danger",onClick:()=>{m("loading"),(async()=>{try{if(ee){const D=await g.v1.accounts.$select((ne==null?void 0:ne.id)||T).unblock();C(D),m("default"),fe(p({id:"sI9N29",values:{username:_}}))}else{const D=await g.v1.accounts.$select((ne==null?void 0:ne.id)||T).block();C(D),m("default"),fe(p({id:"uYcYzu",values:{username:_}}))}x.reloadGenericAccounts.id="block",x.reloadGenericAccounts.counter++}catch{m("error"),ee?fe(p({id:"0tG4wG",values:{username:_}})):fe(p({id:"pA+qEx",values:{username:_}}))}})()},children:ee?e(U,{children:[e(I,{icon:"unblock"}),e("span",{children:e(f,{id:"/3LJfX",values:{username:_},components:{0:e("span",{class:"bidi-isolate"})}})})]}):e(U,{children:[e(I,{icon:"block"}),e("span",{children:e(f,{id:"JRswkR",values:{username:_},components:{0:e("span",{class:"bidi-isolate"})}})})]})}),e(ye,{className:"danger",onClick:()=>{x.showReportModal={account:ne||n}},children:[e(I,{icon:"flag"}),e("span",{children:e(f,{id:"qTJgpR",values:{username:_},components:{0:e("span",{class:"bidi-isolate"})}})})]})]}),b&&Ce&&s&&Je("@mastodon/profile-edit")&&e(U,{children:[e(Ve,{}),e(ye,{onClick:()=>{u(!0)},children:[e(I,{icon:"pencil"}),e("span",{children:e(f,{id:"9OpVZg"})})]})]}),!1]}),!S&&v==="loading"&&e(Be,{abrupt:!0}),!!S&&!W&&e(pt,{confirm:X||te,confirmLabel:e("span",{children:p(te?{id:"e7qQIH"}:{id:"eYsAQr",values:{0:n.acct||n.username}})}),menuItemClassName:"danger",align:"end",disabled:Pe,onClick:()=>{m("loading"),(async()=>{try{let D;X||te?D=await g.v1.accounts.$select(V.current).unfollow():D=await g.v1.accounts.$select(V.current).follow(),D&&(C(D),D.following&&a("onlyOpenIfHasEndorsements")),m("default")}catch(D){alert(D),m("error")}})()},children:e("button",{type:"button",class:`${X||te?"light swap":""}`,"data-swap-state":X||te?"danger":"",disabled:Pe,children:X?e(U,{children:[e("span",{children:e(f,{id:"y6sq5j"})}),e("span",{children:e(f,{id:"HKrBPX"})})]}):te?e(U,{children:[e("span",{children:e(f,{id:"Yx0Ud8"})}),e("span",{children:e(f,{id:"yTVtKs"})})]}):E?e(U,{children:[e(I,{icon:"lock"})," ",e("span",{children:e(f,{id:"MKEPCY"})})]}):p({id:"MKEPCY"})})})]})]}),!!$e&&e(qe,{onClose:()=>{Ee(!1)},children:e(_a,{note:F,fields:O,onClose:()=>Ee(!1)})}),!!H&&e(qe,{onClose:()=>{ke(!1)},children:e(Ca,{accountID:V.current,onClose:()=>ke(!1)})}),!!De&&e(qe,{onClose:()=>{xe(!1)},children:e(Ia,{account:n,note:he,onRelationshipChange:D=>{C(D)},onClose:()=>xe(!1)})})]})}function ka([n,i,s]){const o=.2126*n+.7152*i+.0722*s;let c;return o>=220?c=1:o<=50?c=.1:c=o/255,c=Math.min(1,c),[n,i,s,c]}function Sa(n){if(!n)return;const i=URL.parse(n);if(!i)return;const{host:s,pathname:o}=i,c=o.replace(/\/$/,"").replace(/^\//,"");return e(U,{children:[e("span",{class:"more-insignificant",children:[un.toUnicode(s),"/"]}),e("wbr",{}),e("span",{children:c})]})}function _a({note:n,fields:i,onClose:s}){const{_:o}=re(),c=(i==null?void 0:i.map(({name:u,value:r})=>`${u}
${Di(r)}`).join(`

`))||"",l=Di(n)+(c?`

${c}`:"");return e("div",{class:"sheet",children:[!!s&&e("button",{type:"button",class:"sheet-close",onClick:s,children:e(I,{icon:"x",alt:o({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(f,{id:"9groMz"})})}),e("main",{children:[e("p",{style:{whiteSpace:"pre-wrap"},children:l}),e(Ls,{forceTranslate:!0,text:l})]})]})}function Ca({accountID:n,onClose:i}){const{_:s}=re(),{masto:o}=le(),[c,l]=M("default"),[u,r]=M([]),[d,a]=M([]),[h,p]=Lt(b=>b+1,0);Q(()=>{l("loading"),(async()=>{try{const b=await hn();r(b);const w=await o.v1.accounts.$select(n).lists.list();a(w),l("default")}catch{l("error")}})()},[h]);const[g,y]=M(!1);return e("div",{class:"sheet",id:"list-add-remove-container",children:[!!i&&e("button",{type:"button",class:"sheet-close",onClick:i,children:e(I,{icon:"x",alt:s({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(f,{id:"sJ2yQc"})})}),e("main",{children:[u.length>0?e("ul",{class:"list-add-remove",children:u.map(b=>{const w=d.some(v=>v.id===b.id);return e("li",{children:e("button",{type:"button",class:`light ${w?"checked":""}`,disabled:c==="loading",onClick:()=>{l("loading"),(async()=>{try{w?await o.v1.lists.$select(b.id).accounts.remove({accountIds:[n]}):await o.v1.lists.$select(b.id).accounts.create({accountIds:[n]}),p()}catch{l("error"),alert(s(w?{id:"7KnEYa"}:{id:"Tba8uO"}))}})()},children:[e(I,{icon:"check-circle",alt:"☑️"}),e("span",{children:b.title})]})})})}):c==="loading"?e("p",{class:"ui-state",children:e(Be,{abrupt:!0})}):c==="error"?e("p",{class:"ui-state",children:e(f,{id:"v/l5uA"})}):e("p",{class:"ui-state",children:e(f,{id:"/MJ7gZ"})}),e("button",{type:"button",class:"plain2",onClick:()=>y(!0),disabled:c!=="default",children:[e(I,{icon:"plus",size:"l"})," ",e("span",{children:e(f,{id:"Sb2gYF"})})]})]}),g&&e(qe,{onClick:b=>{b.target===b.currentTarget&&y(!1)},children:e(xi,{list:g==null?void 0:g.list,onClose:b=>{b.state==="success"&&p(),y(!1)}})})]})}function Ia({account:n,note:i,onRelationshipChange:s=()=>{},onClose:o=()=>{}}){const{_:c}=re(),{masto:l}=le(),[u,r]=M("default"),d=q(null);return Q(()=>{let a;return d.current&&!i&&(a=setTimeout(()=>{var h,p;(p=(h=d.current).focus)==null||p.call(h)},100)),()=>{clearTimeout(a)}},[]),e("div",{class:"sheet",id:"private-note-container",children:[!!o&&e("button",{type:"button",class:"sheet-close",onClick:o,children:e(I,{icon:"x",alt:c({id:"yz7wBu"})})}),e("header",{children:e("b",{children:e(f,{id:"DYqYm5",values:{0:(n==null?void 0:n.username)||(n==null?void 0:n.acct)},components:{0:e("span",{class:"bidi-isolate"})}})})}),e("main",{children:e("form",{onSubmit:a=>{a.preventDefault();const p=new FormData(a.target).get("note");(p==null?void 0:p.trim())!==(i==null?void 0:i.trim())&&(r("loading"),(async()=>{try{const g=await l.v1.accounts.$select(n==null?void 0:n.id).note.create({comment:p});r("default"),s(g),o()}catch(g){r("error"),alert((g==null?void 0:g.message)||c({id:"ot8LpF"}))}})())},children:[e("textarea",{ref:d,name:"note",disabled:u==="loading",dir:"auto",children:i}),e("footer",{children:[e("button",{type:"button",class:"light",disabled:u==="loading",onClick:()=>{o==null||o()},children:e(f,{id:"dEgA5A"})}),e("span",{children:[e(Be,{abrupt:!0,hidden:u!=="loading"}),e("button",{disabled:u==="loading",type:"submit",children:e(f,{id:"SrwrEj"})})]})]})]})})]})}const Ta=["image/jpeg","image/png","image/gif","image/webp"],Gi=Ta.join(",");function Aa({onClose:n=()=>{}}){const{_:i}=re(),{masto:s}=le(),[o,c]=M("loading"),[l,u]=M(null),[r,d]=M(null),[a,h]=M(null);Q(()=>{(async()=>{try{const T=await s.v1.accounts.verifyCredentials();u(T),c("default")}catch{c("error")}})()},[]);const{displayName:p,source:g,avatar:y,header:b}=l||{},{note:w,fields:v}=g||{},m=q(null),S=[...y?[{type:"image",url:y}]:[],...a?[{type:"image",url:a}]:[]],C=[...b?[{type:"image",url:b}]:[],...r?[{type:"image",url:r}]:[]];return e("div",{class:"sheet",id:"edit-profile-container",children:[!!n&&e("button",{type:"button",class:"sheet-close",onClick:n,children:e(I,{icon:"x",alt:i({id:"yz7wBu"})})}),e("header",{children:e("b",{children:e(f,{id:"9OpVZg"})})}),e("main",{children:o==="loading"?e("p",{class:"ui-state",children:e(Be,{abrupt:!0})}):e("form",{onSubmit:T=>{T.preventDefault();const A=new FormData(T.target),k=A.get("header"),_=A.get("avatar"),E=A.get("display_name"),R=A.get("note"),F=m.current.querySelectorAll('input[name^="fields_attributes"]'),O=[];F.forEach(W=>{const V=W.name,[X,Y,Z]=V.match(/fields_attributes\[(\d+)\]\[(.+)\]/)||[],B=W.value?W.value.trim():"";Y&&Z&&B&&(O[Y]||(O[Y]={}),O[Y][Z]=B)}),O.forEach(W=>{W.name&&!W.value&&(W.value="")}),(async()=>{try{const W=await s.v1.accounts.updateCredentials({header:k,avatar:_,displayName:E,note:R,fieldsAttributes:O});n==null||n({state:"success",account:W})}catch(W){alert((W==null?void 0:W.message)||i({id:"FwMMx0"}))}})()},children:[e("div",{class:"edit-profile-media-container",children:[e("label",{children:[e(f,{id:"C5zXYJ"})," ",e("input",{type:"file",name:"header",accept:Gi,onChange:T=>{const A=T.target.files[0];if(A){const k=URL.createObjectURL(A);d(k)}}})]}),e("div",{class:"edit-profile-media-field",children:[b?e("div",{class:"edit-media",tabIndex:"0",onClick:()=>{x.showMediaModal={mediaAttachments:C,mediaIndex:0}},children:e("img",{src:b,alt:""})}):e("div",{class:"edit-media"}),r&&e(U,{children:[e(I,{icon:"arrow-right"}),e("div",{class:"edit-media",tabIndex:"0",onClick:()=>{x.showMediaModal={mediaAttachments:C,mediaIndex:1}},children:e("img",{src:r,alt:""})})]})]})]}),e("div",{class:"edit-profile-media-container",children:[e("label",{children:[e(f,{id:"4XF0BB"})," ",e("input",{type:"file",name:"avatar",accept:Gi,onChange:T=>{const A=T.target.files[0];if(A){const k=URL.createObjectURL(A);h(k)}}})]}),e("div",{class:"edit-profile-media-field",children:[y?e("div",{class:"edit-media",tabIndex:"0",onClick:()=>{x.showMediaModal={mediaAttachments:S,mediaIndex:0}},children:e("img",{src:y,alt:""})}):e("div",{class:"edit-media"}),a&&e(U,{children:[e(I,{icon:"arrow-right"}),e("div",{class:"edit-media",tabIndex:"0",onClick:()=>{x.showMediaModal={mediaAttachments:S,mediaIndex:1}},children:e("img",{src:a,alt:""})})]})]})]}),e("p",{children:e("label",{children:[e(f,{id:"6YtxFj"})," ",e("input",{type:"text",name:"display_name",defaultValue:p,maxLength:30,disabled:o==="loading",dir:"auto"})]})}),e("p",{children:e("label",{children:[e(f,{id:"E+oKCO"}),e("textarea",{defaultValue:w,name:"note",maxLength:500,rows:"5",disabled:o==="loading",dir:"auto"})]})}),e("p",{children:e(f,{id:"T4I119"})}),e("table",{ref:m,children:[e("thead",{children:e("tr",{children:[e("th",{children:e(f,{id:"87a/t/"})}),e("th",{children:e(f,{id:"4b3oEV"})})]})}),e("tbody",{children:Array.from({length:Math.max(4,v.length)}).map((T,A)=>{const{name:k="",value:_=""}=v[A]||{};return e(xa,{name:k,value:_,index:A,disabled:o==="loading"},A)})})]}),e("footer",{children:[e("button",{type:"button",class:"light",disabled:o==="loading",onClick:()=>{n==null||n()},children:e(f,{id:"dEgA5A"})}),e("button",{type:"submit",disabled:o==="loading",children:e(f,{id:"tfDRzk"})})]})]})})]})}function xa({name:n,value:i,disabled:s,index:o}){const[c,l]=M(!!i);return e("tr",{children:[e("td",{children:e("input",{type:"text",name:`fields_attributes[${o}][name]`,defaultValue:n,disabled:s,maxLength:255,required:c,dir:"auto"})}),e("td",{children:e("input",{type:"text",name:`fields_attributes[${o}][value]`,defaultValue:i,disabled:s,maxLength:255,onChange:u=>l(!!u.currentTarget.value),dir:"auto"})})]})}function Ea({acct:n,instance:i}){let[s,o]=n.split("@");o||(o=i);const c=un.toASCII(n);return e("div",{class:"handle-info",children:[e("span",{class:"handle-handle",title:c,children:[e("b",{class:"handle-username",children:s}),e("span",{class:"handle-at",children:"@"}),e("b",{class:"handle-server",children:o})]}),e("div",{class:"handle-legend",children:[e("span",{class:"ib",children:[e("span",{class:"handle-legend-icon username"})," ",e(f,{id:"silO9A"})]})," ",e("span",{class:"ib",children:[e("span",{class:"handle-legend-icon server"})," ",e(f,{id:"rZgCpJ"})]})]})]})}function Ra({accountID:n,info:i,open:s=!1,onlyOpenIfHasEndorsements:o=!1}){const{masto:c}=le(),l=q(),[u,r]=M("default"),[d,a]=M([]),[h,p]=M({});return Q(()=>{Je("@mastodon/endorsements")&&s&&(async()=>{r("loading");try{const y=await c.v1.accounts.$select(n).endorsements.list({limit:ba});if(!y.length){r("default");return}a(y),r("default"),setTimeout(()=>{l.current.scrollIntoView({behavior:"smooth",block:"nearest"})},300);const b=await Dn(y,h);b&&p(b)}catch{r("error")}})()},[s,n]),(o?s&&d.length>0:s)?e("div",{class:"shazam-container",children:e("div",{class:"shazam-container-inner",children:e("div",{class:"endorsements-container",ref:l,children:[e("h3",{children:e(f,{id:"UIfdY1",values:{0:i.username}})}),u==="loading"?e("p",{class:"ui-state",children:e(Be,{abrupt:!0})}):d.length>0?e("ul",{class:`endorsements ${d.length>10?"expanded":""}`,children:d.map(y=>e("li",{children:e(ft,{account:y,showStats:!0,avatarSize:"xxl",relationship:h[y.id]},y.id)}))}):e("p",{class:"ui-state insignificant",children:e(f,{id:"AgkUZa"})})]})})}):null}function La({account:n,instance:i,onClose:s}){const{_:o}=re(),{masto:c,instance:l,authenticated:u}=le({instance:i}),r=typeof n=="string";return Q(()=>{r||(x.accounts[`${n.id}@${l}`]=n)},[n]),Ys(s),e("div",{class:"sheet",children:[!!s&&e("button",{type:"button",class:"sheet-close outer",onClick:s,children:e(I,{icon:"x",alt:o({id:"yz7wBu"})})}),e(Gs,{instance:l,authenticated:u,account:n,fetchAccount:async()=>{if(r)try{return await c.v1.accounts.lookup({acct:n,skip_webfinger:!1})}catch{const a=await c.v2.search.list({q:n,type:"accounts",limit:u?1:11,resolve:u});if(a.accounts.length){const h=a.accounts.find(p=>p.url===n||n.startsWith(p.url));if(h)return h}if(/^https?:\/\/[^/]+\/@[^/]+$/.test(n)){const h=URL.parse(n);if(h){const{hostname:p,pathname:g}=h,y=g.replace(/^\//,"").replace(/\/$/,"")+"@"+p,b=await c.v2.search.list({q:y,type:"accounts",limit:1,resolve:u});if(b.accounts.length)return b.accounts[0]}}}else return n}})]})}function Ma({onClose:n}){const{_:i}=re(),{masto:s}=le(),[o,c]=M("default"),[l,u]=M([]),[r,d]=Lt(h=>h+1,0);Q(()=>{c("loading"),(async()=>{try{const h=await gt.drafts.keys();if(h.length){const p=An(),g=h.filter(y=>y.startsWith(p));if(g.length){const y=await gt.drafts.getMany(g);y.sort((b,w)=>new Date(w.updatedAt).getTime()-new Date(b.updatedAt).getTime()),u(y)}else u([])}else u([]);c("default")}catch{c("error")}})()},[r]);const a=(l==null?void 0:l.length)>0;return e("div",{class:"sheet",children:[!!n&&e("button",{type:"button",class:"sheet-close",onClick:n,children:e(I,{icon:"x",alt:i({id:"yz7wBu"})})}),e("header",{children:[e("h2",{children:[e(f,{id:"krk5ws"})," ",e(Be,{abrupt:!0,hidden:o!=="loading"})]}),a&&e("div",{class:"insignificant",children:e(f,{id:"Ap/10+"})})]}),e("main",{children:a?e(U,{children:[e("ul",{class:"drafts-list",children:l.map(h=>{const{updatedAt:p,key:g,draftStatus:y,replyTo:b}=h,w=new Date(p);return e("li",{children:[e("div",{class:"mini-draft-meta",children:[e("b",{children:[e(I,{icon:b?"reply":"quill",size:"s"})," ",e("time",{children:[!!b&&e(U,{children:[e("span",{class:"bidi-isolate",children:["@",b.account.acct]}),e("br",{})]}),ct(w)]})]}),e(pt,{confirmLabel:e("span",{children:e(f,{id:"/W5yFF"})}),menuItemClassName:"danger",align:"end",disabled:o==="loading",onClick:()=>{(async()=>{try{await gt.drafts.del(g),d()}catch{alert(i({id:"rEYoku"}))}})()},children:e("button",{type:"button",class:"small light",disabled:o==="loading",children:e(f,{id:"Jb6/SB"})})})]}),e("button",{type:"button",disabled:o==="loading",class:"draft-item",onClick:async()=>{let v;if(b){c("loading");try{v=await s.v1.statuses.$select(b.id).fetch()}catch{alert(i({id:"tMwimH"})),c("default");return}c("default")}window.__COMPOSE__={draftStatus:y,replyToStatus:v},x.showCompose=!0,x.showDrafts=!1},children:e($a,{draft:h})})]},p)})}),l.length>1&&e("p",{children:e(pt,{confirmLabel:e("span",{children:e(f,{id:"3IakFR"})}),menuItemClassName:"danger",disabled:o==="loading",onClick:()=>{(async()=>{c("loading");try{await gt.drafts.delMany(l.map(h=>h.key)),c("default"),d()}catch{alert(i({id:"0J4sZq"})),c("error")}})()},children:e("button",{type:"button",class:"light danger",disabled:o==="loading",children:e(f,{id:"hOg+Mt"})})})})]}):e("p",{children:e(f,{id:"8iQ+jk"})})})]})}function $a({draft:n}){var g;const{_:i}=re(),{draftStatus:s,replyTo:o}=n,{status:c,spoilerText:l,poll:u,mediaAttachments:r}=s,d=((g=u==null?void 0:u.options)==null?void 0:g.length)>0,a=(r==null?void 0:r.length)>0,h=d||a,p=Ae(()=>{if(!a)return;const y=r.find(v=>/image/.test(v.type));if(!y)return;const{file:b}=y;return URL.createObjectURL(b)},[a,r]);return e(U,{children:e("div",{class:"mini-draft",children:[h&&e("div",{class:`mini-draft-aside ${p?"has-image":""}`,style:p?{"--bg-image":`url(${p})`}:{},children:[d&&e(I,{icon:"poll",alt:i({id:"4WUbF1"})}),a&&e("span",{children:[e(I,{icon:"attachment",alt:i({id:"xYilR2"})})," ",e("small",{children:r==null?void 0:r.length})]})]}),e("div",{class:"mini-draft-main",children:[!!l&&e("div",{class:"mini-draft-spoiler",children:l}),!!c&&e("div",{class:"mini-draft-status",children:c})]})]})})}function Na({html:n,url:i,width:s,height:o,onClose:c=()=>{}}){const{_:l}=re();return e("div",{class:"embed-modal-container",children:[e("div",{class:"top-controls",children:[e("button",{type:"button",class:"light",onClick:()=>c(),children:e(I,{icon:"x",alt:l({id:"yz7wBu"})})}),i&&e("a",{href:i,target:"_blank",rel:"noopener",class:"button plain",children:[e("span",{children:e(f,{id:"4/RpOy"})})," ",e(I,{icon:"external"})]})]}),e("div",{class:"embed-content",dangerouslySetInnerHTML:{__html:n},style:{"--width":s+"px","--height":o+"px","--aspect-ratio":`${s}/${o}`}})]})}function Pa({instance:n,excludeRelationshipAttrs:i=[],postID:s,onClose:o=()=>{},blankCopy:c}){const{_:l}=re(),{masto:u,instance:r}=le(),d=n?n===r:!0,a=We(x),[h,p]=M("default"),[g,y]=M(!1);if(Ys(o),!a.showGenericAccounts)return null;const{id:b,heading:w,fetchAccounts:v,accounts:m,showReactions:S}=a.showGenericAccounts,[C,T]=M(m!=null&&m.length?m:[]),[A,k]=M({}),_=async O=>{if(!(O!=null&&O.length)||!d)return;const W=await Dn(O,A);W&&k({...A,...W})},E=O=>{v&&(O&&!(C!=null&&C.length)&&T([]),p("loading"),(async()=>{try{const{done:W,value:V}=await v(O);if(Array.isArray(V)){if(O){const X=[];for(let Y=0;Y<V.length;Y++){const Z=V[Y],B=X.find((ee,$)=>ee.id===Z.id&&Y!==$);B?B._types.push(...Z._types):X.push({_types:[],...Z})}T(X)}else T(X=>{const Y=X;for(const Z of V){const B=Y.find(ee=>ee.id===Z.id);B?B._types.push(...Z._types):Y.push(Z)}return Y});y(!W),_(V)}else y(!1);p("default")}catch{p("error")}})())},R=q(!0);Q(()=>{(C==null?void 0:C.length)>0?v?(E(!0),R.current=!1):_(C):(E(!0),R.current=!1)},[v]),Q(()=>{var O;R.current||((O=a.reloadGenericAccounts)==null?void 0:O.id)===b&&E(!0)},[a.reloadGenericAccounts.counter]);const F=x.statuses[s];return e("div",{id:"generic-accounts-container",class:"sheet",tabindex:"-1",children:[e("button",{type:"button",class:"sheet-close",onClick:o,children:e(I,{icon:"x",alt:l({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:w||l({id:"bPwFdf"})})}),e("main",{children:[F&&e(ge,{to:`/${n||r}/s/${F.id}`,class:"post-preview",children:e(Ge,{status:F,size:"s",readOnly:!0})}),C.length>0?e(U,{children:[e("ul",{class:"accounts-list",children:C.map(O=>{var X,Y;const W=A[O.id],V=`${O.id}-${((X=O._types)==null?void 0:X.length)||""}`;return e("li",{children:[S&&((Y=O._types)==null?void 0:Y.length)>0&&e("div",{class:"reactions-block",children:O._types.map(Z=>e(I,{icon:{reblog:"rocket",favourite:"heart"}[Z],class:`${Z}-icon`}))}),e("div",{class:"account-relationships",children:e(ft,{account:O,showStats:!0,relationship:W,excludeRelationshipAttrs:i})})]},V)})}),h==="default"?g?e(Tt,{onChange:O=>{O&&E()},children:e("button",{type:"button",class:"plain block",onClick:()=>E(),children:e(f,{id:"uXRAkV"})})}):e("p",{class:"ui-state insignificant",children:e(f,{id:"2EYeAZ"})}):h==="loading"&&e("p",{class:"ui-state",children:e(Be,{abrupt:!0})})]}):h==="loading"?e("p",{class:"ui-state",children:e(Be,{abrupt:!0})}):h==="error"?e("p",{class:"ui-state",children:e(f,{id:"AThL/k"})}):e("p",{class:"ui-state insignificant",children:c||l({id:"10OlfF"})})]})]})}const Da=140;function Oa({alt:n,lang:i,onClose:s}){const{_:o}=re(),c=We(x),[l,u]=M(!1),r=xs(!0),d=c.settings.contentTranslationHideLanguages||[],a=!!i&&i!==r&&!xn([i],[r])&&!d.find(h=>i===h||xn([i],[h]));return Q(()=>{const h=(n==null?void 0:n.length)>0&&(n==null?void 0:n.length)<=Da;a&&h&&u(!0)},[a,n]),e("div",{class:"sheet",tabindex:"-1",children:[!!s&&e("button",{type:"button",class:"sheet-close outer",onClick:s,children:e(I,{icon:"x",alt:o({id:"yz7wBu"})})}),e("header",{class:"header-grid",children:[e("h2",{children:e(f,{id:"5gfDMm"})}),e("div",{class:"header-side",children:e(dt,{align:"end",menuButton:e("button",{type:"button",class:"plain4",children:e(I,{icon:"more",alt:o({id:"2FYpfJ"}),size:"xl"})}),children:[e(ye,{disabled:l,onClick:()=>{u(!0)},children:[e(I,{icon:"translate"}),e("span",{children:e(f,{id:"pi8x/S"})})]}),Wo&&e(ye,{onClick:()=>{Zo(n,i)},children:[e(I,{icon:"speak"}),e("span",{children:e(f,{id:"yIBLq8"})})]})]})})]}),e("main",{lang:i,dir:"auto",children:[e("p",{style:{whiteSpace:"pre-wrap",textWrap:"pretty"},children:n}),(a||l)&&e(Ls,{forceTranslate:l,sourceLanguage:i,text:n})]})]})}const{min:qd,max:jd}=Math;const Ws={};for(let n of["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"])Ws[`[object ${n}]`]=n.toLowerCase();function za(n){return Ws[Object.prototype.toString.call(n)]||"object"}const Qt=(n,i=null)=>n.length>=3?Array.prototype.slice.call(n):za(n[0])=="object"&&i?i.split("").filter(s=>n[0][s]!==void 0).map(s=>n[0][s]):n[0].slice(0);const{PI:Fn,min:Vd,max:Gd}=Math;const Wd=Fn*2,Zd=Fn/3,Ua=Fn/180,Ba=180/Fn;function Mn(n,i){let s=n.length;Array.isArray(n[0])||(n=[n]),Array.isArray(i[0])||(i=i.map(u=>[u]));let o=i[0].length,c=i[0].map((u,r)=>i.map(d=>d[r])),l=n.map(u=>c.map(r=>Array.isArray(u)?u.reduce((d,a,h)=>d+a*(r[h]||0),0):r.reduce((d,a)=>d+a*u,0)));return s===1&&(l=l[0]),o===1?l.map(u=>u[0]):l}const Zs={Kn:18,labWhitePoint:"d65",Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452,kE:216/24389,kKE:8,kK:24389/27,RefWhiteRGB:{X:.95047,Y:1,Z:1.08883},MtxRGB2XYZ:{m00:.4124564390896922,m01:.21267285140562253,m02:.0193338955823293,m10:.357576077643909,m11:.715152155287818,m12:.11919202588130297,m20:.18043748326639894,m21:.07217499330655958,m22:.9503040785363679},MtxXYZ2RGB:{m00:3.2404541621141045,m01:-.9692660305051868,m02:.055643430959114726,m10:-1.5371385127977166,m11:1.8760108454466942,m12:-.2040259135167538,m20:-.498531409556016,m21:.041556017530349834,m22:1.0572251882231791},As:.9414285350000001,Bs:1.040417467,Cs:1.089532651,MtxAdaptMa:{m00:.8951,m01:-.7502,m02:.0389,m10:.2664,m11:1.7135,m12:-.0685,m20:-.1614,m21:.0367,m22:1.0296},MtxAdaptMaI:{m00:.9869929054667123,m01:.43230526972339456,m02:-.008528664575177328,m10:-.14705425642099013,m11:.5183602715367776,m12:.04004282165408487,m20:.15996265166373125,m21:.0492912282128556,m22:.9684866957875502}};const Vn=n=>{const i=Math.sign(n);return n=Math.abs(n),(n<=.0031308?n*12.92:1.055*Math.pow(n,1/2.4)-.055)*i},Fa=(n,i,s)=>{const{MtxAdaptMa:o,MtxAdaptMaI:c,MtxXYZ2RGB:l,RefWhiteRGB:u,Xn:r,Yn:d,Zn:a}=Zs,h=r*o.m00+d*o.m10+a*o.m20,p=r*o.m01+d*o.m11+a*o.m21,g=r*o.m02+d*o.m12+a*o.m22,y=u.X*o.m00+u.Y*o.m10+u.Z*o.m20,b=u.X*o.m01+u.Y*o.m11+u.Z*o.m21,w=u.X*o.m02+u.Y*o.m12+u.Z*o.m22,v=(n*o.m00+i*o.m10+s*o.m20)*(y/h),m=(n*o.m01+i*o.m11+s*o.m21)*(b/p),S=(n*o.m02+i*o.m12+s*o.m22)*(w/g),C=v*c.m00+m*c.m10+S*c.m20,T=v*c.m01+m*c.m11+S*c.m21,A=v*c.m02+m*c.m12+S*c.m22,k=Vn(C*l.m00+T*l.m10+A*l.m20),_=Vn(C*l.m01+T*l.m11+A*l.m21),E=Vn(C*l.m02+T*l.m12+A*l.m22);return[k*255,_*255,E*255]},Ei=(...n)=>{n=Qt(n,"lab");const[i,s,o,...c]=n,[l,u,r]=Ka([i,s,o]),[d,a,h]=Fa(l,u,r);return[d,a,h,...c.length>0&&c[0]<1?[c[0]]:[]]};function Ka(n){var i=[[1.2268798758459243,-.5578149944602171,.2813910456659647],[-.0405757452148008,1.112286803280317,-.0717110580655164],[-.0763729366746601,-.4214933324022432,1.5869240198367816]],s=[[1,.3963377773761749,.2158037573099136],[1,-.1055613458156586,-.0638541728258133],[1,-.0894841775298119,-1.2914855480194092]],o=Mn(s,n);return Mn(i,o.map(c=>c**3))}function Gn(n){const i=Math.sign(n);return n=Math.abs(n),(n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4))*i}const Ha=(n,i,s)=>{n=Gn(n/255),i=Gn(i/255),s=Gn(s/255);const{MtxRGB2XYZ:o,MtxAdaptMa:c,MtxAdaptMaI:l,Xn:u,Yn:r,Zn:d,As:a,Bs:h,Cs:p}=Zs;let g=n*o.m00+i*o.m10+s*o.m20,y=n*o.m01+i*o.m11+s*o.m21,b=n*o.m02+i*o.m12+s*o.m22;const w=u*c.m00+r*c.m10+d*c.m20,v=u*c.m01+r*c.m11+d*c.m21,m=u*c.m02+r*c.m12+d*c.m22;let S=g*c.m00+y*c.m10+b*c.m20,C=g*c.m01+y*c.m11+b*c.m21,T=g*c.m02+y*c.m12+b*c.m22;return S*=w/a,C*=v/h,T*=m/p,g=S*l.m00+C*l.m10+T*l.m20,y=S*l.m01+C*l.m11+T*l.m21,b=S*l.m02+C*l.m12+T*l.m22,[g,y,b]},Ri=(...n)=>{const[i,s,o,...c]=Qt(n,"rgb"),l=Ha(i,s,o);return[...Ya(l),...c.length>0&&c[0]<1?[c[0]]:[]]};function Ya(n){const i=[[.819022437996703,.3619062600528904,-.1288737815209879],[.0329836539323885,.9292868615863434,.0361446663506424],[.0481771893596242,.2642395317527308,.6335478284694309]],s=[[.210454268309314,.7936177747023054,-.0040720430116193],[1.9779985324311684,-2.42859224204858,.450593709617411],[.0259040424655478,.7827717124575296,-.8086757549230774]],o=Mn(i,n);return Mn(s,o.map(c=>Math.cbrt(c)))}const{sin:qa,cos:ja}=Math,Va=(...n)=>{let[i,s,o]=Qt(n,"lch");return isNaN(o)&&(o=0),o=o*Ua,[i,ja(o)*s,qa(o)*s]},Wn=(...n)=>{n=Qt(n,"lch");const[i,s,o,...c]=n,[l,u,r]=Va(i,s,o),[d,a,h]=Ei(l,u,r);return[d,a,h,...c.length>0&&c[0]<1?[c[0]]:[]]},{sqrt:Ga,atan2:Wa,round:Za}=Math,Xa=(...n)=>{const[i,s,o]=Qt(n,"lab"),c=Ga(s*s+o*o);let l=(Wa(o,s)*Ba+360)%360;return Za(c*1e4)===0&&(l=Number.NaN),[i,c,l]},Ja=(...n)=>{const[i,s,o,...c]=Qt(n,"rgb"),[l,u,r]=Ri(i,s,o),[d,a,h]=Xa(l,u,r);return[d,a,h,...c.length>0&&c[0]<1?[c[0]]:[]]},Qa={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Blaede Phanpy",PHANPY_DEFAULT_INSTANCE:"mastodon.blaede.family",PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:"https://mastodon.blaede.family/auth/sign_up",PHANPY_GIPHY_API_KEY:"48JGsrSS1XE5w4nWe9c9hqxPbsfRWR0e",PHANPY_LINGVA_INSTANCES:"lingva.phanpy.social lingva.lunar.icu lingva.garudalinux.org translate.plausibility.cloud",PHANPY_PRIVACY_POLICY_URL:"https://mastodon.blaede.family/privacy-policy",PHANPY_TRANSLANG_INSTANCES:"translang.phanpy.social",PHANPY_WEBSITE:"https://phanpy.blaede.family",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},{PHANPY_IMG_ALT_API_URL:Xd}=Qa;function Xs({mediaAttachments:n,statusID:i,instance:s,lang:o,index:c=0,onClose:l=()=>{}}){var T,A;const{_:u}=re(),[r,d]=M("default"),a=q(null),[h,p]=M(c),g=q(null);St(()=>{var k;(k=g.current)==null||k.scrollIntoView()},[]);const y=q(i);Q(()=>{const k=c*a.current.clientWidth,_=y.current!==i;_&&(y.current=i),a.current.focus(),a.current.scrollTo({left:k*(Ot()?-1:1),behavior:_?"auto":"smooth"})},[c,i]);const[b,w]=M(!0);Q(()=>{let k=_=>{l(_,h,n,a)};return a.current&&a.current.addEventListener("swiped-down",k),()=>{a.current&&a.current.removeEventListener("swiped-down",k)}},[h,n]),Ye("esc",k=>{l(k,h,n,a)},{ignoreEventWhen:k=>!!document.querySelector("#modal-container > *")||k.metaKey||k.ctrlKey||k.altKey||k.shiftKey,useKey:!0},[l,h,n]),Q(()=>{let k=()=>{const{clientWidth:_,scrollLeft:E}=a.current,R=Math.round(Math.abs(E)/_);p(R)};return a.current&&a.current.addEventListener("scroll",k,{passive:!0}),()=>{a.current&&a.current.removeEventListener("scroll",k)}},[]),Q(()=>{let k=setTimeout(()=>{var _,E;(E=(_=a.current)==null?void 0:_.focus)==null||E.call(_)},100);return()=>clearTimeout(k)},[]);const v=Ae(()=>n==null?void 0:n.map(k=>{const{blurhash:_}=k;if(_){const E=yi(_);return Ja(E)}return null}),[n]),m=Ae(()=>v==null?void 0:v.map(k=>k?{light:Wn([.95,.01,k[2]]),dark:Wn([.35,.01,k[2]]),default:Wn([.6,k[1],k[2]])}:null)),S=Ae(()=>{const _=100/m.length,E=m.map((O,W)=>{var Y,Z,B,ee;const V=W*_+5,X=(W+1)*_-5;return O!=null&&O.light&&(O!=null&&O.dark)?{light:`
                rgb(${(Y=O.light)==null?void 0:Y.join(",")}) ${V}%, 
                rgb(${(Z=O.light)==null?void 0:Z.join(",")}) ${X}%
              `,dark:`
                rgb(${(B=O.dark)==null?void 0:B.join(",")}) ${V}%, 
                rgb(${(ee=O.dark)==null?void 0:ee.join(",")}) ${X}%
              `}:{light:`
              transparent ${V}%, 
              transparent ${X}%
            `,dark:`
              transparent ${V}%, 
              transparent ${X}%
            `}}),R=E.map(O=>O.light).join(", "),F=E.map(O=>O.dark).join(", ");return{light:R,dark:F}},[m]);let C=q(null);return Q(()=>()=>{var k,_;(_=(k=C.current)==null?void 0:k.hideToast)==null||_.call(k)},[]),St(()=>{const k=m[h];let _,E;if(k){const R=ze.local.get("theme");if(R){const F=`rgb(${k[R].join(",")})`;_=document.querySelector('meta[name="theme-color"][data-theme-setting="manual"]'),_&&(E=_.content,_.content=F)}else{const F=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",O=`rgb(${k[F].join(",")})`;_=document.querySelector(`meta[name="theme-color"][media*="${F}"]`),_&&(E=_.content,_.content=O)}}return()=>{_&&E&&(_.content=E)}},[h,m]),e("div",{class:`media-modal-container media-modal-count-${n==null?void 0:n.length}`,children:[e("div",{ref:a,tabIndex:"0","data-swipe-threshold":"44",class:"carousel",onClick:k=>{(k.target.classList.contains("carousel-item")||k.target.classList.contains("media")||k.target.classList.contains("media-zoom"))&&l(k,h,n,a)},style:n.length>1?{backgroundAttachment:"local","--accent-gradient-light":S==null?void 0:S.light,"--accent-gradient-dark":S==null?void 0:S.dark}:{},children:n==null?void 0:n.map((k,_)=>{var R,F;const E=n.length===1?m[_]:null;return e("div",{class:"carousel-item",style:E?{"--accent-color":`rgb(${E.default.join(",")})`,"--accent-light-color":`rgb(${(R=E.light)==null?void 0:R.join(",")})`,"--accent-dark-color":`rgb(${(F=E.dark)==null?void 0:F.join(",")})`,"--accent-alpha-color":`rgba(${E.default.join(",")}, 0.4)`}:{},tabindex:"0",ref:_===h?g:null,onClick:O=>{O.target.classList.contains("media")||w(!b)},children:[!!k.description&&e("button",{type:"button",class:"media-alt",hidden:!b,onClick:()=>{x.showMediaAlt={alt:k.description,lang:o}},children:[e("span",{class:"alt-badge",children:"ALT"}),e("span",{class:"media-alt-desc",lang:o,dir:"auto",children:k.description})]}),e(Ms,{media:k,showOriginal:!0,lang:o})]},k.id)})}),e("div",{class:"carousel-top-controls",hidden:!b,children:[e("span",{children:e("button",{type:"button",class:"carousel-button",onClick:k=>l(k,h,n,a),children:e(I,{icon:"x",alt:u({id:"yz7wBu"})})})}),(n==null?void 0:n.length)>1?e("span",{class:"carousel-dots",children:n==null?void 0:n.map((k,_)=>e("button",{type:"button",disabled:_===h,class:`carousel-dot ${_===h?"active":""}`,onClick:E=>{E.preventDefault(),E.stopPropagation();const R=a.current.clientWidth*_*(Ot()?-1:1);a.current.focus(),a.current.scrollTo({left:R,behavior:"smooth"})},children:e(I,{icon:"round",size:"s",alt:"⸱"})},k.id))}):e("span",{}),e("span",{children:[e(dt,{overflow:"auto",align:"end",position:"anchor",gap:4,menuClassName:"glass-menu",menuButton:e("button",{type:"button",class:"carousel-button",children:e(I,{icon:"more",alt:u({id:"2FYpfJ"})})}),children:[e(je,{href:((T=n[h])==null?void 0:T.remoteUrl)||((A=n[h])==null?void 0:A.url),class:"carousel-button",target:"_blank",title:u({id:"5hXGws"}),children:[e(I,{icon:"popout"}),e("span",{children:e(f,{id:"aDr7Vc"})})]}),!1]})," ",!!i&&e(ge,{to:`${s?`/${s}`:""}/s/${i}${window.matchMedia("(min-width: calc(40em + 350px))").matches?`?media=${h+1}`:""}`,class:"button carousel-button media-post-link",children:[e("span",{class:"button-label",children:[e(f,{id:"ISg5SQ"})," "]}),"»"]})]})]}),(n==null?void 0:n.length)>1&&e("div",{class:"carousel-controls",hidden:!b,children:[e("button",{type:"button",class:"carousel-button",hidden:h===0,onClick:k=>{k.preventDefault(),k.stopPropagation(),a.current.focus(),a.current.scrollTo({left:a.current.clientWidth*(h-1)*(Ot()?-1:1),behavior:"smooth"})},children:e(I,{icon:"arrow-left",alt:u({id:"DHhJ7s"})})}),e("button",{type:"button",class:"carousel-button",hidden:h===n.length-1,onClick:k=>{k.preventDefault(),k.stopPropagation(),a.current.focus(),a.current.scrollTo({left:a.current.clientWidth*(h+1)*(Ot()?-1:1),behavior:"smooth"})},children:e(I,{icon:"arrow-right",alt:u({id:"hXzOVo"})})})]})]})}const el=["spam","legal","violation","other"],en={spam:{label:{id:"t8dIOP"},description:{id:"csQin/"}},legal:{label:{id:"IjKdHM"},description:{id:"e6tGFu"}},violation:{label:{id:"KPFHM2"},description:{id:"fpotTF"},stampLabel:{id:"iuLUuH"}},other:{label:{id:"/IX/7x"},description:{id:"kxiG8g"},excludeStamp:!0}};function tl(n,i){if(!n.translations||!i)return null;const s=Object.keys(n.translations);if(!(s!=null&&s.length))return null;let o=xn([i],s,null);if(!o){const c=s.map(l=>l.split(/(?=[A-Z])/).map((r,d)=>d===0?r:r.toLowerCase()).join("-"));o=xn([i],c,null)}if(o&&o.includes("-")){const[c,l]=o.split("-");o=c+l.charAt(0).toUpperCase()+l.slice(1)}return o}function nl(n,i){return n!=null&&n.length?i?n.map(s=>{var c,l;const o=tl(s,i);return{...s,_translatedText:((l=(c=s.translations)==null?void 0:c[o])==null?void 0:l.text)||null}}):n:[]}function il({account:n,post:i,onClose:s}){const{_:o,_:c,i18n:l}=re(),{masto:u}=le(),[r,d]=M("default"),[a,h]=n.acct.split("@"),[p,g]=Ae(()=>{const{rules:T,domain:A}=vs();return[nl(T||[],l.locale),A]},[l.locale]),[y,b]=M(null),[w,v]=M(!1),m=q(null),[S,C]=M(!1);return e("div",{class:"report-modal-container",children:[e("div",{class:"top-controls",children:[e("h1",{children:c(i?{id:"muLhL3"}:{id:"ACul2G",values:{username:a}})}),e("button",{type:"button",class:"plain4 small",disabled:r==="loading",onClick:()=>s(),children:e(I,{icon:"x",size:"xl",alt:c({id:"yz7wBu"})})})]}),e("main",{children:[e("div",{class:"report-preview",children:i?e(Ge,{status:i,size:"s",previewMode:!0}):e(ft,{account:n,avatarSize:"xxl",useAvatarStatic:!0,showStats:!0,showActivity:!0})}),!!y&&!en[y].excludeStamp&&e("span",{class:"rubber-stamp","aria-hidden":"true",children:[o(en[y].stampLabel||o(en[y].label)),e("small",{children:e(f,{id:"2WtL62"})})]},y),e("form",{onSubmit:T=>{T.preventDefault();const A=new FormData(T.target),k=Object.fromEntries(A.entries());let{category:_,comment:E,forward:R}=k;E||(E=void 0),R==="on"&&(R=!0);const F=_==="violation"?Object.entries(k).filter(([W])=>W.startsWith("rule_ids")).map(([W,V])=>V):void 0,O={category:_,comment:E,forward:R,ruleIds:F};d("loading"),(async()=>{try{await u.v1.reports.create({accountId:n.id,statusIds:i!=null&&i.id?[i.id]:void 0,category:_,comment:E,ruleIds:F,forward:R}),d("success"),fe(c(i?{id:"y3ou+8"}:{id:"R9kjEL"})),s()}catch(W){d("error"),fe((W==null?void 0:W.message)||c(i?{id:"+3FjPq"}:{id:"oEQq5w"}))}})()},children:[e("p",{children:c(i?{id:"L9fUm+"}:{id:"rSLkfe"})}),e("section",{class:"report-categories",children:el.map(T=>T==="violation"&&!(p!=null&&p.length)?null:e(U,{children:[e("label",{class:"report-category",children:[e("input",{type:"radio",name:"category",value:T,required:!0,disabled:r==="loading",onChange:A=>{b(A.target.value),v(A.target.value==="violation")}}),e("span",{children:[o(en[T].label),"  ",e("small",{class:"ib insignificant",children:o(en[T].description)})]})]}),T==="violation"&&!!(p!=null&&p.length)&&e("div",{class:"shazam-container no-animation",hidden:!w,children:e("div",{class:"shazam-container-inner",children:e("div",{class:"report-rules",ref:m,children:p.map((A,k)=>e("label",{class:"report-rule",children:[e("input",{type:"checkbox",name:`rule_ids[${k}]`,value:A.id,required:w&&!S,disabled:r==="loading",onChange:_=>{const{checked:E}=_.target;E?C(!0):m.current.querySelectorAll("input:checked").length||C(!1)}}),e("span",{children:A._translatedText||A.text})]},A.id))})})})]},T))}),e("section",{class:"report-comment",children:[e("p",{children:e("label",{for:"report-comment",children:e(f,{id:"ecVtjm"})})}),e("textarea",{maxlength:"1000",rows:"1",name:"comment",id:"report-comment",disabled:r==="loading",required:!i})]}),!!h&&h!==g&&e("section",{children:e("p",{children:e("label",{children:[e("input",{type:"checkbox",switch:!0,name:"forward",disabled:r==="loading"})," ",e("span",{children:e(f,{id:"cyjS8M",values:{domain:h},components:{0:e("i",{})}})})]})})}),e("footer",{children:[e("button",{type:"submit",disabled:r==="loading",children:e(f,{id:"4cijjm"})})," ",e("button",{type:"submit",class:"plain2",disabled:r==="loading",onClick:async()=>{try{await u.v1.accounts.$select(n.id).mute(),fe(c({id:"/BGBeF",values:{username:a}}))}catch{fe(c({id:"v02K7/",values:{username:a}}))}},children:e(f,{id:"caeqw/",components:{0:e("small",{class:"ib"})}})})," ",e("button",{type:"submit",class:"plain2",disabled:r==="loading",onClick:async()=>{try{await u.v1.accounts.$select(n.id).block(),fe(c({id:"kjUejn",values:{username:a}}))}catch{fe(c({id:"pMcdDp",values:{username:a}}))}},children:e(f,{id:"JybQca",components:{0:e("small",{class:"ib"})}})}),e(Be,{hidden:r!=="loading"})]})]})]})]})}var vn={exports:{}},Jd=vn.exports,Wi;function sl(){return Wi||(Wi=1,function(n){var i=function(){var s=String.fromCharCode,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",l={};function u(d,a){if(!l[d]){l[d]={};for(var h=0;h<d.length;h++)l[d][d.charAt(h)]=h}return l[d][a]}var r={compressToBase64:function(d){if(d==null)return"";var a=r._compress(d,6,function(h){return o.charAt(h)});switch(a.length%4){default:case 0:return a;case 1:return a+"===";case 2:return a+"==";case 3:return a+"="}},decompressFromBase64:function(d){return d==null?"":d==""?null:r._decompress(d.length,32,function(a){return u(o,d.charAt(a))})},compressToUTF16:function(d){return d==null?"":r._compress(d,15,function(a){return s(a+32)})+" "},decompressFromUTF16:function(d){return d==null?"":d==""?null:r._decompress(d.length,16384,function(a){return d.charCodeAt(a)-32})},compressToUint8Array:function(d){for(var a=r.compress(d),h=new Uint8Array(a.length*2),p=0,g=a.length;p<g;p++){var y=a.charCodeAt(p);h[p*2]=y>>>8,h[p*2+1]=y%256}return h},decompressFromUint8Array:function(d){if(d==null)return r.decompress(d);for(var a=new Array(d.length/2),h=0,p=a.length;h<p;h++)a[h]=d[h*2]*256+d[h*2+1];var g=[];return a.forEach(function(y){g.push(s(y))}),r.decompress(g.join(""))},compressToEncodedURIComponent:function(d){return d==null?"":r._compress(d,6,function(a){return c.charAt(a)})},decompressFromEncodedURIComponent:function(d){return d==null?"":d==""?null:(d=d.replace(/ /g,"+"),r._decompress(d.length,32,function(a){return u(c,d.charAt(a))}))},compress:function(d){return r._compress(d,16,function(a){return s(a)})},_compress:function(d,a,h){if(d==null)return"";var p,g,y={},b={},w="",v="",m="",S=2,C=3,T=2,A=[],k=0,_=0,E;for(E=0;E<d.length;E+=1)if(w=d.charAt(E),Object.prototype.hasOwnProperty.call(y,w)||(y[w]=C++,b[w]=!0),v=m+w,Object.prototype.hasOwnProperty.call(y,v))m=v;else{if(Object.prototype.hasOwnProperty.call(b,m)){if(m.charCodeAt(0)<256){for(p=0;p<T;p++)k=k<<1,_==a-1?(_=0,A.push(h(k)),k=0):_++;for(g=m.charCodeAt(0),p=0;p<8;p++)k=k<<1|g&1,_==a-1?(_=0,A.push(h(k)),k=0):_++,g=g>>1}else{for(g=1,p=0;p<T;p++)k=k<<1|g,_==a-1?(_=0,A.push(h(k)),k=0):_++,g=0;for(g=m.charCodeAt(0),p=0;p<16;p++)k=k<<1|g&1,_==a-1?(_=0,A.push(h(k)),k=0):_++,g=g>>1}S--,S==0&&(S=Math.pow(2,T),T++),delete b[m]}else for(g=y[m],p=0;p<T;p++)k=k<<1|g&1,_==a-1?(_=0,A.push(h(k)),k=0):_++,g=g>>1;S--,S==0&&(S=Math.pow(2,T),T++),y[v]=C++,m=String(w)}if(m!==""){if(Object.prototype.hasOwnProperty.call(b,m)){if(m.charCodeAt(0)<256){for(p=0;p<T;p++)k=k<<1,_==a-1?(_=0,A.push(h(k)),k=0):_++;for(g=m.charCodeAt(0),p=0;p<8;p++)k=k<<1|g&1,_==a-1?(_=0,A.push(h(k)),k=0):_++,g=g>>1}else{for(g=1,p=0;p<T;p++)k=k<<1|g,_==a-1?(_=0,A.push(h(k)),k=0):_++,g=0;for(g=m.charCodeAt(0),p=0;p<16;p++)k=k<<1|g&1,_==a-1?(_=0,A.push(h(k)),k=0):_++,g=g>>1}S--,S==0&&(S=Math.pow(2,T),T++),delete b[m]}else for(g=y[m],p=0;p<T;p++)k=k<<1|g&1,_==a-1?(_=0,A.push(h(k)),k=0):_++,g=g>>1;S--,S==0&&(S=Math.pow(2,T),T++)}for(g=2,p=0;p<T;p++)k=k<<1|g&1,_==a-1?(_=0,A.push(h(k)),k=0):_++,g=g>>1;for(;;)if(k=k<<1,_==a-1){A.push(h(k));break}else _++;return A.join("")},decompress:function(d){return d==null?"":d==""?null:r._decompress(d.length,32768,function(a){return d.charCodeAt(a)})},_decompress:function(d,a,h){var p=[],g,y=4,b=4,w=3,v="",m=[],S,C,T,A,k,_,E,R={val:h(0),position:a,index:1};for(S=0;S<3;S+=1)p[S]=S;for(T=0,k=Math.pow(2,2),_=1;_!=k;)A=R.val&R.position,R.position>>=1,R.position==0&&(R.position=a,R.val=h(R.index++)),T|=(A>0?1:0)*_,_<<=1;switch(g=T){case 0:for(T=0,k=Math.pow(2,8),_=1;_!=k;)A=R.val&R.position,R.position>>=1,R.position==0&&(R.position=a,R.val=h(R.index++)),T|=(A>0?1:0)*_,_<<=1;E=s(T);break;case 1:for(T=0,k=Math.pow(2,16),_=1;_!=k;)A=R.val&R.position,R.position>>=1,R.position==0&&(R.position=a,R.val=h(R.index++)),T|=(A>0?1:0)*_,_<<=1;E=s(T);break;case 2:return""}for(p[3]=E,C=E,m.push(E);;){if(R.index>d)return"";for(T=0,k=Math.pow(2,w),_=1;_!=k;)A=R.val&R.position,R.position>>=1,R.position==0&&(R.position=a,R.val=h(R.index++)),T|=(A>0?1:0)*_,_<<=1;switch(E=T){case 0:for(T=0,k=Math.pow(2,8),_=1;_!=k;)A=R.val&R.position,R.position>>=1,R.position==0&&(R.position=a,R.val=h(R.index++)),T|=(A>0?1:0)*_,_<<=1;p[b++]=s(T),E=b-1,y--;break;case 1:for(T=0,k=Math.pow(2,16),_=1;_!=k;)A=R.val&R.position,R.position>>=1,R.position==0&&(R.position=a,R.val=h(R.index++)),T|=(A>0?1:0)*_,_<<=1;p[b++]=s(T),E=b-1,y--;break;case 2:return m.join("")}if(y==0&&(y=Math.pow(2,w),w++),p[E])v=p[E];else if(E===b)v=C+C.charAt(0);else return null;m.push(v),p[b++]=C+v.charAt(0),y--,C=v,y==0&&(y=Math.pow(2,w),w++)}}};return r}();n!=null?n.exports=i:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return i})}(vn)),vn.exports}var Zi=sl();const ol="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20fill='none'%20viewBox='0%200%2084%2062'%3e%3crect%20width='64'%20height='48'%20x='18'%20y='2'%20fill='%23fff'%20stroke='%23999'%20stroke-width='3'%20rx='4'/%3e%3crect%20width='32'%20height='48'%20x='2'%20y='12'%20fill='%23fff'%20stroke='%23999'%20stroke-width='3'%20rx='4'/%3e%3cpath%20fill='%234169E1'%20d='M14%2052a4%204%200%201%201-8%200%204%204%200%200%201%208%200Zm64-42a4%204%200%201%201-8%200%204%204%200%200%201%208%200Z'/%3e%3c/svg%3e",cl="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20fill='none'%20viewBox='0%200%2082%2062'%3e%3crect%20width='78'%20height='58'%20x='2'%20y='2'%20fill='%23999'%20fill-opacity='.3'%20stroke='%23999'%20stroke-width='3'%20rx='4'/%3e%3crect%20width='18'%20height='46'%20x='8'%20y='8'%20fill='%23fff'%20stroke='%23999'%20stroke-width='2'%20rx='1'/%3e%3crect%20width='18'%20height='46'%20x='32'%20y='8'%20fill='%23fff'%20stroke='%23999'%20stroke-width='2'%20rx='1'/%3e%3crect%20width='18'%20height='46'%20x='56'%20y='8'%20fill='%23fff'%20stroke='%23999'%20stroke-width='2'%20rx='1'/%3e%3c/svg%3e",al="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20fill='none'%20viewBox='0%200%2084%2062'%3e%3crect%20width='64'%20height='48'%20x='18'%20y='2'%20fill='%23fff'%20stroke='%23999'%20stroke-width='3'%20rx='4'/%3e%3cpath%20fill='%23999'%20fill-opacity='.3'%20d='M19%203h62v10H19z'/%3e%3cpath%20stroke='%234169E1'%20stroke-width='2'%20d='M43%208a2%202%200%201%201-4%200%202%202%200%200%201%204%200Z'/%3e%3cpath%20stroke='%23999'%20stroke-width='2'%20d='M52%208a2%202%200%201%201-4%200%202%202%200%200%201%204%200Zm9%200a2%202%200%201%201-4%200%202%202%200%200%201%204%200Z'/%3e%3crect%20width='32'%20height='48'%20x='2'%20y='12'%20fill='%23fff'%20stroke='%23999'%20stroke-width='3'%20rx='4'/%3e%3cpath%20fill='%23999'%20fill-opacity='.3'%20d='M3%2049h30v10H3z'/%3e%3cpath%20stroke='%234169E1'%20stroke-width='2'%20d='M11%2054a2%202%200%201%201-4%200%202%202%200%200%201%204%200Z'/%3e%3cpath%20stroke='%23999'%20stroke-width='2'%20d='M20%2054a2%202%200%201%201-4%200%202%202%200%200%201%204%200Zm9%200a2%202%200%201%201-4%200%202%202%200%200%201%204%200Z'/%3e%3c/svg%3e",ll=200,rl=10;async function $n(){const{masto:n}=le(),i=n.v1.followedTags.list({limit:ll}).values(),s=[];let o=0;do{const{value:c,done:l}=await i.next();if(l||(c==null?void 0:c.length)===0)break;s.push(...c),o++}while(o<rl);return s.sort((c,l)=>c.name.localeCompare(l.name)),s.length&&setTimeout(()=>{ze.account.set("followedTags",{tags:s,updatedAt:Date.now()})},1),s}const dl=24*60*60*1e3;async function ul(){try{const{tags:n,updatedAt:i}=ze.account.get("followedTags")||{};return n!=null&&n.length?(Date.now()-i>dl&&$n(),n):await $n()}catch{return[]}}const Xi=document.createElement("div"),hl=n=>{if(!n)return[];if(n.indexOf("#")===-1)return[];Xi.innerHTML=n;const i=Xi.querySelectorAll("a.hashtag");return i.length?Array.from(i).map(s=>s.innerText.trim().replace(/^[^#]*#+/,"")):[]};function wn({children:n}){if(typeof n=="string")return n;const[i,s]=M("");return Q(()=>{Promise.resolve(n).then(s)},[n]),i}const It=9,fl=["following","mentions","notifications","list","public","trending","search","hashtag","bookmarks","favourites"],Js={following:{id:"7ZJHdw"},notifications:{id:"iDNBZe"},list:{id:"h16FyT"},public:{id:"tXgQpk"},search:{id:"A1taO8"},"account-statuses":{id:"AeXO77"},bookmarks:{id:"7Ff7ia"},favourites:{id:"zZOZj7"},hashtag:{id:"GP8RLS"},trending:{id:"4/iCqx"},mentions:{id:"/bZzdR"}},kn={list:[{text:{id:"DUMt1y"},name:"id",notRequired:!0}],public:[{text:{id:"OgyJSr"},name:"local",type:"checkbox"},{text:{id:"kyAi7k"},name:"instance",type:"text",placeholder:{id:"7defFj"},notRequired:!0}],trending:[{text:{id:"kyAi7k"},name:"instance",type:"text",placeholder:{id:"7defFj"},notRequired:!0}],search:[{text:{id:"dmloPh"},name:"query",type:"text",placeholder:{id:"UHDQDE"},notRequired:!0}],"account-statuses":[{text:"@",name:"id",type:"text",placeholder:"cheeaun@mastodon.social"}],hashtag:[{text:"#",name:"hashtag",type:"text",placeholder:{id:"a6oTWs"},pattern:"[^#]+"},{text:{id:"eK4SL/"},name:"media",type:"checkbox"},{text:{id:"kyAi7k"},name:"instance",type:"text",placeholder:{id:"7defFj"},notRequired:!0}]},pl=bt(async({id:n})=>{const i=await le().masto.v1.accounts.$select(n).fetch();return i.username||i.acct||i.displayName}),Nn={following:{id:"home",title:(n,i)=>i===0?pe._({id:"i0qMbr"}):pe._({id:"following.title"}),path:"/",icon:"home"},mentions:{id:"mentions",title:{id:"/bZzdR"},path:"/mentions",icon:"at"},notifications:{id:"notifications",title:{id:"iDNBZe"},path:"/notifications",icon:"notification"},list:{id:({id:n})=>n?"list":"lists",title:({id:n})=>n?ra(n):pe._({id:"h16FyT"}),path:({id:n})=>n?`/l/${n}`:"/l",icon:"list",excludeViewMode:({id:n})=>n?[]:["multi-column"]},public:{id:"public",title:({local:n})=>n?pe._({id:"d5zxa4"}):pe._({id:"4ERYY7"}),subtitle:({instance:n})=>n||le().instance,path:({local:n,instance:i})=>`/${i}/p${n?"/l":""}`,icon:({local:n})=>n?"building":"earth"},trending:{id:"trending",title:{id:"4/iCqx"},subtitle:({instance:n})=>n||le().instance,path:({instance:n})=>`/${n}/trending`,icon:"chart"},search:{id:"search",title:({query:n})=>n?`“${n}”`:pe._({id:"A1taO8"}),path:({query:n})=>n?`/search?q=${encodeURIComponent(n)}&type=statuses`:"/search",icon:"search",excludeViewMode:({query:n})=>n?[]:["multi-column"]},"account-statuses":{id:"account-statuses",title:pl,path:({id:n})=>`/a/${n}`,icon:"user"},bookmarks:{id:"bookmarks",title:{id:"7Ff7ia"},path:"/b",icon:"bookmark"},favourites:{id:"favourites",title:{id:"zZOZj7"},path:"/f",icon:"heart"},hashtag:{id:"hashtag",title:({hashtag:n})=>n,subtitle:({instance:n})=>n||le().instance,path:({hashtag:n,instance:i,media:s})=>`${i?`/${i}`:""}/t/${n.split(/\s+/).join("+")}${s?"?media=1":""}`,icon:"hashtag"}};function ml({onClose:n}){const{_:i}=re(),s=We(x),{shortcuts:o}=s,[c,l]=M(!1),[u,r]=M(!1),[d]=_i();return e("div",{id:"shortcuts-settings-container",class:"sheet",tabindex:"-1",children:[!!n&&e("button",{type:"button",class:"sheet-close",onClick:n,children:e(I,{icon:"x",alt:pe._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:[e(I,{icon:"shortcut"})," ",e(f,{id:"CTqTgr"})," ",e("sup",{style:{fontSize:12,opacity:.5,textTransform:"uppercase"},children:e(f,{id:"A1As8l"})})]})}),e("main",{children:[e("p",{children:e(f,{id:"CIHAsy"})}),e("div",{class:"shortcuts-view-mode",children:[{value:"float-button",label:pe._({id:"qwdOim"}),imgURL:ol},{value:"tab-menu-bar",label:pe._({id:"UxBoCm"}),imgURL:al},{value:"multi-column",label:pe._({id:"uvDfdW"}),imgURL:cl}].map(({value:a,label:h,imgURL:p})=>{const g=s.settings.shortcutsViewMode===a||a==="float-button"&&!s.settings.shortcutsViewMode;return e("label",{class:g?"checked":"",children:[e("input",{type:"radio",name:"shortcuts-view-mode",value:a,checked:g,onChange:y=>{x.settings.shortcutsViewMode=y.target.value}})," ",e("img",{src:p,alt:"",width:"80",height:"58"})," ",e("span",{children:h})]},a)})}),o.length>0?e(U,{children:[e("ol",{class:"shortcuts-list",ref:d,children:o.filter(Boolean).map((a,h)=>{const p=Object.values(a).join("-"),{type:g}=a;if(!Nn[g])return null;let{icon:y,title:b,subtitle:w,excludeViewMode:v}=Nn[g];typeof b=="function"?b=b(a,h):b=i(b),typeof w=="function"?w=w(a,h):w=i(w),typeof y=="function"&&(y=y(a,h)),typeof v=="function"&&(v=v(a,h));const m=v==null?void 0:v.includes(s.settings.shortcutsViewMode);return e("li",{children:[e(I,{icon:y}),e("span",{class:"shortcut-text",children:[e(wn,{children:b}),w&&e(U,{children:[" ",e("small",{class:"ib insignificant",children:w})]}),m&&e("span",{class:"tag",children:e(f,{id:"5KJFnN"})})]}),e("span",{class:"shortcut-actions",children:[e("button",{type:"button",class:"plain small",disabled:h===0,onClick:()=>{const S=Array.from(x.shortcuts);if(h>0){const C=x.shortcuts[h-1];S[h-1]=a,S[h]=C,x.shortcuts=S}},children:e(I,{icon:"arrow-up",alt:pe._({id:"QyioBP"})})}),e("button",{type:"button",class:"plain small",disabled:h===o.length-1,onClick:()=>{const S=Array.from(x.shortcuts);if(h<x.shortcuts.length-1){const C=x.shortcuts[h+1];S[h+1]=a,S[h]=C,x.shortcuts=S}},children:e(I,{icon:"arrow-down",alt:pe._({id:"3Ib6FN"})})}),e("button",{type:"button",class:"plain small",onClick:()=>{l({shortcut:a,shortcutIndex:h})},children:e(I,{icon:"pencil",alt:pe._({id:"ePK91l"})})})]})]},p)})}),o.length===1&&s.settings.shortcutsViewMode!=="float-button"&&e("div",{class:"ui-state insignificant",children:[e(I,{icon:"info"})," ",e("small",{children:e(f,{id:"3Xq4Zi"})})]})]}):e("div",{class:"ui-state insignificant",children:[e("p",{children:s.settings.shortcutsViewMode==="multi-column"?pe._({id:"3xIN+E"}):pe._({id:"vLxvHT"})}),e("p",{children:e(f,{id:"Fq4zw3",components:{0:e("br",{}),1:e("a",{href:"#",onClick:a=>{a.preventDefault(),x.shortcuts=[{type:"following"},{type:"notifications"}]}})}})})]}),e("p",{class:"insignificant",children:o.length>=It&&(s.settings.shortcutsViewMode==="multi-column"?pe._({id:"RqXfsz",values:{SHORTCUTS_LIMIT:It}}):pe._({id:"EVRO/o",values:{SHORTCUTS_LIMIT:It}}))}),e("p",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e("button",{type:"button",class:"light",onClick:()=>r(!0),children:e(f,{id:"bgVLbt"})}),e("button",{type:"button",disabled:o.length>=It,onClick:()=>l(!0),children:[e(I,{icon:"plus"})," ",e("span",{children:s.settings.shortcutsViewMode==="multi-column"?pe._({id:"Vh3ADI"}):pe._({id:"9tmn6W"})})]})]})]}),c&&e(qe,{onClick:a=>{a.target===a.currentTarget&&l(!1)},children:e(gl,{shortcut:c.shortcut,shortcutIndex:c.shortcutIndex,onSubmit:({result:a,mode:h})=>{h==="edit"?x.shortcuts[c.shortcutIndex]=a:x.shortcuts.push(a)},onClose:()=>l(!1)})}),u&&e(qe,{onClick:a=>{a.target===a.currentTarget&&r(!1)},children:e(yl,{shortcuts:o,onClose:()=>r(!1)})})]})}const Ji={list:{id:"1qL+L+"},search:{id:"dmTmkQ"},hashtag:{id:"E8laYz"}};function gl({onSubmit:n,disabled:i,shortcut:s,shortcutIndex:o,onClose:c}){var v,m;const{_:l}=re(),u=!!s,[r,d]=M((s==null?void 0:s.type)||null),[a,h]=M("default"),[p,g]=M([]),[y,b]=M([]);Q(()=>{(async()=>{if(r==="list")try{h("loading");const S=await hn();g(S),h("default")}catch{h("error")}})(),(async()=>{if(r==="hashtag")try{const S=await $n();b(S)}catch{}})()},[r]);const w=q();return Q(()=>{if(u&&r&&kn[r]){const S=w.current;kn[r].forEach(({name:C,type:T})=>{const A=S.querySelector(`[name="${C}"]`);A&&s[C]&&(T==="checkbox"?A.checked=s[C]==="on":A.value=s[C])})}},[u,r]),e("div",{id:"shortcut-settings-form",class:"sheet",children:[!!c&&e("button",{type:"button",class:"sheet-close",onClick:c,children:e(I,{icon:"x",alt:pe._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:u?pe._({id:"pe1jog"}):pe._({id:"Lsxpe5"})})}),e("main",{tabindex:"-1",children:e("form",{ref:w,onSubmit:S=>{S.preventDefault();const C=new FormData(S.target),T={};C.forEach((A,k)=>{T[k]=A==null?void 0:A.trim(),k==="instance"&&(T[k]=T[k].replace(/^https?:\/\//,"").replace(/\/+$/,""),T[k]=T[k].replace(/^@?[^@]+@/,""))}),T.type&&(n({result:T,mode:u?"edit":"add"}),S.target.reset(),d(null),c==null||c())},children:[e("p",{children:e("label",{children:[e("span",{children:e(f,{id:"cklVjM"})}),e("select",{required:!0,disabled:i,onChange:S=>{d(S.target.value)},defaultValue:u?s.type:void 0,name:"type",dir:"auto",children:[e("option",{}),fl.map(S=>e("option",{value:S,children:l(Js[S])}))]})]})}),(m=(v=kn[r])==null?void 0:v.map)==null?void 0:m.call(v,({text:S,name:C,type:T,placeholder:A,pattern:k,notRequired:_})=>r==="list"?e("p",{children:e("label",{children:[e("span",{children:e(f,{id:"2BBAbc"})}),e("select",{name:"id",required:!_,disabled:i||a==="loading",defaultValue:u?s.id:void 0,dir:"auto",children:[e("option",{value:""}),p.map(E=>e("option",{value:E.id,children:E.title}))]})]})}):e("p",{children:e("label",{children:[e("span",{children:l(S)})," ",e("input",{type:T,switch:T==="checkbox"||void 0,name:C,placeholder:l(A),required:T==="text"&&!_,disabled:i,list:r==="hashtag"?"followed-hashtags-datalist":null,autocorrect:"off",autocapitalize:"off",spellCheck:!1,pattern:k,dir:"auto"}),r==="hashtag"&&y.length>0&&e("datalist",{id:"followed-hashtags-datalist",children:y.map(E=>e("option",{value:E.name}))})]})})),!!Ji[r]&&e("p",{class:"form-note insignificant",children:[e(I,{icon:"info"}),l(Ji[r])]}),e("footer",{children:[e("button",{type:"submit",class:"block",disabled:i||a==="loading",children:u?pe._({id:"tfDRzk"}):pe._({id:"m16xKo"})}),u&&e("button",{type:"button",class:"light danger",onClick:()=>{x.shortcuts.splice(o,1),c==null||c()},children:e(f,{id:"t/YqKh"})})]})]})})]})}function yl({shortcuts:n,onClose:i}){var g;const{_:s}=re(),{masto:o}=le(),c=Ae(()=>!n||!n.filter(Boolean).length?"":Zi.compressToEncodedURIComponent(JSON.stringify(n.filter(Boolean))),[n]),[l,u]=M(""),[r,d]=M("default"),a=Ae(()=>{if(!l)return d("default"),null;try{const y=JSON.parse(Zi.decompressFromEncodedURIComponent(l));if(!Array.isArray(y))throw new Error("Not an array");return d("default"),y}catch{try{const b=JSON.parse(l);if(!Array.isArray(b))throw new Error("Not an array");return d("default"),b}catch{return d("error"),null}}},[l]),h=x.shortcuts.length>0,p=q();return e("div",{id:"import-export-container",class:"sheet",children:[!!i&&e("button",{type:"button",class:"sheet-close",onClick:i,children:e(I,{icon:"x",alt:pe._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(f,{id:"OOa7/5",components:{0:e("small",{class:"ib insignificant"})}})})}),e("main",{tabindex:"-1",children:[e("section",{children:[e("h3",{children:[e(I,{icon:"arrow-down-circle",size:"l",class:"insignificant"})," ",e("span",{children:e(f,{id:"l3s5ri"})})]}),e("p",{class:"field-button",children:[e("input",{ref:p,type:"text",name:"import",placeholder:pe._({id:"tBmklN"}),class:"block",onInput:y=>{u(y.target.value)},dir:"auto"}),x.settings.shortcutSettingsCloudImportExport&&e("button",{type:"button",class:"plain2 small",disabled:r==="cloud-downloading",onClick:async()=>{d("cloud-downloading");const y=kt();fe(pe._({id:"HLqLGx"}));try{const w=(await o.v1.accounts.relationships.fetch({id:[y]}))[0];if(w){const{note:v=""}=w;if(/<phanpy-shortcuts-settings>(.*)<\/phanpy-shortcuts-settings>/.test(v)){const m=v.match(/<phanpy-shortcuts-settings>(.*)<\/phanpy-shortcuts-settings>/)[1],{v:S,dt:C,data:T}=JSON.parse(m);p.current.value=T,p.current.dispatchEvent(new Event("input"))}}d("default")}catch{d("error"),fe(pe._({id:"gCDfX+"}))}},title:pe._({id:"B6cG3J"}),children:[e(I,{icon:"cloud"}),e(I,{icon:"arrow-down"})]})]}),!!a&&Array.isArray(a)&&e(U,{children:[e("p",{children:[e("b",{children:a.length})," shortcut",a.length>1?"s":""," ",e("small",{class:"insignificant",children:["(",l.length," characters)"]})]}),e("ol",{class:"import-settings-list",children:a.map(y=>{var b,w;return e("li",{children:[e("span",{style:{opacity:n.some(v=>Object.keys(v).every(m=>v[m]===y[m]))?1:0},children:"*"}),e("span",{children:[s(Js[y.type]),y.type==="list"&&" ⚠️"," ",(w=(b=kn[y.type])==null?void 0:b.map)==null?void 0:w.call(b,({text:v,name:m,type:S})=>y[m]?e(U,{children:[e("span",{class:"tag collapsed insignificant",children:[v,":"," ",S==="checkbox"?y[m]==="on"?"✅":"❌":y[m]]})," "]}):null)]})]})})}),e("p",{children:[e("small",{children:e(f,{id:"o6sElH"})}),e("br",{}),e("small",{children:["⚠️"," ",e(f,{id:"N4z4P/"})]})]})]}),r==="error"&&e("p",{class:"error",children:e("small",{children:["⚠️ ",e(f,{id:"ZhsPEb"})]})}),e("p",{children:[h&&e(U,{children:[e(pt,{confirmLabel:pe._({id:"6MzUUU"}),menuFooter:e("div",{class:"footer",children:e(f,{id:"nl8sCE"})}),onClick:()=>{const y=a.filter(v=>!x.shortcuts.some(m=>Object.keys(m).every(S=>m[S]===v[S])));if(!y.length){fe(pe._({id:"o6L30P"}));return}let b=[...x.shortcuts,...y];const w=b.length>It;w&&(b=b.slice(0,It)),x.shortcuts=b,fe(w?pe._({id:"SBmqmC",values:{SHORTCUTS_LIMIT:It}}):pe._({id:"QO9uTx"})),i==null||i()},children:e("button",{type:"button",class:"plain2",disabled:!a,children:e(f,{id:"c89gCv"})})})," "]}),e(pt,{confirmLabel:h?pe._({id:"6ZjzWP"}):pe._({id:"DWumLi"}),menuItemClassName:h?"danger":void 0,onClick:()=>{x.shortcuts=a,fe(pe._({id:"QO9uTx"})),i==null||i()},children:e("button",{type:"button",class:"plain2",disabled:!a,children:h?pe._({id:"uIp8WL"}):pe._({id:"Sjnlwj"})})})]})]}),e("section",{children:[e("h3",{children:[e(I,{icon:"arrow-up-circle",size:"l",class:"insignificant"})," ",e("span",{children:e(f,{id:"GS+Mus"})})]}),e("p",{children:e("input",{style:{width:"100%"},type:"text",value:c,readOnly:!0,onClick:y=>{if(y.target.value){y.target.select();try{navigator.clipboard.writeText(y.target.value),fe(pe._({id:"cWtH+v"}))}catch{fe(pe._({id:"yUWyHa"}))}}},dir:"auto"})}),e("p",{children:[e("button",{type:"button",class:"plain2",disabled:!c,onClick:()=>{try{navigator.clipboard.writeText(c),fe(pe._({id:"+Kq2vY"}))}catch{fe(pe._({id:"tFvxZF"}))}},children:[e(I,{icon:"clipboard"})," ",e("span",{children:e(f,{id:"he3ygx"})})]})," ",(navigator==null?void 0:navigator.share)&&((g=navigator==null?void 0:navigator.canShare)==null?void 0:g.call(navigator,{text:c}))&&e("button",{type:"button",class:"plain2",disabled:!c,onClick:()=>{try{navigator.share({text:c})}catch{alert(pe._({id:"TtG3Uh"}))}},children:[e(I,{icon:"share"})," ",e("span",{children:e(f,{id:"Z8lGw6"})})]})," ",x.settings.shortcutSettingsCloudImportExport&&e("button",{type:"button",class:"plain2",disabled:r==="cloud-uploading",onClick:async()=>{d("cloud-uploading");const y=kt();try{const w=(await o.v1.accounts.relationships.fetch({id:[y]}))[0];if(w){const{note:v=""}=w;let m="";const S=JSON.stringify({v:"1",dt:Date.now(),data:c});/<phanpy-shortcuts-settings>(.*)<\/phanpy-shortcuts-settings>/.test(v)?m=v.replace(/<phanpy-shortcuts-settings>(.*)<\/phanpy-shortcuts-settings>/,`<phanpy-shortcuts-settings>${S}</phanpy-shortcuts-settings>`):m=`${v}


<phanpy-shortcuts-settings>${S}</phanpy-shortcuts-settings>`,fe(pe._({id:"9ZYiLz"})),await o.v1.accounts.$select(y).note.create({comment:m}),d("default"),fe(pe._({id:"5w02SH"}))}}catch{d("error"),fe(pe._({id:"aVsTYo"}))}},title:pe._({id:"gWd6Cu"}),children:[e(I,{icon:"cloud"}),e(I,{icon:"arrow-up"})]})," ",c.length>0&&e("small",{class:"insignificant ib",children:e(f,{id:"IPXOXm",values:{0:c.length}})})]}),!!c&&e("details",{children:[e("summary",{class:"insignificant",children:e("small",{children:e(f,{id:"e5E+WH"})})}),e("textarea",{style:{width:"100%"},rows:10,readOnly:!0,children:JSON.stringify(n.filter(Boolean),null,2)})]})]}),x.settings.shortcutSettingsCloudImportExport&&e("footer",{children:e("p",{children:[e(I,{icon:"cloud"})," ",e(f,{id:"C4T6O/"})]})})]})]})}ws(x,n=>{for(const[i,s,o,c]of n)/^show/i.test(s)&&!o&&ii()});function bl(){var c,l,u,r,d,a,h,p;const{_:n}=re(),i=We(x),s=ks(),o=Jt();return Q(()=>{setTimeout(xo,1e3)},[]),e(U,{children:[!!i.showCompose&&e(qe,{class:`solid ${i.composerState.minimized?"min":""}`,minimized:!!i.composerState.minimized,children:e(Eo,{replyToStatus:typeof i.showCompose!="boolean"?i.showCompose.replyToStatus:((c=window.__COMPOSE__)==null?void 0:c.replyToStatus)||null,editStatus:((l=x.showCompose)==null?void 0:l.editStatus)||((u=window.__COMPOSE__)==null?void 0:u.editStatus)||null,draftStatus:((r=x.showCompose)==null?void 0:r.draftStatus)||((d=window.__COMPOSE__)==null?void 0:d.draftStatus)||null,onClose:g=>{const{newStatus:y,instance:b,type:w,scheduledAt:v}=g||{};x.showCompose=!1,window.__COMPOSE__=null,y&&(x.reloadStatusPage++,v&&x.reloadScheduledPosts++,fe({text:{post:n(v?{id:"IrX0sj"}:{id:"aTyHBW"}),reply:n(v?{id:"+38pse"}:{id:"lZdBKl"}),edit:n({id:"a5BN7l"})}[w||"post"],delay:1e3,duration:1e4,onClick:m=>{m.hideToast(),x.prevLocation=o,s(v?"/sp":b?`/${b}/s/${y.id}`:`/s/${y.id}`)}}))}})}),!!i.showSettings&&e(qe,{onClose:()=>{x.showSettings=!1},children:e(oa,{onClose:()=>{x.showSettings=!1}})}),!!i.showAccounts&&e(qe,{onClose:()=>{x.showAccounts=!1},children:e(jc,{onClose:()=>{x.showAccounts=!1}})}),!!i.showAccount&&e(qe,{onClose:()=>{x.showAccount=!1},children:e(La,{account:((a=i.showAccount)==null?void 0:a.account)||i.showAccount,instance:(h=i.showAccount)==null?void 0:h.instance,onClose:({destination:g}={})=>{x.showAccount=!1}})}),!!i.showDrafts&&e(qe,{onClose:()=>{x.showDrafts=!1},children:e(Ma,{onClose:()=>x.showDrafts=!1})}),!!i.showMediaModal&&e(qe,{onClick:g=>{(g.target===g.currentTarget||g.target.classList.contains("media"))&&(x.showMediaModal=!1)},children:e(Xs,{mediaAttachments:i.showMediaModal.mediaAttachments,instance:i.showMediaModal.instance,index:i.showMediaModal.mediaIndex,statusID:i.showMediaModal.statusID,onClose:()=>{x.showMediaModal=!1}})}),!!i.showShortcutsSettings&&e(qe,{onClose:()=>{x.showShortcutsSettings=!1},children:e(ml,{onClose:()=>x.showShortcutsSettings=!1})}),!!i.showGenericAccounts&&e(qe,{onClose:()=>{x.showGenericAccounts=!1},children:e(Pa,{instance:i.showGenericAccounts.instance,excludeRelationshipAttrs:i.showGenericAccounts.excludeRelationshipAttrs,postID:i.showGenericAccounts.postID,onClose:()=>x.showGenericAccounts=!1,blankCopy:i.showGenericAccounts.blankCopy})}),!!i.showMediaAlt&&e(qe,{onClose:g=>{x.showMediaAlt=!1},children:e(Oa,{alt:i.showMediaAlt.alt||i.showMediaAlt,lang:(p=i.showMediaAlt)==null?void 0:p.lang,onClose:()=>{x.showMediaAlt=!1}})}),!!i.showEmbedModal&&e(qe,{class:"solid",onClose:()=>{x.showEmbedModal=!1},children:e(Na,{html:i.showEmbedModal.html,url:i.showEmbedModal.url,width:i.showEmbedModal.width,height:i.showEmbedModal.height,onClose:()=>{x.showEmbedModal=!1}})}),!!i.showReportModal&&e(qe,{onClose:()=>{x.showReportModal=!1},children:e(il,{account:i.showReportModal.account,post:i.showReportModal.post,onClose:()=>{x.showReportModal=!1}})})]})}function oi({accountID:n,onChange:i}){const{_:s}=re(),{masto:o}=le(),[c,l]=M("default"),[u,r]=M(null),[d,a]=M(null),h=d!==null;return e("p",{class:"follow-request-buttons",children:[e("button",{type:"button",disabled:c==="loading"||h,onClick:()=>{l("loading"),r("accept"),(async()=>{try{const p=await o.v1.followRequests.$select(n).authorize();if(!(p!=null&&p.followedBy))throw new Error("Follow request not accepted");a(p),i()}catch{}l("default")})()},children:e(f,{id:"g3UF2V"})})," ",e("button",{type:"button",disabled:c==="loading"||h,class:"light danger",onClick:()=>{l("loading"),r("reject"),(async()=>{try{const p=await o.v1.followRequests.$select(n).reject();if(p!=null&&p.followedBy)throw new Error("Follow request not rejected");a(p),i()}catch{l("default")}})()},children:e(f,{id:"1t/NnN"})}),e("span",{class:"follow-request-states",children:h&&u?u==="accept"?e(I,{icon:"check-circle",alt:s({id:"bzMKg7"}),class:"follow-accepted"}):e(I,{icon:"x-circle",alt:s({id:"ekCRTP"}),class:"follow-rejected"}):e(Be,{hidden:c!=="loading"})})]})}const Qi={mention:"comment",status:"notification",reblog:"rocket",follow:"follow",follow_request:"follow-add",favourite:"heart",poll:"poll",update:"pencil","admin.signup":"account-edit","admin.report":"account-warning",severed_relationships:"heart-break",moderation_warning:"alert",emoji_reaction:"emoji2","pleroma:emoji_reaction":"emoji2",annual_report:"celebrate"};function es({account:n,emoji:i,emoji_url:s}){let o,c;typeof s=="string"?o=s:(o=s==null?void 0:s.url,c=s==null?void 0:s.staticUrl);const l=o?e(Xo,{url:o,staticUrl:c,alt:i}):i;return e(f,{id:"i5uN6K",values:{account:n,emojiObject:l}})}const Zn={status:({account:n})=>e(f,{id:"idiIxW",values:{account:n}}),reblog:({count:n,account:i,postsCount:s,postType:o,components:{Subject:c}})=>e(f,{id:"jkt9P5",values:{0:Qe(n),1:Qe(n),count:n,postsCount:s,postType:o,account:i},components:{0:e(c,{clickable:n>1}),1:e("span",{title:n}),2:e(c,{clickable:n>1}),3:e("span",{title:n})}}),follow:({account:n,count:i,components:{Subject:s}})=>e(f,{id:"+71G9C",values:{0:Qe(i),count:i,account:n},components:{0:e(s,{clickable:i>1}),1:e("span",{title:i})}}),follow_request:({account:n})=>e(f,{id:"eh6NHW",values:{account:n}}),favourite:({account:n,count:i,postsCount:s,postType:o,components:{Subject:c}})=>e(f,{id:"RqX1mR",values:{0:Qe(i),1:Qe(i),count:i,postsCount:s,postType:o,account:n},components:{0:e(c,{clickable:i>1}),1:e("span",{title:i}),2:e(c,{clickable:i>1}),3:e("span",{title:i})}}),poll:()=>pe._({id:"kIlJaS"}),"poll-self":()=>pe._({id:"kpjzdN"}),"poll-voted":()=>pe._({id:"moT7M8"}),update:()=>pe._({id:"uzt17m"}),"favourite+reblog":({count:n,account:i,postsCount:s,postType:o,components:{Subject:c}})=>e(f,{id:"NunZZQ",values:{0:Qe(n),1:Qe(n),count:n,postsCount:s,postType:o,account:i},components:{0:e(c,{clickable:n>1}),1:e("span",{title:n}),2:e(c,{clickable:n>1}),3:e("span",{title:n})}}),"admin.sign_up":({account:n})=>e(f,{id:"fJCCpx",values:{account:n}}),"admin.report":({account:n,targetAccount:i})=>e(f,{id:"eNfCmq",values:{account:n,targetAccount:i}}),severed_relationships:({name:n})=>e(f,{id:"Xl9v6+",values:{name:n},components:{0:e("i",{})}}),moderation_warning:()=>e("b",{children:e(f,{id:"YqffEv"})}),emoji_reaction:es,"pleroma:emoji_reaction":es,annual_report:({year:n})=>e(f,{id:"INLTzH",values:{year:n}})},vl={account_suspension:({from:n,targetName:i})=>e(f,{id:"uRkcgw",values:{from:n,targetName:i},components:{0:e("i",{}),1:e("i",{})}}),domain_block:({from:n,targetName:i,followersCount:s,followingCount:o})=>e(f,{id:"Q3yArs",values:{from:n,targetName:i,followersCount:s,followingCount:o},components:{0:e("i",{}),1:e("i",{})}}),user_domain_block:({targetName:n,followersCount:i,followingCount:s})=>e(f,{id:"RQKWUa",values:{targetName:n,followersCount:i,followingCount:s},components:{0:e("i",{})}})},wl={none:{id:"ipnHrn"},disable:{id:"jw0eSZ"},mark_statuses_as_sensitive:{id:"v9jO+F"},delete_statuses:{id:"raUMBQ"},sensitive:{id:"w2OpMr"},silence:{id:"mlycBx"},suspend:{id:"Fz4lZ1"}},Xn=30;function kl({notification:n,instance:i,isStatic:s,disableContextMenu:o}){var te,J,ue,he,ne,we,Ce;const{_:c}=re(),{masto:l}=le(),{id:u,status:r,account:d,report:a,event:h,moderation_warning:p,annualReport:g,_ids:y,_accounts:b,_statuses:w,_groupKeys:v,sampleAccounts:m,notificationsCount:S,groupKey:C,_notificationsCount:T,_sampleAccountsCount:A}=n;let{type:k}=n;if(k==="mention"&&!r)return null;const _=(r==null?void 0:r.reblog)||r,E=_==null?void 0:_.id,R=kt(),F=R===(d==null?void 0:d.id),O=(te=r==null?void 0:r.poll)==null?void 0:te.voted,W=!!(r!=null&&r.inReplyToAccountId)&&(r==null?void 0:r.inReplyToAccountId)!==R&&((J=r==null?void 0:r.account)==null?void 0:J.id)===R;let V=0,X=0;if(k==="favourite+reblog"){if(b)for(const se of b)(ue=se._types)!=null&&ue.includes("favourite")&&V++,(he=se._types)!=null&&he.includes("reblog")&&X++;!X&&V&&(k="favourite"),!V&&X&&(k="reblog")}let Y;k==="poll"?Y=Zn[F?"poll-self":O?"poll-voted":"poll"]:Zn[k]?Y=Zn[k]:Y=pe._({id:"ODqZt1",values:{type:k}});const Z=({clickable:se,...Te})=>se?e("b",{tabIndex:"0",onClick:j,...Te}):e("b",{...Te}),B=S>0&&S>(m==null?void 0:m.length),ee=B?"remote":"local";if(typeof Y=="function"){const se=(k==="favourite"||k==="reblog")&&S?B?S:m==null?void 0:m.length:(b==null?void 0:b.length)||(m==null?void 0:m.length)||(d?1:0),Te=(w==null?void 0:w.length)||(r?1:0);if(k==="admin.report"){const Ie=a==null?void 0:a.targetAccount;Ie&&(Y=Y({account:e(yt,{account:d,showAvatar:!0}),targetAccount:e(yt,{account:Ie,showAvatar:!0})}))}else if(k==="severed_relationships"){const Ie=h==null?void 0:h.targetName;Ie&&(Y=Y({name:Ie}))}else if((k==="emoji_reaction"||k==="pleroma:emoji_reaction")&&n.emoji){const Ie=n.emoji_url||((we=(ne=r==null?void 0:r.emojis)==null?void 0:ne.find)==null?void 0:we.call(ne,Pe=>(Pe==null?void 0:Pe.shortcode)===n.emoji.replace(/^:/,"").replace(/:$/,"")));Y=Y({account:e(yt,{account:d,showAvatar:!0}),emoji:n.emoji,emojiURL:Ie})}else k==="annual_report"?Y=Y({...n.annualReport}):Y=Y({account:d?e(yt,{account:d,showAvatar:!0}):(m==null?void 0:m[0])&&e(yt,{account:m[0],showAvatar:!0}),count:se,postsCount:Te,postType:W?"reply":"post",components:{Subject:Z}})}const $=n.createdAt&&new Date(n.createdAt).toLocaleString(),K={"favourite+reblog":pe._({id:"+XOeb+"}),favourite:pe._({id:"LQFF6J"}),reblog:pe._({id:"phQpSa"}),follow:pe._({id:"Ih01jh"})}[k]||pe._({id:"bPwFdf"}),j=()=>{x.showGenericAccounts={heading:K,accounts:b,showReactions:k==="favourite+reblog",excludeRelationshipAttrs:k==="follow"?["followedBy"]:[],postID:rt(E,i)}};if(r!=null&&r.filtered){const se=((Ce=r==null?void 0:r.account)==null?void 0:Ce.id)===R,Te=Vt(r.filtered,"notifications");if(!F&&!se&&(Te==null?void 0:Te.action)==="hide")return null}return e("div",{class:`notification notification-${k}`,"data-notification-id":y||u,"data-group-key":(v==null?void 0:v.join(" "))||C,tabIndex:"0",children:[e("div",{class:`notification-type notification-${k}`,title:$,children:k==="favourite+reblog"?e(U,{children:[e(I,{icon:"rocket",size:"xl",alt:k,class:"reblog-icon"}),e(I,{icon:"heart",size:"xl",alt:k,class:"favourite-icon"})]}):e(I,{icon:Qi[k]||"notification",size:"xl",alt:k})}),e("div",{class:"notification-content",children:[k!=="mention"&&e(U,{children:[e("p",{children:Y}),k==="follow_request"&&e(oi,{accountID:d.id}),k==="severed_relationships"&&e("div",{children:[vl[h.type]({from:i,...h}),e("br",{}),e("a",{href:`https://${i}/severed_relationships`,target:"_blank",rel:"noopener",children:e(f,{id:"YL6Y8P",components:{0:e(I,{icon:"external",size:"s"})}})}),"."]}),k==="moderation_warning"&&!!p&&e("div",{children:[c(wl[p.action]()),e("br",{}),e("a",{href:`/disputes/strikes/${p.id}`,target:"_blank",rel:"noopener",children:e(f,{id:"YL6Y8P",components:{0:e(I,{icon:"external",size:"s"})}})})]}),k==="annual_report"&&e("div",{children:e(ge,{to:`/annual_report/${g==null?void 0:g.year}`,children:e(f,{id:"5PGPvG"})})})]}),(b==null?void 0:b.length)>1&&e("p",{class:"avatars-stack",children:[b.slice(0,Xn).map(se=>e(U,{children:[e("a",{href:se.url,rel:"noopener",class:"account-avatar-stack",onClick:Te=>{Te.preventDefault(),x.showAccount=se},children:[e(mt,{url:se.avatarStatic,size:b.length<=10?"xxl":b.length<20?"xl":"l",alt:`${se.displayName} @${se.acct}`,squircle:se==null?void 0:se.bot},se.id),k==="favourite+reblog"&&e("div",{class:"account-sub-icons",children:se._types.map(Te=>e(I,{icon:Qi[Te],size:"s",class:`${Te}-icon`}))})]},se.id)," "]},se.id)),(k==="favourite+reblog"||k==="favourite"||k==="reblog")&&ee==="remote"?e("button",{type:"button",class:"small plain","data-group-keys":v==null?void 0:v.join(" "),onClick:()=>{x.showGenericAccounts={heading:K,accounts:b,fetchAccounts:async()=>{const se=await Promise.allSettled(v.map(async Ie=>{const Pe=l.v2.notifications.$select(Ie).accounts.list().values();return[Ie,(await Pe.next()).value]})),Te=[];for(const Ie of se){const[Pe,$e]=Ie.value,Ee=/^favourite/.test(Pe)?"favourite":/^reblog/.test(Pe)?"reblog":null;if(Ee)for(const H of $e){const ke=Te.find(De=>De.id===H.id);ke?ke._types.push(Ee):(H._types=[Ee],Te.push(H))}}return{done:!0,value:Te}},showReactions:k==="favourite+reblog",postID:rt(E,i)}},children:["+",(k==="favourite"||k==="reblog")&&S-b.length,e(I,{icon:"chevron-down"})]}):e("button",{type:"button",class:"small plain",onClick:j,children:[b.length>Xn&&`+${b.length-Xn}`,e(I,{icon:"chevron-down"})]})]}),!(b!=null&&b.length)&&(m==null?void 0:m.length)>1&&e("p",{class:"avatars-stack",children:[m.map(se=>e(U,{children:[e("a",{href:se.url,rel:"noopener",class:"account-avatar-stack",onClick:Te=>{Te.preventDefault(),x.showAccount=se},children:e(mt,{url:se.avatarStatic,size:"xxl",alt:`${se.displayName} @${se.acct}`,squircle:se==null?void 0:se.bot},se.id)},se.id)," "]},se.id)),S>m.length&&e(ge,{to:i?`/${i}/s/${r.id}`:`/s/${r.id}`,class:"button small plain centered",children:["+",S-m.length,e(I,{icon:"chevron-right"})]})]}),(w==null?void 0:w.length)>1&&e("ul",{class:"notification-group-statuses",children:w.map(se=>e("li",{children:e(ts,{class:`status-link status-type-${k}`,to:i?`/${i}/s/${se.id}`:`/s/${se.id}`,children:e(Ge,{status:se,size:"s",previewMode:!0,allowContextMenu:!0,allowFilters:!0})})},se.id))}),r&&(!(w!=null&&w.length)||(w==null?void 0:w.length)<=1)&&e(ts,{class:`status-link status-type-${k}`,to:i?`/${i}/s/${E}`:`/s/${E}`,onContextMenu:o?void 0:se=>{const Te=se.target.querySelector(".status");if(Te){if(se.metaKey)return;se.preventDefault(),Te.dispatchEvent(new MouseEvent("contextmenu",{clientX:se.clientX,clientY:se.clientY}))}},children:s?e(Ge,{status:_,size:"s",readOnly:!0,allowContextMenu:!0,allowFilters:!0}):e(Ge,{statusID:E,size:"s",readOnly:!0,allowContextMenu:!0,allowFilters:!0})})]})]})}function ts(n){const i=Jo();return e(ge,{...n,"data-read-more":pe._({id:"8fZueG"}),ref:i})}const rn=ut(kl,(n,i)=>{var s,o;return((s=n.notification)==null?void 0:s.id)===((o=i.notification)==null?void 0:o.id)});"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",n=>{const{type:i,id:s,accessToken:o}=(n==null?void 0:n.data)||{};i==="notification"&&(x.routeNotification={id:s,accessToken:o})});const Sl=ut(function(){const{_:i}=re();if(!("serviceWorker"in navigator))return null;const s=We(x),{routeNotification:o}=s,{id:c,accessToken:l}=o||{},[u,r]=M(!1);St(()=>{if(!c||!l)return;const{instance:a}=le(),{masto:h,instance:p}=le({accessToken:l}),g=a===p,y=l?Ro(l):hi();(async()=>{const b=await h.v1.notifications.$select(c).fetch();if(b&&y){const w=y.instanceURL,{type:v,status:m,account:S}=b,C=!!document.querySelector("#modal-container > *"),T=v==="follow"&&!!(S!=null&&S.id),A=!!(S!=null&&S.id),k=!!(m!=null&&m.id);T&&g?x.showAccount={account:S,instance:w}:C||!g||A&&k?r({id:c,account:y,notification:b,sameInstance:g}):k?location.hash=`/${a}/s/${m.id}`:T?location.hash=`/${a}/a/${S.id}`:location.hash="/notifications"}})()},[c,l]),St(()=>{navigator!=null&&navigator.clearAppBadge&&navigator.clearAppBadge()},[]),Gt(a=>{a&&(navigator!=null&&navigator.clearAppBadge)&&navigator.clearAppBadge()});const d=()=>{r(!1),x.routeNotification=null,/\/notifications\?id=/i.test(location.hash)&&(location.hash="/notifications")};if(u){const{id:a,account:h,notification:p,sameInstance:g}=u;return e(qe,{onClick:y=>{y.target===y.currentTarget&&d()},children:e("div",{class:"sheet",tabIndex:"-1",children:[e("button",{type:"button",class:"sheet-close",onClick:d,children:e(I,{icon:"x",alt:i({id:"yz7wBu"})})}),e("header",{children:e("b",{children:e(f,{id:"5+87Pq"})})}),e("main",{children:[!g&&e("p",{children:e(f,{id:"k9N0Xk"})}),e("div",{class:"notification-peek",onClick:y=>{const{target:b}=y;(y.target.tagName==="BUTTON"||y.target.tagName==="A")&&d()},children:e(rn,{instance:h.instanceURL,notification:p,isStatic:!0})}),e("div",{style:{textAlign:"end"},children:e(ge,{to:"/notifications",class:"button light",onClick:d,children:[e("span",{children:e(f,{id:"/WA/tl"})})," ",e(I,{icon:"arrow-right"})]})})]})]})})}return null}),Qs=Lo((n,i)=>{const{_:s}=re(),{instance:o}=le(),[c,l]=vt(),[u,r]=M(!1),[d,a]=M(c.get("q")||""),h=c.get("type"),p=q(null),g=q(null);return Mo(i,()=>({setValue:y=>{a(y)},focus:()=>{g.current.focus()},select:()=>{g.current.select()},blur:()=>{g.current.blur()}})),e("form",{ref:p,class:"search-popover-container",onSubmit:y=>{var w;if(y.preventDefault(),/\/search/.test(location.hash))if(d){const v={q:d};h&&(v.type=h),l(v)}else l({});else d?location.hash=`/search?q=${encodeURIComponent(d)}${h?`&type=${h}`:""}`:location.hash="/search";(w=n==null?void 0:n.onSubmit)==null||w.call(n,y)},children:[e("input",{ref:g,value:d,name:"q",type:"search",placeholder:s({id:"A1taO8"}),dir:"auto",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellCheck:"false",onSearch:y=>{y.target.value||l({})},onInput:y=>{a(y.target.value),r(!0)},onFocus:()=>{var y,b;r(!0),(b=(y=p.current)==null?void 0:y.querySelector(".search-popover-item"))==null||b.classList.add("focus")},onBlur:()=>{var y,b;setTimeout(()=>{r(!1)},100),(b=(y=p.current)==null?void 0:y.querySelector(".search-popover-item.focus"))==null||b.classList.remove("focus")},onKeyDown:y=>{var w;const{key:b}=y;switch(b){case"Escape":r(!1);break;case"Down":case"ArrowDown":if(y.preventDefault(),u){const v=p.current.querySelector(".search-popover-item.focus");if(v){let m=v.nextElementSibling;for(;m&&m.hidden;)m=m.nextElementSibling;m&&(m.classList.add("focus"),Array.from(m.parentElement.children).filter(C=>C!==m).forEach(C=>{C.classList.remove("focus")}))}else{const m=p.current.querySelector(".search-popover-item");m&&m.classList.add("focus")}}break;case"Up":case"ArrowUp":if(y.preventDefault(),u){const v=document.querySelector(".search-popover-item.focus");if(v){let m=v.previousElementSibling;for(;m&&m.hidden;)m=m.previousElementSibling;m&&(m.classList.add("focus"),Array.from(m.parentElement.children).filter(C=>C!==m).forEach(C=>{C.classList.remove("focus")}))}else{const m=document.querySelector(".search-popover-item:last-child");m&&m.classList.add("focus")}}break;case"Enter":if(u){const v=document.querySelector(".search-popover-item.focus");v&&(y.preventDefault(),v.click()),r(!1),(w=n==null?void 0:n.onSubmit)==null||w.call(n,y)}break}}}),e("div",{class:"search-popover",hidden:!u||!d,children:!!d&&[{label:e(f,{id:"48oDit",values:{query:d},components:{0:e("small",{class:"insignificant"})}}),to:`/search?q=${encodeURIComponent(d)}`,top:!h&&!/\s/.test(d),hidden:!!h},{label:e(f,{id:"o1mMWT",values:{query:d},components:{0:e("q",{})}}),to:`/search?q=${encodeURIComponent(d)}&type=statuses`,hidden:/^https?:/.test(d),top:/\s/.test(d),icon:"document",queryType:"statuses"},{label:e(f,{id:"YAZw8D",values:{0:d.replace(/^#/,"")},components:{0:e("mark",{})}}),to:`/${o}/t/${d.replace(/^#/,"")}`,hidden:/^@/.test(d)||/^https?:/.test(d)||/\s/.test(d),top:/^#/.test(d),type:"link",icon:"hashtag",queryType:"hashtags"},{label:e(f,{id:"gEoOUj",values:{query:d},components:{0:e("mark",{})}}),to:`/${d}`,hidden:!/^https?:/.test(d),top:/^https?:/.test(d),type:"link"},{label:e(f,{id:"cDoNQr",values:{query:d},components:{0:e("q",{})}}),to:`/search?q=${encodeURIComponent(d)}&type=accounts`,icon:"group",queryType:"accounts"}].sort((y,b)=>{if(h){if(y.queryType===h)return-1;if(b.queryType===h)return 1}return y.top&&!b.top?-1:!y.top&&b.top?1:0}).filter(({hidden:y})=>!y).map(({label:y,to:b,icon:w,type:v},m)=>e(ge,{to:b,class:`search-popover-item ${m===0?"focus":""}`,onClick:S=>{var C;(C=n==null?void 0:n.onSubmit)==null||C.call(n,S)},children:[e(I,{icon:w||(v==="link"?"arrow-right":"search"),class:"more-insignificant"}),e("span",{children:y})," "]}))})]})}),_l=ut(function({onClose:i=()=>{}}){const[s,o]=M(!1),c=q(null);Ye(["Slash","/"],u=>{o(!0),setTimeout(()=>{var r,d,a,h;(d=(r=c.current)==null?void 0:r.focus)==null||d.call(r),(h=(a=c.current)==null?void 0:a.select)==null||h.call(a)},0)},{useKey:!0,preventDefault:!0,ignoreEventWhen:u=>{const r=/\/search/.test(location.hash),d=!!document.querySelector("#modal-container > *");return r||d||u.metaKey||u.ctrlKey||u.altKey||u.shiftKey}});const l=()=>{o(!1),i()};return Ye("esc",u=>{var r,d;(d=(r=c.current)==null?void 0:r.blur)==null||d.call(r),l()},{enabled:s,enableOnFormTags:!0,preventDefault:!0,useKey:!0,ignoreEventWhen:u=>u.metaKey||u.ctrlKey||u.altKey||u.shiftKey}),e("div",{id:"search-command-container",hidden:!s,onClick:u=>{u.target===u.currentTarget&&l()},children:e(Qs,{ref:c,onSubmit:()=>{l()}})})});function Cl(){const{_:n,_:i}=re(),{instance:s}=le(),o=We(x),{shortcuts:c,settings:l}=o;if(!c.length)return null;const u=l.shortcutsViewMode==="multi-column"||!l.shortcutsViewMode&&l.shortcutsColumnsMode,r=q(),d=q(),a=q(!1),h=c.map((b,w)=>{const{type:v,...m}=b;if(!Nn[v])return null;let{id:S,path:C,title:T,subtitle:A,icon:k}=Nn[v];return typeof S=="function"&&(S=S(m,w)),typeof C=="function"&&(C=C({...m,instance:m.instance||s},w)),typeof T=="function"?T=T(m,w):T=i(T),typeof A=="function"?A=A(m,w):A=i(A),typeof k=="function"&&(k=k(m,w)),S==="lists"&&(a.current=!0),{id:S,path:C,title:T,subtitle:A,icon:k}}).filter(Boolean);Q(()=>{if(o.settings.shortcutsViewMode==="tab-menu-bar"&&d.current){const b=setTimeout(()=>{var v;const w=(v=d.current)==null?void 0:v.querySelector(".is-active");w&&w.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})},100);return()=>clearTimeout(b)}},[]);const p=ks();Ye(["1","2","3","4","5","6","7","8","9"],b=>{var v,m;const w=parseInt(b.key,10)-1;if(w<h.length){const{path:S}=h[w];S&&(p(S),(m=(v=r.current)==null?void 0:v.closeMenu)==null||m.call(v))}},{enabled:!u,useKey:!0,ignoreEventWhen:b=>b.metaKey||b.ctrlKey||b.altKey||b.shiftKey});const[g,y]=M([]);return u?null:e("div",{id:"shortcuts",children:o.settings.shortcutsViewMode==="tab-menu-bar"?e("nav",{ref:d,class:"tab-bar",onContextMenu:b=>{b.preventDefault(),x.showShortcutsSettings=!0},children:e("ul",{children:h.map(({id:b,path:w,title:v,subtitle:m,icon:S},C)=>e("li",{children:e(ge,{class:m?"has-subtitle":"",to:w,onClick:T=>{if(T.target.classList.contains("is-active")){T.preventDefault();const A=document.getElementById(`${b}-page`);if(A){A.scrollTop=0;const k=A.querySelector(".updates-button");k&&k.click()}}},children:[e(I,{icon:S,size:"xl",alt:v}),e("span",{children:[e(wn,{children:v}),m&&e(U,{children:[e("br",{}),e("small",{children:m})]})]})]})},`${C}-${b}-${v}-${m}-${w}`))})}):e(dt,{instanceRef:r,overflow:"auto",viewScroll:"close",menuClassName:"glass-menu shortcuts-menu",gap:8,position:"anchor",onMenuChange:b=>{b.open&&a.current&&hn().then(y)},menuButton:e("button",{type:"button",id:"shortcuts-button",class:"plain",onContextMenu:b=>{b.preventDefault(),x.showShortcutsSettings=!0},onTransitionStart:b=>{var w,v;try{const{target:m}=b;getComputedStyle(m).pointerEvents==="none"&&((v=(w=r.current)==null?void 0:w.closeMenu)==null||v.call(w))}catch{}},children:e(I,{icon:"shortcut",size:"xl",alt:n({id:"CTqTgr"})})}),children:h.map(({id:b,path:w,title:v,subtitle:m,icon:S},C)=>b==="lists"?e(dn,{menuClassName:"glass-menu",overflow:"auto",gap:-8,label:e(U,{children:[e(I,{icon:S,size:"l"}),e("span",{class:"menu-grow",children:e(wn,{children:v})}),e(I,{icon:"chevron-right"})]}),children:[e(je,{to:"/l",children:e("span",{children:e(f,{id:"BHWx+g"})})}),e(Ve,{}),g==null?void 0:g.map(T=>e(je,{to:`/l/${T.id}`,children:e("span",{children:[T.title,T.exclusive&&e(U,{children:[" ",e(Bt,{})]})]})},T.id))]}):e(je,{to:w,class:"glass-menu-item",children:[e(I,{icon:S,size:"l"})," ",e("span",{class:"menu-grow",children:[e("span",{children:e(wn,{children:v})}),m&&e(U,{children:[" ",e("small",{class:"more-insignificant",children:m})]})]}),e("span",{class:"menu-shortcut hide-until-focus-visible",children:C+1})]},`${C}-${b}-${v}-${m}-${w}`))})})}const Il=ut(Cl);function Tl(n){var c;let i=[],s=[],o=0;for(let l=0;l<n.length;l++){const u=n[l];u.reblog&&!((c=u.account)!=null&&c.group)?(s.push(u),o++):(i.push(u),o<3&&(o=0))}if(n.length>10&&(s.length>n.length/4||o>=3)){const l=s.map(u=>u.id);if(s.length>n.length*3/4)i=[...i,{id:l,items:s,type:"boosts"}];else{const u=Math.floor(i.length/2);i=[...i.slice(0,u),{id:l,items:s,type:"boosts"},...i.slice(u)]}return i}else return n}function ns(n,i){const s=ze.account.get("boostedStatusIDs")||{},o=n.filter(l=>{if(!l.reblog)return!0;const u=`${i}-${l.reblog.id}`,r=s[u];return r&&r!==l.id?!1:(s[u]=l.id,!0)}),c=Object.keys(s);return c.length>50&&c.slice(0,c.length-50).forEach(l=>{delete s[l]}),ze.account.set("boostedStatusIDs",s),o}function Al(n,i){const s=[];let o=0;n.forEach(r=>{for(let a=0;a<s.length;a++){if(s[a].find(h=>h.id===r.id))return;if(s[a].find(h=>h.id===r.inReplyToId)||s[a].find(h=>h.inReplyToId===r.id)){s[a].push(r);return}}const d=n.find(a=>a.id===r.inReplyToId);d&&(s[o++]=[r,d])});for(let r=0;r<s.length;r++)for(let d=r+1;d<s.length;d++)s[r].find(h=>s[d].includes(h))&&(s[r]=[...s[r],...s[d]],s[r]=s[r].filter((h,p,g)=>g.findIndex(y=>y.id===h.id)===p),s.splice(d,1),d--);s.forEach(r=>{r.sort((d,a)=>!d.inReplyToId&&!a.inReplyToId?new Date(d.createdAt)-new Date(a.createdAt):d.inReplyToId===a.id?1:a.inReplyToId===d.id||!d.inReplyToId?-1:a.inReplyToId?new Date(d.createdAt)-new Date(a.createdAt):1)}),s.forEach(r=>{const d=r[0].account.id;r.forEach(a=>{a.account.id!==d&&(a._differentAuthor=!0)})}),s.length;const c=[],l=[],u=[];return n.forEach(r=>{if(r.reblog){c.push(r);return}for(let d=0;d<s.length;d++)if(s[d].find(a=>a.id===r.id)){if(l.includes(d))return;const a=s[d];a.sort((p,g)=>{const y=new Date(p.createdAt),b=new Date(g.createdAt);return y-b});const h=a[0].account.id;c.push({id:a.map(p=>p.id),items:a,type:a.every(p=>p.account.id===h)?"thread":"conversation"}),l.push(d);return}if(r.inReplyToId&&r.inReplyToAccountId!==r.account.id){const d=rt(r.id,i);x.statusReply[d]||u.push({sKey:d,inReplyToId:r.inReplyToId})}c.push(r)}),u!=null&&u.length&&queueMicrotask(()=>{const{masto:r}=le({instance:i});async function d(){for(let a=0;a<u.length;a++){const{sKey:h,inReplyToId:p}=u[a];try{const g=await xl(p,r);et(g,i,{skipThreading:!0}),x.statusReply[h]={id:g.id,instance:i},await new Promise(y=>setTimeout(y,1e3))}catch{}}}if(Je("@mastodon/fetch-multiple-statuses")){const a=u.map(({inReplyToId:h})=>h);(async()=>{var h;try{const p=await r.v1.statuses.list({id:a});if(p!=null&&p.length)for(const g of p){et(g,i,{skipThreading:!0});const y=(h=u.find(({inReplyToId:b})=>b===g.id))==null?void 0:h.sKey;y&&(x.statusReply[y]={id:g.id,instance:i})}else d()}catch{d()}})()}else d()}),c}const xl=bt((n,i)=>i.v1.statuses.$select(n).fetch());async function eo(n,i){const s=await ul();if(!s.length)return;const{statusFollowedTags:o}=x,c=[];if(n.forEach(l=>{var g;if(l.reblog)return;const{id:u,content:r,tags:d=[]}=l,a=rt(u,i);if((g=o[a])!=null&&g.length)return;const h=hl(r);if(!h.length&&!d.length)return;const p=s.reduce((y,b)=>((h.some(w=>w.toLowerCase()===b.name.toLowerCase())||d.some(w=>w.name.toLowerCase()===b.name.toLowerCase()))&&y.push(b.name),y),[]);p.length&&c.push({item:l,sKey:a,followedTags:p})}),c.length){const l=c.map(r=>r.item.account),u=await Dn(l);if(!u)return;c.forEach(r=>{const{item:d,sKey:a,followedTags:h}=r,p=u[d.account.id];p&&!p.following&&(o[a]=h)})}}function El(){x.statusFollowedTags={}}function Rl({scrollableRef:n,distanceFromStart:i=1,distanceFromEnd:s=1,scrollThresholdStart:o=10,scrollThresholdEnd:c=10,direction:l="vertical",distanceFromStartPx:u,distanceFromEndPx:r}={}){const[d,a]=M(null),[h,p]=M(!1),[g,y]=M(!1),[b,w]=M(!1),[v,m]=M(!1),S=l==="vertical";return St(()=>{const C=n.current;if(!C)return{};let T=S?C.scrollTop:C.scrollLeft;function A(){const{scrollTop:k,scrollLeft:_,scrollHeight:E,scrollWidth:R,clientHeight:F,clientWidth:O}=C,W=S?k:_,V=S?E:R,X=S?F:O,Y=Math.abs(W-T),Z=u||Math.min(X*i,V,W),B=r||Math.min(X*s,V,V-W-X);Y>=(T<W?c:o)&&(a(T<W?"end":"start"),T=W),p(W<=0),y(W+X>=V),w(W<=Z),m(W+X>=V-B)}return C.addEventListener("scroll",A,{passive:!0}),()=>C.removeEventListener("scroll",A)},[i,s,o,c]),{scrollDirection:d,reachStart:h,reachEnd:g,nearReachStart:b,nearReachEnd:v,init:()=>{n.current&&n.current.dispatchEvent(new Event("scroll"))}}}function Ll({scrollableRef:n,distanceFromStart:i=1,distanceFromEnd:s=1,scrollThresholdStart:o=10,scrollThresholdEnd:c=10,direction:l="vertical",distanceFromStartPx:u,distanceFromEndPx:r,init:d}={},a,h){if(!a)return;const p=l==="vertical",g=q(null),y=q(null),b=Qo(()=>{let w=!1,v=!1,m=!1,S=!1;const C=n.current,{scrollTop:T,scrollLeft:A,scrollHeight:k,scrollWidth:_,clientHeight:E,clientWidth:R}=C,F=p?T:A,O=p?k:_,W=p?E:R,V=Math.abs(F-g.current),X=u||Math.min(W*i,O,F),Y=r||Math.min(W*s,O,O-F-W);V>=(g.current<F?c:o)&&(y.current=g.current<F?"end":"start",g.current=F),w=F<=0,v=F+W>=O,m=F<=X,S=F+W>=O-Y,a({scrollDirection:y.current,reachStart:w,reachEnd:v,nearReachStart:m,nearReachEnd:S})},500);St(()=>{const w=n.current;return w?(g.current=w[p?"scrollTop":"scrollLeft"],w.addEventListener("scroll",b,{passive:!0}),()=>w.removeEventListener("scroll",b)):{}},[i,s,o,c,...h]),Q(()=>{d&&n.current&&queueMicrotask(()=>{n.current.dispatchEvent(new Event("scroll"))})},[d])}function Ml({class:n,statusID:i,status:s,instance:o,parent:c,onMediaClick:l}){var N;const{_:u}=re();let r=rt(i,o);const d=We(x);if(s||(s=d.statuses[r]||d.statuses[i],r=rt(s==null?void 0:s.id,o)),!s)return null;const{account:{acct:a,avatar:h,avatarStatic:p,id:g,url:y,displayName:b,username:w,emojis:v,bot:m,group:S},id:C,repliesCount:T,reblogged:A,reblogsCount:k,favourited:_,favouritesCount:E,bookmarked:R,poll:F,muted:O,sensitive:W,spoilerText:V,visibility:X,language:Y,editedAt:Z,filtered:B,card:ee,createdAt:$,inReplyToId:K,inReplyToAccountId:j,content:te,mentions:J,mediaAttachments:ue,reblog:he,uri:ne,url:we,emojis:Ce,_deleted:se,_pinned:Te}=s;if(!(ue!=null&&ue.length))return null;const Ie=D=>{D.shiftKey},Pe=Ae(()=>kt(),[]),$e=Ae(()=>Pe&&Pe===g,[g,Pe]),Ee=$o(On),H=!$e&&Vt(B,Ee);if((H==null?void 0:H.action)==="hide")return null;const ke=W,Me=(((N=di()["reading:expand:media"])==null?void 0:N.toLowerCase())||"default")==="show_all",me=c||"div";return ue.map((D,oe)=>{const Le=`${r}-${D.id}`,P=H==null?void 0:H.titlesStr;return e(me,{"data-state-post-id":r,onMouseEnter:Ie,"data-spoiler-text":V||(W?u({id:"FKojeB"}):void 0),"data-filtered-text":H?u(P?{id:"7FGvtQ",values:{filterTitleStr:P}}:{id:"03Qqf9"}):void 0,class:`
          media-post
          ${H?"filtered":""}
          ${ke?"has-spoiler":""}
          ${Me?"show-media":""}
        `,children:e(Ms,{class:n,media:D,lang:Y,to:`/${o}/s/${C}?media-only=${oe+1}`,onClick:l?ce=>l(ce,oe,D,s):void 0})},Le)})}const is=ut(Ml);function $l(n){var C,T,A,k,_;const{_:i}=re(),s=We(x),{masto:o,instance:c,authenticated:l}=le(),[u,r]=Ae(()=>{const E=ri();return[E.find(F=>F.info.id===kt())||E[0],E.length>1]},[]),d=(s.settings.shortcutsViewMode==="multi-column"||!s.settings.shortcutsViewMode&&s.settings.shortcutsColumnsMode)&&!s.shortcuts.find(E=>E.type==="following"),a=Is(()=>{x.showAccounts=!0},{threshold:600,detect:"touch",cancelOnMovement:!0}),h=q(),[p,g]=M(void 0),y=As([0,0,s.settings.shortcutsViewMode==="tab-menu-bar"?50:0,0]),b=q();async function w(E){return(E||!b.current)&&(b.current=o.v1.mutes.list({limit:80}).values()),await b.current.next()}const v=q();async function m(E){return(E||!v.current)&&(v.current=o.v1.blocks.list({limit:80}).values()),await v.current.next()}const S=q();return e(U,{children:[e("button",{ref:h,type:"button",class:`button plain nav-menu-button ${r?"with-avatar":""} ${p==="open"?"active":""}`,style:{position:"relative"},onClick:()=>{S.current=Date.now(),g(E=>E?void 0:"open")},onContextMenu:E=>{E.preventDefault(),x.showAccounts=!0},...a(),children:[r&&e(mt,{url:((C=u==null?void 0:u.info)==null?void 0:C.avatar)||((T=u==null?void 0:u.info)==null?void 0:T.avatarStatic),size:"l",squircle:(A=u==null?void 0:u.info)==null?void 0:A.bot}),e(I,{icon:"menu",size:r?"s":"l",alt:i({id:"zucql+"})})]}),e(gi,{menuClassName:"nav-menu",state:p,anchorRef:h,onClose:()=>{g(void 0)},containerProps:{style:{zIndex:10},onClick:()=>{Date.now()-S.current<300}},portal:{target:document.body},...n,overflow:"auto",viewScroll:"close",position:"anchor",align:"center",boundingBoxPadding:y,unmountOnClose:!0,children:[!!((k=s.appVersion)!=null&&k.commitHash)&&s.appVersion.commitHash!=="4758452"&&e("div",{class:"top-menu",children:[e(ye,{onClick:()=>{confirm(i({id:"Djbaby"}))&&(async()=>{try{location.reload()}catch{}})()},children:[e(I,{icon:"sparkles",class:"sparkle-icon",size:"l"})," ",e("span",{children:e(f,{id:"95IFnD"})})]}),e(Ve,{})]}),e("section",{children:[e(je,{to:"/",children:[e(I,{icon:"home",size:"l"})," ",e("span",{children:e(f,{id:"i0qMbr"})})]}),l?e(U,{children:[d&&e(je,{to:"/following",children:[e(I,{icon:"following",size:"l"})," ",e("span",{children:e(f,{id:"following.title"})})]}),e(je,{to:"/catchup",children:[e(I,{icon:"history2",size:"l"}),e("span",{children:e(f,{id:"xrl8fj"})})]}),Je("@mastodon/mentions")&&e(je,{to:"/mentions",children:[e(I,{icon:"at",size:"l"})," ",e("span",{children:e(f,{id:"/bZzdR"})})]}),e(je,{to:"/notifications",children:[e(I,{icon:"notification",size:"l"})," ",e("span",{children:e(f,{id:"iDNBZe"})}),s.notificationsShowNew&&e("sup",{title:i({id:"isRobC"}),style:{opacity:.5},children:[" ","•"]})]}),e(Ve,{}),((_=u==null?void 0:u.info)==null?void 0:_.id)&&e(je,{to:`/${c}/a/${u.info.id}`,children:[e(I,{icon:"user",size:"l"})," ",e("span",{children:e(f,{id:"vERlcd"})})]}),e(Nl,{menuState:p}),e(je,{to:"/b",children:[e(I,{icon:"bookmark",size:"l"})," ",e("span",{children:e(f,{id:"7Ff7ia"})})]}),e(dn,{menuClassName:"nav-submenu",overflow:"auto",gap:-8,label:e(U,{children:[e(I,{icon:"more",size:"l"}),e("span",{class:"menu-grow",children:e(f,{id:"24misb"})}),e(I,{icon:"chevron-right"})]}),children:[e(je,{to:"/f",children:[e(I,{icon:"heart",size:"l"})," ",e("span",{children:e(f,{id:"zZOZj7"})})]}),e(je,{to:"/fh",children:[e(I,{icon:"hashtag",size:"l"})," ",e("span",{children:e(f,{id:"Xi1/bw"})})]}),e(je,{to:"/sp",children:[e(I,{icon:"schedule",size:"l"})," ",e("span",{children:e(f,{id:"+GkIdc"})})]}),e(Ve,{}),Je("@mastodon/filters")&&e(je,{to:"/ft",children:[e(I,{icon:"filters",size:"l"})," ",e("span",{children:e(f,{id:"cSev+j"})})]}),e(ye,{onClick:()=>{x.showGenericAccounts={id:"mute",heading:i({id:"sOKhEA"}),fetchAccounts:w,excludeRelationshipAttrs:["muting"]}},children:[e(I,{icon:"mute",size:"l"})," ",e("span",{children:e(f,{id:"n1sANU"})})]}),e(ye,{onClick:()=>{x.showGenericAccounts={id:"block",heading:i({id:"nL8nlr"}),fetchAccounts:m,excludeRelationshipAttrs:["blocking"]}},children:[e(I,{icon:"block",size:"l"})," ",e("span",{children:e(f,{id:"r3RRWo"})})]})," "]}),e(Ve,{}),e(ye,{onClick:()=>{x.showAccounts=!0},children:[e(I,{icon:"group",size:"l"})," ",e("span",{children:e(f,{id:"7e0O8Z"})})]})]}):e(U,{children:[e(Ve,{}),e(je,{to:"/login",children:[e(I,{icon:"user",size:"l"})," ",e("span",{children:e(f,{id:"sQia9P"})})]})]})]}),e("section",{children:[e(Ve,{}),e(je,{to:"/search",children:[e(I,{icon:"search",size:"l"})," ",e("span",{children:e(f,{id:"A1taO8"})})]}),e(je,{to:`/${c}/trending`,children:[e(I,{icon:"chart",size:"l"})," ",e("span",{children:e(f,{id:"4/iCqx"})})]}),e(je,{to:`/${c}/p/l`,children:[e(I,{icon:"building",size:"l"})," ",e("span",{children:e(f,{id:"d5zxa4"})})]}),e(je,{to:`/${c}/p`,children:[e(I,{icon:"earth",size:"l"})," ",e("span",{children:e(f,{id:"4ERYY7"})})]}),l?e(U,{children:[e(Ve,{className:"divider-grow"}),e(ye,{onClick:()=>{x.showKeyboardShortcutsHelp=!0},children:[e(I,{icon:"keyboard",size:"l"})," ",e("span",{children:e(f,{id:"77Emn0"})})]}),e(ye,{onClick:()=>{x.showShortcutsSettings=!0},children:[e(I,{icon:"shortcut",size:"l"})," ",e("span",{children:e(f,{id:"8Kudkr"})})]}),e(ye,{onClick:()=>{x.showSettings=!0},children:[e(I,{icon:"gear",size:"l"})," ",e("span",{children:e(f,{id:"uVbUP8"})})]})]}):e(U,{children:[e(Ve,{}),e(ye,{onClick:()=>{x.showSettings=!0},children:[e(I,{icon:"gear",size:"l"})," ",e("span",{children:e(f,{id:"uVbUP8"})})]})]})]})]})]})}function Nl({menuState:n}){const i=Je("@mastodon/lists"),[s,o]=M([]);return Q(()=>{i&&n==="open"&&hn().then(o)},[n,i]),s.length>0?e(dn,{menuClassName:"nav-submenu",overflow:"auto",gap:-8,label:e(U,{children:[e(I,{icon:"list",size:"l"}),e("span",{class:"menu-grow",children:e(f,{id:"h16FyT"})}),e(I,{icon:"chevron-right"})]}),children:[e(je,{to:"/l",children:e("span",{children:e(f,{id:"BHWx+g"})})}),(s==null?void 0:s.length)>0&&e(U,{children:[e(Ve,{}),s.map(c=>e(je,{to:`/l/${c.id}`,children:e("span",{children:[c.title,c.exclusive&&e(U,{children:[" ",e(Bt,{})]})]})},c.id))]})]}):i&&e(je,{to:"/l",children:[e(I,{icon:"list",size:"l"}),e("span",{children:e(f,{id:"h16FyT"})})]})}const $t=ut($l),fn={block:"start",inline:"center",behavior:"smooth"};function At({title:n,titleComponent:i,id:s,instance:o,emptyText:c,errorText:l,useItemID:u,boostsCarousel:r,fetchItems:d=()=>{},checkForUpdates:a=()=>{},checkForUpdatesInterval:h=15e3,headerStart:p,headerEnd:g,timelineStart:y,refresh:b,view:w,filterContext:v,showFollowedTags:m,showReplyParent:S,clearWhenRefresh:C}){const{_:T}=re(),A=We(x),[k,_]=M([]),[E,R]=M("start"),[F,O]=M(!1),[W,V]=M(!1),[X,Y]=M(!0),Z=q();__BENCHMARK.start(`timeline-${s}-load`);const B=Ae(()=>fi(),[]),ee=w!=="media",$=q(0),K=ec(H=>{V(!1),R("loading"),(async()=>{try{const ke=$.current=Date.now();let{done:De,value:xe}=await d(H);if(ke!==$.current)return;if(Array.isArray(xe)){const[Me,me]=xe.reduce((N,D)=>(D._pinned?N[0].push(D):N[1].push(D),N),[[],[]]);xe=me,ee&&(r&&(xe=Tl(xe)),xe=Al(xe,o)),Me.length&&(xe=Me.concat(xe)),_(H?xe:N=>[...N,...xe]),xe.length||(De=!0),O(!De)}else O(!1);R("default"),__BENCHMARK.end(`timeline-${s}-load`)}catch{R("error"),H&&!k.length&&l&&fe(l)}finally{K.cancel()}})()},1e3,{leading:!0}),j=".timeline-item, .timeline-item-alt",te=Ye("j, shift+j",(H,ke)=>{if(H.shiftKey!==ke.shift)return;const De=document.activeElement.closest(j),xe=De==null?void 0:De.getBoundingClientRect(),Me=Array.from(Z.current.querySelectorAll(j)).filter(me=>!!me.offsetHeight);if(De&&xe.top<Z.current.clientHeight&&xe.bottom>0){const me=Me.indexOf(De);let N=Me[me+1];ke.shift&&(N=Me.find((D,oe)=>oe>me&&!D.classList.contains("timeline-item-alt"))),N&&(N.focus(),N.scrollIntoView(fn))}else{const me=Me.find(N=>{const D=N.getBoundingClientRect();return D.top>=44&&D.left>=0});me&&(me.focus(),me.scrollIntoView(fn))}},{useKey:!0,ignoreEventWhen:H=>H.metaKey||H.ctrlKey||H.altKey}),J=Ye("k, shift+k",(H,ke)=>{if(H.shiftKey!==ke.shift)return;const De=document.activeElement.closest(j),xe=De==null?void 0:De.getBoundingClientRect(),Me=Array.from(Z.current.querySelectorAll(j)).filter(me=>!!me.offsetHeight);if(De&&xe.top<Z.current.clientHeight&&xe.bottom>0){const me=Me.indexOf(De);let N=Me[me-1];ke.shift&&(N=Me.findLast((D,oe)=>oe<me&&!D.classList.contains("timeline-item-alt"))),N&&(N.focus(),N.scrollIntoView(fn))}else{const me=Me.find(N=>{const D=N.getBoundingClientRect();return D.top>=44&&D.left>=0});me&&(me.focus(),me.scrollIntoView(fn))}},{useKey:!0,ignoreEventWhen:H=>H.metaKey||H.ctrlKey||H.altKey}),ue=Ye(["enter","o"],()=>{const H=document.activeElement;H!=null&&H.matches(j)&&H.click()},{useKey:!0,ignoreEventWhen:H=>H.metaKey||H.ctrlKey||H.altKey||H.shiftKey}),he=k.length>0&&E!=="loading"&&W,ne=it(()=>{var H;he&&K(!0),(H=Z.current)==null||H.scrollTo({top:0,behavior:"smooth"})},[K,he]),we=Ye(".",ne,{useKey:!0,ignoreEventWhen:H=>H.metaKey||H.ctrlKey||H.altKey||H.shiftKey}),Ce=q(),[se,Te]=M(!1);Ll({scrollableRef:Z,distanceFromEnd:2,scrollThresholdStart:44},({scrollDirection:H,nearReachStart:ke,reachStart:De})=>{if(Ce.current){const xe=H==="end"&&!ke;Ce.current.hidden=xe}Te(ke),De&&K(!0)},[]),Q(()=>{var H;(H=Z.current)==null||H.scrollTo({top:0}),K(!0)},[]);const Ie=q(!0);Q(()=>{var H;if(Ie.current){Ie.current=!1;return}C&&(k!=null&&k.length)&&((H=K.cancel)==null||H.call(K),_([])),K(!0)},[C,b]);const Pe=q(w);Q(()=>{Pe.current!==w&&(Pe.current=w,_([]))},[w]);const $e=it(async({disableIdleCheck:H=!1}={})=>{const ke=Z.current?getComputedStyle(Z.current).pointerEvents==="none":!1;A.settings.autoRefresh&&Z.current.scrollTop<16&&(H||window.__IDLE__)&&!zl()&&!ke?K(!0):await a()&&V(!0)},[s,K,a,A.settings.autoRefresh]),Ee=q();return Gt(H=>{if(H){const ke=Date.now()-Ee.current;(!Ee.current||ke>1e3*3)&&$e({disableIdleCheck:!0})}else Ee.current=Date.now();Y(H)},[a,$e,A.settings.autoRefresh]),mi($e,X&&!W?h*(se?1:2):null),e(On.Provider,{value:v,children:e("div",{id:`${s}-page`,class:`deck-container ${B?"deck-container-media-first":""}`,ref:H=>{Z.current=H,te.current=H,J.current=H,ue.current=H,we.current=H},tabIndex:"-1",onClick:H=>{Ce.current&&H.target.closest(".timeline-item, .timeline-item-alt")&&setTimeout(()=>{Ce.current.hidden=!1},250)},children:e("div",{class:"timeline-deck deck",children:[e("header",{ref:Ce,onClick:H=>{var ke;H.target.closest("a, button")||(ke=Z.current)==null||ke.scrollTo({top:0,behavior:"smooth"})},onDblClick:H=>{H.target.closest("a, button")||K(!0)},class:E==="loading"?"loading":"",children:[e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e($t,{}),p??e(ge,{to:"/",class:"button plain home-button",children:e(I,{icon:"home",size:"l",alt:T({id:"i0qMbr"})})})]}),n&&(i||e("h1",{children:n})),e("div",{class:"header-side",children:!!g&&g})]}),he&&e("button",{class:"updates-button shiny-pill",type:"button",onClick:ne,children:[e(I,{icon:"arrow-up"})," ",e(f,{id:"2yr1/p"})]})]}),!!y&&e("div",{class:`timeline-start ${E==="loading"?"loading":""}`,children:y}),k.length?e(U,{children:[e("ul",{class:`timeline ${w?`timeline-${w}`:""}`,children:[k.map(H=>e(Pl,{status:H,instance:o,useItemID:u,filterContext:v,view:w,showFollowedTags:m,showReplyParent:S,mediaFirst:B},H.id+(H==null?void 0:H._pinned)+w)),F&&E==="loading"&&(w==="media"?null:e(U,{children:[e("li",{style:{height:"20vh"},children:e(Ge,{skeleton:!0,mediaFirst:B})}),e("li",{style:{height:"25vh"},children:e(Ge,{skeleton:!0,mediaFirst:B})})]}))]}),E==="default"&&(F?e(Tt,{root:Z.current,rootMargin:`0px 0px ${screen.height*1.5}px 0px`,onChange:H=>{H&&K()},children:e("button",{type:"button",class:"plain block",onClick:()=>K(),style:{marginBlockEnd:"6em"},children:e(f,{id:"uXRAkV"})})}):e("p",{class:"ui-state insignificant",children:e(f,{id:"2EYeAZ"})}))]}):E==="loading"?e("ul",{class:"timeline",children:Array.from({length:5}).map((H,ke)=>w==="media"?e("div",{style:{height:"50vh"}}):e("li",{children:e(Ge,{skeleton:!0,mediaFirst:B})},ke))}):E!=="error"&&E!=="start"&&e("p",{class:"ui-state",children:c}),E==="error"&&e("p",{class:"ui-state",children:[l,e("br",{}),e("br",{}),e("button",{type:"button",onClick:()=>K(!k.length),children:e(f,{id:"KDw4GX"})})]})]})})})}const Pl=ut(({status:n,instance:i,useItemID:s,filterContext:o,view:c,showFollowedTags:l,showReplyParent:u,mediaFirst:r})=>{const{_:d}=re(),{id:a,reblog:h,items:p,type:g,_pinned:y}=n;y&&(s=!1);const b=(h==null?void 0:h.id)||a,w=i?`/${i}/s/${b}`:`/s/${b}`;if(p){let m=zt(p,o),S="";if(g==="boosts"?S=pe._({id:"NuqppG",values:{0:m.length}}):g==="pinned"&&(S=d({id:"GlfmCu"})),g==="boosts"||g==="pinned"){const A=new Set;if(m.sort((k,_)=>{const E=Vt(k.filtered,o),R=Vt(_.filtered,o);return E&&(E==null?void 0:E.action)!=="blur"&&A.add(k.id),R&&(R==null?void 0:R.action)!=="blur"&&A.add(_.id),E&&!R?1:!E&&R?-1:0}),A.size>=2){const _=[],E=[];m.forEach(F=>{A.has(F.id)?E.push(F):_.push(F)});const R=[];for(let F=0;F<E.length;F+=5)R.push({_grouped:!0,posts:E.slice(F,F+5)});m=_.concat(R)}return e("li",{class:"timeline-item-carousel",children:e(Dl,{title:S,class:`${g}-carousel`,children:m.map(k=>{const{id:_,reblog:E,_pinned:R,_grouped:F}=k;if(F)return e("li",{class:"timeline-item-carousel-group",children:k.posts.map(V=>{const{id:X,reblog:Y,_pinned:Z}=V,B=(Y==null?void 0:Y.id)||X,ee=i?`/${i}/s/${B}`:`/s/${B}`;return Z&&(s=!1),e(ge,{class:"status-carousel-link timeline-item-alt",to:ee,children:s?e(Ge,{statusID:X,instance:i,size:"s"}):e(Ge,{status:V,instance:i,size:"s"})})})},_);const O=(E==null?void 0:E.id)||_,W=i?`/${i}/s/${O}`:`/s/${O}`;return R&&(s=!1),e("li",{children:e(ge,{class:"status-carousel-link timeline-item-alt",to:W,children:s?e(Ge,{statusID:_,instance:i,size:"s",contentTextWeight:!0,enableCommentHint:!0,mediaFirst:r}):e(Ge,{status:k,instance:i,size:"s",contentTextWeight:!0,enableCommentHint:!0,mediaFirst:r})})},_)})})},`timeline-${a}`)}const T=m.length>3;return m.map((A,k)=>{const{id:_,_differentAuthor:E}=A,R=i?`/${i}/s/${_}`:`/s/${_}`,F=k>0&&k<m.length-1,O=A.sensitive&&!!A.spoilerText,W=!E&&O&&k>0||T&&F&&(g==="thread"||g==="conversation"&&!E&&!m[k-1]._differentAuthor&&!m[k+1]._differentAuthor),V=k===0,X=k===m.length-1;return e("li",{class:`timeline-item-container timeline-item-container-type-${g} timeline-item-container-${V?"start":X?"end":"middle"} ${E?"timeline-item-diff-author":""}`,children:e(ge,{class:"status-link timeline-item",to:R,children:W?e(Ol,{status:A,instance:i,filterContext:o}):s?e(Ge,{statusID:_,instance:i,enableCommentHint:X,showFollowedTags:l}):e(Ge,{status:A,instance:i,enableCommentHint:X,showFollowedTags:l})})},`timeline-${_}`)})}const v=`timeline-${a+y}`;return c==="media"?s?e(is,{class:"timeline-item",parent:"li",statusID:a,instance:i},v):e(is,{class:"timeline-item",parent:"li",status:n,instance:i},v):e("li",{children:e(ge,{class:"status-link timeline-item",to:w,children:s?e(Ge,{statusID:a,instance:i,enableCommentHint:!0,showFollowedTags:l,showReplyParent:u,mediaFirst:r}):e(Ge,{status:n,instance:i,enableCommentHint:!0,showFollowedTags:l,showReplyParent:u,mediaFirst:r})})},v)},(n,i)=>{var c,l;const s=(((c=n.status)==null?void 0:c.id)||"").toString(),o=(((l=i.status)==null?void 0:l.id)||"").toString();return s===o&&n.instance===i.instance&&n.view===i.view});function Dl({title:n,class:i,children:s}){const{_:o}=re(),c=q(),l=q(),u=q(),[r,d]=M(!1);return Q(()=>{setTimeout(()=>{d(!0)},1)},[]),e("div",{class:`status-carousel ${i}`,children:[e("header",{children:[e("h3",{children:n}),e("span",{children:[e("button",{ref:l,type:"button",class:"small plain2",onClick:()=>{var h,p;const a=Math.min(320,(h=c.current)==null?void 0:h.offsetWidth)*(Ot()?1:-1);(p=c.current)==null||p.scrollBy({left:a,behavior:"smooth"})},children:e(I,{icon:"chevron-left",alt:o({id:"DHhJ7s"})})})," ",e("button",{ref:u,type:"button",class:"small plain2",onClick:()=>{var h,p;const a=Math.min(320,(h=c.current)==null?void 0:h.offsetWidth)*(Ot()?-1:1);(p=c.current)==null||p.scrollBy({left:a,behavior:"smooth"})},children:e(I,{icon:"chevron-right",alt:o({id:"hXzOVo"})})})]})]}),e("ul",{ref:c,children:[e(Tt,{class:"status-carousel-beacon",onChange:a=>{l.current&&(l.current.disabled=a)}}),s[0],r&&s.slice(1),e(Tt,{class:"status-carousel-beacon",onChange:a=>{u.current&&(u.current.disabled=a)}})]})]})}function Ol({status:n,instance:i,filterContext:s}){const{_:o}=re(),c=We(x),{id:l,visibility:u,language:r}=n,d=Pn(n),a=rt(l,i),h=Vt(n.filtered,s);return e("article",{class:`status compact-thread ${u==="direct"?"visibility-direct":""}`,tabindex:"-1",children:[c.statusThreadNumber[a]?e("div",{class:"status-thread-badge",children:[e(I,{icon:"thread",size:"s",alt:o({id:"e66y2Z"})}),c.statusThreadNumber[a]?` ${c.statusThreadNumber[a]}/X`:""]}):e("div",{class:"status-thread-badge",children:e(I,{icon:"thread",size:"s",alt:o({id:"e66y2Z"})})}),e("div",{class:"content-compact",title:d,lang:r,dir:"auto",children:h&&(h==null?void 0:h.action)!=="blur"?e("b",{class:"status-filtered-badge badge-meta horizontal",title:(h==null?void 0:h.titlesStr)||"",children:h!=null&&h.titlesStr?e(f,{id:"sr6maL",values:{0:h.titlesStr},components:{0:e("span",{}),1:e("span",{})}}):e("span",{children:e(f,{id:"03Qqf9"})})}):e(U,{children:[d,n.sensitive&&n.spoilerText&&e(U,{children:[" ",e("span",{class:"spoiler-badge",children:e(I,{icon:"eye-close",size:"s",alt:o({id:"gnKo7f"})})})]})]})})]})}function zl(){return!!document.querySelector(".deck-backdrop, #modal-container > *")}const Yt=20,Li=1983,ss=`${Li}-01`,Ul=(()=>{try{const n=document.createElement("input");return n.setAttribute("type","month"),n.type==="month"}catch{return!1}})();async function Bl(n){var o;const{masto:i}=le({instance:n}),s=await i.v2.search.list({q:"from:me",type:"statuses",limit:1});return!!((o=s==null?void 0:s.statuses)!=null&&o.length)}const Fl=bt(Bl);function Kl(){const{i18n:n,_:i}=re(),s=We(x),{id:o,...c}=Mt(),[l,u]=vt(),r=l.get("month"),d=!l.get("replies"),a=!!l.get("boosts"),h=l.get("tagged"),p=!!l.get("media"),{masto:g,instance:y,authenticated:b}=le({instance:c.instance}),{masto:w,instance:v}=le(),m=q(),S=[r,d,a,h,p],[C,T]=M(),A=q(0);Q(()=>{A.current=0},S);const k=Ae(()=>fi(),[]),_=Ae(()=>y===v,[y,v]),[E,R]=M(!1);Q(()=>{_&&C!=null&&C.acct&&(async()=>{const J=await Fl(y);R(J)})()},[y,_,C==null?void 0:C.acct]);async function F(J){var se,Te,Ie,Pe;const ue=/^\d{4}-[01]\d$/.test(r),he=((Te=(se=r==null?void 0:r.split)==null?void 0:se.call(r,"-"))==null?void 0:Te[0])>=Li;if(ue&&he){if(!C)return{value:[],done:!0};const[$e,Ee]=r.split("-"),H=parseInt(Ee,10)-1,ke=new Date($e,H,0),De=`${ke.getFullYear()}-${(ke.getMonth()+1).toString().padStart(2,"0")}-${ke.getDate().toString().padStart(2,"0")}`,xe=new Date($e,H+1,1),Me=`${xe.getFullYear()}-${(xe.getMonth()+1).toString().padStart(2,"0")}-${xe.getDate().toString().padStart(2,"0")}`;let me;J?(me=Yt+1,A.current=0):(me=Yt+A.current+1,A.current+=Yt);const N=await g.v2.search.list({q:`from:${C.acct} after:${De} before:${Me}`,type:"statuses",limit:me,offset:A.current});if((Ie=N==null?void 0:N.statuses)!=null&&Ie.length){const D=N.statuses.slice(0,Yt);D.forEach(Le=>{et(Le,y)});const oe=N.statuses.length<=Yt;return{value:D,done:oe}}else return{value:[],done:!0}}let ne=[];if(J){const{value:$e}=await g.v1.accounts.$select(o).statuses.list({pinned:!0}).values().next();if($e!=null&&$e.length&&!h&&!p){const Ee=$e.map(H=>(et(H,y),{...H,_pinned:!0}));if(Ee.length>=3){const H=Ee.map(ke=>ke.id);ne.push({id:H,items:Ee,type:"pinned"})}else ne.push(...Ee)}}(J||!m.current)&&(m.current=g.v1.accounts.$select(o).statuses.list({limit:Yt,exclude_replies:d,exclude_reblogs:a,only_media:p||void 0,tagged:h}).values());const{value:we,done:Ce}=await m.current.next();if(we!=null&&we.length){if(!Je("@mastodon/pinned-posts")&&ne.length){let $e=[];((Pe=ne[0])==null?void 0:Pe.type)==="pinned"?$e=ne[0].id:$e=ne.filter(H=>H._pinned).map(H=>H.id),$e.every(H=>we.some(ke=>ke.id===H))&&(ne=[])}ne.push(...we),we.forEach($e=>{et($e,y)})}return{value:ne,done:Ce}}const[O,W]=M([]);let V=i({id:"/cKnpj"});if(C!=null&&C.acct){const J=(/@/.test(C.acct)?"":"@")+C.acct,ue=C!=null&&C.displayName?`${C.displayName} (${J})`:`${J}`;if(!d)V=i({id:"hS1Opy",values:{accountDisplay:ue}});else if(a)V=i({id:"A/CX5F",values:{accountDisplay:ue}});else if(h)V=i({id:"QQrO94",values:{accountDisplay:ue,tagged:h}});else if(p)V=i({id:"NoG5wD",values:{accountDisplay:ue}});else if(r){const he=new Date(r).toLocaleString(n.locale,{month:"long",year:"numeric"});V=i({id:"8GjLvB",values:{accountDisplay:ue,monthYear:he}})}else V=ue}tt(V,"/:instance?/a/:id");const X=it(()=>ql(o,g),[o,g]);Q(()=>{(async()=>{try{const J=await X();T(J)}catch{}if(!k)try{const J=await g.v1.accounts.$select(o).featuredTags.list();W(J)}catch{}})()},[o,k]);const{displayName:Y,acct:Z,emojis:B}=C||{},ee=q(),$=Ae(()=>{const J=!d||a||h||p||!!r,ue=s.accounts[`${o}@${y}`];return e(U,{children:[e(Gs,{instance:y,account:ue||o,fetchAccount:X,authenticated:b,standalone:!0,showEndorsements:!0}),!k&&e("div",{class:"filter-bar",ref:ee,style:{position:"relative"},children:[J?e(ge,{to:`/${y}/a/${o}`,class:"insignificant filter-clear",title:i({id:"u8JHrO"}),children:e(I,{icon:"x",size:"l",alt:i({id:"xCJdfg"})})},"clear-filters"):e(I,{icon:"filter",class:"insignificant",size:"l",alt:i({id:"cSev+j"})}),e(ge,{to:`/${y}/a/${o}${d?"?replies=1":""}`,onClick:()=>{d&&fe(i({id:"PIWNSQ"}))},class:d?"":"is-active",children:e(f,{id:"5BFynH"})}),e(ge,{to:`/${y}/a/${o}${a?"":"?boosts=0"}`,onClick:()=>{a||fe(i({id:"Qd13i0"}))},class:a?"is-active":"",children:e(f,{id:"usxQx0"})}),e(ge,{to:`/${y}/a/${o}${p?"":"?media=1"}`,onClick:()=>{p||fe(i({id:"rKpfPY"}))},class:p?"is-active":"",children:e(f,{id:"xYilR2"})}),O.map(he=>e(ge,{to:`/${y}/a/${o}${h===he.name?"":`?tagged=${encodeURIComponent(he.name)}`}`,onClick:()=>{h!==he.name&&fe(i({id:"L+HFfr",values:{0:he.name}}))},class:h===he.name?"is-active":"",children:e("span",{children:[e("span",{class:"more-insignificant",children:"#"}),he.name]})},he.id)),E&&(Ul?e("label",{class:`filter-field ${r?"is-active":""}`,children:[e(I,{icon:"month",size:"l"}),e("input",{type:"month",disabled:!(C!=null&&C.acct),value:r||"",min:ss,max:new Date().toISOString().slice(0,7),onInput:he=>{const{value:ne,validity:we}=he.currentTarget;if(!we.valid)return;u(ne?{month:ne}:{});const[Ce,se]=ne.split("-"),Te=parseInt(se,10)-1,Ie=new Date(Ce,Te);fe(i({id:"0WUFGD",values:{0:Ie.toLocaleString(n.locale,{month:"long",year:"numeric"})}}))}})]}):e(Hl,{class:`filter-field ${r?"is-active":""}`,disabled:!(C!=null&&C.acct),value:r||"",min:ss,max:new Date().toISOString().slice(0,7),onInput:he=>{const{value:ne,validity:we}=he;we.valid&&u(ne?{month:ne}:{})}}))]})]})},[o,y,b,O,X,E,...S]);Q(()=>{var ue;const J=(ue=ee.current)==null?void 0:ue.querySelector(".is-active");J&&ee.current.scrollTo({behavior:"smooth",left:J.offsetLeft-(ee.current.offsetWidth-J.offsetWidth)/2})},[O,E,...S]);const K=Ae(()=>{var ue;return C!=null&&C.url?(ue=URL.parse(C.url))==null?void 0:ue.hostname:null},[C]),te=!!C&&!(y===K);return e(U,{children:[e(At,{title:`${C!=null&&C.acct?"@"+C.acct:i({id:"+owNNn"})}`,titleComponent:e("h1",{class:"header-double-lines header-account",children:[e("b",{children:e(Rs,{text:Y,emojis:B})}),e("div",{children:e("span",{class:"bidi-isolate",children:["@",Z]})})]}),id:"account-statuses",instance:y,emptyText:i({id:"+k97fV"}),errorText:i({id:"scd9lw"}),fetchItems:F,useItemID:!0,view:p||k?"media":void 0,boostsCarousel:s.settings.boostsCarousel,timelineStart:$,refresh:[d,a,h,p,r+(C==null?void 0:C.acct)].toString(),headerEnd:e(dt,{portal:!0,overflow:"auto",viewScroll:"close",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(I,{icon:"more",size:"l",alt:i({id:"2FYpfJ"})})}),children:[e(ye,{disabled:!te,onClick:()=>{(async()=>{try{const{masto:J}=le({instance:K}),ue=await J.v1.accounts.lookup({acct:C.acct}),{id:he}=ue;location.hash=`/${K}/a/${he}`}catch{alert(i({id:"FgdLx0"}))}})()},children:[e(I,{icon:"transfer"})," ",e("small",{class:"menu-double-lines",children:e(f,{id:"/JFxxT",values:{0:K?e(U,{children:[" ","(",e("b",{children:un.toUnicode(K)}),")"]}):null}})})]}),!_&&e(ye,{onClick:()=>{(async()=>{try{const J=await w.v1.accounts.lookup({acct:C.acct+"@"+y}),{id:ue}=J;location.hash=`/${v}/a/${ue}`}catch{alert(i({id:"FgdLx0"}))}})()},children:[e(I,{icon:"transfer"})," ",e("small",{class:"menu-double-lines",children:e(f,{id:"HkuyOu",values:{currentInstance:v},components:{0:e("b",{})}})})]})]})},o),Z&&e("data",{class:"compose-data",value:JSON.stringify({draftStatus:{status:`@${Z} `}})})]})}function Hl(n){const{i18n:i}=re(),{class:s,disabled:o,value:c,min:l,max:u,onInput:r=()=>{}}=n,[d,a]=(c==null?void 0:c.split("-"))||[],h=q(),p=q(),g=(y,b)=>{const[w,v]=(l==null?void 0:l.split("-"))||[],[m,S]=(u==null?void 0:u.split("-"))||[];return!(b<w||b>m||b===w&&y<v||b===m&&y>S)};return e("div",{class:s,children:[e(I,{icon:"month",size:"l"}),e("select",{ref:h,disabled:o,value:a||"",onInput:y=>{const{value:b}=y.currentTarget,w=p.current.value;if(!g(b,w))return{value:"",validity:{valid:!1}};r({value:b?`${w}-${b}`:"",validity:{valid:!0}})},children:[e("option",{value:"",children:e(f,{id:"HajiZl"})}),e("option",{disabled:!0,children:"-----"}),Array.from({length:12},(y,b)=>e("option",{value:(b+1).toString().padStart(2,"0"),children:new Date(0,b).toLocaleString(i.locale,{month:"long"})},b))]})," ",e("input",{ref:p,type:"number",disabled:o,value:d||new Date().getFullYear(),min:(l==null?void 0:l.slice(0,4))||Li,max:(u==null?void 0:u.slice(0,4))||new Date().getFullYear(),onInput:y=>{const{value:b,validity:w}=y.currentTarget,v=h.current.value;if(!w.valid||!g(v,b))return{value:"",validity:{valid:!1}};r({value:b?`${b}-${v}`:"",validity:{valid:!0}})},style:{width:"4.5em"}})]})}function Yl(n,i){return i.v1.accounts.$select(n).fetch()}const ql=bt(Yl,{maxAge:30*60*1e3});function jl(){var y;const n=Mt(),{year:i}=n;tt(i?`Annual Report: ${i}`:"Annual Report");const{masto:s,instance:o}=le(),[c,l]=M(null),[u,r]=M("default");Q(()=>{i&&(async()=>{r("loading");const b=await s.v1.annualReports.$select(i).fetch();l(b),r("default")})()},[i]);const{accounts:d,annualReports:a,statuses:h}=c||{},p=(y=a==null?void 0:a.find(b=>b.year==i))==null?void 0:y.data,g=new Date;return e("div",{id:"annual-report-page",class:"deck-container",tabIndex:"-1",children:[e("div",{class:"report",children:[e("h1",{children:[i," #Wrapstodon"]}),u==="loading"&&e("p",{children:[e(Be,{abrupt:!0})," ",e(f,{id:"Pwqkdw"})]}),!!p&&e("dl",{children:Object.entries(p).map(([b,w])=>e(U,{children:[e("dt",{children:b}),e("dd",{class:`report-${b}`,children:Array.isArray(w)?e("table",{children:[e("thead",{children:e("tr",{children:Object.entries(w[0]).map(([v,m])=>e("th",{class:v!=="month"&&typeof m=="number"?"number":"",children:v}))})}),e("tbody",{children:w.map(v=>e("tr",{children:Object.entries(v).map(([m,S])=>e("td",{class:m!=="month"&&typeof S=="number"?"number":"",children:S&&/(accountId)/i.test(m)&&/^(mostRebloggedAccounts|commonlyInteractedWithAccounts)$/i.test(b)?e(yt,{account:d==null?void 0:d.find(C=>C.id===S),showAvatar:!0}):m==="month"?g.setMonth(S-1)&&g.toLocaleString(void 0,{month:"long"}):typeof S=="number"?S.toLocaleString():S}))}))})]}):typeof w=="object"?/^(topStatuses)$/i.test(b)?e("dl",{children:Object.entries(w).map(([v,m])=>e(U,{children:[e("dt",{children:v}),e("dd",{children:m&&e(ge,{to:`/${o}/s/${m}`,children:e(Ge,{status:h==null?void 0:h.find(S=>S.id===m),size:"s",readOnly:!0})})})]}))}):e("table",{children:e("tbody",{children:Object.entries(w).map(([v,m])=>e("tr",{children:[e("th",{children:v}),e("td",{class:typeof m=="number"?"number":"",children:m})]}))})}):typeof w=="string"?w:JSON.stringify(w,null,2)})]}))})]}),e("hr",{}),e("p",{style:{textAlign:"center"},children:e(ge,{to:"/",children:e(f,{id:"iWpEwy"})})})]})}const Vl=20;function to(){const{_:n}=re();tt(n({id:"7Ff7ia"}),"/bookmarks");const{masto:i,instance:s}=le(),o=q();async function c(l){return(l||!o.current)&&(o.current=i.v1.bookmarks.list({limit:Vl}).values()),await o.current.next()}return e(At,{title:n({id:"7Ff7ia"}),id:"bookmarks",emptyText:n({id:"8k2w6G"}),errorText:n({id:"UoL+FC"}),instance:s,fetchItems:c})}const Gl=""+new URL("catch-up-O5q5C75Z.png",import.meta.url).href,Wl="home",ht=[{label:{id:"Ov9hfp"},value:1},{label:{id:"tVE2wM"},value:2},{label:{id:"8+HOWa"},value:3},{label:{id:"1o+mEC"},value:4},{label:{id:"dZZ8oA"},value:5},{label:{id:"lpPucp"},value:6},{label:{id:"r9r5X6"},value:7},{label:{id:"I9uBFA"},value:8},{label:{id:"pBYFlb"},value:9},{label:{id:"wvL7OJ"},value:10},{label:{id:"7Vb+qD"},value:11},{label:{id:"VU1Pnd"},value:12},{label:{id:"vpc27K"},value:13}],Zl={original:{id:"HxF6Fk"},replies:{id:"N8UzTV"},boosts:{id:"puY2t0"},followedTags:{id:"lCLRBe"},groups:{id:"zhrjek"},filtered:{id:"03Qqf9"}},Xl=["createdAt","repliesCount","favouritesCount","reblogsCount","density"],Jl=[null,"account"],Ql=Ss(n=>new Intl.DateTimeFormat(n||void 0,{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}));function er(){const{i18n:n,_:i,_:s}=re(),o=Ql(n.locale);tt("Catch-up","/catchup");const{masto:c,instance:l}=le(),[u,r]=vt(),d=u.get("id"),[a,h]=M("start"),[p,g]=M(!1),y=Ae(()=>kt(),[]),b=L=>L===y,w=Je("@pixelfed/home-include-reblogs");async function v({maxCreatedAt:L}){var be,ve,_e;const G=L?new Date(L):null,ae=[],ie=c.v1.timelines.home.list({limit:40}),z=ie.values();e:for(;;)try{w&&ie.params&&(typeof ie.params=="string"?ie.params+="&include_reblogs=true":ie.params.include_reblogs=!0);const Ze=await z.next(),{value:Fe}=Ze;if(Fe!=null&&Fe.length){await eo(Fe,l);let de=!1;for(let Ue=0;Ue<Fe.length;Ue++){const Ke=Fe[Ue],nt=new Date(Ke.createdAt);if(!G||nt>=G){const He=!b(((ve=(be=Ke.reblog)==null?void 0:be.account)==null?void 0:ve.id)||Ke.account.id)&&Vt(((_e=Ke.reblog)==null?void 0:_e.filtered)||Ke.filtered,Wl);if((He==null?void 0:He.action)==="hide")continue;Ke._filtered=He;const at=rt(Ke.id,l);Ke._followedTags=x.statusFollowedTags[at]?[...x.statusFollowedTags[at]]:[],ae.push(Ke),de=!0}if(!de)break e}}else break e;await new Promise(de=>setTimeout(de,1e3))}catch{break e}return ae.forEach(Ze=>{if(Ze!=null&&Ze.inReplyToId){const Fe=ae.find(de=>de.id===Ze.inReplyToId);Fe&&!Fe.inReplyToId&&(Fe._thread=!0)}}),ae}const[m,S]=M([]),C=q(),T=q(),A=Ae(()=>An(),[]),k=it(async({duration:L}={})=>{const G=Date.now(),ae=L?G-L:null;h("loading");const ie=await v({maxCreatedAt:ae}),z=`${A}-${tc()}`;try{await gt.catchup.set(z,{id:z,posts:ie,count:ie.length,startAt:ae,endAt:G}),r({id:z})}catch{}},[]);Q(()=>{d?(async()=>{const L=await gt.catchup.get(d);L&&(L.posts.sort((G,ae)=>G.createdAt>ae.createdAt?1:-1),S(L.posts),h("results"))})():a==="results"&&(S([]),h("start"))},[d]);const[_,E]=Lt(L=>L+1,0),[R,F]=M(null),[O,W]=M([]);Q(()=>{(async()=>{try{const L=await gt.catchup.keys();if(L.length){const G=An(),ae=L.filter(ie=>ie.startsWith(`${G}-`));if(ae.length){let ie=await gt.catchup.getMany(ae);ie.sort((_e,Ze)=>Ze.endAt-_e.endAt);let z=ie.slice(0,3),be=ie.slice(3);const ve=z.map(_e=>{const{id:Ze,count:Fe,startAt:de,endAt:Ue}=_e;return{id:Ze,count:Fe,startAt:de,endAt:Ue}});W(ve),F(z[0].endAt),ie=null,z=null,queueMicrotask(()=>{be.length&&gt.catchup.delMany(be.map(_e=>_e.id)).then(()=>{be=null}).catch(_e=>{})});return}}}catch{}W([])})()},[_]),Q(()=>{a==="start"&&E()},[a==="start"]);const[V,X]=Ae(()=>{var Ze,Fe,de,Ue,Ke,nt;let L=0,G=0,ae=0,ie=0,z=0,be=0;const ve={};for(const Re of m){Re._filtered&&((Ze=Re._filtered)==null?void 0:Ze.action)!=="blur"?(L++,Re.__FILTER="filtered"):Re.group?(G++,Re.__FILTER="groups"):Re.reblog?(ae++,Re.__FILTER="boosts"):(Fe=Re._followedTags)!=null&&Fe.length?(z++,Re.__FILTER="followedTags"):Re.inReplyToId&&Re.inReplyToAccountId!==((de=Re.account)==null?void 0:de.id)?(ie++,Re.__FILTER="replies"):(be++,Re.__FILTER="original");const He=Re.reblog||Re;if(Re.__FILTER!=="filtered"&&((Ue=He.card)!=null&&Ue.url)&&((Ke=He.card)!=null&&Ke.image)&&((nt=He.card)==null?void 0:nt.type)==="link"){const{card:at,favouritesCount:Nt,reblogsCount:Pt}=He;let{url:st}=at;if(st=st.replace(/\/$/,""),!ve[st])ve[st]={postID:He.id,card:at,shared:1,sharers:[Re.account],likes:Nt,boosts:Pt};else{if(ve[st].sharers.find(Kn=>Kn.id===Re.account.id))continue;ve[st].shared++,ve[st].sharers.push(Re.account),ve[st].postID!==He.id&&(ve[st].likes+=Nt,ve[st].boosts+=Pt)}}}let _e=[];for(const Re in ve)_e.push({url:Re,...ve[Re]});if(_e.sort((Re,He)=>Re.shared>He.shared?-1:Re.shared<He.shared?1:Re.boosts>He.boosts?-1:Re.boosts<He.boosts?1:Re.likes>He.likes?-1:Re.likes<He.likes?1:0),_e.length>10)e:for(let Re=10;Re<_e.length;Re++){const{shared:He}=_e[Re];if(He<=1){_e=_e.slice(0,Re);break e}}return[{filtered:L,groups:G,boosts:ae,replies:ie,followedTags:z,original:be},_e]},[m]),[Y,Z]=M("all"),[B,ee]=M(null),[$,K]=M(1),[j,te]=M("createdAt"),[J,ue]=M("asc"),[he,ne]=M(null),[we,Ce,se]=Ae(()=>{const L={},G=new Map;let ae=m.filter(z=>{const be=Y==="all"||z.__FILTER===Y;return be&&(L[z.account.id]=z.account,G.set(z.account.id,(G.get(z.account.id)||0)+1)),be});const ie={};return ae.forEach(z=>{z.reblog&&(ie[z.reblog.id]?(ie[z.reblog.id].__BOOSTERS?ie[z.reblog.id].__BOOSTERS.add(z.account):ie[z.reblog.id].__BOOSTERS=new Set([z.account]),z.__HIDDEN=!0):ie[z.reblog.id]=z)}),B&&G.has(B)&&(ae=ae.filter(z=>z.account.id===B||[...z.__BOOSTERS||[]].find(be=>be.id===B))),[ae,L,Object.fromEntries(G)]},[Y,B,m]),Te=Ae(()=>{const L={};return we.forEach(G=>{L[G.id]=G}),L},[we]),Ie=Ae(()=>Object.keys(se).sort((L,G)=>se[G]-se[L]),[se]),Pe=Ae(()=>{const L={};return Ie.forEach((G,ae)=>{L[G]=ae}),we.filter(G=>!G.__HIDDEN).sort((G,ae)=>{if(he==="account"){const ie=G.account.id,z=ae.account.id,be=L[ie],ve=L[z],_e=be-ve;if(_e!==0)return _e}if(j!=="createdAt"&&(G=G.reblog||G,ae=ae.reblog||ae,j!=="density"&&G[j]===ae[j]))return G.createdAt>ae.createdAt?1:-1;if(j==="density"){const ie=os(G),z=os(ae);return J==="asc"?ie>z?1:-1:z>ie?1:-1}return J==="asc"?G[j]>ae[j]?1:-1:ae[j]>G[j]?1:-1})},[we,j,J,he,Ie]),$e=q(null),Ee=q(null),H=q(!1);Q(()=>{m.length>100||H.current||Ee.current&&(Fs(Ee.current,{duration:200}),H.current=!0)},[m,Ee]);const ke=m.length>160?"3d":"2d",De=Ae(()=>ke!=="2d"?null:m.map(L=>{const G=Te[L.id];return e("span",{class:`post-dot ${G?"post-dot-highlight":""}`},L.id)}),[Te]),xe=Ae(()=>ke!=="3d"||!(m!=null&&m.length)?null:ar(m,"createdAt",320).map((G,ae)=>e("div",{class:"posts-bin",children:G.map(ie=>{const z=Te[ie.id];return e("span",{class:`post-dot ${z?"post-dot-highlight":""}`},ie.id)})},ae)),[Te]),Me=q(null),me=Ae(()=>R?(Date.now()-R)/1e3/60/60:null,[R,$]);Q(()=>{if(a!=="results")return;const L=B&&Ce[B]?Ce[B].username:"",G=J==="asc"?0:1,ae={account:"authors"};let ie=fe({duration:5e3,text:s({id:"TLYeLT",values:{selectedFilterCategory:Y,sortBy:j,sortOrder:J,groupBy:he}})});return()=>{var z;(z=ie==null?void 0:ie.hideToast)==null||z.call(ie)}},[a,Y,B,j,J,he,Ce]),Q(()=>{var L;if(B&&Ce[B]){const G=Ee.current.querySelector(`[data-author="${B}"]`),ae=(L=Ee.current)==null?void 0:L.getBoundingClientRect(),ie=G==null?void 0:G.getBoundingClientRect();ie.left<ae.left||ie.right>ae.right?G.scrollIntoView({block:"nearest",inline:"center",behavior:"smooth"}):ie.top<0&&G.scrollIntoView({block:"nearest",inline:"nearest",behavior:"smooth"})}},[B,Ce]);const[N,D]=M(!1),oe=".catchup-list > li > a",Le=Ye("j",()=>{const L=document.activeElement.closest(oe),G=L==null?void 0:L.getBoundingClientRect(),ae=Array.from(Me.current.querySelectorAll(oe));if(L&&G.top<Me.current.clientHeight&&G.bottom>0){const ie=ae.indexOf(L),z=ae[ie+1];z&&(z.focus(),z.scrollIntoView({block:"center",inline:"center",behavior:"smooth"}))}else{const ie=ae.find(z=>z.getBoundingClientRect().top>=0);ie&&(ie.focus(),ie.scrollIntoView({block:"nearest",inline:"center",behavior:"smooth"}))}},{useKey:!0,preventDefault:!0,ignoreEventWhen:L=>L.metaKey||L.ctrlKey||L.altKey||L.shiftKey}),P=Ye("k",()=>{const L=document.activeElement.closest(oe),G=L==null?void 0:L.getBoundingClientRect(),ae=Array.from(Me.current.querySelectorAll(oe));if(L&&G.top<Me.current.clientHeight&&G.bottom>0){const ie=ae.indexOf(L);let z=ae[ie-1];z&&(z.focus(),z.scrollIntoView({block:"center",inline:"center",behavior:"smooth"}))}else{const ie=ae.find(z=>{const be=z.getBoundingClientRect();return be.top>=44&&be.left>=0});ie&&(ie.focus(),ie.scrollIntoView({block:"nearest",inline:"center",behavior:"smooth"}))}},{useKey:!0,preventDefault:!0,ignoreEventWhen:L=>L.metaKey||L.ctrlKey||L.altKey||L.shiftKey}),ce=Ye("h, l",(L,G)=>{var ie,z,be;const ae=G.keys[0];if(B){const ve=Ie.indexOf(B);ae==="h"?ve>0&&ve<Ie.length&&(ee(Ie[ve-1]),(ie=Me.current)==null||ie.focus()):ae==="l"&&ve<Ie.length-1&&ve>=0&&(ee(Ie[ve+1]),(z=Me.current)==null||z.focus())}else ae==="l"&&(ee(Ie[0]),(be=Me.current)==null||be.focus())},{useKey:!0,preventDefault:!0,ignoreEventWhen:L=>L.metaKey||L.ctrlKey||L.altKey||L.shiftKey,enableOnFormTags:["input"]}),Se=Ye("esc",()=>{var L;ee(null),(L=Me.current)==null||L.focus()},{preventDefault:!0,ignoreEventWhen:L=>L.metaKey||L.ctrlKey||L.altKey||L.shiftKey,enableOnFormTags:["input"],useKey:!0}),Ne=Ye(".",()=>{var L;(L=Me.current)==null||L.scrollTo({top:0,behavior:"smooth"})},{useKey:!0,preventDefault:!0,ignoreEventWhen:L=>L.metaKey||L.ctrlKey||L.altKey||L.shiftKey,enableOnFormTags:["input"]}),Oe=it(L=>{const G=document.activeElement,ae=(G==null?void 0:G.tagName)==="INPUT"&&G.type==="radio";if((L.key==="ArrowDown"||L.key==="ArrowUp"||L.key==="ArrowLeft"||L.key==="ArrowRight")&&ae){G.blur();return}},[]);return e("div",{ref:L=>{Me.current=L,Le.current=L,P.current=L,ce.current=L,Se.current=L,Ne.current=L},id:"catchup-page",class:"deck-container",tabIndex:"-1",children:[e("div",{class:"timeline-deck deck wide",children:[e("header",{class:`${a==="loading"?"loading":""}`,onClick:L=>{var G;L.target.closest("a, button")||(G=Me.current)==null||G.scrollTo({top:0,behavior:"smooth"})},children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e($t,{}),a==="results"&&e(ge,{to:"/catchup",class:"button plain",children:e(I,{icon:"history2",size:"l",alt:s({id:"xrl8fj"})})}),a==="start"&&e(ge,{to:"/",class:"button plain",children:e(I,{icon:"home",size:"l",alt:s({id:"i0qMbr"})})})]}),e("h1",{children:a!=="start"&&e(f,{id:"wyL/3/",components:{0:e("sup",{})}})}),e("div",{class:"header-side",children:a!=="start"&&a!=="loading"&&e("button",{type:"button",class:"plain",onClick:()=>{D(!0)},children:e(f,{id:"c3XJ18"})})})]})}),e("main",{onKeyDown:Oe,children:[a==="start"&&e("div",{class:"catchup-start",children:[e("h1",{children:e(f,{id:"wyL/3/",components:{0:e("sup",{})}})}),e("details",{children:[e("summary",{children:e(f,{id:"CxKPv6"})}),e("p",{children:e(f,{id:"YMU1CK"})}),e("img",{src:Gl,width:"1200",height:"900",alt:s({id:"CeInO2"})}),e("p",{children:e("button",{type:"button",onClick:L=>{L.target.closest("details").open=!1},children:e(f,{id:"2jI8hh"})})})]}),e("p",{children:e(f,{id:"1RfGk7"})}),e("p",{children:e("b",{children:e(f,{id:"OOEonE"})})}),e("div",{class:"catchup-form",children:[e("input",{ref:C,type:"range",value:$,min:ht[0].value,max:ht[ht.length-1].value,step:"1",list:"catchup-ranges",onChange:L=>K(+L.target.value)})," ",e("span",{style:{width:"8em"},children:[i(ht[$-1].label),e("br",{}),e("small",{class:"insignificant",children:$==ht[ht.length-1].value?s({id:"NMNiaO"}):ct(new Date(Date.now()-$*60*60*1e3))})]}),e("datalist",{id:"catchup-ranges",children:ht.map(({label:L,value:G})=>e("option",{value:G,label:i(L)}))})," ",e("button",{type:"button",onClick:()=>{var L;if($<ht[ht.length-1].value){let G;$===ht[ht.length-1].value&&((L=T.current)!=null&&L.checked)?G=Date.now()-R:G=$*60*60*1e3,k({duration:G})}else k()},children:e(f,{id:"R0yu2l"})})]}),me&&$>me?e("p",{class:"catchup-info",children:[e(I,{icon:"info"})," ",e(f,{id:"AGyV7s"})]}):$===ht[ht.length-1].value&&R?e("p",{class:"catchup-info",children:e("label",{children:[e("input",{type:"checkbox",switch:!0,checked:!0,ref:T})," ",e(f,{id:"dDJEHI",values:{0:o.format(new Date(R))}})]})}):null,e("p",{class:"insignificant",children:e("small",{children:e(f,{id:"EAjFM0"})})}),!!(O!=null&&O.length)&&e("div",{class:"catchup-prev",children:[e("p",{children:e(f,{id:"Yfb9A8"})}),e("ul",{children:O.map(L=>e("li",{children:[e(ge,{to:`/catchup?id=${L.id}`,children:[e(I,{icon:"history2"})," ",e("span",{children:L.startAt?o.formatRange(new Date(L.startAt),new Date(L.endAt)):`… – ${o.format(new Date(L.endAt))}`})]})," ",e("span",{children:[e("small",{class:"ib insignificant",children:e(f,{id:"S6XZwv",values:{0:L.count}})})," ",e("button",{type:"button",class:"light danger small",onClick:async()=>{var ae;if(confirm(s({id:"D9CmP2"}))){let ie=fe(s({id:"xJUo4P",values:{0:L.id}}));await gt.catchup.del(L.id),(ae=ie==null?void 0:ie.hideToast)==null||ae.call(ie),fe(s({id:"1dyGG/",values:{0:L.id}})),E()}},children:e(I,{icon:"x",alt:s({id:"t/YqKh"})})})]})]},L.id))}),O.length>=3&&e("p",{children:e("small",{children:e(f,{id:"sXmrl4"})})})]})]}),a==="loading"&&e("div",{class:"ui-state catchup-start",children:[e(Be,{abrupt:!0}),e("p",{class:"insignificant",children:e(f,{id:"rbUTzD"})}),e("p",{class:"insignificant",children:e(f,{id:"q9urQO"})})]}),a==="results"&&e(U,{children:[e("div",{class:"catchup-header",children:[m.length>0&&e("p",{children:e("b",{class:"ib",children:o.formatRange(new Date(m[0].createdAt),new Date(m[m.length-1].createdAt))})}),e("aside",{children:[e("button",{hidden:Y==="all"&&!B&&j==="createdAt"&&J==="asc",type:"button",class:"plain4 small",onClick:()=>{Z("all"),ee(null),te("createdAt"),ne(null),ue("asc")},children:e(f,{id:"I9EnzM"})}),(X==null?void 0:X.length)>0&&e("button",{type:"button",class:"plain small",onClick:()=>g(!p),children:[e(f,{id:"EIZREX"})," ",e(I,{icon:"chevron-down",style:{transform:p?"rotate(180deg)":"rotate(0deg)"}})]})]})]}),e("div",{class:"shazam-container no-animation",hidden:!p,children:e("div",{class:"shazam-container-inner",children:e("div",{class:"catchup-top-links links-bar",children:X.map(L=>{const{card:G,shared:ae,sharers:ie,likes:z,boosts:be}=L,{blurhash:ve,title:_e,description:Ze,url:Fe,image:de,imageDescription:Ue,language:Ke,width:nt,height:Re,publishedAt:He}=G,at=$s(Fe);let Nt;if(ve){const Pt=yi(ve),st=Ri(Pt);Nt=Ei([.6,st[1],st[2]])}return e("a",{href:Fe,target:"_blank",rel:"noopener",class:"link-block",style:Nt?{"--accent-color":`rgb(${Nt.join(",")})`,"--accent-alpha-color":`rgba(${Nt.join(",")}, 0.4)`}:{},children:e("article",{children:[e("figure",{children:e("img",{src:de,alt:Ue,width:nt,height:Re,loading:"lazy"})}),e("div",{class:"article-body",children:[e("header",{children:[e("div",{class:"article-meta",children:[e("span",{class:"domain",children:at})," ",!!He&&e(U,{children:"· "}),!!He&&e(U,{children:e(_t,{datetime:He,format:"micro"})})]}),!!_e&&e("h1",{class:"title",lang:Ke,dir:"auto",title:_e,children:_e})]}),!!Ze&&e("p",{class:"description",lang:Ke,dir:"auto",title:Ze,children:Ze}),e("hr",{}),e("p",{style:{whiteSpace:"nowrap"},children:e(f,{id:"bfSr6z",values:{0:ie.map(Pt=>{const{avatarStatic:st,displayName:Kn}=Pt;return e("button",{type:"button",class:"plain",style:{padding:0},onClick:$i=>{$i.preventDefault(),$i.stopPropagation();const{id:So}=Pt;ee(So),Z("all")},children:e(mt,{url:st,size:"s",alt:Kn})})})}})})]})]})},Fe)})})})}),m.length>=5&&(ke==="3d"?e("div",{class:"catchup-posts-viz-time-bar",children:xe}):e("div",{class:"catchup-posts-viz-bar",children:De})),m.length>=2&&e("div",{class:"catchup-filters",children:[e("label",{class:"filter-cat",children:[e("input",{type:"radio",name:"filter-cat",checked:Y.toLowerCase()==="all",onChange:()=>{Z("all")}}),e(f,{id:"N40H+G"})," ",e("span",{class:"count",children:m.length})]}),Object.entries(Zl).map(([L,G])=>!!V[L]&&e("label",{class:"filter-cat",title:(V[L]/m.length*100).toFixed(2)+"%",children:[e("input",{type:"radio",name:"filter-cat",checked:Y.toLowerCase()===L.toLowerCase(),onChange:()=>{Z(L),L==="boosts"&&(te("reblogsCount"),ue("desc"),ne(null))}}),i(G)," ",e("span",{class:"count",children:V[L]})]},i(G)))]}),m.length>=2&&!!se&&e("div",{class:"catchup-filters authors-filters",ref:Ee,children:[Ie.map(L=>e("label",{class:"filter-author","data-author":L,children:[e("input",{type:"radio",name:"filter-author",checked:B===L,onChange:()=>{ee(L)},onClick:()=>{B===L&&ee(null)}}),e(mt,{url:Ce[L].avatarStatic||Ce[L].avatar,size:"xxl",alt:`${Ce[L].displayName} (@${Ce[L].acct})`})," ",e("span",{class:"count",children:se[L]}),e("span",{class:"username",children:Ce[L].username})]},`${L}-${se[L]}`)),Ie.length>5&&e("small",{style:{whiteSpace:"nowrap",paddingInline:"1em",opacity:.33},children:e(f,{id:"HHtYi7",values:{0:Ie.length}})},"authors-count")]}),m.length>=2&&e("div",{class:"catchup-filters",children:[e("span",{class:"filter-label",children:e(f,{id:"f6Hub0"})})," ",e("fieldset",{class:"radio-field-group",children:Xl.map(L=>e("label",{class:"filter-sort",onClick:G=>{j===L&&(G.preventDefault(),G.stopPropagation(),ue(J==="asc"?"desc":"asc"))},children:[e("input",{type:"radio",name:"filter-sort-cat",checked:j===L,onChange:()=>{te(L);const G=/(replies|favourites|reblogs)/.test(L)?"desc":"asc";ue(G)}}),{createdAt:s({id:"mYGY3B"}),repliesCount:s({id:"N8UzTV"}),favouritesCount:s({id:"zZOZj7"}),reblogsCount:s({id:"puY2t0"}),density:s({id:"0tQ7AD"})}[L],j===L&&(J==="asc"?" ↑":" ↓")]},L))}),e("span",{class:"filter-label",children:e(f,{id:"group.filter"})})," ",e("fieldset",{class:"radio-field-group",children:Jl.map(L=>e("label",{class:"filter-group",children:[e("input",{type:"radio",name:"filter-group",checked:he===L,onChange:()=>{ne(L)},disabled:L==="account"&&B}),{account:s({id:"dpqPBg"})}[L]||s({id:"EdQY6l"})]},L||"none"))}),B&&Ie.length>1?e("button",{type:"button",class:"plain6 small",onClick:()=>{ee(null)},style:{whiteSpace:"nowrap"},children:e(f,{id:"/dlmrZ"})}):null]}),e("ul",{class:`catchup-list catchup-filter-${Y||""} ${j?`catchup-sort-${j}`:""} ${B&&Ce[B]?"catchup-selected-author":""} ${he?`catchup-group-${he}`:""}`,children:Pe.map((L,G)=>{var z;const ae=((z=L.reblog)==null?void 0:z.id)||L.id;let ie=!1;return he==="account"&&($e.current&&L.account.id!==$e.current&&G>0&&(ie=!0),$e.current=L.account.id),e(U,{children:[ie&&e("li",{class:"separator"}),e(nr,{to:`/${l}/s/${ae}`,post:L,root:Me.current})]},`${L.id}-${ie}`)})}),e("footer",{children:we.length>5&&e("p",{children:[s(Y==="boosts"?{id:"eVosYr"}:{id:"rhmyFK"})," ",e("button",{type:"button",class:"textual",onClick:()=>{Me.current.scrollTop=0},children:e(f,{id:"0MgdN+"})}),"."]})})]})]})]}),N&&e(qe,{onClose:()=>D(!1),children:e("div",{class:"sheet",id:"catchup-help-sheet",children:[e("button",{type:"button",class:"sheet-close",onClick:()=>D(!1),children:e(I,{icon:"x",alt:s({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(f,{id:"c3XJ18"})})}),e("main",{children:e("dl",{children:[e("dt",{children:e(f,{id:"EIZREX"})}),e("dd",{children:e(f,{id:"YmGrIy"})}),e("dt",{children:e(f,{id:"coaNtr"})}),e("dd",{children:e(f,{id:"UUrqX1"})}),e("dt",{children:e(f,{id:"ScQBC/"})}),e("dd",{children:e(f,{id:"srocAr"})}),e("dt",{children:e(f,{id:"77Emn0"})}),e("dd",{children:e("table",{children:e("tbody",{children:[e("tr",{children:[e("td",{children:e(f,{id:"Gy9P9T"})}),e("td",{children:e("kbd",{children:"j"})})]}),e("tr",{children:[e("td",{children:e(f,{id:"6XYpYY"})}),e("td",{children:e("kbd",{children:"k"})})]}),e("tr",{children:[e("td",{children:e(f,{id:"f5dduh"})}),e("td",{children:e("kbd",{children:"l"})})]}),e("tr",{children:[e("td",{children:e(f,{id:"rj0vxZ"})}),e("td",{children:e("kbd",{children:"h"})})]}),e("tr",{children:[e("td",{children:e(f,{id:"jsFF8C"})}),e("td",{children:e("kbd",{children:"Enter"})})]}),e("tr",{children:[e("td",{children:e(f,{id:"bUUv3P"})}),e("td",{children:e("kbd",{children:"."})})]})]})})})]})})]})})]})}const tr=ut(function({post:n}){const{id:i,account:s,group:o,reblog:c,inReplyToId:l,inReplyToAccountId:u,_followedTags:r,_filtered:d,visibility:a,__BOOSTERS:h}=n,p=l&&u!==s.id,g=!!d&&(d==null?void 0:d.action)!=="blur",y=b=>{b.shiftKey};return e("article",{class:`post-line ${o?"group":c?"reblog":r!=null&&r.length?"followed-tags":""} ${p?"reply-to":""} ${g?"filtered":""} visibility-${a}`,onMouseEnter:y,children:[e("span",{class:"post-author",children:c?e("span",{class:"post-reblog-avatar",children:[e(mt,{url:s.avatarStatic||s.avatar,squircle:s.bot}),(h==null?void 0:h.size)>0?[...h].map(b=>e(mt,{url:b.avatarStatic||b.avatar,squircle:b.bot})):""," ",e(I,{icon:"rocket"})," ",e(yt,{account:c.account,showAvatar:!0})]}):e(yt,{account:s,showAvatar:!0})}),e(or,{post:c||n,filterInfo:d}),e("span",{class:"post-meta",children:[e(cr,{post:c||n})," ",e(_t,{datetime:new Date((c==null?void 0:c.createdAt)||n.createdAt),format:"micro"})]})]})},(n,i)=>{var s,o;return((s=n==null?void 0:n.post)==null?void 0:s.id)===((o=i==null?void 0:i.post)==null?void 0:o.id)}),nr=({root:n,to:i,...s})=>{const o=q(),[c,l]=M(!1);return Q(()=>{const u=new IntersectionObserver(r=>{r[0].isIntersecting&&(queueMicrotask(()=>l(!0)),u.unobserve(o.current))},{root:n,rootMargin:`${Math.max(320,screen.height*.75)}px`});return o.current&&u.observe(o.current),()=>{o.current&&u.unobserve(o.current)}},[]),c?e("li",{children:e(ge,{to:i,children:e(tr,{...s})})}):e("li",{ref:o,style:{height:"4em"}})},ir=8,sr=8;function os(n){var d;const{spoilerText:i,content:s,poll:o,mediaAttachments:c,card:l}=n,u=(d=o==null?void 0:o.options)!=null&&d.length?o.options.reduce((a,h)=>a+h.title,""):"";return(i.length+Ns(s)+u.length)/140+(c!=null&&c.length?ir*c.length:l!=null&&l.image?sr:0)}const xt=48;function or({post:n,filterInfo:i}){var T;const{_:s}=re(),{spoilerText:o,sensitive:c,content:l,emojis:u,poll:r,mediaAttachments:d,card:a,inReplyToId:h,inReplyToAccountId:p,account:g,_thread:y}=n,b=h&&p===g.id||!!y,v=!!di()["reading:expand:spoilers"],m=v||!o&&!c&&(i==null?void 0:i.action)!=="blur",S=l?Pn(n):"",C=!o||v;return e("div",{class:"post-peek",title:o?"":S,children:[e("span",{class:"post-peek-content",children:[b&&!C&&e(U,{children:[e("span",{class:"post-peek-tag post-peek-thread",children:"Thread"})," "]}),i&&(i==null?void 0:i.action)!=="blur"?e("span",{class:"post-peek-filtered",children:i!=null&&i.titlesStr?s({id:"suKjh3",values:{0:i.titlesStr}}):s({id:"03Qqf9"})}):e(U,{children:[!!o&&e("span",{class:"post-peek-spoiler",children:[e(I,{icon:`${v?"eye-open":"eye-close"}`})," ",o]}),C&&e("div",{class:"post-peek-html",children:[b&&e(U,{children:[e("span",{class:"post-peek-tag post-peek-thread",children:e(f,{id:"e66y2Z"})})," "]}),!!l&&e("div",{dangerouslySetInnerHTML:{__html:nc(l,u)}}),!!((T=r==null?void 0:r.options)!=null&&T.length)&&r.options.map(A=>e("div",{children:[r.multiple?"▪️":"•"," ",A.title]})),!l&&(d==null?void 0:d.length)===1&&d[0].description&&e(U,{children:[e("span",{class:"post-peek-tag post-peek-alt",children:"ALT"})," ",e("div",{children:d[0].description})]})]})]})]}),(!i||(i==null?void 0:i.action)==="blur")&&e("span",{class:"post-peek-post-content",children:[!!r&&e("span",{class:"post-peek-tag post-peek-poll",children:[e(I,{icon:"poll",size:"s"}),e(f,{id:"4WUbF1"})]}),d!=null&&d.length?d.map(A=>{var F,O,W,V,X,Y,Z,B,ee,$;const k=A.previewUrl||A.url,_=A.previewRemoteUrl||A.remoteUrl,E=(F=A.meta)!=null&&F.original?A.meta.original.width:((W=(O=A.meta)==null?void 0:O.small)==null?void 0:W.width)||((X=(V=A.meta)==null?void 0:V.original)==null?void 0:X.width),R=(Y=A.meta)!=null&&Y.original?A.meta.original.height:((B=(Z=A.meta)==null?void 0:Z.small)==null?void 0:B.height)||(($=(ee=A.meta)==null?void 0:ee.original)==null?void 0:$.height);return e("span",{class:"post-peek-media",children:{image:(k||_)&&m?e("img",{src:k,width:xt,height:xt,alt:A.description,loading:"lazy",onError:K=>{const{src:j}=K.target;j===k&&(K.target.src=_)},style:{"--anim-duration":`${Math.min(Math.max(Math.max(E,R)/100,5),120)}s`}}):e("span",{class:"post-peek-faux-media",children:"🖼"}),gifv:(k||_)&&m?e("img",{src:k,width:xt,height:xt,alt:A.description,loading:"lazy",onError:K=>{const{src:j}=K.target;j===k&&(K.target.src=_)}}):e("span",{class:"post-peek-faux-media",children:"🎞️"}),video:(k||_)&&m?e("img",{src:k,width:xt,height:xt,alt:A.description,loading:"lazy",onError:K=>{const{src:j}=K.target;j===k&&(K.target.src=_)}}):e("span",{class:"post-peek-faux-media",children:"📹"}),audio:e("span",{class:"post-peek-faux-media",children:"🎵"})}[A.type]||null},A.id)}):!!a&&a.image&&m&&e("span",{class:`post-peek-media post-peek-card card-${a.type||""}`,children:a.image?e("img",{src:a.image,width:xt,height:xt,alt:a.title||a.description||a.imageDescription,loading:"lazy",style:{"--anim-duration":a.width&&a.height&&`${Math.min(Math.max(Math.max(a.width,a.height)/100,5),120)}s`}}):e("span",{class:"post-peek-faux-media",children:"🔗"})})]})]})}function cr({post:n}){const{_:i}=re(),{reblogsCount:s,repliesCount:o,favouritesCount:c}=n;return e("span",{class:"post-stats",children:[o>0&&e("span",{class:"post-stat-replies",children:[e(I,{icon:"comment2",size:"s",alt:i({id:"N8UzTV"})})," ",Qe(o)]}),c>0&&e("span",{class:"post-stat-likes",children:[e(I,{icon:"heart",size:"s",alt:i({id:"zZOZj7"})})," ",Qe(c)]}),s>0&&e("span",{class:"post-stat-boosts",children:[e(I,{icon:"rocket",size:"s",alt:i({id:"puY2t0"})})," ",Qe(s)]})]})}function ar(n,i,s){const o=n.map(d=>new Date(d[i])),c=o.reduce((d,a)=>a<d?a:d,o[0]),l=o.reduce((d,a)=>a>d?a:d,o[0]),u=Math.min(l.getTime(),Date.now())-c.getTime(),r=Array.from({length:s},()=>[]);return n.forEach(d=>{const a=new Date(d[i]);if(a.getTime()>Date.now())r[r.length-1].push(d);else{const h=(a.getTime()-c.getTime())/u,p=Math.floor(h*(s-1));r[p].push(d)}}),r}const lr=20;function no(){const{_:n}=re();tt(n({id:"zZOZj7"}),"/favourites");const{masto:i,instance:s}=le(),o=q();async function c(l){return(l||!o.current)&&(o.current=i.v1.favourites.list({limit:lr}).values()),await o.current.next()}return e(At,{title:n({id:"zZOZj7"}),id:"favourites",emptyText:n({id:"PHIrMr"}),errorText:n({id:"khVljG"}),instance:s,fetchItems:c})}const rr=["home","public","notifications","thread","account"],cs=["thread","account"],dr={home:{id:"Buy2bt"},notifications:{id:"iDNBZe"},public:{id:"RO10dm"},thread:{id:"EnJuK0"},account:{id:"vrQQgz"}},ur=[0,30*60,60*60,6*60*60,12*60*60,60*60*24,60*60*24*7,60*60*24*30],Jn={0:{id:"qqeAJM"},1800:ot(30,"minute"),3600:ot(1,"hour"),21600:ot(6,"hour"),43200:ot(12,"hour"),86400:ot(24,"hour"),604800:ot(7,"day"),2592e3:ot(30,"day")};function hr(){const{_:n}=re(),{masto:i}=le();tt(n({id:"cSev+j"}),"/ft");const[s,o]=M("default"),[c,l]=M(!1),[u,r]=Lt(h=>h+1,0),[d,a]=M([]);return Q(()=>{o("loading"),(async()=>{try{const h=await i.v2.filters.list();h.sort((p,g)=>p.title.localeCompare(g.title)),h.forEach(p=>{var g;(g=p.keywords)!=null&&g.length&&p.keywords.sort((y,b)=>y.id-b.id)}),a(h),o("default")}catch{o("error")}})()},[u]),e("div",{id:"filters-page",class:"deck-container",tabIndex:"-1",children:[e("div",{class:"timeline-deck deck",children:[e("header",{children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e($t,{}),e(ge,{to:"/",class:"button plain",children:e(I,{icon:"home",size:"l",alt:n({id:"i0qMbr"})})})]}),e("h1",{children:e(f,{id:"cSev+j"})}),e("div",{class:"header-side",children:e("button",{type:"button",class:"plain",onClick:()=>{l(!0)},children:e(I,{icon:"plus",size:"l",alt:n({id:"yFfBdX"})})})})]})}),e("main",{children:d.length>0?e(U,{children:[e("ul",{class:"filters-list",children:d.map(h=>{const{id:p,title:g,expiresAt:y,keywords:b}=h;return e("li",{children:[e("div",{children:[e("h2",{children:g}),(b==null?void 0:b.length)>0&&e("div",{children:b.map(w=>e(U,{children:[e("span",{class:"tag collapsed insignificant",children:w.wholeWord?`“${w.keyword}”`:w.keyword})," "]}))}),e("small",{class:"insignificant",children:e(io,{expiresAt:y})})]}),e("button",{type:"button",class:"plain",onClick:()=>{l({filter:h})},children:e(I,{icon:"pencil",size:"l",alt:"Edit filter"})})]},p)})}),d.length>1&&e("footer",{class:"ui-state",children:e("small",{class:"insignificant",children:e(f,{id:"5vzJxv",values:{0:d.length}})})})]}):s==="loading"?e("p",{class:"ui-state",children:e(Be,{})}):s==="error"?e("p",{class:"ui-state",children:e(f,{id:"qcAUwp"})}):e("p",{class:"ui-state",children:e(f,{id:"cWIHTt"})})})]}),!!c&&e(qe,{title:n({id:"vCSBPD"}),onClose:()=>{l(!1)},children:e(mr,{filter:c==null?void 0:c.filter,onClose:h=>{h.state==="success"&&r(),l(!1)}})})]})}let fr=1;const pr=()=>fr++;function mr({filter:n,onClose:i}){var E;const{_:s,_:o}=re(),{masto:c}=le(),[l,u]=M("default"),r=!!n,{context:d,expiresAt:a,id:h,keywords:p,title:g,filterAction:y}=n||{},b=!!a,w=b&&new Date(a),[v,m]=M(p||[]),S=q(),[C,T]=M([]),[A,k]=M([]),_=v.filter(R=>!C.includes(R.id)&&!A.includes(R._id));return e("div",{class:"sheet",id:"filters-add-edit-modal",children:[!!i&&e("button",{type:"button",class:"sheet-close",onClick:i,children:e(I,{icon:"x",alt:o({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:o(r?{id:"3mOee6"}:{id:"yFfBdX"})})}),e("main",{children:e("form",{onSubmit:R=>{R.preventDefault();const F=new FormData(R.target),O=F.get("title"),W=F.getAll("keyword_attributes[][id]"),V=F.getAll("keyword_attributes[][keyword]"),X=[...S.current.querySelectorAll('input[name="keyword_attributes[][whole_word]"]')].map($=>$.checked),Y=V.map(($,K)=>({id:W[K]||void 0,keyword:$,wholeWord:X[K]}));r&&(C!=null&&C.length)&&C.forEach($=>{Y.push({id:$,_destroy:!0})});const Z=F.getAll("context");let B=F.get("expires_in");const ee=F.get("filter_action");!O||!(Z!=null&&Z.length)||(u("loading"),(async()=>{try{let $;r?(B===""||B===null?b?B=Math.floor((w-new Date)/1e3):B=null:B==="0"||B===0?B=null:B=+B,$=await c.v2.filters.$select(h).update({title:O,context:Z,expiresIn:B,keywordsAttributes:Y,filterAction:ee})):(B=+B||null,$=await c.v2.filters.create({title:O,context:Z,expiresIn:B,keywordsAttributes:Y,filterAction:ee})),u("default"),i==null||i({state:"success",filter:$})}catch{u("error"),alert(o(r?{id:"H8RP+h"}:{id:"Fr0hAN"}))}})())},children:[e("div",{class:"filter-form-row",children:e("label",{children:[e("b",{children:e(f,{id:"MHrjPM"})}),e("input",{type:"text",name:"title",defaultValue:g,disabled:l==="loading",dir:"auto",required:!0})]})}),e("div",{class:"filter-form-keywords",ref:S,children:[_.length?e("ul",{class:"filter-keywords",children:_.map(R=>{const{id:F,keyword:O,wholeWord:W,_id:V}=R;return e("li",{children:[e("input",{type:"hidden",name:"keyword_attributes[][id]",value:F}),e("input",{name:"keyword_attributes[][keyword]",type:"text",defaultValue:O,disabled:l==="loading",required:!0,dir:"auto"}),e("div",{class:"filter-keyword-actions",children:[e("label",{children:[e("input",{name:"keyword_attributes[][whole_word]",type:"checkbox",value:F,defaultChecked:W,disabled:l==="loading"})," ",e(f,{id:"/7UQ7y"})]}),e("button",{type:"button",class:"light danger small",disabled:l==="loading",onClick:()=>{F?(C.push(F),T([...C])):V&&(A.push(V),k([...A]))},children:e(I,{icon:"x",alt:o({id:"t/YqKh"})})})]})]},`${F}-${V}`)})}):e("div",{class:"filter-keywords",children:e("div",{class:"insignificant",children:e(f,{id:"SYKm3p"})})}),e("footer",{class:"filter-keywords-footer",children:[e("button",{type:"button",class:"light",onClick:()=>{m([...v,{_id:pr(),keyword:"",wholeWord:!0}]),setTimeout(()=>{var F,O;const R=S.current.querySelectorAll('input[type="text"]');(O=(F=R[R.length-1])==null?void 0:F.focus)==null||O.call(F)},10)},children:e(f,{id:"qn5Dbn"})})," ",(_==null?void 0:_.length)>1&&e("small",{class:"insignificant",children:e(f,{id:"1JZ175",values:{0:_.length}})})]})]}),e("div",{class:"filter-form-cols",children:[e("div",{class:"filter-form-col",children:[e("div",{children:e("b",{children:e(f,{id:"uqf7Yq"})})}),rr.map(R=>e("div",{children:[e("label",{class:cs.includes(R)?"insignificant":"",children:[e("input",{type:"checkbox",name:"context",value:R,defaultChecked:d?d.includes(R):!0,disabled:l==="loading"})," ",s(dr[R]),cs.includes(R)?"*":""]})," "]})),e("p",{children:e("small",{class:"insignificant",children:e(f,{id:"m0G499"})})})]}),e("div",{class:"filter-form-col",children:[r&&e(f,{id:"ucJk3m",components:{0:e("b",{}),1:e(io,{expiresAt:a,showNeverExpires:!0})}}),e("div",{children:[e("label",{for:"filters-expires_in",children:o(r?{id:"BcNdg+"}:{id:"agO/T/"})}),e("select",{id:"filters-expires_in",name:"expires_in",disabled:l==="loading",defaultValue:r?void 0:0,children:[r&&e("option",{}),ur.map(R=>e("option",{value:R,children:typeof Jn[R]=="function"?Jn[R]():s(Jn[R])}))]})]}),e("p",{children:[e(f,{id:"blQMpa"}),e("br",{}),((E=ui())==null?void 0:E.mastodon)>=5&&e("label",{class:"ib",children:[e("input",{type:"radio",name:"filter_action",value:"blur",defaultChecked:y==="blur",disabled:l==="loading"})," ",e(f,{id:"ggxOw9"})]})," ",e("label",{class:"ib",children:[e("input",{type:"radio",name:"filter_action",value:"warn",defaultChecked:y!=="hide"&&y!=="blur"||!r,disabled:l==="loading"})," ",e(f,{id:"jbreWy"})]})," ",e("label",{class:"ib",children:[e("input",{type:"radio",name:"filter_action",value:"hide",defaultChecked:y==="hide",disabled:l==="loading"})," ",e(f,{id:"zNCBmf"})]})]})]})]}),e("footer",{class:"filter-form-footer",children:[e("span",{children:[e("button",{type:"submit",disabled:l==="loading",children:o(r?{id:"tfDRzk"}:{id:"hYgDIe"})})," ",e(Be,{abrupt:!0,hidden:l!=="loading"})]}),r&&e(pt,{disabled:l==="loading",align:"end",menuItemClassName:"danger",confirmLabel:o({id:"BPjyR2"}),onClick:()=>{u("loading"),(async()=>{try{await c.v2.filters.$select(h).remove(),u("default"),i==null||i({state:"success"})}catch{u("error"),alert(o({id:"4Dh9J1"}))}})()},children:e("button",{type:"button",class:"light danger",onClick:()=>{},disabled:l==="loading",children:e(f,{id:"Jb6/SB"})})})]})]})})]})}function io({expiresAt:n,showNeverExpires:i}){const{_:s}=re(),o=!!n,c=o&&new Date(n),l=o&&c<=new Date,[u,r]=Lt(d=>d+1,0);return mi(r,l||3e4),l?s({id:"M1RnFv"}):o?e(f,{id:"urGtsw",components:{0:e(_t,{datetime:c})}}):i&&s({id:"O1Aswy"})}function gr(){const{_:n}=re(),{masto:i,instance:s}=le();tt(n({id:"Xi1/bw"}),"/fh");const[o,c]=M("default"),[l,u]=M([]);return Q(()=>{c("loading"),(async()=>{try{const r=await $n();u(r),c("default")}catch{c("error")}})()},[]),e("div",{id:"followed-hashtags-page",class:"deck-container",tabIndex:"-1",children:e("div",{class:"timeline-deck deck",children:[e("header",{children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e($t,{}),e(ge,{to:"/",class:"button plain",children:e(I,{icon:"home",size:"l",alt:n({id:"i0qMbr"})})})]}),e("h1",{children:e(f,{id:"Xi1/bw"})}),e("div",{class:"header-side"})]})}),e("main",{children:l.length>0?e(U,{children:[e("ul",{class:"link-list",children:l.map(r=>e("li",{children:e(ge,{to:s?`/${s}/t/${r.name}`:`/t/${r.name}`,children:[e(I,{icon:"hashtag",alt:"#"})," ",e("span",{children:r.name})]})}))}),l.length>1&&e("footer",{class:"ui-state",children:e("small",{class:"insignificant",children:e(f,{id:"2S/uvJ",values:{0:l.length}})})})]}):o==="loading"?e("p",{class:"ui-state",children:e(Be,{abrupt:!0})}):o==="error"?e("p",{class:"ui-state",children:e(f,{id:"2AeREO"})}):e("p",{class:"ui-state",children:e(f,{id:"vKsGhk"})})})]})})}const yr=20;function Mi({title:n,path:i,id:s,...o}){const{_:c}=re();tt(n||c({id:"following.title"}),i||"/following");const{masto:l,streaming:u,instance:r}=le(),d=We(x),a=q(),h=q(),p=q();__BENCHMARK.end("time-to-following");const g=Je("@pixelfed/home-include-reblogs");async function y(w){var S;(w||!h.current)&&(__BENCHMARK.start("fetch-home-first"),a.current=l.v1.timelines.home.list({limit:yr}),h.current=a.current.values()),g&&((S=a.current)!=null&&S.params)&&(typeof a.current.params=="string"?a.current.params+="&include_reblogs=true":a.current.params.include_reblogs=!0);const v=await h.current.next();let{value:m}=v;if(m!=null&&m.length){let C=!1;w&&(m[0].id!==p.current&&(C=!0),p.current=m[0].id),m.forEach(T=>{et(T,r)}),m=ns(m,r),w&&C&&El(),eo(m,r),m.sort((T,A)=>{const k=new Date(T.createdAt);return new Date(A.createdAt)-k})}return __BENCHMARK.end("fetch-home-first"),{...v,value:m}}async function b(){var w;try{const v={limit:5,since_id:p.current};Je("@pixelfed/home-include-reblogs")&&(v.include_reblogs=!0);const m=await l.v1.timelines.home.list(v).values().next();let{value:S}=m;const C=((w=S[0])==null?void 0:w.id)===p.current;return!!(S!=null&&S.length&&!C&&(p.current=S[0].id,S=ns(S,r),S=zt(S,"home"),S.some(T=>!T.reblog)))}catch{return!1}}return Q(()=>{let w;return(async()=>{if(u){w=u.user.subscribe();for await(const v of w){if(!w)break;if(v.event==="status.update"){const m=v.payload;et(m,r)}else if(v.event==="delete"){const m=v.payload,S=_s(m,r);S&&(S._deleted=!0)}}}})(),()=>{var v;(v=w==null?void 0:w.unsubscribe)==null||v.call(w),w=null}},[u]),e(At,{title:n||c({id:"following.title"}),id:s||"following",emptyText:c({id:"nJEKbY"}),errorText:c({id:"7QSeK6"}),instance:r,fetchItems:y,checkForUpdates:b,useItemID:!0,boostsCarousel:d.settings.boostsCarousel,...o,filterContext:"home",showFollowedTags:!0,showReplyParent:!0})}const br=20,vr=4,as=vr+1;function so({media:n,columnMode:i,...s}){const{_:o}=re();let{hashtag:c,...l}=i?{}:Mt();s.hashtag&&(c=s.hashtag);let u=c.trim().split(/[\s+]+/);u.sort(),c=u[0];const[r,d]=vt(),a=n||!!r.get("media"),h=a?"?media=1":"",{masto:p,instance:g,authenticated:y}=le({instance:(s==null?void 0:s.instance)||l.instance}),{masto:b,instance:w,authenticated:v}=le(),m=u.map($=>`#${$}`).join(" "),S=o(g?a?{id:"kH0rA0",values:{hashtagTitle:m,instance:g}}:{id:"IK0zKi",values:{hashtagTitle:m,instance:g}}:a?{id:"hHSI3w",values:{hashtagTitle:m}}:{id:"+ZzjRY",values:{hashtagTitle:m}});tt(S,"/:instance?/t/:hashtag");const C=q(),T=Ae(()=>fi(),[]),A=q(void 0);async function k($){const K=await p.v1.timelines.tag.$select(c).list({limit:br,any:u.slice(1),maxId:$?void 0:A.current,onlyMedia:a?!0:void 0}).values().next();let{value:j}=K;return j!=null&&j.length&&($&&(C.current=j[0].id),j.forEach(te=>{et(te,g,{skipThreading:a||T})}),A.current=j[j.length-1].id),{...K,value:j}}async function _(){var $;try{const K=await p.v1.timelines.tag.$select(c).list({limit:1,any:u.slice(1),since_id:C.current,onlyMedia:a}).values().next();let{value:j}=K;const te=(($=j[0])==null?void 0:$.id)===C.current;return j!=null&&j.length&&!te?(j=zt(j,"public"),!0):!1}catch{return!1}}const[E,R]=M("default"),[F,O]=M();Q(()=>{(async()=>{try{const $=await p.v1.tags.$select(c).fetch();O($)}catch{}})()},[c]);const W=u.length>=as,[V,X]=M("default"),[Y,Z]=M([]),[B,ee]=M(!1);return Q(()=>{y&&(async()=>{try{const $=await p.v1.featuredTags.list();Z($),ee($.some(K=>K.name.toLowerCase()===c.toLowerCase()))}catch{}})()},[]),e(U,{children:[e(At,{title:S,titleComponent:!!g&&e("h1",{class:"header-double-lines",children:[e("b",{dir:"auto",children:m}),e("div",{children:g})]}),id:"hashtag",instance:g,emptyText:o({id:"CNSLAW"}),errorText:o({id:"yjj6Ll"}),fetchItems:k,checkForUpdates:_,useItemID:!0,view:a||T?"media":void 0,refresh:a,filterContext:"public",headerEnd:e(dt,{portal:!0,setDownOverflow:!0,overflow:"auto",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(I,{icon:"more",size:"l",alt:o({id:"2FYpfJ"})})}),children:[!!F&&u.length===1&&e(U,{children:[e(pt,{subMenu:!0,confirm:F.following,confirmLabel:o({id:"ctJi7k",values:{hashtag:c}}),disabled:E==="loading"||!y,onClick:()=>{R("loading"),F.following?p.v1.tags.$select(c).unfollow().then(()=>{O({...F,following:!1}),fe(o({id:"doK/ij",values:{hashtag:c}}))}).catch($=>{alert($)}).finally(()=>{R("default")}):p.v1.tags.$select(c).follow().then(()=>{O({...F,following:!0}),fe(o({id:"R9+aEN",values:{hashtag:c}}))}).catch($=>{alert($)}).finally(()=>{R("default")})},children:F.following?e(U,{children:[e(I,{icon:"check-circle"})," ",e("span",{children:e(f,{id:"HOSk7R"})})]}):e(U,{children:[e(I,{icon:"plus"})," ",e("span",{children:e(f,{id:"MKEPCY"})})]})}),e(ye,{type:"checkbox",checked:B,disabled:V==="loading"||!y,onClick:()=>{if(X("loading"),B){const $=Y.find(K=>K.name.toLowerCase()===c.toLowerCase()).id;$?p.v1.featuredTags.$select($).remove().then(()=>{ee(!1),fe(o({id:"VH+Tf9"})),Z(Y.filter(K=>K.id!==$))}).catch(K=>{}).finally(()=>{X("default")}):fe(o({id:"3OLv47"}))}else p.v1.featuredTags.create({name:c}).then($=>{ee(!0),fe(o({id:"9ra4hn"})),Z(Y.concat($))}).catch($=>{}).finally(()=>{X("default")})},children:B?e(U,{children:[e(I,{icon:"check-circle"}),e("span",{children:e(f,{id:"9ra4hn"})})]}):e(U,{children:[e(I,{icon:"check-circle"}),e("span",{children:e(f,{id:"UlJ3QN"})})]})}),e(Ve,{})]}),!T&&e(U,{children:[e(bi,{className:"plain",children:e(f,{id:"cSev+j"})}),e(ye,{type:"checkbox",checked:!!a,onClick:()=>{a?r.delete("media"):r.set("media","1"),d(r)},children:[e(I,{icon:"check-circle",alt:"☑️"})," ",e("span",{class:"menu-grow",children:e(f,{id:"eK4SL/"})})]}),e(Ve,{})]}),e(ic,{className:"menu-field",disabled:W,children:({ref:$})=>e("form",{onSubmit:K=>{var te,J;K.preventDefault();const j=(J=(te=K.target[0].value)==null?void 0:te.trim)==null?void 0:J.call(te);j&&!u.some(ue=>ue.toLowerCase()===j.toLowerCase())&&(u.push(j),u.sort(),location.hash=g?`/${g}/t/${u.join("+")}${h}`:`/t/${u.join("+")}${h}`)},children:[e(I,{icon:"hashtag"}),e("input",{ref:$,type:"text",placeholder:W?pe._({id:"ouWc/D",values:{TOTAL_TAGS_LIMIT:as}}):o({id:"cxL5F9"}),required:!0,autocorrect:"off",autocapitalize:"off",spellCheck:!1,pattern:"[^#][^\\s#]+[^#]",disabled:W,dir:"auto"})]})}),e(sc,{takeOverflow:!0,children:u.map(($,K)=>e(ye,{disabled:u.length===1,onClick:j=>{u.splice(K,1),u.sort(),location.hash=g?`/${g}/t/${u.join("+")}${h}`:`/t/${u.join("+")}${h}`},children:[e(I,{icon:"x",alt:o({id:"OISAkj"}),class:"danger-icon"}),e("span",{class:"bidi-isolate",children:[e("span",{class:"more-insignificant",children:"#"}),$]})]},$))}),e(Ve,{}),e(ye,{disabled:!v,onClick:()=>{if(x.shortcuts.length>=It){alert(pe._({id:"XN1xAY",values:{SHORTCUTS_LIMIT:It}}));return}const $={type:"hashtag",hashtag:u.join(" "),instance:g,media:a?"on":void 0};x.shortcuts.some(j=>j.type===$.type&&j.hashtag.split(/[\s+]+/).sort().join(" ")===$.hashtag.split(/[\s+]+/).sort().join(" ")&&(j.instance?j.instance===$.instance:!0)&&(j.media?!!j.media==!!$.media:!0))?alert(o({id:"kfeQnS"})):(x.shortcuts.push($),fe(o({id:"MIhb91"})))},children:[e(I,{icon:"shortcut"})," ",e("span",{children:e(f,{id:"i02Lq/"})})]}),e(ye,{onClick:()=>{let $=prompt(o({id:"2MQ2cd"}));if(!/\./.test($)){$&&alert(o({id:"7WddtO"}));return}$&&($=$.toLowerCase().trim(),location.hash=`/${$}/t/${u.join("+")}${h}`)},children:[e(I,{icon:"bus"})," ",e("span",{children:e(f,{id:"Sq04Yc"})})]}),w!==g&&e(ye,{onClick:()=>{location.hash=`/${w}/t/${u.join("+")}${h}`},children:[e(I,{icon:"bus"})," ",e("small",{class:"menu-double-lines",children:e(f,{id:"iAzCp4",values:{currentInstance:w},components:{0:e("b",{})}})})]})]})},g+m),!i&&!!(u!=null&&u.length)&&e("data",{class:"compose-data",value:JSON.stringify({draftStatus:{status:`${u.length>1?`

`:" "}${m}`}})})]})}const wr=20;function oo(n){var S;const{_:i}=re(),s=We(x),{masto:o,instance:c}=le(),l=(n==null?void 0:n.id)||((S=Mt())==null?void 0:S.id),u=q(),r=q();async function d(C){(C||!r.current)&&(r.current=o.v1.timelines.list.$select(l).list({limit:wr}).values());const T=await r.current.next();let{value:A}=T;return A!=null&&A.length&&(C&&(u.current=A[0].id),A.forEach(k=>{et(k,c)})),{...T,value:A}}async function a(){var C;try{const T=await o.v1.timelines.list.$select(l).list({limit:1,since_id:u.current});let{value:A}=T;const k=((C=A[0])==null?void 0:C.id)===u.current;return A!=null&&A.length&&!k?(A=zt(A,"home"),!0):!1}catch{return!1}}const[h,p]=M([]),[g,y]=M({title:"List"});tt(g.title,"/l/:id"),Q(()=>{(async()=>{try{const C=await js(l);y(C)}catch{}})()},[l]);const[b,w]=M(!1),[v,m]=M(!1);return e(U,{children:[e(At,{title:g.title,id:"list",emptyText:i({id:"KkDhfU"}),errorText:i({id:"7QSeK6"}),instance:c,fetchItems:d,checkForUpdates:a,useItemID:!0,boostsCarousel:s.settings.boostsCarousel,filterContext:"home",showReplyParent:!0,headerStart:e(dt,{overflow:"auto",menuButton:e("button",{type:"button",class:"plain",children:[e(I,{icon:"list",size:"l",alt:i({id:"h16FyT"})}),e(I,{icon:"chevron-down",size:"s"})]}),onMenuChange:C=>{C.open&&hn().then(p)},children:[e(je,{to:"/l",children:e("span",{children:e(f,{id:"BHWx+g"})})}),(h==null?void 0:h.length)>0&&e(U,{children:[e(Ve,{}),h.map(C=>e(je,{to:`/l/${C.id}`,children:e("span",{children:[C.title,C.exclusive&&e(U,{children:[" ",e(Bt,{})]})]})},C.id))]})]}),headerEnd:e(dt,{portal:!0,setDownOverflow:!0,overflow:"auto",viewScroll:"close",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(I,{icon:"more",size:"l",alt:i({id:"2FYpfJ"})})}),children:[(g==null?void 0:g.exclusive)&&e(U,{children:[e(bi,{className:"plain",children:[e(Bt,{})," ",e(f,{id:"FNptcJ"})]}),e(Ve,{})]}),e(ye,{onClick:()=>w({list:g}),children:[e(I,{icon:"pencil",size:"l"}),e("span",{children:e(f,{id:"ePK91l"})})]}),e(ye,{onClick:()=>m(!0),children:[e(I,{icon:"group",size:"l"}),e("span",{children:e(f,{id:"hB02vO"})})]})]})},l),b&&e(qe,{onClick:C=>{C.target===C.currentTarget&&w(!1)},children:e(xi,{list:b==null?void 0:b.list,onClose:C=>{C.state==="success"&&C.list?y(C.list):C.state==="deleted"&&(location.hash="/l"),w(!1)}})}),v&&e(qe,{onClick:C=>{C.target===C.currentTarget&&m(!1)},children:e(Sr,{listID:l,onClose:()=>m(!1)})})]})}const kr=40;function Sr({listID:n,onClose:i}){const{_:s}=re(),{masto:o,instance:c}=le(),[l,u]=M([]),[r,d]=M("default"),[a,h]=M(!1),p=q();async function g(y){h(!1),d("loading"),(async()=>{try{(y||!p.current)&&(p.current=o.v1.lists.$select(n).accounts.list({limit:kr}).values());const b=await p.current.next();let{done:w,value:v}=b;v!=null&&v.length?(u(y?v:l.concat(v)),h(!w)):h(!1),d("default")}catch{d("error")}})()}return Q(()=>{g(!0)},[]),e("div",{class:"sheet",id:"list-manage-members-container",children:[!!i&&e("button",{type:"button",class:"sheet-close",onClick:i,children:e(I,{icon:"x",alt:s({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(f,{id:"hB02vO"})})}),e("main",{children:e("ul",{children:[l.map(y=>e("li",{children:[e(ft,{account:y,instance:c}),e(_r,{account:y,listID:n})]},y.id)),a&&r==="default"&&e(Tt,{as:"li",onChange:y=>y&&g(),children:e("button",{type:"button",class:"light block",onClick:g,children:e(f,{id:"uXRAkV"})})})]})})]})}function _r({account:n,listID:i}){const{_:s}=re(),{masto:o}=le(),[c,l]=M("default"),[u,r]=M(!1);return e(pt,{confirm:!u,confirmLabel:e("span",{children:e(f,{id:"j5n9Ry",values:{0:n.username},components:{0:e("span",{class:"bidi-isolate"})}})}),align:"end",menuItemClassName:"danger",onClick:()=>{u?(l("loading"),(async()=>{try{await o.v1.lists.$select(i).accounts.create({accountIds:[n.id]}),l("default"),r(!1)}catch{l("error")}})()):(l("loading"),(async()=>{try{await o.v1.lists.$select(i).accounts.remove({accountIds:[n.id]}),l("default"),r(!0)}catch{l("error")}})())},children:e("button",{type:"button",class:`light ${u?"":"danger"}`,disabled:c==="loading",children:s(u?{id:"m16xKo"}:{id:"MWIaew"})})})}const Cr={mention:["account","status"],status:["account","status"],reblog:["account","status"],follow:["account"],follow_request:["account"],favourite:["account","status"],poll:["status"],update:["status"]},Ir=["favourite","reblog","follow"],co=n=>Ir.includes(n);function ao(n){return n.filter(i=>{const{type:s,id:o,createdAt:c}=i;if(!s)return!1;const l=Cr[s];return l!=null&&l.length?l.every(u=>!!i[u]):!0})}function lo(n){if(n!=null&&n.notificationGroups){const{accounts:i=[],notificationGroups:s=[],statuses:o=[]}=n;return s.map(c=>{const{sampleAccountIds:l,statusId:u}=c,r=(l==null?void 0:l.map(a=>i.find(h=>h.id===a)))||[],d=(o==null?void 0:o.find(a=>a.id===u))||null;return{...c,sampleAccounts:r,status:d}})}return n}function Tr(n){const i=n.map(u=>{const{latestPageNotificationAt:r,mostRecentNotificationId:d,sampleAccounts:a,notificationsCount:h}=u;return{id:""+d,createdAt:r,account:a[0],...u}}),s={},o=[];for(let u=0;u<i.length;u++){const r=i[u],{type:d,status:a,createdAt:h,notificationsCount:p,sampleAccounts:g,groupKey:y}=r,b=h?new Date(h).toLocaleDateString():"";let w=d;!(p>0&&(g==null?void 0:g.length)>0&&p>(g==null?void 0:g.length))&&(d==="favourite"||d==="reblog")&&(w="favourite+reblog");const m=`${a==null?void 0:a.id}-${w}-${b}`,S=s[m];if(!co(d))o.push(r);else if(S)g.forEach(C=>{const T=S.sampleAccounts.find(A=>A.id===C.id);T?(T._types.push(d),T._types.sort().reverse()):S.sampleAccounts.push({...C,_types:[d]})}),S.notificationsCount=Math.min(S.notificationsCount,p),S._notificationsCount.push(p),S._sampleAccountsCount.push(g==null?void 0:g.length),S._accounts=S.sampleAccounts,S._groupKeys.push(y);else{const C=g.map(T=>({...T,_types:[d]}));s[m]={...r,sampleAccounts:C,type:w,_accounts:C,_groupKeys:y?[y]:[],_notificationsCount:[p],_sampleAccountsCount:[g==null?void 0:g.length]},o.push(s[m])}}const c={},l=[];for(let u=0;u<o.length;u++){const r=o[u],{type:d,account:a,_accounts:h,sampleAccounts:p,createdAt:g,groupKey:y}=r,b=g?new Date(g).toLocaleDateString():"",w=(p==null?void 0:p.length)===1||(h==null?void 0:h.length)===1;if((d==="favourite"||d==="reblog"||d==="favourite+reblog")&&w){const v=`${a==null?void 0:a.id}-${d}-${b}`,m=c[v];if(m)m._statuses.push(r.status),m._ids+=`-${r.id}`,m._groupKeys.push(y);else{let S=c[v]={...r,type:d,_ids:r.id,_statuses:[r.status],_groupKeys:y?[y]:[]};l.push(S)}}else l.push(r)}return l}function Ar(n){n=ao(n);const i={},s=[];for(let l=0,u=0;l<n.length;l++){const r=n[l],{id:d,status:a,account:h,type:p,createdAt:g}=r,y=g?new Date(g).toLocaleDateString():"";let b=p;(p==="favourite"||p==="reblog")&&(b="favourite+reblog");const w=`${a==null?void 0:a.id}-${b}-${y}`,v=i[w];if(!co(p))s[u++]=r;else if(v!=null&&v.account){const m=v._accounts.find(S=>S.id===h.id);m?(m._types.push(p),m._types.sort().reverse(),v._ids+=`-${d}`):(h._types=[p],v._accounts.push(h),v._ids+=`-${d}`)}else{h&&(h._types=[p]);let m=i[w]={...r,type:b,_ids:d,_accounts:h?[h]:[]};s[u++]=m}}const o={},c=[];for(let l=0,u=0;l<s.length;l++){const r=s[l],{id:d,account:a,_accounts:h,type:p,createdAt:g}=r,y=g?new Date(g).toLocaleDateString():"";if(p==="favourite+reblog"&&a&&h.length===1){const b=`${a==null?void 0:a.id}-${p}-${y}`,w=o[b];if(w)w._statuses.push(r.status),w._ids+=`-${d}`;else{let v=o[b]={...r,type:p,_ids:d,_statuses:[r.status]};c[u++]=v}}else c[u++]=r}return c}const ls=20,xr=new URLSearchParams;function ro({columnMode:n,...i}){const{_:s}=re(),{masto:o,instance:c}=le(),[l]=n?[xr]:vt(),[u,r]=M(null),d=(i==null?void 0:i.type)||l.get("type")||u;tt(s(d==="private"?{id:"2BApYc"}:{id:"/bZzdR"}),"/mentions");const a=q(),h=q();async function p(S){(S||!a.current)&&(a.current=o.v1.notifications.list({limit:ls,types:["mention"]}).values());const C=await a.current.next();let{value:T}=C;return T!=null&&T.length&&(T=ao(T),S&&(h.current=T[0].id),T.forEach(({status:A})=>{et(A,c)})),{...C,value:T==null?void 0:T.map(A=>A.status)}}const g=q(),y=q();async function b(S){(S||!g.current)&&(g.current=o.v1.conversations.list({limit:ls}).values());const C=await g.current.next();let{value:T}=C;return T=T==null?void 0:T.filter(A=>A.lastStatus),T!=null&&T.length&&(S&&(y.current=T[0].lastStatus.id),T.forEach(({lastStatus:A})=>{et(A,c)})),{...C,value:T==null?void 0:T.map(A=>A.lastStatus)}}function w(...S){return d==="private"?b(...S):p(...S)}async function v(){var S;if(d==="private")try{const C=await o.v1.conversations.list({limit:1,since_id:y.current}).values().next();let{value:T}=C;const A=((S=T[0])==null?void 0:S.id)===y.current;return T!=null&&T.length&&!A?(y.current=T[0].lastStatus.id,!0):!1}catch{return!1}else try{const C=await o.v1.notifications.list({limit:1,types:["mention"],since_id:h.current}).values().next();let{value:T}=C;return T!=null&&T.length?(h.current=T[0].id,!0):!1}catch{return!1}}const m=Ae(()=>e("div",{class:"filter-bar centered",children:[e(ge,{to:"/mentions",class:d?"":"is-active",onClick:S=>{n&&(S.preventDefault(),r(null))},children:e(f,{id:"N40H+G"})}),e(ge,{to:"/mentions?type=private",class:d==="private"?"is-active":"",onClick:S=>{n&&(S.preventDefault(),r("private"))},children:e(f,{id:"zwBp5t"})})]}),[d]);return e(At,{title:s({id:"/bZzdR"}),id:"mentions",emptyText:s({id:"03jFGT"}),errorText:s({id:"pqR9KF"}),instance:c,fetchItems:w,checkForUpdates:v,useItemID:!0,timelineStart:m,refresh:d,filterContext:"notifications"})}const Er=80,Rr=20,Lr=new URLSearchParams,pn={block:"center",inline:"center",behavior:"smooth"},uo=Ss(()=>{var n;return((n=ui())==null?void 0:n.mastodon)>=2},{maxAge:1e3*60*5});function ho(n={}){const{masto:i}=le();return x.settings.groupedNotificationsAlpha&&uo()?i.v2.notifications.list({limit:Rr,...n}):i.v1.notifications.list({limit:Er,...n})}function fo(n={}){return ho(n).values()}function po(n){return x.settings.groupedNotificationsAlpha&&uo()?Tr(n):Ar(n)}const Mr=["forNotFollowing","forNotFollowers","forNewAccounts","forPrivateMentions","forLimitedAccounts"],$r={forNotFollowing:{id:"d+hDoa"},forNotFollowers:{id:"oAwuQj"},forNewAccounts:{id:"Srs8u7"},forPrivateMentions:{id:"IDC5Uw"},forLimitedAccounts:{id:"XMGM2e"}};function Nr({columnMode:n}){var Le;const{_:i,_:s}=re();tt(s({id:"iDNBZe"}),"/notifications");const{masto:o,instance:c}=le(),l=We(x),[u,r]=M("default"),[d]=n?[Lr]:vt(),a=d.get("id"),h=d.get("access_token"),[p,g]=M(!1),[y,b]=M(!1),w=q(),{nearReachEnd:v,scrollDirection:m,reachStart:S,nearReachStart:C}=Rl({scrollableRef:w}),T=m==="end"&&!C,[A,k]=M([]),[_,E]=M([]),R=q(),F=q();async function O(P){var Ne;if((P||!F.current)&&(R.current=ho({excludeTypes:["follow_request"]}),F.current=R.current.values()),/max_id=($|&)/i.test((Ne=F.current)==null?void 0:Ne.nextParams))return{done:!0};const ce=await F.current.next(),Se=lo(ce.value);if(Se!=null&&Se.length){Se.forEach(L=>{et(L.status,c,{skipThreading:!0})});const Oe=po(Se);P?(x.notificationsLast=Oe[0],x.notifications=Oe,o.v1.markers.create({notifications:{lastReadId:Oe[0].id}}).catch(()=>{})):x.notifications.push(...Oe)}return x.notificationsShowNew=!1,x.notificationsLastFetchTime=Date.now(),ce}async function W(){try{return await o.v1.followRequests.list({limit:80})}catch{return[]}}const V=()=>{r("loading"),(async()=>{try{const P=await W();k(P),r("default")}catch{r("error")}})()};async function X(){try{return await o.v1.announcements.list()}catch{return[]}}const Y=Je("@mastodon/filtered-notifications"),[Z,B]=M(!1),[ee,$]=M({});function K(){return o.v2.notifications.policy.fetch().catch(()=>{})}function j(){K().then(P=>{$(P)}).catch(()=>{})}const[te,J]=M(null);function ue(){return o.v1.notifications.requests.list()}const he=P=>{we(!1),r("loading"),(async()=>{try{const ce=O(P);P&&(X().then(Ne=>{Ne.sort((Oe,L)=>{const G=new Date(Oe.updatedAt||Oe.createdAt);return new Date(L.updatedAt||L.createdAt)-G}),E(Ne)}).catch(()=>{}),W().then(Ne=>{k(Ne)}).catch(()=>{}),Y&&j());const{done:Se}=await ce;g(!Se),r("default")}catch{r("error")}})()};Q(()=>{he(!0)},[]),Q(()=>{S&&he(!0)},[S]);const[ne,we]=M(!1),Ce=it(({disableIdleCheck:P=!1}={})=>{var ce;u!=="loading"&&l.settings.autoRefresh&&((ce=w.current)==null?void 0:ce.scrollTop)<16&&(P||window.__IDLE__)&&!Pr()&&he(!0)},[l.notificationsShowNew,l.settings.autoRefresh,u]),se=q();Gt(P=>{if(P){const ce=Date.now()-se.current;!se.current||ce>1e3*3?Ce({disableIdleCheck:!0}):se.current=Date.now()}});const Te=q(!0);Q(()=>{let P=No(x,"notificationsShowNew",ce=>{if(Te.current){Te.current=!1;return}u!=="loading"&&(ce&&Ce(),we(ce))});return()=>P==null?void 0:P()},[]);const Ie=new Date,Pe=new Date(Ie-24*60*60*1e3);let $e=new Date;const Ee=!l.notifications.some(P=>new Date(P.createdAt).toDateString()===Ie.toDateString()),H=q();Q(()=>{a&&(x.routeNotification={id:a,accessToken:atob(h)})},[a,h]);const[ke,De]=M(null);Q(async()=>{var Ne,Oe,L;const P=new Date;if(P.getMonth()!==11||!Je("@mastodon/annual-report"))return;let ce=ze.account.get("annualReportNotification");if(ce){De(ce);return}const Se=fo({types:["annual_report"]});try{const G=await Se.next();ce=(Oe=(Ne=G==null?void 0:G.value)==null?void 0:Ne.notificationGroups)==null?void 0:Oe[0],((L=ce==null?void 0:ce.annualReport)==null?void 0:L.year)==P.getFullYear()&&(De(ce),ze.account.set("annualReportNotification",ce))}catch{}},[]);const xe=".notification",Me=Ye("j",()=>{const P=document.activeElement.closest(xe),ce=P==null?void 0:P.getBoundingClientRect(),Se=Array.from(w.current.querySelectorAll(xe));if(P&&ce.top<w.current.clientHeight&&ce.bottom>0){const Ne=Se.indexOf(P);let Oe=Se[Ne+1];Oe&&(Oe.focus(),Oe.scrollIntoView(pn))}else{const Ne=Se.find(Oe=>{const L=Oe.getBoundingClientRect();return L.top>=44&&L.left>=0});Ne&&(Ne.focus(),Ne.scrollIntoView(pn))}},{useKey:!0,ignoreEventWhen:P=>P.metaKey||P.ctrlKey||P.altKey||P.shiftKey}),me=Ye("k",()=>{const P=document.activeElement.closest(xe),ce=P==null?void 0:P.getBoundingClientRect(),Se=Array.from(w.current.querySelectorAll(xe));if(P&&ce.top<w.current.clientHeight&&ce.bottom>0){const Ne=Se.indexOf(P);let Oe=Se[Ne-1];Oe&&(Oe.focus(),Oe.scrollIntoView(pn))}else{const Ne=Se.find(Oe=>{const L=Oe.getBoundingClientRect();return L.top>=44&&L.left>=0});Ne&&(Ne.focus(),Ne.scrollIntoView(pn))}},{useKey:!0,ignoreEventWhen:P=>P.metaKey||P.ctrlKey||P.altKey||P.shiftKey}),N=Ye(["enter","o"],()=>{const P=document.activeElement.closest(xe),ce=P==null?void 0:P.querySelector(".status-link");ce&&ce.click()},{useKey:!0,ignoreEventWhen:P=>P.metaKey||P.ctrlKey||P.altKey||P.shiftKey}),D=new Date,oe=Ae(()=>ct(D,{forceOpts:{weekday:"long"}}),[D]);return e("div",{id:"notifications-page",class:"deck-container",ref:P=>{w.current=P,Me.current=P,me.current=P,N.current=P},tabIndex:"-1",children:[e("div",{class:`timeline-deck deck ${y?"only-mentions":""}`,children:[e("header",{hidden:T,onClick:P=>{var ce;P.target.closest("a, button")||(ce=w.current)==null||ce.scrollTo({top:0,behavior:"smooth"})},onDblClick:P=>{P.target.closest("a, button")||he(!0)},class:u==="loading"?"loading":"",children:[e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e($t,{}),e(ge,{to:"/",class:"button plain",children:e(I,{icon:"home",size:"l",alt:s({id:"i0qMbr"})})})]}),e("h1",{children:e(f,{id:"iDNBZe"})}),e("div",{class:"header-side",children:Y&&e("button",{type:"button",class:"button plain4",onClick:()=>{B(!0)},children:e(I,{icon:"settings",size:"l",alt:s({id:"a/+arl"})})})})]}),ne&&u!=="loading"&&e("button",{class:"updates-button shiny-pill",type:"button",onClick:()=>{var P;he(!0),(P=w.current)==null||P.scrollTo({top:0,behavior:"smooth"})},children:[e(I,{icon:"arrow-up"})," ",e(f,{id:"Jy9RU/"})]})]}),_.length>0&&e("div",{class:"shazam-container",children:e("div",{class:"shazam-container-inner",children:e("details",{class:"announcements",children:[e("summary",{children:[e("span",{children:[e(I,{icon:"announce",class:"announcement-icon",size:"l"})," ",e(f,{id:"0whvLM",values:{0:_.length}})," ",e("small",{class:"insignificant",children:c})]}),_.length>1&&e("span",{class:"announcements-nav-buttons",children:_.map((P,ce)=>e("button",{type:"button",class:"plain2 small",onClick:()=>{var Se;(Se=H.current)==null||Se.children[ce].scrollIntoView({behavior:"smooth",block:"nearest"})},children:ce+1}))})]}),e("ul",{class:`announcements-list-${_.length>1?"multiple":"single"}`,ref:H,children:_.map(P=>e("li",{children:e(Dr,{announcement:P})}))})]})})}),A.length>0&&e("div",{class:"follow-requests",children:[e("h2",{class:"timeline-header",children:e(f,{id:"6Fs1Ba"})}),A.length>5?e("details",{children:[e("summary",{children:e(f,{id:"7dHKu4",values:{0:A.length}})}),e("ul",{children:A.map(P=>e("li",{children:[e(ft,{account:P}),e(oi,{accountID:P.id,onChange:()=>{}})]},P.id))})]}):e("ul",{children:A.map(P=>e("li",{children:[e(ft,{account:P}),e(oi,{accountID:P.id,onChange:()=>{}})]},P.id))})]}),Y&&((Le=ee==null?void 0:ee.summary)==null?void 0:Le.pendingRequestsCount)>0&&e("div",{class:"shazam-container",children:e("div",{class:"shazam-container-inner",children:e("div",{class:"filtered-notifications",children:e("details",{onToggle:async P=>{const{open:ce}=P.target;if(ce){const Se=await ue();J(Se)}},children:[e("summary",{children:e(f,{id:"N3Bq0f",values:{0:ee.summary.pendingRequestsCount}})}),te?(te==null?void 0:te.length)>0&&e("ul",{children:te.map(P=>{var ce,Se;return e("li",{children:[e("div",{class:"request-notifcations",children:[!((ce=P.lastStatus)!=null&&ce.id)&&e(ft,{useAvatarStatic:!0,showStats:!0,account:P.account}),((Se=P.lastStatus)==null?void 0:Se.id)&&e("div",{class:"last-post",children:e(ge,{class:"status-link",to:`/${c}/s/${P.lastStatus.id}`,children:e(Ge,{status:P.lastStatus,size:"s",readOnly:!0})})}),e(zr,{request:P})]}),e(Ur,{request:P,onChange:()=>{he(!0)}})]},P.id)})}):e("p",{class:"ui-state",children:e(Be,{abrupt:!0})})]})})})}),ke&&e("div",{class:"shazam-container",children:e("div",{class:"shazam-container-inner",children:e(rn,{notification:ke})})}),e("div",{id:"mentions-option",children:e("label",{children:[e("input",{type:"checkbox",checked:y,onChange:P=>{b(P.target.checked)}})," ",e(f,{id:"0udtPI"})]})}),e("h2",{class:"timeline-header",children:[e(f,{id:"ecUA8p"})," ",e("small",{class:"insignificant bidi-isolate",children:oe})]}),Ee&&e("p",{class:"ui-state insignificant",children:u==="default"?s({id:"KS7iJH"}):e(U,{children:"…"})}),l.notifications.length?e(On.Provider,{value:"notifications",children:l.notifications.filter(P=>P.type!=="follow_request").map(P=>{if(y&&P.type!=="mention")return null;const ce=new Date(P.createdAt),Se=ce.toDateString()!==$e.toDateString();Se&&($e=ce);const Ne=ce.toDateString()===Pe.toDateString()?s({id:"y/0uwd"}):ct($e,{hideTime:!0}),Oe=ct($e,{forceOpts:{weekday:"long"}});return e(U,{children:[Se&&e("h2",{class:"timeline-header",children:[e("span",{children:Ne})," ",e("small",{class:"insignificant bidi-isolate",children:Oe})]}),e(rn,{instance:c,notification:P},P._ids||P.id)]},P._ids||P.id)})}):e(U,{children:[u==="loading"&&e(U,{children:e("ul",{class:"timeline flat",children:Array.from({length:5}).map((P,ce)=>e("li",{class:"notification skeleton",children:[e("div",{class:"notification-type",children:e(I,{icon:"notification",size:"xl"})}),e("div",{class:"notification-content",children:e("p",{children:"███████████ ████"})})]}))})}),u==="error"&&e("p",{class:"ui-state",children:[e(f,{id:"gjzl8E"}),e("br",{}),e("br",{}),e("button",{type:"button",onClick:()=>he(!0),children:e(f,{id:"KDw4GX"})})]})]}),p&&e(Tt,{onChange:P=>{P&&he()},children:e("button",{type:"button",class:"plain block",disabled:u==="loading",onClick:()=>he(),style:{marginBlockEnd:"6em"},children:u==="loading"?e(Be,{abrupt:!0}):e(f,{id:"uXRAkV"})})})]}),Y&&Z&&e(qe,{onClick:P=>{P.target===P.currentTarget&&B(!1)},children:e("div",{class:"sheet",id:"notifications-settings",tabIndex:"-1",children:[e("button",{type:"button",class:"sheet-close",onClick:()=>B(!1),children:e(I,{icon:"x",alt:s({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(f,{id:"a/+arl"})})}),e("main",{children:e("form",{onSubmit:P=>{P.preventDefault();const{forNotFollowing:ce,forNotFollowers:Se,forNewAccounts:Ne,forPrivateMentions:Oe,forLimitedAccounts:L}=P.target,G={...ee,forNotFollowing:ce.value,forNotFollowers:Se.value,forNewAccounts:Ne.value,forPrivateMentions:Oe.value,forLimitedAccounts:L.value};$(G),B(!1),(async()=>{try{await o.v2.notifications.policy.update(G),fe(s({id:"4+7X9i"}))}catch{}})()},children:[e("p",{children:e(f,{id:"WrkPTf"})}),e("div",{class:"notification-policy-fields",children:Mr.map(P=>{const ce=ee[P];return e("div",{children:e("label",{children:[i($r[P]),e("select",{name:P,defaultValue:ce,class:"small",children:[e("option",{value:"accept",children:e(f,{id:"g3UF2V"})}),e("option",{value:"filter",children:e(f,{id:"o7J4JM"})}),e("option",{value:"drop",children:e(f,{id:"gbbkE7"})})]})]})},P)})}),e("p",{children:e("button",{type:"submit",children:e(f,{id:"tfDRzk"})})})]})})]})})]})}function Pr(){return!!document.querySelector(".deck-backdrop, #modal-container > *")}function Dr({announcement:n}){const{instance:i}=le(),{contact:s}=vs(),o=s==null?void 0:s.account,{id:c,content:l,startsAt:u,endsAt:r,published:d,allDay:a,publishedAt:h,updatedAt:p,read:g,mentions:y,statuses:b,tags:w,emojis:v,reactions:m}=n,S=new Date(h),C=ct(S),T=new Date(p),A=ct(T);return e("div",{class:"announcement-block",children:[e(ft,{account:o}),e("div",{class:"announcement-content",onClick:Es({mentions:y,instance:i}),dangerouslySetInnerHTML:{__html:ei(l,{emojis:v})}}),e("p",{class:"insignificant",children:[e("time",{datetime:S.toISOString(),children:ct(S)}),p&&A!==C&&e(U,{children:[" ","•"," ",e("span",{class:"ib",children:e(f,{id:"TbFrLc",values:{0:ct(T)},components:{0:e("time",{datetime:T.toISOString()})}})})]})]}),e("div",{class:"announcement-reactions",hidden:!0,children:m.map(k=>{const{name:_,count:E,me:R,staticUrl:F,url:O}=k;return e("button",{type:"button",class:`plain4 small ${R?"reacted":""}`,children:[O||F?e("img",{src:O||F,alt:_,width:"16",height:"16"}):e("span",{children:_})," ",e("span",{class:"count",children:Qe(E)})]})})})]})}function Or(n){const{masto:i}=le();return i.v1.notifications.list({accountID:n})}function zr({request:n}){var p;const{instance:i}=le(),[s,o]=M("loading"),{account:c,lastStatus:l}=n,[u,r]=M(!1),[d,a]=M([]);function h(){r(!1)}return Q(()=>{var g;(g=n==null?void 0:n.account)!=null&&g.id&&u&&(o("loading"),(async()=>{const y=await Or(n.account.id);a(y||[]),o("default")})())},[u,(p=n==null?void 0:n.account)==null?void 0:p.id]),e(U,{children:[e("button",{type:"button",class:"plain4 request-notifications-account",onClick:()=>{r(!0)},children:[e(I,{icon:"notification",class:"more-insignificant"})," ",e("small",{children:e(f,{id:"H0wUNM",values:{0:c.username},components:{0:e("span",{class:"bidi-isolate"})}})})," ",e(I,{icon:"chevron-down"})]}),u&&e(qe,{onClick:g=>{g.target===g.currentTarget&&h()},children:e("div",{class:"sheet",tabIndex:"-1",children:[e("button",{type:"button",class:"sheet-close",onClick:h,children:e(I,{icon:"x",alt:t`Close`})}),e("header",{children:e("b",{children:e(f,{id:"MXOmPt",values:{0:c.username},components:{0:e("span",{class:"bidi-isolate"})}})})}),e("main",{children:s==="loading"?e("p",{class:"ui-state",children:e(Be,{abrupt:!0})}):d.map(g=>e("div",{class:"notification-peek",onClick:y=>{const{target:b}=y;(y.target.tagName==="BUTTON"||y.target.tagName==="A")&&h()},children:e(rn,{instance:i,notification:g,isStatic:!0})}))})]})})]})}function Ur({request:n,onChange:i}){const{_:s}=re(),{masto:o}=le(),[c,l]=M("default"),[u,r]=M(null),d=u!==null;return e("p",{class:"notification-request-buttons",children:[e("button",{type:"button",disabled:c==="loading"||d,onClick:()=>{l("loading"),(async()=>{try{await o.v1.notifications.requests.$select(n.id).accept(),r("accept"),l("default"),i({request:n,state:"accept"}),fe(s({id:"ZtBMwU",values:{0:n.account.username}}))}catch{l("error"),fe(s({id:"S92JKG"}))}})()},children:e(f,{id:"h7peZQ"})})," ",e("button",{type:"button",disabled:c==="loading"||d,class:"light danger",onClick:()=>{l("loading"),(async()=>{try{await o.v1.notifications.requests.$select(n.id).dismiss(),r("dismiss"),l("default"),i({request:n,state:"dismiss"}),fe(s({id:"ibBDry",values:{0:n.account.username}}))}catch{l("error"),fe(s({id:"S5aemF"}))}})()},children:e(f,{id:"1QfxQT"})}),e("span",{class:"notification-request-states",children:c==="loading"?e(Be,{abrupt:!0}):u==="accept"?e(I,{icon:"check-circle",alt:s({id:"bzMKg7"}),class:"notification-accepted"}):u==="dismiss"&&e(I,{icon:"x-circle",alt:s({id:"J6hrEy"}),class:"notification-dismissed"})})]})}const mo=ut(Nr),Br=20;function ci({local:n,columnMode:i,...s}){const{_:o}=re(),c=We(x),l=!!n,u=i?{}:Mt(),{masto:r,instance:d}=le({instance:(s==null?void 0:s.instance)||u.instance}),{masto:a,instance:h}=le(),p=o(l?{id:"u96B/B",values:{instance:d}}:{id:"PgVqvd",values:{instance:d}});tt(p,l?"/:instance?/p/l":"/:instance?/p");const g=q(),y=q();async function b(v){if(v||!y.current){const C={limit:Br,local:l||void 0};!l&&Je("@pixelfed/global-feed")&&(C.remote=!0),y.current=r.v1.timelines.public.list(C).values()}const m=await y.current.next();let{value:S}=m;return S!=null&&S.length&&(v&&(g.current=S[0].id),S.forEach(C=>{et(C,d)})),{...m,value:S}}async function w(){var v;try{const m=await r.v1.timelines.public.list({limit:1,local:l,since_id:g.current}).values().next();let{value:S}=m;const C=((v=S[0])==null?void 0:v.id)===g.current;return S!=null&&S.length&&!C?(S=zt(S,"public"),!0):!1}catch{return!1}}return e(At,{title:p,titleComponent:e("h1",{class:"header-double-lines",children:[e("b",{children:o(l?{id:"pJQgQV"}:{id:"cg0I+x"})}),e("div",{children:d})]}),id:"public",instance:d,emptyText:o({id:"BiZJ6G"}),errorText:o({id:"scd9lw"}),fetchItems:b,checkForUpdates:w,useItemID:!0,headerStart:e(U,{}),boostsCarousel:c.settings.boostsCarousel,filterContext:"public",headerEnd:e(dt,{portal:!0,overflow:"auto",viewScroll:"close",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(I,{icon:"more",size:"l",alt:o({id:"2FYpfJ"})})}),children:[e(ye,{href:l?`/#/${d}/p`:`/#/${d}/p/l`,children:l?e(U,{children:[e(I,{icon:"transfer"})," ",e("span",{children:e(f,{id:"dXMiUw"})})]}):e(U,{children:[e(I,{icon:"transfer"})," ",e("span",{children:e(f,{id:"t2B/we"})})]})}),e(Ve,{}),e(ye,{onClick:()=>{let v=prompt(o({id:"2MQ2cd"}));if(!/\./.test(v)){v&&alert(o({id:"7WddtO"}));return}v&&(v=v.toLowerCase().trim(),location.hash=l?`/${v}/p/l`:`/${v}/p`)},children:[e(I,{icon:"bus"})," ",e("span",{children:e(f,{id:"Sq04Yc"})})]}),h!==d&&e(ye,{onClick:()=>{location.hash=l?`/${h}/p/l`:`/${h}/p`},children:[e(I,{icon:"bus"})," ",e("small",{class:"menu-double-lines",children:e(f,{id:"iAzCp4",values:{currentInstance:h},components:{0:e("b",{})}})})]})]})},d+l)}const mn=5,Qn=40,Fr=new URLSearchParams,gn={block:"nearest",inline:"center",behavior:"smooth"};function go({columnMode:n,...i}){const{_:s}=re(),o=n?{}:Mt(),{masto:c,instance:l,authenticated:u}=le({instance:o.instance}),[r,d]=M("default"),[a]=n?[Fr]:vt(),h=q(),p=(i==null?void 0:i.query)||a.get("q"),g=n?"statuses":(i==null?void 0:i.type)||a.get("type");let y=s({id:"A1taO8"});if(p)switch(g){case"statuses":y=s({id:"6YeoAt",values:{q:p}});break;case"accounts":y=s({id:"fpgumQ",values:{q:p}});break;case"hashtags":y=s({id:"AuiMZZ",values:{q:p}});break;default:y=s({id:"wr3GZI",values:{q:p}})}tt(y,"/search");const[b,w]=M(!1),v=q(0);Q(()=>{v.current=0},[p,g]);const m=q();St(()=>{var $,K;(K=($=m.current)==null?void 0:$.scrollTo)==null||K.call($,0,0)},[p,g]);const[S,C]=M([]),[T,A]=M([]),[k,_]=M([]);Q(()=>{C([]),A([]),_([])},[p]);const E={statuses:S,accounts:T,hashtags:k},R={statuses:C,accounts:A,hashtags:_},[F,O]=M({}),W=async $=>{if(!($!=null&&$.length))return;const K=await Dn($,F);K&&O({...F,...K})};function V($){$&&(v.current=0),!(!$&&!u)&&(d("loading"),$&&!g&&(C(S.slice(0,mn)),A(T.slice(0,mn)),_(k.slice(0,mn))),(async()=>{var j,te,J,ue,he,ne;const K={q:p,resolve:u,limit:mn};g&&(K.limit=Qn,K.type=g,u&&(K.offset=v.current));try{const we=await c.v2.search.list(K);if(g)if($){R[g](we[g]);const Ce=(j=we[g])==null?void 0:j.length;v.current=Qn,w(!!Ce)}else if(((J=(te=we[g])==null?void 0:te[0])==null?void 0:J.id)===((he=(ue=E[g])==null?void 0:ue[0])==null?void 0:he.id))w(!1);else{R[g](se=>[...se,...we[g]]);const Ce=(ne=we[g])==null?void 0:ne.length;v.current=v.current+Qn,w(!!Ce)}else C(we.statuses||[]),A(we.accounts||[]),_(we.hashtags||[]),v.current=0,w(!1);W(we.accounts),d("default")}catch{d("error")}})())}const X=q();Gt($=>{var j;const K=((j=m.current)==null?void 0:j.scrollTop)===0;if($&&K){const te=Date.now()-X.current;!X.current||te>1e3*3?V(!0):X.current=Date.now()}}),Q(()=>{var K,j;let $;return(j=(K=h.current)==null?void 0:K.setValue)==null||j.call(K,p||""),p?V(!0):$=setTimeout(()=>{var te,J;(J=(te=h.current)==null?void 0:te.focus)==null||J.call(te)},150),()=>clearTimeout($)},[p,g,l]),Ye(["Slash","/"],$=>{var K,j,te,J;(j=(K=h.current)==null?void 0:K.focus)==null||j.call(K),(J=(te=h.current)==null?void 0:te.select)==null||J.call(te)},{useKey:!0,preventDefault:!0,ignoreEventWhen:$=>$.metaKey||$.ctrlKey||$.altKey||$.shiftKey});const Y=".timeline > li > a, .hashtag-list > li > a",Z=Ye("j",()=>{const $=document.activeElement.closest(Y),K=$==null?void 0:$.getBoundingClientRect(),j=Array.from(m.current.querySelectorAll(Y));if($&&K.top<m.current.clientHeight&&K.bottom>0){const te=j.indexOf($);let J=j[te+1];J&&(J.focus(),J.scrollIntoView(gn))}else{const te=j.find(J=>{const ue=J.getBoundingClientRect();return ue.top>=44&&ue.left>=0});te&&(te.focus(),te.scrollIntoView(gn))}},{useKey:!0,ignoreEventWhen:$=>$.metaKey||$.ctrlKey||$.altKey||$.shiftKey}),B=Ye("k",()=>{const $=document.activeElement.closest(Y),K=$==null?void 0:$.getBoundingClientRect(),j=Array.from(m.current.querySelectorAll(Y));if($&&K.top<m.current.clientHeight&&K.bottom>0){const te=j.indexOf($);let J=j[te-1];J&&(J.focus(),J.scrollIntoView(gn))}else{const te=j.find(J=>{const ue=J.getBoundingClientRect();return ue.top>=44&&ue.left>=0});te&&(te.focus(),te.scrollIntoView(gn))}},{useKey:!0,ignoreEventWhen:$=>$.metaKey||$.ctrlKey||$.altKey||$.shiftKey}),[ee]=_i();return e("div",{id:"search-page",class:"deck-container",tabIndex:"-1",ref:$=>{m.current=$,Z.current=$,B.current=$},children:e("div",{class:"timeline-deck deck",children:[e("header",{class:r==="loading"?"loading":"",children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:e($t,{})}),e(Qs,{ref:h}),e("div",{class:"header-side",children:e("button",{type:"button",class:"plain",onClick:()=>{V(!0)},disabled:r==="loading",children:e(I,{icon:"search",size:"l",alt:s({id:"A1taO8"})})})})]})}),e("main",{children:[!!p&&!n&&e("div",{ref:ee,class:`filter-bar ${r==="loading"?"loading":""}`,children:[!!g&&e(ge,{to:`/search${p?`?q=${encodeURIComponent(p)}`:""}`,children:[e(I,{icon:"chevron-left"})," ",e(f,{id:"N40H+G"})]}),[{label:s({id:"bPwFdf"}),type:"accounts",to:`/search?q=${encodeURIComponent(p)}&type=accounts`},{label:s({id:"VwUsHI"}),type:"hashtags",to:`/search?q=${encodeURIComponent(p)}&type=hashtags`},{label:s({id:"+owNNn"}),type:"statuses",to:`/search?q=${encodeURIComponent(p)}&type=statuses`}].sort(($,K)=>$.type===g?-1:K.type===g?1:0).map($=>e(ge,{to:$.to,children:$.label},$.type))]}),p?e(U,{children:[(!g||g==="accounts")&&e(U,{children:[g!=="accounts"&&e("h2",{class:"timeline-header",children:[e(f,{id:"bPwFdf"})," ",e(ge,{to:`/search?q=${encodeURIComponent(p)}&type=accounts`,children:e(I,{icon:"arrow-right",size:"l",alt:s({id:"V1fa9u"})})})]}),T.length>0?e(U,{children:[e("ul",{class:"timeline flat accounts-list",children:T.map($=>e("li",{children:e(ft,{account:$,instance:l,showStats:!0,relationship:F[$.id]})},$.id))}),g!=="accounts"&&e("div",{class:"ui-state",children:e(ge,{class:"plain button",to:`/search?q=${encodeURIComponent(p)}&type=accounts`,children:[e(f,{id:"BMmtZ8"})," ",e(I,{icon:"arrow-right"})]})})]}):!g&&(r==="loading"?e("p",{class:"ui-state",children:e(Be,{abrupt:!0})}):e("p",{class:"ui-state",children:e(f,{id:"YYB61U"})}))]}),(!g||g==="hashtags")&&e(U,{children:[g!=="hashtags"&&e("h2",{class:"timeline-header",children:[e(f,{id:"VwUsHI"})," ",e(ge,{to:`/search?q=${encodeURIComponent(p)}&type=hashtags`,children:e(I,{icon:"arrow-right",size:"l",alt:s({id:"V1fa9u"})})})]}),k.length>0?e(U,{children:[e("ul",{class:"link-list hashtag-list",children:k.map($=>{var J;const{name:K,history:j}=$,te=(J=j==null?void 0:j.reduce)==null?void 0:J.call(j,(ue,he)=>ue+ +he.uses,0);return e("li",{children:e(ge,{to:l?`/${l}/t/${K}`:`/t/${K}`,children:[e(I,{icon:"hashtag",alt:"#"}),e("span",{children:K}),!!te&&e("span",{class:"count",children:Qe(te)})]})},`${K}-${te}`)})}),g!=="hashtags"&&e("div",{class:"ui-state",children:e(ge,{class:"plain button",to:`/search?q=${encodeURIComponent(p)}&type=hashtags`,children:[e(f,{id:"Nc/W5J"})," ",e(I,{icon:"arrow-right"})]})})]}):!g&&(r==="loading"?e("p",{class:"ui-state",children:e(Be,{abrupt:!0})}):e("p",{class:"ui-state",children:e(f,{id:"4MFM3P"})}))]}),(!g||g==="statuses")&&e(U,{children:[g!=="statuses"&&e("h2",{class:"timeline-header",children:[e(f,{id:"+owNNn"})," ",e(ge,{to:`/search?q=${encodeURIComponent(p)}&type=statuses`,children:e(I,{icon:"arrow-right",size:"l",alt:s({id:"V1fa9u"})})})]}),S.length>0?e(U,{children:[e("ul",{class:"timeline",children:S.map($=>e("li",{children:e(ge,{class:"status-link",to:l?`/${l}/s/${$.id}`:`/s/${$.id}`,children:e(Ge,{status:$})})},$.id))}),g!=="statuses"&&e("div",{class:"ui-state",children:e(ge,{class:"plain button",to:`/search?q=${encodeURIComponent(p)}&type=statuses`,children:[e(f,{id:"LYCgej"})," ",e(I,{icon:"arrow-right"})]})})]}):!g&&(r==="loading"?e("p",{class:"ui-state",children:e(Be,{abrupt:!0})}):e("p",{class:"ui-state",children:e(f,{id:"Hzi9AA"})}))]}),!!g&&(r==="default"?b?e(Tt,{onChange:$=>{$&&V()},children:e("button",{type:"button",class:"plain block",onClick:()=>V(),style:{marginBlockEnd:"6em"},children:e(f,{id:"uXRAkV"})})}):e("p",{class:"ui-state insignificant",children:e(f,{id:"2EYeAZ"})}):r==="loading"&&e("p",{class:"ui-state",children:e(Be,{abrupt:!0})}))]}):r==="loading"?e("p",{class:"ui-state",children:e(Be,{abrupt:!0})}):e("p",{class:"ui-state",children:e(f,{id:"fGn1Hk"})})]})]})})}const Kr=20,yo=10*60*1e3,Hr=bt(n=>n.v1.trends.links.list().values().next(),{maxAge:yo}),Yr=bt(n=>n.v1.trends.tags.list().values().next(),{maxAge:yo});function qr(n){return Je("@pixelfed/trending")?n.pixelfed.v2.discover.posts.trending.list({range:"daily"}).values():n.v1.trends.statuses.list({limit:Kr}).values()}function jr(n,i){return n.v1.timelines.link.list(i).values()}function bo({columnMode:n,...i}){const{_:s}=re(),o=We(x),c=n?{}:Mt(),{masto:l,instance:u}=le({instance:(i==null?void 0:i.instance)||c.instance}),{masto:r,instance:d}=le(),a=s({id:"cI3UEs",values:{instance:u}});tt(a,"/:instance?/trending");const h=q(),p=u===d,[g,y]=M([]),[b,w]=M([]),v=q();async function m(X){var B;if(X||!v.current){if(v.current=qr(l),Je("@mastodon/trending-hashtags"))try{const{value:ee}=await Yr(l);ee!=null&&ee.length&&y(ee)}catch{}if(Je("@mastodon/trending-links"))try{const{value:ee}=await Hr(l,u),$=(B=ee==null?void 0:ee.filter)==null?void 0:B.call(ee,K=>K.type==="link");$!=null&&$.length&&w($)}catch{}}const Y=await v.current.next();let{value:Z}=Y;return Z!=null&&Z.length&&(X&&(h.current=Z[0].id),Z.forEach(ee=>{et(ee,u)})),{...Y,value:Z}}const[S,C]=M(!1),T=q(),[A,k]=M(null),_=!!A,E=q(),R=p&&Je("@mastodon/trending-link-posts");Q(()=>{A&&E.current&&E.current.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})},[A]);const F=q();async function O(X){(X||!T.current)&&(C(!0),T.current=jr(l,{url:A})),F.current=A;const Y=await T.current.next();let{value:Z}=Y;return Z!=null&&Z.length&&(Z=zt(Z,"public"),Z.forEach(B=>{et(B,u)})),F.current===A&&C(!1),{...Y,value:Z}}async function W(){try{const X=await l.v1.trends.statuses.list({limit:1}).values().next();let{value:Y}=X;return Y=zt(Y,"public"),Y!=null&&Y.length&&Y[0].id!==h.current?(h.current=Y[0].id,!0):!1}catch{return!1}}const V=Ae(()=>e(U,{children:[!!g.length&&e("div",{class:"filter-bar expandable",children:[e(I,{icon:"chart",class:"insignificant",size:"l"}),g.map((X,Y)=>{const{name:Z,history:B}=X,ee=B.reduce(($,K)=>$+ +K.uses,0);return e(ge,{to:`/${u}/t/${Z}`,children:[e("span",{dir:"auto",children:[e("span",{class:"more-insignificant",children:"#"}),Z]}),e("span",{class:"filter-count",children:Qe(ee)})]},Z)})]}),!!b.length&&e("div",{class:"links-bar",children:[e("header",{children:e("h3",{children:e(f,{id:"9veeTb"})})}),b.map(X=>{var H,ke;const{authors:Y,authorName:Z,authorUrl:B,blurhash:ee,description:$,height:K,image:j,imageDescription:te,language:J,providerName:ue,providerUrl:he,publishedAt:ne,title:we,url:Ce,width:se}=X,Te=(ke=(H=Y==null?void 0:Y[0])==null?void 0:H.account)!=null&&ke.id?Y[0].account:null,Ie=we.length<30,Pe=!!(Z||Te),$e=$s(Ce);let Ee;if(ee){const De=yi(ee),xe=Ri(De);Ee=Ei([.6,xe[1],xe[2]])}return e("div",{children:[e("a",{ref:A===Ce?E:null,href:Ce,target:"_blank",rel:"noopener",class:`link-block ${_?A===Ce?"active":"inactive":""}`,style:Ee?{"--accent-color":`rgb(${Ee.join(",")})`,"--accent-alpha-color":`rgba(${Ee.join(",")}, 0.4)`}:{},children:e("article",{children:[e("figure",{children:e("img",{src:j,alt:te,width:se,height:K,loading:"lazy"})}),e("div",{class:"article-body",children:[e("header",{children:[e("div",{class:"article-meta",children:[e("span",{class:"domain",children:$e})," ",!!ne&&e(U,{children:"· "}),!!ne&&e(U,{children:e(_t,{datetime:ne,format:"micro"})})]}),!!we&&e("h1",{class:"title",lang:J,dir:"auto",title:we,children:we})]}),!!$&&e("p",{class:`description ${Pe&&!Ie?"":"more-lines"}`,lang:J,dir:"auto",title:$,children:$}),Pe&&e(U,{children:[e("hr",{}),e("p",{class:"byline",children:e("small",{children:e(f,{id:"aavdrC",values:{0:Te?e(yt,{account:Te,showAvatar:!0}):B?e("a",{href:B,target:"_blank",rel:"noopener",children:Z}):Z}})})})]})]})]})}),R&&e("button",{type:"button",class:"small plain4 block",onClick:()=>{k(Ce)},disabled:Ce===A,children:[e(I,{icon:"comment2"})," ",e("span",{children:e(f,{id:"/bZzdR"})})," ",e(I,{icon:"chevron-down"})]})]},Ce)})]}),R&&!!b.length&&e("div",{class:`timeline-header-block ${_?"blended":""}`,children:_?e(U,{children:[e("div",{style:{width:50,flexShrink:0,textAlign:"center"},children:S?e(Be,{abrupt:!0}):e("button",{type:"button",class:"light",onClick:()=>{k(null)},children:e(I,{icon:"x",alt:s({id:"9Q/4xJ"})})})}),e("p",{children:e(f,{id:"BATCqf",values:{0:A.replace(/^https?:\/\/(www\.)?/i,"").replace(/\/$/,"")},components:{0:e("span",{class:"link-text"})}})})]}):e("p",{class:"insignificant",children:e(f,{id:"Vosm4k"})})})]}),[g,b,A,S]);return e(At,{title:a,titleComponent:e("h1",{class:"header-double-lines",children:[e("b",{children:e(f,{id:"4/iCqx"})}),e("div",{children:u})]}),id:"trending",instance:u,emptyText:s({id:"6HA9+s"}),errorText:s({id:"scd9lw"}),fetchItems:_?O:m,checkForUpdates:_?void 0:W,checkForUpdatesInterval:5*60*1e3,useItemID:!0,headerStart:e(U,{}),boostsCarousel:o.settings.boostsCarousel,filterContext:"public",timelineStart:V,refresh:A,clearWhenRefresh:!0,view:_?"link-mentions":void 0,headerEnd:e(dt,{portal:!0,overflow:"auto",viewScroll:"close",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(I,{icon:"more",size:"l",alt:s({id:"2FYpfJ"})})}),children:[e(ye,{onClick:()=>{let X=prompt(s({id:"2MQ2cd"}));if(!/\./.test(X)){X&&alert(s({id:"7WddtO"}));return}X&&(X=X.toLowerCase().trim(),location.hash=`/${X}/trending`)},children:[e(I,{icon:"bus"})," ",e("span",{children:e(f,{id:"Sq04Yc"})})]}),d!==u&&e(ye,{onClick:()=>{location.hash=`/${d}/trending`},children:[e(I,{icon:"bus"})," ",e("small",{class:"menu-double-lines",children:e(f,{id:"iAzCp4",values:{currentInstance:d},components:{0:e("b",{})}})})]})]})},u)}const rs={block:"nearest",inline:"nearest",behavior:"smooth"};function Vr(){const{_:n}=re();tt(n({id:"i0qMbr"}),"/");const i=We(x),{shortcuts:s}=i,o=s.map(c=>{if(!c)return null;const{type:l,...u}=c,r={following:Mi,notifications:mo,list:oo,public:ci,bookmarks:to,favourites:no,hashtag:so,mentions:ro,trending:bo,search:go}[l];return!r||l==="search"&&!u.query||l==="list"&&!u.id?null:e(r,{...u,columnMode:!0},l+JSON.stringify(u))});return Ye(["1","2","3","4","5","6","7","8","9"],c=>{try{const l=parseInt(c.key,10)-1,u=document.querySelectorAll("#columns > *")[l];u&&(u.focus(),u.scrollIntoView(rs))}catch{}},{useKey:!0,ignoreEventWhen:c=>c.metaKey||c.ctrlKey||c.altKey||c.shiftKey}),Ye(["[","]"],(c,l)=>{const u=l.keys[0],r=document.activeElement.closest("#columns > *"),d=Ot(),a=d?"]":"[",h=d?"[":"]";let p;u===a?p=r?r.previousElementSibling:document.querySelectorAll("#columns > *")[0]:u===h&&(p=r?r.nextElementSibling:document.querySelectorAll("#columns > *")[1]),p&&(p.focus(),p.scrollIntoView(rs))},{useKey:!0,ignoreEventWhen:c=>c.metaKey||c.ctrlKey||c.altKey||c.shiftKey}),e("div",{id:"columns",onContextMenu:c=>{c.target.closest(".deck > header")&&!c.target.closest("a")&&!c.target.closest("button")&&(c.preventDefault(),x.showShortcutsSettings=!0)},onFocus:()=>{const c=document.activeElement.closest("#columns > *");c&&document.querySelectorAll("#columns > *").forEach(l=>{l.classList.toggle("focus",l===c)})},children:o})}function Gr(){var s;const{_:n}=re(),i=We(x);return __BENCHMARK.end("time-to-home"),Q(()=>{(async()=>{const o=await gt.drafts.keys();if(o.length){const c=An();o.filter(u=>u.startsWith(c)).length&&(x.showDrafts=!0)}})()},[]),e(U,{children:(i.settings.shortcutsViewMode==="multi-column"||!i.settings.shortcutsViewMode&&i.settings.shortcutsColumnsMode)&&((s=i.shortcuts)!=null&&s.length)?e(Vr,{}):e(Mi,{title:n({id:"i0qMbr"}),path:"/",id:"home",headerStart:!1,headerEnd:e(Wr,{})})})}function Wr(){const{_:n}=re(),i=We(x),s=q(),[o,c]=M(void 0);return e(U,{children:[e(ge,{ref:s,to:"/notifications",class:`button plain notifications-button ${i.notificationsShowNew?"has-badge":""} ${o||""}`,onClick:l=>{l.stopPropagation(),window.matchMedia("(min-width: calc(40em))").matches&&(l.preventDefault(),c(u=>u?void 0:"open"))},children:e(I,{icon:"notification",size:"l",alt:n({id:"iDNBZe"})})}),e(Xr,{state:o,anchorRef:s,onClose:()=>c(void 0)})]})}const Zr=5;function Xr({anchorRef:n,state:i,onClose:s}){const{masto:o,instance:c}=le(),l=We(x),[u,r]=M("default"),d=fo();async function a(){const v=await d.next(),m=lo(v.value);if(m!=null&&m.length){m.forEach(C=>{et(C.status,c,{skipThreading:!0})});const S=po(m);x.notificationsLast=S[0],x.notifications=S,o.v1.markers.create({notifications:{lastReadId:S[0].id}}).catch(()=>{})}return x.notificationsShowNew=!1,x.notificationsLastFetchTime=Date.now(),v}const[h,p]=M(!1);function g(){return o.v1.followRequests.list({limit:1})}function y({skipFollowRequests:v=!1}={}){r("loading"),(async()=>{try{if(await a(),!v){const m=await g();p(!!(m!=null&&m.length))}r("default")}catch{r("error")}})()}const b=q(),w=52;return Q(()=>{if(i==="open")if(l.notificationsShowNew){const v=b.current;(v==null?void 0:v.scrollTop)<=w&&y({skipFollowRequests:!0})}else y()},[i,l.notificationsShowNew]),e(gi,{ref:b,menuClassName:"notifications-menu",state:i,anchorRef:n,onClose:s,portal:{target:document.body},containerProps:{onClick:()=>{var v,m;(m=(v=b.current)==null?void 0:v.closeMenu)==null||m.call(v)}},overflow:"auto",viewScroll:"close",position:"anchor",align:"center",boundingBoxPadding:"8 8 8 8",children:[e("header",{children:e("h2",{children:e(f,{id:"iDNBZe"})})}),e(On.Provider,{value:"notifications",children:e("main",{children:l.notifications.length?e(U,{children:l.notifications.slice(0,Zr).map(v=>e(rn,{instance:c,notification:v,disableContextMenu:!0},v._ids||v.id))}):u==="loading"?e("div",{class:"ui-state",children:e(Be,{abrupt:!0})}):u==="error"&&e("div",{class:"ui-state",children:[e("p",{children:e(f,{id:"5GFQTh"})}),e("p",{children:e("button",{type:"button",onClick:y,children:e(f,{id:"KDw4GX"})})})]})})}),e("footer",{children:[e(ge,{to:"/mentions",class:"button plain",children:[e(I,{icon:"at"})," ",e("span",{children:e(f,{id:"/bZzdR"})})]}),e(ge,{to:"/notifications",class:"button plain2",children:[h?e(f,{id:"OdVhdR",components:{0:e("span",{class:"tag collapsed"}),1:e("span",{})}}):e("b",{children:e(f,{id:"gukqfD"})})," ",e(I,{icon:"arrow-right"})]})]})]})}const Jr=ut(Gr),Qr=[/^\/@[^@\/]+\/(?:statuses|posts)\/([^\/]+)/i,/\/notes\/([^\/]+)/i,/^\/(?:notice|objects)\/([a-z0-9-]+)/i,/\/@[^@\/]+\/post\/([^\/]+)/i,/\/@[^@\/]+@?[^\/]+?\/([^\/]+)/i,/^\/p\/[^\/]+\/([^\/]+)/i];function vo(n){const i=URL.parse(n);if(!i)return{};const{hostname:s,pathname:o}=i;for(const c of Qr){const[,l]=o.match(c)||[];if(l)return{instance:s,id:l}}return{}}function ed(n){const{instance:i,id:s}=vo(n);return i&&s?`/${i}/s/${s}`:null}function td(){const i=Jt().pathname.replace(/^\//,""),s=vo(i),o=s!=null&&s.instance?`/${s.instance}/s/${s.id}`:null,[c,l]=M("loading");return St(()=>{l("loading"),(async()=>{try{const{instance:u,id:r}=s;if(r){const{masto:d}=le({instance:u});if(await d.v1.statuses.$select(r).fetch()){window.location.hash=o+"?view=full";return}}}catch{}{const{masto:u,instance:r}=le(),d=await u.v2.search.list({q:i,limit:1,resolve:!0});if(d.statuses.length){const a=d.statuses[0];window.location.hash=`/${r}/s/${a.id}?view=full`}else if(d.accounts.length){const a=d.accounts[0];window.location.hash=`/${r}/a/${a.id}`}else o?window.location.hash=o+"?view=full":l("error")}})()},[o]),e("div",{class:"ui-state",tabIndex:"-1",children:[c==="loading"?e(U,{children:[e(Be,{abrupt:!0}),e("h2",{children:e(f,{id:"RTAr/z"})}),e("p",{children:e("a",{href:i,target:"_blank",rel:"noopener",children:i})})]}):e(U,{children:[e("h2",{children:e(f,{id:"ufzZSJ"})}),e("p",{children:e("a",{href:i,target:"_blank",rel:"noopener",children:i})})]}),e("hr",{}),e("p",{children:e(ge,{to:"/",children:e(f,{id:"iWpEwy"})})})]})}function nd(){const{_:n}=re();tt(n({id:"h16FyT"}),"/l");const[i,s]=M("default"),[o,c]=Lt(h=>h+1,0),[l,u]=M([]);Q(()=>{s("loading"),(async()=>{try{const h=await si();u(h),s("default")}catch{s("error")}})()},[o]);const[r,d]=M(!1),a=l.some(h=>h.exclusive);return e("div",{id:"lists-page",class:"deck-container",tabIndex:"-1",children:[e("div",{class:"timeline-deck deck",children:[e("header",{children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e($t,{}),e(ge,{to:"/",class:"button plain",children:e(I,{icon:"home",size:"l"})})]}),e("h1",{children:e(f,{id:"h16FyT"})}),e("div",{class:"header-side",children:e("button",{type:"button",class:"plain",onClick:()=>d(!0),children:e(I,{icon:"plus",size:"l",alt:n({id:"Sb2gYF"})})})})]})}),e("main",{children:l.length>0?e(U,{children:[e("ul",{class:"link-list",children:l.map(h=>e("li",{children:e(ge,{to:`/l/${h.id}`,children:[e(I,{icon:"list"})," ",e("span",{children:[h.title,h.exclusive&&e(U,{children:[" ",e(Bt,{insignificant:!0})]})]})]})}))}),l.length>1&&e("footer",{class:"ui-state",children:[a&&e("p",{children:e("small",{class:"insignificant",children:[e(Bt,{})," ",e(f,{id:"FNptcJ"})]})}),e("p",{children:e("small",{class:"insignificant",children:e(f,{id:"8prZNK",values:{0:l.length}})})})]})]}):i==="loading"?e("p",{class:"ui-state",children:e(Be,{})}):i==="error"?e("p",{class:"ui-state",children:e(f,{id:"v/l5uA"})}):e("p",{class:"ui-state",children:e(f,{id:"IvPikw"})})})]}),r&&e(qe,{onClick:h=>{h.target===h.currentTarget&&d(!1)},children:e(xi,{list:r==null?void 0:r.list,onClose:h=>{h.state==="success"&&c(),d(!1)}})})]})}const id=""+new URL("instances-LA7224ZB.json",import.meta.url).href,sd={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Blaede Phanpy",PHANPY_DEFAULT_INSTANCE:"mastodon.blaede.family",PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:"https://mastodon.blaede.family/auth/sign_up",PHANPY_GIPHY_API_KEY:"48JGsrSS1XE5w4nWe9c9hqxPbsfRWR0e",PHANPY_LINGVA_INSTANCES:"lingva.phanpy.social lingva.lunar.icu lingva.garudalinux.org translate.plausibility.cloud",PHANPY_PRIVACY_POLICY_URL:"https://mastodon.blaede.family/privacy-policy",PHANPY_TRANSLANG_INSTANCES:"translang.phanpy.social",PHANPY_WEBSITE:"https://phanpy.blaede.family",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},{PHANPY_DEFAULT_INSTANCE:od}=sd;function cd(){var C,T;const{_:n}=re();tt(n({id:"sQia9P"}),"/login");const i=q(),s=ze.local.get("instanceURL"),[o,c]=M("default"),[l]=vt(),u=l.get("instance"),r=l.get("submit"),[d,a]=M(u||(s==null?void 0:s.toLowerCase())||""),[h,p]=M([]),g=q();Q(()=>{(async()=>{try{const k=await(await fetch(id)).json();p(k),g.current=new oc(k)}catch{}})()},[]);const y=A=>{A&&(async()=>{try{const _=await(await fetch(`https://${A}/.well-known/host-meta`)).text(),O=new DOMParser().parseFromString(_,"text/xml").getElementsByTagName("Link")[0].getAttribute("template"),W=URL.parse(O),{host:V}=W;A!==V&&(A=V)}catch{}ze.local.set("instanceURL",A),c("loading");try{let k=Cs(A);(!k||!k.client_id||!k.client_secret)&&(k=await Bc({instanceURL:A}),Po(A,k));const{client_id:_,client_secret:E}=k,R=await Nc({instanceURL:A}),F=Do(A);if(R)if(_&&E){const[O,W]=await Fc({instanceURL:A,client_id:_,forceLogin:F});ze.sessionCookie.set("codeVerifier",W),location.href=O}else alert(n({id:"ZP1FIA"}));else _&&E?location.href=await Kc({instanceURL:A,client_id:_,forceLogin:F}):alert(n({id:"ZP1FIA"}));c("default")}catch{c("error")}})()},b=d?d.replace(/^https?:\/\//,"").replace(/\/+$/,"").replace(/^@?[^@]+@/,"").trim():null,w=/[^\s\r\n\t\/\\]+\.[^\s\r\n\t\/\\]+/.test(b)&&!/[\s\/\\@]/.test(b),v=b?(T=(C=g.current)==null?void 0:C.search(b,{limit:10}))==null?void 0:T.map(A=>A.item):[],m=w?b:v!=null&&v.length?v[0]:d?h.find(A=>A.includes(d)):null,S=A=>{A.preventDefault(),y(m)};return r&&Q(()=>{y(u||m)},[]),e("main",{id:"login",style:{textAlign:"center"},children:e("form",{onSubmit:S,children:[e("h1",{children:[e("img",{src:Ii,alt:"",width:"80",height:"80"}),e("br",{}),e(f,{id:"sQia9P"})]}),e("label",{children:[e("p",{children:e(f,{id:"kyAi7k"})}),e("input",{value:d,required:!0,type:"text",class:"large",id:"instanceURL",ref:i,disabled:o==="loading",autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellCheck:!1,placeholder:n({id:"u3gOdY"}),onInput:A=>{a(A.target.value)},dir:"auto"}),(v==null?void 0:v.length)>0?e("ul",{id:"instances-suggestions",children:v.map((A,k)=>e("li",{children:e("button",{type:"button",class:"plain5",onClick:()=>{y(A)},children:A})}))}):e("div",{id:"instances-eg",children:e(f,{id:"/OvbEC"})})]}),o==="error"&&e("p",{class:"error",children:e(f,{id:"rmBHZn"})}),e("div",{children:[e("button",{disabled:o==="loading"||!d||!m,children:n(m?{id:"2xahsi",values:{selectedInstanceText:m}}:{id:"xGVfLh"})})," "]}),e(Be,{hidden:o!=="loading"}),e("hr",{}),!od&&e("p",{children:e("a",{href:"https://joinmastodon.org/servers",target:"_blank",children:e(f,{id:"LcOiWS"})})}),e("p",{children:e(ge,{to:"/",children:e(f,{id:"iWpEwy"})})}),e(Ti,{})]})})}const ad=40;function ld(){const{_:n}=re(),i=We(x);tt(n({id:"+GkIdc"}),"/sp");const{masto:s}=le(),[o,c]=M([]),[l,u]=M("default"),[r,d]=Lt(p=>p+1,0),[a,h]=M(!1);return Q(d,[i.reloadScheduledPosts]),Q(()=>{u("loading"),(async()=>{try{const p=s.v1.scheduledStatuses.list({limit:ad}).values(),g=[];let y;do y=(await p.next()).value,y!=null&&y.length&&g.push(...y);while(y!=null&&y.length);c(g)}catch{u("error")}finally{u("default")}})()},[r]),e("div",{id:"scheduled-posts-page",class:"deck-container",tabIndex:"-1",children:e("div",{class:"timeline-deck deck",children:[e("header",{children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e($t,{}),e(ge,{to:"/",class:"button plain",children:e(I,{icon:"home",size:"l",alt:n({id:"i0qMbr"})})})]}),e("h1",{children:e(f,{id:"+GkIdc"})}),e("div",{class:"header-side",children:e(dt,{portal:!0,setDownOverflow:!0,overflow:"auto",viewScroll:"close",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(I,{icon:"more",size:"l",alt:n({id:"2FYpfJ"})})}),children:e(ye,{onClick:()=>{d()},children:[e(I,{icon:"refresh",size:"l"}),e("span",{children:e(f,{id:"lCF0wC"})})]})})})]})}),e("main",{children:[o.length?e("ul",{class:"posts-list",children:o.map(p=>{const{id:g,params:y,scheduledAt:b,mediaAttachments:w}=p,{inReplyToId:v,language:m,poll:S,sensitive:C,spoilerText:T,text:A,visibility:k}=y,_={id:g,inReplyToId:v,language:m,mediaAttachments:w,poll:S?{...S,expiresAt:new Date(Date.now()+S.expiresIn*1e3),options:S.options.map(E=>({title:E,votesCount:0}))}:void 0,sensitive:C,spoilerText:T,text:A,visibility:k,content:`<p>${A}</p>`};return e("li",{children:e(rd,{status:_,scheduledAt:b,onClick:()=>{h({post:_,scheduledAt:new Date(b)})}})},g)})}):e("p",{class:"ui-state",children:l==="loading"?e(Be,{}):n({id:"mZYb1f"})}),a&&e(qe,{onClick:p=>{p.target===p.currentTarget&&h(!1)},children:e(dd,{post:a.post,scheduledAt:a.scheduledAt,onClose:()=>h(!1)})})]})]})})}function rd({status:n,scheduledAt:i,onClick:s}){const o=Ae(()=>{const c=(new Date(i).getTime()-Date.now())/36e5;return c<24?"time":c<720?"day":"month"},[i]);return e("button",{type:"button",class:"textual block",onClick:s,children:[e("div",{class:`post-schedule-meta post-schedule-${o}`,children:[e(I,{icon:o,class:"insignificant"})," ",e("span",{children:e(f,{id:"aEp6lO",values:{0:ct(i,{formatOpts:{weekday:"short",second:"numeric"}})},components:{0:e("b",{}),1:e(_t,{datetime:i}),2:e("small",{})}})})]}),e(Ge,{status:n,size:"s",previewMode:!0,readOnly:!0})]})}function dd({post:n,scheduledAt:i,onClose:s}){const{masto:o}=le(),{_:c}=re(),[l,u]=M("default"),[r,d]=M(),a=r&&r.getTime()!==i.getTime(),h=cc(),p=i&&i<=Date.now(),{inReplyToId:g}=n,[y,b]=M(null);return e("div",{id:"scheduled-post-sheet",class:"sheet",children:[e("button",{type:"button",class:"sheet-close",onClick:s,children:e(I,{icon:"x",size:"l",alt:c({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:[e(f,{id:"orjBLU",components:{0:e("b",{}),1:e(_t,{datetime:i})}}),e("br",{}),e("small",{children:ct(i,{formatOpts:{weekday:"short",second:"numeric"}})})]})}),e("main",{tabIndex:"-1",children:[!!y&&e("div",{class:"status-reply",children:e(Ge,{status:y,size:"s",previewMode:!0,readOnly:!0})}),e(Ge,{status:n,size:"s",previewMode:!0,readOnly:!0,onMediaClick:(w,v,m,S)=>{w.preventDefault(),x.showMediaModal={mediaAttachments:n.mediaAttachments,mediaIndex:v}}}),e("form",{onSubmit:w=>{w.preventDefault(),u("loading"),(async()=>{try{await o.v1.scheduledStatuses.$select(n.id).update({scheduledAt:r.toISOString()}),fe(c({id:"40naR1"})),s(),u("default"),x.reloadScheduledPosts++}catch{u("error"),fe(c({id:"ZM3jAs"}))}})()},children:e("footer",{children:[e("div",{class:"row",children:e("span",{children:[e(ac,{scheduledAt:i,setScheduledAt:w=>{d(w)}})," ",e("small",{class:"ib",children:h})]})}),e("div",{class:"row",children:[e("button",{disabled:!a||l==="loading"||p,children:e(f,{id:"QqW27M"})}),e("span",{class:"grow"}),e(pt,{align:"end",menuItemClassName:"danger",confirmLabel:c({id:"09u3Kk"}),onClick:()=>{u("loading"),(async()=>{try{await le().masto.v1.scheduledStatuses.$select(n.id).remove(),fe(c({id:"/zL/Mq"})),s(),u("default"),x.reloadScheduledPosts++}catch{u("error"),fe(c({id:"aOh6Md"}))}})()},children:e("button",{type:"button",class:"light danger",disabled:l==="loading"||p,children:e(f,{id:"Jb6/SB"})})})]})]})})]})]})}const ud={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Blaede Phanpy",PHANPY_DEFAULT_INSTANCE:"mastodon.blaede.family",PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:"https://mastodon.blaede.family/auth/sign_up",PHANPY_GIPHY_API_KEY:"48JGsrSS1XE5w4nWe9c9hqxPbsfRWR0e",PHANPY_LINGVA_INSTANCES:"lingva.phanpy.social lingva.lunar.icu lingva.garudalinux.org translate.plausibility.cloud",PHANPY_PRIVACY_POLICY_URL:"https://mastodon.blaede.family/privacy-policy",PHANPY_TRANSLANG_INSTANCES:"translang.phanpy.social",PHANPY_WEBSITE:"https://phanpy.blaede.family",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},{PHANPY_DEFAULT_INSTANCE:ds}=ud,yn=40,hd=10,fd=5;let ai={},Sn={},_n={};function Cn(n){delete Sn[n],delete _n[n]}const tn={block:"nearest",inline:"center",behavior:"smooth"},us=".status-link:not(details:not([open]) > summary ~ *, details:not([open]) > summary ~ * *), .status-focus:not(details:not([open]) > summary ~ *, details:not([open]) > summary ~ * *)",hs=/\/s\//i;function pd(n){var _;const{_:i}=re(),{id:s}=n,{masto:o,instance:c}=le({instance:n.instance}),l=We(x),[u,r]=vt(),d=u.get("media"),a=u.get("media-only"),h=parseInt(d||a,10);let p=h>0;const g=u.get("mediaStatusID"),y=_s(g,c);g&&!y&&(p=!1);const b=p&&!!a,w=rt(s,c),[v,m]=M(x.statuses[w]);Q(()=>{x.statuses[w]&&m(x.statuses[w])},[w]);const S=Ae(()=>{const{prevLocation:E}=x,R=((E==null?void 0:E.pathname)||"")+((E==null?void 0:E.search)||""),F=cn("/:instance/s/:id",R)||cn("/s/:id",R);return!R||F?"/":R},[]);Q(()=>{!v&&p&&(async()=>{try{const E=await o.v1.statuses.$select(s).fetch();et(E,c),m(E)}catch{alert("Unable to load post."),location.hash=S}})()},[p]);const C=g?(_=l.statuses[rt(g,c)])==null?void 0:_.mediaAttachments:v==null?void 0:v.mediaAttachments,T=()=>window.matchMedia("(min-width: calc(40em + 350px))").matches?"large":"small",A=it(()=>{T()==="small"&&l.prevLocation?history.back():b?location.hash=S:(u.delete("media"),u.delete("mediaStatusID"),r(u))},[b,S,l.prevLocation]),k=it((E,R,F,O)=>{var W,V;if(T()==="large"&&!b){A();return}if(p&&document.startViewTransition){const X=F[R],{id:Y,blurhash:Z,url:B}=X,ee=lc(Y||Z||B),K=(V=(W=[...document.querySelectorAll(`.status .media [data-view-transition-name="${ee}"]`)]).filter)==null?void 0:V.call(W,te=>{const J=te.getBoundingClientRect();return J.top<window.innerHeight&&J.bottom>0&&J.left<window.innerWidth&&J.right>0}),j=K.length===1?K[0]:K.find(te=>!!te.closest(".status-deck"));j?document.startViewTransition(()=>{var J;j.style.viewTransitionName=ee,O!=null&&O.current&&((J=O.current.querySelectorAll(".media img, .media video"))==null||J.forEach(ue=>{ue.style.viewTransitionName=""})),A()}).ready.finally(()=>{j.style.viewTransitionName=""}):A()}else A()},[p,b]);return Q(()=>{let E=setTimeout(()=>{const R=document.querySelector(".carousel");R&&R.focus()},100);return()=>clearTimeout(E)},[b]),Q(()=>{const E=document.querySelectorAll(".deck-container");return E.forEach(R=>{R.setAttribute("inert","")}),()=>{E.forEach(R=>{R.removeAttribute("inert")})}},[]),e("div",{class:"deck-backdrop",children:[p?C!=null&&C.length?e(Xs,{mediaAttachments:C,statusID:g||s,instance:c,lang:v==null?void 0:v.language,index:h-1,onClose:k}):e("div",{class:"media-modal-container loading",children:e(Be,{abrupt:!0})}):e(ge,{to:S}),!b&&e(gd,{id:s,instance:n.instance,closeLink:S})]})}function md(n){const{linkable:i,to:s,onClick:o,...c}=n;return i?e(ge,{class:"status-link",to:s,onClick:o,...c}):e("div",{class:"status-focus",tabIndex:0,...c})}function fs(n,i){return new Date(i.created_at)-new Date(n.created_at)}function gd({id:n,closeLink:i="/",instance:s}){var Me,me;const{_:o}=re(),[c,l]=vt(),u=c.get("media"),r=c.get("mediaStatusID"),d=parseInt(u,10)>0,a=q(!x.prevLocation&&(history.length===1||"navigation"in window&&((me=(Me=navigation==null?void 0:navigation.entries)==null?void 0:Me.call(navigation))==null?void 0:me.length)===1)),[h,p]=M(c.get("view")||a.current?"full":null),g=!!parseInt(c.get("translate")),{masto:y,instance:b}=le({instance:s}),{masto:w,instance:v,authenticated:m}=le(),S=b===v,C=We(x),[T,A]=M([]),[k,_]=M("default"),E=q(),R=rt(n,b),F=q(0),O=q();Q(()=>{var N;(N=O.current)==null||N.focus()},[]),Q(()=>{var D;const N=Ps(()=>{if(!O.current)return;const{scrollTop:oe}=O.current;k!=="loading"&&(_n[n]=oe)},50);return(D=O.current)==null||D.addEventListener("scroll",N,{passive:!0}),N(),()=>{var oe;N.cancel(),(oe=O.current)==null||oe.removeEventListener("scroll",N)}},[n,k!=="loading"]);const W=q(),V=q(),X=({reloadHero:N}={})=>{_("loading");let D;const oe=Sn[n];if(oe){const Le=oe.filter(P=>x.statuses[R]);A(Le)}else A([{id:n}]);return(async()=>{var Ne,Oe;const Le=()=>Oi(()=>y.v1.statuses.$select(n).fetch(),{retries:4}),P=Oi(()=>y.v1.statuses.$select(n).context.fetch(),{retries:8}),ce=!!C.statuses[R];let Se=C.statuses[R];if(!(ce&&!N))try{Se=await Le(),et(Se,b),await new Promise(L=>{setTimeout(L,100)})}catch{_("error");return}try{let L=function(de,Ue){const Ke=Ue+1;return Ke>_e&&(_e=Ue),de==null?void 0:de.map(nt=>({id:nt.id,account:nt.account,repliesCount:nt.repliesCount,content:nt.content,weight:on(nt),level:Ke,replies:L(nt.__replies,Ke)}))};const G=await P,{ancestors:ae,descendants:ie}=G;ae.sort(fs),ie.sort(fs),F.current=(ie==null?void 0:ie.length)||0;const z=new Set;ae.forEach(de=>{et(de,b,{skipThreading:!0}),de.inReplyToId&&!ae.find(Ue=>Ue.id===de.inReplyToId)&&z.add(de.inReplyToId)});const be=ae.every(de=>de.account.id===Se.account.id),ve=[];ie.forEach(de=>{if(et(de,b,{skipThreading:!0}),de.inReplyToId&&!ie.find(Ue=>Ue.id===de.inReplyToId)&&de.inReplyToId!==Se.id&&z.add(de.inReplyToId),de.inReplyToAccountId===de.account.id)ve.push(de);else if(de.inReplyToId===Se.id)ve.push(de);else if(!de.inReplyToAccountId&&ve.find(Ue=>Ue.id===de.inReplyToId&&Ue.account.id===Se.account.id)&&de.account.id===Se.account.id)ve.push(de);else{const Ue=ie.find(Ke=>Ke.id===de.inReplyToId);Ue&&(Ue.__replies||(Ue.__replies=[]),Ue.__replies.push(de))}}),ve.sort((de,Ue)=>{const Ke=Se.account.id;return de.account.id===Ke&&Ue.account.id!==Ke?-1:Ue.account.id===Ke&&de.account.id!==Ke?1:0}),z.size;let _e=1;const Ze=[...ae.map(de=>({id:de.id,ancestor:!0,isThread:be,accountID:de.account.id,account:de.account,repliesCount:de.repliesCount,weight:on(de)})),{id:n,accountID:Se.account.id,weight:on(Se)},...ve.map(de=>({id:de.id,account:de.account,accountID:de.account.id,descendant:!0,thread:de.account.id===Se.account.id,weight:on(de),level:1,replies:L(de.__replies,1)}))];_("default"),W.current={offsetTop:(Ne=E.current)==null?void 0:Ne.offsetTop,scrollTop:(Oe=O.current)==null?void 0:Oe.scrollTop};const Fe=ae.length||0;Fe>=te&&J(Fe+1),A(Ze),Sn[n]=Ze,Oo(Se,b)}catch{_("error")}})(),V.current=Date.now(),()=>{clearTimeout(D)}};Q(X,[n,y]);const[Y,Z]=M(!1);Q(()=>{let N=setInterval(()=>{const D=Date.now();V.current&&D-V.current>=6e4&&Z(!0)},6e4);return()=>{clearInterval(N)}},[]),St(()=>{var D,oe;if(!T.length)return;const N=_n[n];if(N)O.current.scrollTop=N;else if(W.current){const Le={offsetTop:(D=E.current)==null?void 0:D.offsetTop,scrollTop:(oe=O.current)==null?void 0:oe.scrollTop},P=Le.offsetTop-W.current.offsetTop+Le.scrollTop;O.current.scrollTop=P}else T.length===1&&(O.current.scrollTop=0);W.current=null},[T]),Q(()=>{C.reloadStatusPage<=0||(async()=>{try{const{instanceURL:N}=hi(),D=`https://${N}/api/v1/statuses/${n}/context`;return await(await caches.open("api")).delete(D,{ignoreVary:!0}),X({reloadHero:!0})}catch{}})()},[C.reloadStatusPage]),Q(()=>()=>{_n={},x.reloadStatusPage=0,Sn={},ai={},li.clear()},[]);const B=C.statuses[R]||C.statuses[n],ee=Ae(()=>{if(!B)return"";const{account:N}=B,D=document.createElement("div");return D.innerHTML=N.displayName,D.innerText.trim()},[B]),$=Ae(()=>{if(!B)return"";let N=Pn(B);return N.length>64&&(N=N.slice(0,64)+"…"),N},[B]);tt(ee&&$?`${ee}: "${$}"`:o({id:"post.title"}),"/:instance?/s/:id");const K=Ae(()=>{var D;if(!B)return;const{url:N}=B;if(N)return(D=URL.parse(N))==null?void 0:D.hostname},[B]),j=Ae(()=>{if(K)return K===b},[K,b]),[te,J]=M(yn),ue=Ae(()=>T.length-te,[T.length,te]),he=T.some(N=>N.descendant),ne=T.filter(N=>N.ancestor),[we,Ce]=M(!0),se=Ae(()=>{if(!E.current||we)return null;const{top:N}=E.current.getBoundingClientRect();return N>0?"down":"up"},[we]);Ye("esc",()=>{location.hash=i},{enabled:!d,ignoreEventWhen:N=>!!document.querySelector("#modal-container > *")||N.metaKey||N.ctrlKey||N.altKey||N.shiftKey,useKey:!0}),Ye("backspace",()=>{location.hash=i},{useKey:!0,ignoreEventWhen:N=>N.metaKey||N.ctrlKey||N.altKey||N.shiftKey}),Ye("j",()=>{const N=document.activeElement.closest(".status-link, .status-focus"),D=N==null?void 0:N.getBoundingClientRect(),oe=Array.from(O.current.querySelectorAll(us));if(N&&D.top<O.current.clientHeight&&D.bottom>0){const Le=oe.indexOf(N);let P=oe[Le+1];P&&(P.focus(),P.scrollIntoView(tn))}else{const Le=oe.find(P=>{const ce=P.getBoundingClientRect();return ce.top>=44&&ce.left>=0});Le&&(Le.focus(),Le.scrollIntoView(tn))}},{useKey:!0,ignoreEventWhen:N=>N.metaKey||N.ctrlKey||N.altKey||N.shiftKey}),Ye("k",()=>{const N=document.activeElement.closest(".status-link, .status-focus"),D=N==null?void 0:N.getBoundingClientRect(),oe=Array.from(O.current.querySelectorAll(us));if(N&&D.top<O.current.clientHeight&&D.bottom>0){const Le=oe.indexOf(N);let P=oe[Le-1];P&&(P.focus(),P.scrollIntoView(tn))}else{const Le=oe.find(P=>{const ce=P.getBoundingClientRect();return ce.top>=44&&ce.left>=0});Le&&(Le.focus(),Le.scrollIntoView(tn))}},{useKey:!0,ignoreEventWhen:N=>N.metaKey||N.ctrlKey||N.altKey||N.shiftKey}),Ye("x",()=>{const N=document.activeElement.closest(".status-link, .status-focus");if(N){const D=N.nextElementSibling;D&&D.tagName.toLowerCase()==="details"&&(D.open=!D.open)}},{useKey:!0,ignoreEventWhen:N=>N.metaKey||N.ctrlKey||N.altKey||N.shiftKey});const[Te,Ie]=M(!1),Pe=q(d?"media+status":"status"),$e=it((N,D,oe,Le)=>{N.preventDefault(),N.stopPropagation(),l({media:D+1,mediaStatusID:Le.id})},[n]),Ee=it((N,D)=>{Cn(D.id)},[]);Q(()=>{let N;return r&&d&&(N=setTimeout(()=>{var oe;const D=(oe=O.current)==null?void 0:oe.querySelector(`.status-link[href*="/${r}"]`);D&&D.scrollIntoView(tn)},400)),()=>{clearTimeout(N)}},[r,d]);const H=it((N,D)=>{const{id:oe,ancestor:Le,isThread:P,descendant:ce,thread:Se,replies:Ne,repliesCount:Oe,weight:L,level:G}=N,ae=oe===n;return e("li",{ref:ae?E:null,class:`${Le?"ancestor":""} ${ce?"descendant":""} ${Se?"thread":""} ${ae?"hero":""}`,children:[ae?e(U,{children:[e(Tt,{threshold:.1,onChange:z=>{queueMicrotask(()=>{requestAnimationFrame(()=>{Ce(z)})})},class:"status-focus",tabIndex:0,children:e(Ge,{statusID:oe,instance:b,withinContext:!0,size:"l",enableTranslate:!0,forceTranslate:g})}),k!=="loading"&&!m?e("div",{class:"post-status-banner",children:[e("p",{children:e(f,{id:"Vyeh4F"})}),e(ge,{to:ds?`/login?instance=${ds}&submit=1`:"/login",class:"button",children:e(f,{id:"sQia9P"})})]}):!S&&e("div",{class:"post-status-banner",children:[e("p",{children:e(f,{id:"j5roNG",values:{instance:b},components:{0:e("b",{})}})}),e("button",{type:"button",disabled:k==="loading",onClick:()=>{_("loading"),(async()=>{try{const z=await w.v2.search.list({q:B.url,type:"statuses",resolve:!0,limit:1});if(z.statuses.length){const be=z.statuses[0];location.hash=v?`/${v}/s/${be.id}`:`/s/${be.id}`}else throw new Error("No results")}catch(z){_("default"),alert(o({id:"DnepCE",values:{e:z}}))}})()},children:[e(I,{icon:"transfer"})," ",e(f,{id:"ejAVrO"})]})]})]}):e(md,{linkable:P||Le,to:b?`/${b}/s/${oe}`:`/s/${oe}`,onClick:()=>{Cn(oe)},children:[D===0&&Le?e(Tt,{threshold:.5,onChange:z=>{queueMicrotask(()=>{requestAnimationFrame(()=>{Ie(z)})})},children:e(Ge,{statusID:oe,instance:b,withinContext:!0,size:Se||Le?"m":"s",enableTranslate:!0,onMediaClick:$e,onStatusLinkClick:Ee})}):e(Ge,{statusID:oe,instance:b,withinContext:!0,size:Se||Le?"m":"s",enableTranslate:!0,onMediaClick:$e,onStatusLinkClick:Ee,showActionsBar:!!ce}),Le&&Oe>1&&e("div",{class:"replies-link",children:[e(I,{icon:"comment2",alt:o({id:"N8UzTV"})})," ",e("span",{title:Oe,children:Qe(Oe)})]})," "]}),ce&&(Ne==null?void 0:Ne.length)>0&&e(wo,{instance:b,replies:Ne,hasParentThread:Se,level:G,accWeight:L,openAll:F.current<hd,parentLink:{to:b?`/${b}/s/${oe}`:`/s/${oe}`,onClick:()=>Cn(oe)}}),k==="loading"&&ae&&!!(B!=null&&B.repliesCount)&&!he&&e("div",{class:"status-loading",children:e(Be,{abrupt:B.repliesCount>=3})}),k==="error"&&ae&&!!(B!=null&&B.repliesCount)&&!he&&e("div",{class:"status-error",children:[e(f,{id:"HQJU6W"}),e("br",{}),e("button",{type:"button",class:"plain",onClick:()=>{x.reloadStatusPage++},children:e(f,{id:"KDw4GX"})})]})]},oe)},[n,b,k,m,S,g,$e,Ee,he]),ke=Ae(()=>{var N;if("navigation"in window&&(navigation!=null&&navigation.entries)){const D=navigation.entries()[navigation.currentEntry.index-1];if(D!=null&&D.url)return hs.test(D.url)}return hs.test((N=x.prevLocation)==null?void 0:N.pathname)},[R]),De=Ae(()=>{if(!ue)return[];const N=[];function D(oe){N.push(oe.id),oe.replies&&oe.replies.forEach(D)}return T.slice(te).forEach(D),N.map(oe=>rt(oe,b))},[ue,T,te,b]),xe=Ae(()=>T.slice(0,te).map(H),[T,te,H]);return Q(()=>{let N=setTimeout(()=>{if(!E.current)return;const D=E.current.querySelector(".spoiler-button:not(.spoiling), .spoiler-media-button:not(.spoiling)");D&&D.click()},1e3);return()=>clearTimeout(N)},[n]),e("div",{tabIndex:"-1",ref:O,class:`status-deck deck contained ${T.length>1?"padded-bottom":""} ${Pe.current==="status"&&!a.current?"slide-in":""} ${h?`deck-view-${h}`:""}`,onAnimationEnd:N=>{Pe.current==="status"&&(Pe.current=null)},children:[e("header",{class:`${k==="loading"?"loading":""}`,onDblClick:N=>{x.reloadStatusPage++},children:e("div",{class:"header-grid header-grid-2",children:[e("h1",{children:[ke&&e("button",{type:"button",class:"plain deck-back",onClick:()=>{history.back()},children:e(I,{icon:"chevron-left",size:"xl",alt:o({id:"iH8pgl"})})}),!we&&B&&k!=="loading"?e(U,{children:[e("span",{class:"hero-heading",children:[e(yt,{account:B.account,instance:b,showAvatar:!0,short:!0})," ",e("span",{class:"insignificant",children:["•"," ",e(_t,{datetime:B.createdAt,format:"micro"})]})]})," ",e("button",{type:"button",class:"ancestors-indicator light small",onClick:N=>{N.preventDefault(),N.stopPropagation(),E.current.scrollIntoView({behavior:"smooth",block:"start"})},title:o({id:"NCy+Nw"}),children:e(I,{icon:se==="down"?"arrow-down":"arrow-up"})})]}):e(U,{children:[e(f,{id:"post.title"})," ",e("button",{type:"button",class:"ancestors-indicator light small",onClick:N=>{N.preventDefault(),N.stopPropagation(),O.current.scrollTo({top:0,behavior:"smooth"})},hidden:!ne.length||Te,title:o({id:"R8CUl0",values:{0:ne.length}}),children:[e(I,{icon:"arrow-up"}),ne.filter((N,D,oe)=>oe.findIndex(Le=>Le.accountID===N.accountID)===D).slice(0,3).map(N=>{var D;return e(mt,{url:N.account.avatarStatic||N.account.avatar,alt:N.account.displayName,squircle:(D=N.account)==null?void 0:D.bot},N.account.id)}),ne.length>3&&e(U,{children:[" ",e("span",{class:"insignificant",children:Qe(ne.length)})]})]})]})]}),e("div",{class:"header-side",children:[e("button",{type:"button",class:"plain4 button-switch-view",style:{display:h==="full"?"":"none"},onClick:()=>{p(null),c.delete("media"),c.delete("media-only"),c.delete("view"),l(c)},title:o({id:"+/xYEI"}),children:e(I,{icon:"layout4",size:"l"})}),Y&&e("button",{type:"button",class:"plain button-refresh",onClick:()=>{x.reloadStatusPage++,Z(!1)},children:e(I,{icon:"refresh",size:"l",alt:o({id:"lCF0wC"})})}),e(dt,{align:"end",portal:{target:O.current},menuButton:e("button",{type:"button",class:"button plain4",children:e(I,{icon:"more",alt:o({id:"2FYpfJ"}),size:"xl"})}),children:[e(ye,{disabled:k==="loading",onClick:()=>{x.reloadStatusPage++},children:[e(I,{icon:"refresh"}),e("span",{children:e(f,{id:"lCF0wC"})})]}),e(ye,{className:"menu-switch-view",onClick:()=>{p(h==="full"?null:"full"),c.delete("media"),c.delete("media-only"),h==="full"?c.delete("view"):c.set("view","full"),l(c)},children:[e(I,{icon:{"":"layout5",full:"layout4"}[h||""]}),e("span",{children:o(h==="full"?{id:"+/xYEI"}:{id:"2LiWsE"})})]}),e(ye,{onClick:()=>{Array.from(O.current.querySelectorAll(".spoiler-button:not(.spoiling), .spoiler-media-button:not(.spoiling)")).forEach(D=>{D.click()})},children:[e(I,{icon:"eye-open"})," ",e("span",{children:e(f,{id:"8r8KmB"})})]}),e(Ve,{}),e(bi,{className:"plain",children:e(f,{id:"Rsjgm0"})}),e(ye,{disabled:!K||j,onClick:()=>{const N=ed(B.url);N?location.hash=N:alert(o({id:"9J6biQ"}))},children:[e(I,{icon:"transfer"}),e("small",{class:"menu-double-lines",children:o(K?{id:"Kp9SAs",values:{0:un.toUnicode(K)}}:{id:"lb07+k"})})]})]}),e(ge,{class:"button plain deck-close",to:i,children:e(I,{icon:"x",size:"xl",alt:o({id:"yz7wBu"})})})]})]})}),T.length&&B?e("ul",{class:`timeline flat contextual grow ${k==="loading"?"loading":""}`,children:[xe,ue>0&&e("li",{class:"descendant descendant-more",children:e("button",{type:"button",class:"plain block show-more",disabled:k==="loading",onClick:()=>J(N=>N+yn),style:{marginBlockEnd:"6em"},"data-state-post-ids":De.join(" "),children:[e("div",{class:"ib avatars-bunch",children:T.slice(te,te+5).map(N=>e(mt,{url:N.account.avatarStatic},N.id))})," ",e("div",{class:"ib",children:[e(f,{id:"uXRAkV"})," ",e("span",{class:"tag",children:ue>yn?`${yn}+`:ue})]})]})})]}):e(U,{children:[k==="loading"&&e("ul",{class:"timeline flat contextual grow loading",children:e("li",{children:e(Ge,{skeleton:!0,size:"l"})})}),k==="error"&&e("p",{class:"ui-state",children:[e(f,{id:"JWxodU"}),e("br",{}),e("br",{}),e("button",{type:"button",onClick:()=>{x.reloadStatusPage++},children:e(f,{id:"KDw4GX"})})]})]})]})}function wo({replies:n,instance:i,hasParentThread:s,level:o,accWeight:c,openAll:l,parentLink:u}){const{_:r}=re(),[d,a]=vt(),h=_=>_.reduce((E,R)=>{const{repliesCount:F,replies:O}=R,W=(O==null?void 0:O.length)||F;return E+W+h(O||[])},0),p=n.length+h(n),g=n.length===p,y=n.map(_=>_.account).filter((_,E,R)=>R.findIndex(F=>F.id===_.id)===E).slice(0,3),b=Ae(()=>n==null?void 0:n.reduce((_,E)=>_+(E==null?void 0:E.weight),c),[c,n==null?void 0:n.length]);let w=!1;(l||b<=fd||!s&&p===1&&on(n[0])<2)&&(w=!0);const v=ai[n[0].id],m=it((_,E,R,F)=>{_.preventDefault(),_.stopPropagation(),a({media:E+1,mediaStatusID:F.id})},[]),S=q();St(()=>{var E;function _(R){R.target.dataset.scrollLeft=R.target.scrollLeft}return(E=S.current)==null||E.addEventListener("scroll",_,{passive:!0}),()=>{var R;(R=S.current)==null||R.removeEventListener("scroll",_)}},[]);const[C,T]=M(v||w);Q(()=>{let _;return!v&&!w&&(_=setTimeout(()=>T(!0),100)),()=>clearTimeout(_)},[v,w]);const A=w?"div":"details",k=A==="details";return e(A,{ref:S,class:"replies",open:k?v||w:void 0,onToggle:k?_=>{const{open:E}=_.target;ai[n[0].id]=E}:void 0,style:{"--comments-level":o},"data-comments-level":o,"data-comments-level-overflow":o>4,children:[!w&&e("summary",{class:"replies-summary",hidden:w,children:[e("span",{class:"avatars",children:y.map(_=>e(mt,{url:_.avatarStatic,title:`${_.displayName} @${_.username}`,squircle:_==null?void 0:_.bot},_.id))}),e("span",{class:"replies-counts",children:[e("b",{children:e(f,{id:"DOQUen",values:{0:n.length,1:Qe(n.length)},components:{0:e("span",{title:n.length})}})}),!g&&p>1&&e(U,{children:[" ","·"," ",e("span",{children:e(f,{id:"qSQQSe",values:{0:Qe(p),totalComments:p},components:{0:e("span",{title:p})}})})]})]}),e(I,{icon:"chevron-down",class:"replies-summary-chevron"}),!!u&&e(ge,{class:"replies-parent-link",to:u.to,onClick:u.onClick,title:r({id:"ZlV82A"}),children:"»"})]}),C&&e("ul",{children:n.map(_=>{var E,R;return e("li",{children:[e("div",{class:"status-focus",tabIndex:0,children:[e(Ge,{statusID:_.id,instance:i,withinContext:!0,size:"s",enableTranslate:!0,onMediaClick:m,showActionsBar:!0}),!((E=_.replies)!=null&&E.length)&&_.repliesCount>0&&e("div",{class:"replies-link",children:[e(I,{icon:"comment2",alt:r({id:"N8UzTV"})})," ",e("span",{title:_.repliesCount,children:Qe(_.repliesCount)})]})]}),((R=_.replies)==null?void 0:R.length)&&e(wo,{instance:i,replies:_.replies,level:_.level,accWeight:w?b:_.weight,openAll:l,parentLink:{to:i?`/${i}/s/${_.id}`:`/s/${_.id}`,onClick:()=>{Cn(_.id)}}})]},_.id)})})]})}const yd=140,bd=35,vd=70,wd=140,li=new Map;function on(n){var y,b;const i=li.get(n.id);if(i)return i;const{spoilerText:s,content:o,mediaAttachments:c,poll:l,card:u}=n,r=Ns(s+o),d=c!=null&&c.length?yd:0,a=(((y=l==null?void 0:l.options)==null?void 0:y.length)||0)*bd,h=u&&(c!=null&&c.length||(b=l==null?void 0:l.options)!=null&&b.length)?0:vd,g=(r+d+a+h)/wd;return li.set(n.id,g),g}const kd=ut(pd);function Sd(){const n=Mt(),{id:i,instance:s}=n;return e(kd,{id:i,instance:s})}const _d=""+new URL("boosts-carousel-BiOaNdMT.jpg",import.meta.url).href,Cd=""+new URL("grouped-notifications-DFgwVVj3.jpg",import.meta.url).href,Id=""+new URL("multi-column-ROck0NVt.jpg",import.meta.url).href,Td=""+new URL("multi-hashtag-timeline-DH5INVHi.jpg",import.meta.url).href,Ad=""+new URL("nested-comments-thread-hv59kZLc.jpg",import.meta.url).href,xd="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20fill-rule='evenodd'%20stroke-linejoin='round'%20stroke-miterlimit='2'%20clip-rule='evenodd'%20viewBox='0%200%20102%2028'%3e%3cpath%20fill='none'%20d='M0%200h101.5v27.5H0z'/%3e%3cg%20fill-rule='nonzero'%3e%3cpath%20fill='url(%23a)'%20d='M2.32%2021.85c1.4%200%202.21-.85%202.21-2.3v-4.64H8.5c4.45%200%207.54-2.9%207.54-7.24%200-4.35-2.98-7.24-7.32-7.24h-6.4C.93.43.11%201.28.11%202.73v16.82c0%201.45.82%202.3%202.21%202.3Zm2.21-10.4V3.94h3c2.54%200%204%201.34%204%203.75s-1.47%203.76-4%203.76h-3Z'/%3e%3cpath%20fill='url(%23b)'%20d='M20.52%2021.88c1.25%200%202.13-.76%202.13-2.23v-7.04c0-2.07%201.2-3.49%203.21-3.49%201.95%200%202.95%201.23%202.95%203.25v7.28c0%201.47.89%202.23%202.13%202.23%201.26%200%202.14-.76%202.14-2.23v-8.18c0-3.64-1.99-5.9-5.48-5.9-2.38%200-4.1%201.12-4.93%203.1h-.09V2.3c0-1.38-.78-2.2-2.1-2.2-1.31%200-2.1.82-2.1%202.2v17.34c0%201.47.9%202.23%202.14%202.23Z'/%3e%3cpath%20fill='url(%23c)'%20d='M40.45%2021.82c1.96%200%203.93-.98%204.8-2.65h.1v.8c.08%201.27.89%201.91%202.05%201.91%201.21%200%202.08-.73%202.08-2.15v-8.95c0-3.17-2.63-5.25-6.65-5.25-3.26%200-5.78%201.16-6.5%203.04-.15.32-.23.63-.23.96%200%20.97.75%201.64%201.79%201.64.69%200%201.23-.26%201.7-.79.95-1.23%201.74-1.65%203.04-1.65%201.62%200%202.64.85%202.64%202.31v1.04l-3.95.24c-3.93.23-6.13%201.88-6.13%204.74%200%202.83%202.27%204.76%205.26%204.76Zm1.4-3.09c-1.43%200-2.4-.73-2.4-1.9%200-1.12.91-1.83%202.51-1.95l3.31-.2v1.14c0%201.7-1.54%202.91-3.41%202.91Z'/%3e%3cpath%20fill='url(%23d)'%20d='M54.37%2021.88c1.26%200%202.14-.76%202.14-2.23v-7.09c0-2.03%201.21-3.44%203.13-3.44s2.89%201.17%202.89%203.22v7.31c0%201.47.88%202.23%202.14%202.23%201.24%200%202.13-.76%202.13-2.23v-8.2c0-3.68-1.96-5.87-5.45-5.87-2.41%200-4%201.07-4.83%203.01h-.09v-.87c0-1.35-.85-2.17-2.14-2.17-1.28%200-2.06.82-2.06%202.15v11.95c0%201.47.9%202.23%202.14%202.23Z'/%3e%3cpath%20fill='url(%23e)'%20d='M71.65%2027.17c1.26%200%202.14-.76%202.14-2.23v-6h.09a5.15%205.15%200%200%200%204.88%202.88c3.92%200%206.35-3.05%206.35-8.1%200-5.07-2.44-8.1-6.43-8.1a5.12%205.12%200%200%200-4.86%202.99h-.09v-.85c0-1.45-.88-2.21-2.1-2.21-1.24%200-2.11.76-2.11%202.2v17.2c0%201.46.89%202.22%202.13%202.22Zm5.6-8.8c-2.1%200-3.47-1.8-3.47-4.65%200-2.81%201.37-4.67%203.47-4.67%202.14%200%203.49%201.83%203.49%204.67%200%202.86-1.35%204.66-3.5%204.66Z'/%3e%3cpath%20fill='url(%23f)'%20d='M89.61%2027.39c3.44%200%205.26-1.5%206.73-5.55l4.81-13.1a4%204%200%200%200%20.24-1.26c0-1.13-.85-1.93-2.08-1.93-1.1%200-1.71.51-2.07%201.7l-3.4%2010.9h-.08L90.35%207.28c-.36-1.25-.94-1.73-2.07-1.73-1.26%200-2.21.83-2.21%201.99%200%20.35.09.82.25%201.26l5%2013.21-.21.56c-.52%201.1-1.32%201.42-2.07%201.42l-.75-.01c-.96%200-1.56.54-1.56%201.4%200%201.29%201%202%202.88%202Z'/%3e%3c/g%3e%3cdefs%3e%3cradialGradient%20id='a'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3cradialGradient%20id='b'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3cradialGradient%20id='c'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3cradialGradient%20id='d'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3cradialGradient%20id='e'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3cradialGradient%20id='f'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3c/defs%3e%3c/svg%3e",Ed={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Blaede Phanpy",PHANPY_DEFAULT_INSTANCE:"mastodon.blaede.family",PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:"https://mastodon.blaede.family/auth/sign_up",PHANPY_GIPHY_API_KEY:"48JGsrSS1XE5w4nWe9c9hqxPbsfRWR0e",PHANPY_LINGVA_INSTANCES:"lingva.phanpy.social lingva.lunar.icu lingva.garudalinux.org translate.plausibility.cloud",PHANPY_PRIVACY_POLICY_URL:"https://mastodon.blaede.family/privacy-policy",PHANPY_TRANSLANG_INSTANCES:"translang.phanpy.social",PHANPY_WEBSITE:"https://phanpy.blaede.family",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},{PHANPY_DEFAULT_INSTANCE:nn,PHANPY_WEBSITE:ps,PHANPY_PRIVACY_POLICY_URL:Rd,PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:ms}=Ed,gs=ps?ps.replace(/https?:\/\//g,"").replace(/\/$/,""):null,ys=`${"2025-07-10T18:22:36.776Z".slice(0,10).replace(/-/g,".")}.4758452`;function ko(){const{_:n}=re();return tt(null,["/","/welcome"]),e("main",{id:"welcome",children:[e("div",{class:"hero-container",children:[e("div",{class:"hero-content",children:[e("h1",{children:[e("img",{src:Ii,alt:"",width:"160",height:"160",style:{aspectRatio:"1/1",marginBlockEnd:-16}}),e("img",{src:xd,alt:"Phanpy",width:"200"})]}),e("p",{class:"desc",children:e(f,{id:"Ogtv0V"})}),e("p",{children:e(ge,{to:nn?`/login?instance=${nn}&submit=1`:"/login",class:"button",children:n(nn?{id:"sQia9P"}:{id:"ZLoGls"})})}),nn&&ms&&e("p",{children:e("a",{href:ms,class:"button plain5",children:e(f,{id:"e+RpCP"})})}),!nn&&e("p",{class:"insignificant",children:e("small",{children:e(f,{id:"fvAsUK",components:{0:e("br",{})}})})})]}),(gs||ys)&&e("p",{class:"app-site-version",children:e("small",{children:[gs," ",ys]})}),e("p",{children:e(f,{id:"BskFI2",components:{0:e("a",{href:"https://github.com/cheeaun/phanpy",target:"_blank"}),1:e("a",{href:"https://mastodon.social/@cheeaun",target:"_blank",onClick:i=>{i.preventDefault(),x.showAccount="cheeaun@mastodon.social"}}),2:e("a",{href:Rd,target:"_blank"})}})}),e("div",{children:e(Ti,{})})]}),e("div",{id:"why-container",children:e("div",{class:"sections",children:[e("section",{children:[e("img",{src:_d,alt:n({id:"S5cYrQ"}),loading:"lazy"}),e("h4",{children:e(f,{id:"Tu+sCN"})}),e("p",{children:e(f,{id:"e2uVlo"})})]}),e("section",{children:[e("img",{src:Ad,alt:n({id:"CGQ27z"}),loading:"lazy"}),e("h4",{children:e(f,{id:"cYE45+"})}),e("p",{children:e(f,{id:"Pc7QKh"})})]}),e("section",{children:[e("img",{src:Cd,alt:n({id:"rnrM7k"}),loading:"lazy"}),e("h4",{children:e(f,{id:"4RRMre"})}),e("p",{children:e(f,{id:"8GMtDr"})})]}),e("section",{children:[e("img",{src:Id,alt:n({id:"VLKtvP"}),loading:"lazy"}),e("h4",{children:e(f,{id:"pEkad9"})}),e("p",{children:e(f,{id:"t7Py5R"})})]}),e("section",{children:[e("img",{src:Td,alt:n({id:"wOax6E"}),loading:"lazy"}),e("h4",{children:e(f,{id:"Wi1Ov0"})}),e("p",{children:e(f,{id:"tS2i+h"})})]})]})})]})}const Ld=window.alert;window.__nativeAlert||(window.__nativeAlert=Ld);window.alert=function(n){n instanceof Error&&(n!=null&&n.message)&&(n=n.message),typeof n!="string"&&(n=JSON.stringify(n));const i=rc({text:n,className:"alert",gravity:"top",position:"center",duration:1e4,offset:{y:48},onClick:()=>{i.hideToast()}});i.showToast()};window.__STATES__=x;window.__STATES_STATS__=()=>{const n=["statuses","accounts","spoilers","unfurledLinks","statusQuotes"],i={};n.forEach(c=>{i[c]=Object.keys(x[c]).length});const{statuses:s}=x,o=[];for(const c in s)document.querySelector(`[data-state-post-id~="${c}"], [data-state-post-ids~="${c}"]`)||o.push(c)};setInterval(()=>{if(!window.__IDLE__)return;const{statuses:n,unfurledLinks:i,notifications:s}=x;let o=0;const{instance:c}=le();for(const l in n){if(!window.__IDLE__)break;try{const u=document.querySelector(`[data-state-post-id~="${l}"], [data-state-post-ids~="${l}"]`),r=s.some(d=>{var a;return l===rt((a=d.status)==null?void 0:a.id,c)});if(!u&&!r){delete x.statuses[l],delete x.statusQuotes[l];for(const d in i){const a=i[d];if(rt(a.id,a.instance)===l){delete x.unfurledLinks[d];break}}o++}}catch{}}},15*60*1e3);setTimeout(()=>{for(const n in Kt)setTimeout(()=>{var i,s,o,c,l,u;Array.isArray(Kt[n])?(s=(i=Kt[n])[0])==null||s.call(i):typeof Kt[n]=="object"?(c=(o=Kt[n]).module)==null||c.call(o):(u=(l=Kt)[n])==null||u.call(l)},1)},5e3);(()=>{window.__IDLE__=!0;const n=["mousemove","mousedown","resize","keydown","touchstart","pointerdown","pointermove","wheel"],i=()=>{window.__IDLE__=!0},o=Ps(i,3e3),c=()=>{window.__IDLE__=!1,o()};n.forEach(l=>{window.addEventListener(l,c,{passive:!0,capture:!0})}),window.addEventListener("blur",i,{passive:!0}),document.documentElement.addEventListener("mouseleave",l=>{!l.relatedTarget&&!l.toElement&&i()},{passive:!0})})();const Md=/iPad|iPhone|iPod/.test(navigator.userAgent);Md&&document.addEventListener("visibilitychange",()=>{if(document.visibilityState==="visible"){if(document.getElementsByClassName("media-modal-container").length>0)return;const i=ze.local.get("theme");let s;if(i){if(s=document.querySelector('meta[name="theme-color"][data-theme-setting="manual"]'),s){const o=s.content,c=i==="light"?s.dataset.themeLightColorTemp:s.dataset.themeDarkColorTemp;s.content=c||"",setTimeout(()=>{s.content=o},10)}}else{const o=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";if(s=document.querySelector(`meta[name="theme-color"][media*="${o}"]`),s){const c=s.dataset.content,l=s.dataset.contentTemp;s.content=l||"",setTimeout(()=>{s.content=c},10)}}}});{const n=ze.local.get("theme");if(n){document.documentElement.classList.add(`is-${n}`),document.querySelector('meta[name="color-scheme"]').setAttribute("content",n||"dark light");const s=document.querySelector('meta[data-theme-setting="manual"]');s&&(s.name="theme-color",s.content=n==="light"?s.dataset.themeLightColor:s.dataset.themeDarkColor),document.querySelectorAll('meta[data-theme-setting="auto"]').forEach(c=>{c.name=""})}const i=ze.local.get("textSize");i&&document.documentElement.style.setProperty("--text-size",`${i}px`)}ws(x,n=>{var i;for(const[s,o,c,l]of n){if(o.join(".")==="settings.shortcutsViewMode"){const u=document.getElementById("app");u&&(u.dataset.shortcutsViewMode=(i=x.shortcuts)!=null&&i.length?c:"")}o.join(".")==="settings.cloakMode"&&document.body.classList.toggle("cloak",c)}});const bn=new Map;window.__BENCH_RESULTS=new Map;window.__BENCHMARK={start(n){},end(n){}};document.body.classList.toggle("exp-tab-bar-v2",ze.local.get("experiments-tabBarV2")??!1);function $d(){const[n,i]=M(!1),[s,o]=M("loading");__BENCHMARK.start("app-init"),__BENCHMARK.start("time-to-following"),__BENCHMARK.start("time-to-home"),__BENCHMARK.start("time-to-isLoggedIn"),re(),Q(()=>{const l=ze.local.get("instanceURL"),u=decodeURIComponent((window.location.search.match(/code=([^&]+)/)||[,""])[1]);if(u){window.history.replaceState({},document.title,window.location.pathname||"/");const{client_id:r,client_secret:d,vapid_key:a}=Cs(l)||{},h=Tn(l)||a,p=ze.sessionCookie.get("codeVerifier");(async()=>{o("loading");const{access_token:g}=await Hc({instanceURL:l,client_id:r,client_secret:d,code:u,code_verifier:p||void 0});if(g){const y=zo({instance:l,accessToken:g});await Promise.allSettled([Yn(y),qn(y,l),Uo(y,l,g,h)]),Ni(),window.__IGNORE_GET_ACCOUNT_ERROR__=!0,i(!0),o("default")}else o("error");__BENCHMARK.end("app-init")})()}else{window.__IGNORE_GET_ACCOUNT_ERROR__=!0;const r=decodeURIComponent((window.location.search.match(/account=([^&]+)/)||[,""])[1]);let d;if(r&&(d=Bo(r),d&&(In(d.info.id),window.history.replaceState({},document.title,window.location.pathname||"/"))),d||(d=hi()),d){In(d.info.id);const{client:a}=le({account:d}),{instance:h}=a;Ni(),o("loading"),(async()=>{try{Fo()&&Ko(h)?(Yn(a),qn(a,h)):await Promise.allSettled([Yn(a),qn(a,h)])}catch{}finally{i(!0),o("default"),__BENCHMARK.end("app-init")}})()}else o("default"),__BENCHMARK.end("app-init")}ze.sessionCookie.del("clientID"),ze.sessionCookie.del("clientSecret"),ze.sessionCookie.del("codeVerifier")},[]);let c=Jt();return x.currentLocation=c.pathname,Q(ii,[c,n]),/\/https?:/.test(c.pathname)?e(td,{}):s==="loading"?e(Be,{id:"loader-root"}):e(U,{children:[e(Pd,{isLoggedIn:n}),e(Dd,{isLoggedIn:n}),e(pi,{children:e(Xe,{path:"/:instance?/s/:id",element:e(Sd,{})})}),n&&e(pc,{}),n&&e(Il,{}),e(bl,{}),n&&e(Sl,{}),e(hc,{isLoggedIn:n}),e(_l,{onClose:ii}),e(mc,{})]})}function Nd({isLoggedIn:n}){return n&&__BENCHMARK.end("time-to-isLoggedIn"),n?e(Jr,{}):e(ko,{})}const Pd=ut(({isLoggedIn:n})=>{const i=Jt(),s=Ae(()=>{const{pathname:o}=i;return!/^\/(login|welcome|_sandbox)/i.test(o)},[i]);return e(pi,{location:s||i,children:[e(Xe,{path:"/",element:e(Nd,{isLoggedIn:n})}),e(Xe,{path:"/login",element:e(cd,{})}),e(Xe,{path:"/welcome",element:e(ko,{})}),void 0]})});function bs(){return x.prevLocation||null}function Dd({isLoggedIn:n}){const i=Jt(),s=q(bs());return Ae(()=>cn("/:instance/s/:id",i.pathname)||cn("/s/:id",i.pathname),[i.pathname,cn])?s.current||(s.current=bs()):s.current=null,e(pi,{location:s.current||i,children:[n&&e(U,{children:[e(Xe,{path:"/notifications",element:e(mo,{})}),e(Xe,{path:"/mentions",element:e(ro,{})}),e(Xe,{path:"/following",element:e(Mi,{})}),e(Xe,{path:"/b",element:e(to,{})}),e(Xe,{path:"/f",element:e(no,{})}),e(Xe,{path:"/l",children:[e(Xe,{index:!0,element:e(nd,{})}),e(Xe,{path:":id",element:e(oo,{})})]}),e(Xe,{path:"/fh",element:e(gr,{})}),e(Xe,{path:"/sp",element:e(ld,{})}),e(Xe,{path:"/ft",element:e(hr,{})}),e(Xe,{path:"/catchup",element:e(er,{})}),e(Xe,{path:"/annual_report/:year",element:e(jl,{})})]}),e(Xe,{path:"/:instance?/t/:hashtag",element:e(so,{})}),e(Xe,{path:"/:instance?/a/:id",element:e(Kl,{})}),e(Xe,{path:"/:instance?/p",children:[e(Xe,{index:!0,element:e(ci,{})}),e(Xe,{path:"l",element:e(ci,{local:!0})})]}),e(Xe,{path:"/:instance?/trending",element:e(bo,{})}),e(Xe,{path:"/:instance?/search",element:e(go,{})})]})}Ho();Yo(e(qo,{i18n:pe,children:e(jo,{children:e($d,{})})}),document.getElementById("app"));setTimeout(()=>{try{Object.keys(localStorage).forEach(n=>{n.startsWith("iconify")&&localStorage.removeItem(n)}),Object.keys(sessionStorage).forEach(n=>{n.startsWith("iconify")&&sessionStorage.removeItem(n)}),localStorage.removeItem("settings:boostsCarousel")}catch{}},5e3);if("serviceWorker"in navigator&&typeof caches<"u"){const i=["icons"];let s=!1;const o=1e4,c=60*60*1e3;async function l(){if(window.__IDLE__)try{const u=await caches.keys();for(const r of u){if(i.includes(r))continue;const d=await caches.open(r),a=await d.keys();if(a.length>50){const h=a.slice(50);for(const p of h)await d.delete(p)}}s=!0}catch{}setTimeout(l,s?c:o)}setTimeout(l,o)}window.__CLOAK__=()=>{document.body.classList.toggle("cloak")};
//# sourceMappingURL=main-CNsOHh3U.js.map
