import{A as q,y as ie,M as dt,u as de,d as R,s as x,a as ce,b as Qe,p as bt,c as Ge,q as ot,g as wt,e,k as U,T as h,f as ye,h as Rt,i as _n,j as _e,L as bo,C as zn,D as yo,m as vo,n as Wn,o as ps,r as Wt,t as he,v as wo,w as Ue,x as Cn,z as xi,_ as kt,B as ms,E as _d,F as gs,G as bs,H as ko,I as So,J as rt,K as _o,N as ci,O as Co,P as yt,Q as Io,R as Ao,S as ai,U as Lt,V as tt,W as ys,X as vs,Y as To,Z as nn,$ as xo,a0 as Eo,a1 as Un,a2 as Bn,a3 as Ro,a4 as Ei,a5 as Lo,a6 as Mo,a7 as $o,a8 as ri,a9 as Ke,aa as No,ab as Po,ac as Do,ad as Oo}from"./useTitle-BJe98Jmu.js";import{u as li,s as Fe,a as pe,o as Ri,b as zo,V as ws,c as ks,I as A,C as di,d as Ss,M as Ye,e as Ve,S as an,f as ve,g as Ln,R as It,n as ct,h as He,A as pt,N as gt,i as lt,j as ht,L as ge,l as xt,k as Uo,m as _s,p as et,q as Id,r as st,t as rn,v as ft,w as Zn,x as Cs,E as Is,y as Je,z as Li,T as As,B as mt,D as ui,F as qe,G as Ct,H as Bo,J as Fo,K as Dt,O as hi,P as Ts,Q as Ho,U as qt,W as Yo,X as qo,Y as Mn,Z as jo,_ as Ot,$ as Go,a0 as xs,a1 as Es,a2 as Ko,a3 as Rs,a4 as Vo,a5 as Wo,a6 as Zo,a7 as Xo,a8 as Jo,a9 as Mi,aa as Qo,ab as Bt}from"./ScheduledAtField-DHD2UnRo.js";var Ls=ec;function ec(n,i,s){var o=null,c=null,r=function(){o&&(clearTimeout(o),c=null,o=null)},u=function(){var l=c;r(),l&&l()},d=function(){if(!i)return n.apply(this,arguments);var l=this,a=arguments,p=s&&!o;if(r(),c=function(){n.apply(l,a)},o=setTimeout(function(){if(o=null,!p){var y=c;return c=null,y()}},i),p)return c()};return d.cancel=r,d.flush=u,d}/*!
 * swiped-events.js - v@version@
 * Pure JavaScript swipe events
 * https://github.com/john-doherty/swiped-events
 * @inspiration https://stackoverflow.com/questions/16348031/disable-scrolling-when-touch-moving-certain-element
 * @author John Doherty <www.johndoherty.info>
 * @license MIT
 */(function(n,i){"use strict";typeof n.CustomEvent!="function"&&(n.CustomEvent=function(b,f){f=f||{bubbles:!1,cancelable:!1,detail:void 0};var g=i.createEvent("CustomEvent");return g.initCustomEvent(b,f.bubbles,f.cancelable,f.detail),g},n.CustomEvent.prototype=n.Event.prototype),i.addEventListener("touchstart",p,!1),i.addEventListener("touchmove",y,!1),i.addEventListener("touchend",a,!1);var s=null,o=null,c=null,r=null,u=null,d=null,l=0;function a(b){if(d===b.target){var f=parseInt(m(d,"data-swipe-threshold","20"),10),g=m(d,"data-swipe-unit","px"),v=parseInt(m(d,"data-swipe-timeout","500"),10),w=Date.now()-u,_="",S=b.changedTouches||b.touches||[];if(g==="vh"&&(f=Math.round(f/100*i.documentElement.clientHeight)),g==="vw"&&(f=Math.round(f/100*i.documentElement.clientWidth)),Math.abs(c)>Math.abs(r)?Math.abs(c)>f&&w<v&&(c>0?_="swiped-left":_="swiped-right"):Math.abs(r)>f&&w<v&&(r>0?_="swiped-up":_="swiped-down"),_!==""){var k={dir:_.replace(/swiped-/,""),touchType:(S[0]||{}).touchType||"direct",fingers:l,xStart:parseInt(s,10),xEnd:parseInt((S[0]||{}).clientX||-1,10),yStart:parseInt(o,10),yEnd:parseInt((S[0]||{}).clientY||-1,10)};d.dispatchEvent(new CustomEvent("swiped",{bubbles:!0,cancelable:!0,detail:k})),d.dispatchEvent(new CustomEvent(_,{bubbles:!0,cancelable:!0,detail:k}))}s=null,o=null,u=null}}function p(b){b.target.getAttribute("data-swipe-ignore")!=="true"&&(d=b.target,u=Date.now(),s=b.touches[0].clientX,o=b.touches[0].clientY,c=0,r=0,l=b.touches.length)}function y(b){if(!(!s||!o)){var f=b.touches[0].clientX,g=b.touches[0].clientY;c=s-f,r=o-g}}function m(b,f,g){for(;b&&b!==i.documentElement;){var v=b.getAttribute(f);if(v)return v;b=b.parentNode}return g}})(window,document);function jt(n=()=>{},i=[]){const s=q(n);ie(()=>{s.current=n},[i]),ie(()=>{const o=()=>{const c=document.hidden||document.visibilityState==="hidden";s.current(!c)};return document.addEventListener("visibilitychange",o),()=>document.removeEventListener("visibilitychange",o)},[])}const tc=1e3*3,$i=2e4,nc=dt(function({isLoggedIn:i}){const{_:s}=de(),[o,c]=R(!0),r=q();jt(a=>{clearTimeout(r.current),a?c(!0):r.current=setTimeout(()=>{c(!1)},$i)});const u=async(a,p,y)=>{var m;if(x.notificationsLast){const b=a.v1.notifications.list({limit:1,sinceId:x.notificationsLast.id}),{value:f}=await b.next();if(f!=null&&f.length)if(y)x.notificationsShowNew=!0;else{let g;try{const v=await a.v1.markers.fetch({timeline:"notifications"});g=(m=v==null?void 0:v.notifications)==null?void 0:m.lastReadId}catch{}g?x.notificationsShowNew=f[0].id!==g:x.notificationsShowNew=!0}}};ie(()=>{let a,p,y;if(i&&o){const{masto:m,streaming:b,instance:f}=ce();(async()=>{await u(m,f);let g=!1;b&&(p=setTimeout(()=>{(async()=>{try{g=!0,a=b.user.notification.subscribe();for await(const v of a){if(!a||!o)break;v.event==="notification"&&Qe(v.payload,f,{skipThreading:!0}),x.notificationsShowNew=!0}}catch{g=!1}g||(y=setInterval(()=>{u(m,f,!0)},$i))})()},tc))})()}return()=>{var m;(m=a==null?void 0:a.unsubscribe)==null||m.call(a),a=null,clearTimeout(p),clearInterval(y)}},[o,i]);const d=q(),l=()=>{d.current=Date.now(),fetch("./version.json").then(a=>a.json()).then(a=>{a&&(x.appVersion=a)}).catch(a=>{})};return li(l,o&&1e3*60*30),jt(a=>{a&&(d.current?Date.now()-d.current>1e3*60*60&&l():l())}),Fe("shift+alt+k",a=>{if(!a.shiftKey||!a.altKey)return;const p=x.settings.cloakMode;x.settings.cloakMode=!p,pe({text:s(p?{id:"oguMwa"}:{id:"IXZLPs"})})},{useKey:!0}),null}),ic=bt(async(n,i)=>{const s=n.v1.accounts.$select(i).statuses.list({limit:3,exclude_replies:!0,exclude_reblogs:!0}),{value:o}=await s.next();return o||[]},{maxAge:6e4});function sc(){const{_:n}=de(),i=Ge(x),{masto:s}=ce(),[o,c]=R(!1),[r,u]=R([]),[d,l]=R(!1),a=q(null),p=q(null);function y(g){if(i.composerState.minimized){x.composerState.minimized=!1,Ri();return}g.shiftKey?zo()||(x.showCompose=!0):(Ri(),x.showCompose=!0)}Fe("c, shift+c",y,{ignoreEventWhen:g=>!!document.querySelector("#modal-container > *")},{useKey:!0});const m=ws(()=>{c(!0)},{threshold:600}),b=ot(async()=>{try{l(!0);const g=wt();if(!g)return;const v=await ic(s,g);u(v)}catch{}finally{l(!1)}},[s]),f=ot(g=>{ks({replyToStatus:g}),c(!1)},[]);return ie(()=>{o&&b()},[b,o]),e(U,{children:[e("button",{ref:a,type:"button",id:"compose-button",onClick:y,onContextMenu:g=>{g.preventDefault(),c(!0)},...m(),class:`${i.composerState.minimized?"min":""} ${i.composerState.publishing?"loading":""} ${i.composerState.publishingError?"error":""}`,children:e(A,{icon:"quill",size:"xl",alt:n({id:"QOhkyl"})})}),e(di,{ref:p,state:o?"open":void 0,anchorRef:a,onClose:()=>c(!1),direction:"top",gap:8,unmountOnClose:!0,portal:{target:document.body},boundingBoxPadding:Ss(),containerProps:{style:{zIndex:19},onClick:()=>{var g,v;(v=(g=p.current)==null?void 0:g.closeMenu)==null||v.call(g)}},submenuOpenDelay:600,children:[e(Ye,{to:"/sp",children:[e(A,{icon:"schedule"})," ",e("span",{children:e(h,{id:"+GkIdc"})})]}),e(Ve,{}),e(an,{align:"end",direction:"top",shift:-8,disabled:d||r.length===0,label:e(U,{children:[e(A,{icon:"comment"})," ",e("span",{className:"menu-grow",children:e(h,{id:"LwOr4P"})}),d?"…":e(A,{icon:"chevron-right"})]}),children:r.length>0&&r.map(g=>{const v=new Date(g.createdAt),w=new Date().getTime()-v.getTime()<864e5;return e(ve,{onClick:()=>f(g),children:e("small",{children:[e("div",{class:"menu-post-text",children:Ln(g)}),e("span",{className:"more-insignificant",children:[w&&e(U,{children:[e(It,{datetime:v,format:"micro"})," ","‒"," "]}),e("time",{className:"created",dateTime:v.toISOString(),title:v.toLocaleString(),children:ct(g.createdAt)})]})]})},g.id)})})]})]})}const oc=dt(function(){const{_:i}=de(),s=Ge(x);function o(){x.showKeyboardShortcutsHelp=!1}return Fe("?",()=>{x.showKeyboardShortcutsHelp=!0},{useKey:!0,ignoreEventWhen:c=>/\/catchup/i.test(location.hash)}),!!s.showKeyboardShortcutsHelp&&e(He,{onClose:o,children:e("div",{id:"keyboard-shortcuts-help-container",class:"sheet",tabindex:"-1",children:[e("button",{type:"button",class:"sheet-close",onClick:o,children:e(A,{icon:"x",alt:i({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(h,{id:"77Emn0"})})}),e("main",{children:e("table",{children:e("tbody",{children:[{action:i({id:"ulXSNi"}),keys:e("kbd",{children:"?"})},{action:i({id:"Gy9P9T"}),keys:e("kbd",{children:"j"})},{action:i({id:"6XYpYY"}),keys:e("kbd",{children:"k"})},{action:i({id:"DYowFe"}),keys:e(h,{id:"mzjGX4",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"S5ez7Y"}),keys:e(h,{id:"Fd8FaU",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"VkLESX"}),keys:e("kbd",{children:"."})},{action:i({id:"jsFF8C"}),keys:e(h,{id:"80sOCm",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:e(h,{id:"41gejM",components:{0:e("br",{})}}),keys:e("kbd",{children:"x"})},{action:i({id:"jAj8rv"}),keys:e(h,{id:"evz6c6",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"duF1lx"}),keys:e(h,{id:"nhpsIN",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"YrR3Co"}),keys:e("kbd",{children:"]"})},{action:i({id:"noxAFR"}),keys:e("kbd",{children:"["})},{action:i({id:"AIa/f7"}),keys:e("kbd",{children:"c"})},{action:i({id:"snPx8X"}),className:"insignificant",keys:e(h,{id:"+Cxvld",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"1pKapz"}),keys:e(h,{id:"py67WT",components:{0:e("kbd",{}),1:e("kbd",{}),2:e("kbd",{}),3:e("kbd",{})}})},{action:i({id:"A1taO8"}),keys:e("kbd",{children:"/"})},{action:i({id:"ImOQa9"}),keys:e("kbd",{children:"r"})},{action:i({id:"KFs8c6"}),className:"insignificant",keys:e(h,{id:"XpQLJF",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"cqi4Mx"}),keys:e(h,{id:"84WuL2",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"kulphB"}),keys:e(h,{id:"yrz6Ck",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"PZlHt8"}),keys:e("kbd",{children:"d"})},{action:i({id:"C7ujRh"}),keys:e(h,{id:"v4TbMP",components:{0:e("kbd",{}),1:e("kbd",{}),2:e("kbd",{})}})}].map(({action:c,className:r,keys:u})=>e("tr",{children:[e("th",{class:r,children:c}),e("td",{children:u})]},c))})})})]})})}),Ms=new Set,at=new WeakMap,Gt=new WeakMap,zt=new WeakMap,Xn=new WeakMap,cc=new WeakMap,Kt=new WeakMap,In=new WeakMap,en=new WeakSet;let Et,fi=0,pi=0;const St="__aa_tgt",sn="__aa_del",An="__aa_new",ac=n=>{const i=fc(n);i&&i.forEach(s=>pc(s))},rc=n=>{n.forEach(i=>{i.target===Et&&dc(),at.has(i.target)&&Ut(i.target)})};function lc(n){const i=Xn.get(n);i==null||i.disconnect();let s=at.get(n),o=0;const c=5;s||(s=Vt(n),at.set(n,s));const{offsetWidth:r,offsetHeight:u}=Et,l=[s.top-c,r-(s.left+c+s.width),u-(s.top+c+s.height),s.left-c].map(p=>`${-1*Math.floor(p)}px`).join(" "),a=new IntersectionObserver(()=>{++o>1&&Ut(n)},{root:Et,threshold:1,rootMargin:l});a.observe(n),Xn.set(n,a)}function Ut(n){clearTimeout(In.get(n));const i=$n(n),s=on(i)?500:i.duration;In.set(n,setTimeout(async()=>{const o=zt.get(n);try{await(o==null?void 0:o.finished),at.set(n,Vt(n)),lc(n)}catch{}},s))}function dc(){clearTimeout(In.get(Et)),In.set(Et,setTimeout(()=>{Ms.forEach(n=>Ds(n,i=>$s(()=>Ut(i))))},100))}function uc(n){setTimeout(()=>{cc.set(n,setInterval(()=>$s(Ut.bind(null,n)),2e3))},Math.round(2e3*Math.random()))}function $s(n){typeof requestIdleCallback=="function"?requestIdleCallback(()=>n()):requestAnimationFrame(()=>n())}let Jn,Yt;const hc=typeof window<"u"&&"ResizeObserver"in window;hc&&(Et=document.documentElement,Jn=new MutationObserver(ac),Yt=new ResizeObserver(rc),window.addEventListener("scroll",()=>{pi=window.scrollY,fi=window.scrollX}),Yt.observe(Et));function fc(n){return n.reduce((o,c)=>[...o,...Array.from(c.addedNodes),...Array.from(c.removedNodes)],[]).every(o=>o.nodeName==="#comment")?!1:n.reduce((o,c)=>{if(o===!1)return!1;if(c.target instanceof Element){if(Fn(c.target),!o.has(c.target)){o.add(c.target);for(let r=0;r<c.target.children.length;r++){const u=c.target.children.item(r);if(u){if(sn in u)return!1;Fn(c.target,u),o.add(u)}}}if(c.removedNodes.length)for(let r=0;r<c.removedNodes.length;r++){const u=c.removedNodes[r];if(sn in u)return!1;u instanceof Element&&(o.add(u),Fn(c.target,u),Gt.set(u,[c.previousSibling,c.nextSibling]))}}return o},new Set)}function Fn(n,i){!i&&!(St in n)?Object.defineProperty(n,St,{value:n}):i&&!(St in i)&&Object.defineProperty(i,St,{value:n})}function pc(n){var i;const s=n.isConnected,o=at.has(n);s&&Gt.has(n)&&Gt.delete(n),zt.has(n)&&((i=zt.get(n))===null||i===void 0||i.cancel()),An in n?Ni(n):o&&s?gc(n):o&&!s?bc(n):Ni(n)}function vt(n){return Number(n.replace(/[^0-9.\-]/g,""))}function mc(n){let i=n.parentElement;for(;i;){if(i.scrollLeft||i.scrollTop)return{x:i.scrollLeft,y:i.scrollTop};i=i.parentElement}return{x:0,y:0}}function Vt(n){const i=n.getBoundingClientRect(),{x:s,y:o}=mc(n);return{top:i.top+o,left:i.left+s,width:i.width,height:i.height}}function Ns(n,i,s){let o=i.width,c=i.height,r=s.width,u=s.height;const d=getComputedStyle(n);if(d.getPropertyValue("box-sizing")==="content-box"){const a=vt(d.paddingTop)+vt(d.paddingBottom)+vt(d.borderTopWidth)+vt(d.borderBottomWidth),p=vt(d.paddingLeft)+vt(d.paddingRight)+vt(d.borderRightWidth)+vt(d.borderLeftWidth);o-=p,r-=p,c-=a,u-=a}return[o,r,c,u].map(Math.round)}function $n(n){return St in n&&Kt.has(n[St])?Kt.get(n[St]):{duration:250,easing:"ease-in-out"}}function Ps(n){if(St in n)return n[St]}function mi(n){const i=Ps(n);return i?en.has(i):!1}function Ds(n,...i){i.forEach(s=>s(n,Kt.has(n)));for(let s=0;s<n.children.length;s++){const o=n.children.item(s);o&&i.forEach(c=>c(o,Kt.has(o)))}}function gi(n){return Array.isArray(n)?n:[n]}function on(n){return typeof n=="function"}function gc(n){const i=at.get(n),s=Vt(n);if(!mi(n))return at.set(n,s);let o;if(!i)return;const c=$n(n);if(typeof c!="function"){const r=i.left-s.left,u=i.top-s.top,[d,l,a,p]=Ns(n,i,s),y={transform:`translate(${r}px, ${u}px)`},m={transform:"translate(0, 0)"};d!==l&&(y.width=`${d}px`,m.width=`${l}px`),a!==p&&(y.height=`${a}px`,m.height=`${p}px`),o=n.animate([y,m],{duration:c.duration,easing:c.easing})}else{const[r]=gi(c(n,"remain",i,s));o=new Animation(r),o.play()}zt.set(n,o),at.set(n,s),o.addEventListener("finish",Ut.bind(null,n))}function Ni(n){An in n&&delete n[An];const i=Vt(n);at.set(n,i);const s=$n(n);if(!mi(n))return;let o;if(typeof s!="function")o=n.animate([{transform:"scale(.98)",opacity:0},{transform:"scale(0.98)",opacity:0,offset:.5},{transform:"scale(1)",opacity:1}],{duration:s.duration*1.5,easing:"ease-in"});else{const[c]=gi(s(n,"add",i));o=new Animation(c),o.play()}zt.set(n,o),o.addEventListener("finish",Ut.bind(null,n))}function Pi(n,i){var s;n.remove(),at.delete(n),Gt.delete(n),zt.delete(n),(s=Xn.get(n))===null||s===void 0||s.disconnect(),setTimeout(()=>{if(sn in n&&delete n[sn],Object.defineProperty(n,An,{value:!0,configurable:!0}),i&&n instanceof HTMLElement)for(const o in i)n.style[o]=""},0)}function bc(n){var i;if(!Gt.has(n)||!at.has(n))return;const[s,o]=Gt.get(n);Object.defineProperty(n,sn,{value:!0,configurable:!0});const c=window.scrollX,r=window.scrollY;if(o&&o.parentNode&&o.parentNode instanceof Element?o.parentNode.insertBefore(n,o):s&&s.parentNode?s.parentNode.appendChild(n):(i=Ps(n))===null||i===void 0||i.appendChild(n),!mi(n))return Pi(n);const[u,d,l,a]=vc(n),p=$n(n),y=at.get(n);(c!==fi||r!==pi)&&yc(n,c,r,p);let m,b={position:"absolute",top:`${u}px`,left:`${d}px`,width:`${l}px`,height:`${a}px`,margin:"0",pointerEvents:"none",transformOrigin:"center",zIndex:"100"};if(!on(p))Object.assign(n.style,b),m=n.animate([{transform:"scale(1)",opacity:1},{transform:"scale(.98)",opacity:0}],{duration:p.duration,easing:"ease-out"});else{const[f,g]=gi(p(n,"remove",y));(g==null?void 0:g.styleReset)!==!1&&(b=(g==null?void 0:g.styleReset)||b,Object.assign(n.style,b)),m=new Animation(f),m.play()}zt.set(n,m),m.addEventListener("finish",Pi.bind(null,n,b))}function yc(n,i,s,o){const c=fi-i,r=pi-s,u=document.documentElement.style.scrollBehavior;if(getComputedStyle(Et).scrollBehavior==="smooth"&&(document.documentElement.style.scrollBehavior="auto"),window.scrollTo(window.scrollX+c,window.scrollY+r),!n.parentElement)return;const l=n.parentElement;let a=l.clientHeight,p=l.clientWidth;const y=performance.now();function m(){requestAnimationFrame(()=>{if(!on(o)){const b=a-l.clientHeight,f=p-l.clientWidth;y+o.duration>performance.now()?(window.scrollTo({left:window.scrollX-f,top:window.scrollY-b}),a=l.clientHeight,p=l.clientWidth,m()):document.documentElement.style.scrollBehavior=u}})}m()}function vc(n){const i=at.get(n),[s,,o]=Ns(n,i,Vt(n));let c=n.parentElement;for(;c&&(getComputedStyle(c).position==="static"||c instanceof HTMLBodyElement);)c=c.parentElement;c||(c=document.body);const r=getComputedStyle(c),u=at.get(c)||Vt(c),d=Math.round(i.top-u.top)-vt(r.borderTopWidth),l=Math.round(i.left-u.left)-vt(r.borderLeftWidth);return[d,l,s,o]}function Os(n,i={}){return Jn&&Yt&&(window.matchMedia("(prefers-reduced-motion: reduce)").matches&&!on(i)&&!i.disrespectUserMotionPreference||(en.add(n),getComputedStyle(n).position==="static"&&Object.assign(n.style,{position:"relative"}),Ds(n,Ut,uc,c=>Yt==null?void 0:Yt.observe(c)),on(i)?Kt.set(n,i):Kt.set(n,{duration:250,easing:"ease-in-out",...i}),Jn.observe(n,{childList:!0}),Ms.add(n))),Object.freeze({parent:n,enable:()=>{en.add(n)},disable:()=>{en.delete(n)},isEnabled:()=>en.has(n)})}function bi(n){const i=q(null),[s,o]=R(),c=r=>{s&&(r?s.enable():s.disable())};return ie(()=>{i.current instanceof HTMLElement&&o(Os(i.current,n||{}))},[]),[i,c]}const wc=window.matchMedia("(display-mode: standalone)").matches;function kc({onClose:n}){const{_:i}=de(),{masto:s}=ce(),o=ye.local.getJSON("accounts"),c=wt(),r=o.length>1,[u,d]=Rt(a=>a+1,0),[l]=bi();return e("div",{id:"accounts-container",class:"sheet",tabIndex:"-1",children:[!!n&&e("button",{type:"button",class:"sheet-close",onClick:n,children:e(A,{icon:"x",alt:i({id:"yz7wBu"})})}),e("header",{class:"header-grid",children:e("h2",{children:e(h,{id:"bPwFdf"})})}),e("main",{children:e("section",{children:[e("ul",{class:"accounts-list",ref:l,children:o.map((a,p)=>{const y=a.info.id===c,m=p===0;return e("li",{children:[e("div",{children:[r&&e("span",{class:`current ${y?"is-current":""}`,children:e(A,{icon:"check-circle",alt:i({id:"Hp1l6f"})})}),e(pt,{url:a.info.avatarStatic,size:"xxl",onDblClick:async()=>{if(y)try{const b=await s.v1.accounts.$select(a.info.id).fetch();a.info=b,ye.local.setJSON("accounts",o),d()}catch{}}}),e(gt,{account:r?{...a.info,acct:/@/.test(a.info.acct)?a.info.acct:`${a.info.acct}@${a.instanceURL}`}:a.info,showAcct:!0,onClick:()=>{y?x.showAccount=`${a.info.username}@${a.instanceURL}`:(_n(a.info.id),location.reload())}})]}),e("div",{class:"actions",children:[m&&r&&e(U,{children:[e("span",{class:"tag",children:e(h,{id:"ovBPCi"})})," "]}),e(lt,{align:"end",menuButton:e("button",{type:"button",class:"plain more-button",children:e(A,{icon:"more",size:"l",alt:i({id:"2FYpfJ"})})}),children:[r&&e(U,{children:[e(ve,{disabled:y,onClick:()=>{_n(a.info.id),location.reload()},children:[e(A,{icon:"transfer"})," ",e(h,{id:"3t/Nrv"})]}),!wc&&!y&&e(Ye,{href:`./?account=${a.info.id}`,target:"_blank",children:[e(A,{icon:"external"}),e("span",{children:e(h,{id:"PZgZtY"})})]}),e(Ve,{})]}),e(ve,{onClick:()=>{x.showAccount=`${a.info.username}@${a.instanceURL}`},children:[e(A,{icon:"user"}),e("span",{children:e(h,{id:"40z2Fm"})})]}),e(Ve,{}),r&&e(ve,{disabled:m,onClick:()=>{o.splice(p,1),o.unshift(a),ye.local.setJSON("accounts",o),d()},children:[e(A,{icon:"check-circle"}),e("span",{children:e(h,{id:"PPcets"})})]}),e(ht,{subMenu:!0,confirmLabel:e(U,{children:[e(A,{icon:"exit"}),e("span",{children:e(h,{id:"k08LxG",values:{0:a.info.acct},components:{0:e("span",{class:"bidi-isolate"})}})})]}),disabled:!y,menuItemClassName:"danger",onClick:()=>{o.splice(p,1),ye.local.setJSON("accounts",o),location.href=location.pathname||"/"},children:[e(A,{icon:"exit"}),e("span",{children:e(h,{id:"CXk1bI"})})]})]})]})]},a.info.id)})}),e("p",{children:e(ge,{to:"/login",class:"button plain2",onClick:n,children:[e(A,{icon:"plus"})," ",e("span",{children:e(h,{id:"Is7/PB"})})]})}),r&&e("p",{children:e("small",{children:e(h,{id:"52x24e",components:{0:e("i",{})}})})})]})})]})}const yi="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20fill-rule='evenodd'%20stroke-linejoin='round'%20stroke-miterlimit='2'%20clip-rule='evenodd'%20viewBox='0%200%2064%2064'%3e%3cpath%20fill='none'%20d='M0%200h63.994v63.994H0z'/%3e%3cpath%20fill='%23a4bff7'%20d='M37.774%2011.471c14.639%203.752%2019.034%2016.557%2015.889%2031.304-.696%203.261-2.563%206.661-6.356%208.693-3.204%201.717-8.07%202.537-15.338.55l-9.634-2.404C11.651%2046.992%208.378%2038.733%2010.027%2031.823c3.627-15.201%2015.543-23.48%2027.747-20.352Z'/%3e%3cpath%20fill='%23d8e7fe'%20d='M36.76%2015.429c12.289%203.15%2015.547%2014.114%2012.907%2026.493-.947%204.44-4.937%209.365-16.664%206.143l-9.684-2.417c-7.854-1.923-10.53-7.8-9.318-12.877%203.016-12.639%2012.611-19.943%2022.759-17.342Z'/%3e%3cpath%20fill='%236081e6'%20d='M27.471%2024.991c-1.457-.698-7.229%203.213-7.663%208.926-.182%202.39%204.55%203.237%205.071-.169.725-4.743%203.715-8.218%202.592-8.757Zm10.746%202.005c-2.083.327-.382%205.901-.595%2010.727-.123%202.8%204.388%203.464%204.703%202.011%201.098-5.073-2.066-13.058-4.108-12.738Z'/%3e%3c/svg%3e",Sc={"zh-CN":"zh-Hans","zh-TW":"zh-Hant","pt-BR":"pt-BR"};function vi(){const{i18n:n}=de(),i=_e(()=>bo.map(s=>{var u,d;const o=Sc[s]||s.replace(/-[a-z]+$/i,""),c=xt({code:o,locale:s,fallback:(u=zn.find(l=>l.code===s))==null?void 0:u.nativeName}),r=xt({code:o,locale:n.locale,fallback:(d=zn.find(l=>l.code===s))==null?void 0:d.name});return{code:s,regionlessCode:o,_common:r,native:c}}).sort((s,o)=>{const c=s._common.localeCompare(o._common,n.locale);return c!==0?c:s.code<o.code?-1:s.code>o.code?1:0}),[]);return e("label",{class:"lang-selector",children:["🌐"," ",e("select",{class:"small",value:n.locale||yo,onChange:s=>{ye.local.set("lang",s.target.value),vo(s.target.value)},children:[i.map(({code:s,regionlessCode:o,native:c})=>{var d;const r=xt({code:o,locale:n.locale,fallback:(d=zn.find(l=>l.code===s))==null?void 0:d.name});return e("option",{value:s,"data-regionless-code":o,children:!!r&&r!==c?`${c} - ${r}`:c},s)}),void 0]})]})}function Di(n){const{masto:i}=ce();return i.v1.push.subscription.create(n)}function _c(){const{masto:n}=ce();return n.v1.push.subscription.fetch()}function Cc(n){const{masto:i}=ce();return i.v1.push.subscription.update(n)}function Ic(){const{masto:n}=ce();return n.v1.push.subscription.remove()}function Nn(){return"serviceWorker"in navigator&&"PushManager"in window}function Ac(){return navigator.serviceWorker.getRegistration()}async function wi(){const n=await Ac(),i=n?await n.pushManager.getSubscription():void 0;return{registration:n,subscription:i}}function zs(n){const i="=".repeat((4-n.length%4)%4),s=`${n}${i}`.replace(/-/g,"+").replace(/_/g,"/"),o=window.atob(s),c=new Uint8Array(o.length);for(let r=0;r<o.length;++r)c[r]=o.charCodeAt(r);return c}async function Tc(){if(!Nn())return;const{subscription:n}=await wi();let i=null;try{i=await _c()}catch(s){if(!/(not found|unknown)/i.test(s.message))throw s}if(i&&n){const s=i.endpoint===n.endpoint,o=Wn(),c=i.serverKey===o;if(!s)throw new Error("Backend subscription endpoint changed");if(!c)throw new Error("Backend subscription key and vapid key changed")}if(n&&!i){const s=Wn();if(s){const{applicationServerKey:o}=n.options,c=zs(s).toString(),r=new Uint8Array(o).toString();if(!(c===r))throw await n.unsubscribe(),new Error("Subscription key and vapid key changed")}}return{subscription:n,backendSubscription:i}}async function Oi({data:n,policy:i}){if(!Nn())return;let{registration:s,subscription:o}=await wi(),c=null;if(o)try{c=await Cc({data:n,policy:i})}catch{c=await Di({subscription:o,data:n,policy:i})}else{const r=Wn();if(!r)throw new Error("No server key found");o=await s.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:zs(r)}),c=await Di({subscription:o,data:n,policy:i})}return{subscription:o,backendSubscription:c}}async function zi(){if(!Nn())return;const{subscription:n}=await wi();n&&(await Ic(),await n.unsubscribe())}const xc={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Blaede Phanpy",PHANPY_DEFAULT_INSTANCE:"mastodon.blaede.family",PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:"https://mastodon.blaede.family/auth/sign_up",PHANPY_GIPHY_API_KEY:"48JGsrSS1XE5w4nWe9c9hqxPbsfRWR0e",PHANPY_LINGVA_INSTANCES:"lingva.phanpy.social lingva.lunar.icu lingva.garudalinux.org translate.plausibility.cloud",PHANPY_PRIVACY_POLICY_URL:"https://mastodon.blaede.family/privacy-policy",PHANPY_TRANSLANG_INSTANCES:"translang.phanpy.social",PHANPY_WEBSITE:"https://phanpy.blaede.family",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},Ui=16,Pt=[14,15,16,17,18,19,20],{PHANPY_WEBSITE:Bi,PHANPY_PRIVACY_POLICY_URL:Ec,PHANPY_TRANSLANG_INSTANCES:Rc,PHANPY_IMG_ALT_API_URL:Lc,PHANPY_GIPHY_API_KEY:Mc}=xc,Fi=Object.entries(Uo.tl).map(([n,i])=>({code:n,name:i})),$c="TransLang API";function Nc({onClose:n}){var f;const{_:i}=de(),s=Ge(x),o=ye.local.get("theme")||"auto",c=q(),r=s.settings.contentTranslationTargetLanguage||null,u=_s(),d=xt(u),l=ye.local.get("textSize")||Ui,[a,p]=R(ye.account.get("preferences")||{}),{masto:y,authenticated:m,instance:b}=ce();return e("div",{id:"settings-container",class:"sheet",tabIndex:"-1",style:{"--current-text-size":`${l}px`},children:[!!n&&e("button",{type:"button",class:"sheet-close",onClick:n,children:e(A,{icon:"x",alt:i({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(h,{id:"Tz0i8g"})})}),e("main",{children:[e("section",{children:e("ul",{children:[e("li",{children:[e("div",{children:e("label",{children:e(h,{id:"aAIQg2"})})}),e("div",{children:e("form",{ref:c,onInput:g=>{g.preventDefault();const w=new FormData(c.current).get("theme"),_=document.documentElement;if(w==="auto"){_.classList.remove("is-light","is-dark");const S=document.querySelector('meta[data-theme-setting="manual"]');S&&(S.name=""),document.querySelectorAll('meta[data-theme-setting="auto"]').forEach(T=>{T.name="theme-color"})}else{_.classList.toggle("is-light",w==="light"),_.classList.toggle("is-dark",w==="dark");const S=document.querySelector('meta[data-theme-setting="manual"]');S&&(S.name="theme-color",S.content=w==="light"?S.dataset.themeLightColor:S.dataset.themeDarkColor),document.querySelectorAll('meta[data-theme-setting="auto"]').forEach(T=>{T.name=""})}document.querySelector('meta[name="color-scheme"]').setAttribute("content",w==="auto"?"dark light":w),w==="auto"?ye.local.del("theme"):ye.local.set("theme",w)},children:e("div",{class:"radio-group",children:[e("label",{children:[e("input",{type:"radio",name:"theme",value:"light",defaultChecked:o==="light"}),e("span",{children:e(h,{id:"1njn7W"})})]}),e("label",{children:[e("input",{type:"radio",name:"theme",value:"dark",defaultChecked:o==="dark"}),e("span",{children:e(h,{id:"pvnfJD"})})]}),e("label",{children:[e("input",{type:"radio",name:"theme",value:"auto",defaultChecked:o!=="light"&&o!=="dark"}),e("span",{children:e(h,{id:"R9Khdg"})})]})]})})})]}),e("li",{children:[e("div",{children:e("label",{children:e(h,{id:"7r6sCa"})})}),e("div",{class:"range-group",children:[e("span",{style:{fontSize:Pt[0]},children:e(h,{id:"J6ypuD"})})," ",e("input",{type:"range",min:Pt[0],max:Pt[Pt.length-1],step:"1",value:l,list:"sizes",onChange:g=>{const v=parseInt(g.target.value,10);document.documentElement.style.setProperty("--text-size",`${v}px`),v===Ui?ye.local.del("textSize"):ye.local.set("textSize",g.target.value)}})," ",e("span",{style:{fontSize:Pt[Pt.length-1]},children:e(h,{id:"J6ypuD"})}),e("datalist",{id:"sizes",children:Pt.map(g=>e("option",{value:g}))})]})]}),e("li",{children:[e("span",{children:[e("label",{children:e(h,{id:"CeJHfb"})}),e("br",{}),e("small",{children:e("a",{href:"https://crowdin.com/project/phanpy",target:"_blank",rel:"noopener",children:e(h,{id:"FFmj1D"})})})]}),e(vi,{})]})]})}),m&&e(U,{children:[e("h3",{children:e(h,{id:"PcoS3v"})}),e("section",{children:e("ul",{children:e("li",{children:[e("div",{children:e("label",{for:"posting-privacy-field",children:[e(h,{id:"NAjVvt"})," ",e(A,{icon:"cloud",alt:i({id:"N2FcBE"}),class:"synced-icon"})]})}),e("div",{children:e("select",{id:"posting-privacy-field",value:a["posting:default:visibility"]||"public",onChange:g=>{const{value:v}=g.target;(async()=>{try{await y.v1.accounts.updateCredentials({source:{privacy:v}}),p({...a,"posting:default:visibility":v}),ye.account.set("preferences",{...a,"posting:default:visibility":v})}catch{alert(i({id:"Oa+KBY"}))}})()},children:[e("option",{value:"public",children:e(h,{id:"7d1a0d"})}),e("option",{value:"unlisted",children:e(h,{id:"WDcQq9"})}),e("option",{value:"private",children:e(h,{id:"o34OrG"})})]})})]})})}),e("p",{class:"section-postnote",children:[e(A,{icon:"cloud",alt:i({id:"N2FcBE"}),class:"synced-icon"})," ",e("small",{children:e(h,{id:"xlsg7n",values:{instance:b},components:{0:e("a",{href:`https://${b}/`,target:"_blank",rel:"noopener"})}})})]})]}),e("h3",{children:e(h,{id:"ivdhsq"})}),e("section",{children:e("ul",{children:[e("li",{class:"block",children:e("label",{children:[e("input",{type:"checkbox",checked:s.settings.autoRefresh,onChange:g=>{x.settings.autoRefresh=g.target.checked}})," ",e(h,{id:"0mC0SF"})]})}),e("li",{class:"block",children:e("label",{children:[e("input",{type:"checkbox",checked:s.settings.boostsCarousel,onChange:g=>{x.settings.boostsCarousel=g.target.checked}})," ",e(h,{id:"TSbnoW"})]})}),!!Rc&&e("li",{class:"block",children:[e("label",{children:[e("input",{type:"checkbox",checked:s.settings.contentTranslation,onChange:g=>{const{checked:v}=g.target;x.settings.contentTranslation=v,v||(x.settings.contentTranslationTargetLanguage=null)}})," ",e(h,{id:"0SdaOt"})]}),e("div",{class:`sub-section ${s.settings.contentTranslation?"":"more-insignificant"}`,children:[e("div",{children:e("label",{children:[e(h,{id:"zXCa9e"})," ",e("select",{value:r||"",disabled:!s.settings.contentTranslation,style:{width:"10em"},onChange:g=>{x.settings.contentTranslationTargetLanguage=g.target.value||null},children:[e("option",{value:"",children:e(h,{id:"jNCSyx",values:{systemTargetLanguageText:d}})}),e("option",{disabled:!0,children:"──────────"}),Fi.map(g=>{const v=xt({code:g.code,fallback:g.name}),w=xt({code:g.code,locale:g.code}),_=w&&v!==w;return e("option",{value:g.code,children:_?`${w} - ${v}`:v})})]})]})}),e("hr",{}),e("div",{class:"checkbox-fieldset",children:[e(h,{id:"cc0NrU",values:{0:s.settings.contentTranslationHideLanguages.length}}),e("div",{class:"checkbox-fields",children:Fi.map(g=>{const v=xt({code:g.code,fallback:g.name}),w=xt({code:g.code,locale:g.code}),_=w&&v!==w;return e("label",{children:[e("input",{type:"checkbox",checked:s.settings.contentTranslationHideLanguages.includes(g.code),onChange:S=>{const{checked:k}=S.target;k?x.settings.contentTranslationHideLanguages.push(g.code):x.settings.contentTranslationHideLanguages=s.settings.contentTranslationHideLanguages.filter(T=>T!==g.code)}})," ",_?e("span",{children:[w," ",e("span",{class:"insignificant ib",children:["- ",v]})]}):v]})})})]}),e("p",{class:"insignificant",children:e("small",{children:e(h,{id:"7I3sDQ",values:{TRANSLATION_API_NAME:$c},components:{0:e("a",{href:"https://github.com/cheeaun/translang-api",target:"_blank",rel:"noopener"})}})})}),e("hr",{}),e("div",{children:[e("label",{children:[e("input",{type:"checkbox",checked:s.settings.contentTranslationAutoInline,disabled:!s.settings.contentTranslation,onChange:g=>{x.settings.contentTranslationAutoInline=g.target.checked}})," ",e(h,{id:"gURvmk"})]}),e("p",{class:"insignificant",children:e("small",{children:e(h,{id:"PbHARL",components:{0:e("b",{})}})})})]})]})]}),!!Mc&&m&&e("li",{class:"block",children:[e("label",{children:[e("input",{type:"checkbox",checked:s.settings.composerGIFPicker,onChange:g=>{x.settings.composerGIFPicker=g.target.checked}})," ",e(h,{id:"D7/2jB"})]}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(h,{id:"/CLBTL",components:{0:e("a",{href:"https://developers.giphy.com/",target:"_blank",rel:"noopener"})}})})})]}),!!Lc&&m&&e("li",{class:"block",children:[e("label",{children:[e("input",{type:"checkbox",checked:s.settings.mediaAltGenerator,onChange:g=>{x.settings.mediaAltGenerator=g.target.checked}})," ",e(h,{id:"9q5uor"})," ",e(A,{icon:"sparkles2",class:"more-insignificant"})]}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(h,{id:"faZ9RI"})})}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(h,{id:"fHZgvt",components:{0:e("a",{href:"https://github.com/cheeaun/img-alt-api",target:"_blank",rel:"noopener"})}})})})]}),m&&et("@mastodon/grouped-notifications")&&((f=ps())==null?void 0:f.mastodon)>=2&&e("li",{class:"block",children:[e("label",{children:[e("input",{type:"checkbox",checked:s.settings.groupedNotificationsAlpha,onChange:g=>{x.settings.groupedNotificationsAlpha=g.target.checked}})," ",e(h,{id:"aGziA/"})]}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(h,{id:"X17jCM"})})})]}),m&&e("li",{class:"block",children:[e("label",{children:[e("input",{type:"checkbox",checked:s.settings.shortcutSettingsCloudImportExport,onChange:g=>{x.settings.shortcutSettingsCloudImportExport=g.target.checked}})," ",e(h,{id:"570qTm"})," ",e(A,{icon:"cloud",class:"more-insignificant"})]}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(h,{id:"0tZAhT",components:{0:e("br",{})}})})}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(h,{id:"fHf1v/"})})})]}),e("li",{class:"block",children:[e("label",{children:[e("input",{type:"checkbox",checked:s.settings.cloakMode,onChange:g=>{x.settings.cloakMode=g.target.checked}})," ",e(h,{id:"lxYe+I",components:{0:e("span",{class:"insignificant"}),1:e("samp",{}),2:e("samp",{})}})]}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(h,{id:"T/hglb"})})})]}),m&&e("li",{children:e("button",{type:"button",class:"light",onClick:()=>{x.showDrafts=!0,x.showSettings=!1},children:e(h,{id:"krk5ws"})})})]})}),m&&e(Pc,{onClose:n}),e("h3",{children:e(h,{id:"uyJsf6"})}),e("section",{children:[e("div",{style:{display:"flex",flexWrap:"wrap",gap:8,lineHeight:1.25,alignItems:"center",marginTop:8},children:[e("img",{src:yi,alt:"",width:"64",height:"64",style:{aspectRatio:"1/1",verticalAlign:"middle",background:"#b7cdf9",borderRadius:12}}),e("div",{children:[e("b",{children:"Phanpy"})," ",e("a",{href:"https://hachyderm.io/@phanpy",rel:"noopener",onClick:g=>{g.preventDefault(),x.showAccount="phanpy@hachyderm.io"},children:"@phanpy"}),e("br",{}),e(h,{id:"AZ2EoP",components:{0:e("a",{href:"https://github.com/cheeaun/phanpy",target:"_blank",rel:"noopener"}),1:e("a",{href:"https://mastodon.social/@cheeaun",rel:"noopener",onClick:g=>{g.preventDefault(),x.showAccount="cheeaun@mastodon.social"}})}})]})]}),e("p",{children:[e("a",{href:"https://github.com/sponsors/cheeaun",target:"_blank",rel:"noopener",children:e(h,{id:"O4cLCR"})})," ","·"," ",e("a",{href:"https://www.buymeacoffee.com/cheeaun",target:"_blank",rel:"noopener",children:e(h,{id:"Ng063n"})})," ","·"," ",e("a",{href:"https://patreon.com/cheeaun",target:"_blank",rel:"noopener",children:"Patreon"})," ","·"," ",e("a",{href:Ec,target:"_blank",rel:"noopener",children:e(h,{id:"LcET2C"})})]}),e("p",{children:[Bi&&e(U,{children:[e(h,{id:"pFnMHn",values:{0:Bi.replace(/https?:\/\//g,"").replace(/\/$/,"")},components:{0:e("span",{class:"insignificant"})}}),e("br",{})]}),e(h,{id:"6KkH+2",values:{0:e("span",{class:"ib insignificant",children:["(",e("a",{href:"https://github.com/cheeaun/phanpy/commit/4f6f237",target:"_blank",rel:"noopener",children:e(It,{datetime:new Date("2025-04-23T16:49:10.780Z")})}),")"]})},components:{0:e("span",{class:"insignificant"}),1:e("input",{type:"text",class:"version-string",readOnly:!0,size:"18",value:`${"2025-04-23T16:49:10.780Z".slice(0,10).replace(/-/g,".")}.4f6f237`,onClick:g=>{g.target.select();try{navigator.clipboard.writeText(g.target.value),pe(i({id:"PiPfua"}))}catch{pe(i({id:"gdxreD"}))}}})}})]})]}),void 0]})]})}function Pc({onClose:n}){const{_:i}=de();if(!Nn())return null;const{instance:s}=ce(),[o,c]=R("default"),r=q(),[u,d]=R(!1),[l,a]=R(!1),p=q();ie(()=>{(async()=>{c("loading");try{const{subscription:m,backendSubscription:b}=await Tc();if(b!=null&&b.policy&&b.policy!=="none"){d(!0);const{alerts:f,policy:g}=b;p.current=g;const{elements:v}=r.current,w=v.namedItem("policy");w&&(w.value=g),Object.entries(f).forEach(([_,S])=>{const k=v.namedItem(_);(k==null?void 0:k.type)==="checkbox"&&(k.checked=!!S)})}c("default")}catch(m){/outside.*authorized/i.test(m.message)?a(!0):alert((m==null?void 0:m.message)||m),c("error")}})()},[]);const y=o==="loading";return e("form",{ref:r,onChange:()=>{setTimeout(()=>{const m=Object.fromEntries(new FormData(r.current)),b=!!m["policy-allow"],f={data:{policy:m.policy,alerts:{mention:!!m.mention,favourite:!!m.favourite,reblog:!!m.reblog,follow:!!m.follow,follow_request:!!m.followRequest,poll:!!m.poll,update:!!m.update,status:!!m.status}}};let g=0;Object.keys(f.data.alerts).forEach(w=>{f.data.alerts[w]?g++:delete f.data.alerts[w]});const v=p.current!==f.data.policy;b&&g>0?v?zi().then(()=>{Oi(f)}).catch(w=>{alert(i({id:"I6pdY3"}))}):Oi(f).catch(w=>{alert(i({id:"I6pdY3"}))}):zi().catch(w=>{alert(i({id:"q1zFd+"}))})},100)},children:[e("h3",{children:e(h,{id:"WUHLnz"})}),e("section",{children:e("ul",{children:e("li",{children:[e("label",{children:[e("input",{type:"checkbox",disabled:y||l,name:"policy-allow",checked:u,onChange:async m=>{const{checked:b}=m.target;if(b){const f=await Notification.requestPermission();f==="granted"?d(!0):(d(!1),f==="denied"&&alert(i({id:"6LUsk7"})))}else d(!1)}})," ",e(h,{id:"qYNCa1",values:{0:[{value:"all",label:i({id:"+niKJH"})},{value:"followed",label:i({id:"x2NYtp"})},{value:"follower",label:i({id:"PBFNgg"})}].map(m=>e("option",{value:m.value,children:m.label}))},components:{0:e("select",{name:"policy",disabled:y||l||!u})}})]}),e("div",{class:"shazam-container no-animation",style:{width:"100%"},hidden:!u,children:e("div",{class:"shazam-container-inner",children:e("div",{class:"sub-section",children:e("ul",{children:[{value:"mention",label:i({id:"/bZzdR"})},{value:"favourite",label:i({id:"zZOZj7"})},{value:"reblog",label:i({id:"puY2t0"})},{value:"follow",label:i({id:"aaJhcT"})},{value:"followRequest",label:i({id:"6Fs1Ba"})},{value:"poll",label:i({id:"wNExRS"})},{value:"update",label:i({id:"K/EtE6"})},{value:"status",label:i({id:"2yr1/p"})}].map(m=>e("li",{children:e("label",{children:[e("input",{type:"checkbox",name:m.value})," ",m.label]})}))})})})}),l&&e("div",{class:"sub-section",children:e("p",{children:e(h,{id:"8d0b8B",components:{0:e(ge,{to:`/login?instance=${s}`,onClick:n}),1:e("b",{})}})})})]})})}),e("p",{class:"section-postnote",children:e("small",{children:e(h,{id:"z96cOX",components:{0:e("b",{})}})})})]})}const Qn=()=>{let n=setTimeout(()=>{var s,o;const i=document.getElementById("columns");if(i){const c=i.querySelector(".deck-container.focus");if(c)c.focus();else{const r=Array.from(i.querySelectorAll(".deck-container")).find(u=>u.getBoundingClientRect().left>=0);r?r.focus():(o=(s=i.querySelector(".deck-container"))==null?void 0:s.focus)==null||o.call(s)}}else{const c=document.querySelectorAll("#modal-container > *");if(c!=null&&c.length){const l=c[c.length-1],a=l.querySelector('[tabindex="-1"]')||l;if(a){a.focus();return}}if(document.querySelector(".deck-backdrop"))return;const u=document.querySelectorAll(".deck-container"),d=u[u.length-1];d&&d.tabIndex===-1&&d.focus()}},100);return()=>clearTimeout(n)};function Us(n){if(!n)return;const i=Wt(),s=q(i.pathname);ie(()=>{s.current&&i.pathname!==s.current&&(n==null||n())},[i.pathname,n])}const Bs=1e3*60,Dc=24*60*60*1e3,ei=bt(async()=>{const{masto:n}=ce(),i=await n.v1.lists.list();return i.sort((s,o)=>s.title.localeCompare(o.title)),i.length&&setTimeout(()=>{ye.account.set("lists",{lists:i,updatedAt:Date.now()})},1),i},{maxAge:Bs});async function ln(){try{const{lists:n,updatedAt:i}=ye.account.get("lists")||{};return n!=null&&n.length?(Date.now()-i>Dc&&ei(),n):await ei()}catch{return[]}}const Oc=bt(n=>{const{masto:i}=ce();return i.v1.lists.$select(n).fetch()},{maxAge:Bs});async function Fs(n){const{lists:i}=ye.account.get("lists")||{};if(i!=null&&i.length){const s=i.find(o=>o.id===n);if(s)return s}try{return Oc(n)}catch{return null}}async function zc(n){const i=await Fs(n);return(i==null?void 0:i.title)||""}function Uc(n){const{lists:i}=ye.account.get("lists")||{};i!=null&&i.length&&(i.push(n),i.sort((s,o)=>s.title.localeCompare(o.title)),ye.account.set("lists",{lists:i,updatedAt:Date.now()}))}function Bc(n){const{lists:i}=ye.account.get("lists")||{};if(i!=null&&i.length){const s=i.findIndex(o=>o.id===n.id);s!==-1&&(i[s]=n,i.sort((o,c)=>o.title.localeCompare(c.title)),ye.account.set("lists",{lists:i,updatedAt:Date.now()}))}}function Fc(n){const{lists:i}=ye.account.get("lists")||{};if(i!=null&&i.length){const s=i.findIndex(o=>o.id===n);s!==-1&&(i.splice(s,1),ye.account.set("lists",{lists:i,updatedAt:Date.now()}))}}function ki({list:n,onClose:i}){const{_:s}=de(),{masto:o}=ce(),[c,r]=R("default"),u=!!n,d=q(),l=q(),a=q();ie(()=>{u&&(d.current.value=n.title,l.current.value=n.repliesPolicy,a.current&&(a.current.checked=n.exclusive))},[u]);const p=et("@mastodon/list-exclusive")||et("@gotosocial/list-exclusive");return e("div",{class:"sheet",children:[!!i&&e("button",{type:"button",class:"sheet-close",onClick:i,children:e(A,{icon:"x",alt:s({id:"yz7wBu"})})})," ",e("header",{children:e("h2",{children:s(u?{id:"tuhghE"}:{id:"Sb2gYF"})})}),e("main",{children:e("form",{class:"list-form",onSubmit:y=>{y.preventDefault();const m=new FormData(y.target),b=m.get("title"),f=m.get("replies_policy"),g=m.get("exclusive")==="on";r("loading"),(async()=>{try{let v;u?v=await o.v1.lists.$select(n.id).update({title:b,replies_policy:f,exclusive:g}):v=await o.v1.lists.create({title:b,replies_policy:f,exclusive:g}),r("default"),i==null||i({state:"success",list:v}),setTimeout(()=>{u?Bc(v):Uc(v)},1)}catch{r("error"),alert(s(u?{id:"R7ep1i"}:{id:"KPoj8w"}))}})()},children:[e("div",{class:"list-form-row",children:e("label",{for:"list-title",children:[e(h,{id:"6YtxFj"})," ",e("input",{ref:d,type:"text",id:"list-title",name:"title",required:!0,disabled:c==="loading",dir:"auto"})]})}),e("div",{class:"list-form-row",children:e("select",{ref:l,name:"replies_policy",required:!0,disabled:c==="loading",children:[e("option",{value:"list",children:e(h,{id:"ei6pnR"})}),e("option",{value:"followed",children:e(h,{id:"Mr53YX"})}),e("option",{value:"none",children:e(h,{id:"PM7llw"})})]})}),p&&e("div",{class:"list-form-row",children:e("label",{class:"label-block",children:[e("input",{ref:a,type:"checkbox",name:"exclusive",disabled:c==="loading"})," ",e(h,{id:"jxxYp0"})]})}),e("div",{class:"list-form-footer",children:[e("button",{type:"submit",disabled:c==="loading",children:s(u?{id:"tfDRzk"}:{id:"hYgDIe"})}),u&&e(ht,{disabled:c==="loading",align:"end",menuItemClassName:"danger",confirmLabel:s({id:"+kQ/cY"}),onClick:()=>{r("loading"),(async()=>{try{await o.v1.lists.$select(n.id).remove(),r("default"),i==null||i({state:"deleted"}),setTimeout(()=>{Fc(n.id)},1)}catch{r("error"),alert(s({id:"tqUaGL"}))}})()},children:e("button",{type:"button",class:"light danger",disabled:c==="loading",children:e(h,{id:"Jb6/SB"})})})]})]})})]})}const Hc=[60*5,60*30,60*60,60*60*6,60*60*24,60*60*24*3,60*60*24*7,60*60*24*30,0],Ft={0:{id:"9ZP9cc"},300:st(5,"minute"),1800:st(30,"minute"),3600:st(1,"hour"),21600:st(6,"hour"),86400:st(1,"day"),259200:st(3,"day"),604800:st(1,"week"),2592e3:st(30,"day")},Hi=80,Hs=1e3*60*10;function Yc(n,i){return i.v1.accounts.familiarFollowers.fetch({id:[n]})}const qc=bt(Yc,{maxAge:Hs});async function jc(n,i){const s=i.v1.accounts.$select(n).statuses.list({limit:20}).next(),{value:o}=await s,c={total:o.length,originals:0,replies:0,boosts:0};return o.forEach(r=>{r.reblog?c.boosts++:r.inReplyToId&&r.inReplyToAccountId!==r.account.id?c.replies++:c.originals++}),o.length&&(c.daysSinceLastPost=Math.ceil((Date.now()-new Date(o[o.length-1].createdAt))/864e5)),c}const Gc=bt(jc,{maxAge:Hs});function Ys({account:n,fetchAccount:i=()=>{},standalone:s,instance:o,authenticated:c}){const{i18n:r,_:u}=de(),{masto:d,authenticated:l}=ce({instance:o}),{masto:a,instance:p}=ce(),[y,m]=R("default"),b=typeof n=="string",[f,g]=R(b?null:n),v=_e(()=>o===p,[o,p]);ie(()=>{if(!b){g(n);return}m("loading"),(async()=>{try{const N=await i();x.accounts[`${N.id}@${o}`]=N,g(N),m("default")}catch{g(null),m("error")}})()},[b,n,i]);const{acct:w,avatar:_,avatarStatic:S,bot:k,createdAt:T,displayName:C,emojis:I,fields:E,followersCount:L,followingCount:B,group:P,id:Y,lastStatusAt:Q,locked:te,note:J,statusesCount:V,url:z,username:ue,memorial:M,moved:F,roles:G,hideCollections:re}=f||{};let H=!1,{header:se,headerStatic:be}=f||{};(!se||/missing\.png$/.test(se))&&_&&!/missing\.png$/.test(_)&&(se=_,H=!0,S&&!/missing\.png$/.test(S)&&(be=S));const we=_e(()=>Y===wt(),[Y]);ie(()=>{const N=!!(f!=null&&f.id&&(f!=null&&f.username)&&(f!=null&&f.acct)&&(f!=null&&f.avatar)&&(f!=null&&f.avatarStatic)&&(f!=null&&f.displayName)&&(f!=null&&f.url));if(we&&o&&N){const W=ye.local.getJSON("accounts");let j=!1;W.forEach(K=>{K.info.id===f.id&&K.instanceURL===o&&(K.info=f,j=!0)}),j&&ye.local.setJSON("accounts",W)}},[we,f,o]);const Z=_e(()=>{var j;if(!z)return null;const N=(j=URL.parse(z))==null?void 0:j.hostname;return N?rn.toUnicode(N):null},[z]),[le,Re]=R([]),$e=q(),De=q([]);async function ze(N){var Oe;(N||!$e.current)&&($e.current=d.v1.accounts.$select(Y).followers.list({limit:Hi}));const W=await $e.current.next();if(we||!v)return W;const{value:j}=W;let K=[];if(N){let Ae=[];try{Ae=await d.v1.accounts.familiarFollowers.fetch({id:[Y]})}catch{}De.current=((Oe=Ae==null?void 0:Ae[0])==null?void 0:Oe.accounts)||[],K=[...De.current,...j.filter(Ce=>!De.current.some(Be=>Be.id===Ce.id))]}else j!=null&&j.length&&(K=j.filter(Ae=>!De.current.some(Ce=>Ce.id===Ae.id)));return{...W,value:K}}const Le=q();async function Te(N){return(N||!Le.current)&&(Le.current=d.v1.accounts.$select(Y).following.list({limit:Hi})),await Le.current.next()}const X=s?"div":ge,ke=o?`/${o}/a/${Y}`:`/a/${Y}`,[Ne,ne]=R([]),[oe,xe]=R(),[O,ee]=R("default"),fe=!!(oe!=null&&oe.total),D=async N=>{try{const W=await qc(N,a);ne(W[0].accounts.slice(0,Kc))}catch{}},ae=async()=>{if(Y){ee("loading");try{const N=await Gc(Y,d);xe(N),ee("default")}catch{ee("error")}}},Ie=ot(({relationship:N,currentID:W})=>{N.following||(D(W),!s&&V>0&&ae())},[s,Y,V]),Se=ot(N=>{N.id===Y&&(g(N),x.accounts[`${N.id}@${o}`]=N)},[Y,o]),Pe=b&&n&&/^https?:\/\//.test(n),[je,$]=R(!1);return e(U,{children:[e("div",{tabIndex:"-1",class:`account-container ${y==="loading"?"skeleton":""}`,style:{"--header-color-1":le[0],"--header-color-2":le[1],"--header-color-3":le[2],"--header-color-4":le[3]},children:[y==="error"&&e("div",{class:"ui-state",children:[e("p",{children:e(h,{id:"44hICK"})}),b?e("p",{children:Pe?e("a",{href:n,target:"_blank",rel:"noopener",children:n}):e("code",{class:"insignificant",children:n})}):e("p",{children:e("a",{href:z,target:"_blank",rel:"noopener",children:[e(h,{id:"Aadw0+"})," ",e(A,{icon:"external"})]})})]}),y==="loading"?e(U,{children:[e("header",{children:e(ft,{avatarSize:"xxxl",skeleton:!0})}),e("main",{children:[e("div",{class:"note",children:[e("p",{children:"███████ ████ ████"}),e("p",{children:"████ ████████ ██████ █████████ ████ ██"})]}),e("div",{class:"account-metadata-box",children:[e("div",{class:"profile-metadata",children:[e("div",{class:"profile-field",children:[e("b",{class:"more-insignificant",children:"███"}),e("p",{children:"██████"})]}),e("div",{class:"profile-field",children:[e("b",{class:"more-insignificant",children:"████"}),e("p",{children:"███████████"})]})]}),e("div",{class:"stats",children:[e("div",{children:[e("span",{children:"██"})," ",e(h,{id:"x5LEuB"})]}),e("div",{children:[e("span",{children:"██"})," ",e(h,{id:"following.stats"})]}),e("div",{children:[e("span",{children:"██"})," ",e(h,{id:"+owNNn"})]})]})]}),e("div",{class:"actions",children:[e("span",{}),e("span",{class:"buttons",children:e("button",{type:"button",class:"plain",disabled:!0,children:e(A,{icon:"more",size:"l",alt:u({id:"2FYpfJ"})})})})]})]})]}):f&&e(U,{children:[!!F&&e("div",{class:"account-moved",children:[e("p",{children:e(h,{id:"C6cVP/",values:{displayName:C},components:{0:e("b",{})}})}),e(ft,{account:F,instance:o,onClick:N=>{N.stopPropagation(),x.showAccount=F}})]}),!!se&&!/missing\.png$/.test(se)&&e("img",{src:se,alt:"",class:`header-banner ${H?"header-is-avatar":""}`,onError:N=>{N.target.crossOrigin?N.target.src!==be?N.target.src=be:(N.target.removeAttribute("crossorigin"),N.target.src=se):N.target.src!==be?N.target.src=be:N.target.remove()},crossOrigin:"anonymous",onLoad:N=>{N.target.classList.add("loaded");try{const W=window.OffscreenCanvas?new OffscreenCanvas(1,1):document.createElement("canvas"),j=W.getContext("2d",{willReadFrequently:!0});W.width=N.target.width,W.height=N.target.height,j.imageSmoothingEnabled=!1,j.drawImage(N.target,0,0);const K=10,Ae=[j.getImageData(0,0,K,K).data,j.getImageData(N.target.width-K,0,K,K).data,j.getImageData(0,N.target.height-K,K,K).data,j.getImageData(N.target.width-K,N.target.height-K,K,K).data].map(Ce=>{let Be=0,We=0,me=0,Me=0;for(let nt=0;nt<Ce.length;nt+=4)Be+=Ce[nt],We+=Ce[nt+1],me+=Ce[nt+2],Me+=Ce[nt+3];const Ze=Ce.length/4;return[Be/Ze,We/Ze,me/Ze,Me/Ze]}).map(Ce=>{const[Be,We,me,Me]=Wc(Ce);return`rgba(${Be}, ${We}, ${me}, ${Me})`});Re(Ae)}catch{}}}),e("header",{children:s?e(lt,{shift:window.matchMedia("(min-width: calc(40em))").matches?114:64,menuButton:e("div",{children:e(ft,{account:f,instance:o,avatarSize:"xxxl",onClick:()=>{}})}),children:[e("div",{class:"szh-menu__header",children:e(ia,{acct:w,instance:o})}),e(ve,{onClick:()=>{const N=w.includes("@")?`@${w}`:`@${w}@${o}`;try{navigator.clipboard.writeText(N),pe(u({id:"zJoEwS"}))}catch{pe(u({id:"BC0lSD"}))}},children:[e(A,{icon:"link"}),e("span",{children:e(h,{id:"27x6gl"})})]}),e(ve,{href:z,target:"_blank",children:[e(A,{icon:"external"}),e("span",{children:e(h,{id:"Bz5hLl"})})]}),e(Ve,{}),e(ve,{onClick:()=>{x.showMediaModal={mediaAttachments:[{type:"image",url:S}]}},children:[e(A,{icon:"user"}),e("span",{children:e(h,{id:"7WYl2I"})})]}),e(ve,{onClick:()=>{x.showMediaModal={mediaAttachments:[{type:"image",url:be}]}},children:[e(A,{icon:"media"}),e("span",{children:e(h,{id:"ZNme5R"})})]}),l&&we&&et("@mastodon/profile-edit")&&e(U,{children:[e(Ve,{}),e(ve,{onClick:()=>{$(!0)},children:[e(A,{icon:"pencil"}),e("span",{children:e(h,{id:"9OpVZg"})})]})]})]}):e(ft,{account:f,instance:o,avatarSize:"xxxl",internal:!0})}),e("div",{class:"faux-header-bg","aria-hidden":"true"}),e("main",{children:[!!M&&e("span",{class:"tag",children:e(h,{id:"prdIOK"})}),!!k&&e("span",{class:"tag",children:[e(A,{icon:"bot"})," ",e(h,{id:"9Vdq+j"})]}),!!P&&e("span",{class:"tag",children:[e(A,{icon:"group"})," ",e(h,{id:"L8fEEm"})]}),G==null?void 0:G.map(N=>e("span",{class:"tag",children:[N.name,!!Z&&e(U,{children:[" ",e("span",{class:"more-insignificant",children:Z})]})]})),e("div",{class:"note",dir:"auto",onClick:Cs({instance:p}),dangerouslySetInnerHTML:{__html:Zn(J,{emojis:I})}}),e("div",{class:"account-metadata-box",children:[(E==null?void 0:E.length)>0&&e("div",{class:"profile-metadata",children:E.map(({name:N,value:W,verifiedAt:j},K)=>e("div",{class:`profile-field ${j?"profile-verified":""}`,dir:"auto",children:[e("b",{children:[e(Is,{text:N,emojis:I})," ",!!j&&e(A,{icon:"check-circle",size:"s",alt:u({id:"QDEWii"})})]}),e("p",{dangerouslySetInnerHTML:{__html:Zn(W,{emojis:I})}})]},N+K))}),e("div",{class:"stats",children:[e(X,{tabIndex:0,to:ke,onClick:()=>{setTimeout(()=>{x.showGenericAccounts={id:"followers",heading:u({id:"x5LEuB"}),fetchAccounts:ze,instance:o,excludeRelationshipAttrs:we?["followedBy"]:[],blankCopy:re?u({id:"BRV/wh"}):void 0}},0)},children:[!!Ne.length&&e("span",{class:"shazam-container-horizontal",children:e("span",{class:"shazam-container-inner stats-avatars-bunch",children:Ne.map(N=>e(pt,{url:N.avatarStatic,size:"s",alt:`${N.displayName} @${N.acct}`,squircle:N==null?void 0:N.bot}))})}),e("span",{title:L,children:Je(L)})," ",e(h,{id:"x5LEuB"})]}),e(X,{class:"insignificant",tabIndex:0,to:ke,onClick:()=>{setTimeout(()=>{x.showGenericAccounts={heading:u({id:"following.stats"}),fetchAccounts:Te,instance:o,excludeRelationshipAttrs:we?["following"]:[],blankCopy:re?u({id:"BRV/wh"}):void 0}},0)},children:[e("span",{title:B,children:Je(B)})," ",e(h,{id:"following.stats"}),e("br",{})]}),e(X,{class:"insignificant",to:ke,children:[e("span",{title:V,children:Je(V)})," ",e(h,{id:"+owNNn"})]}),!!T&&e("div",{class:"insignificant",children:e(h,{id:"PCcEFZ",values:{0:ct(T,{hideTime:!0})},components:{0:e("time",{datetime:T})}})})]})]}),!!oe&&e(X,{to:ke,class:"account-metadata-box",children:e("div",{class:"shazam-container",children:e("div",{class:"shazam-container-inner",children:fe?e("div",{class:"posting-stats",title:u({id:"wiuWLe",values:{0:(oe.originals/oe.total).toLocaleString(r.locale||void 0,{style:"percent"}),1:(oe.replies/oe.total).toLocaleString(r.locale||void 0,{style:"percent"}),2:(oe.boosts/oe.total).toLocaleString(r.locale||void 0,{style:"percent"})}}),children:[e("div",{children:oe.daysSinceLastPost<365?he._({id:"oZUtTk",values:{0:oe.total,1:oe.daysSinceLastPost,2:oe.daysSinceLastPost,3:oe.daysSinceLastPost,4:oe.total,5:oe.total,6:oe.daysSinceLastPost}}):he._({id:"JvA7Mo",values:{0:oe.total,1:oe.total}})}),e("div",{class:"posting-stats-bar",style:{"--originals-percentage":`${oe.originals/oe.total*100}%`,"--replies-percentage":`${(oe.originals+oe.replies)/oe.total*100}%`}}),e("div",{class:"posting-stats-legends",children:[e("span",{class:"ib",children:[e("span",{class:"posting-stats-legend-item posting-stats-legend-item-originals"})," ",e(h,{id:"HxF6Fk"})]})," ",e("span",{class:"ib",children:[e("span",{class:"posting-stats-legend-item posting-stats-legend-item-replies"})," ",e(h,{id:"N8UzTV"})]})," ",e("span",{class:"ib",children:[e("span",{class:"posting-stats-legend-item posting-stats-legend-item-boosts"})," ",e(h,{id:"puY2t0"})]})]})]}):e("div",{class:"posting-stats",children:e(h,{id:"vl3XTJ"})})})})}),!F&&e("div",{class:"account-metadata-box",children:e("div",{class:"shazam-container no-animation",hidden:!!oe,children:e("div",{class:"shazam-container-inner",children:e("button",{type:"button",class:"posting-stats-button",disabled:O==="loading",onClick:()=>{ae()},children:[e("div",{class:`posting-stats-bar posting-stats-icon ${O==="loading"?"loading":""}`,style:{"--originals-percentage":"33%","--replies-percentage":"66%"}}),e(h,{id:"PjP87f"})," "]})})})})]}),e("footer",{children:e(Vc,{info:f,instance:o,standalone:s,authenticated:c,onRelationshipChange:Ie,onProfileUpdate:Se,setShowEditProfile:$})})]})]}),!!je&&e(He,{onClose:()=>{$(!1)},children:e(ta,{onClose:({state:N,account:W}={})=>{$(!1),N==="success"&&W&&Se(W)}})})]})}const Kc=3;function Vc({info:n,instance:i,standalone:s,authenticated:o,onRelationshipChange:c=()=>{},onProfileUpdate:r=()=>{},setShowEditProfile:u=()=>{}}){var Ne;if(!n)return null;const{_:d,_:l}=de(),{masto:a,instance:p,authenticated:y}=ce(),m=i===p,[b,f]=R("default"),[g,v]=R(null),{id:w,acct:_,url:S,username:k,locked:T,lastStatusAt:C,note:I,fields:E,moved:L}=n,B=q(w),{following:P,showingReblogs:Y,notifying:Q,followedBy:te,blocking:J,blockedBy:V,muting:z,mutingNotifications:ue,requested:M,domainBlocking:F,endorsed:G,note:re}=g||{},[H,se]=R(null),[be,we]=R(!1),Z=_.includes("@")?_:`${_}@${i}`;ie(()=>{if(n){const ne=wt();let oe;(async()=>{if(m&&o)oe=w;else if(!m&&y){const O=n.acct.includes("@");try{const ee=await a.v2.search.fetch({q:O?n.acct:`${n.username}@${i}`,type:"accounts",limit:1,resolve:!0});ee.accounts.length&&(oe=ee.accounts[0].id,se(ee.accounts[0]))}catch{}}if(!oe)return;if(ne===oe){we(!0);return}B.current=oe,f("loading");const xe=a.v1.accounts.relationships.fetch({id:[oe]});try{const O=await xe;if(f("default"),O.length){const ee=O[0];v(ee),c({relationship:ee,currentID:oe})}}catch{f("error")}})()}},[n,o]),ie(()=>{n&&be&&wo(n)},[n,be]);const le=b==="loading",[Re,$e]=R(!1),[De,ze]=R(!1),[Le,Te]=R(!1),[X,ke]=R([]);return e(U,{children:[e("div",{class:"actions",children:[e("span",{children:[te?e("span",{class:"tag",children:e(h,{id:"p3UO/y"})}):C?e("small",{class:"insignificant",children:e(h,{id:"F3cM1G",values:{0:ct(C,{hideTime:!0})},components:{0:e("span",{class:"ib"})}})}):e("span",{}),z&&e("span",{class:"tag danger",children:e(h,{id:"+IJm1Z"})}),J&&e("span",{class:"tag danger",children:e(h,{id:"32TndD"})})]})," ",e("span",{class:"buttons",children:[!!re&&e("button",{type:"button",class:"private-note-tag",title:l({id:"zxFxcH"}),onClick:()=>{Te(!0)},dir:"auto",children:e("span",{children:re})}),e(lt,{portal:{target:document.body},containerProps:{style:{zIndex:1001}},align:"center",position:"anchor",overflow:"auto",menuButton:e("button",{type:"button",class:"plain",disabled:le,children:e(A,{icon:"more",size:"l",alt:l({id:"2FYpfJ"})})}),onMenuChange:ne=>{P&&ne.open&&(async()=>{try{const oe=await a.v1.accounts.$select(B.current).lists.list();ke(oe)}catch{}})()},children:[y&&!be&&e(U,{children:[e(ve,{onClick:()=>{ks({draftStatus:{status:`@${(H==null?void 0:H.acct)||_} `}})},children:[e(A,{icon:"at"}),e("span",{children:e(h,{id:"3LkfZu",values:{username:k},components:{0:e("span",{class:"bidi-isolate"})}})})]}),e(ve,{onClick:()=>{$e(!0)},children:[e(A,{icon:"translate"}),e("span",{children:e(h,{id:"R8mSiS"})})]}),et("@mastodon/profile-private-note")&&e(ve,{onClick:()=>{Te(!0)},children:[e(A,{icon:"pencil"}),e("span",{children:l(re?{id:"U+Gokq"}:{id:"VcQzRi"})})]}),P&&!!g&&e(U,{children:[e(ve,{onClick:()=>{f("loading"),(async()=>{try{const ne=await a.v1.accounts.$select(B.current).follow({notify:!Q});ne&&v(ne),f("default"),pe(ne.notifying?l({id:"jL3N0G",values:{username:k}}):l({id:"0h4/9h",values:{username:k}}))}catch(ne){alert(ne),f("error")}})()},children:[e(A,{icon:"notification"}),e("span",{children:l(Q?{id:"osJmEN"}:{id:"I92Z+b"})})]}),e(ve,{onClick:()=>{f("loading"),(async()=>{try{const ne=await a.v1.accounts.$select(B.current).follow({reblogs:!Y});ne&&v(ne),f("default"),pe(ne.showingReblogs?l({id:"0X2KC8",values:{username:k}}):l({id:"cXWjH0",values:{username:k}}))}catch(ne){alert(ne),f("error")}})()},children:[e(A,{icon:"rocket"}),e("span",{children:l(Y?{id:"GRUr8d"}:{id:"uREpT3"})})]})]}),P&&e(ve,{onClick:()=>{ze(!0)},children:[e(A,{icon:"list"}),X.length?e(U,{children:[e("small",{class:"menu-grow",children:[e(h,{id:"sJ2yQc"}),e("br",{}),e("span",{class:"more-insignificant",children:X.map(ne=>ne.title).join(", ")})]}),e("small",{class:"more-insignificant",children:X.length})]}):e("span",{children:e(h,{id:"sJ2yQc"})})]}),e(Ve,{})]}),e(ve,{onClick:()=>{const ne=`@${(H==null?void 0:H.acct)||Z}`;try{navigator.clipboard.writeText(ne),pe(l({id:"zJoEwS"}))}catch{pe(l({id:"BC0lSD"}))}},children:[e(A,{icon:"copy"}),e("small",{children:[e(h,{id:"27x6gl"}),e("br",{}),e("span",{class:"more-insignificant bidi-isolate",children:["@",(H==null?void 0:H.acct)||Z]})]})]}),e(ve,{href:S,target:"_blank",children:[e(A,{icon:"external"}),e("small",{class:"menu-double-lines",children:Zc(S)})]}),e("div",{class:"menu-horizontal",children:[e(ve,{onClick:()=>{try{navigator.clipboard.writeText(S),pe(l({id:"edWbV6"}))}catch{pe(l({id:"W1ewR0"}))}},children:[e(A,{icon:"link"}),e("span",{children:e(h,{id:"he3ygx"})})]}),(navigator==null?void 0:navigator.share)&&((Ne=navigator==null?void 0:navigator.canShare)==null?void 0:Ne.call(navigator,{url:S}))&&e(ve,{onClick:()=>{try{navigator.share({url:S})}catch{alert(l({id:"TtG3Uh"}))}},children:[e(A,{icon:"share"}),e("span",{children:e(h,{id:"LFKLqp"})})]})]}),!!g&&e(U,{children:[e(Ve,{}),z?e(ve,{onClick:()=>{f("loading"),(async()=>{try{const ne=await a.v1.accounts.$select((H==null?void 0:H.id)||w).unmute();v(ne),f("default"),pe(l({id:"B4Xkly",values:{username:k}})),x.reloadGenericAccounts.id="mute",x.reloadGenericAccounts.counter++}catch{f("error")}})()},children:[e(A,{icon:"unmute"}),e("span",{children:e(h,{id:"Q/HUhC",values:{username:k},components:{0:e("span",{class:"bidi-isolate"})}})})]}):e(an,{menuClassName:"menu-blur",openTrigger:"clickOnly",direction:"bottom",overflow:"auto",shift:16,label:e(U,{children:[e(A,{icon:"mute"}),e("span",{class:"menu-grow",children:e(h,{id:"xhPEH3",values:{username:k},components:{0:e("span",{class:"bidi-isolate"})}})}),e("span",{style:{textOverflow:"clip"},children:[e(A,{icon:"time"}),e(A,{icon:"chevron-right"})]})]}),children:e("div",{class:"menu-wrap",children:Hc.map(ne=>e(ve,{onClick:()=>{f("loading"),(async()=>{try{const oe=await a.v1.accounts.$select((H==null?void 0:H.id)||w).mute({duration:ne});v(oe),f("default"),pe(l({id:"/plB9m",values:{0:typeof Ft[ne]=="function"?Ft[ne]():d(Ft[ne]),username:k}})),x.reloadGenericAccounts.id="mute",x.reloadGenericAccounts.counter++}catch{f("error"),pe(l({id:"vWGBjT",values:{username:k}}))}})()},children:typeof Ft[ne]=="function"?Ft[ne]():d(Ft[ne])}))})}),te&&e(ht,{subMenu:!0,menuItemClassName:"danger",confirmLabel:e(U,{children:[e(A,{icon:"user-x"}),e("span",{children:e(h,{id:"unyq2W",values:{username:k},components:{0:e("span",{class:"bidi-isolate"})}})})]}),onClick:()=>{f("loading"),(async()=>{try{const ne=await a.v1.accounts.$select((H==null?void 0:H.id)||w).removeFromFollowers();v(ne),f("default"),pe(l({id:"AgkcM/",values:{username:k}})),x.reloadGenericAccounts.id="followers",x.reloadGenericAccounts.counter++}catch{f("error")}})()},children:[e(A,{icon:"user-x"}),e("span",{children:e(h,{id:"VCZ0OT"})})]}),e(ht,{subMenu:!0,confirm:!J,confirmLabel:e(U,{children:[e(A,{icon:"block"}),e("span",{children:e(h,{id:"aforS9",values:{username:k},components:{0:e("span",{class:"bidi-isolate"})}})})]}),itemProps:{className:"danger"},menuItemClassName:"danger",onClick:()=>{f("loading"),(async()=>{try{if(J){const ne=await a.v1.accounts.$select((H==null?void 0:H.id)||w).unblock();v(ne),f("default"),pe(l({id:"sI9N29",values:{username:k}}))}else{const ne=await a.v1.accounts.$select((H==null?void 0:H.id)||w).block();v(ne),f("default"),pe(l({id:"uYcYzu",values:{username:k}}))}x.reloadGenericAccounts.id="block",x.reloadGenericAccounts.counter++}catch{f("error"),J?pe(l({id:"0tG4wG",values:{username:k}})):pe(l({id:"pA+qEx",values:{username:k}}))}})()},children:J?e(U,{children:[e(A,{icon:"unblock"}),e("span",{children:e(h,{id:"/3LJfX",values:{username:k},components:{0:e("span",{class:"bidi-isolate"})}})})]}):e(U,{children:[e(A,{icon:"block"}),e("span",{children:e(h,{id:"JRswkR",values:{username:k},components:{0:e("span",{class:"bidi-isolate"})}})})]})}),e(ve,{className:"danger",onClick:()=>{x.showReportModal={account:H||n}},children:[e(A,{icon:"flag"}),e("span",{children:e(h,{id:"qTJgpR",values:{username:k},components:{0:e("span",{class:"bidi-isolate"})}})})]})]}),y&&be&&s&&et("@mastodon/profile-edit")&&e(U,{children:[e(Ve,{}),e(ve,{onClick:()=>{u(!0)},children:[e(A,{icon:"pencil"}),e("span",{children:e(h,{id:"9OpVZg"})})]})]}),!1]}),!g&&b==="loading"&&e(Ue,{abrupt:!0}),!!g&&!L&&e(ht,{confirm:P||M,confirmLabel:e("span",{children:l(M?{id:"e7qQIH"}:{id:"eYsAQr",values:{0:n.acct||n.username}})}),menuItemClassName:"danger",align:"end",disabled:le,onClick:()=>{f("loading"),(async()=>{try{let ne;P||M?ne=await a.v1.accounts.$select(B.current).unfollow():ne=await a.v1.accounts.$select(B.current).follow(),ne&&v(ne),f("default")}catch(ne){alert(ne),f("error")}})()},children:e("button",{type:"button",class:`${P||M?"light swap":""}`,"data-swap-state":P||M?"danger":"",disabled:le,children:P?e(U,{children:[e("span",{children:e(h,{id:"y6sq5j"})}),e("span",{children:e(h,{id:"HKrBPX"})})]}):M?e(U,{children:[e("span",{children:e(h,{id:"Yx0Ud8"})}),e("span",{children:e(h,{id:"yTVtKs"})})]}):T?e(U,{children:[e(A,{icon:"lock"})," ",e("span",{children:e(h,{id:"MKEPCY"})})]}):l({id:"MKEPCY"})})})]})]}),!!Re&&e(He,{onClose:()=>{$e(!1)},children:e(Xc,{note:I,fields:E,onClose:()=>$e(!1)})}),!!De&&e(He,{onClose:()=>{ze(!1)},children:e(Jc,{accountID:B.current,onClose:()=>ze(!1)})}),!!Le&&e(He,{onClose:()=>{Te(!1)},children:e(Qc,{account:n,note:re,onRelationshipChange:ne=>{v(ne)},onClose:()=>Te(!1)})})]})}function Wc([n,i,s]){const o=.2126*n+.7152*i+.0722*s;let c;return o>=220?c=1:o<=50?c=.1:c=o/255,c=Math.min(1,c),[n,i,s,c]}function Zc(n){if(!n)return;const i=URL.parse(n);if(!i)return;const{host:s,pathname:o}=i,c=o.replace(/\/$/,"").replace(/^\//,"");return e(U,{children:[e("span",{class:"more-insignificant",children:[rn.toUnicode(s),"/"]}),e("wbr",{}),e("span",{children:c})]})}function Xc({note:n,fields:i,onClose:s}){const{_:o}=de(),c=(i==null?void 0:i.map(({name:u,value:d})=>`${u}
${Li(d)}`).join(`

`))||"",r=Li(n)+(c?`

${c}`:"");return e("div",{class:"sheet",children:[!!s&&e("button",{type:"button",class:"sheet-close",onClick:s,children:e(A,{icon:"x",alt:o({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(h,{id:"9groMz"})})}),e("main",{children:[e("p",{style:{whiteSpace:"pre-wrap"},children:r}),e(As,{forceTranslate:!0,text:r})]})]})}function Jc({accountID:n,onClose:i}){const{_:s}=de(),{masto:o}=ce(),[c,r]=R("default"),[u,d]=R([]),[l,a]=R([]),[p,y]=Rt(f=>f+1,0);ie(()=>{r("loading"),(async()=>{try{const f=await ln();d(f);const g=await o.v1.accounts.$select(n).lists.list();a(g),r("default")}catch{r("error")}})()},[p]);const[m,b]=R(!1);return e("div",{class:"sheet",id:"list-add-remove-container",children:[!!i&&e("button",{type:"button",class:"sheet-close",onClick:i,children:e(A,{icon:"x",alt:s({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(h,{id:"sJ2yQc"})})}),e("main",{children:[u.length>0?e("ul",{class:"list-add-remove",children:u.map(f=>{const g=l.some(v=>v.id===f.id);return e("li",{children:e("button",{type:"button",class:`light ${g?"checked":""}`,disabled:c==="loading",onClick:()=>{r("loading"),(async()=>{try{g?await o.v1.lists.$select(f.id).accounts.remove({accountIds:[n]}):await o.v1.lists.$select(f.id).accounts.create({accountIds:[n]}),y()}catch{r("error"),alert(s(g?{id:"7KnEYa"}:{id:"Tba8uO"}))}})()},children:[e(A,{icon:"check-circle",alt:"☑️"}),e("span",{children:f.title})]})})})}):c==="loading"?e("p",{class:"ui-state",children:e(Ue,{abrupt:!0})}):c==="error"?e("p",{class:"ui-state",children:e(h,{id:"v/l5uA"})}):e("p",{class:"ui-state",children:e(h,{id:"/MJ7gZ"})}),e("button",{type:"button",class:"plain2",onClick:()=>b(!0),disabled:c!=="default",children:[e(A,{icon:"plus",size:"l"})," ",e("span",{children:e(h,{id:"Sb2gYF"})})]})]}),m&&e(He,{onClick:f=>{f.target===f.currentTarget&&b(!1)},children:e(ki,{list:m==null?void 0:m.list,onClose:f=>{f.state==="success"&&y(),b(!1)}})})]})}function Qc({account:n,note:i,onRelationshipChange:s=()=>{},onClose:o=()=>{}}){const{_:c}=de(),{masto:r}=ce(),[u,d]=R("default"),l=q(null);return ie(()=>{let a;return l.current&&!i&&(a=setTimeout(()=>{var p,y;(y=(p=l.current).focus)==null||y.call(p)},100)),()=>{clearTimeout(a)}},[]),e("div",{class:"sheet",id:"private-note-container",children:[!!o&&e("button",{type:"button",class:"sheet-close",onClick:o,children:e(A,{icon:"x",alt:c({id:"yz7wBu"})})}),e("header",{children:e("b",{children:e(h,{id:"DYqYm5",values:{0:(n==null?void 0:n.username)||(n==null?void 0:n.acct)},components:{0:e("span",{class:"bidi-isolate"})}})})}),e("main",{children:e("form",{onSubmit:a=>{a.preventDefault();const y=new FormData(a.target).get("note");(y==null?void 0:y.trim())!==(i==null?void 0:i.trim())&&(d("loading"),(async()=>{try{const m=await r.v1.accounts.$select(n==null?void 0:n.id).note.create({comment:y});d("default"),s(m),o()}catch(m){d("error"),alert((m==null?void 0:m.message)||c({id:"ot8LpF"}))}})())},children:[e("textarea",{ref:l,name:"note",disabled:u==="loading",dir:"auto",children:i}),e("footer",{children:[e("button",{type:"button",class:"light",disabled:u==="loading",onClick:()=>{o==null||o()},children:e(h,{id:"dEgA5A"})}),e("span",{children:[e(Ue,{abrupt:!0,hidden:u!=="loading"}),e("button",{disabled:u==="loading",type:"submit",children:e(h,{id:"SrwrEj"})})]})]})]})})]})}const ea=["image/jpeg","image/png","image/gif","image/webp"],Yi=ea.join(",");function ta({onClose:n=()=>{}}){const{_:i}=de(),{masto:s}=ce(),[o,c]=R("loading"),[r,u]=R(null),[d,l]=R(null),[a,p]=R(null);ie(()=>{(async()=>{try{const k=await s.v1.accounts.verifyCredentials();u(k),c("default")}catch{c("error")}})()},[]);const{displayName:y,source:m,avatar:b,header:f}=r||{},{note:g,fields:v}=m||{},w=q(null),_=[...b?[{type:"image",url:b}]:[],...a?[{type:"image",url:a}]:[]],S=[...f?[{type:"image",url:f}]:[],...d?[{type:"image",url:d}]:[]];return e("div",{class:"sheet",id:"edit-profile-container",children:[!!n&&e("button",{type:"button",class:"sheet-close",onClick:n,children:e(A,{icon:"x",alt:i({id:"yz7wBu"})})}),e("header",{children:e("b",{children:e(h,{id:"9OpVZg"})})}),e("main",{children:o==="loading"?e("p",{class:"ui-state",children:e(Ue,{abrupt:!0})}):e("form",{onSubmit:k=>{k.preventDefault();const T=new FormData(k.target),C=T.get("header"),I=T.get("avatar"),E=T.get("display_name"),L=T.get("note"),B=w.current.querySelectorAll('input[name^="fields_attributes"]'),P=[];B.forEach(Y=>{const Q=Y.name,[te,J,V]=Q.match(/fields_attributes\[(\d+)\]\[(.+)\]/)||[],z=Y.value?Y.value.trim():"";J&&V&&z&&(P[J]||(P[J]={}),P[J][V]=z)}),P.forEach(Y=>{Y.name&&!Y.value&&(Y.value="")}),(async()=>{try{const Y=await s.v1.accounts.updateCredentials({header:C,avatar:I,displayName:E,note:L,fieldsAttributes:P});n==null||n({state:"success",account:Y})}catch(Y){alert((Y==null?void 0:Y.message)||i({id:"FwMMx0"}))}})()},children:[e("div",{class:"edit-profile-media-container",children:[e("label",{children:[e(h,{id:"C5zXYJ"})," ",e("input",{type:"file",name:"header",accept:Yi,onChange:k=>{const T=k.target.files[0];if(T){const C=URL.createObjectURL(T);l(C)}}})]}),e("div",{class:"edit-profile-media-field",children:[f?e("div",{class:"edit-media",tabIndex:"0",onClick:()=>{x.showMediaModal={mediaAttachments:S,index:0}},children:e("img",{src:f,alt:""})}):e("div",{class:"edit-media"}),d&&e(U,{children:[e(A,{icon:"arrow-right"}),e("div",{class:"edit-media",tabIndex:"0",onClick:()=>{x.showMediaModal={mediaAttachments:S,index:1}},children:e("img",{src:d,alt:""})})]})]})]}),e("div",{class:"edit-profile-media-container",children:[e("label",{children:[e(h,{id:"4XF0BB"})," ",e("input",{type:"file",name:"avatar",accept:Yi,onChange:k=>{const T=k.target.files[0];if(T){const C=URL.createObjectURL(T);p(C)}}})]}),e("div",{class:"edit-profile-media-field",children:[b?e("div",{class:"edit-media",tabIndex:"0",onClick:()=>{x.showMediaModal={mediaAttachments:_,index:0}},children:e("img",{src:b,alt:""})}):e("div",{class:"edit-media"}),a&&e(U,{children:[e(A,{icon:"arrow-right"}),e("div",{class:"edit-media",tabIndex:"0",onClick:()=>{x.showMediaModal={mediaAttachments:_,index:1}},children:e("img",{src:a,alt:""})})]})]})]}),e("p",{children:e("label",{children:[e(h,{id:"6YtxFj"})," ",e("input",{type:"text",name:"display_name",defaultValue:y,maxLength:30,disabled:o==="loading",dir:"auto"})]})}),e("p",{children:e("label",{children:[e(h,{id:"E+oKCO"}),e("textarea",{defaultValue:g,name:"note",maxLength:500,rows:"5",disabled:o==="loading",dir:"auto"})]})}),e("p",{children:e(h,{id:"T4I119"})}),e("table",{ref:w,children:[e("thead",{children:e("tr",{children:[e("th",{children:e(h,{id:"87a/t/"})}),e("th",{children:e(h,{id:"4b3oEV"})})]})}),e("tbody",{children:Array.from({length:Math.max(4,v.length)}).map((k,T)=>{const{name:C="",value:I=""}=v[T]||{};return e(na,{name:C,value:I,index:T,disabled:o==="loading"},T)})})]}),e("footer",{children:[e("button",{type:"button",class:"light",disabled:o==="loading",onClick:()=>{n==null||n()},children:e(h,{id:"dEgA5A"})}),e("button",{type:"submit",disabled:o==="loading",children:e(h,{id:"tfDRzk"})})]})]})})]})}function na({name:n,value:i,disabled:s,index:o}){const[c,r]=R(!!i);return e("tr",{children:[e("td",{children:e("input",{type:"text",name:`fields_attributes[${o}][name]`,defaultValue:n,disabled:s,maxLength:255,required:c,dir:"auto"})}),e("td",{children:e("input",{type:"text",name:`fields_attributes[${o}][value]`,defaultValue:i,disabled:s,maxLength:255,onChange:u=>r(!!u.currentTarget.value),dir:"auto"})})]})}function ia({acct:n,instance:i}){let[s,o]=n.split("@");o||(o=i);const c=rn.toASCII(n);return e("div",{class:"handle-info",children:[e("span",{class:"handle-handle",title:c,children:[e("b",{class:"handle-username",children:s}),e("span",{class:"handle-at",children:"@"}),e("b",{class:"handle-server",children:o})]}),e("div",{class:"handle-legend",children:[e("span",{class:"ib",children:[e("span",{class:"handle-legend-icon username"})," ",e(h,{id:"silO9A"})]})," ",e("span",{class:"ib",children:[e("span",{class:"handle-legend-icon server"})," ",e(h,{id:"rZgCpJ"})]})]})]})}function sa({account:n,instance:i,onClose:s}){const{_:o}=de(),{masto:c,instance:r,authenticated:u}=ce({instance:i}),d=typeof n=="string";return ie(()=>{d||(x.accounts[`${n.id}@${r}`]=n)},[n]),Us(s),e("div",{class:"sheet",children:[!!s&&e("button",{type:"button",class:"sheet-close outer",onClick:s,children:e(A,{icon:"x",alt:o({id:"yz7wBu"})})}),e(Ys,{instance:r,authenticated:u,account:n,fetchAccount:async()=>{if(d)try{return await c.v1.accounts.lookup({acct:n,skip_webfinger:!1})}catch{const a=await c.v2.search.fetch({q:n,type:"accounts",limit:1,resolve:u});if(a.accounts.length)return a.accounts[0];if(/https?:\/\/[^/]+\/@/.test(n)){const p=URL.parse(n);if(p){const{hostname:y,pathname:m}=p,b=m.replace(/^\//,"").replace(/\/$/,"")+"@"+y,f=await c.v2.search.fetch({q:b,type:"accounts",limit:1,resolve:u});if(f.accounts.length)return f.accounts[0]}}}else return n}})]})}function oa({onClose:n}){const{_:i}=de(),{masto:s}=ce(),[o,c]=R("default"),[r,u]=R([]),[d,l]=Rt(p=>p+1,0);ie(()=>{c("loading"),(async()=>{try{const p=await mt.drafts.keys();if(p.length){const y=Cn(),m=p.filter(b=>b.startsWith(y));if(m.length){const b=await mt.drafts.getMany(m);b.sort((f,g)=>new Date(g.updatedAt).getTime()-new Date(f.updatedAt).getTime()),u(b)}else u([])}else u([]);c("default")}catch{c("error")}})()},[d]);const a=(r==null?void 0:r.length)>0;return e("div",{class:"sheet",children:[!!n&&e("button",{type:"button",class:"sheet-close",onClick:n,children:e(A,{icon:"x",alt:i({id:"yz7wBu"})})}),e("header",{children:[e("h2",{children:[e(h,{id:"krk5ws"})," ",e(Ue,{abrupt:!0,hidden:o!=="loading"})]}),a&&e("div",{class:"insignificant",children:e(h,{id:"Ap/10+"})})]}),e("main",{children:a?e(U,{children:[e("ul",{class:"drafts-list",children:r.map(p=>{const{updatedAt:y,key:m,draftStatus:b,replyTo:f}=p,g=new Date(y);return e("li",{children:[e("div",{class:"mini-draft-meta",children:[e("b",{children:[e(A,{icon:f?"reply":"quill",size:"s"})," ",e("time",{children:[!!f&&e(U,{children:[e("span",{class:"bidi-isolate",children:["@",f.account.acct]}),e("br",{})]}),ct(g)]})]}),e(ht,{confirmLabel:e("span",{children:e(h,{id:"/W5yFF"})}),menuItemClassName:"danger",align:"end",disabled:o==="loading",onClick:()=>{(async()=>{try{await mt.drafts.del(m),l()}catch{alert(i({id:"rEYoku"}))}})()},children:e("button",{type:"button",class:"small light",disabled:o==="loading",children:e(h,{id:"Jb6/SB"})})})]}),e("button",{type:"button",disabled:o==="loading",class:"draft-item",onClick:async()=>{let v;if(f){c("loading");try{v=await s.v1.statuses.$select(f.id).fetch()}catch{alert(i({id:"tMwimH"})),c("default");return}c("default")}window.__COMPOSE__={draftStatus:b,replyToStatus:v},x.showCompose=!0,x.showDrafts=!1},children:e(ca,{draft:p})})]},y)})}),r.length>1&&e("p",{children:e(ht,{confirmLabel:e("span",{children:e(h,{id:"3IakFR"})}),menuItemClassName:"danger",disabled:o==="loading",onClick:()=>{(async()=>{c("loading");try{await mt.drafts.delMany(r.map(p=>p.key)),c("default"),l()}catch{alert(i({id:"0J4sZq"})),c("error")}})()},children:e("button",{type:"button",class:"light danger",disabled:o==="loading",children:e(h,{id:"hOg+Mt"})})})})]}):e("p",{children:e(h,{id:"8iQ+jk"})})})]})}function ca({draft:n}){var m;const{_:i}=de(),{draftStatus:s,replyTo:o}=n,{status:c,spoilerText:r,poll:u,mediaAttachments:d}=s,l=((m=u==null?void 0:u.options)==null?void 0:m.length)>0,a=(d==null?void 0:d.length)>0,p=l||a,y=_e(()=>{if(!a)return;const b=d.find(v=>/image/.test(v.type));if(!b)return;const{file:f}=b;return URL.createObjectURL(f)},[a,d]);return e(U,{children:e("div",{class:"mini-draft",children:[p&&e("div",{class:`mini-draft-aside ${y?"has-image":""}`,style:y?{"--bg-image":`url(${y})`}:{},children:[l&&e(A,{icon:"poll",alt:i({id:"4WUbF1"})}),a&&e("span",{children:[e(A,{icon:"attachment",alt:i({id:"xYilR2"})})," ",e("small",{children:d==null?void 0:d.length})]})]}),e("div",{class:"mini-draft-main",children:[!!r&&e("div",{class:"mini-draft-spoiler",children:r}),!!c&&e("div",{class:"mini-draft-status",children:c})]})]})})}function aa({html:n,url:i,width:s,height:o,onClose:c=()=>{}}){const{_:r}=de();return e("div",{class:"embed-modal-container",children:[e("div",{class:"top-controls",children:[e("button",{type:"button",class:"light",onClick:()=>c(),children:e(A,{icon:"x",alt:r({id:"yz7wBu"})})}),i&&e("a",{href:i,target:"_blank",rel:"noopener",class:"button plain",children:[e("span",{children:e(h,{id:"4/RpOy"})})," ",e(A,{icon:"external"})]})]}),e("div",{class:"embed-content",dangerouslySetInnerHTML:{__html:n},style:{"--width":s+"px","--height":o+"px","--aspect-ratio":`${s}/${o}`}})]})}function ra({instance:n,excludeRelationshipAttrs:i=[],postID:s,onClose:o=()=>{},blankCopy:c}){const{_:r}=de(),{masto:u,instance:d}=ce(),l=n?n===d:!0,a=Ge(x),[p,y]=R("default"),[m,b]=R([]),[f,g]=R(!1);if(Us(o),!a.showGenericAccounts)return null;const{id:v,heading:w,fetchAccounts:_,accounts:S,showReactions:k}=a.showGenericAccounts,[T,C]=R({}),I=async P=>{if(!(P!=null&&P.length)||!l)return;const Y=await ui(P,T);Y&&C({...T,...Y})},E=P=>{_&&(P&&b([]),y("loading"),(async()=>{try{const{done:Y,value:Q}=await _(P);if(Array.isArray(Q)){if(P){const te=[];for(let J=0;J<Q.length;J++){const V=Q[J],z=te.find((ue,M)=>ue.id===V.id&&J!==M);z?z._types.push(...V._types):te.push({_types:[],...V})}b(te)}else b(te=>{const J=te;for(const V of Q){const z=J.find(ue=>ue.id===V.id);z?z._types.push(...V._types):J.push(V)}return J});g(!Y),I(Q)}else g(!1);y("default")}catch{y("error")}})())},L=q(!0);ie(()=>{(S==null?void 0:S.length)>0?(b(S),I(S)):(E(!0),L.current=!1)},[S,_]),ie(()=>{var P;L.current||((P=a.reloadGenericAccounts)==null?void 0:P.id)===v&&E(!0)},[a.reloadGenericAccounts.counter]);const B=x.statuses[s];return e("div",{id:"generic-accounts-container",class:"sheet",tabindex:"-1",children:[e("button",{type:"button",class:"sheet-close",onClick:o,children:e(A,{icon:"x",alt:r({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:w||r({id:"bPwFdf"})})}),e("main",{children:[B&&e(ge,{to:`/${n||d}/s/${B.id}`,class:"post-preview",children:e(qe,{status:B,size:"s",readOnly:!0})}),m.length>0?e(U,{children:[e("ul",{class:"accounts-list",children:m.map(P=>{var te,J;const Y=T[P.id],Q=`${P.id}-${((te=P._types)==null?void 0:te.length)||""}`;return e("li",{children:[k&&((J=P._types)==null?void 0:J.length)>0&&e("div",{class:"reactions-block",children:P._types.map(V=>e(A,{icon:{reblog:"rocket",favourite:"heart"}[V],class:`${V}-icon`}))}),e("div",{class:"account-relationships",children:e(ft,{account:P,showStats:!0,relationship:Y,excludeRelationshipAttrs:i})})]},Q)})}),p==="default"?f?e(Ct,{onChange:P=>{P&&E()},children:e("button",{type:"button",class:"plain block",onClick:()=>E(),children:e(h,{id:"uXRAkV"})})}):e("p",{class:"ui-state insignificant",children:e(h,{id:"2EYeAZ"})}):p==="loading"&&e("p",{class:"ui-state",children:e(Ue,{abrupt:!0})})]}):p==="loading"?e("p",{class:"ui-state",children:e(Ue,{abrupt:!0})}):p==="error"?e("p",{class:"ui-state",children:e(h,{id:"AThL/k"})}):e("p",{class:"ui-state insignificant",children:c||r({id:"10OlfF"})})]})]})}function la({alt:n,lang:i,onClose:s}){const{_:o}=de(),c=Ge(x),[r,u]=R(!1),d=_s(!0),l=c.settings.contentTranslationHideLanguages||[],a=!!i&&i!==d&&!xi([i],[d])&&!l.find(p=>i===p||xi([i],[p]));return e("div",{class:"sheet",tabindex:"-1",children:[!!s&&e("button",{type:"button",class:"sheet-close outer",onClick:s,children:e(A,{icon:"x",alt:o({id:"yz7wBu"})})}),e("header",{class:"header-grid",children:[e("h2",{children:e(h,{id:"5gfDMm"})}),e("div",{class:"header-side",children:e(lt,{align:"end",menuButton:e("button",{type:"button",class:"plain4",children:e(A,{icon:"more",alt:o({id:"2FYpfJ"}),size:"xl"})}),children:[e(ve,{disabled:r,onClick:()=>{u(!0)},children:[e(A,{icon:"translate"}),e("span",{children:e(h,{id:"pi8x/S"})})]}),Bo&&e(ve,{onClick:()=>{Fo(n,i)},children:[e(A,{icon:"speak"}),e("span",{children:e(h,{id:"yIBLq8"})})]})]})})]}),e("main",{lang:i,dir:"auto",children:[e("p",{style:{whiteSpace:"pre-wrap",textWrap:"pretty"},children:n}),(a||r)&&e(As,{forceTranslate:r,sourceLanguage:i,text:n})]})]})}const{min:Ad,max:Td}=Math;const qs={};for(let n of["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"])qs[`[object ${n}]`]=n.toLowerCase();function da(n){return qs[Object.prototype.toString.call(n)]||"object"}const Zt=(n,i=null)=>n.length>=3?Array.prototype.slice.call(n):da(n[0])=="object"&&i?i.split("").filter(s=>n[0][s]!==void 0).map(s=>n[0][s]):n[0].slice(0);const{PI:Pn,min:xd,max:Ed}=Math;const Rd=Pn*2,Ld=Pn/3,ua=Pn/180,ha=180/Pn;function Tn(n,i){let s=n.length;Array.isArray(n[0])||(n=[n]),Array.isArray(i[0])||(i=i.map(u=>[u]));let o=i[0].length,c=i[0].map((u,d)=>i.map(l=>l[d])),r=n.map(u=>c.map(d=>Array.isArray(u)?u.reduce((l,a,p)=>l+a*(d[p]||0),0):d.reduce((l,a)=>l+a*u,0)));return s===1&&(r=r[0]),o===1?r.map(u=>u[0]):r}const js={Kn:18,labWhitePoint:"d65",Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452,kE:216/24389,kKE:8,kK:24389/27,RefWhiteRGB:{X:.95047,Y:1,Z:1.08883},MtxRGB2XYZ:{m00:.4124564390896922,m01:.21267285140562253,m02:.0193338955823293,m10:.357576077643909,m11:.715152155287818,m12:.11919202588130297,m20:.18043748326639894,m21:.07217499330655958,m22:.9503040785363679},MtxXYZ2RGB:{m00:3.2404541621141045,m01:-.9692660305051868,m02:.055643430959114726,m10:-1.5371385127977166,m11:1.8760108454466942,m12:-.2040259135167538,m20:-.498531409556016,m21:.041556017530349834,m22:1.0572251882231791},As:.9414285350000001,Bs:1.040417467,Cs:1.089532651,MtxAdaptMa:{m00:.8951,m01:-.7502,m02:.0389,m10:.2664,m11:1.7135,m12:-.0685,m20:-.1614,m21:.0367,m22:1.0296},MtxAdaptMaI:{m00:.9869929054667123,m01:.43230526972339456,m02:-.008528664575177328,m10:-.14705425642099013,m11:.5183602715367776,m12:.04004282165408487,m20:.15996265166373125,m21:.0492912282128556,m22:.9684866957875502}};const Hn=n=>{const i=Math.sign(n);return n=Math.abs(n),(n<=.0031308?n*12.92:1.055*Math.pow(n,1/2.4)-.055)*i},fa=(n,i,s)=>{const{MtxAdaptMa:o,MtxAdaptMaI:c,MtxXYZ2RGB:r,RefWhiteRGB:u,Xn:d,Yn:l,Zn:a}=js,p=d*o.m00+l*o.m10+a*o.m20,y=d*o.m01+l*o.m11+a*o.m21,m=d*o.m02+l*o.m12+a*o.m22,b=u.X*o.m00+u.Y*o.m10+u.Z*o.m20,f=u.X*o.m01+u.Y*o.m11+u.Z*o.m21,g=u.X*o.m02+u.Y*o.m12+u.Z*o.m22,v=(n*o.m00+i*o.m10+s*o.m20)*(b/p),w=(n*o.m01+i*o.m11+s*o.m21)*(f/y),_=(n*o.m02+i*o.m12+s*o.m22)*(g/m),S=v*c.m00+w*c.m10+_*c.m20,k=v*c.m01+w*c.m11+_*c.m21,T=v*c.m02+w*c.m12+_*c.m22,C=Hn(S*r.m00+k*r.m10+T*r.m20),I=Hn(S*r.m01+k*r.m11+T*r.m21),E=Hn(S*r.m02+k*r.m12+T*r.m22);return[C*255,I*255,E*255]},Si=(...n)=>{n=Zt(n,"lab");const[i,s,o,...c]=n,[r,u,d]=pa([i,s,o]),[l,a,p]=fa(r,u,d);return[l,a,p,...c.length>0&&c[0]<1?[c[0]]:[]]};function pa(n){var i=[[1.2268798758459243,-.5578149944602171,.2813910456659647],[-.0405757452148008,1.112286803280317,-.0717110580655164],[-.0763729366746601,-.4214933324022432,1.5869240198367816]],s=[[1,.3963377773761749,.2158037573099136],[1,-.1055613458156586,-.0638541728258133],[1,-.0894841775298119,-1.2914855480194092]],o=Tn(s,n);return Tn(i,o.map(c=>c**3))}function Yn(n){const i=Math.sign(n);return n=Math.abs(n),(n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4))*i}const ma=(n,i,s)=>{n=Yn(n/255),i=Yn(i/255),s=Yn(s/255);const{MtxRGB2XYZ:o,MtxAdaptMa:c,MtxAdaptMaI:r,Xn:u,Yn:d,Zn:l,As:a,Bs:p,Cs:y}=js;let m=n*o.m00+i*o.m10+s*o.m20,b=n*o.m01+i*o.m11+s*o.m21,f=n*o.m02+i*o.m12+s*o.m22;const g=u*c.m00+d*c.m10+l*c.m20,v=u*c.m01+d*c.m11+l*c.m21,w=u*c.m02+d*c.m12+l*c.m22;let _=m*c.m00+b*c.m10+f*c.m20,S=m*c.m01+b*c.m11+f*c.m21,k=m*c.m02+b*c.m12+f*c.m22;return _*=g/a,S*=v/p,k*=w/y,m=_*r.m00+S*r.m10+k*r.m20,b=_*r.m01+S*r.m11+k*r.m21,f=_*r.m02+S*r.m12+k*r.m22,[m,b,f]},_i=(...n)=>{const[i,s,o,...c]=Zt(n,"rgb"),r=ma(i,s,o);return[...ga(r),...c.length>0&&c[0]<1?[c[0]]:[]]};function ga(n){const i=[[.819022437996703,.3619062600528904,-.1288737815209879],[.0329836539323885,.9292868615863434,.0361446663506424],[.0481771893596242,.2642395317527308,.6335478284694309]],s=[[.210454268309314,.7936177747023054,-.0040720430116193],[1.9779985324311684,-2.42859224204858,.450593709617411],[.0259040424655478,.7827717124575296,-.8086757549230774]],o=Tn(i,n);return Tn(s,o.map(c=>Math.cbrt(c)))}const{sin:ba,cos:ya}=Math,va=(...n)=>{let[i,s,o]=Zt(n,"lch");return isNaN(o)&&(o=0),o=o*ua,[i,ya(o)*s,ba(o)*s]},qn=(...n)=>{n=Zt(n,"lch");const[i,s,o,...c]=n,[r,u,d]=va(i,s,o),[l,a,p]=Si(r,u,d);return[l,a,p,...c.length>0&&c[0]<1?[c[0]]:[]]},{sqrt:wa,atan2:ka,round:Sa}=Math,_a=(...n)=>{const[i,s,o]=Zt(n,"lab"),c=wa(s*s+o*o);let r=(ka(o,s)*ha+360)%360;return Sa(c*1e4)===0&&(r=Number.NaN),[i,c,r]},Ca=(...n)=>{const[i,s,o,...c]=Zt(n,"rgb"),[r,u,d]=_i(i,s,o),[l,a,p]=_a(r,u,d);return[l,a,p,...c.length>0&&c[0]<1?[c[0]]:[]]},Ia={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Blaede Phanpy",PHANPY_DEFAULT_INSTANCE:"mastodon.blaede.family",PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:"https://mastodon.blaede.family/auth/sign_up",PHANPY_GIPHY_API_KEY:"48JGsrSS1XE5w4nWe9c9hqxPbsfRWR0e",PHANPY_LINGVA_INSTANCES:"lingva.phanpy.social lingva.lunar.icu lingva.garudalinux.org translate.plausibility.cloud",PHANPY_PRIVACY_POLICY_URL:"https://mastodon.blaede.family/privacy-policy",PHANPY_TRANSLANG_INSTANCES:"translang.phanpy.social",PHANPY_WEBSITE:"https://phanpy.blaede.family",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},{PHANPY_IMG_ALT_API_URL:Md}=Ia;function Gs({mediaAttachments:n,statusID:i,instance:s,lang:o,index:c=0,onClose:r=()=>{}}){var k,T;const{_:u}=de(),[d,l]=R("default"),a=q(null),[p,y]=R(c),m=q(null);kt(()=>{var C;(C=m.current)==null||C.scrollIntoView()},[]);const b=q(i);ie(()=>{const C=c*a.current.clientWidth,I=b.current!==i;I&&(b.current=i),a.current.focus(),a.current.scrollTo({left:C*(Dt()?-1:1),behavior:I?"auto":"smooth"})},[c,i]);const[f,g]=R(!0);ie(()=>{let C=()=>{r()};return a.current&&a.current.addEventListener("swiped-down",C),()=>{a.current&&a.current.removeEventListener("swiped-down",C)}},[]),Fe("esc",r,{ignoreEventWhen:C=>!!document.querySelector("#modal-container > *")},[r]),ie(()=>{let C=()=>{const{clientWidth:I,scrollLeft:E}=a.current,L=Math.round(Math.abs(E)/I);y(L)};return a.current&&a.current.addEventListener("scroll",C,{passive:!0}),()=>{a.current&&a.current.removeEventListener("scroll",C)}},[]),ie(()=>{let C=setTimeout(()=>{var I,E;(E=(I=a.current)==null?void 0:I.focus)==null||E.call(I)},100);return()=>clearTimeout(C)},[]);const v=_e(()=>n==null?void 0:n.map(C=>{const{blurhash:I}=C;if(I){const E=hi(I);return Ca(E)}return null}),[n]),w=_e(()=>v==null?void 0:v.map(C=>C?{light:qn([.95,.01,C[2]]),dark:qn([.35,.01,C[2]]),default:qn([.6,C[1],C[2]])}:null)),_=_e(()=>{const I=100/w.length,E=w.map((P,Y)=>{var J,V,z,ue;const Q=Y*I+5,te=(Y+1)*I-5;return P!=null&&P.light&&(P!=null&&P.dark)?{light:`
                rgb(${(J=P.light)==null?void 0:J.join(",")}) ${Q}%, 
                rgb(${(V=P.light)==null?void 0:V.join(",")}) ${te}%
              `,dark:`
                rgb(${(z=P.dark)==null?void 0:z.join(",")}) ${Q}%, 
                rgb(${(ue=P.dark)==null?void 0:ue.join(",")}) ${te}%
              `}:{light:`
              transparent ${Q}%, 
              transparent ${te}%
            `,dark:`
              transparent ${Q}%, 
              transparent ${te}%
            `}}),L=E.map(P=>P.light).join(", "),B=E.map(P=>P.dark).join(", ");return{light:L,dark:B}},[w]);let S=q(null);return ie(()=>()=>{var C,I;(I=(C=S.current)==null?void 0:C.hideToast)==null||I.call(C)},[]),kt(()=>{const C=w[p];let I,E;if(C){const L=ye.local.get("theme");if(L){const B=`rgb(${C[L].join(",")})`;I=document.querySelector('meta[name="theme-color"][data-theme-setting="manual"]'),I&&(E=I.content,I.content=B)}else{const B=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",P=`rgb(${C[B].join(",")})`;I=document.querySelector(`meta[name="theme-color"][media*="${B}"]`),I&&(E=I.content,I.content=P)}}return()=>{I&&E&&(I.content=E)}},[p,w]),e("div",{class:`media-modal-container media-modal-count-${n==null?void 0:n.length}`,children:[e("div",{ref:a,tabIndex:"0","data-swipe-threshold":"44",class:"carousel",onClick:C=>{(C.target.classList.contains("carousel-item")||C.target.classList.contains("media")||C.target.classList.contains("media-zoom"))&&r()},style:n.length>1?{backgroundAttachment:"local","--accent-gradient-light":_==null?void 0:_.light,"--accent-gradient-dark":_==null?void 0:_.dark}:{},children:n==null?void 0:n.map((C,I)=>{var L,B;const E=n.length===1?w[I]:null;return e("div",{class:"carousel-item",style:E?{"--accent-color":`rgb(${E.default.join(",")})`,"--accent-light-color":`rgb(${(L=E.light)==null?void 0:L.join(",")})`,"--accent-dark-color":`rgb(${(B=E.dark)==null?void 0:B.join(",")})`,"--accent-alpha-color":`rgba(${E.default.join(",")}, 0.4)`}:{},tabindex:"0",ref:I===p?m:null,onClick:P=>{P.target.classList.contains("media")||g(!f)},children:[!!C.description&&e("button",{type:"button",class:"media-alt",hidden:!f,onClick:()=>{x.showMediaAlt={alt:C.description,lang:o}},children:[e("span",{class:"alt-badge",children:"ALT"}),e("span",{class:"media-alt-desc",lang:o,dir:"auto",children:C.description})]}),e(Ts,{media:C,showOriginal:!0,lang:o})]},C.id)})}),e("div",{class:"carousel-top-controls",hidden:!f,children:[e("span",{children:e("button",{type:"button",class:"carousel-button",onClick:()=>r(),children:e(A,{icon:"x",alt:u({id:"yz7wBu"})})})}),(n==null?void 0:n.length)>1?e("span",{class:"carousel-dots",children:n==null?void 0:n.map((C,I)=>e("button",{type:"button",disabled:I===p,class:`carousel-dot ${I===p?"active":""}`,onClick:E=>{E.preventDefault(),E.stopPropagation();const L=a.current.clientWidth*I*(Dt()?-1:1);a.current.focus(),a.current.scrollTo({left:L,behavior:"smooth"})},children:e(A,{icon:"round",size:"s",alt:"⸱"})},C.id))}):e("span",{}),e("span",{children:[e(lt,{overflow:"auto",align:"end",position:"anchor",gap:4,menuClassName:"glass-menu",menuButton:e("button",{type:"button",class:"carousel-button",children:e(A,{icon:"more",alt:u({id:"2FYpfJ"})})}),children:[e(Ye,{href:((k=n[p])==null?void 0:k.remoteUrl)||((T=n[p])==null?void 0:T.url),class:"carousel-button",target:"_blank",title:u({id:"5hXGws"}),children:[e(A,{icon:"popout"}),e("span",{children:e(h,{id:"aDr7Vc"})})]}),!1]})," ",!!i&&e(ge,{to:`${s?`/${s}`:""}/s/${i}${window.matchMedia("(min-width: calc(40em + 350px))").matches?`?media=${p+1}`:""}`,class:"button carousel-button media-post-link",children:[e("span",{class:"button-label",children:[e(h,{id:"ISg5SQ"})," "]}),"»"]})]})]}),(n==null?void 0:n.length)>1&&e("div",{class:"carousel-controls",hidden:!f,children:[e("button",{type:"button",class:"carousel-button",hidden:p===0,onClick:C=>{C.preventDefault(),C.stopPropagation(),a.current.focus(),a.current.scrollTo({left:a.current.clientWidth*(p-1)*(Dt()?-1:1),behavior:"smooth"})},children:e(A,{icon:"arrow-left",alt:u({id:"DHhJ7s"})})}),e("button",{type:"button",class:"carousel-button",hidden:p===n.length-1,onClick:C=>{C.preventDefault(),C.stopPropagation(),a.current.focus(),a.current.scrollTo({left:a.current.clientWidth*(p+1)*(Dt()?-1:1),behavior:"smooth"})},children:e(A,{icon:"arrow-right",alt:u({id:"hXzOVo"})})})]})]})}const Aa=[,"spam","legal","violation","other"],Xt={spam:{label:{id:"t8dIOP"},description:{id:"csQin/"}},legal:{label:{id:"IjKdHM"},description:{id:"e6tGFu"}},violation:{label:{id:"KPFHM2"},description:{id:"fpotTF"},stampLabel:{id:"iuLUuH"}},other:{label:{id:"/IX/7x"},description:{id:"kxiG8g"},excludeStamp:!0}};function Ta({account:n,post:i,onClose:s}){const{_:o,_:c}=de(),{masto:r}=ce(),[u,d]=R("default"),[l,a]=n.acct.split("@"),[p,y]=_e(()=>{const{rules:S,domain:k}=ms();return[S||[],k]}),[m,b]=R(null),[f,g]=R(!1),v=q(null),[w,_]=R(!1);return e("div",{class:"report-modal-container",children:[e("div",{class:"top-controls",children:[e("h1",{children:c(i?{id:"muLhL3"}:{id:"ACul2G",values:{username:l}})}),e("button",{type:"button",class:"plain4 small",disabled:u==="loading",onClick:()=>s(),children:e(A,{icon:"x",size:"xl",alt:c({id:"yz7wBu"})})})]}),e("main",{children:[e("div",{class:"report-preview",children:i?e(qe,{status:i,size:"s",previewMode:!0}):e(ft,{account:n,avatarSize:"xxl",useAvatarStatic:!0,showStats:!0,showActivity:!0})}),!!m&&!Xt[m].excludeStamp&&e("span",{class:"rubber-stamp","aria-hidden":"true",children:[o(Xt[m].stampLabel||o(Xt[m].label)),e("small",{children:e(h,{id:"2WtL62"})})]},m),e("form",{onSubmit:S=>{S.preventDefault();const k=new FormData(S.target),T=Object.fromEntries(k.entries());let{category:C,comment:I,forward:E}=T;I||(I=void 0),E==="on"&&(E=!0);const L=C==="violation"?Object.entries(T).filter(([P])=>P.startsWith("rule_ids")).map(([P,Y])=>Y):void 0,B={category:C,comment:I,forward:E,ruleIds:L};d("loading"),(async()=>{try{await r.v1.reports.create({accountId:n.id,statusIds:i!=null&&i.id?[i.id]:void 0,category:C,comment:I,ruleIds:L,forward:E}),d("success"),pe(c(i?{id:"y3ou+8"}:{id:"R9kjEL"})),s()}catch(P){d("error"),pe((P==null?void 0:P.message)||c(i?{id:"+3FjPq"}:{id:"oEQq5w"}))}})()},children:[e("p",{children:c(i?{id:"L9fUm+"}:{id:"rSLkfe"})}),e("section",{class:"report-categories",children:Aa.map(S=>S==="violation"&&!(p!=null&&p.length)?null:e(U,{children:[e("label",{class:"report-category",children:[e("input",{type:"radio",name:"category",value:S,required:!0,disabled:u==="loading",onChange:k=>{b(k.target.value),g(k.target.value==="violation")}}),e("span",{children:[o(Xt[S].label),"  ",e("small",{class:"ib insignificant",children:o(Xt[S].description)})]})]}),S==="violation"&&!!(p!=null&&p.length)&&e("div",{class:"shazam-container no-animation",hidden:!f,children:e("div",{class:"shazam-container-inner",children:e("div",{class:"report-rules",ref:v,children:p.map((k,T)=>e("label",{class:"report-rule",children:[e("input",{type:"checkbox",name:`rule_ids[${T}]`,value:k.id,required:f&&!w,disabled:u==="loading",onChange:C=>{const{checked:I}=C.target;I?_(!0):v.current.querySelectorAll("input:checked").length||_(!1)}}),e("span",{children:k.text})]},k.id))})})})]},S))}),e("section",{class:"report-comment",children:[e("p",{children:e("label",{for:"report-comment",children:e(h,{id:"ecVtjm"})})}),e("textarea",{maxlength:"1000",rows:"1",name:"comment",id:"report-comment",disabled:u==="loading",required:!i})]}),!!a&&a!==y&&e("section",{children:e("p",{children:e("label",{children:[e("input",{type:"checkbox",switch:!0,name:"forward",disabled:u==="loading"})," ",e("span",{children:e(h,{id:"cyjS8M",values:{domain:a},components:{0:e("i",{})}})})]})})}),e("footer",{children:[e("button",{type:"submit",disabled:u==="loading",children:e(h,{id:"4cijjm"})})," ",e("button",{type:"submit",class:"plain2",disabled:u==="loading",onClick:async()=>{try{await r.v1.accounts.$select(n.id).mute(),pe(c({id:"/BGBeF",values:{username:l}}))}catch{pe(c({id:"v02K7/",values:{username:l}}))}},children:e(h,{id:"caeqw/",components:{0:e("small",{class:"ib"})}})})," ",e("button",{type:"submit",class:"plain2",disabled:u==="loading",onClick:async()=>{try{await r.v1.accounts.$select(n.id).block(),pe(c({id:"kjUejn",values:{username:l}}))}catch{pe(c({id:"pMcdDp",values:{username:l}}))}},children:e(h,{id:"JybQca",components:{0:e("small",{class:"ib"})}})}),e(Ue,{hidden:u!=="loading"})]})]})]})]})}var bn={exports:{}},$d=bn.exports,qi;function xa(){return qi||(qi=1,function(n){var i=function(){var s=String.fromCharCode,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",r={};function u(l,a){if(!r[l]){r[l]={};for(var p=0;p<l.length;p++)r[l][l.charAt(p)]=p}return r[l][a]}var d={compressToBase64:function(l){if(l==null)return"";var a=d._compress(l,6,function(p){return o.charAt(p)});switch(a.length%4){default:case 0:return a;case 1:return a+"===";case 2:return a+"==";case 3:return a+"="}},decompressFromBase64:function(l){return l==null?"":l==""?null:d._decompress(l.length,32,function(a){return u(o,l.charAt(a))})},compressToUTF16:function(l){return l==null?"":d._compress(l,15,function(a){return s(a+32)})+" "},decompressFromUTF16:function(l){return l==null?"":l==""?null:d._decompress(l.length,16384,function(a){return l.charCodeAt(a)-32})},compressToUint8Array:function(l){for(var a=d.compress(l),p=new Uint8Array(a.length*2),y=0,m=a.length;y<m;y++){var b=a.charCodeAt(y);p[y*2]=b>>>8,p[y*2+1]=b%256}return p},decompressFromUint8Array:function(l){if(l==null)return d.decompress(l);for(var a=new Array(l.length/2),p=0,y=a.length;p<y;p++)a[p]=l[p*2]*256+l[p*2+1];var m=[];return a.forEach(function(b){m.push(s(b))}),d.decompress(m.join(""))},compressToEncodedURIComponent:function(l){return l==null?"":d._compress(l,6,function(a){return c.charAt(a)})},decompressFromEncodedURIComponent:function(l){return l==null?"":l==""?null:(l=l.replace(/ /g,"+"),d._decompress(l.length,32,function(a){return u(c,l.charAt(a))}))},compress:function(l){return d._compress(l,16,function(a){return s(a)})},_compress:function(l,a,p){if(l==null)return"";var y,m,b={},f={},g="",v="",w="",_=2,S=3,k=2,T=[],C=0,I=0,E;for(E=0;E<l.length;E+=1)if(g=l.charAt(E),Object.prototype.hasOwnProperty.call(b,g)||(b[g]=S++,f[g]=!0),v=w+g,Object.prototype.hasOwnProperty.call(b,v))w=v;else{if(Object.prototype.hasOwnProperty.call(f,w)){if(w.charCodeAt(0)<256){for(y=0;y<k;y++)C=C<<1,I==a-1?(I=0,T.push(p(C)),C=0):I++;for(m=w.charCodeAt(0),y=0;y<8;y++)C=C<<1|m&1,I==a-1?(I=0,T.push(p(C)),C=0):I++,m=m>>1}else{for(m=1,y=0;y<k;y++)C=C<<1|m,I==a-1?(I=0,T.push(p(C)),C=0):I++,m=0;for(m=w.charCodeAt(0),y=0;y<16;y++)C=C<<1|m&1,I==a-1?(I=0,T.push(p(C)),C=0):I++,m=m>>1}_--,_==0&&(_=Math.pow(2,k),k++),delete f[w]}else for(m=b[w],y=0;y<k;y++)C=C<<1|m&1,I==a-1?(I=0,T.push(p(C)),C=0):I++,m=m>>1;_--,_==0&&(_=Math.pow(2,k),k++),b[v]=S++,w=String(g)}if(w!==""){if(Object.prototype.hasOwnProperty.call(f,w)){if(w.charCodeAt(0)<256){for(y=0;y<k;y++)C=C<<1,I==a-1?(I=0,T.push(p(C)),C=0):I++;for(m=w.charCodeAt(0),y=0;y<8;y++)C=C<<1|m&1,I==a-1?(I=0,T.push(p(C)),C=0):I++,m=m>>1}else{for(m=1,y=0;y<k;y++)C=C<<1|m,I==a-1?(I=0,T.push(p(C)),C=0):I++,m=0;for(m=w.charCodeAt(0),y=0;y<16;y++)C=C<<1|m&1,I==a-1?(I=0,T.push(p(C)),C=0):I++,m=m>>1}_--,_==0&&(_=Math.pow(2,k),k++),delete f[w]}else for(m=b[w],y=0;y<k;y++)C=C<<1|m&1,I==a-1?(I=0,T.push(p(C)),C=0):I++,m=m>>1;_--,_==0&&(_=Math.pow(2,k),k++)}for(m=2,y=0;y<k;y++)C=C<<1|m&1,I==a-1?(I=0,T.push(p(C)),C=0):I++,m=m>>1;for(;;)if(C=C<<1,I==a-1){T.push(p(C));break}else I++;return T.join("")},decompress:function(l){return l==null?"":l==""?null:d._decompress(l.length,32768,function(a){return l.charCodeAt(a)})},_decompress:function(l,a,p){var y=[],m,b=4,f=4,g=3,v="",w=[],_,S,k,T,C,I,E,L={val:p(0),position:a,index:1};for(_=0;_<3;_+=1)y[_]=_;for(k=0,C=Math.pow(2,2),I=1;I!=C;)T=L.val&L.position,L.position>>=1,L.position==0&&(L.position=a,L.val=p(L.index++)),k|=(T>0?1:0)*I,I<<=1;switch(m=k){case 0:for(k=0,C=Math.pow(2,8),I=1;I!=C;)T=L.val&L.position,L.position>>=1,L.position==0&&(L.position=a,L.val=p(L.index++)),k|=(T>0?1:0)*I,I<<=1;E=s(k);break;case 1:for(k=0,C=Math.pow(2,16),I=1;I!=C;)T=L.val&L.position,L.position>>=1,L.position==0&&(L.position=a,L.val=p(L.index++)),k|=(T>0?1:0)*I,I<<=1;E=s(k);break;case 2:return""}for(y[3]=E,S=E,w.push(E);;){if(L.index>l)return"";for(k=0,C=Math.pow(2,g),I=1;I!=C;)T=L.val&L.position,L.position>>=1,L.position==0&&(L.position=a,L.val=p(L.index++)),k|=(T>0?1:0)*I,I<<=1;switch(E=k){case 0:for(k=0,C=Math.pow(2,8),I=1;I!=C;)T=L.val&L.position,L.position>>=1,L.position==0&&(L.position=a,L.val=p(L.index++)),k|=(T>0?1:0)*I,I<<=1;y[f++]=s(k),E=f-1,b--;break;case 1:for(k=0,C=Math.pow(2,16),I=1;I!=C;)T=L.val&L.position,L.position>>=1,L.position==0&&(L.position=a,L.val=p(L.index++)),k|=(T>0?1:0)*I,I<<=1;y[f++]=s(k),E=f-1,b--;break;case 2:return w.join("")}if(b==0&&(b=Math.pow(2,g),g++),y[E])v=y[E];else if(E===f)v=S+S.charAt(0);else return null;w.push(v),y[f++]=S+v.charAt(0),b--,S=v,b==0&&(b=Math.pow(2,g),g++)}}};return d}();n!=null?n.exports=i:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return i})}(bn)),bn.exports}var ji=xa();const Ea="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20fill='none'%20viewBox='0%200%2084%2062'%3e%3crect%20width='64'%20height='48'%20x='18'%20y='2'%20fill='%23fff'%20stroke='%23999'%20stroke-width='3'%20rx='4'/%3e%3crect%20width='32'%20height='48'%20x='2'%20y='12'%20fill='%23fff'%20stroke='%23999'%20stroke-width='3'%20rx='4'/%3e%3cpath%20fill='%234169E1'%20d='M14%2052a4%204%200%201%201-8%200%204%204%200%200%201%208%200Zm64-42a4%204%200%201%201-8%200%204%204%200%200%201%208%200Z'/%3e%3c/svg%3e",Ra="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20fill='none'%20viewBox='0%200%2082%2062'%3e%3crect%20width='78'%20height='58'%20x='2'%20y='2'%20fill='%23999'%20fill-opacity='.3'%20stroke='%23999'%20stroke-width='3'%20rx='4'/%3e%3crect%20width='18'%20height='46'%20x='8'%20y='8'%20fill='%23fff'%20stroke='%23999'%20stroke-width='2'%20rx='1'/%3e%3crect%20width='18'%20height='46'%20x='32'%20y='8'%20fill='%23fff'%20stroke='%23999'%20stroke-width='2'%20rx='1'/%3e%3crect%20width='18'%20height='46'%20x='56'%20y='8'%20fill='%23fff'%20stroke='%23999'%20stroke-width='2'%20rx='1'/%3e%3c/svg%3e",La="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20fill='none'%20viewBox='0%200%2084%2062'%3e%3crect%20width='64'%20height='48'%20x='18'%20y='2'%20fill='%23fff'%20stroke='%23999'%20stroke-width='3'%20rx='4'/%3e%3cpath%20fill='%23999'%20fill-opacity='.3'%20d='M19%203h62v10H19z'/%3e%3cpath%20stroke='%234169E1'%20stroke-width='2'%20d='M43%208a2%202%200%201%201-4%200%202%202%200%200%201%204%200Z'/%3e%3cpath%20stroke='%23999'%20stroke-width='2'%20d='M52%208a2%202%200%201%201-4%200%202%202%200%200%201%204%200Zm9%200a2%202%200%201%201-4%200%202%202%200%200%201%204%200Z'/%3e%3crect%20width='32'%20height='48'%20x='2'%20y='12'%20fill='%23fff'%20stroke='%23999'%20stroke-width='3'%20rx='4'/%3e%3cpath%20fill='%23999'%20fill-opacity='.3'%20d='M3%2049h30v10H3z'/%3e%3cpath%20stroke='%234169E1'%20stroke-width='2'%20d='M11%2054a2%202%200%201%201-4%200%202%202%200%200%201%204%200Z'/%3e%3cpath%20stroke='%23999'%20stroke-width='2'%20d='M20%2054a2%202%200%201%201-4%200%202%202%200%200%201%204%200Zm9%200a2%202%200%201%201-4%200%202%202%200%200%201%204%200Z'/%3e%3c/svg%3e",Ma=200,$a=10;async function xn(){const{masto:n}=ce(),i=n.v1.followedTags.list({limit:Ma}),s=[];let o=0;do{const{value:c,done:r}=await i.next();if(r||(c==null?void 0:c.length)===0)break;s.push(...c),o++}while(o<$a);return s.sort((c,r)=>c.name.localeCompare(r.name)),s.length&&setTimeout(()=>{ye.account.set("followedTags",{tags:s,updatedAt:Date.now()})},1),s}const Na=24*60*60*1e3;async function Pa(){try{const{tags:n,updatedAt:i}=ye.account.get("followedTags")||{};return n!=null&&n.length?(Date.now()-i>Na&&xn(),n):await xn()}catch{return[]}}const Gi=document.createElement("div"),Da=n=>{if(!n)return[];if(n.indexOf("#")===-1)return[];Gi.innerHTML=n;const i=Gi.querySelectorAll("a.hashtag");return i.length?Array.from(i).map(s=>s.innerText.trim().replace(/^[^#]*#+/,"")):[]};function yn({children:n}){if(typeof n=="string")return n;const[i,s]=R("");return ie(()=>{Promise.resolve(n).then(s)},[n]),i}const _t=9,Oa=["following","mentions","notifications","list","public","trending","search","hashtag","bookmarks","favourites"],Ks={following:{id:"7ZJHdw"},notifications:{id:"iDNBZe"},list:{id:"h16FyT"},public:{id:"tXgQpk"},search:{id:"A1taO8"},"account-statuses":{id:"AeXO77"},bookmarks:{id:"7Ff7ia"},favourites:{id:"zZOZj7"},hashtag:{id:"GP8RLS"},trending:{id:"4/iCqx"},mentions:{id:"/bZzdR"}},vn={list:[{text:{id:"DUMt1y"},name:"id",notRequired:!0}],public:[{text:{id:"OgyJSr"},name:"local",type:"checkbox"},{text:{id:"kyAi7k"},name:"instance",type:"text",placeholder:{id:"7defFj"},notRequired:!0}],trending:[{text:{id:"kyAi7k"},name:"instance",type:"text",placeholder:{id:"7defFj"},notRequired:!0}],search:[{text:{id:"dmloPh"},name:"query",type:"text",placeholder:{id:"UHDQDE"},notRequired:!0}],"account-statuses":[{text:"@",name:"id",type:"text",placeholder:"cheeaun@mastodon.social"}],hashtag:[{text:"#",name:"hashtag",type:"text",placeholder:{id:"a6oTWs"},pattern:"[^#]+"},{text:{id:"eK4SL/"},name:"media",type:"checkbox"},{text:{id:"kyAi7k"},name:"instance",type:"text",placeholder:{id:"7defFj"},notRequired:!0}]},za=bt(async({id:n})=>{const i=await ce().masto.v1.accounts.$select(n).fetch();return i.username||i.acct||i.displayName}),En={following:{id:"home",title:(n,i)=>i===0?he._({id:"i0qMbr"}):he._({id:"following.title"}),path:"/",icon:"home"},mentions:{id:"mentions",title:{id:"/bZzdR"},path:"/mentions",icon:"at"},notifications:{id:"notifications",title:{id:"iDNBZe"},path:"/notifications",icon:"notification"},list:{id:({id:n})=>n?"list":"lists",title:({id:n})=>n?zc(n):he._({id:"h16FyT"}),path:({id:n})=>n?`/l/${n}`:"/l",icon:"list",excludeViewMode:({id:n})=>n?[]:["multi-column"]},public:{id:"public",title:({local:n})=>n?he._({id:"d5zxa4"}):he._({id:"4ERYY7"}),subtitle:({instance:n})=>n||ce().instance,path:({local:n,instance:i})=>`/${i}/p${n?"/l":""}`,icon:({local:n})=>n?"building":"earth"},trending:{id:"trending",title:{id:"4/iCqx"},subtitle:({instance:n})=>n||ce().instance,path:({instance:n})=>`/${n}/trending`,icon:"chart"},search:{id:"search",title:({query:n})=>n?`“${n}”`:he._({id:"A1taO8"}),path:({query:n})=>n?`/search?q=${encodeURIComponent(n)}&type=statuses`:"/search",icon:"search",excludeViewMode:({query:n})=>n?[]:["multi-column"]},"account-statuses":{id:"account-statuses",title:za,path:({id:n})=>`/a/${n}`,icon:"user"},bookmarks:{id:"bookmarks",title:{id:"7Ff7ia"},path:"/b",icon:"bookmark"},favourites:{id:"favourites",title:{id:"zZOZj7"},path:"/f",icon:"heart"},hashtag:{id:"hashtag",title:({hashtag:n})=>n,subtitle:({instance:n})=>n||ce().instance,path:({hashtag:n,instance:i,media:s})=>`${i?`/${i}`:""}/t/${n.split(/\s+/).join("+")}${s?"?media=1":""}`,icon:"hashtag"}};function Ua({onClose:n}){const{_:i}=de(),s=Ge(x),{shortcuts:o}=s,[c,r]=R(!1),[u,d]=R(!1),[l]=bi();return e("div",{id:"shortcuts-settings-container",class:"sheet",tabindex:"-1",children:[!!n&&e("button",{type:"button",class:"sheet-close",onClick:n,children:e(A,{icon:"x",alt:he._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:[e(A,{icon:"shortcut"})," ",e(h,{id:"CTqTgr"})," ",e("sup",{style:{fontSize:12,opacity:.5,textTransform:"uppercase"},children:e(h,{id:"A1As8l"})})]})}),e("main",{children:[e("p",{children:e(h,{id:"CIHAsy"})}),e("div",{class:"shortcuts-view-mode",children:[{value:"float-button",label:he._({id:"qwdOim"}),imgURL:Ea},{value:"tab-menu-bar",label:he._({id:"UxBoCm"}),imgURL:La},{value:"multi-column",label:he._({id:"uvDfdW"}),imgURL:Ra}].map(({value:a,label:p,imgURL:y})=>{const m=s.settings.shortcutsViewMode===a||a==="float-button"&&!s.settings.shortcutsViewMode;return e("label",{class:m?"checked":"",children:[e("input",{type:"radio",name:"shortcuts-view-mode",value:a,checked:m,onChange:b=>{x.settings.shortcutsViewMode=b.target.value}})," ",e("img",{src:y,alt:"",width:"80",height:"58"})," ",e("span",{children:p})]},a)})}),o.length>0?e(U,{children:[e("ol",{class:"shortcuts-list",ref:l,children:o.filter(Boolean).map((a,p)=>{const y=Object.values(a).join("-"),{type:m}=a;if(!En[m])return null;let{icon:b,title:f,subtitle:g,excludeViewMode:v}=En[m];typeof f=="function"?f=f(a,p):f=i(f),typeof g=="function"?g=g(a,p):g=i(g),typeof b=="function"&&(b=b(a,p)),typeof v=="function"&&(v=v(a,p));const w=v==null?void 0:v.includes(s.settings.shortcutsViewMode);return e("li",{children:[e(A,{icon:b}),e("span",{class:"shortcut-text",children:[e(yn,{children:f}),g&&e(U,{children:[" ",e("small",{class:"ib insignificant",children:g})]}),w&&e("span",{class:"tag",children:e(h,{id:"5KJFnN"})})]}),e("span",{class:"shortcut-actions",children:[e("button",{type:"button",class:"plain small",disabled:p===0,onClick:()=>{const _=Array.from(x.shortcuts);if(p>0){const S=x.shortcuts[p-1];_[p-1]=a,_[p]=S,x.shortcuts=_}},children:e(A,{icon:"arrow-up",alt:he._({id:"QyioBP"})})}),e("button",{type:"button",class:"plain small",disabled:p===o.length-1,onClick:()=>{const _=Array.from(x.shortcuts);if(p<x.shortcuts.length-1){const S=x.shortcuts[p+1];_[p+1]=a,_[p]=S,x.shortcuts=_}},children:e(A,{icon:"arrow-down",alt:he._({id:"3Ib6FN"})})}),e("button",{type:"button",class:"plain small",onClick:()=>{r({shortcut:a,shortcutIndex:p})},children:e(A,{icon:"pencil",alt:he._({id:"ePK91l"})})})]})]},y)})}),o.length===1&&s.settings.shortcutsViewMode!=="float-button"&&e("div",{class:"ui-state insignificant",children:[e(A,{icon:"info"})," ",e("small",{children:e(h,{id:"3Xq4Zi"})})]})]}):e("div",{class:"ui-state insignificant",children:[e("p",{children:s.settings.shortcutsViewMode==="multi-column"?he._({id:"3xIN+E"}):he._({id:"vLxvHT"})}),e("p",{children:e(h,{id:"Fq4zw3",components:{0:e("br",{}),1:e("a",{href:"#",onClick:a=>{a.preventDefault(),x.shortcuts=[{type:"following"},{type:"notifications"}]}})}})})]}),e("p",{class:"insignificant",children:o.length>=_t&&(s.settings.shortcutsViewMode==="multi-column"?he._({id:"RqXfsz",values:{SHORTCUTS_LIMIT:_t}}):he._({id:"EVRO/o",values:{SHORTCUTS_LIMIT:_t}}))}),e("p",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e("button",{type:"button",class:"light",onClick:()=>d(!0),children:e(h,{id:"bgVLbt"})}),e("button",{type:"button",disabled:o.length>=_t,onClick:()=>r(!0),children:[e(A,{icon:"plus"})," ",e("span",{children:s.settings.shortcutsViewMode==="multi-column"?he._({id:"Vh3ADI"}):he._({id:"9tmn6W"})})]})]})]}),c&&e(He,{onClick:a=>{a.target===a.currentTarget&&r(!1)},children:e(Ba,{shortcut:c.shortcut,shortcutIndex:c.shortcutIndex,onSubmit:({result:a,mode:p})=>{p==="edit"?x.shortcuts[c.shortcutIndex]=a:x.shortcuts.push(a)},onClose:()=>r(!1)})}),u&&e(He,{onClick:a=>{a.target===a.currentTarget&&d(!1)},children:e(Fa,{shortcuts:o,onClose:()=>d(!1)})})]})}const Ki={list:{id:"1qL+L+"},search:{id:"dmTmkQ"},hashtag:{id:"E8laYz"}};function Ba({onSubmit:n,disabled:i,shortcut:s,shortcutIndex:o,onClose:c}){var v,w;const{_:r}=de(),u=!!s,[d,l]=R((s==null?void 0:s.type)||null),[a,p]=R("default"),[y,m]=R([]),[b,f]=R([]);ie(()=>{(async()=>{if(d==="list")try{p("loading");const _=await ln();m(_),p("default")}catch{p("error")}})(),(async()=>{if(d==="hashtag")try{const _=await xn();f(_)}catch{}})()},[d]);const g=q();return ie(()=>{if(u&&d&&vn[d]){const _=g.current;vn[d].forEach(({name:S,type:k})=>{const T=_.querySelector(`[name="${S}"]`);T&&s[S]&&(k==="checkbox"?T.checked=s[S]==="on":T.value=s[S])})}},[u,d]),e("div",{id:"shortcut-settings-form",class:"sheet",children:[!!c&&e("button",{type:"button",class:"sheet-close",onClick:c,children:e(A,{icon:"x",alt:he._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:u?he._({id:"pe1jog"}):he._({id:"Lsxpe5"})})}),e("main",{tabindex:"-1",children:e("form",{ref:g,onSubmit:_=>{_.preventDefault();const S=new FormData(_.target),k={};S.forEach((T,C)=>{k[C]=T==null?void 0:T.trim(),C==="instance"&&(k[C]=k[C].replace(/^https?:\/\//,"").replace(/\/+$/,""),k[C]=k[C].replace(/^@?[^@]+@/,""))}),k.type&&(n({result:k,mode:u?"edit":"add"}),_.target.reset(),l(null),c==null||c())},children:[e("p",{children:e("label",{children:[e("span",{children:e(h,{id:"cklVjM"})}),e("select",{required:!0,disabled:i,onChange:_=>{l(_.target.value)},defaultValue:u?s.type:void 0,name:"type",dir:"auto",children:[e("option",{}),Oa.map(_=>e("option",{value:_,children:r(Ks[_])}))]})]})}),(w=(v=vn[d])==null?void 0:v.map)==null?void 0:w.call(v,({text:_,name:S,type:k,placeholder:T,pattern:C,notRequired:I})=>d==="list"?e("p",{children:e("label",{children:[e("span",{children:e(h,{id:"2BBAbc"})}),e("select",{name:"id",required:!I,disabled:i||a==="loading",defaultValue:u?s.id:void 0,dir:"auto",children:[e("option",{value:""}),y.map(E=>e("option",{value:E.id,children:E.title}))]})]})}):e("p",{children:e("label",{children:[e("span",{children:r(_)})," ",e("input",{type:k,switch:k==="checkbox"||void 0,name:S,placeholder:r(T),required:k==="text"&&!I,disabled:i,list:d==="hashtag"?"followed-hashtags-datalist":null,autocorrect:"off",autocapitalize:"off",spellCheck:!1,pattern:C,dir:"auto"}),d==="hashtag"&&b.length>0&&e("datalist",{id:"followed-hashtags-datalist",children:b.map(E=>e("option",{value:E.name}))})]})})),!!Ki[d]&&e("p",{class:"form-note insignificant",children:[e(A,{icon:"info"}),r(Ki[d])]}),e("footer",{children:[e("button",{type:"submit",class:"block",disabled:i||a==="loading",children:u?he._({id:"tfDRzk"}):he._({id:"m16xKo"})}),u&&e("button",{type:"button",class:"light danger",onClick:()=>{x.shortcuts.splice(o,1),c==null||c()},children:e(h,{id:"t/YqKh"})})]})]})})]})}function Fa({shortcuts:n,onClose:i}){var m;const{_:s}=de(),{masto:o}=ce(),c=_e(()=>!n||!n.filter(Boolean).length?"":ji.compressToEncodedURIComponent(JSON.stringify(n.filter(Boolean))),[n]),[r,u]=R(""),[d,l]=R("default"),a=_e(()=>{if(!r)return l("default"),null;try{const b=JSON.parse(ji.decompressFromEncodedURIComponent(r));if(!Array.isArray(b))throw new Error("Not an array");return l("default"),b}catch{try{const f=JSON.parse(r);if(!Array.isArray(f))throw new Error("Not an array");return l("default"),f}catch{return l("error"),null}}},[r]),p=x.shortcuts.length>0,y=q();return e("div",{id:"import-export-container",class:"sheet",children:[!!i&&e("button",{type:"button",class:"sheet-close",onClick:i,children:e(A,{icon:"x",alt:he._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(h,{id:"OOa7/5",components:{0:e("small",{class:"ib insignificant"})}})})}),e("main",{tabindex:"-1",children:[e("section",{children:[e("h3",{children:[e(A,{icon:"arrow-down-circle",size:"l",class:"insignificant"})," ",e("span",{children:e(h,{id:"l3s5ri"})})]}),e("p",{class:"field-button",children:[e("input",{ref:y,type:"text",name:"import",placeholder:he._({id:"tBmklN"}),class:"block",onInput:b=>{u(b.target.value)},dir:"auto"}),x.settings.shortcutSettingsCloudImportExport&&e("button",{type:"button",class:"plain2 small",disabled:d==="cloud-downloading",onClick:async()=>{l("cloud-downloading");const b=wt();pe(he._({id:"HLqLGx"}));try{const g=(await o.v1.accounts.relationships.fetch({id:[b]}))[0];if(g){const{note:v=""}=g;if(/<phanpy-shortcuts-settings>(.*)<\/phanpy-shortcuts-settings>/.test(v)){const w=v.match(/<phanpy-shortcuts-settings>(.*)<\/phanpy-shortcuts-settings>/)[1],{v:_,dt:S,data:k}=JSON.parse(w);y.current.value=k,y.current.dispatchEvent(new Event("input"))}}l("default")}catch{l("error"),pe(he._({id:"gCDfX+"}))}},title:he._({id:"B6cG3J"}),children:[e(A,{icon:"cloud"}),e(A,{icon:"arrow-down"})]})]}),!!a&&Array.isArray(a)&&e(U,{children:[e("p",{children:[e("b",{children:a.length})," shortcut",a.length>1?"s":""," ",e("small",{class:"insignificant",children:["(",r.length," characters)"]})]}),e("ol",{class:"import-settings-list",children:a.map(b=>{var f,g;return e("li",{children:[e("span",{style:{opacity:n.some(v=>Object.keys(v).every(w=>v[w]===b[w]))?1:0},children:"*"}),e("span",{children:[s(Ks[b.type]),b.type==="list"&&" ⚠️"," ",(g=(f=vn[b.type])==null?void 0:f.map)==null?void 0:g.call(f,({text:v,name:w,type:_})=>b[w]?e(U,{children:[e("span",{class:"tag collapsed insignificant",children:[v,":"," ",_==="checkbox"?b[w]==="on"?"✅":"❌":b[w]]})," "]}):null)]})]})})}),e("p",{children:[e("small",{children:e(h,{id:"o6sElH"})}),e("br",{}),e("small",{children:["⚠️"," ",e(h,{id:"N4z4P/"})]})]})]}),d==="error"&&e("p",{class:"error",children:e("small",{children:["⚠️ ",e(h,{id:"ZhsPEb"})]})}),e("p",{children:[p&&e(U,{children:[e(ht,{confirmLabel:he._({id:"6MzUUU"}),menuFooter:e("div",{class:"footer",children:e(h,{id:"nl8sCE"})}),onClick:()=>{const b=a.filter(v=>!x.shortcuts.some(w=>Object.keys(w).every(_=>w[_]===v[_])));if(!b.length){pe(he._({id:"o6L30P"}));return}let f=[...x.shortcuts,...b];const g=f.length>_t;g&&(f=f.slice(0,_t)),x.shortcuts=f,pe(g?he._({id:"SBmqmC",values:{SHORTCUTS_LIMIT:_t}}):he._({id:"QO9uTx"})),i==null||i()},children:e("button",{type:"button",class:"plain2",disabled:!a,children:e(h,{id:"c89gCv"})})})," "]}),e(ht,{confirmLabel:p?he._({id:"6ZjzWP"}):he._({id:"DWumLi"}),menuItemClassName:p?"danger":void 0,onClick:()=>{x.shortcuts=a,pe(he._({id:"QO9uTx"})),i==null||i()},children:e("button",{type:"button",class:"plain2",disabled:!a,children:p?he._({id:"uIp8WL"}):he._({id:"Sjnlwj"})})})]})]}),e("section",{children:[e("h3",{children:[e(A,{icon:"arrow-up-circle",size:"l",class:"insignificant"})," ",e("span",{children:e(h,{id:"GS+Mus"})})]}),e("p",{children:e("input",{style:{width:"100%"},type:"text",value:c,readOnly:!0,onClick:b=>{if(b.target.value){b.target.select();try{navigator.clipboard.writeText(b.target.value),pe(he._({id:"cWtH+v"}))}catch{pe(he._({id:"yUWyHa"}))}}},dir:"auto"})}),e("p",{children:[e("button",{type:"button",class:"plain2",disabled:!c,onClick:()=>{try{navigator.clipboard.writeText(c),pe(he._({id:"+Kq2vY"}))}catch{pe(he._({id:"tFvxZF"}))}},children:[e(A,{icon:"clipboard"})," ",e("span",{children:e(h,{id:"he3ygx"})})]})," ",(navigator==null?void 0:navigator.share)&&((m=navigator==null?void 0:navigator.canShare)==null?void 0:m.call(navigator,{text:c}))&&e("button",{type:"button",class:"plain2",disabled:!c,onClick:()=>{try{navigator.share({text:c})}catch{alert(he._({id:"TtG3Uh"}))}},children:[e(A,{icon:"share"})," ",e("span",{children:e(h,{id:"Z8lGw6"})})]})," ",x.settings.shortcutSettingsCloudImportExport&&e("button",{type:"button",class:"plain2",disabled:d==="cloud-uploading",onClick:async()=>{l("cloud-uploading");const b=wt();try{const g=(await o.v1.accounts.relationships.fetch({id:[b]}))[0];if(g){const{note:v=""}=g;let w="";const _=JSON.stringify({v:"1",dt:Date.now(),data:c});/<phanpy-shortcuts-settings>(.*)<\/phanpy-shortcuts-settings>/.test(v)?w=v.replace(/<phanpy-shortcuts-settings>(.*)<\/phanpy-shortcuts-settings>/,`<phanpy-shortcuts-settings>${_}</phanpy-shortcuts-settings>`):w=`${v}


<phanpy-shortcuts-settings>${_}</phanpy-shortcuts-settings>`,pe(he._({id:"9ZYiLz"})),await o.v1.accounts.$select(b).note.create({comment:w}),l("default"),pe(he._({id:"5w02SH"}))}}catch{l("error"),pe(he._({id:"aVsTYo"}))}},title:he._({id:"gWd6Cu"}),children:[e(A,{icon:"cloud"}),e(A,{icon:"arrow-up"})]})," ",c.length>0&&e("small",{class:"insignificant ib",children:e(h,{id:"IPXOXm",values:{0:c.length}})})]}),!!c&&e("details",{children:[e("summary",{class:"insignificant",children:e("small",{children:e(h,{id:"e5E+WH"})})}),e("textarea",{style:{width:"100%"},rows:10,readOnly:!0,children:JSON.stringify(n.filter(Boolean),null,2)})]})]}),x.settings.shortcutSettingsCloudImportExport&&e("footer",{children:e("p",{children:[e(A,{icon:"cloud"})," ",e(h,{id:"C4T6O/"})]})})]})]})}gs(x,n=>{for(const[i,s,o,c]of n)/^show/i.test(s)&&!o&&Qn()});function Ha(){var c,r,u,d,l,a,p,y;const{_:n}=de(),i=Ge(x),s=bs(),o=Wt();return ie(()=>{setTimeout(ko,1e3)},[]),e(U,{children:[!!i.showCompose&&e(He,{class:`solid ${i.composerState.minimized?"min":""}`,minimized:!!i.composerState.minimized,children:e(So,{replyToStatus:typeof i.showCompose!="boolean"?i.showCompose.replyToStatus:((c=window.__COMPOSE__)==null?void 0:c.replyToStatus)||null,editStatus:((r=x.showCompose)==null?void 0:r.editStatus)||((u=window.__COMPOSE__)==null?void 0:u.editStatus)||null,draftStatus:((d=x.showCompose)==null?void 0:d.draftStatus)||((l=window.__COMPOSE__)==null?void 0:l.draftStatus)||null,onClose:m=>{const{newStatus:b,instance:f,type:g,scheduledAt:v}=m||{};x.showCompose=!1,window.__COMPOSE__=null,b&&(x.reloadStatusPage++,v&&x.reloadScheduledPosts++,pe({text:{post:n(v?{id:"IrX0sj"}:{id:"aTyHBW"}),reply:n(v?{id:"+38pse"}:{id:"lZdBKl"}),edit:n({id:"a5BN7l"})}[g||"post"],delay:1e3,duration:1e4,onClick:w=>{w.hideToast(),x.prevLocation=o,s(v?"/sp":f?`/${f}/s/${b.id}`:`/s/${b.id}`)}}))}})}),!!i.showSettings&&e(He,{onClose:()=>{x.showSettings=!1},children:e(Nc,{onClose:()=>{x.showSettings=!1}})}),!!i.showAccounts&&e(He,{onClose:()=>{x.showAccounts=!1},children:e(kc,{onClose:()=>{x.showAccounts=!1}})}),!!i.showAccount&&e(He,{onClose:()=>{x.showAccount=!1},children:e(sa,{account:((a=i.showAccount)==null?void 0:a.account)||i.showAccount,instance:(p=i.showAccount)==null?void 0:p.instance,onClose:({destination:m}={})=>{x.showAccount=!1}})}),!!i.showDrafts&&e(He,{onClose:()=>{x.showDrafts=!1},children:e(oa,{onClose:()=>x.showDrafts=!1})}),!!i.showMediaModal&&e(He,{onClick:m=>{(m.target===m.currentTarget||m.target.classList.contains("media"))&&(x.showMediaModal=!1)},children:e(Gs,{mediaAttachments:i.showMediaModal.mediaAttachments,instance:i.showMediaModal.instance,index:i.showMediaModal.index,statusID:i.showMediaModal.statusID,onClose:()=>{x.showMediaModal=!1}})}),!!i.showShortcutsSettings&&e(He,{onClose:()=>{x.showShortcutsSettings=!1},children:e(Ua,{onClose:()=>x.showShortcutsSettings=!1})}),!!i.showGenericAccounts&&e(He,{onClose:()=>{x.showGenericAccounts=!1},children:e(ra,{instance:i.showGenericAccounts.instance,excludeRelationshipAttrs:i.showGenericAccounts.excludeRelationshipAttrs,postID:i.showGenericAccounts.postID,onClose:()=>x.showGenericAccounts=!1,blankCopy:i.showGenericAccounts.blankCopy})}),!!i.showMediaAlt&&e(He,{onClose:m=>{x.showMediaAlt=!1},children:e(la,{alt:i.showMediaAlt.alt||i.showMediaAlt,lang:(y=i.showMediaAlt)==null?void 0:y.lang,onClose:()=>{x.showMediaAlt=!1}})}),!!i.showEmbedModal&&e(He,{class:"solid",onClose:()=>{x.showEmbedModal=!1},children:e(aa,{html:i.showEmbedModal.html,url:i.showEmbedModal.url,width:i.showEmbedModal.width,height:i.showEmbedModal.height,onClose:()=>{x.showEmbedModal=!1}})}),!!i.showReportModal&&e(He,{onClose:()=>{x.showReportModal=!1},children:e(Ta,{account:i.showReportModal.account,post:i.showReportModal.post,onClose:()=>{x.showReportModal=!1}})})]})}function ti({accountID:n,onChange:i}){const{_:s}=de(),{masto:o}=ce(),[c,r]=R("default"),[u,d]=R(null),[l,a]=R(null),p=l!==null;return e("p",{class:"follow-request-buttons",children:[e("button",{type:"button",disabled:c==="loading"||p,onClick:()=>{r("loading"),d("accept"),(async()=>{try{const y=await o.v1.followRequests.$select(n).authorize();if(!(y!=null&&y.followedBy))throw new Error("Follow request not accepted");a(y),i()}catch{}r("default")})()},children:e(h,{id:"g3UF2V"})})," ",e("button",{type:"button",disabled:c==="loading"||p,class:"light danger",onClick:()=>{r("loading"),d("reject"),(async()=>{try{const y=await o.v1.followRequests.$select(n).reject();if(y!=null&&y.followedBy)throw new Error("Follow request not rejected");a(y),i()}catch{r("default")}})()},children:e(h,{id:"1t/NnN"})}),e("span",{class:"follow-request-states",children:p&&u?u==="accept"?e(A,{icon:"check-circle",alt:s({id:"bzMKg7"}),class:"follow-accepted"}):e(A,{icon:"x-circle",alt:s({id:"ekCRTP"}),class:"follow-rejected"}):e(Ue,{hidden:c!=="loading"})})]})}const Vi={mention:"comment",status:"notification",reblog:"rocket",follow:"follow",follow_request:"follow-add",favourite:"heart",poll:"poll",update:"pencil","admin.signup":"account-edit","admin.report":"account-warning",severed_relationships:"heart-break",moderation_warning:"alert",emoji_reaction:"emoji2","pleroma:emoji_reaction":"emoji2",annual_report:"celebrate"};function Wi({account:n,emoji:i,emoji_url:s}){let o,c;typeof s=="string"?o=s:(o=s==null?void 0:s.url,c=s==null?void 0:s.staticUrl);const r=o?e(Ho,{url:o,staticUrl:c,alt:i}):i;return e(h,{id:"i5uN6K",values:{account:n,emojiObject:r}})}const jn={status:({account:n})=>e(h,{id:"idiIxW",values:{account:n}}),reblog:({count:n,account:i,postsCount:s,postType:o,components:{Subject:c}})=>e(h,{id:"jkt9P5",values:{0:Je(n),1:Je(n),count:n,postsCount:s,postType:o,account:i},components:{0:e(c,{clickable:n>1}),1:e("span",{title:n}),2:e(c,{clickable:n>1}),3:e("span",{title:n})}}),follow:({account:n,count:i,components:{Subject:s}})=>e(h,{id:"+71G9C",values:{0:Je(i),count:i,account:n},components:{0:e(s,{clickable:i>1}),1:e("span",{title:i})}}),follow_request:({account:n})=>e(h,{id:"eh6NHW",values:{account:n}}),favourite:({account:n,count:i,postsCount:s,postType:o,components:{Subject:c}})=>e(h,{id:"RqX1mR",values:{0:Je(i),1:Je(i),count:i,postsCount:s,postType:o,account:n},components:{0:e(c,{clickable:i>1}),1:e("span",{title:i}),2:e(c,{clickable:i>1}),3:e("span",{title:i})}}),poll:()=>he._({id:"kIlJaS"}),"poll-self":()=>he._({id:"kpjzdN"}),"poll-voted":()=>he._({id:"moT7M8"}),update:()=>he._({id:"uzt17m"}),"favourite+reblog":({count:n,account:i,postsCount:s,postType:o,components:{Subject:c}})=>e(h,{id:"NunZZQ",values:{0:Je(n),1:Je(n),count:n,postsCount:s,postType:o,account:i},components:{0:e(c,{clickable:n>1}),1:e("span",{title:n}),2:e(c,{clickable:n>1}),3:e("span",{title:n})}}),"admin.sign_up":({account:n})=>e(h,{id:"fJCCpx",values:{account:n}}),"admin.report":({account:n,targetAccount:i})=>e(h,{id:"eNfCmq",values:{account:n,targetAccount:i}}),severed_relationships:({name:n})=>e(h,{id:"Xl9v6+",values:{name:n},components:{0:e("i",{})}}),moderation_warning:()=>e("b",{children:e(h,{id:"YqffEv"})}),emoji_reaction:Wi,"pleroma:emoji_reaction":Wi,annual_report:({year:n})=>e(h,{id:"INLTzH",values:{year:n}})},Ya={account_suspension:({from:n,targetName:i})=>e(h,{id:"uRkcgw",values:{from:n,targetName:i},components:{0:e("i",{}),1:e("i",{})}}),domain_block:({from:n,targetName:i,followersCount:s,followingCount:o})=>e(h,{id:"Q3yArs",values:{from:n,targetName:i,followersCount:s,followingCount:o},components:{0:e("i",{}),1:e("i",{})}}),user_domain_block:({targetName:n,followersCount:i,followingCount:s})=>e(h,{id:"RQKWUa",values:{targetName:n,followersCount:i,followingCount:s},components:{0:e("i",{})}})},qa={none:{id:"ipnHrn"},disable:{id:"jw0eSZ"},mark_statuses_as_sensitive:{id:"v9jO+F"},delete_statuses:{id:"raUMBQ"},sensitive:{id:"w2OpMr"},silence:{id:"mlycBx"},suspend:{id:"Fz4lZ1"}},Gn=30;function ja({notification:n,instance:i,isStatic:s,disableContextMenu:o}){var F,G,re,H,se,be,we;const{_:c}=de(),{masto:r}=ce(),{id:u,status:d,account:l,report:a,event:p,moderation_warning:y,annualReport:m,_ids:b,_accounts:f,_statuses:g,_groupKeys:v,sampleAccounts:w,notificationsCount:_,groupKey:S}=n;let{type:k}=n;if(k==="mention"&&!d)return null;const T=(d==null?void 0:d.reblog)||d,C=T==null?void 0:T.id,I=wt(),E=I===(l==null?void 0:l.id),L=(F=d==null?void 0:d.poll)==null?void 0:F.voted,B=!!(d!=null&&d.inReplyToAccountId)&&(d==null?void 0:d.inReplyToAccountId)!==I&&((G=d==null?void 0:d.account)==null?void 0:G.id)===I;let P=0,Y=0;if(k==="favourite+reblog"){if(f)for(const Z of f)(re=Z._types)!=null&&re.includes("favourite")&&P++,(H=Z._types)!=null&&H.includes("reblog")&&Y++;!Y&&P&&(k="favourite"),!P&&Y&&(k="reblog")}let Q;k==="poll"?Q=jn[E?"poll-self":L?"poll-voted":"poll"]:jn[k]?Q=jn[k]:Q=he._({id:"ODqZt1",values:{type:k}});const te=({clickable:Z,...le})=>Z?e("b",{tabIndex:"0",onClick:z,...le}):e("b",{...le});if(typeof Q=="function"){const Z=(f==null?void 0:f.length)||(w==null?void 0:w.length)||(l?1:0),le=(g==null?void 0:g.length)||(d?1:0);if(k==="admin.report"){const Re=a==null?void 0:a.targetAccount;Re&&(Q=Q({account:e(gt,{account:l,showAvatar:!0}),targetAccount:e(gt,{account:Re,showAvatar:!0})}))}else if(k==="severed_relationships"){const Re=p==null?void 0:p.targetName;Re&&(Q=Q({name:Re}))}else if((k==="emoji_reaction"||k==="pleroma:emoji_reaction")&&n.emoji){const Re=n.emoji_url||((be=(se=d==null?void 0:d.emojis)==null?void 0:se.find)==null?void 0:be.call(se,$e=>($e==null?void 0:$e.shortcode)===n.emoji.replace(/^:/,"").replace(/:$/,"")));Q=Q({account:e(gt,{account:l,showAvatar:!0}),emoji:n.emoji,emojiURL:Re})}else k==="annual_report"?Q=Q({...n.annualReport}):Q=Q({account:l?e(gt,{account:l,showAvatar:!0}):(w==null?void 0:w[0])&&e(gt,{account:w[0],showAvatar:!0}),count:Z,postsCount:le,postType:B?"reply":"post",components:{Subject:te}})}const J=n.createdAt&&new Date(n.createdAt).toLocaleString(),V={"favourite+reblog":he._({id:"+XOeb+"}),favourite:he._({id:"LQFF6J"}),reblog:he._({id:"phQpSa"}),follow:he._({id:"Ih01jh"})}[k]||he._({id:"bPwFdf"}),z=()=>{x.showGenericAccounts={heading:V,accounts:f,showReactions:k==="favourite+reblog",excludeRelationshipAttrs:k==="follow"?["followedBy"]:[],postID:rt(C,i)}},M=_>0&&_>(w==null?void 0:w.length)?"remote":"local";if(d!=null&&d.filtered){const Z=((we=d==null?void 0:d.account)==null?void 0:we.id)===I,le=qt(d.filtered,"notifications");if(!E&&!Z&&(le==null?void 0:le.action)==="hide")return null}return e("div",{class:`notification notification-${k}`,"data-notification-id":b||u,"data-group-key":(v==null?void 0:v.join(" "))||S,tabIndex:"0",children:[e("div",{class:`notification-type notification-${k}`,title:J,children:k==="favourite+reblog"?e(U,{children:[e(A,{icon:"rocket",size:"xl",alt:k,class:"reblog-icon"}),e(A,{icon:"heart",size:"xl",alt:k,class:"favourite-icon"})]}):e(A,{icon:Vi[k]||"notification",size:"xl",alt:k})}),e("div",{class:"notification-content",children:[k!=="mention"&&e(U,{children:[e("p",{children:Q}),k==="follow_request"&&e(ti,{accountID:l.id}),k==="severed_relationships"&&e("div",{children:[Ya[p.type]({from:i,...p}),e("br",{}),e("a",{href:`https://${i}/severed_relationships`,target:"_blank",rel:"noopener",children:e(h,{id:"YL6Y8P",components:{0:e(A,{icon:"external",size:"s"})}})}),"."]}),k==="moderation_warning"&&!!y&&e("div",{children:[c(qa[y.action]()),e("br",{}),e("a",{href:`/disputes/strikes/${y.id}`,target:"_blank",rel:"noopener",children:e(h,{id:"YL6Y8P",components:{0:e(A,{icon:"external",size:"s"})}})})]}),k==="annual_report"&&e("div",{children:e(ge,{to:`/annual_report/${m==null?void 0:m.year}`,children:e(h,{id:"5PGPvG"})})})]}),(f==null?void 0:f.length)>1&&e("p",{class:"avatars-stack",children:[f.slice(0,Gn).map(Z=>e(U,{children:[e("a",{href:Z.url,rel:"noopener",class:"account-avatar-stack",onClick:le=>{le.preventDefault(),x.showAccount=Z},children:[e(pt,{url:Z.avatarStatic,size:f.length<=10?"xxl":f.length<20?"xl":"l",alt:`${Z.displayName} @${Z.acct}`,squircle:Z==null?void 0:Z.bot},Z.id),k==="favourite+reblog"&&e("div",{class:"account-sub-icons",children:Z._types.map(le=>e(A,{icon:Vi[le],size:"s",class:`${le}-icon`}))})]},Z.id)," "]},Z.id)),k==="favourite+reblog"&&M==="remote"?e("button",{type:"button",class:"small plain","data-group-keys":v==null?void 0:v.join(" "),onClick:()=>{x.showGenericAccounts={heading:V,fetchAccounts:async()=>{const Z=await Promise.allSettled(v.map(async Re=>{const $e=r.v2.notifications.$select(Re).accounts.list();return[Re,(await $e.next()).value]})),le=[];for(const Re of Z){const[$e,De]=Re.value,ze=/^favourite/.test($e)?"favourite":/^reblog/.test($e)?"reblog":null;if(ze)for(const Le of De){const Te=le.find(X=>X.id===Le.id);Te?Te._types.push(ze):(Le._types=[ze],le.push(Le))}}return{done:!0,value:le}},showReactions:!0,postID:rt(C,i)}},children:e(A,{icon:"chevron-down"})}):e("button",{type:"button",class:"small plain",onClick:z,children:[f.length>Gn&&`+${f.length-Gn}`,e(A,{icon:"chevron-down"})]})]}),!(f!=null&&f.length)&&(w==null?void 0:w.length)>1&&e("p",{class:"avatars-stack",children:[w.map(Z=>e(U,{children:[e("a",{href:Z.url,rel:"noopener",class:"account-avatar-stack",onClick:le=>{le.preventDefault(),x.showAccount=Z},children:e(pt,{url:Z.avatarStatic,size:"xxl",alt:`${Z.displayName} @${Z.acct}`,squircle:Z==null?void 0:Z.bot},Z.id)},Z.id)," "]},Z.id)),_>w.length&&e(ge,{to:i?`/${i}/s/${d.id}`:`/s/${d.id}`,class:"button small plain centered",children:["+",_-w.length,e(A,{icon:"chevron-right"})]})]}),(g==null?void 0:g.length)>1&&e("ul",{class:"notification-group-statuses",children:g.map(Z=>e("li",{children:e(Zi,{class:`status-link status-type-${k}`,to:i?`/${i}/s/${Z.id}`:`/s/${Z.id}`,children:e(qe,{status:Z,size:"s",previewMode:!0,allowContextMenu:!0,allowFilters:!0})})},Z.id))}),d&&(!(g!=null&&g.length)||(g==null?void 0:g.length)<=1)&&e(Zi,{class:`status-link status-type-${k}`,to:i?`/${i}/s/${C}`:`/s/${C}`,onContextMenu:o?void 0:Z=>{const le=Z.target.querySelector(".status");if(le){if(Z.metaKey)return;Z.preventDefault(),le.dispatchEvent(new MouseEvent("contextmenu",{clientX:Z.clientX,clientY:Z.clientY}))}},children:s?e(qe,{status:T,size:"s",readOnly:!0,allowContextMenu:!0,allowFilters:!0}):e(qe,{statusID:C,size:"s",readOnly:!0,allowContextMenu:!0,allowFilters:!0})})]})]})}function Zi(n){const i=Yo();return e(ge,{...n,"data-read-more":he._({id:"8fZueG"}),ref:i})}const cn=dt(ja,(n,i)=>{var s,o;return((s=n.notification)==null?void 0:s.id)===((o=i.notification)==null?void 0:o.id)});"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",n=>{const{type:i,id:s,accessToken:o}=(n==null?void 0:n.data)||{};i==="notification"&&(x.routeNotification={id:s,accessToken:o})});const Ga=dt(function(){const{_:i}=de();if(!("serviceWorker"in navigator))return null;const s=Ge(x),{routeNotification:o}=s,{id:c,accessToken:r}=o||{},[u,d]=R(!1);kt(()=>{if(!c||!r)return;const{instance:a}=ce(),{masto:p,instance:y}=ce({accessToken:r}),m=a===y,b=r?_o(r):ci();(async()=>{const f=await p.v1.notifications.$select(c).fetch();if(f&&b){const g=b.instanceURL,{type:v,status:w,account:_}=f,S=!!document.querySelector("#modal-container > *"),k=v==="follow"&&!!(_!=null&&_.id),T=!!(_!=null&&_.id),C=!!(w!=null&&w.id);k&&m?x.showAccount={account:_,instance:g}:S||!m||T&&C?d({id:c,account:b,notification:f,sameInstance:m}):C?location.hash=`/${a}/s/${w.id}`:k?location.hash=`/${a}/a/${_.id}`:location.hash="/notifications"}})()},[c,r]),kt(()=>{navigator!=null&&navigator.clearAppBadge&&navigator.clearAppBadge()},[]),jt(a=>{a&&(navigator!=null&&navigator.clearAppBadge)&&navigator.clearAppBadge()});const l=()=>{d(!1),x.routeNotification=null,/\/notifications\?id=/i.test(location.hash)&&(location.hash="/notifications")};if(u){const{id:a,account:p,notification:y,sameInstance:m}=u;return e(He,{onClick:b=>{b.target===b.currentTarget&&l()},children:e("div",{class:"sheet",tabIndex:"-1",children:[e("button",{type:"button",class:"sheet-close",onClick:l,children:e(A,{icon:"x",alt:i({id:"yz7wBu"})})}),e("header",{children:e("b",{children:e(h,{id:"5+87Pq"})})}),e("main",{children:[!m&&e("p",{children:e(h,{id:"k9N0Xk"})}),e("div",{class:"notification-peek",onClick:b=>{const{target:f}=b;(b.target.tagName==="BUTTON"||b.target.tagName==="A")&&l()},children:e(cn,{instance:p.instanceURL,notification:y,isStatic:!0})}),e("div",{style:{textAlign:"end"},children:e(ge,{to:"/notifications",class:"button light",onClick:l,children:[e("span",{children:e(h,{id:"/WA/tl"})})," ",e(A,{icon:"arrow-right"})]})})]})]})})}return null}),Vs=Co((n,i)=>{const{_:s}=de(),{instance:o}=ce(),[c,r]=yt(),[u,d]=R(!1),[l,a]=R(c.get("q")||""),p=c.get("type"),y=q(null),m=q(null);return Io(i,()=>({setValue:b=>{a(b)},focus:()=>{m.current.focus()},select:()=>{m.current.select()},blur:()=>{m.current.blur()}})),e("form",{ref:y,class:"search-popover-container",onSubmit:b=>{var g;if(b.preventDefault(),/\/search/.test(location.hash))if(l){const v={q:l};p&&(v.type=p),r(v)}else r({});else l?location.hash=`/search?q=${encodeURIComponent(l)}${p?`&type=${p}`:""}`:location.hash="/search";(g=n==null?void 0:n.onSubmit)==null||g.call(n,b)},children:[e("input",{ref:m,value:l,name:"q",type:"search",placeholder:s({id:"A1taO8"}),dir:"auto",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellCheck:"false",onSearch:b=>{b.target.value||r({})},onInput:b=>{a(b.target.value),d(!0)},onFocus:()=>{var b,f;d(!0),(f=(b=y.current)==null?void 0:b.querySelector(".search-popover-item"))==null||f.classList.add("focus")},onBlur:()=>{var b,f;setTimeout(()=>{d(!1)},100),(f=(b=y.current)==null?void 0:b.querySelector(".search-popover-item.focus"))==null||f.classList.remove("focus")},onKeyDown:b=>{var g;const{key:f}=b;switch(f){case"Escape":d(!1);break;case"Down":case"ArrowDown":if(b.preventDefault(),u){const v=y.current.querySelector(".search-popover-item.focus");if(v){let w=v.nextElementSibling;for(;w&&w.hidden;)w=w.nextElementSibling;w&&(w.classList.add("focus"),Array.from(w.parentElement.children).filter(S=>S!==w).forEach(S=>{S.classList.remove("focus")}))}else{const w=y.current.querySelector(".search-popover-item");w&&w.classList.add("focus")}}break;case"Up":case"ArrowUp":if(b.preventDefault(),u){const v=document.querySelector(".search-popover-item.focus");if(v){let w=v.previousElementSibling;for(;w&&w.hidden;)w=w.previousElementSibling;w&&(w.classList.add("focus"),Array.from(w.parentElement.children).filter(S=>S!==w).forEach(S=>{S.classList.remove("focus")}))}else{const w=document.querySelector(".search-popover-item:last-child");w&&w.classList.add("focus")}}break;case"Enter":if(u){const v=document.querySelector(".search-popover-item.focus");v&&(b.preventDefault(),v.click()),d(!1),(g=n==null?void 0:n.onSubmit)==null||g.call(n,b)}break}}}),e("div",{class:"search-popover",hidden:!u||!l,children:!!l&&[{label:e(h,{id:"48oDit",values:{query:l},components:{0:e("small",{class:"insignificant"})}}),to:`/search?q=${encodeURIComponent(l)}`,top:!p&&!/\s/.test(l),hidden:!!p},{label:e(h,{id:"o1mMWT",values:{query:l},components:{0:e("q",{})}}),to:`/search?q=${encodeURIComponent(l)}&type=statuses`,hidden:/^https?:/.test(l),top:/\s/.test(l),icon:"document",queryType:"statuses"},{label:e(h,{id:"YAZw8D",values:{0:l.replace(/^#/,"")},components:{0:e("mark",{})}}),to:`/${o}/t/${l.replace(/^#/,"")}`,hidden:/^@/.test(l)||/^https?:/.test(l)||/\s/.test(l),top:/^#/.test(l),type:"link",icon:"hashtag",queryType:"hashtags"},{label:e(h,{id:"gEoOUj",values:{query:l},components:{0:e("mark",{})}}),to:`/${l}`,hidden:!/^https?:/.test(l),top:/^https?:/.test(l),type:"link"},{label:e(h,{id:"cDoNQr",values:{query:l},components:{0:e("q",{})}}),to:`/search?q=${encodeURIComponent(l)}&type=accounts`,icon:"group",queryType:"accounts"}].sort((b,f)=>{if(p){if(b.queryType===p)return-1;if(f.queryType===p)return 1}return b.top&&!f.top?-1:!b.top&&f.top?1:0}).filter(({hidden:b})=>!b).map(({label:b,to:f,icon:g,type:v},w)=>e(ge,{to:f,class:`search-popover-item ${w===0?"focus":""}`,onClick:_=>{var S;(S=n==null?void 0:n.onSubmit)==null||S.call(n,_)},children:[e(A,{icon:g||(v==="link"?"arrow-right":"search"),class:"more-insignificant"}),e("span",{children:b})," "]}))})]})}),Ka=dt(function({onClose:i=()=>{}}){const[s,o]=R(!1),c=q(null);Fe(["Slash","/"],u=>{o(!0),setTimeout(()=>{var d,l,a,p;(l=(d=c.current)==null?void 0:d.focus)==null||l.call(d),(p=(a=c.current)==null?void 0:a.select)==null||p.call(a)},0)},{useKey:!0,preventDefault:!0,ignoreEventWhen:u=>{const d=/\/search/.test(location.hash),l=!!document.querySelector("#modal-container > *");return d||l}});const r=()=>{o(!1),i()};return Fe("esc",u=>{var d,l;(l=(d=c.current)==null?void 0:d.blur)==null||l.call(d),r()},{enabled:s,enableOnFormTags:!0,preventDefault:!0}),e("div",{id:"search-command-container",hidden:!s,onClick:u=>{u.target===u.currentTarget&&r()},children:e(Vs,{ref:c,onSubmit:()=>{r()}})})});function Va(){const{_:n,_:i}=de(),{instance:s}=ce(),o=Ge(x),{shortcuts:c,settings:r}=o;if(!c.length)return null;const u=r.shortcutsViewMode==="multi-column"||!r.shortcutsViewMode&&r.shortcutsColumnsMode;if(u)return null;const d=q(),l=q(!1),a=c.map((b,f)=>{const{type:g,...v}=b;if(!En[g])return null;let{id:w,path:_,title:S,subtitle:k,icon:T}=En[g];return typeof w=="function"&&(w=w(v,f)),typeof _=="function"&&(_=_({...v,instance:v.instance||s},f)),typeof S=="function"?S=S(v,f):S=i(S),typeof k=="function"?k=k(v,f):k=i(k),typeof T=="function"&&(T=T(v,f)),w==="lists"&&(l.current=!0),{id:w,path:_,title:S,subtitle:k,icon:T}}).filter(Boolean),p=bs();Fe(["1","2","3","4","5","6","7","8","9"],(b,f)=>{var v,w;const g=parseInt(f.keys[0],10)-1;if(g<a.length){const{path:_}=a[g];_&&(p(_),(w=(v=d.current)==null?void 0:v.closeMenu)==null||w.call(v))}},{enabled:!u});const[y,m]=R([]);return e("div",{id:"shortcuts",children:o.settings.shortcutsViewMode==="tab-menu-bar"?e("nav",{class:"tab-bar",onContextMenu:b=>{b.preventDefault(),x.showShortcutsSettings=!0},children:e("ul",{children:a.map(({id:b,path:f,title:g,subtitle:v,icon:w},_)=>e("li",{children:e(ge,{class:v?"has-subtitle":"",to:f,onClick:S=>{if(S.target.classList.contains("is-active")){S.preventDefault();const k=document.getElementById(`${b}-page`);if(k){k.scrollTop=0;const T=k.querySelector(".updates-button");T&&T.click()}}},children:[e(A,{icon:w,size:"xl",alt:g}),e("span",{children:[e(yn,{children:g}),v&&e(U,{children:[e("br",{}),e("small",{children:v})]})]})]})},`${_}-${b}-${g}-${v}-${f}`))})}):e(lt,{instanceRef:d,overflow:"auto",viewScroll:"close",menuClassName:"glass-menu shortcuts-menu",gap:8,position:"anchor",onMenuChange:b=>{b.open&&l.current&&ln().then(m)},menuButton:e("button",{type:"button",id:"shortcuts-button",class:"plain",onContextMenu:b=>{b.preventDefault(),x.showShortcutsSettings=!0},onTransitionStart:b=>{var f,g;try{const{target:v}=b;getComputedStyle(v).pointerEvents==="none"&&((g=(f=d.current)==null?void 0:f.closeMenu)==null||g.call(f))}catch{}},children:e(A,{icon:"shortcut",size:"xl",alt:n({id:"CTqTgr"})})}),children:a.map(({id:b,path:f,title:g,subtitle:v,icon:w},_)=>b==="lists"?e(an,{menuClassName:"glass-menu",overflow:"auto",gap:-8,label:e(U,{children:[e(A,{icon:w,size:"l"}),e("span",{class:"menu-grow",children:e(yn,{children:g})}),e(A,{icon:"chevron-right"})]}),children:[e(Ye,{to:"/l",children:e("span",{children:e(h,{id:"BHWx+g"})})}),e(Ve,{}),y==null?void 0:y.map(S=>e(Ye,{to:`/l/${S.id}`,children:e("span",{children:S.title})},S.id))]}):e(Ye,{to:f,class:"glass-menu-item",children:[e(A,{icon:w,size:"l"})," ",e("span",{class:"menu-grow",children:[e("span",{children:e(yn,{children:g})}),v&&e(U,{children:[" ",e("small",{class:"more-insignificant",children:v})]})]}),e("span",{class:"menu-shortcut hide-until-focus-visible",children:_+1})]},`${_}-${b}-${g}-${v}-${f}`))})})}const Wa=dt(Va);function Za(n){var c;let i=[],s=[],o=0;for(let r=0;r<n.length;r++){const u=n[r];u.reblog&&!((c=u.account)!=null&&c.group)?(s.push(u),o++):(i.push(u),o<3&&(o=0))}if(n.length>10&&(s.length>n.length/4||o>=3)){const r=s.map(u=>u.id);if(s.length>n.length*3/4)i=[...i,{id:r,items:s,type:"boosts"}];else{const u=Math.floor(i.length/2);i=[...i.slice(0,u),{id:r,items:s,type:"boosts"},...i.slice(u)]}return i}else return n}function Xi(n,i){const s=ye.account.get("boostedStatusIDs")||{},o=n.filter(r=>{if(!r.reblog)return!0;const u=`${i}-${r.reblog.id}`,d=s[u];return d&&d!==r.id?!1:(s[u]=r.id,!0)}),c=Object.keys(s);return c.length>50&&c.slice(0,c.length-50).forEach(r=>{delete s[r]}),ye.account.set("boostedStatusIDs",s),o}function Xa(n,i){const s=[];let o=0;n.forEach(d=>{for(let a=0;a<s.length;a++){if(s[a].find(p=>p.id===d.id))return;if(s[a].find(p=>p.id===d.inReplyToId)||s[a].find(p=>p.inReplyToId===d.id)){s[a].push(d);return}}const l=n.find(a=>a.id===d.inReplyToId);l&&(s[o++]=[d,l])});for(let d=0;d<s.length;d++)for(let l=d+1;l<s.length;l++)s[d].find(p=>s[l].includes(p))&&(s[d]=[...s[d],...s[l]],s[d]=s[d].filter((p,y,m)=>m.findIndex(b=>b.id===p.id)===y),s.splice(l,1),l--);s.forEach(d=>{d.sort((l,a)=>!l.inReplyToId&&!a.inReplyToId?new Date(l.createdAt)-new Date(a.createdAt):l.inReplyToId===a.id?1:a.inReplyToId===l.id||!l.inReplyToId?-1:a.inReplyToId?new Date(l.createdAt)-new Date(a.createdAt):1)}),s.forEach(d=>{const l=d[0].account.id;d.forEach(a=>{a.account.id!==l&&(a._differentAuthor=!0)})}),s.length;const c=[],r=[],u=[];return n.forEach(d=>{if(d.reblog){c.push(d);return}for(let l=0;l<s.length;l++)if(s[l].find(a=>a.id===d.id)){if(r.includes(l))return;const a=s[l];a.sort((y,m)=>{const b=new Date(y.createdAt),f=new Date(m.createdAt);return b-f});const p=a[0].account.id;c.push({id:a.map(y=>y.id),items:a,type:a.every(y=>y.account.id===p)?"thread":"conversation"}),r.push(l);return}if(d.inReplyToId&&d.inReplyToAccountId!==d.account.id){const l=rt(d.id,i);x.statusReply[l]||u.push({sKey:l,inReplyToId:d.inReplyToId})}c.push(d)}),u!=null&&u.length&&queueMicrotask(()=>{const{masto:d}=ce({instance:i});async function l(){for(let a=0;a<u.length;a++){const{sKey:p,inReplyToId:y}=u[a];try{const m=await Ja(y,d);Qe(m,i,{skipThreading:!0}),x.statusReply[p]={id:m.id,instance:i},await new Promise(b=>setTimeout(b,1e3))}catch{}}}if(et("@mastodon/fetch-multiple-statuses")){const a=u.map(({inReplyToId:p})=>p);(async()=>{var p;try{const y=await d.v1.statuses.list({id:a});if(y!=null&&y.length)for(const m of y){Qe(m,i,{skipThreading:!0});const b=(p=u.find(({inReplyToId:f})=>f===m.id))==null?void 0:p.sKey;b&&(x.statusReply[b]={id:m.id,instance:i})}else l()}catch{l()}})()}else l()}),c}const Ja=bt((n,i)=>i.v1.statuses.$select(n).fetch());async function Ws(n,i){const s=await Pa();if(!s.length)return;const{statusFollowedTags:o}=x,c=[];if(n.forEach(r=>{var m;if(r.reblog)return;const{id:u,content:d,tags:l=[]}=r,a=rt(u,i);if((m=o[a])!=null&&m.length)return;const p=Da(d);if(!p.length&&!l.length)return;const y=s.reduce((b,f)=>((p.some(g=>g.toLowerCase()===f.name.toLowerCase())||l.some(g=>g.name.toLowerCase()===f.name.toLowerCase()))&&b.push(f.name),b),[]);y.length&&c.push({item:r,sKey:a,followedTags:y})}),c.length){const r=c.map(d=>d.item.account),u=await ui(r);if(!u)return;c.forEach(d=>{const{item:l,sKey:a,followedTags:p}=d,y=u[l.account.id];y&&!y.following&&(o[a]=p)})}}function Qa(){x.statusFollowedTags={}}function er({scrollableRef:n,distanceFromStart:i=1,distanceFromEnd:s=1,scrollThresholdStart:o=10,scrollThresholdEnd:c=10,direction:r="vertical",distanceFromStartPx:u,distanceFromEndPx:d}={}){const[l,a]=R(null),[p,y]=R(!1),[m,b]=R(!1),[f,g]=R(!1),[v,w]=R(!1),_=r==="vertical";return kt(()=>{const S=n.current;if(!S)return{};let k=_?S.scrollTop:S.scrollLeft;function T(){const{scrollTop:C,scrollLeft:I,scrollHeight:E,scrollWidth:L,clientHeight:B,clientWidth:P}=S,Y=_?C:I,Q=_?E:L,te=_?B:P,J=Math.abs(Y-k),V=u||Math.min(te*i,Q,Y),z=d||Math.min(te*s,Q,Q-Y-te);J>=(k<Y?c:o)&&(a(k<Y?"end":"start"),k=Y),y(Y<=0),b(Y+te>=Q),g(Y<=V),w(Y+te>=Q-z)}return S.addEventListener("scroll",T,{passive:!0}),()=>S.removeEventListener("scroll",T)},[i,s,o,c]),{scrollDirection:l,reachStart:p,reachEnd:m,nearReachStart:f,nearReachEnd:v,init:()=>{n.current&&n.current.dispatchEvent(new Event("scroll"))}}}function tr({scrollableRef:n,distanceFromStart:i=1,distanceFromEnd:s=1,scrollThresholdStart:o=10,scrollThresholdEnd:c=10,direction:r="vertical",distanceFromStartPx:u,distanceFromEndPx:d,init:l}={},a,p){if(!a)return;const y=r==="vertical",m=q(null),b=q(null),f=qo(()=>{let g=!1,v=!1,w=!1,_=!1;const S=n.current,{scrollTop:k,scrollLeft:T,scrollHeight:C,scrollWidth:I,clientHeight:E,clientWidth:L}=S,B=y?k:T,P=y?C:I,Y=y?E:L,Q=Math.abs(B-m.current),te=u||Math.min(Y*i,P,B),J=d||Math.min(Y*s,P,P-B-Y);Q>=(m.current<B?c:o)&&(b.current=m.current<B?"end":"start",m.current=B),g=B<=0,v=B+Y>=P,w=B<=te,_=B+Y>=P-J,a({scrollDirection:b.current,reachStart:g,reachEnd:v,nearReachStart:w,nearReachEnd:_})},500);kt(()=>{const g=n.current;return g?(m.current=g[y?"scrollTop":"scrollLeft"],g.addEventListener("scroll",f,{passive:!0}),()=>g.removeEventListener("scroll",f)):{}},[i,s,o,c,...p]),ie(()=>{l&&n.current&&queueMicrotask(()=>{n.current.dispatchEvent(new Event("scroll"))})},[l])}function nr({class:n,statusID:i,status:s,instance:o,parent:c,onMediaClick:r}){const{_:u}=de();let d=rt(i,o);const l=Ge(x);if(s||(s=l.statuses[d]||l.statuses[i],d=rt(s==null?void 0:s.id,o)),!s)return null;const{account:{acct:a,avatar:p,avatarStatic:y,id:m,url:b,displayName:f,username:g,emojis:v,bot:w,group:_},id:S,repliesCount:k,reblogged:T,reblogsCount:C,favourited:I,favouritesCount:E,bookmarked:L,poll:B,muted:P,sensitive:Y,spoilerText:Q,visibility:te,language:J,editedAt:V,filtered:z,card:ue,createdAt:M,inReplyToId:F,inReplyToAccountId:G,content:re,mentions:H,mediaAttachments:se,reblog:be,uri:we,url:Z,emojis:le,_deleted:Re,_pinned:$e}=s;if(!(se!=null&&se.length))return null;const De=xe=>{xe.shiftKey},ze=_e(()=>wt(),[]),Le=_e(()=>ze&&ze===m,[m,ze]),Te=Ao(Mn),X=!Le&&qt(z,Te);if((X==null?void 0:X.action)==="hide")return null;const ke=Y,ne=_e(()=>{var O;return((O=(ye.account.get("preferences")||{})["reading:expand:media"])==null?void 0:O.toLowerCase())||"default"},[])==="show_all",oe=c||"div";return se.map((xe,O)=>{const ee=`${d}-${xe.id}`,fe=X==null?void 0:X.titlesStr;return e(oe,{"data-state-post-id":d,onMouseEnter:De,"data-spoiler-text":Q||(Y?u({id:"FKojeB"}):void 0),"data-filtered-text":X?u(fe?{id:"7FGvtQ",values:{filterTitleStr:fe}}:{id:"03Qqf9"}):void 0,class:`
          media-post
          ${X?"filtered":""}
          ${ke?"has-spoiler":""}
          ${ne?"show-media":""}
        `,children:e(Ts,{class:n,media:xe,lang:J,to:`/${o}/s/${S}?media-only=${O+1}`,onClick:r?D=>r(D,O,xe,s):void 0})},ee)})}const Ji=dt(nr);function ir(n){var S,k,T,C,I;const{_:i}=de(),s=Ge(x),{masto:o,instance:c,authenticated:r}=ce(),[u,d]=_e(()=>{const E=ye.local.getJSON("accounts")||[];return[E.find(B=>B.info.id===wt())||E[0],E.length>1]},[]),l=(s.settings.shortcutsViewMode==="multi-column"||!s.settings.shortcutsViewMode&&s.settings.shortcutsColumnsMode)&&!s.shortcuts.find(E=>E.type==="following"),a=ws(()=>{x.showAccounts=!0},{threshold:600,detect:"touch",cancelOnMovement:!0}),p=q(),[y,m]=R(void 0),b=Ss([0,0,s.settings.shortcutsViewMode==="tab-menu-bar"?50:0,0]),f=q();async function g(E){return(E||!f.current)&&(f.current=o.v1.mutes.list({limit:80})),await f.current.next()}const v=q();async function w(E){return(E||!v.current)&&(v.current=o.v1.blocks.list({limit:80})),await v.current.next()}const _=q();return e(U,{children:[e("button",{ref:p,type:"button",class:`button plain nav-menu-button ${d?"with-avatar":""} ${y==="open"?"active":""}`,style:{position:"relative"},onClick:()=>{_.current=Date.now(),m(E=>E?void 0:"open")},onContextMenu:E=>{E.preventDefault(),x.showAccounts=!0},...a(),children:[d&&e(pt,{url:((S=u==null?void 0:u.info)==null?void 0:S.avatar)||((k=u==null?void 0:u.info)==null?void 0:k.avatarStatic),size:"l",squircle:(T=u==null?void 0:u.info)==null?void 0:T.bot}),e(A,{icon:"menu",size:d?"s":"l",alt:i({id:"zucql+"})})]}),e(di,{menuClassName:"nav-menu",state:y,anchorRef:p,onClose:()=>{m(void 0)},containerProps:{style:{zIndex:10},onClick:()=>{Date.now()-_.current<300}},portal:{target:document.body},...n,overflow:"auto",viewScroll:"close",position:"anchor",align:"center",boundingBoxPadding:b,unmountOnClose:!0,children:[!!((C=s.appVersion)!=null&&C.commitHash)&&s.appVersion.commitHash!=="4f6f237"&&e("div",{class:"top-menu",children:[e(ve,{onClick:()=>{confirm(i({id:"Djbaby"}))&&(async()=>{try{location.reload()}catch{}})()},children:[e(A,{icon:"sparkles",class:"sparkle-icon",size:"l"})," ",e("span",{children:e(h,{id:"95IFnD"})})]}),e(Ve,{})]}),e("section",{children:[e(Ye,{to:"/",children:[e(A,{icon:"home",size:"l"})," ",e("span",{children:e(h,{id:"i0qMbr"})})]}),r?e(U,{children:[l&&e(Ye,{to:"/following",children:[e(A,{icon:"following",size:"l"})," ",e("span",{children:e(h,{id:"following.title"})})]}),e(Ye,{to:"/catchup",children:[e(A,{icon:"history2",size:"l"}),e("span",{children:e(h,{id:"xrl8fj"})})]}),et("@mastodon/mentions")&&e(Ye,{to:"/mentions",children:[e(A,{icon:"at",size:"l"})," ",e("span",{children:e(h,{id:"/bZzdR"})})]}),e(Ye,{to:"/notifications",children:[e(A,{icon:"notification",size:"l"})," ",e("span",{children:e(h,{id:"iDNBZe"})}),s.notificationsShowNew&&e("sup",{title:i({id:"isRobC"}),style:{opacity:.5},children:[" ","•"]})]}),e(Ve,{}),((I=u==null?void 0:u.info)==null?void 0:I.id)&&e(Ye,{to:`/${c}/a/${u.info.id}`,children:[e(A,{icon:"user",size:"l"})," ",e("span",{children:e(h,{id:"vERlcd"})})]}),e(sr,{menuState:y}),e(Ye,{to:"/b",children:[e(A,{icon:"bookmark",size:"l"})," ",e("span",{children:e(h,{id:"7Ff7ia"})})]}),e(an,{menuClassName:"nav-submenu",overflow:"auto",gap:-8,label:e(U,{children:[e(A,{icon:"more",size:"l"}),e("span",{class:"menu-grow",children:e(h,{id:"24misb"})}),e(A,{icon:"chevron-right"})]}),children:[e(Ye,{to:"/f",children:[e(A,{icon:"heart",size:"l"})," ",e("span",{children:e(h,{id:"zZOZj7"})})]}),e(Ye,{to:"/fh",children:[e(A,{icon:"hashtag",size:"l"})," ",e("span",{children:e(h,{id:"Xi1/bw"})})]}),e(Ye,{to:"/sp",children:[e(A,{icon:"schedule",size:"l"})," ",e("span",{children:e(h,{id:"+GkIdc"})})]}),e(Ve,{}),et("@mastodon/filters")&&e(Ye,{to:"/ft",children:[e(A,{icon:"filters",size:"l"})," ",e("span",{children:e(h,{id:"cSev+j"})})]}),e(ve,{onClick:()=>{x.showGenericAccounts={id:"mute",heading:i({id:"sOKhEA"}),fetchAccounts:g,excludeRelationshipAttrs:["muting"]}},children:[e(A,{icon:"mute",size:"l"})," ",e("span",{children:e(h,{id:"n1sANU"})})]}),e(ve,{onClick:()=>{x.showGenericAccounts={id:"block",heading:i({id:"nL8nlr"}),fetchAccounts:w,excludeRelationshipAttrs:["blocking"]}},children:[e(A,{icon:"block",size:"l"})," ",e("span",{children:e(h,{id:"r3RRWo"})})]})," "]}),e(Ve,{}),e(ve,{onClick:()=>{x.showAccounts=!0},children:[e(A,{icon:"group",size:"l"})," ",e("span",{children:e(h,{id:"7e0O8Z"})})]})]}):e(U,{children:[e(Ve,{}),e(Ye,{to:"/login",children:[e(A,{icon:"user",size:"l"})," ",e("span",{children:e(h,{id:"sQia9P"})})]})]})]}),e("section",{children:[e(Ve,{}),e(Ye,{to:"/search",children:[e(A,{icon:"search",size:"l"})," ",e("span",{children:e(h,{id:"A1taO8"})})]}),e(Ye,{to:`/${c}/trending`,children:[e(A,{icon:"chart",size:"l"})," ",e("span",{children:e(h,{id:"4/iCqx"})})]}),e(Ye,{to:`/${c}/p/l`,children:[e(A,{icon:"building",size:"l"})," ",e("span",{children:e(h,{id:"d5zxa4"})})]}),e(Ye,{to:`/${c}/p`,children:[e(A,{icon:"earth",size:"l"})," ",e("span",{children:e(h,{id:"4ERYY7"})})]}),r?e(U,{children:[e(Ve,{className:"divider-grow"}),e(ve,{onClick:()=>{x.showKeyboardShortcutsHelp=!0},children:[e(A,{icon:"keyboard",size:"l"})," ",e("span",{children:e(h,{id:"77Emn0"})})]}),e(ve,{onClick:()=>{x.showShortcutsSettings=!0},children:[e(A,{icon:"shortcut",size:"l"})," ",e("span",{children:e(h,{id:"8Kudkr"})})]}),e(ve,{onClick:()=>{x.showSettings=!0},children:[e(A,{icon:"gear",size:"l"})," ",e("span",{children:e(h,{id:"uVbUP8"})})]})]}):e(U,{children:[e(Ve,{}),e(ve,{onClick:()=>{x.showSettings=!0},children:[e(A,{icon:"gear",size:"l"})," ",e("span",{children:e(h,{id:"uVbUP8"})})]})]})]})]})]})}function sr({menuState:n}){const i=et("@mastodon/lists"),[s,o]=R([]);return ie(()=>{i&&n==="open"&&ln().then(o)},[n,i]),s.length>0?e(an,{menuClassName:"nav-submenu",overflow:"auto",gap:-8,label:e(U,{children:[e(A,{icon:"list",size:"l"}),e("span",{class:"menu-grow",children:e(h,{id:"h16FyT"})}),e(A,{icon:"chevron-right"})]}),children:[e(Ye,{to:"/l",children:e("span",{children:e(h,{id:"BHWx+g"})})}),(s==null?void 0:s.length)>0&&e(U,{children:[e(Ve,{}),s.map(c=>e(Ye,{to:`/l/${c.id}`,children:e("span",{children:c.title})},c.id))]})]}):i&&e(Ye,{to:"/l",children:[e(A,{icon:"list",size:"l"}),e("span",{children:e(h,{id:"h16FyT"})})]})}const Mt=dt(ir),un={block:"start",inline:"center",behavior:"smooth"};function At({title:n,titleComponent:i,id:s,instance:o,emptyText:c,errorText:r,useItemID:u,boostsCarousel:d,fetchItems:l=()=>{},checkForUpdates:a=()=>{},checkForUpdatesInterval:p=15e3,headerStart:y,headerEnd:m,timelineStart:b,refresh:f,view:g,filterContext:v,showFollowedTags:w,showReplyParent:_,clearWhenRefresh:S}){const{_:k}=de(),T=Ge(x),[C,I]=R([]),[E,L]=R("start"),[B,P]=R(!1),[Y,Q]=R(!1),[te,J]=R(!0),V=q();__BENCHMARK.start(`timeline-${s}-load`);const z=_e(()=>ai(),[]),ue=g!=="media",M=q(0),F=jo(X=>{Q(!1),L("loading"),(async()=>{try{const ke=M.current=Date.now();let{done:Ne,value:ne}=await l(X);if(ke!==M.current)return;if(Array.isArray(ne)){const[oe,xe]=ne.reduce((O,ee)=>(ee._pinned?O[0].push(ee):O[1].push(ee),O),[[],[]]);ne=xe,ue&&(d&&(ne=Za(ne)),ne=Xa(ne,o)),oe.length&&(ne=oe.concat(ne)),I(X?ne:O=>[...O,...ne]),ne.length||(Ne=!0),P(!Ne)}else P(!1);L("default"),__BENCHMARK.end(`timeline-${s}-load`)}catch{L("error"),X&&!C.length&&r&&pe(r)}finally{F.cancel()}})()},1e3,{leading:!0}),G=".timeline-item, .timeline-item-alt",re=Fe("j, shift+j",(X,ke)=>{if(X.shiftKey!==ke.shift)return;const Ne=document.activeElement.closest(G),ne=Ne==null?void 0:Ne.getBoundingClientRect(),oe=Array.from(V.current.querySelectorAll(G)).filter(xe=>!!xe.offsetHeight);if(Ne&&ne.top<V.current.clientHeight&&ne.bottom>0){const xe=oe.indexOf(Ne);let O=oe[xe+1];ke.shift&&(O=oe.find((ee,fe)=>fe>xe&&!ee.classList.contains("timeline-item-alt"))),O&&(O.focus(),O.scrollIntoView(un))}else{const xe=oe.find(O=>{const ee=O.getBoundingClientRect();return ee.top>=44&&ee.left>=0});xe&&(xe.focus(),xe.scrollIntoView(un))}},{useKey:!0}),H=Fe("k, shift+k",(X,ke)=>{if(X.shiftKey!==ke.shift)return;const Ne=document.activeElement.closest(G),ne=Ne==null?void 0:Ne.getBoundingClientRect(),oe=Array.from(V.current.querySelectorAll(G)).filter(xe=>!!xe.offsetHeight);if(Ne&&ne.top<V.current.clientHeight&&ne.bottom>0){const xe=oe.indexOf(Ne);let O=oe[xe-1];ke.shift&&(O=oe.findLast((ee,fe)=>fe<xe&&!ee.classList.contains("timeline-item-alt"))),O&&(O.focus(),O.scrollIntoView(un))}else{const xe=oe.find(O=>{const ee=O.getBoundingClientRect();return ee.top>=44&&ee.left>=0});xe&&(xe.focus(),xe.scrollIntoView(un))}},{useKey:!0}),se=Fe(["enter","o"],()=>{const X=document.activeElement;X!=null&&X.matches(G)&&X.click()},{useKey:!0}),be=C.length>0&&E!=="loading"&&Y,we=ot(()=>{var X;be&&F(!0),(X=V.current)==null||X.scrollTo({top:0,behavior:"smooth"})},[F,be]),Z=Fe(".",we),le=q(),[Re,$e]=R(!1);tr({scrollableRef:V,distanceFromEnd:2,scrollThresholdStart:44},({scrollDirection:X,nearReachStart:ke,reachStart:Ne})=>{if(le.current){const ne=X==="end"&&!ke;le.current.hidden=ne}$e(ke),Ne&&F(!0)},[]),ie(()=>{var X;(X=V.current)==null||X.scrollTo({top:0}),F(!0)},[]);const De=q(!0);ie(()=>{var X;if(De.current){De.current=!1;return}S&&(C!=null&&C.length)&&((X=F.cancel)==null||X.call(F),I([])),F(!0)},[S,f]);const ze=q(g);ie(()=>{ze.current!==g&&(ze.current=g,I([]))},[g]);const Le=ot(async({disableIdleCheck:X=!1}={})=>{const ke=V.current?getComputedStyle(V.current).pointerEvents==="none":!1;T.settings.autoRefresh&&V.current.scrollTop<16&&(X||window.__IDLE__)&&!rr()&&!ke?F(!0):await a()&&Q(!0)},[s,F,a,T.settings.autoRefresh]),Te=q();return jt(X=>{if(X){const ke=Date.now()-Te.current;(!Te.current||ke>1e3*3)&&Le({disableIdleCheck:!0})}else Te.current=Date.now();J(X)},[a,Le,T.settings.autoRefresh]),li(Le,te&&!Y?p*(Re?1:2):null),e(Mn.Provider,{value:v,children:e("div",{id:`${s}-page`,class:`deck-container ${z?"deck-container-media-first":""}`,ref:X=>{V.current=X,re.current=X,H.current=X,se.current=X,Z.current=X},tabIndex:"-1",onClick:X=>{le.current&&X.target.closest(".timeline-item, .timeline-item-alt")&&setTimeout(()=>{le.current.hidden=!1},250)},children:e("div",{class:"timeline-deck deck",children:[e("header",{ref:le,onClick:X=>{var ke;X.target.closest("a, button")||(ke=V.current)==null||ke.scrollTo({top:0,behavior:"smooth"})},onDblClick:X=>{X.target.closest("a, button")||F(!0)},class:E==="loading"?"loading":"",children:[e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Mt,{}),y??e(ge,{to:"/",class:"button plain home-button",children:e(A,{icon:"home",size:"l",alt:k({id:"i0qMbr"})})})]}),n&&(i||e("h1",{children:n})),e("div",{class:"header-side",children:!!m&&m})]}),be&&e("button",{class:"updates-button shiny-pill",type:"button",onClick:we,children:[e(A,{icon:"arrow-up"})," ",e(h,{id:"2yr1/p"})]})]}),!!b&&e("div",{class:`timeline-start ${E==="loading"?"loading":""}`,children:b}),C.length?e(U,{children:[e("ul",{class:`timeline ${g?`timeline-${g}`:""}`,children:[C.map(X=>e(or,{status:X,instance:o,useItemID:u,filterContext:v,view:g,showFollowedTags:w,showReplyParent:_,mediaFirst:z},X.id+(X==null?void 0:X._pinned)+g)),B&&E==="loading"&&(g==="media"?null:e(U,{children:[e("li",{style:{height:"20vh"},children:e(qe,{skeleton:!0,mediaFirst:z})}),e("li",{style:{height:"25vh"},children:e(qe,{skeleton:!0,mediaFirst:z})})]}))]}),E==="default"&&(B?e(Ct,{root:V.current,rootMargin:`0px 0px ${screen.height*1.5}px 0px`,onChange:X=>{X&&F()},children:e("button",{type:"button",class:"plain block",onClick:()=>F(),style:{marginBlockEnd:"6em"},children:e(h,{id:"uXRAkV"})})}):e("p",{class:"ui-state insignificant",children:e(h,{id:"2EYeAZ"})}))]}):E==="loading"?e("ul",{class:"timeline",children:Array.from({length:5}).map((X,ke)=>g==="media"?e("div",{style:{height:"50vh"}}):e("li",{children:e(qe,{skeleton:!0,mediaFirst:z})},ke))}):E!=="error"&&E!=="start"&&e("p",{class:"ui-state",children:c}),E==="error"&&e("p",{class:"ui-state",children:[r,e("br",{}),e("br",{}),e("button",{type:"button",onClick:()=>F(!C.length),children:e(h,{id:"KDw4GX"})})]})]})})})}const or=dt(({status:n,instance:i,useItemID:s,filterContext:o,view:c,showFollowedTags:r,showReplyParent:u,mediaFirst:d})=>{const{_:l}=de(),{id:a,reblog:p,items:y,type:m,_pinned:b}=n;b&&(s=!1);const f=(p==null?void 0:p.id)||a,g=i?`/${i}/s/${f}`:`/s/${f}`;if(y){let w=Ot(y,o),_="";if(m==="boosts"?_=he._({id:"NuqppG",values:{0:w.length}}):m==="pinned"&&(_=l({id:"GlfmCu"})),m==="boosts"||m==="pinned"){const T=new Set;if(w.sort((C,I)=>{const E=qt(C.filtered,o),L=qt(I.filtered,o);return E&&(E==null?void 0:E.action)!=="blur"&&T.add(C.id),L&&(L==null?void 0:L.action)!=="blur"&&T.add(I.id),E&&!L?1:!E&&L?-1:0}),T.size>=2){const I=[],E=[];w.forEach(B=>{T.has(B.id)?E.push(B):I.push(B)});const L=[];for(let B=0;B<E.length;B+=5)L.push({_grouped:!0,posts:E.slice(B,B+5)});w=I.concat(L)}return e("li",{class:"timeline-item-carousel",children:e(cr,{title:_,class:`${m}-carousel`,children:w.map(C=>{const{id:I,reblog:E,_pinned:L,_grouped:B}=C;if(B)return e("li",{class:"timeline-item-carousel-group",children:C.posts.map(Q=>{const{id:te,reblog:J,_pinned:V}=Q,z=(J==null?void 0:J.id)||te,ue=i?`/${i}/s/${z}`:`/s/${z}`;return V&&(s=!1),e(ge,{class:"status-carousel-link timeline-item-alt",to:ue,children:s?e(qe,{statusID:te,instance:i,size:"s"}):e(qe,{status:Q,instance:i,size:"s"})})})},I);const P=(E==null?void 0:E.id)||I,Y=i?`/${i}/s/${P}`:`/s/${P}`;return L&&(s=!1),e("li",{children:e(ge,{class:"status-carousel-link timeline-item-alt",to:Y,children:s?e(qe,{statusID:I,instance:i,size:"s",contentTextWeight:!0,enableCommentHint:!0,mediaFirst:d}):e(qe,{status:C,instance:i,size:"s",contentTextWeight:!0,enableCommentHint:!0,mediaFirst:d})})},I)})})},`timeline-${a}`)}const k=w.length>3;return w.map((T,C)=>{const{id:I,_differentAuthor:E}=T,L=i?`/${i}/s/${I}`:`/s/${I}`,B=C>0&&C<w.length-1,P=T.sensitive&&!!T.spoilerText,Y=!E&&P&&C>0||k&&B&&(m==="thread"||m==="conversation"&&!E&&!w[C-1]._differentAuthor&&!w[C+1]._differentAuthor),Q=C===0,te=C===w.length-1;return e("li",{class:`timeline-item-container timeline-item-container-type-${m} timeline-item-container-${Q?"start":te?"end":"middle"} ${E?"timeline-item-diff-author":""}`,children:e(ge,{class:"status-link timeline-item",to:L,children:Y?e(ar,{status:T,instance:i,filterContext:o}):s?e(qe,{statusID:I,instance:i,enableCommentHint:te,showFollowedTags:r}):e(qe,{status:T,instance:i,enableCommentHint:te,showFollowedTags:r})})},`timeline-${I}`)})}const v=`timeline-${a+b}`;return c==="media"?s?e(Ji,{class:"timeline-item",parent:"li",statusID:a,instance:i},v):e(Ji,{class:"timeline-item",parent:"li",status:n,instance:i},v):e("li",{children:e(ge,{class:"status-link timeline-item",to:g,children:s?e(qe,{statusID:a,instance:i,enableCommentHint:!0,showFollowedTags:r,showReplyParent:u,mediaFirst:d}):e(qe,{status:n,instance:i,enableCommentHint:!0,showFollowedTags:r,showReplyParent:u,mediaFirst:d})})},v)},(n,i)=>{var c,r;const s=(((c=n.status)==null?void 0:c.id)||"").toString(),o=(((r=i.status)==null?void 0:r.id)||"").toString();return s===o&&n.instance===i.instance&&n.view===i.view});function cr({title:n,class:i,children:s}){const{_:o}=de(),c=q(),r=q(),u=q(),[d,l]=R(!1);return ie(()=>{setTimeout(()=>{l(!0)},1)},[]),e("div",{class:`status-carousel ${i}`,children:[e("header",{children:[e("h3",{children:n}),e("span",{children:[e("button",{ref:r,type:"button",class:"small plain2",onClick:()=>{var p,y;const a=Math.min(320,(p=c.current)==null?void 0:p.offsetWidth)*(Dt()?1:-1);(y=c.current)==null||y.scrollBy({left:a,behavior:"smooth"})},children:e(A,{icon:"chevron-left",alt:o({id:"DHhJ7s"})})})," ",e("button",{ref:u,type:"button",class:"small plain2",onClick:()=>{var p,y;const a=Math.min(320,(p=c.current)==null?void 0:p.offsetWidth)*(Dt()?-1:1);(y=c.current)==null||y.scrollBy({left:a,behavior:"smooth"})},children:e(A,{icon:"chevron-right",alt:o({id:"hXzOVo"})})})]})]}),e("ul",{ref:c,children:[e(Ct,{class:"status-carousel-beacon",onChange:a=>{r.current&&(r.current.disabled=a)}}),s[0],d&&s.slice(1),e(Ct,{class:"status-carousel-beacon",onChange:a=>{u.current&&(u.current.disabled=a)}})]})]})}function ar({status:n,instance:i,filterContext:s}){const{_:o}=de(),c=Ge(x),{id:r,visibility:u,language:d}=n,l=Ln(n),a=rt(r,i),p=qt(n.filtered,s);return e("article",{class:`status compact-thread ${u==="direct"?"visibility-direct":""}`,tabindex:"-1",children:[c.statusThreadNumber[a]?e("div",{class:"status-thread-badge",children:[e(A,{icon:"thread",size:"s",alt:o({id:"e66y2Z"})}),c.statusThreadNumber[a]?` ${c.statusThreadNumber[a]}/X`:""]}):e("div",{class:"status-thread-badge",children:e(A,{icon:"thread",size:"s",alt:o({id:"e66y2Z"})})}),e("div",{class:"content-compact",title:l,lang:d,dir:"auto",children:p&&(p==null?void 0:p.action)!=="blur"?e("b",{class:"status-filtered-badge badge-meta horizontal",title:(p==null?void 0:p.titlesStr)||"",children:p!=null&&p.titlesStr?e(h,{id:"sr6maL",values:{0:p.titlesStr},components:{0:e("span",{}),1:e("span",{})}}):e("span",{children:e(h,{id:"03Qqf9"})})}):e(U,{children:[l,n.sensitive&&n.spoilerText&&e(U,{children:[" ",e("span",{class:"spoiler-badge",children:e(A,{icon:"eye-close",size:"s",alt:o({id:"gnKo7f"})})})]})]})})]})}function rr(){return!!document.querySelector(".deck-backdrop, #modal-container > *")}const Ht=20,Ci=1983,Qi=`${Ci}-01`,lr=(()=>{try{const n=document.createElement("input");return n.setAttribute("type","month"),n.type==="month"}catch{return!1}})();async function dr(n){var o;const{masto:i}=ce({instance:n}),s=await i.v2.search.fetch({q:"from:me",type:"statuses",limit:1});return!!((o=s==null?void 0:s.statuses)!=null&&o.length)}const ur=bt(dr);function hr(){const{i18n:n,_:i}=de(),s=Ge(x),{id:o,...c}=Lt(),[r,u]=yt(),d=r.get("month"),l=!r.get("replies"),a=!!r.get("boosts"),p=r.get("tagged"),y=!!r.get("media"),{masto:m,instance:b,authenticated:f}=ce({instance:c.instance}),{masto:g,instance:v}=ce(),w=q(),_=[d,l,a,p,y],[S,k]=R(),T=q(0);ie(()=>{T.current=0},_);const C=_e(()=>ai(),[]),I=_e(()=>b===v,[b,v]),[E,L]=R(!1);ie(()=>{I&&S!=null&&S.acct&&(async()=>{const H=await ur(b);L(H)})()},[b,I,S==null?void 0:S.acct]);async function B(H){var Re,$e,De,ze;const se=/^\d{4}-[01]\d$/.test(d),be=(($e=(Re=d==null?void 0:d.split)==null?void 0:Re.call(d,"-"))==null?void 0:$e[0])>=Ci;if(se&&be){if(!S)return{value:[],done:!0};const[Le,Te]=d.split("-"),X=parseInt(Te,10)-1,ke=new Date(Le,X,0),Ne=`${ke.getFullYear()}-${(ke.getMonth()+1).toString().padStart(2,"0")}-${ke.getDate().toString().padStart(2,"0")}`,ne=new Date(Le,X+1,1),oe=`${ne.getFullYear()}-${(ne.getMonth()+1).toString().padStart(2,"0")}-${ne.getDate().toString().padStart(2,"0")}`;let xe;H?(xe=Ht+1,T.current=0):(xe=Ht+T.current+1,T.current+=Ht);const O=await m.v2.search.fetch({q:`from:${S.acct} after:${Ne} before:${oe}`,type:"statuses",limit:xe,offset:T.current});if((De=O==null?void 0:O.statuses)!=null&&De.length){const ee=O.statuses.slice(0,Ht);ee.forEach(D=>{Qe(D,b)});const fe=O.statuses.length<=Ht;return{value:ee,done:fe}}else return{value:[],done:!0}}let we=[];if(H){const{value:Le}=await m.v1.accounts.$select(o).statuses.list({pinned:!0}).next();if(Le!=null&&Le.length&&!p&&!y){const Te=Le.map(X=>(Qe(X,b),{...X,_pinned:!0}));if(Te.length>=3){const X=Te.map(ke=>ke.id);we.push({id:X,items:Te,type:"pinned"})}else we.push(...Te)}}(H||!w.current)&&(w.current=m.v1.accounts.$select(o).statuses.list({limit:Ht,exclude_replies:l,exclude_reblogs:a,only_media:y||void 0,tagged:p}));const{value:Z,done:le}=await w.current.next();if(Z!=null&&Z.length){if(we.length){let Le=[];((ze=we[0])==null?void 0:ze.type)==="pinned"?Le=we[0].id:Le=we.filter(X=>X._pinned).map(X=>X.id),Le.every(X=>Z.some(ke=>ke.id===X))&&(we=[])}we.push(...Z),Z.forEach(Le=>{Qe(Le,b)})}return{value:we,done:le}}const[P,Y]=R([]);let Q=i({id:"/cKnpj"});if(S!=null&&S.acct){const H=(/@/.test(S.acct)?"":"@")+S.acct,se=S!=null&&S.displayName?`${S.displayName} (${H})`:`${H}`;if(!l)Q=i({id:"hS1Opy",values:{accountDisplay:se}});else if(a)Q=i({id:"A/CX5F",values:{accountDisplay:se}});else if(p)Q=i({id:"QQrO94",values:{accountDisplay:se,tagged:p}});else if(y)Q=i({id:"NoG5wD",values:{accountDisplay:se}});else if(d){const be=new Date(d).toLocaleString(n.locale,{month:"long",year:"numeric"});Q=i({id:"8GjLvB",values:{accountDisplay:se,monthYear:be}})}else Q=se}tt(Q,"/:instance?/a/:id");const te=ot(()=>mr(o,m),[o,m]);ie(()=>{(async()=>{try{const H=await te();k(H)}catch{}if(!C)try{const H=await m.v1.accounts.$select(o).featuredTags.list();Y(H)}catch{}})()},[o,C]);const{displayName:J,acct:V,emojis:z}=S||{},ue=q(),M=_e(()=>{const H=!l||a||p||y||!!d,se=s.accounts[`${o}@${b}`];return e(U,{children:[e(Ys,{instance:b,account:se||o,fetchAccount:te,authenticated:f,standalone:!0}),!C&&e("div",{class:"filter-bar",ref:ue,style:{position:"relative"},children:[H?e(ge,{to:`/${b}/a/${o}`,class:"insignificant filter-clear",title:i({id:"u8JHrO"}),children:e(A,{icon:"x",size:"l",alt:i({id:"xCJdfg"})})},"clear-filters"):e(A,{icon:"filter",class:"insignificant",size:"l",alt:i({id:"cSev+j"})}),e(ge,{to:`/${b}/a/${o}${l?"?replies=1":""}`,onClick:()=>{l&&pe(i({id:"PIWNSQ"}))},class:l?"":"is-active",children:e(h,{id:"5BFynH"})}),e(ge,{to:`/${b}/a/${o}${a?"":"?boosts=0"}`,onClick:()=>{a||pe(i({id:"Qd13i0"}))},class:a?"is-active":"",children:e(h,{id:"usxQx0"})}),e(ge,{to:`/${b}/a/${o}${y?"":"?media=1"}`,onClick:()=>{y||pe(i({id:"rKpfPY"}))},class:y?"is-active":"",children:e(h,{id:"xYilR2"})}),P.map(be=>e(ge,{to:`/${b}/a/${o}${p===be.name?"":`?tagged=${encodeURIComponent(be.name)}`}`,onClick:()=>{p!==be.name&&pe(i({id:"L+HFfr",values:{0:be.name}}))},class:p===be.name?"is-active":"",children:e("span",{children:[e("span",{class:"more-insignificant",children:"#"}),be.name]})},be.id)),E&&(lr?e("label",{class:`filter-field ${d?"is-active":""}`,children:[e(A,{icon:"month",size:"l"}),e("input",{type:"month",disabled:!(S!=null&&S.acct),value:d||"",min:Qi,max:new Date().toISOString().slice(0,7),onInput:be=>{const{value:we,validity:Z}=be.currentTarget;if(!Z.valid)return;u(we?{month:we}:{});const[le,Re]=we.split("-"),$e=parseInt(Re,10)-1,De=new Date(le,$e);pe(i({id:"0WUFGD",values:{0:De.toLocaleString(n.locale,{month:"long",year:"numeric"})}}))}})]}):e(fr,{class:`filter-field ${d?"is-active":""}`,disabled:!(S!=null&&S.acct),value:d||"",min:Qi,max:new Date().toISOString().slice(0,7),onInput:be=>{const{value:we,validity:Z}=be;Z.valid&&u(we?{month:we}:{})}}))]})]})},[o,b,f,P,te,E,..._]);ie(()=>{var se;const H=(se=ue.current)==null?void 0:se.querySelector(".is-active");H&&ue.current.scrollTo({behavior:"smooth",left:H.offsetLeft-(ue.current.offsetWidth-H.offsetWidth)/2})},[P,E,..._]);const F=_e(()=>{var se;return S!=null&&S.url?(se=URL.parse(S.url))==null?void 0:se.hostname:null},[S]),re=!!S&&!(b===F);return e(At,{title:`${S!=null&&S.acct?"@"+S.acct:i({id:"+owNNn"})}`,titleComponent:e("h1",{class:"header-double-lines header-account",children:[e("b",{children:e(Is,{text:J,emojis:z})}),e("div",{children:e("span",{class:"bidi-isolate",children:["@",V]})})]}),id:"account-statuses",instance:b,emptyText:i({id:"+k97fV"}),errorText:i({id:"scd9lw"}),fetchItems:B,useItemID:!0,view:y||C?"media":void 0,boostsCarousel:s.settings.boostsCarousel,timelineStart:M,refresh:[l,a,p,y,d+(S==null?void 0:S.acct)].toString(),headerEnd:e(lt,{portal:!0,overflow:"auto",viewScroll:"close",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(A,{icon:"more",size:"l",alt:i({id:"2FYpfJ"})})}),children:[e(ve,{disabled:!re,onClick:()=>{(async()=>{try{const{masto:H}=ce({instance:F}),se=await H.v1.accounts.lookup({acct:S.acct}),{id:be}=se;location.hash=`/${F}/a/${be}`}catch{alert(i({id:"FgdLx0"}))}})()},children:[e(A,{icon:"transfer"})," ",e("small",{class:"menu-double-lines",children:e(h,{id:"/JFxxT",values:{0:F?e(U,{children:[" ","(",e("b",{children:rn.toUnicode(F)}),")"]}):null}})})]}),!I&&e(ve,{onClick:()=>{(async()=>{try{const H=await g.v1.accounts.lookup({acct:S.acct+"@"+b}),{id:se}=H;location.hash=`/${v}/a/${se}`}catch{alert(i({id:"FgdLx0"}))}})()},children:[e(A,{icon:"transfer"})," ",e("small",{class:"menu-double-lines",children:e(h,{id:"HkuyOu",values:{currentInstance:v},components:{0:e("b",{})}})})]})]})},o)}function fr(n){const{i18n:i}=de(),{class:s,disabled:o,value:c,min:r,max:u,onInput:d=()=>{}}=n,[l,a]=(c==null?void 0:c.split("-"))||[],p=q(),y=q(),m=(b,f)=>{const[g,v]=(r==null?void 0:r.split("-"))||[],[w,_]=(u==null?void 0:u.split("-"))||[];return!(f<g||f>w||f===g&&b<v||f===w&&b>_)};return e("div",{class:s,children:[e(A,{icon:"month",size:"l"}),e("select",{ref:p,disabled:o,value:a||"",onInput:b=>{const{value:f}=b.currentTarget,g=y.current.value;if(!m(f,g))return{value:"",validity:{valid:!1}};d({value:f?`${g}-${f}`:"",validity:{valid:!0}})},children:[e("option",{value:"",children:e(h,{id:"HajiZl"})}),e("option",{disabled:!0,children:"-----"}),Array.from({length:12},(b,f)=>e("option",{value:(f+1).toString().padStart(2,"0"),children:new Date(0,f).toLocaleString(i.locale,{month:"long"})},f))]})," ",e("input",{ref:y,type:"number",disabled:o,value:l||new Date().getFullYear(),min:(r==null?void 0:r.slice(0,4))||Ci,max:(u==null?void 0:u.slice(0,4))||new Date().getFullYear(),onInput:b=>{const{value:f,validity:g}=b.currentTarget,v=p.current.value;if(!g.valid||!m(v,f))return{value:"",validity:{valid:!1}};d({value:f?`${f}-${v}`:"",validity:{valid:!0}})},style:{width:"4.5em"}})]})}function pr(n,i){return i.v1.accounts.$select(n).fetch()}const mr=bt(pr,{maxAge:30*60*1e3});function gr(){var b;const n=Lt(),{year:i}=n;tt(i?`Annual Report: ${i}`:"Annual Report");const{masto:s,instance:o}=ce(),[c,r]=R(null),[u,d]=R("default");ie(()=>{i&&(async()=>{d("loading");const f=await s.v1.annualReports.$select(i).fetch();r(f),d("default")})()},[i]);const{accounts:l,annualReports:a,statuses:p}=c||{},y=(b=a==null?void 0:a.find(f=>f.year==i))==null?void 0:b.data,m=new Date;return e("div",{id:"annual-report-page",class:"deck-container",tabIndex:"-1",children:[e("div",{class:"report",children:[e("h1",{children:[i," #Wrapstodon"]}),u==="loading"&&e("p",{children:[e(Ue,{abrupt:!0})," ",e(h,{id:"Pwqkdw"})]}),!!y&&e("dl",{children:Object.entries(y).map(([f,g])=>e(U,{children:[e("dt",{children:f}),e("dd",{class:`report-${f}`,children:Array.isArray(g)?e("table",{children:[e("thead",{children:e("tr",{children:Object.entries(g[0]).map(([v,w])=>e("th",{class:v!=="month"&&typeof w=="number"?"number":"",children:v}))})}),e("tbody",{children:g.map(v=>e("tr",{children:Object.entries(v).map(([w,_])=>e("td",{class:w!=="month"&&typeof _=="number"?"number":"",children:_&&/(accountId)/i.test(w)&&/^(mostRebloggedAccounts|commonlyInteractedWithAccounts)$/i.test(f)?e(gt,{account:l==null?void 0:l.find(S=>S.id===_),showAvatar:!0}):w==="month"?m.setMonth(_-1)&&m.toLocaleString(void 0,{month:"long"}):typeof _=="number"?_.toLocaleString():_}))}))})]}):typeof g=="object"?/^(topStatuses)$/i.test(f)?e("dl",{children:Object.entries(g).map(([v,w])=>e(U,{children:[e("dt",{children:v}),e("dd",{children:w&&e(ge,{to:`/${o}/s/${w}`,children:e(qe,{status:p==null?void 0:p.find(_=>_.id===w),size:"s",readOnly:!0})})})]}))}):e("table",{children:e("tbody",{children:Object.entries(g).map(([v,w])=>e("tr",{children:[e("th",{children:v}),e("td",{class:typeof w=="number"?"number":"",children:w})]}))})}):typeof g=="string"?g:JSON.stringify(g,null,2)})]}))})]}),e("hr",{}),e("p",{style:{textAlign:"center"},children:e(ge,{to:"/",children:e(h,{id:"iWpEwy"})})})]})}const br=20;function Zs(){const{_:n}=de();tt(n({id:"7Ff7ia"}),"/bookmarks");const{masto:i,instance:s}=ce(),o=q();async function c(r){return(r||!o.current)&&(o.current=i.v1.bookmarks.list({limit:br})),await o.current.next()}return e(At,{title:n({id:"7Ff7ia"}),id:"bookmarks",emptyText:n({id:"8k2w6G"}),errorText:n({id:"UoL+FC"}),instance:s,fetchItems:c})}const yr=""+new URL("catch-up-O5q5C75Z.png",import.meta.url).href,vr="home",ut=[{label:{id:"Ov9hfp"},value:1},{label:{id:"tVE2wM"},value:2},{label:{id:"8+HOWa"},value:3},{label:{id:"1o+mEC"},value:4},{label:{id:"dZZ8oA"},value:5},{label:{id:"lpPucp"},value:6},{label:{id:"r9r5X6"},value:7},{label:{id:"I9uBFA"},value:8},{label:{id:"pBYFlb"},value:9},{label:{id:"wvL7OJ"},value:10},{label:{id:"7Vb+qD"},value:11},{label:{id:"VU1Pnd"},value:12},{label:{id:"vpc27K"},value:13}],wr={original:{id:"HxF6Fk"},replies:{id:"N8UzTV"},boosts:{id:"puY2t0"},followedTags:{id:"lCLRBe"},groups:{id:"zhrjek"},filtered:{id:"03Qqf9"}},kr=["createdAt","repliesCount","favouritesCount","reblogsCount","density"],Sr=[null,"account"],_r=ys(n=>new Intl.DateTimeFormat(n||void 0,{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}));function Cr(){const{i18n:n,_:i,_:s}=de(),o=_r(n.locale);tt("Catch-up","/catchup");const{masto:c,instance:r}=ce(),[u,d]=yt(),l=u.get("id"),[a,p]=R("start"),[y,m]=R(!1),b=_e(()=>wt(),[]),f=$=>$===b,g=et("@pixelfed/home-include-reblogs");async function v({maxCreatedAt:$}){var K,Oe,Ae;const N=$?new Date($):null,W=[],j=c.v1.timelines.home.list({limit:40});e:for(;;)try{g&&j.nextParams&&(typeof j.nextParams=="string"?j.nextParams+="&include_reblogs=true":j.nextParams.include_reblogs=!0);const Ce=await j.next(),{value:Be}=Ce;if(Be!=null&&Be.length){await Ws(Be,r);let We=!1;for(let me=0;me<Be.length;me++){const Me=Be[me],Ze=new Date(Me.createdAt);if(!N||Ze>=N){const Ee=!f(((Oe=(K=Me.reblog)==null?void 0:K.account)==null?void 0:Oe.id)||Me.account.id)&&qt(((Ae=Me.reblog)==null?void 0:Ae.filtered)||Me.filtered,vr);if((Ee==null?void 0:Ee.action)==="hide")continue;Me._filtered=Ee;const Xe=rt(Me.id,r);Me._followedTags=x.statusFollowedTags[Xe]?[...x.statusFollowedTags[Xe]]:[],W.push(Me),We=!0}if(!We)break e}}else break e;await new Promise(We=>setTimeout(We,1e3))}catch{break e}return W.forEach(Ce=>{if(Ce!=null&&Ce.inReplyToId){const Be=W.find(We=>We.id===Ce.inReplyToId);Be&&!Be.inReplyToId&&(Be._thread=!0)}}),W}const[w,_]=R([]),S=q(),k=q(),T=_e(()=>Cn(),[]),C=ot(async({duration:$}={})=>{const N=Date.now(),W=$?N-$:null;p("loading");const j=await v({maxCreatedAt:W}),K=`${T}-${Go()}`;try{await mt.catchup.set(K,{id:K,posts:j,count:j.length,startAt:W,endAt:N}),d({id:K})}catch{}},[]);ie(()=>{l?(async()=>{const $=await mt.catchup.get(l);$&&($.posts.sort((N,W)=>N.createdAt>W.createdAt?1:-1),_($.posts),p("results"))})():a==="results"&&(_([]),p("start"))},[l]);const[I,E]=Rt($=>$+1,0),[L,B]=R(null),[P,Y]=R([]);ie(()=>{(async()=>{try{const $=await mt.catchup.keys();if($.length){const N=Cn(),W=$.filter(j=>j.startsWith(`${N}-`));if(W.length){let j=await mt.catchup.getMany(W);j.sort((Ce,Be)=>Be.endAt-Ce.endAt);let K=j.slice(0,3),Oe=j.slice(3);const Ae=K.map(Ce=>{const{id:Be,count:We,startAt:me,endAt:Me}=Ce;return{id:Be,count:We,startAt:me,endAt:Me}});Y(Ae),B(K[0].endAt),j=null,K=null,queueMicrotask(()=>{Oe.length&&mt.catchup.delMany(Oe.map(Ce=>Ce.id)).then(()=>{Oe=null}).catch(Ce=>{})});return}}}catch{}Y([])})()},[I]),ie(()=>{a==="start"&&E()},[a==="start"]);const[Q,te]=_e(()=>{var Be,We,me,Me,Ze,nt;let $=0,N=0,W=0,j=0,K=0,Oe=0;const Ae={};for(const Ee of w){Ee._filtered&&((Be=Ee._filtered)==null?void 0:Be.action)!=="blur"?($++,Ee.__FILTER="filtered"):Ee.group?(N++,Ee.__FILTER="groups"):Ee.reblog?(W++,Ee.__FILTER="boosts"):(We=Ee._followedTags)!=null&&We.length?(K++,Ee.__FILTER="followedTags"):Ee.inReplyToId&&Ee.inReplyToAccountId!==((me=Ee.account)==null?void 0:me.id)?(j++,Ee.__FILTER="replies"):(Oe++,Ee.__FILTER="original");const Xe=Ee.reblog||Ee;if(Ee.__FILTER!=="filtered"&&((Me=Xe.card)!=null&&Me.url)&&((Ze=Xe.card)!=null&&Ze.image)&&((nt=Xe.card)==null?void 0:nt.type)==="link"){const{card:dn,favouritesCount:$t,reblogsCount:Nt}=Xe;let{url:it}=dn;if(it=it.replace(/\/$/,""),!Ae[it])Ae[it]={postID:Xe.id,card:dn,shared:1,sharers:[Ee.account],likes:$t,boosts:Nt};else{if(Ae[it].sharers.find(On=>On.id===Ee.account.id))continue;Ae[it].shared++,Ae[it].sharers.push(Ee.account),Ae[it].postID!==Xe.id&&(Ae[it].likes+=$t,Ae[it].boosts+=Nt)}}}let Ce=[];for(const Ee in Ae)Ce.push({url:Ee,...Ae[Ee]});if(Ce.sort((Ee,Xe)=>Ee.shared>Xe.shared?-1:Ee.shared<Xe.shared?1:Ee.boosts>Xe.boosts?-1:Ee.boosts<Xe.boosts?1:Ee.likes>Xe.likes?-1:Ee.likes<Xe.likes?1:0),Ce.length>10)e:for(let Ee=10;Ee<Ce.length;Ee++){const{shared:Xe}=Ce[Ee];if(Xe<=1){Ce=Ce.slice(0,Ee);break e}}return[{filtered:$,groups:N,boosts:W,replies:j,followedTags:K,original:Oe},Ce]},[w]),[J,V]=R("all"),[z,ue]=R(null),[M,F]=R(1),[G,re]=R("createdAt"),[H,se]=R("asc"),[be,we]=R(null),[Z,le,Re]=_e(()=>{const $={},N=new Map;let W=w.filter(K=>{const Oe=J==="all"||K.__FILTER===J;return Oe&&($[K.account.id]=K.account,N.set(K.account.id,(N.get(K.account.id)||0)+1)),Oe});const j={};return W.forEach(K=>{K.reblog&&(j[K.reblog.id]?(j[K.reblog.id].__BOOSTERS?j[K.reblog.id].__BOOSTERS.add(K.account):j[K.reblog.id].__BOOSTERS=new Set([K.account]),K.__HIDDEN=!0):j[K.reblog.id]=K)}),z&&N.has(z)&&(W=W.filter(K=>K.account.id===z||[...K.__BOOSTERS||[]].find(Oe=>Oe.id===z))),[W,$,Object.fromEntries(N)]},[J,z,w]),$e=_e(()=>{const $={};return Z.forEach(N=>{$[N.id]=N}),$},[Z]),De=_e(()=>Object.keys(Re).sort(($,N)=>Re[N]-Re[$]),[Re]),ze=_e(()=>{const $={};return De.forEach((N,W)=>{$[N]=W}),Z.filter(N=>!N.__HIDDEN).sort((N,W)=>{if(be==="account"){const j=N.account.id,K=W.account.id,Oe=$[j],Ae=$[K],Ce=Oe-Ae;if(Ce!==0)return Ce}if(G!=="createdAt"&&(N=N.reblog||N,W=W.reblog||W,G!=="density"&&N[G]===W[G]))return N.createdAt>W.createdAt?1:-1;if(G==="density"){const j=es(N),K=es(W);return H==="asc"?j>K?1:-1:K>j?1:-1}return H==="asc"?N[G]>W[G]?1:-1:W[G]>N[G]?1:-1})},[Z,G,H,be,De]),Le=q(null),Te=q(null),X=q(!1);ie(()=>{w.length>100||X.current||Te.current&&(Os(Te.current,{duration:200}),X.current=!0)},[w,Te]);const ke=w.length>160?"3d":"2d",Ne=_e(()=>ke!=="2d"?null:w.map($=>{const N=$e[$.id];return e("span",{class:`post-dot ${N?"post-dot-highlight":""}`},$.id)}),[$e]),ne=_e(()=>ke!=="3d"||!(w!=null&&w.length)?null:Lr(w,"createdAt",320).map((N,W)=>e("div",{class:"posts-bin",children:N.map(j=>{const K=$e[j.id];return e("span",{class:`post-dot ${K?"post-dot-highlight":""}`},j.id)})},W)),[$e]),oe=q(null),xe=_e(()=>L?(Date.now()-L)/1e3/60/60:null,[L,M]);ie(()=>{if(a!=="results")return;const $=z&&le[z]?le[z].username:"",N=H==="asc"?0:1,W={account:"authors"};let j=pe({duration:5e3,text:s({id:"TLYeLT",values:{selectedFilterCategory:J,sortBy:G,sortOrder:H,groupBy:be}})});return()=>{var K;(K=j==null?void 0:j.hideToast)==null||K.call(j)}},[a,J,z,G,H,be,le]),ie(()=>{var $;if(z&&le[z]){const N=Te.current.querySelector(`[data-author="${z}"]`),W=($=Te.current)==null?void 0:$.getBoundingClientRect(),j=N==null?void 0:N.getBoundingClientRect();j.left<W.left||j.right>W.right?N.scrollIntoView({block:"nearest",inline:"center",behavior:"smooth"}):j.top<0&&N.scrollIntoView({block:"nearest",inline:"nearest",behavior:"smooth"})}},[z,le]);const[O,ee]=R(!1),fe=".catchup-list > li > a",D=Fe("j",()=>{const $=document.activeElement.closest(fe),N=$==null?void 0:$.getBoundingClientRect(),W=Array.from(oe.current.querySelectorAll(fe));if($&&N.top<oe.current.clientHeight&&N.bottom>0){const j=W.indexOf($),K=W[j+1];K&&(K.focus(),K.scrollIntoView({block:"center",inline:"center",behavior:"smooth"}))}else{const j=W.find(K=>K.getBoundingClientRect().top>=0);j&&(j.focus(),j.scrollIntoView({block:"nearest",inline:"center",behavior:"smooth"}))}},{useKey:!0,preventDefault:!0,ignoreModifiers:!0}),ae=Fe("k",()=>{const $=document.activeElement.closest(fe),N=$==null?void 0:$.getBoundingClientRect(),W=Array.from(oe.current.querySelectorAll(fe));if($&&N.top<oe.current.clientHeight&&N.bottom>0){const j=W.indexOf($);let K=W[j-1];K&&(K.focus(),K.scrollIntoView({block:"center",inline:"center",behavior:"smooth"}))}else{const j=W.find(K=>{const Oe=K.getBoundingClientRect();return Oe.top>=44&&Oe.left>=0});j&&(j.focus(),j.scrollIntoView({block:"nearest",inline:"center",behavior:"smooth"}))}},{useKey:!0,preventDefault:!0,ignoreModifiers:!0}),Ie=Fe("h, l",($,N)=>{var j,K,Oe;const W=N.keys[0];if(z){const Ae=De.indexOf(z);W==="h"?Ae>0&&Ae<De.length&&(ue(De[Ae-1]),(j=oe.current)==null||j.focus()):W==="l"&&Ae<De.length-1&&Ae>=0&&(ue(De[Ae+1]),(K=oe.current)==null||K.focus())}else W==="l"&&(ue(De[0]),(Oe=oe.current)==null||Oe.focus())},{useKey:!0,preventDefault:!0,ignoreModifiers:!0,enableOnFormTags:["input"]}),Se=Fe("esc",()=>{var $;ue(null),($=oe.current)==null||$.focus()},{preventDefault:!0,ignoreModifiers:!0,enableOnFormTags:["input"]}),Pe=Fe(".",()=>{var $;($=oe.current)==null||$.scrollTo({top:0,behavior:"smooth"})},{useKey:!0,preventDefault:!0,ignoreModifiers:!0,enableOnFormTags:["input"]}),je=ot($=>{const N=document.activeElement,W=(N==null?void 0:N.tagName)==="INPUT"&&N.type==="radio";if(($.key==="ArrowDown"||$.key==="ArrowUp"||$.key==="ArrowLeft"||$.key==="ArrowRight")&&W){N.blur();return}},[]);return e("div",{ref:$=>{oe.current=$,D.current=$,ae.current=$,Ie.current=$,Se.current=$,Pe.current=$},id:"catchup-page",class:"deck-container",tabIndex:"-1",children:[e("div",{class:"timeline-deck deck wide",children:[e("header",{class:`${a==="loading"?"loading":""}`,onClick:$=>{var N;$.target.closest("a, button")||(N=oe.current)==null||N.scrollTo({top:0,behavior:"smooth"})},children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Mt,{}),a==="results"&&e(ge,{to:"/catchup",class:"button plain",children:e(A,{icon:"history2",size:"l",alt:s({id:"xrl8fj"})})}),a==="start"&&e(ge,{to:"/",class:"button plain",children:e(A,{icon:"home",size:"l",alt:s({id:"i0qMbr"})})})]}),e("h1",{children:a!=="start"&&e(h,{id:"wyL/3/",components:{0:e("sup",{})}})}),e("div",{class:"header-side",children:a!=="start"&&a!=="loading"&&e("button",{type:"button",class:"plain",onClick:()=>{ee(!0)},children:e(h,{id:"c3XJ18"})})})]})}),e("main",{onKeyDown:je,children:[a==="start"&&e("div",{class:"catchup-start",children:[e("h1",{children:e(h,{id:"wyL/3/",components:{0:e("sup",{})}})}),e("details",{children:[e("summary",{children:e(h,{id:"CxKPv6"})}),e("p",{children:e(h,{id:"YMU1CK"})}),e("img",{src:yr,width:"1200",height:"900",alt:s({id:"CeInO2"})}),e("p",{children:e("button",{type:"button",onClick:$=>{$.target.closest("details").open=!1},children:e(h,{id:"2jI8hh"})})})]}),e("p",{children:e(h,{id:"1RfGk7"})}),e("p",{children:e("b",{children:e(h,{id:"OOEonE"})})}),e("div",{class:"catchup-form",children:[e("input",{ref:S,type:"range",value:M,min:ut[0].value,max:ut[ut.length-1].value,step:"1",list:"catchup-ranges",onChange:$=>F(+$.target.value)})," ",e("span",{style:{width:"8em"},children:[i(ut[M-1].label),e("br",{}),e("small",{class:"insignificant",children:M==ut[ut.length-1].value?s({id:"NMNiaO"}):ct(new Date(Date.now()-M*60*60*1e3))})]}),e("datalist",{id:"catchup-ranges",children:ut.map(({label:$,value:N})=>e("option",{value:N,label:i($)}))})," ",e("button",{type:"button",onClick:()=>{var $;if(M<ut[ut.length-1].value){let N;M===ut[ut.length-1].value&&(($=k.current)!=null&&$.checked)?N=Date.now()-L:N=M*60*60*1e3,C({duration:N})}else C()},children:e(h,{id:"R0yu2l"})})]}),xe&&M>xe?e("p",{class:"catchup-info",children:[e(A,{icon:"info"})," ",e(h,{id:"AGyV7s"})]}):M===ut[ut.length-1].value&&L?e("p",{class:"catchup-info",children:e("label",{children:[e("input",{type:"checkbox",switch:!0,checked:!0,ref:k})," ",e(h,{id:"dDJEHI",values:{0:o.format(new Date(L))}})]})}):null,e("p",{class:"insignificant",children:e("small",{children:e(h,{id:"EAjFM0"})})}),!!(P!=null&&P.length)&&e("div",{class:"catchup-prev",children:[e("p",{children:e(h,{id:"Yfb9A8"})}),e("ul",{children:P.map($=>e("li",{children:[e(ge,{to:`/catchup?id=${$.id}`,children:[e(A,{icon:"history2"})," ",e("span",{children:$.startAt?o.formatRange(new Date($.startAt),new Date($.endAt)):`… – ${o.format(new Date($.endAt))}`})]})," ",e("span",{children:[e("small",{class:"ib insignificant",children:e(h,{id:"S6XZwv",values:{0:$.count}})})," ",e("button",{type:"button",class:"light danger small",onClick:async()=>{var W;if(confirm(s({id:"D9CmP2"}))){let j=pe(s({id:"xJUo4P",values:{0:$.id}}));await mt.catchup.del($.id),(W=j==null?void 0:j.hideToast)==null||W.call(j),pe(s({id:"1dyGG/",values:{0:$.id}})),E()}},children:e(A,{icon:"x",alt:s({id:"t/YqKh"})})})]})]},$.id))}),P.length>=3&&e("p",{children:e("small",{children:e(h,{id:"sXmrl4"})})})]})]}),a==="loading"&&e("div",{class:"ui-state catchup-start",children:[e(Ue,{abrupt:!0}),e("p",{class:"insignificant",children:e(h,{id:"rbUTzD"})}),e("p",{class:"insignificant",children:e(h,{id:"q9urQO"})})]}),a==="results"&&e(U,{children:[e("div",{class:"catchup-header",children:[w.length>0&&e("p",{children:e("b",{class:"ib",children:o.formatRange(new Date(w[0].createdAt),new Date(w[w.length-1].createdAt))})}),e("aside",{children:[e("button",{hidden:J==="all"&&!z&&G==="createdAt"&&H==="asc",type:"button",class:"plain4 small",onClick:()=>{V("all"),ue(null),re("createdAt"),we(null),se("asc")},children:e(h,{id:"I9EnzM"})}),(te==null?void 0:te.length)>0&&e("button",{type:"button",class:"plain small",onClick:()=>m(!y),children:[e(h,{id:"EIZREX"})," ",e(A,{icon:"chevron-down",style:{transform:y?"rotate(180deg)":"rotate(0deg)"}})]})]})]}),e("div",{class:"shazam-container no-animation",hidden:!y,children:e("div",{class:"shazam-container-inner",children:e("div",{class:"catchup-top-links links-bar",children:te.map($=>{const{card:N,shared:W,sharers:j,likes:K,boosts:Oe}=$,{blurhash:Ae,title:Ce,description:Be,url:We,image:me,imageDescription:Me,language:Ze,width:nt,height:Ee,publishedAt:Xe}=N,dn=xs(We);let $t;if(Ae){const Nt=hi(Ae),it=_i(Nt);$t=Si([.6,it[1],it[2]])}return e("a",{href:We,target:"_blank",rel:"noopener",class:"link-block",style:$t?{"--accent-color":`rgb(${$t.join(",")})`,"--accent-alpha-color":`rgba(${$t.join(",")}, 0.4)`}:{},children:e("article",{children:[e("figure",{children:e("img",{src:me,alt:Me,width:nt,height:Ee,loading:"lazy"})}),e("div",{class:"article-body",children:[e("header",{children:[e("div",{class:"article-meta",children:[e("span",{class:"domain",children:dn})," ",!!Xe&&e(U,{children:"· "}),!!Xe&&e(U,{children:e(It,{datetime:Xe,format:"micro"})})]}),!!Ce&&e("h1",{class:"title",lang:Ze,dir:"auto",title:Ce,children:Ce})]}),!!Be&&e("p",{class:"description",lang:Ze,dir:"auto",title:Be,children:Be}),e("hr",{}),e("p",{style:{whiteSpace:"nowrap"},children:e(h,{id:"bfSr6z",values:{0:j.map(Nt=>{const{avatarStatic:it,displayName:On}=Nt;return e("button",{type:"button",class:"plain",style:{padding:0},onClick:Ti=>{Ti.preventDefault(),Ti.stopPropagation();const{id:go}=Nt;ue(go),V("all")},children:e(pt,{url:it,size:"s",alt:On})})})}})})]})]})},We)})})})}),w.length>=5&&(ke==="3d"?e("div",{class:"catchup-posts-viz-time-bar",children:ne}):e("div",{class:"catchup-posts-viz-bar",children:Ne})),w.length>=2&&e("div",{class:"catchup-filters",children:[e("label",{class:"filter-cat",children:[e("input",{type:"radio",name:"filter-cat",checked:J.toLowerCase()==="all",onChange:()=>{V("all")}}),e(h,{id:"N40H+G"})," ",e("span",{class:"count",children:w.length})]}),Object.entries(wr).map(([$,N])=>!!Q[$]&&e("label",{class:"filter-cat",title:(Q[$]/w.length*100).toFixed(2)+"%",children:[e("input",{type:"radio",name:"filter-cat",checked:J.toLowerCase()===$.toLowerCase(),onChange:()=>{V($),$==="boosts"&&(re("reblogsCount"),se("desc"),we(null))}}),i(N)," ",e("span",{class:"count",children:Q[$]})]},i(N)))]}),w.length>=2&&!!Re&&e("div",{class:"catchup-filters authors-filters",ref:Te,children:[De.map($=>e("label",{class:"filter-author","data-author":$,children:[e("input",{type:"radio",name:"filter-author",checked:z===$,onChange:()=>{ue($)},onClick:()=>{z===$&&ue(null)}}),e(pt,{url:le[$].avatarStatic||le[$].avatar,size:"xxl",alt:`${le[$].displayName} (@${le[$].acct})`})," ",e("span",{class:"count",children:Re[$]}),e("span",{class:"username",children:le[$].username})]},`${$}-${Re[$]}`)),De.length>5&&e("small",{style:{whiteSpace:"nowrap",paddingInline:"1em",opacity:.33},children:e(h,{id:"HHtYi7",values:{0:De.length}})},"authors-count")]}),w.length>=2&&e("div",{class:"catchup-filters",children:[e("span",{class:"filter-label",children:e(h,{id:"f6Hub0"})})," ",e("fieldset",{class:"radio-field-group",children:kr.map($=>e("label",{class:"filter-sort",onClick:N=>{G===$&&(N.preventDefault(),N.stopPropagation(),se(H==="asc"?"desc":"asc"))},children:[e("input",{type:"radio",name:"filter-sort-cat",checked:G===$,onChange:()=>{re($);const N=/(replies|favourites|reblogs)/.test($)?"desc":"asc";se(N)}}),{createdAt:s({id:"mYGY3B"}),repliesCount:s({id:"N8UzTV"}),favouritesCount:s({id:"zZOZj7"}),reblogsCount:s({id:"puY2t0"}),density:s({id:"0tQ7AD"})}[$],G===$&&(H==="asc"?" ↑":" ↓")]},$))}),e("span",{class:"filter-label",children:e(h,{id:"group.filter"})})," ",e("fieldset",{class:"radio-field-group",children:Sr.map($=>e("label",{class:"filter-group",children:[e("input",{type:"radio",name:"filter-group",checked:be===$,onChange:()=>{we($)},disabled:$==="account"&&z}),{account:s({id:"dpqPBg"})}[$]||s({id:"EdQY6l"})]},$||"none"))}),z&&De.length>1?e("button",{type:"button",class:"plain6 small",onClick:()=>{ue(null)},style:{whiteSpace:"nowrap"},children:e(h,{id:"/dlmrZ"})}):null]}),e("ul",{class:`catchup-list catchup-filter-${J||""} ${G?`catchup-sort-${G}`:""} ${z&&le[z]?"catchup-selected-author":""} ${be?`catchup-group-${be}`:""}`,children:ze.map(($,N)=>{var K;const W=((K=$.reblog)==null?void 0:K.id)||$.id;let j=!1;return be==="account"&&(Le.current&&$.account.id!==Le.current&&N>0&&(j=!0),Le.current=$.account.id),e(U,{children:[j&&e("li",{class:"separator"}),e(Ar,{to:`/${r}/s/${W}`,post:$,root:oe.current})]},`${$.id}-${j}`)})}),e("footer",{children:Z.length>5&&e("p",{children:[s(J==="boosts"?{id:"eVosYr"}:{id:"rhmyFK"})," ",e("button",{type:"button",class:"textual",onClick:()=>{oe.current.scrollTop=0},children:e(h,{id:"0MgdN+"})}),"."]})})]})]})]}),O&&e(He,{onClose:()=>ee(!1),children:e("div",{class:"sheet",id:"catchup-help-sheet",children:[e("button",{type:"button",class:"sheet-close",onClick:()=>ee(!1),children:e(A,{icon:"x",alt:s({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(h,{id:"c3XJ18"})})}),e("main",{children:e("dl",{children:[e("dt",{children:e(h,{id:"EIZREX"})}),e("dd",{children:e(h,{id:"YmGrIy"})}),e("dt",{children:e(h,{id:"coaNtr"})}),e("dd",{children:e(h,{id:"UUrqX1"})}),e("dt",{children:e(h,{id:"ScQBC/"})}),e("dd",{children:e(h,{id:"srocAr"})}),e("dt",{children:e(h,{id:"77Emn0"})}),e("dd",{children:e("table",{children:e("tbody",{children:[e("tr",{children:[e("td",{children:e(h,{id:"Gy9P9T"})}),e("td",{children:e("kbd",{children:"j"})})]}),e("tr",{children:[e("td",{children:e(h,{id:"6XYpYY"})}),e("td",{children:e("kbd",{children:"k"})})]}),e("tr",{children:[e("td",{children:e(h,{id:"f5dduh"})}),e("td",{children:e("kbd",{children:"l"})})]}),e("tr",{children:[e("td",{children:e(h,{id:"rj0vxZ"})}),e("td",{children:e("kbd",{children:"h"})})]}),e("tr",{children:[e("td",{children:e(h,{id:"jsFF8C"})}),e("td",{children:e("kbd",{children:"Enter"})})]}),e("tr",{children:[e("td",{children:e(h,{id:"bUUv3P"})}),e("td",{children:e("kbd",{children:"."})})]})]})})})]})})]})})]})}const Ir=dt(function({post:n}){const{id:i,account:s,group:o,reblog:c,inReplyToId:r,inReplyToAccountId:u,_followedTags:d,_filtered:l,visibility:a,__BOOSTERS:p}=n,y=r&&u!==s.id,m=!!l&&(l==null?void 0:l.action)!=="blur",b=f=>{f.shiftKey};return e("article",{class:`post-line ${o?"group":c?"reblog":d!=null&&d.length?"followed-tags":""} ${y?"reply-to":""} ${m?"filtered":""} visibility-${a}`,onMouseEnter:b,children:[e("span",{class:"post-author",children:c?e("span",{class:"post-reblog-avatar",children:[e(pt,{url:s.avatarStatic||s.avatar,squircle:s.bot}),(p==null?void 0:p.size)>0?[...p].map(f=>e(pt,{url:f.avatarStatic||f.avatar,squircle:f.bot})):""," ",e(A,{icon:"rocket"})," ",e(gt,{account:c.account,showAvatar:!0})]}):e(gt,{account:s,showAvatar:!0})}),e(Er,{post:c||n,filterInfo:l}),e("span",{class:"post-meta",children:[e(Rr,{post:c||n})," ",e(It,{datetime:new Date((c==null?void 0:c.createdAt)||n.createdAt),format:"micro"})]})]})},(n,i)=>{var s,o;return((s=n==null?void 0:n.post)==null?void 0:s.id)===((o=i==null?void 0:i.post)==null?void 0:o.id)}),Ar=({root:n,to:i,...s})=>{const o=q(),[c,r]=R(!1);return ie(()=>{const u=new IntersectionObserver(d=>{d[0].isIntersecting&&(queueMicrotask(()=>r(!0)),u.unobserve(o.current))},{root:n,rootMargin:`${Math.max(320,screen.height*.75)}px`});return o.current&&u.observe(o.current),()=>{o.current&&u.unobserve(o.current)}},[]),c?e("li",{children:e(ge,{to:i,children:e(Ir,{...s})})}):e("li",{ref:o,style:{height:"4em"}})},Tr=8,xr=8;function es(n){var l;const{spoilerText:i,content:s,poll:o,mediaAttachments:c,card:r}=n,u=(l=o==null?void 0:o.options)!=null&&l.length?o.options.reduce((a,p)=>a+p.title,""):"";return(i.length+Es(s)+u.length)/140+(c!=null&&c.length?Tr*c.length:r!=null&&r.image?xr:0)}const Tt=48;function Er({post:n,filterInfo:i}){var S;const{_:s}=de(),{spoilerText:o,sensitive:c,content:r,emojis:u,poll:d,mediaAttachments:l,card:a,inReplyToId:p,inReplyToAccountId:y,account:m,_thread:b}=n,f=p&&y===m.id||!!b,g=_e(()=>!!(ye.account.get("preferences")||{})["reading:expand:spoilers"],[]),v=g||!o&&!c&&(i==null?void 0:i.action)!=="blur",w=r?Ln(n):"",_=!o||g;return e("div",{class:"post-peek",title:o?"":w,children:[e("span",{class:"post-peek-content",children:[f&&!_&&e(U,{children:[e("span",{class:"post-peek-tag post-peek-thread",children:"Thread"})," "]}),i&&(i==null?void 0:i.action)!=="blur"?e("span",{class:"post-peek-filtered",children:i!=null&&i.titlesStr?s({id:"suKjh3",values:{0:i.titlesStr}}):s({id:"03Qqf9"})}):e(U,{children:[!!o&&e("span",{class:"post-peek-spoiler",children:[e(A,{icon:`${g?"eye-open":"eye-close"}`})," ",o]}),_&&e("div",{class:"post-peek-html",children:[f&&e(U,{children:[e("span",{class:"post-peek-tag post-peek-thread",children:e(h,{id:"e66y2Z"})})," "]}),!!r&&e("div",{dangerouslySetInnerHTML:{__html:Ko(r,u)}}),!!((S=d==null?void 0:d.options)!=null&&S.length)&&d.options.map(k=>e("div",{children:[d.multiple?"▪️":"•"," ",k.title]})),!r&&(l==null?void 0:l.length)===1&&l[0].description&&e(U,{children:[e("span",{class:"post-peek-tag post-peek-alt",children:"ALT"})," ",e("div",{children:l[0].description})]})]})]})]}),(!i||(i==null?void 0:i.action)==="blur")&&e("span",{class:"post-peek-post-content",children:[!!d&&e("span",{class:"post-peek-tag post-peek-poll",children:[e(A,{icon:"poll",size:"s"}),e(h,{id:"4WUbF1"})]}),l!=null&&l.length?l.map(k=>{var L,B,P,Y,Q,te,J,V,z,ue;const T=k.previewUrl||k.url,C=k.previewRemoteUrl||k.remoteUrl,I=(L=k.meta)!=null&&L.original?k.meta.original.width:((P=(B=k.meta)==null?void 0:B.small)==null?void 0:P.width)||((Q=(Y=k.meta)==null?void 0:Y.original)==null?void 0:Q.width),E=(te=k.meta)!=null&&te.original?k.meta.original.height:((V=(J=k.meta)==null?void 0:J.small)==null?void 0:V.height)||((ue=(z=k.meta)==null?void 0:z.original)==null?void 0:ue.height);return e("span",{class:"post-peek-media",children:{image:(T||C)&&v?e("img",{src:T,width:Tt,height:Tt,alt:k.description,loading:"lazy",onError:M=>{const{src:F}=M.target;F===T&&(M.target.src=C)},style:{"--anim-duration":`${Math.min(Math.max(Math.max(I,E)/100,5),120)}s`}}):e("span",{class:"post-peek-faux-media",children:"🖼"}),gifv:(T||C)&&v?e("img",{src:T,width:Tt,height:Tt,alt:k.description,loading:"lazy",onError:M=>{const{src:F}=M.target;F===T&&(M.target.src=C)}}):e("span",{class:"post-peek-faux-media",children:"🎞️"}),video:(T||C)&&v?e("img",{src:T,width:Tt,height:Tt,alt:k.description,loading:"lazy",onError:M=>{const{src:F}=M.target;F===T&&(M.target.src=C)}}):e("span",{class:"post-peek-faux-media",children:"📹"}),audio:e("span",{class:"post-peek-faux-media",children:"🎵"})}[k.type]||null},k.id)}):!!a&&a.image&&v&&e("span",{class:`post-peek-media post-peek-card card-${a.type||""}`,children:a.image?e("img",{src:a.image,width:Tt,height:Tt,alt:a.title||a.description||a.imageDescription,loading:"lazy",style:{"--anim-duration":a.width&&a.height&&`${Math.min(Math.max(Math.max(a.width,a.height)/100,5),120)}s`}}):e("span",{class:"post-peek-faux-media",children:"🔗"})})]})]})}function Rr({post:n}){const{_:i}=de(),{reblogsCount:s,repliesCount:o,favouritesCount:c}=n;return e("span",{class:"post-stats",children:[o>0&&e("span",{class:"post-stat-replies",children:[e(A,{icon:"comment2",size:"s",alt:i({id:"N8UzTV"})})," ",Je(o)]}),c>0&&e("span",{class:"post-stat-likes",children:[e(A,{icon:"heart",size:"s",alt:i({id:"zZOZj7"})})," ",Je(c)]}),s>0&&e("span",{class:"post-stat-boosts",children:[e(A,{icon:"rocket",size:"s",alt:i({id:"puY2t0"})})," ",Je(s)]})]})}function Lr(n,i,s){const o=n.map(l=>new Date(l[i])),c=o.reduce((l,a)=>a<l?a:l,o[0]),r=o.reduce((l,a)=>a>l?a:l,o[0]),u=Math.min(r.getTime(),Date.now())-c.getTime(),d=Array.from({length:s},()=>[]);return n.forEach(l=>{const a=new Date(l[i]);if(a.getTime()>Date.now())d[d.length-1].push(l);else{const p=(a.getTime()-c.getTime())/u,y=Math.floor(p*(s-1));d[y].push(l)}}),d}const Mr=20;function Xs(){const{_:n}=de();tt(n({id:"zZOZj7"}),"/favourites");const{masto:i,instance:s}=ce(),o=q();async function c(r){return(r||!o.current)&&(o.current=i.v1.favourites.list({limit:Mr})),await o.current.next()}return e(At,{title:n({id:"zZOZj7"}),id:"favourites",emptyText:n({id:"PHIrMr"}),errorText:n({id:"khVljG"}),instance:s,fetchItems:c})}const $r=["home","public","notifications","thread","account"],ts=["thread","account"],Nr={home:{id:"Buy2bt"},notifications:{id:"iDNBZe"},public:{id:"RO10dm"},thread:{id:"EnJuK0"},account:{id:"vrQQgz"}},Pr=[0,30*60,60*60,6*60*60,12*60*60,60*60*24,60*60*24*7,60*60*24*30],Kn={0:{id:"qqeAJM"},1800:st(30,"minute"),3600:st(1,"hour"),21600:st(6,"hour"),43200:st(12,"hour"),86400:st(24,"hour"),604800:st(7,"day"),2592e3:st(30,"day")};function Dr(){const{_:n}=de(),{masto:i}=ce();tt(n({id:"cSev+j"}),"/ft");const[s,o]=R("default"),[c,r]=R(!1),[u,d]=Rt(p=>p+1,0),[l,a]=R([]);return ie(()=>{o("loading"),(async()=>{try{const p=await i.v2.filters.list();p.sort((y,m)=>y.title.localeCompare(m.title)),p.forEach(y=>{var m;(m=y.keywords)!=null&&m.length&&y.keywords.sort((b,f)=>b.id-f.id)}),a(p),o("default")}catch{o("error")}})()},[u]),e("div",{id:"filters-page",class:"deck-container",tabIndex:"-1",children:[e("div",{class:"timeline-deck deck",children:[e("header",{children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Mt,{}),e(ge,{to:"/",class:"button plain",children:e(A,{icon:"home",size:"l",alt:n({id:"i0qMbr"})})})]}),e("h1",{children:e(h,{id:"cSev+j"})}),e("div",{class:"header-side",children:e("button",{type:"button",class:"plain",onClick:()=>{r(!0)},children:e(A,{icon:"plus",size:"l",alt:n({id:"yFfBdX"})})})})]})}),e("main",{children:l.length>0?e(U,{children:[e("ul",{class:"filters-list",children:l.map(p=>{const{id:y,title:m,expiresAt:b,keywords:f}=p;return e("li",{children:[e("div",{children:[e("h2",{children:m}),(f==null?void 0:f.length)>0&&e("div",{children:f.map(g=>e(U,{children:[e("span",{class:"tag collapsed insignificant",children:g.wholeWord?`“${g.keyword}”`:g.keyword})," "]}))}),e("small",{class:"insignificant",children:e(Js,{expiresAt:b})})]}),e("button",{type:"button",class:"plain",onClick:()=>{r({filter:p})},children:e(A,{icon:"pencil",size:"l",alt:"Edit filter"})})]},y)})}),l.length>1&&e("footer",{class:"ui-state",children:e("small",{class:"insignificant",children:e(h,{id:"5vzJxv",values:{0:l.length}})})})]}):s==="loading"?e("p",{class:"ui-state",children:e(Ue,{})}):s==="error"?e("p",{class:"ui-state",children:e(h,{id:"qcAUwp"})}):e("p",{class:"ui-state",children:e(h,{id:"cWIHTt"})})})]}),!!c&&e(He,{title:n({id:"vCSBPD"}),onClose:()=>{r(!1)},children:e(Ur,{filter:c==null?void 0:c.filter,onClose:p=>{p.state==="success"&&d(),r(!1)}})})]})}let Or=1;const zr=()=>Or++;function Ur({filter:n,onClose:i}){var E;const{_:s,_:o}=de(),{masto:c}=ce(),[r,u]=R("default"),d=!!n,{context:l,expiresAt:a,id:p,keywords:y,title:m,filterAction:b}=n||{},f=!!a,g=f&&new Date(a),[v,w]=R(y||[]),_=q(),[S,k]=R([]),[T,C]=R([]),I=v.filter(L=>!S.includes(L.id)&&!T.includes(L._id));return e("div",{class:"sheet",id:"filters-add-edit-modal",children:[!!i&&e("button",{type:"button",class:"sheet-close",onClick:i,children:e(A,{icon:"x",alt:o({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:o(d?{id:"3mOee6"}:{id:"yFfBdX"})})}),e("main",{children:e("form",{onSubmit:L=>{L.preventDefault();const B=new FormData(L.target),P=B.get("title"),Y=B.getAll("keyword_attributes[][id]"),Q=B.getAll("keyword_attributes[][keyword]"),te=[..._.current.querySelectorAll('input[name="keyword_attributes[][whole_word]"]')].map(M=>M.checked),J=Q.map((M,F)=>({id:Y[F]||void 0,keyword:M,wholeWord:te[F]}));d&&(S!=null&&S.length)&&S.forEach(M=>{J.push({id:M,_destroy:!0})});const V=B.getAll("context");let z=B.get("expires_in");const ue=B.get("filter_action");!P||!(V!=null&&V.length)||(u("loading"),(async()=>{try{let M;d?(z===""||z===null?f?z=Math.floor((g-new Date)/1e3):z=null:z==="0"||z===0?z=null:z=+z,M=await c.v2.filters.$select(p).update({title:P,context:V,expiresIn:z,keywordsAttributes:J,filterAction:ue})):(z=+z||null,M=await c.v2.filters.create({title:P,context:V,expiresIn:z,keywordsAttributes:J,filterAction:ue})),u("default"),i==null||i({state:"success",filter:M})}catch{u("error"),alert(o(d?{id:"H8RP+h"}:{id:"Fr0hAN"}))}})())},children:[e("div",{class:"filter-form-row",children:e("label",{children:[e("b",{children:e(h,{id:"MHrjPM"})}),e("input",{type:"text",name:"title",defaultValue:m,disabled:r==="loading",dir:"auto",required:!0})]})}),e("div",{class:"filter-form-keywords",ref:_,children:[I.length?e("ul",{class:"filter-keywords",children:I.map(L=>{const{id:B,keyword:P,wholeWord:Y,_id:Q}=L;return e("li",{children:[e("input",{type:"hidden",name:"keyword_attributes[][id]",value:B}),e("input",{name:"keyword_attributes[][keyword]",type:"text",defaultValue:P,disabled:r==="loading",required:!0,dir:"auto"}),e("div",{class:"filter-keyword-actions",children:[e("label",{children:[e("input",{name:"keyword_attributes[][whole_word]",type:"checkbox",value:B,defaultChecked:Y,disabled:r==="loading"})," ",e(h,{id:"/7UQ7y"})]}),e("button",{type:"button",class:"light danger small",disabled:r==="loading",onClick:()=>{B?(S.push(B),k([...S])):Q&&(T.push(Q),C([...T]))},children:e(A,{icon:"x",alt:o({id:"t/YqKh"})})})]})]},`${B}-${Q}`)})}):e("div",{class:"filter-keywords",children:e("div",{class:"insignificant",children:e(h,{id:"SYKm3p"})})}),e("footer",{class:"filter-keywords-footer",children:[e("button",{type:"button",class:"light",onClick:()=>{w([...v,{_id:zr(),keyword:"",wholeWord:!0}]),setTimeout(()=>{var B,P;const L=_.current.querySelectorAll('input[type="text"]');(P=(B=L[L.length-1])==null?void 0:B.focus)==null||P.call(B)},10)},children:e(h,{id:"qn5Dbn"})})," ",(I==null?void 0:I.length)>1&&e("small",{class:"insignificant",children:e(h,{id:"1JZ175",values:{0:I.length}})})]})]}),e("div",{class:"filter-form-cols",children:[e("div",{class:"filter-form-col",children:[e("div",{children:e("b",{children:e(h,{id:"uqf7Yq"})})}),$r.map(L=>e("div",{children:[e("label",{class:ts.includes(L)?"insignificant":"",children:[e("input",{type:"checkbox",name:"context",value:L,defaultChecked:l?l.includes(L):!0,disabled:r==="loading"})," ",s(Nr[L]),ts.includes(L)?"*":""]})," "]})),e("p",{children:e("small",{class:"insignificant",children:e(h,{id:"m0G499"})})})]}),e("div",{class:"filter-form-col",children:[d&&e(h,{id:"ucJk3m",components:{0:e("b",{}),1:e(Js,{expiresAt:a,showNeverExpires:!0})}}),e("div",{children:[e("label",{for:"filters-expires_in",children:o(d?{id:"BcNdg+"}:{id:"agO/T/"})}),e("select",{id:"filters-expires_in",name:"expires_in",disabled:r==="loading",defaultValue:d?void 0:0,children:[d&&e("option",{}),Pr.map(L=>e("option",{value:L,children:typeof Kn[L]=="function"?Kn[L]():s(Kn[L])}))]})]}),e("p",{children:[e(h,{id:"blQMpa"}),e("br",{}),((E=ps())==null?void 0:E.mastodon)>=5&&e("label",{class:"ib",children:[e("input",{type:"radio",name:"filter_action",value:"blur",defaultChecked:b==="blur",disabled:r==="loading"})," ",e(h,{id:"ggxOw9"})]})," ",e("label",{class:"ib",children:[e("input",{type:"radio",name:"filter_action",value:"warn",defaultChecked:b!=="hide"&&b!=="blur"||!d,disabled:r==="loading"})," ",e(h,{id:"jbreWy"})]})," ",e("label",{class:"ib",children:[e("input",{type:"radio",name:"filter_action",value:"hide",defaultChecked:b==="hide",disabled:r==="loading"})," ",e(h,{id:"zNCBmf"})]})]})]})]}),e("footer",{class:"filter-form-footer",children:[e("span",{children:[e("button",{type:"submit",disabled:r==="loading",children:o(d?{id:"tfDRzk"}:{id:"hYgDIe"})})," ",e(Ue,{abrupt:!0,hidden:r!=="loading"})]}),d&&e(ht,{disabled:r==="loading",align:"end",menuItemClassName:"danger",confirmLabel:o({id:"BPjyR2"}),onClick:()=>{u("loading"),(async()=>{try{await c.v2.filters.$select(p).remove(),u("default"),i==null||i({state:"success"})}catch{u("error"),alert(o({id:"4Dh9J1"}))}})()},children:e("button",{type:"button",class:"light danger",onClick:()=>{},disabled:r==="loading",children:e(h,{id:"Jb6/SB"})})})]})]})})]})}function Js({expiresAt:n,showNeverExpires:i}){const{_:s}=de(),o=!!n,c=o&&new Date(n),r=o&&c<=new Date,[u,d]=Rt(l=>l+1,0);return li(d,r||3e4),r?s({id:"M1RnFv"}):o?e(h,{id:"urGtsw",components:{0:e(It,{datetime:c})}}):i&&s({id:"O1Aswy"})}function Br(){const{_:n}=de(),{masto:i,instance:s}=ce();tt(n({id:"Xi1/bw"}),"/fh");const[o,c]=R("default"),[r,u]=R([]);return ie(()=>{c("loading"),(async()=>{try{const d=await xn();u(d),c("default")}catch{c("error")}})()},[]),e("div",{id:"followed-hashtags-page",class:"deck-container",tabIndex:"-1",children:e("div",{class:"timeline-deck deck",children:[e("header",{children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Mt,{}),e(ge,{to:"/",class:"button plain",children:e(A,{icon:"home",size:"l",alt:n({id:"i0qMbr"})})})]}),e("h1",{children:e(h,{id:"Xi1/bw"})}),e("div",{class:"header-side"})]})}),e("main",{children:r.length>0?e(U,{children:[e("ul",{class:"link-list",children:r.map(d=>e("li",{children:e(ge,{to:s?`/${s}/t/${d.name}`:`/t/${d.name}`,children:[e(A,{icon:"hashtag",alt:"#"})," ",e("span",{children:d.name})]})}))}),r.length>1&&e("footer",{class:"ui-state",children:e("small",{class:"insignificant",children:e(h,{id:"2S/uvJ",values:{0:r.length}})})})]}):o==="loading"?e("p",{class:"ui-state",children:e(Ue,{abrupt:!0})}):o==="error"?e("p",{class:"ui-state",children:e(h,{id:"2AeREO"})}):e("p",{class:"ui-state",children:e(h,{id:"vKsGhk"})})})]})})}const Fr=20;function Ii({title:n,path:i,id:s,...o}){const{_:c}=de();tt(n||c({id:"following.title"}),i||"/following");const{masto:r,streaming:u,instance:d}=ce(),l=Ge(x),a=q(),p=q();__BENCHMARK.end("time-to-following");const y=et("@pixelfed/home-include-reblogs");async function m(f){var w;(f||!a.current)&&(__BENCHMARK.start("fetch-home-first"),a.current=r.v1.timelines.home.list({limit:Fr})),y&&((w=a.current)!=null&&w.nextParams)&&(typeof a.current.nextParams=="string"?a.current.nextParams+="&include_reblogs=true":a.current.nextParams.include_reblogs=!0);const g=await a.current.next();let{value:v}=g;if(v!=null&&v.length){let _=!1;f&&(v[0].id!==p.current&&(_=!0),p.current=v[0].id),v.forEach(S=>{Qe(S,d)}),v=Xi(v,d),f&&_&&Qa(),Ws(v,d),v.sort((S,k)=>{const T=new Date(S.createdAt);return new Date(k.createdAt)-T})}return __BENCHMARK.end("fetch-home-first"),{...g,value:v}}async function b(){var f;try{const g={limit:5,since_id:p.current};et("@pixelfed/home-include-reblogs")&&(g.include_reblogs=!0);const v=await r.v1.timelines.home.list(g).next();let{value:w}=v;const _=((f=w[0])==null?void 0:f.id)===p.current;return!!(w!=null&&w.length&&!_&&(p.current=w[0].id,w=Xi(w,d),w=Ot(w,"home"),w.some(S=>!S.reblog)))}catch{return!1}}return ie(()=>{let f;return(async()=>{if(u){f=u.user.subscribe();for await(const g of f){if(!f)break;if(g.event==="status.update"){const v=g.payload;Qe(v,d)}else if(g.event==="delete"){const v=g.payload,w=vs(v,d);w&&(w._deleted=!0)}}}})(),()=>{var g;(g=f==null?void 0:f.unsubscribe)==null||g.call(f),f=null}},[u]),e(At,{title:n||c({id:"following.title"}),id:s||"following",emptyText:c({id:"nJEKbY"}),errorText:c({id:"7QSeK6"}),instance:d,fetchItems:m,checkForUpdates:b,useItemID:!0,boostsCarousel:l.settings.boostsCarousel,...o,filterContext:"home",showFollowedTags:!0,showReplyParent:!0})}const Hr=20,Yr=4,ns=Yr+1;function Qs({media:n,columnMode:i,...s}){const{_:o}=de();let{hashtag:c,...r}=i?{}:Lt();s.hashtag&&(c=s.hashtag);let u=c.trim().split(/[\s+]+/);u.sort(),c=u[0];const[d,l]=yt(),a=n||!!d.get("media"),p=a?"?media=1":"",{masto:y,instance:m,authenticated:b}=ce({instance:(s==null?void 0:s.instance)||r.instance}),{masto:f,instance:g,authenticated:v}=ce(),w=u.map(M=>`#${M}`).join(" "),_=o(m?a?{id:"kH0rA0",values:{hashtagTitle:w,instance:m}}:{id:"IK0zKi",values:{hashtagTitle:w,instance:m}}:a?{id:"hHSI3w",values:{hashtagTitle:w}}:{id:"+ZzjRY",values:{hashtagTitle:w}});tt(_,"/:instance?/t/:hashtag");const S=q(),k=_e(()=>ai(),[]),T=q(void 0);async function C(M){const F=await y.v1.timelines.tag.$select(c).list({limit:Hr,any:u.slice(1),maxId:M?void 0:T.current,onlyMedia:a?!0:void 0}).next();let{value:G}=F;return G!=null&&G.length&&(M&&(S.current=G[0].id),G.forEach(re=>{Qe(re,m,{skipThreading:a||k})}),T.current=G[G.length-1].id),{...F,value:G}}async function I(){var M;try{const F=await y.v1.timelines.tag.$select(c).list({limit:1,any:u.slice(1),since_id:S.current,onlyMedia:a}).next();let{value:G}=F;const re=((M=G[0])==null?void 0:M.id)===S.current;return G!=null&&G.length&&!re?(G=Ot(G,"public"),!0):!1}catch{return!1}}const[E,L]=R("default"),[B,P]=R();ie(()=>{(async()=>{try{const M=await y.v1.tags.$select(c).fetch();P(M)}catch{}})()},[c]);const Y=u.length>=ns,[Q,te]=R("default"),[J,V]=R([]),[z,ue]=R(!1);return ie(()=>{b&&(async()=>{try{const M=await y.v1.featuredTags.list();V(M),ue(M.some(F=>F.name.toLowerCase()===c.toLowerCase()))}catch{}})()},[]),e(At,{title:_,titleComponent:!!m&&e("h1",{class:"header-double-lines",children:[e("b",{dir:"auto",children:w}),e("div",{children:m})]}),id:"hashtag",instance:m,emptyText:o({id:"CNSLAW"}),errorText:o({id:"yjj6Ll"}),fetchItems:C,checkForUpdates:I,useItemID:!0,view:a||k?"media":void 0,refresh:a,filterContext:"public",headerEnd:e(lt,{portal:!0,setDownOverflow:!0,overflow:"auto",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(A,{icon:"more",size:"l",alt:o({id:"2FYpfJ"})})}),children:[!!B&&u.length===1&&e(U,{children:[e(ht,{subMenu:!0,confirm:B.following,confirmLabel:o({id:"ctJi7k",values:{hashtag:c}}),disabled:E==="loading"||!b,onClick:()=>{L("loading"),B.following?y.v1.tags.$select(c).unfollow().then(()=>{P({...B,following:!1}),pe(o({id:"doK/ij",values:{hashtag:c}}))}).catch(M=>{alert(M)}).finally(()=>{L("default")}):y.v1.tags.$select(c).follow().then(()=>{P({...B,following:!0}),pe(o({id:"R9+aEN",values:{hashtag:c}}))}).catch(M=>{alert(M)}).finally(()=>{L("default")})},children:B.following?e(U,{children:[e(A,{icon:"check-circle"})," ",e("span",{children:e(h,{id:"HOSk7R"})})]}):e(U,{children:[e(A,{icon:"plus"})," ",e("span",{children:e(h,{id:"MKEPCY"})})]})}),e(ve,{type:"checkbox",checked:z,disabled:Q==="loading"||!b,onClick:()=>{if(te("loading"),z){const M=J.find(F=>F.name.toLowerCase()===c.toLowerCase()).id;M?y.v1.featuredTags.$select(M).remove().then(()=>{ue(!1),pe(o({id:"VH+Tf9"})),V(J.filter(F=>F.id!==M))}).catch(F=>{}).finally(()=>{te("default")}):pe(o({id:"3OLv47"}))}else y.v1.featuredTags.create({name:c}).then(M=>{ue(!0),pe(o({id:"9ra4hn"})),V(J.concat(M))}).catch(M=>{}).finally(()=>{te("default")})},children:z?e(U,{children:[e(A,{icon:"check-circle"}),e("span",{children:e(h,{id:"9ra4hn"})})]}):e(U,{children:[e(A,{icon:"check-circle"}),e("span",{children:e(h,{id:"UlJ3QN"})})]})}),e(Ve,{})]}),!k&&e(U,{children:[e(Rs,{className:"plain",children:e(h,{id:"cSev+j"})}),e(ve,{type:"checkbox",checked:!!a,onClick:()=>{a?d.delete("media"):d.set("media","1"),l(d)},children:[e(A,{icon:"check-circle",alt:"☑️"})," ",e("span",{class:"menu-grow",children:e(h,{id:"eK4SL/"})})]}),e(Ve,{})]}),e(Vo,{className:"menu-field",disabled:Y,children:({ref:M})=>e("form",{onSubmit:F=>{var re,H;F.preventDefault();const G=(H=(re=F.target[0].value)==null?void 0:re.trim)==null?void 0:H.call(re);G&&!u.some(se=>se.toLowerCase()===G.toLowerCase())&&(u.push(G),u.sort(),location.hash=m?`/${m}/t/${u.join("+")}${p}`:`/t/${u.join("+")}${p}`)},children:[e(A,{icon:"hashtag"}),e("input",{ref:M,type:"text",placeholder:Y?he._({id:"ouWc/D",values:{TOTAL_TAGS_LIMIT:ns}}):o({id:"cxL5F9"}),required:!0,autocorrect:"off",autocapitalize:"off",spellCheck:!1,pattern:"[^#][^\\s#]+[^#]",disabled:Y,dir:"auto"})]})}),e(Wo,{takeOverflow:!0,children:u.map((M,F)=>e(ve,{disabled:u.length===1,onClick:G=>{u.splice(F,1),u.sort(),location.hash=m?`/${m}/t/${u.join("+")}${p}`:`/t/${u.join("+")}${p}`},children:[e(A,{icon:"x",alt:o({id:"OISAkj"}),class:"danger-icon"}),e("span",{class:"bidi-isolate",children:[e("span",{class:"more-insignificant",children:"#"}),M]})]},M))}),e(Ve,{}),e(ve,{disabled:!v,onClick:()=>{if(x.shortcuts.length>=_t){alert(he._({id:"XN1xAY",values:{SHORTCUTS_LIMIT:_t}}));return}const M={type:"hashtag",hashtag:u.join(" "),instance:m,media:a?"on":void 0};x.shortcuts.some(G=>G.type===M.type&&G.hashtag.split(/[\s+]+/).sort().join(" ")===M.hashtag.split(/[\s+]+/).sort().join(" ")&&(G.instance?G.instance===M.instance:!0)&&(G.media?!!G.media==!!M.media:!0))?alert(o({id:"kfeQnS"})):(x.shortcuts.push(M),pe(o({id:"MIhb91"})))},children:[e(A,{icon:"shortcut"})," ",e("span",{children:e(h,{id:"i02Lq/"})})]}),e(ve,{onClick:()=>{let M=prompt(o({id:"2MQ2cd"}));if(!/\./.test(M)){M&&alert(o({id:"7WddtO"}));return}M&&(M=M.toLowerCase().trim(),location.hash=`/${M}/t/${u.join("+")}${p}`)},children:[e(A,{icon:"bus"})," ",e("span",{children:e(h,{id:"Sq04Yc"})})]}),g!==m&&e(ve,{onClick:()=>{location.hash=`/${g}/t/${u.join("+")}${p}`},children:[e(A,{icon:"bus"})," ",e("small",{class:"menu-double-lines",children:e(h,{id:"iAzCp4",values:{currentInstance:g},components:{0:e("b",{})}})})]})]})},m+w)}const qr=20;function eo(n){var _;const{_:i}=de(),s=Ge(x),{masto:o,instance:c}=ce(),r=(n==null?void 0:n.id)||((_=Lt())==null?void 0:_.id),u=q(),d=q();async function l(S){(S||!d.current)&&(d.current=o.v1.timelines.list.$select(r).list({limit:qr}));const k=await d.current.next();let{value:T}=k;return T!=null&&T.length&&(S&&(u.current=T[0].id),T.forEach(C=>{Qe(C,c)})),{...k,value:T}}async function a(){var S;try{const k=await o.v1.timelines.list.$select(r).list({limit:1,since_id:u.current});let{value:T}=k;const C=((S=T[0])==null?void 0:S.id)===u.current;return T!=null&&T.length&&!C?(T=Ot(T,"home"),!0):!1}catch{return!1}}const[p,y]=R([]);ie(()=>{ln().then(y)},[]);const[m,b]=R({title:"List"});tt(m.title,"/l/:id"),ie(()=>{(async()=>{try{const S=await Fs(r);b(S)}catch{}})()},[r]);const[f,g]=R(!1),[v,w]=R(!1);return e(U,{children:[e(At,{title:m.title,id:"list",emptyText:i({id:"KkDhfU"}),errorText:i({id:"7QSeK6"}),instance:c,fetchItems:l,checkForUpdates:a,useItemID:!0,boostsCarousel:s.settings.boostsCarousel,filterContext:"home",showReplyParent:!0,headerStart:e(lt,{overflow:"auto",menuButton:e("button",{type:"button",class:"plain",children:[e(A,{icon:"list",size:"l",alt:i({id:"h16FyT"})}),e(A,{icon:"chevron-down",size:"s"})]}),children:[e(Ye,{to:"/l",children:e("span",{children:e(h,{id:"BHWx+g"})})}),(p==null?void 0:p.length)>0&&e(U,{children:[e(Ve,{}),p.map(S=>e(Ye,{to:`/l/${S.id}`,children:e("span",{children:S.title})},S.id))]})]}),headerEnd:e(lt,{portal:!0,setDownOverflow:!0,overflow:"auto",viewScroll:"close",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(A,{icon:"more",size:"l",alt:i({id:"2FYpfJ"})})}),children:[e(ve,{onClick:()=>g({list:m}),children:[e(A,{icon:"pencil",size:"l"}),e("span",{children:e(h,{id:"ePK91l"})})]}),e(ve,{onClick:()=>w(!0),children:[e(A,{icon:"group",size:"l"}),e("span",{children:e(h,{id:"hB02vO"})})]})]})},r),f&&e(He,{onClick:S=>{S.target===S.currentTarget&&g(!1)},children:e(ki,{list:f==null?void 0:f.list,onClose:S=>{S.state==="success"&&S.list?b(S.list):S.state==="deleted"&&(location.hash="/l"),g(!1)}})}),v&&e(He,{onClick:S=>{S.target===S.currentTarget&&w(!1)},children:e(Gr,{listID:r,onClose:()=>w(!1)})})]})}const jr=40;function Gr({listID:n,onClose:i}){const{_:s}=de(),{masto:o,instance:c}=ce(),[r,u]=R([]),[d,l]=R("default"),[a,p]=R(!1),y=q();async function m(b){p(!1),l("loading"),(async()=>{try{(b||!y.current)&&(y.current=o.v1.lists.$select(n).accounts.list({limit:jr}));const f=await y.current.next();let{done:g,value:v}=f;v!=null&&v.length?(u(b?v:r.concat(v)),p(!g)):p(!1),l("default")}catch{l("error")}})()}return ie(()=>{m(!0)},[]),e("div",{class:"sheet",id:"list-manage-members-container",children:[!!i&&e("button",{type:"button",class:"sheet-close",onClick:i,children:e(A,{icon:"x",alt:s({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(h,{id:"hB02vO"})})}),e("main",{children:e("ul",{children:[r.map(b=>e("li",{children:[e(ft,{account:b,instance:c}),e(Kr,{account:b,listID:n})]},b.id)),a&&d==="default"&&e(Ct,{as:"li",onChange:b=>b&&m(),children:e("button",{type:"button",class:"light block",onClick:m,children:e(h,{id:"uXRAkV"})})})]})})]})}function Kr({account:n,listID:i}){const{_:s}=de(),{masto:o}=ce(),[c,r]=R("default"),[u,d]=R(!1);return e(ht,{confirm:!u,confirmLabel:e("span",{children:e(h,{id:"j5n9Ry",values:{0:n.username},components:{0:e("span",{class:"bidi-isolate"})}})}),align:"end",menuItemClassName:"danger",onClick:()=>{u?(r("loading"),(async()=>{try{await o.v1.lists.$select(i).accounts.create({accountIds:[n.id]}),r("default"),d(!1)}catch{r("error")}})()):(r("loading"),(async()=>{try{await o.v1.lists.$select(i).accounts.remove({accountIds:[n.id]}),r("default"),d(!0)}catch{r("error")}})())},children:e("button",{type:"button",class:`light ${u?"":"danger"}`,disabled:c==="loading",children:s(u?{id:"m16xKo"}:{id:"MWIaew"})})})}const Vr={mention:["account","status"],status:["account","status"],reblog:["account","status"],follow:["account"],follow_request:["account"],favourite:["account","status"],poll:["status"],update:["status"]},Wr=["favourite","reblog","follow"],to=n=>Wr.includes(n);function no(n){return n.filter(i=>{const{type:s,id:o,createdAt:c}=i;if(!s)return!1;const r=Vr[s];return r!=null&&r.length?r.every(u=>!!i[u]):!0})}function io(n){if(n!=null&&n.notificationGroups){const{accounts:i=[],notificationGroups:s=[],statuses:o=[]}=n;return s.map(c=>{const{sampleAccountIds:r,statusId:u}=c,d=(r==null?void 0:r.map(a=>i.find(p=>p.id===a)))||[],l=(o==null?void 0:o.find(a=>a.id===u))||null;return{...c,sampleAccounts:d,status:l}})}return n}function Zr(n){const i=n.map(u=>{const{latestPageNotificationAt:d,mostRecentNotificationId:l,sampleAccounts:a,notificationsCount:p}=u;return{id:""+l,createdAt:d,account:a[0],...u}}),s={},o=[];for(let u=0;u<i.length;u++){const d=i[u],{type:l,status:a,createdAt:p,notificationsCount:y,sampleAccounts:m,groupKey:b}=d,f=p?new Date(p).toLocaleDateString():"";let g=l;y>0&&(m==null||m.length),(l==="favourite"||l==="reblog")&&(g="favourite+reblog");const v=`${a==null?void 0:a.id}-${g}-${f}`,w=s[v];if(!to(l))o.push(d);else if(w)m.forEach(_=>{const S=w.sampleAccounts.find(k=>k.id===_.id);S?(S._types.push(l),S._types.sort().reverse()):w.sampleAccounts.push({..._,_types:[l]})}),w.notificationsCount=Math.min(w.notificationsCount,y),w._notificationsCount.push(y),w._accounts=w.sampleAccounts,w._groupKeys.push(b);else{const _=m.map(S=>({...S,_types:[l]}));s[v]={...d,sampleAccounts:_,type:g,_accounts:_,_groupKeys:b?[b]:[],_notificationsCount:[y]},o.push(s[v])}}const c={},r=[];for(let u=0;u<o.length;u++){const d=o[u],{type:l,account:a,_accounts:p,sampleAccounts:y,createdAt:m,groupKey:b}=d,f=m?new Date(m).toLocaleDateString():"",g=(y==null?void 0:y.length)===1||(p==null?void 0:p.length)===1;if((l==="favourite"||l==="reblog"||l==="favourite+reblog")&&g){const v=`${a==null?void 0:a.id}-${l}-${f}`,w=c[v];if(w)w._statuses.push(d.status),w._ids+=`-${d.id}`,w._groupKeys.push(b);else{let _=c[v]={...d,type:l,_ids:d.id,_statuses:[d.status],_groupKeys:b?[b]:[]};r.push(_)}}else r.push(d)}return r}function Xr(n){n=no(n);const i={},s=[];for(let r=0,u=0;r<n.length;r++){const d=n[r],{id:l,status:a,account:p,type:y,createdAt:m}=d,b=m?new Date(m).toLocaleDateString():"";let f=y;(y==="favourite"||y==="reblog")&&(f="favourite+reblog");const g=`${a==null?void 0:a.id}-${f}-${b}`,v=i[g];if(!to(y))s[u++]=d;else if(v!=null&&v.account){const w=v._accounts.find(_=>_.id===p.id);w?(w._types.push(y),w._types.sort().reverse(),v._ids+=`-${l}`):(p._types=[y],v._accounts.push(p),v._ids+=`-${l}`)}else{p&&(p._types=[y]);let w=i[g]={...d,type:f,_ids:l,_accounts:p?[p]:[]};s[u++]=w}}const o={},c=[];for(let r=0,u=0;r<s.length;r++){const d=s[r],{id:l,account:a,_accounts:p,type:y,createdAt:m}=d,b=m?new Date(m).toLocaleDateString():"";if(y==="favourite+reblog"&&a&&p.length===1){const f=`${a==null?void 0:a.id}-${y}-${b}`,g=o[f];if(g)g._statuses.push(d.status),g._ids+=`-${l}`;else{let v=o[f]={...d,type:y,_ids:l,_statuses:[d.status]};c[u++]=v}}else c[u++]=d}return c}const is=20,Jr=new URLSearchParams;function so({columnMode:n,...i}){const{_:s}=de(),{masto:o,instance:c}=ce(),[r]=n?[Jr]:yt(),[u,d]=R(null),l=(i==null?void 0:i.type)||r.get("type")||u;tt(s(l==="private"?{id:"2BApYc"}:{id:"/bZzdR"}),"/mentions");const a=q(),p=q();async function y(_){(_||!a.current)&&(a.current=o.v1.notifications.list({limit:is,types:["mention"]}));const S=await a.current.next();let{value:k}=S;return k!=null&&k.length&&(k=no(k),_&&(p.current=k[0].id),k.forEach(({status:T})=>{Qe(T,c)})),{...S,value:k==null?void 0:k.map(T=>T.status)}}const m=q(),b=q();async function f(_){(_||!m.current)&&(m.current=o.v1.conversations.list({limit:is}));const S=await m.current.next();let{value:k}=S;return k=k==null?void 0:k.filter(T=>T.lastStatus),k!=null&&k.length&&(_&&(b.current=k[0].lastStatus.id),k.forEach(({lastStatus:T})=>{Qe(T,c)})),{...S,value:k==null?void 0:k.map(T=>T.lastStatus)}}function g(..._){return l==="private"?f(..._):y(..._)}async function v(){var _;if(l==="private")try{const S=await o.v1.conversations.list({limit:1,since_id:b.current}).next();let{value:k}=S;const T=((_=k[0])==null?void 0:_.id)===b.current;return k!=null&&k.length&&!T?(b.current=k[0].lastStatus.id,!0):!1}catch{return!1}else try{const S=await o.v1.notifications.list({limit:1,types:["mention"],since_id:p.current}).next();let{value:k}=S;return k!=null&&k.length?(p.current=k[0].id,!0):!1}catch{return!1}}const w=_e(()=>e("div",{class:"filter-bar centered",children:[e(ge,{to:"/mentions",class:l?"":"is-active",onClick:_=>{n&&(_.preventDefault(),d(null))},children:e(h,{id:"N40H+G"})}),e(ge,{to:"/mentions?type=private",class:l==="private"?"is-active":"",onClick:_=>{n&&(_.preventDefault(),d("private"))},children:e(h,{id:"zwBp5t"})})]}),[l]);return e(At,{title:s({id:"/bZzdR"}),id:"mentions",emptyText:s({id:"03jFGT"}),errorText:s({id:"pqR9KF"}),instance:c,fetchItems:g,checkForUpdates:v,useItemID:!0,timelineStart:w,refresh:l,filterContext:"notifications"})}const Qr=80,el=20,tl=new URLSearchParams,hn={block:"center",inline:"center",behavior:"smooth"},oo=ys(()=>et("@mastodon/grouped-notifications"),{maxAge:1e3*60*5});function ni(n={}){const{masto:i}=ce();return x.settings.groupedNotificationsAlpha&&oo()?i.v2.notifications.list({limit:el,...n}):i.v1.notifications.list({limit:Qr,...n})}function co(n){return x.settings.groupedNotificationsAlpha&&oo()?Zr(n):Xr(n)}const nl=["forNotFollowing","forNotFollowers","forNewAccounts","forPrivateMentions","forLimitedAccounts"],il={forNotFollowing:{id:"d+hDoa"},forNotFollowers:{id:"oAwuQj"},forNewAccounts:{id:"Srs8u7"},forPrivateMentions:{id:"IDC5Uw"},forLimitedAccounts:{id:"XMGM2e"}};function sl({columnMode:n}){var fe;const{_:i,_:s}=de();tt(s({id:"iDNBZe"}),"/notifications");const{masto:o,instance:c}=ce(),r=Ge(x),[u,d]=R("default"),[l]=n?[tl]:yt(),a=l.get("id"),p=l.get("access_token"),[y,m]=R(!1),[b,f]=R(!1),g=q(),{nearReachEnd:v,scrollDirection:w,reachStart:_,nearReachStart:S}=er({scrollableRef:g}),k=w==="end"&&!S,[T,C]=R([]),[I,E]=R([]),L=q();async function B(D){var Se;if((D||!L.current)&&(L.current=ni({excludeTypes:["follow_request"]})),/max_id=($|&)/i.test((Se=L.current)==null?void 0:Se.nextParams))return{done:!0};const ae=await L.current.next(),Ie=io(ae.value);if(Ie!=null&&Ie.length){Ie.forEach(je=>{Qe(je.status,c,{skipThreading:!0})});const Pe=co(Ie);D?(x.notificationsLast=Pe[0],x.notifications=Pe,o.v1.markers.create({notifications:{lastReadId:Pe[0].id}}).catch(()=>{})):x.notifications.push(...Pe)}return x.notificationsShowNew=!1,x.notificationsLastFetchTime=Date.now(),ae}async function P(){try{return await o.v1.followRequests.list({limit:80})}catch{return[]}}const Y=()=>{d("loading"),(async()=>{try{const D=await P();C(D),d("default")}catch{d("error")}})()};async function Q(){try{return await o.v1.announcements.list()}catch{return[]}}const te=et("@mastodon/filtered-notifications"),[J,V]=R(!1),[z,ue]=R({});function M(){return o.v2.notifications.policy.fetch().catch(()=>{})}function F(){M().then(D=>{ue(D)}).catch(()=>{})}const[G,re]=R(null);function H(){return o.v1.notifications.requests.list()}const se=D=>{we(!1),d("loading"),(async()=>{try{const ae=B(D);D&&(Q().then(Se=>{Se.sort((Pe,je)=>{const $=new Date(Pe.updatedAt||Pe.createdAt);return new Date(je.updatedAt||je.createdAt)-$}),E(Se)}).catch(()=>{}),P().then(Se=>{C(Se)}).catch(()=>{}),te&&F());const{done:Ie}=await ae;m(!Ie),d("default")}catch{d("error")}})()};ie(()=>{se(!0)},[]),ie(()=>{_&&se(!0)},[_]);const[be,we]=R(!1),Z=ot(({disableIdleCheck:D=!1}={})=>{var ae;u!=="loading"&&r.settings.autoRefresh&&((ae=g.current)==null?void 0:ae.scrollTop)<16&&(D||window.__IDLE__)&&!ol()&&se(!0)},[r.notificationsShowNew,r.settings.autoRefresh,u]),le=q();jt(D=>{if(D){const ae=Date.now()-le.current;!le.current||ae>1e3*3?Z({disableIdleCheck:!0}):le.current=Date.now()}});const Re=q(!0);ie(()=>{let D=To(x,"notificationsShowNew",ae=>{if(Re.current){Re.current=!1;return}u!=="loading"&&(ae&&Z(),we(ae))});return()=>D==null?void 0:D()},[]);const $e=new Date,De=new Date($e-24*60*60*1e3);let ze=new Date;const Le=!r.notifications.some(D=>new Date(D.createdAt).toDateString()===$e.toDateString()),Te=q();ie(()=>{a&&(x.routeNotification={id:a,accessToken:atob(p)})},[a,p]);const[X,ke]=R(null);ie(async()=>{var Se,Pe,je;const D=new Date;if(D.getMonth()!==11||!et("@mastodon/annual-report"))return;let ae=ye.account.get("annualReportNotification");if(ae){ke(ae);return}const Ie=ni({types:["annual_report"]});try{const $=await Ie.next();ae=(Pe=(Se=$==null?void 0:$.value)==null?void 0:Se.notificationGroups)==null?void 0:Pe[0],((je=ae==null?void 0:ae.annualReport)==null?void 0:je.year)==D.getFullYear()&&(ke(ae),ye.account.set("annualReportNotification",ae))}catch{}},[]);const Ne=".notification",ne=Fe("j",()=>{const D=document.activeElement.closest(Ne),ae=D==null?void 0:D.getBoundingClientRect(),Ie=Array.from(g.current.querySelectorAll(Ne));if(D&&ae.top<g.current.clientHeight&&ae.bottom>0){const Se=Ie.indexOf(D);let Pe=Ie[Se+1];Pe&&(Pe.focus(),Pe.scrollIntoView(hn))}else{const Se=Ie.find(Pe=>{const je=Pe.getBoundingClientRect();return je.top>=44&&je.left>=0});Se&&(Se.focus(),Se.scrollIntoView(hn))}},{useKey:!0}),oe=Fe("k",()=>{const D=document.activeElement.closest(Ne),ae=D==null?void 0:D.getBoundingClientRect(),Ie=Array.from(g.current.querySelectorAll(Ne));if(D&&ae.top<g.current.clientHeight&&ae.bottom>0){const Se=Ie.indexOf(D);let Pe=Ie[Se-1];Pe&&(Pe.focus(),Pe.scrollIntoView(hn))}else{const Se=Ie.find(Pe=>{const je=Pe.getBoundingClientRect();return je.top>=44&&je.left>=0});Se&&(Se.focus(),Se.scrollIntoView(hn))}},{useKey:!0}),xe=Fe(["enter","o"],()=>{const D=document.activeElement.closest(Ne),ae=D==null?void 0:D.querySelector(".status-link");ae&&ae.click()},{useKey:!0}),O=new Date,ee=_e(()=>ct(O,{forceOpts:{weekday:"long"}}),[O]);return e("div",{id:"notifications-page",class:"deck-container",ref:D=>{g.current=D,ne.current=D,oe.current=D,xe.current=D},tabIndex:"-1",children:[e("div",{class:`timeline-deck deck ${b?"only-mentions":""}`,children:[e("header",{hidden:k,onClick:D=>{var ae;D.target.closest("a, button")||(ae=g.current)==null||ae.scrollTo({top:0,behavior:"smooth"})},onDblClick:D=>{D.target.closest("a, button")||se(!0)},class:u==="loading"?"loading":"",children:[e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Mt,{}),e(ge,{to:"/",class:"button plain",children:e(A,{icon:"home",size:"l",alt:s({id:"i0qMbr"})})})]}),e("h1",{children:e(h,{id:"iDNBZe"})}),e("div",{class:"header-side",children:te&&e("button",{type:"button",class:"button plain4",onClick:()=>{V(!0)},children:e(A,{icon:"settings",size:"l",alt:s({id:"a/+arl"})})})})]}),be&&u!=="loading"&&e("button",{class:"updates-button shiny-pill",type:"button",onClick:()=>{var D;se(!0),(D=g.current)==null||D.scrollTo({top:0,behavior:"smooth"})},children:[e(A,{icon:"arrow-up"})," ",e(h,{id:"Jy9RU/"})]})]}),I.length>0&&e("div",{class:"shazam-container",children:e("div",{class:"shazam-container-inner",children:e("details",{class:"announcements",children:[e("summary",{children:[e("span",{children:[e(A,{icon:"announce",class:"announcement-icon",size:"l"})," ",e(h,{id:"0whvLM",values:{0:I.length}})," ",e("small",{class:"insignificant",children:c})]}),I.length>1&&e("span",{class:"announcements-nav-buttons",children:I.map((D,ae)=>e("button",{type:"button",class:"plain2 small",onClick:()=>{var Ie;(Ie=Te.current)==null||Ie.children[ae].scrollIntoView({behavior:"smooth",block:"nearest"})},children:ae+1}))})]}),e("ul",{class:`announcements-list-${I.length>1?"multiple":"single"}`,ref:Te,children:I.map(D=>e("li",{children:e(cl,{announcement:D})}))})]})})}),T.length>0&&e("div",{class:"follow-requests",children:[e("h2",{class:"timeline-header",children:e(h,{id:"6Fs1Ba"})}),T.length>5?e("details",{children:[e("summary",{children:e(h,{id:"7dHKu4",values:{0:T.length}})}),e("ul",{children:T.map(D=>e("li",{children:[e(ft,{account:D}),e(ti,{accountID:D.id,onChange:()=>{}})]},D.id))})]}):e("ul",{children:T.map(D=>e("li",{children:[e(ft,{account:D}),e(ti,{accountID:D.id,onChange:()=>{}})]},D.id))})]}),te&&((fe=z==null?void 0:z.summary)==null?void 0:fe.pendingRequestsCount)>0&&e("div",{class:"shazam-container",children:e("div",{class:"shazam-container-inner",children:e("div",{class:"filtered-notifications",children:e("details",{onToggle:async D=>{const{open:ae}=D.target;if(ae){const Ie=await H();re(Ie)}},children:[e("summary",{children:e(h,{id:"N3Bq0f",values:{0:z.summary.pendingRequestsCount}})}),G?(G==null?void 0:G.length)>0&&e("ul",{children:G.map(D=>{var ae,Ie;return e("li",{children:[e("div",{class:"request-notifcations",children:[!((ae=D.lastStatus)!=null&&ae.id)&&e(ft,{useAvatarStatic:!0,showStats:!0,account:D.account}),((Ie=D.lastStatus)==null?void 0:Ie.id)&&e("div",{class:"last-post",children:e(ge,{class:"status-link",to:`/${c}/s/${D.lastStatus.id}`,children:e(qe,{status:D.lastStatus,size:"s",readOnly:!0})})}),e(rl,{request:D})]}),e(ll,{request:D,onChange:()=>{se(!0)}})]},D.id)})}):e("p",{class:"ui-state",children:e(Ue,{abrupt:!0})})]})})})}),X&&e("div",{class:"shazam-container",children:e("div",{class:"shazam-container-inner",children:e(cn,{notification:X})})}),e("div",{id:"mentions-option",children:e("label",{children:[e("input",{type:"checkbox",checked:b,onChange:D=>{f(D.target.checked)}})," ",e(h,{id:"0udtPI"})]})}),e("h2",{class:"timeline-header",children:[e(h,{id:"ecUA8p"})," ",e("small",{class:"insignificant bidi-isolate",children:ee})]}),Le&&e("p",{class:"ui-state insignificant",children:u==="default"?s({id:"KS7iJH"}):e(U,{children:"…"})}),r.notifications.length?e(Mn.Provider,{value:"notifications",children:r.notifications.filter(D=>D.type!=="follow_request").map(D=>{if(b&&D.type!=="mention")return null;const ae=new Date(D.createdAt),Ie=ae.toDateString()!==ze.toDateString();Ie&&(ze=ae);const Se=ae.toDateString()===De.toDateString()?s({id:"y/0uwd"}):ct(ze,{hideTime:!0}),Pe=ct(ze,{forceOpts:{weekday:"long"}});return e(U,{children:[Ie&&e("h2",{class:"timeline-header",children:[e("span",{children:Se})," ",e("small",{class:"insignificant bidi-isolate",children:Pe})]}),e(cn,{instance:c,notification:D},D._ids||D.id)]},D._ids||D.id)})}):e(U,{children:[u==="loading"&&e(U,{children:e("ul",{class:"timeline flat",children:Array.from({length:5}).map((D,ae)=>e("li",{class:"notification skeleton",children:[e("div",{class:"notification-type",children:e(A,{icon:"notification",size:"xl"})}),e("div",{class:"notification-content",children:e("p",{children:"███████████ ████"})})]}))})}),u==="error"&&e("p",{class:"ui-state",children:[e(h,{id:"gjzl8E"}),e("br",{}),e("br",{}),e("button",{type:"button",onClick:()=>se(!0),children:e(h,{id:"KDw4GX"})})]})]}),y&&e(Ct,{onChange:D=>{D&&se()},children:e("button",{type:"button",class:"plain block",disabled:u==="loading",onClick:()=>se(),style:{marginBlockEnd:"6em"},children:u==="loading"?e(Ue,{abrupt:!0}):e(h,{id:"uXRAkV"})})})]}),te&&J&&e(He,{onClick:D=>{D.target===D.currentTarget&&V(!1)},children:e("div",{class:"sheet",id:"notifications-settings",tabIndex:"-1",children:[e("button",{type:"button",class:"sheet-close",onClick:()=>V(!1),children:e(A,{icon:"x",alt:s({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(h,{id:"a/+arl"})})}),e("main",{children:e("form",{onSubmit:D=>{D.preventDefault();const{forNotFollowing:ae,forNotFollowers:Ie,forNewAccounts:Se,forPrivateMentions:Pe,forLimitedAccounts:je}=D.target,$={...z,forNotFollowing:ae.value,forNotFollowers:Ie.value,forNewAccounts:Se.value,forPrivateMentions:Pe.value,forLimitedAccounts:je.value};ue($),V(!1),(async()=>{try{await o.v2.notifications.policy.update($),pe(s({id:"4+7X9i"}))}catch{}})()},children:[e("p",{children:e(h,{id:"WrkPTf"})}),e("div",{class:"notification-policy-fields",children:nl.map(D=>{const ae=z[D];return e("div",{children:e("label",{children:[i(il[D]),e("select",{name:D,defaultValue:ae,class:"small",children:[e("option",{value:"accept",children:e(h,{id:"g3UF2V"})}),e("option",{value:"filter",children:e(h,{id:"o7J4JM"})}),e("option",{value:"drop",children:e(h,{id:"gbbkE7"})})]})]})},D)})}),e("p",{children:e("button",{type:"submit",children:e(h,{id:"tfDRzk"})})})]})})]})})]})}function ol(){return!!document.querySelector(".deck-backdrop, #modal-container > *")}function cl({announcement:n}){const{instance:i}=ce(),{contact:s}=ms(),o=s==null?void 0:s.account,{id:c,content:r,startsAt:u,endsAt:d,published:l,allDay:a,publishedAt:p,updatedAt:y,read:m,mentions:b,statuses:f,tags:g,emojis:v,reactions:w}=n,_=new Date(p),S=ct(_),k=new Date(y),T=ct(k);return e("div",{class:"announcement-block",children:[e(ft,{account:o}),e("div",{class:"announcement-content",onClick:Cs({mentions:b,instance:i}),dangerouslySetInnerHTML:{__html:Zn(r,{emojis:v})}}),e("p",{class:"insignificant",children:[e("time",{datetime:_.toISOString(),children:ct(_)}),y&&T!==S&&e(U,{children:[" ","•"," ",e("span",{class:"ib",children:e(h,{id:"TbFrLc",values:{0:ct(k)},components:{0:e("time",{datetime:k.toISOString()})}})})]})]}),e("div",{class:"announcement-reactions",hidden:!0,children:w.map(C=>{const{name:I,count:E,me:L,staticUrl:B,url:P}=C;return e("button",{type:"button",class:`plain4 small ${L?"reacted":""}`,children:[P||B?e("img",{src:P||B,alt:I,width:"16",height:"16"}):e("span",{children:I})," ",e("span",{class:"count",children:Je(E)})]})})})]})}function al(n){const{masto:i}=ce();return i.v1.notifications.list({accountID:n})}function rl({request:n}){var y;const{instance:i}=ce(),[s,o]=R("loading"),{account:c,lastStatus:r}=n,[u,d]=R(!1),[l,a]=R([]);function p(){d(!1)}return ie(()=>{var m;(m=n==null?void 0:n.account)!=null&&m.id&&u&&(o("loading"),(async()=>{const b=await al(n.account.id);a(b||[]),o("default")})())},[u,(y=n==null?void 0:n.account)==null?void 0:y.id]),e(U,{children:[e("button",{type:"button",class:"plain4 request-notifications-account",onClick:()=>{d(!0)},children:[e(A,{icon:"notification",class:"more-insignificant"})," ",e("small",{children:e(h,{id:"H0wUNM",values:{0:c.username},components:{0:e("span",{class:"bidi-isolate"})}})})," ",e(A,{icon:"chevron-down"})]}),u&&e(He,{onClick:m=>{m.target===m.currentTarget&&p()},children:e("div",{class:"sheet",tabIndex:"-1",children:[e("button",{type:"button",class:"sheet-close",onClick:p,children:e(A,{icon:"x",alt:t`Close`})}),e("header",{children:e("b",{children:e(h,{id:"MXOmPt",values:{0:c.username},components:{0:e("span",{class:"bidi-isolate"})}})})}),e("main",{children:s==="loading"?e("p",{class:"ui-state",children:e(Ue,{abrupt:!0})}):l.map(m=>e("div",{class:"notification-peek",onClick:b=>{const{target:f}=b;(b.target.tagName==="BUTTON"||b.target.tagName==="A")&&p()},children:e(cn,{instance:i,notification:m,isStatic:!0})}))})]})})]})}function ll({request:n,onChange:i}){const{_:s}=de(),{masto:o}=ce(),[c,r]=R("default"),[u,d]=R(null),l=u!==null;return e("p",{class:"notification-request-buttons",children:[e("button",{type:"button",disabled:c==="loading"||l,onClick:()=>{r("loading"),(async()=>{try{await o.v1.notifications.requests.$select(n.id).accept(),d("accept"),r("default"),i({request:n,state:"accept"}),pe(s({id:"ZtBMwU",values:{0:n.account.username}}))}catch{r("error"),pe(s({id:"S92JKG"}))}})()},children:e(h,{id:"h7peZQ"})})," ",e("button",{type:"button",disabled:c==="loading"||l,class:"light danger",onClick:()=>{r("loading"),(async()=>{try{await o.v1.notifications.requests.$select(n.id).dismiss(),d("dismiss"),r("default"),i({request:n,state:"dismiss"}),pe(s({id:"ibBDry",values:{0:n.account.username}}))}catch{r("error"),pe(s({id:"S5aemF"}))}})()},children:e(h,{id:"1QfxQT"})}),e("span",{class:"notification-request-states",children:c==="loading"?e(Ue,{abrupt:!0}):u==="accept"?e(A,{icon:"check-circle",alt:s({id:"bzMKg7"}),class:"notification-accepted"}):u==="dismiss"&&e(A,{icon:"x-circle",alt:s({id:"J6hrEy"}),class:"notification-dismissed"})})]})}const ao=dt(sl),dl=20;function ii({local:n,columnMode:i,...s}){const{_:o}=de(),c=Ge(x),r=!!n,u=i?{}:Lt(),{masto:d,instance:l}=ce({instance:(s==null?void 0:s.instance)||u.instance}),{masto:a,instance:p}=ce(),y=o(r?{id:"u96B/B",values:{instance:l}}:{id:"PgVqvd",values:{instance:l}});tt(y,r?"/:instance?/p/l":"/:instance?/p");const m=q(),b=q();async function f(v){if(v||!b.current){const S={limit:dl,local:r||void 0};!r&&et("@pixelfed/global-feed")&&(S.remote=!0),b.current=d.v1.timelines.public.list(S)}const w=await b.current.next();let{value:_}=w;return _!=null&&_.length&&(v&&(m.current=_[0].id),_.forEach(S=>{Qe(S,l)})),{...w,value:_}}async function g(){var v;try{const w=await d.v1.timelines.public.list({limit:1,local:r,since_id:m.current}).next();let{value:_}=w;const S=((v=_[0])==null?void 0:v.id)===m.current;return _!=null&&_.length&&!S?(_=Ot(_,"public"),!0):!1}catch{return!1}}return e(At,{title:y,titleComponent:e("h1",{class:"header-double-lines",children:[e("b",{children:o(r?{id:"pJQgQV"}:{id:"cg0I+x"})}),e("div",{children:l})]}),id:"public",instance:l,emptyText:o({id:"BiZJ6G"}),errorText:o({id:"scd9lw"}),fetchItems:f,checkForUpdates:g,useItemID:!0,headerStart:e(U,{}),boostsCarousel:c.settings.boostsCarousel,filterContext:"public",headerEnd:e(lt,{portal:!0,overflow:"auto",viewScroll:"close",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(A,{icon:"more",size:"l",alt:o({id:"2FYpfJ"})})}),children:[e(ve,{href:r?`/#/${l}/p`:`/#/${l}/p/l`,children:r?e(U,{children:[e(A,{icon:"transfer"})," ",e("span",{children:e(h,{id:"dXMiUw"})})]}):e(U,{children:[e(A,{icon:"transfer"})," ",e("span",{children:e(h,{id:"t2B/we"})})]})}),e(Ve,{}),e(ve,{onClick:()=>{let v=prompt(o({id:"2MQ2cd"}));if(!/\./.test(v)){v&&alert(o({id:"7WddtO"}));return}v&&(v=v.toLowerCase().trim(),location.hash=r?`/${v}/p/l`:`/${v}/p`)},children:[e(A,{icon:"bus"})," ",e("span",{children:e(h,{id:"Sq04Yc"})})]}),p!==l&&e(ve,{onClick:()=>{location.hash=r?`/${p}/p/l`:`/${p}/p`},children:[e(A,{icon:"bus"})," ",e("small",{class:"menu-double-lines",children:e(h,{id:"iAzCp4",values:{currentInstance:p},components:{0:e("b",{})}})})]})]})},l+r)}const fn=5,Vn=40,ul=new URLSearchParams,pn={block:"nearest",inline:"center",behavior:"smooth"};function ro({columnMode:n,...i}){const{_:s}=de(),o=n?{}:Lt(),{masto:c,instance:r,authenticated:u}=ce({instance:o.instance}),[d,l]=R("default"),[a]=n?[ul]:yt(),p=q(),y=(i==null?void 0:i.query)||a.get("q"),m=n?"statuses":(i==null?void 0:i.type)||a.get("type");let b=s({id:"A1taO8"});if(y)switch(m){case"statuses":b=s({id:"6YeoAt",values:{q:y}});break;case"accounts":b=s({id:"fpgumQ",values:{q:y}});break;case"hashtags":b=s({id:"AuiMZZ",values:{q:y}});break;default:b=s({id:"wr3GZI",values:{q:y}})}tt(b,"/search");const[f,g]=R(!1),v=q(0);ie(()=>{v.current=0},[y,m]);const w=q();kt(()=>{var M,F;(F=(M=w.current)==null?void 0:M.scrollTo)==null||F.call(M,0,0)},[y,m]);const[_,S]=R([]),[k,T]=R([]),[C,I]=R([]);ie(()=>{S([]),T([]),I([])},[y]);const E={statuses:_,accounts:k,hashtags:C},L={statuses:S,accounts:T,hashtags:I},[B,P]=R({}),Y=async M=>{if(!(M!=null&&M.length))return;const F=await ui(M,B);F&&P({...B,...F})};function Q(M){M&&(v.current=0),!(!M&&!u)&&(l("loading"),M&&!m&&(S(_.slice(0,fn)),T(k.slice(0,fn)),I(C.slice(0,fn))),(async()=>{var G,re,H,se,be,we;const F={q:y,resolve:u,limit:fn};m&&(F.limit=Vn,F.type=m,u&&(F.offset=v.current));try{const Z=await c.v2.search.fetch(F);if(m)if(M){L[m](Z[m]);const le=(G=Z[m])==null?void 0:G.length;v.current=Vn,g(!!le)}else if(((H=(re=Z[m])==null?void 0:re[0])==null?void 0:H.id)===((be=(se=E[m])==null?void 0:se[0])==null?void 0:be.id))g(!1);else{L[m](Re=>[...Re,...Z[m]]);const le=(we=Z[m])==null?void 0:we.length;v.current=v.current+Vn,g(!!le)}else S(Z.statuses||[]),T(Z.accounts||[]),I(Z.hashtags||[]),v.current=0,g(!1);Y(Z.accounts),l("default")}catch{l("error")}})())}const te=q();jt(M=>{var G;const F=((G=w.current)==null?void 0:G.scrollTop)===0;if(M&&F){const re=Date.now()-te.current;!te.current||re>1e3*3?Q(!0):te.current=Date.now()}}),ie(()=>{var F,G;let M;return(G=(F=p.current)==null?void 0:F.setValue)==null||G.call(F,y||""),y?Q(!0):M=setTimeout(()=>{var re,H;(H=(re=p.current)==null?void 0:re.focus)==null||H.call(re)},150),()=>clearTimeout(M)},[y,m,r]),Fe(["Slash","/"],M=>{var F,G,re,H;(G=(F=p.current)==null?void 0:F.focus)==null||G.call(F),(H=(re=p.current)==null?void 0:re.select)==null||H.call(re)},{useKey:!0,preventDefault:!0});const J=".timeline > li > a, .hashtag-list > li > a",V=Fe("j",()=>{const M=document.activeElement.closest(J),F=M==null?void 0:M.getBoundingClientRect(),G=Array.from(w.current.querySelectorAll(J));if(M&&F.top<w.current.clientHeight&&F.bottom>0){const re=G.indexOf(M);let H=G[re+1];H&&(H.focus(),H.scrollIntoView(pn))}else{const re=G.find(H=>{const se=H.getBoundingClientRect();return se.top>=44&&se.left>=0});re&&(re.focus(),re.scrollIntoView(pn))}},{useKey:!0}),z=Fe("k",()=>{const M=document.activeElement.closest(J),F=M==null?void 0:M.getBoundingClientRect(),G=Array.from(w.current.querySelectorAll(J));if(M&&F.top<w.current.clientHeight&&F.bottom>0){const re=G.indexOf(M);let H=G[re-1];H&&(H.focus(),H.scrollIntoView(pn))}else{const re=G.find(H=>{const se=H.getBoundingClientRect();return se.top>=44&&se.left>=0});re&&(re.focus(),re.scrollIntoView(pn))}},{useKey:!0}),[ue]=bi();return e("div",{id:"search-page",class:"deck-container",tabIndex:"-1",ref:M=>{w.current=M,V.current=M,z.current=M},children:e("div",{class:"timeline-deck deck",children:[e("header",{class:d==="loading"?"loading":"",children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:e(Mt,{})}),e(Vs,{ref:p}),e("div",{class:"header-side",children:e("button",{type:"button",class:"plain",onClick:()=>{Q(!0)},disabled:d==="loading",children:e(A,{icon:"search",size:"l",alt:s({id:"A1taO8"})})})})]})}),e("main",{children:[!!y&&!n&&e("div",{ref:ue,class:`filter-bar ${d==="loading"?"loading":""}`,children:[!!m&&e(ge,{to:`/search${y?`?q=${encodeURIComponent(y)}`:""}`,children:[e(A,{icon:"chevron-left"})," ",e(h,{id:"N40H+G"})]}),[{label:s({id:"bPwFdf"}),type:"accounts",to:`/search?q=${encodeURIComponent(y)}&type=accounts`},{label:s({id:"VwUsHI"}),type:"hashtags",to:`/search?q=${encodeURIComponent(y)}&type=hashtags`},{label:s({id:"+owNNn"}),type:"statuses",to:`/search?q=${encodeURIComponent(y)}&type=statuses`}].sort((M,F)=>M.type===m?-1:F.type===m?1:0).map(M=>e(ge,{to:M.to,children:M.label},M.type))]}),y?e(U,{children:[(!m||m==="accounts")&&e(U,{children:[m!=="accounts"&&e("h2",{class:"timeline-header",children:[e(h,{id:"bPwFdf"})," ",e(ge,{to:`/search?q=${encodeURIComponent(y)}&type=accounts`,children:e(A,{icon:"arrow-right",size:"l",alt:s({id:"V1fa9u"})})})]}),k.length>0?e(U,{children:[e("ul",{class:"timeline flat accounts-list",children:k.map(M=>e("li",{children:e(ft,{account:M,instance:r,showStats:!0,relationship:B[M.id]})},M.id))}),m!=="accounts"&&e("div",{class:"ui-state",children:e(ge,{class:"plain button",to:`/search?q=${encodeURIComponent(y)}&type=accounts`,children:[e(h,{id:"BMmtZ8"})," ",e(A,{icon:"arrow-right"})]})})]}):!m&&(d==="loading"?e("p",{class:"ui-state",children:e(Ue,{abrupt:!0})}):e("p",{class:"ui-state",children:e(h,{id:"YYB61U"})}))]}),(!m||m==="hashtags")&&e(U,{children:[m!=="hashtags"&&e("h2",{class:"timeline-header",children:[e(h,{id:"VwUsHI"})," ",e(ge,{to:`/search?q=${encodeURIComponent(y)}&type=hashtags`,children:e(A,{icon:"arrow-right",size:"l",alt:s({id:"V1fa9u"})})})]}),C.length>0?e(U,{children:[e("ul",{class:"link-list hashtag-list",children:C.map(M=>{var H;const{name:F,history:G}=M,re=(H=G==null?void 0:G.reduce)==null?void 0:H.call(G,(se,be)=>se+ +be.uses,0);return e("li",{children:e(ge,{to:r?`/${r}/t/${F}`:`/t/${F}`,children:[e(A,{icon:"hashtag",alt:"#"}),e("span",{children:F}),!!re&&e("span",{class:"count",children:Je(re)})]})},`${F}-${re}`)})}),m!=="hashtags"&&e("div",{class:"ui-state",children:e(ge,{class:"plain button",to:`/search?q=${encodeURIComponent(y)}&type=hashtags`,children:[e(h,{id:"Nc/W5J"})," ",e(A,{icon:"arrow-right"})]})})]}):!m&&(d==="loading"?e("p",{class:"ui-state",children:e(Ue,{abrupt:!0})}):e("p",{class:"ui-state",children:e(h,{id:"4MFM3P"})}))]}),(!m||m==="statuses")&&e(U,{children:[m!=="statuses"&&e("h2",{class:"timeline-header",children:[e(h,{id:"+owNNn"})," ",e(ge,{to:`/search?q=${encodeURIComponent(y)}&type=statuses`,children:e(A,{icon:"arrow-right",size:"l",alt:s({id:"V1fa9u"})})})]}),_.length>0?e(U,{children:[e("ul",{class:"timeline",children:_.map(M=>e("li",{children:e(ge,{class:"status-link",to:r?`/${r}/s/${M.id}`:`/s/${M.id}`,children:e(qe,{status:M})})},M.id))}),m!=="statuses"&&e("div",{class:"ui-state",children:e(ge,{class:"plain button",to:`/search?q=${encodeURIComponent(y)}&type=statuses`,children:[e(h,{id:"LYCgej"})," ",e(A,{icon:"arrow-right"})]})})]}):!m&&(d==="loading"?e("p",{class:"ui-state",children:e(Ue,{abrupt:!0})}):e("p",{class:"ui-state",children:e(h,{id:"Hzi9AA"})}))]}),!!m&&(d==="default"?f?e(Ct,{onChange:M=>{M&&Q()},children:e("button",{type:"button",class:"plain block",onClick:()=>Q(),style:{marginBlockEnd:"6em"},children:e(h,{id:"uXRAkV"})})}):e("p",{class:"ui-state insignificant",children:e(h,{id:"2EYeAZ"})}):d==="loading"&&e("p",{class:"ui-state",children:e(Ue,{abrupt:!0})}))]}):d==="loading"?e("p",{class:"ui-state",children:e(Ue,{abrupt:!0})}):e("p",{class:"ui-state",children:e(h,{id:"fGn1Hk"})})]})]})})}const hl=20,lo=10*60*1e3,fl=bt(n=>n.v1.trends.links.list().next(),{maxAge:lo}),pl=bt(n=>n.v1.trends.tags.list().next(),{maxAge:lo});function ml(n){return et("@pixelfed/trending")?n.pixelfed.v2.discover.posts.trending.list({range:"daily"}):n.v1.trends.statuses.list({limit:hl})}function gl(n,i){return n.v1.timelines.link.list(i)}function uo({columnMode:n,...i}){const{_:s}=de(),o=Ge(x),c=n?{}:Lt(),{masto:r,instance:u}=ce({instance:(i==null?void 0:i.instance)||c.instance}),{masto:d,instance:l}=ce(),a=s({id:"cI3UEs",values:{instance:u}});tt(a,"/:instance?/trending");const p=q(),y=u===l,[m,b]=R([]),[f,g]=R([]),v=q();async function w(te){var z;if(te||!v.current){if(v.current=ml(r),et("@mastodon/trending-hashtags"))try{const{value:ue}=await pl(r);ue!=null&&ue.length&&b(ue)}catch{}if(et("@mastodon/trending-links"))try{const{value:ue}=await fl(r,u),M=(z=ue==null?void 0:ue.filter)==null?void 0:z.call(ue,F=>F.type==="link");M!=null&&M.length&&g(M)}catch{}}const J=await v.current.next();let{value:V}=J;return V!=null&&V.length&&(te&&(p.current=V[0].id),V.forEach(ue=>{Qe(ue,u)})),{...J,value:V}}const[_,S]=R(!1),k=q(),[T,C]=R(null),I=!!T,E=q(),L=y&&et("@mastodon/trending-link-posts");ie(()=>{T&&E.current&&E.current.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})},[T]);const B=q();async function P(te){(te||!k.current)&&(S(!0),k.current=gl(r,{url:T})),B.current=T;const J=await k.current.next();let{value:V}=J;return V!=null&&V.length&&(V=Ot(V,"public"),V.forEach(z=>{Qe(z,u)})),B.current===T&&S(!1),{...J,value:V}}async function Y(){try{const te=await r.v1.trends.statuses.list({limit:1}).next();let{value:J}=te;return J=Ot(J,"public"),J!=null&&J.length&&J[0].id!==p.current?(p.current=J[0].id,!0):!1}catch{return!1}}const Q=_e(()=>e(U,{children:[!!m.length&&e("div",{class:"filter-bar expandable",children:[e(A,{icon:"chart",class:"insignificant",size:"l"}),m.map((te,J)=>{const{name:V,history:z}=te,ue=z.reduce((M,F)=>M+ +F.uses,0);return e(ge,{to:`/${u}/t/${V}`,children:[e("span",{dir:"auto",children:[e("span",{class:"more-insignificant",children:"#"}),V]}),e("span",{class:"filter-count",children:Je(ue)})]},V)})]}),!!f.length&&e("div",{class:"links-bar",children:[e("header",{children:e("h3",{children:e(h,{id:"9veeTb"})})}),f.map(te=>{var X,ke;const{authors:J,authorName:V,authorUrl:z,blurhash:ue,description:M,height:F,image:G,imageDescription:re,language:H,providerName:se,providerUrl:be,publishedAt:we,title:Z,url:le,width:Re}=te,$e=(ke=(X=J==null?void 0:J[0])==null?void 0:X.account)!=null&&ke.id?J[0].account:null,De=Z.length<30,ze=!!(V||$e),Le=xs(le);let Te;if(ue){const Ne=hi(ue),ne=_i(Ne);Te=Si([.6,ne[1],ne[2]])}return e("div",{children:[e("a",{ref:T===le?E:null,href:le,target:"_blank",rel:"noopener",class:`link-block ${I?T===le?"active":"inactive":""}`,style:Te?{"--accent-color":`rgb(${Te.join(",")})`,"--accent-alpha-color":`rgba(${Te.join(",")}, 0.4)`}:{},children:e("article",{children:[e("figure",{children:e("img",{src:G,alt:re,width:Re,height:F,loading:"lazy"})}),e("div",{class:"article-body",children:[e("header",{children:[e("div",{class:"article-meta",children:[e("span",{class:"domain",children:Le})," ",!!we&&e(U,{children:"· "}),!!we&&e(U,{children:e(It,{datetime:we,format:"micro"})})]}),!!Z&&e("h1",{class:"title",lang:H,dir:"auto",title:Z,children:Z})]}),!!M&&e("p",{class:`description ${ze&&!De?"":"more-lines"}`,lang:H,dir:"auto",title:M,children:M}),ze&&e(U,{children:[e("hr",{}),e("p",{class:"byline",children:e("small",{children:e(h,{id:"aavdrC",values:{0:$e?e(gt,{account:$e,showAvatar:!0}):z?e("a",{href:z,target:"_blank",rel:"noopener",children:V}):V}})})})]})]})]})}),L&&e("button",{type:"button",class:"small plain4 block",onClick:()=>{C(le)},disabled:le===T,children:[e(A,{icon:"comment2"})," ",e("span",{children:e(h,{id:"/bZzdR"})})," ",e(A,{icon:"chevron-down"})]})]},le)})]}),L&&!!f.length&&e("div",{class:`timeline-header-block ${I?"blended":""}`,children:I?e(U,{children:[e("div",{style:{width:50,flexShrink:0,textAlign:"center"},children:_?e(Ue,{abrupt:!0}):e("button",{type:"button",class:"light",onClick:()=>{C(null)},children:e(A,{icon:"x",alt:s({id:"9Q/4xJ"})})})}),e("p",{children:e(h,{id:"BATCqf",values:{0:T.replace(/^https?:\/\/(www\.)?/i,"").replace(/\/$/,"")},components:{0:e("span",{class:"link-text"})}})})]}):e("p",{class:"insignificant",children:e(h,{id:"Vosm4k"})})})]}),[m,f,T,_]);return e(At,{title:a,titleComponent:e("h1",{class:"header-double-lines",children:[e("b",{children:e(h,{id:"4/iCqx"})}),e("div",{children:u})]}),id:"trending",instance:u,emptyText:s({id:"6HA9+s"}),errorText:s({id:"scd9lw"}),fetchItems:I?P:w,checkForUpdates:I?void 0:Y,checkForUpdatesInterval:5*60*1e3,useItemID:!0,headerStart:e(U,{}),boostsCarousel:o.settings.boostsCarousel,filterContext:"public",timelineStart:Q,refresh:T,clearWhenRefresh:!0,view:I?"link-mentions":void 0,headerEnd:e(lt,{portal:!0,overflow:"auto",viewScroll:"close",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(A,{icon:"more",size:"l",alt:s({id:"2FYpfJ"})})}),children:[e(ve,{onClick:()=>{let te=prompt(s({id:"2MQ2cd"}));if(!/\./.test(te)){te&&alert(s({id:"7WddtO"}));return}te&&(te=te.toLowerCase().trim(),location.hash=`/${te}/trending`)},children:[e(A,{icon:"bus"})," ",e("span",{children:e(h,{id:"Sq04Yc"})})]}),l!==u&&e(ve,{onClick:()=>{location.hash=`/${l}/trending`},children:[e(A,{icon:"bus"})," ",e("small",{class:"menu-double-lines",children:e(h,{id:"iAzCp4",values:{currentInstance:l},components:{0:e("b",{})}})})]})]})},u)}const ss={block:"nearest",inline:"nearest",behavior:"smooth"};function bl(){const{_:n}=de();tt(n({id:"i0qMbr"}),"/");const i=Ge(x),{shortcuts:s}=i,o=s.map(c=>{if(!c)return null;const{type:r,...u}=c,d={following:Ii,notifications:ao,list:eo,public:ii,bookmarks:Zs,favourites:Xs,hashtag:Qs,mentions:so,trending:uo,search:ro}[r];return!d||r==="search"&&!u.query||r==="list"&&!u.id?null:e(d,{...u,columnMode:!0},r+JSON.stringify(u))});return Fe(["1","2","3","4","5","6","7","8","9"],(c,r)=>{try{const u=parseInt(r.keys[0],10)-1,d=document.querySelectorAll("#columns > *")[u];d&&(d.focus(),d.scrollIntoView(ss))}catch{}}),Fe(["[","]"],(c,r)=>{const u=r.keys[0],d=document.activeElement.closest("#columns > *"),l=Dt(),a=l?"]":"[",p=l?"[":"]";let y;u===a?y=d?d.previousElementSibling:document.querySelectorAll("#columns > *")[0]:u===p&&(y=d?d.nextElementSibling:document.querySelectorAll("#columns > *")[1]),y&&(y.focus(),y.scrollIntoView(ss))},{useKey:!0}),e("div",{id:"columns",onContextMenu:c=>{c.target.closest(".deck > header")&&!c.target.closest("a")&&!c.target.closest("button")&&(c.preventDefault(),x.showShortcutsSettings=!0)},onFocus:()=>{const c=document.activeElement.closest("#columns > *");c&&document.querySelectorAll("#columns > *").forEach(r=>{r.classList.toggle("focus",r===c)})},children:o})}function yl(){var s;const{_:n}=de(),i=Ge(x);return __BENCHMARK.end("time-to-home"),ie(()=>{(async()=>{const o=await mt.drafts.keys();if(o.length){const c=Cn();o.filter(u=>u.startsWith(c)).length&&(x.showDrafts=!0)}})()},[]),e(U,{children:(i.settings.shortcutsViewMode==="multi-column"||!i.settings.shortcutsViewMode&&i.settings.shortcutsColumnsMode)&&((s=i.shortcuts)!=null&&s.length)?e(bl,{}):e(Ii,{title:n({id:"i0qMbr"}),path:"/",id:"home",headerStart:!1,headerEnd:e(vl,{})})})}function vl(){const{_:n}=de(),i=Ge(x),s=q(),[o,c]=R(void 0);return e(U,{children:[e(ge,{ref:s,to:"/notifications",class:`button plain notifications-button ${i.notificationsShowNew?"has-badge":""} ${o||""}`,onClick:r=>{r.stopPropagation(),window.matchMedia("(min-width: calc(40em))").matches&&(r.preventDefault(),c(u=>u?void 0:"open"))},children:e(A,{icon:"notification",size:"l",alt:n({id:"iDNBZe"})})}),e(kl,{state:o,anchorRef:s,onClose:()=>c(void 0)})]})}const wl=5;function kl({anchorRef:n,state:i,onClose:s}){const{masto:o,instance:c}=ce(),r=Ge(x),[u,d]=R("default"),l=ni();async function a(){const g=await l.next(),v=io(g.value);if(v!=null&&v.length){v.forEach(_=>{Qe(_.status,c,{skipThreading:!0})});const w=co(v);x.notificationsLast=w[0],x.notifications=w,o.v1.markers.create({notifications:{lastReadId:w[0].id}}).catch(()=>{})}return x.notificationsShowNew=!1,x.notificationsLastFetchTime=Date.now(),g}const[p,y]=R(!1);function m(){return o.v1.followRequests.list({limit:1})}function b(){d("loading"),(async()=>{try{await a();const g=await m();y(!!(g!=null&&g.length)),d("default")}catch{d("error")}})()}ie(()=>{i==="open"&&b()},[i]);const f=q();return e(di,{ref:f,menuClassName:"notifications-menu",state:i,anchorRef:n,onClose:s,portal:{target:document.body},containerProps:{onClick:()=>{var g,v;(v=(g=f.current)==null?void 0:g.closeMenu)==null||v.call(g)}},overflow:"auto",viewScroll:"close",position:"anchor",align:"center",boundingBoxPadding:"8 8 8 8",children:[e("header",{children:e("h2",{children:e(h,{id:"iDNBZe"})})}),e(Mn.Provider,{value:"notifications",children:e("main",{children:r.notifications.length?e(U,{children:r.notifications.slice(0,wl).map(g=>e(cn,{instance:c,notification:g,disableContextMenu:!0},g._ids||g.id))}):u==="loading"?e("div",{class:"ui-state",children:e(Ue,{abrupt:!0})}):u==="error"&&e("div",{class:"ui-state",children:[e("p",{children:e(h,{id:"5GFQTh"})}),e("p",{children:e("button",{type:"button",onClick:b,children:e(h,{id:"KDw4GX"})})})]})})}),e("footer",{children:[e(ge,{to:"/mentions",class:"button plain",children:[e(A,{icon:"at"})," ",e("span",{children:e(h,{id:"/bZzdR"})})]}),e(ge,{to:"/notifications",class:"button plain2",children:[p?e(h,{id:"OdVhdR",components:{0:e("span",{class:"tag collapsed"}),1:e("span",{})}}):e("b",{children:e(h,{id:"gukqfD"})})," ",e(A,{icon:"arrow-right"})]})]})]})}const Sl=dt(yl),_l=[/^\/@[^@\/]+\/(?:statuses|posts)\/([^\/]+)/i,/\/notes\/([^\/]+)/i,/^\/(?:notice|objects)\/([a-z0-9-]+)/i,/\/@[^@\/]+\/post\/([^\/]+)/i,/\/@[^@\/]+@?[^\/]+?\/([^\/]+)/i,/^\/p\/[^\/]+\/([^\/]+)/i];function ho(n){const i=URL.parse(n);if(!i)return{};const{hostname:s,pathname:o}=i;for(const c of _l){const[,r]=o.match(c)||[];if(r)return{instance:s,id:r}}return{}}function Cl(n){const{instance:i,id:s}=ho(n);return i&&s?`/${i}/s/${s}`:null}function Il(){const i=Wt().pathname.replace(/^\//,""),s=ho(i),o=s!=null&&s.instance?`/${s.instance}/s/${s.id}`:null,[c,r]=R("loading");return kt(()=>{r("loading"),(async()=>{try{const{instance:u,id:d}=s;if(d){const{masto:l}=ce({instance:u});if(await l.v1.statuses.$select(d).fetch()){window.location.hash=o+"?view=full";return}}}catch{}{const{masto:u,instance:d}=ce(),l=await u.v2.search.fetch({q:i,limit:1,resolve:!0});if(l.statuses.length){const a=l.statuses[0];window.location.hash=`/${d}/s/${a.id}?view=full`}else if(l.accounts.length){const a=l.accounts[0];window.location.hash=`/${d}/a/${a.id}`}else o?window.location.hash=o+"?view=full":r("error")}})()},[o]),e("div",{class:"ui-state",tabIndex:"-1",children:[c==="loading"?e(U,{children:[e(Ue,{abrupt:!0}),e("h2",{children:e(h,{id:"RTAr/z"})}),e("p",{children:e("a",{href:i,target:"_blank",rel:"noopener",children:i})})]}):e(U,{children:[e("h2",{children:e(h,{id:"ufzZSJ"})}),e("p",{children:e("a",{href:i,target:"_blank",rel:"noopener",children:i})})]}),e("hr",{}),e("p",{children:e(ge,{to:"/",children:e(h,{id:"iWpEwy"})})})]})}function Al(){const{_:n}=de();tt(n({id:"h16FyT"}),"/l");const[i,s]=R("default"),[o,c]=Rt(a=>a+1,0),[r,u]=R([]);ie(()=>{s("loading"),(async()=>{try{const a=await ei();u(a),s("default")}catch{s("error")}})()},[o]);const[d,l]=R(!1);return e("div",{id:"lists-page",class:"deck-container",tabIndex:"-1",children:[e("div",{class:"timeline-deck deck",children:[e("header",{children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Mt,{}),e(ge,{to:"/",class:"button plain",children:e(A,{icon:"home",size:"l"})})]}),e("h1",{children:e(h,{id:"h16FyT"})}),e("div",{class:"header-side",children:e("button",{type:"button",class:"plain",onClick:()=>l(!0),children:e(A,{icon:"plus",size:"l",alt:n({id:"Sb2gYF"})})})})]})}),e("main",{children:r.length>0?e(U,{children:[e("ul",{class:"link-list",children:r.map(a=>e("li",{children:e(ge,{to:`/l/${a.id}`,children:e("span",{children:[e(A,{icon:"list"})," ",e("span",{children:a.title})]})})}))}),r.length>1&&e("footer",{class:"ui-state",children:e("small",{class:"insignificant",children:e(h,{id:"8prZNK",values:{0:r.length}})})})]}):i==="loading"?e("p",{class:"ui-state",children:e(Ue,{})}):i==="error"?e("p",{class:"ui-state",children:e(h,{id:"v/l5uA"})}):e("p",{class:"ui-state",children:e(h,{id:"IvPikw"})})})]}),d&&e(He,{onClick:a=>{a.target===a.currentTarget&&l(!1)},children:e(ki,{list:d==null?void 0:d.list,onClose:a=>{a.state==="success"&&c(),l(!1)}})})]})}const Tl=""+new URL("instances-LA7224ZB.json",import.meta.url).href;function xl(n){return("0"+n.toString(16)).slice(-2)}function El(){var n=new Uint32Array(28);return window.crypto.getRandomValues(n),Array.from(n,xl).join("")}function Rl(n){const s=new TextEncoder().encode(n);return window.crypto.subtle.digest("SHA-256",s)}function Ll(n){let i="";const s=new Uint8Array(n),o=s.byteLength;for(var c=0;c<o;c++)i+=String.fromCharCode(s[c]);return btoa(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function fo(n){const i=await Rl(n);return Ll(i)}async function Ml({instanceURL:n}){var i;if(!n)return!1;try{const s=await fetch(`https://${n}/.well-known/oauth-authorization-server`);return!s.ok||s.status!==200?!1:!!((i=(await s.json()).code_challenge_methods_supported)!=null&&i.includes("S256"))}catch{return!1}}window.__generateCodeChallenge=fo;const $l={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Blaede Phanpy",PHANPY_DEFAULT_INSTANCE:"mastodon.blaede.family",PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:"https://mastodon.blaede.family/auth/sign_up",PHANPY_GIPHY_API_KEY:"48JGsrSS1XE5w4nWe9c9hqxPbsfRWR0e",PHANPY_LINGVA_INSTANCES:"lingva.phanpy.social lingva.lunar.icu lingva.garudalinux.org translate.plausibility.cloud",PHANPY_PRIVACY_POLICY_URL:"https://mastodon.blaede.family/privacy-policy",PHANPY_TRANSLANG_INSTANCES:"translang.phanpy.social",PHANPY_WEBSITE:"https://phanpy.blaede.family",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},{DEV:Nl,PHANPY_CLIENT_NAME:Pl,PHANPY_WEBSITE:Rn}=$l,Ai="read write follow push",Dl=Rn?Rn.toLowerCase().includes(location.hostname):!1,Ol=location.origin+location.pathname,Dn=Nl||!Dl?Ol:Rn;async function zl({instanceURL:n}){const i=new URLSearchParams({client_name:Pl,redirect_uris:Dn,scopes:Ai,website:Rn});return await(await fetch(`https://${n}/api/v1/apps`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:i.toString()})).json()}async function Ul({instanceURL:n,client_id:i}){const s=El(),o=await fo(s),c=new URLSearchParams({client_id:i,code_challenge_method:"S256",code_challenge:o,redirect_uri:Dn,response_type:"code",scope:Ai});return[`https://${n}/oauth/authorize?${c.toString()}`,s]}async function Bl({instanceURL:n,client_id:i}){const s=new URLSearchParams({client_id:i,scope:Ai,redirect_uri:Dn,response_type:"code"});return`https://${n}/oauth/authorize?${s.toString()}`}async function Fl({instanceURL:n,client_id:i,client_secret:s,code:o,code_verifier:c}){const r=new URLSearchParams({client_id:i,redirect_uri:Dn,grant_type:"authorization_code",code:o});return s&&r.append("client_secret",s),c&&r.append("code_verifier",c),await(await fetch(`https://${n}/oauth/token`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:r.toString()})).json()}const Hl={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Blaede Phanpy",PHANPY_DEFAULT_INSTANCE:"mastodon.blaede.family",PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:"https://mastodon.blaede.family/auth/sign_up",PHANPY_GIPHY_API_KEY:"48JGsrSS1XE5w4nWe9c9hqxPbsfRWR0e",PHANPY_LINGVA_INSTANCES:"lingva.phanpy.social lingva.lunar.icu lingva.garudalinux.org translate.plausibility.cloud",PHANPY_PRIVACY_POLICY_URL:"https://mastodon.blaede.family/privacy-policy",PHANPY_TRANSLANG_INSTANCES:"translang.phanpy.social",PHANPY_WEBSITE:"https://phanpy.blaede.family",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},{PHANPY_DEFAULT_INSTANCE:Yl}=Hl;function ql(){var S,k;const{_:n}=de();tt(n({id:"sQia9P"}),"/login");const i=q(),s=ye.local.get("instanceURL"),[o,c]=R("default"),[r]=yt(),u=r.get("instance"),d=r.get("submit"),[l,a]=R(u||(s==null?void 0:s.toLowerCase())||""),[p,y]=R([]),m=q();ie(()=>{(async()=>{try{const C=await(await fetch(Tl)).json();y(C),m.current=new Zo(C)}catch{}})()},[]);const b=T=>{T&&(async()=>{try{const I=await(await fetch(`https://${T}/.well-known/host-meta`)).text(),P=new DOMParser().parseFromString(I,"text/xml").getElementsByTagName("Link")[0].getAttribute("template"),Y=URL.parse(P),{host:Q}=Y;T!==Q&&(T=Q)}catch{}ye.local.set("instanceURL",T),c("loading");try{const{client_id:C,client_secret:I,vapid_key:E}=await zl({instanceURL:T});if(await Ml({instanceURL:T}))if(C&&I){ye.sessionCookie.set("clientID",C),ye.sessionCookie.set("clientSecret",I),ye.sessionCookie.set("vapidKey",E);const[B,P]=await Ul({instanceURL:T,client_id:C});ye.sessionCookie.set("codeVerifier",P),location.href=B}else alert(n({id:"ZP1FIA"}));else C&&I?(ye.sessionCookie.set("clientID",C),ye.sessionCookie.set("clientSecret",I),ye.sessionCookie.set("vapidKey",E),location.href=await Bl({instanceURL:T,client_id:C})):alert(n({id:"ZP1FIA"}));c("default")}catch{c("error")}})()},f=l?l.replace(/^https?:\/\//,"").replace(/\/+$/,"").replace(/^@?[^@]+@/,"").trim():null,g=/[^\s\r\n\t\/\\]+\.[^\s\r\n\t\/\\]+/.test(f)&&!/[\s\/\\@]/.test(f),v=f?(k=(S=m.current)==null?void 0:S.search(f,{limit:10}))==null?void 0:k.map(T=>T.item):[],w=g?f:v!=null&&v.length?v[0]:l?p.find(T=>T.includes(l)):null,_=T=>{T.preventDefault(),b(w)};return d&&ie(()=>{b(u||w)},[]),e("main",{id:"login",style:{textAlign:"center"},children:e("form",{onSubmit:_,children:[e("h1",{children:[e("img",{src:yi,alt:"",width:"80",height:"80"}),e("br",{}),e(h,{id:"sQia9P"})]}),e("label",{children:[e("p",{children:e(h,{id:"kyAi7k"})}),e("input",{value:l,required:!0,type:"text",class:"large",id:"instanceURL",ref:i,disabled:o==="loading",autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellCheck:!1,placeholder:n({id:"u3gOdY"}),onInput:T=>{a(T.target.value)},dir:"auto"}),(v==null?void 0:v.length)>0?e("ul",{id:"instances-suggestions",children:v.map((T,C)=>e("li",{children:e("button",{type:"button",class:"plain5",onClick:()=>{b(T)},children:T})}))}):e("div",{id:"instances-eg",children:e(h,{id:"/OvbEC"})})]}),o==="error"&&e("p",{class:"error",children:e(h,{id:"rmBHZn"})}),e("div",{children:[e("button",{disabled:o==="loading"||!l||!w,children:n(w?{id:"2xahsi",values:{selectedInstanceText:w}}:{id:"xGVfLh"})})," "]}),e(Ue,{hidden:o!=="loading"}),e("hr",{}),!Yl&&e("p",{children:e("a",{href:"https://joinmastodon.org/servers",target:"_blank",children:e(h,{id:"LcOiWS"})})}),e("p",{children:e(ge,{to:"/",children:e(h,{id:"iWpEwy"})})}),e(vi,{})]})})}const jl=40;function Gl(){const{_:n}=de(),i=Ge(x);tt(n({id:"+GkIdc"}),"/sp");const{masto:s}=ce(),[o,c]=R([]),[r,u]=R("default"),[d,l]=Rt(y=>y+1,0),[a,p]=R(!1);return ie(l,[i.reloadScheduledPosts]),ie(()=>{u("loading"),(async()=>{try{const y=s.v1.scheduledStatuses.list({limit:jl}),m=[];let b;do b=(await y.next()).value,b!=null&&b.length&&m.push(...b);while(b!=null&&b.length);c(m)}catch{u("error")}finally{u("default")}})()},[d]),e("div",{id:"scheduled-posts-page",class:"deck-container",tabIndex:"-1",children:e("div",{class:"timeline-deck deck",children:[e("header",{children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Mt,{}),e(ge,{to:"/",class:"button plain",children:e(A,{icon:"home",size:"l",alt:n({id:"i0qMbr"})})})]}),e("h1",{children:e(h,{id:"+GkIdc"})}),e("div",{class:"header-side",children:e(lt,{portal:!0,setDownOverflow:!0,overflow:"auto",viewScroll:"close",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(A,{icon:"more",size:"l",alt:n({id:"2FYpfJ"})})}),children:e(ve,{onClick:()=>{l()},children:[e(A,{icon:"refresh",size:"l"}),e("span",{children:e(h,{id:"lCF0wC"})})]})})})]})}),e("main",{children:[o.length?e("ul",{class:"posts-list",children:o.map(y=>{const{id:m,params:b,scheduledAt:f,mediaAttachments:g}=y,{inReplyToId:v,language:w,poll:_,sensitive:S,spoilerText:k,text:T,visibility:C}=b,I={id:m,inReplyToId:v,language:w,mediaAttachments:g,poll:_?{..._,expiresAt:new Date(Date.now()+_.expiresIn*1e3),options:_.options.map(E=>({title:E,votesCount:0}))}:void 0,sensitive:S,spoilerText:k,text:T,visibility:C,content:`<p>${T}</p>`};return e("li",{children:e(Kl,{status:I,scheduledAt:f,onClick:()=>{p({post:I,scheduledAt:new Date(f)})}})},m)})}):e("p",{class:"ui-state",children:r==="loading"?e(Ue,{}):n({id:"mZYb1f"})}),a&&e(He,{onClick:y=>{y.target===y.currentTarget&&p(!1)},children:e(Vl,{post:a.post,scheduledAt:a.scheduledAt,onClose:()=>p(!1)})})]})]})})}function Kl({status:n,scheduledAt:i,onClick:s}){const o=_e(()=>{const c=(new Date(i).getTime()-Date.now())/36e5;return c<24?"time":c<720?"day":"month"},[i]);return e("button",{type:"button",class:"textual block",onClick:s,children:[e("div",{class:`post-schedule-meta post-schedule-${o}`,children:[e(A,{icon:o,class:"insignificant"})," ",e("span",{children:e(h,{id:"aEp6lO",values:{0:ct(i,{formatOpts:{weekday:"short",second:"numeric"}})},components:{0:e("b",{}),1:e(It,{datetime:i}),2:e("small",{})}})})]}),e(qe,{status:n,size:"s",previewMode:!0,readOnly:!0})]})}function Vl({post:n,scheduledAt:i,onClose:s}){const{masto:o}=ce(),{_:c}=de(),[r,u]=R("default"),[d,l]=R(),a=d&&d.getTime()!==i.getTime(),p=Xo(),y=i&&i<=Date.now(),{inReplyToId:m}=n,[b,f]=R(null);return e("div",{id:"scheduled-post-sheet",class:"sheet",children:[e("button",{type:"button",class:"sheet-close",onClick:s,children:e(A,{icon:"x",size:"l",alt:c({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:[e(h,{id:"orjBLU",components:{0:e("b",{}),1:e(It,{datetime:i})}}),e("br",{}),e("small",{children:ct(i,{formatOpts:{weekday:"short",second:"numeric"}})})]})}),e("main",{tabIndex:"-1",children:[!!b&&e("div",{class:"status-reply",children:e(qe,{status:b,size:"s",previewMode:!0,readOnly:!0})}),e(qe,{status:n,size:"s",previewMode:!0,readOnly:!0,onMediaClick:(g,v,w,_)=>{g.preventDefault(),x.showMediaModal={mediaAttachments:n.mediaAttachments,mediaIndex:v}}}),e("form",{onSubmit:g=>{g.preventDefault(),u("loading"),(async()=>{try{await o.v1.scheduledStatuses.$select(n.id).update({scheduledAt:d.toISOString()}),pe(c({id:"40naR1"})),s(),u("default"),x.reloadScheduledPosts++}catch{u("error"),pe(c({id:"ZM3jAs"}))}})()},children:e("footer",{children:[e("div",{class:"row",children:e("span",{children:[e(Jo,{scheduledAt:i,setScheduledAt:g=>{l(g)}})," ",e("small",{class:"ib",children:p})]})}),e("div",{class:"row",children:[e("button",{disabled:!a||r==="loading"||y,children:e(h,{id:"QqW27M"})}),e("span",{class:"grow"}),e(ht,{align:"end",menuItemClassName:"danger",confirmLabel:c({id:"09u3Kk"}),onClick:()=>{u("loading"),(async()=>{try{await ce().masto.v1.scheduledStatuses.$select(n.id).remove(),pe(c({id:"/zL/Mq"})),s(),u("default"),x.reloadScheduledPosts++}catch{u("error"),pe(c({id:"aOh6Md"}))}})()},children:e("button",{type:"button",class:"light danger",disabled:r==="loading"||y,children:e(h,{id:"Jb6/SB"})})})]})]})})]})]})}const Wl={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Blaede Phanpy",PHANPY_DEFAULT_INSTANCE:"mastodon.blaede.family",PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:"https://mastodon.blaede.family/auth/sign_up",PHANPY_GIPHY_API_KEY:"48JGsrSS1XE5w4nWe9c9hqxPbsfRWR0e",PHANPY_LINGVA_INSTANCES:"lingva.phanpy.social lingva.lunar.icu lingva.garudalinux.org translate.plausibility.cloud",PHANPY_PRIVACY_POLICY_URL:"https://mastodon.blaede.family/privacy-policy",PHANPY_TRANSLANG_INSTANCES:"translang.phanpy.social",PHANPY_WEBSITE:"https://phanpy.blaede.family",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},{PHANPY_DEFAULT_INSTANCE:os}=Wl,mn=40,Zl=10,Xl=5;let si={},wn={},kn={};function Sn(n){delete wn[n],delete kn[n]}const Jt={block:"nearest",inline:"center",behavior:"smooth"},cs=".status-link:not(details:not([open]) > summary ~ *, details:not([open]) > summary ~ * *), .status-focus:not(details:not([open]) > summary ~ *, details:not([open]) > summary ~ * *)",as=/\/s\//i;function Jl(n){var T;const{_:i}=de(),{id:s}=n,{masto:o,instance:c}=ce({instance:n.instance}),r=Ge(x),[u,d]=yt(),l=u.get("media"),a=u.get("media-only"),p=parseInt(l||a,10);let y=p>0;const m=u.get("mediaStatusID"),b=vs(m,c);m&&!b&&(y=!1);const f=y&&!!a,g=rt(s,c),[v,w]=R(x.statuses[g]);ie(()=>{x.statuses[g]&&w(x.statuses[g])},[g]);const _=_e(()=>{const{prevLocation:C}=x,I=((C==null?void 0:C.pathname)||"")+((C==null?void 0:C.search)||""),E=nn("/:instance/s/:id",I)||nn("/s/:id",I);return!I||E?"/":I},[]);ie(()=>{!v&&y&&(async()=>{try{const C=await o.v1.statuses.$select(s).fetch();Qe(C,c),w(C)}catch{alert("Unable to load post."),location.hash=_}})()},[y]);const S=m?(T=r.statuses[rt(m,c)])==null?void 0:T.mediaAttachments:v==null?void 0:v.mediaAttachments,k=ot(()=>{!window.matchMedia("(min-width: calc(40em + 350px))").matches&&r.prevLocation?history.back():f?location.hash=_:(u.delete("media"),u.delete("mediaStatusID"),d(u))},[f,_,r.prevLocation]);return ie(()=>{let C=setTimeout(()=>{const I=document.querySelector(".carousel");I&&I.focus()},100);return()=>clearTimeout(C)},[f]),ie(()=>{const C=document.querySelectorAll(".deck-container");return C.forEach(I=>{I.setAttribute("inert","")}),()=>{C.forEach(I=>{I.removeAttribute("inert")})}},[]),e("div",{class:"deck-backdrop",children:[y?S!=null&&S.length?e(Gs,{mediaAttachments:S,statusID:m||s,instance:c,lang:v==null?void 0:v.language,index:p-1,onClose:k}):e("div",{class:"media-modal-container loading",children:e(Ue,{abrupt:!0})}):e(ge,{to:_}),!f&&e(ed,{id:s,instance:n.instance,closeLink:_})]})}function Ql(n){const{linkable:i,to:s,onClick:o,...c}=n;return i?e(ge,{class:"status-link",to:s,onClick:o,...c}):e("div",{class:"status-focus",tabIndex:0,...c})}function rs(n,i){return new Date(i.created_at)-new Date(n.created_at)}function ed({id:n,closeLink:i="/",instance:s}){var oe,xe;const{_:o}=de(),[c,r]=yt(),u=c.get("media"),d=c.get("mediaStatusID"),l=parseInt(u,10)>0,a=q(!x.prevLocation&&(history.length===1||"navigation"in window&&((xe=(oe=navigation==null?void 0:navigation.entries)==null?void 0:oe.call(navigation))==null?void 0:xe.length)===1)),[p,y]=R(c.get("view")||a.current?"full":null),m=!!parseInt(c.get("translate")),{masto:b,instance:f}=ce({instance:s}),{masto:g,instance:v,authenticated:w}=ce(),_=f===v,S=Ge(x),[k,T]=R([]),[C,I]=R("default"),E=q(),L=rt(n,f),B=q(0),P=q();ie(()=>{var O;(O=P.current)==null||O.focus()},[]),ie(()=>{var ee;const O=Ls(()=>{if(!P.current)return;const{scrollTop:fe}=P.current;C!=="loading"&&(kn[n]=fe)},50);return(ee=P.current)==null||ee.addEventListener("scroll",O,{passive:!0}),O(),()=>{var fe;O.cancel(),(fe=P.current)==null||fe.removeEventListener("scroll",O)}},[n,C!=="loading"]);const Y=q(),Q=q(),te=({reloadHero:O}={})=>{I("loading");let ee;const fe=wn[n];if(fe){const D=fe.filter(ae=>x.statuses[L]);T(D)}else T([{id:n}]);return(async()=>{var Pe,je;const D=()=>Mi(()=>b.v1.statuses.$select(n).fetch(),{retries:4}),ae=Mi(()=>b.v1.statuses.$select(n).context.fetch(),{retries:8}),Ie=!!S.statuses[L];let Se=S.statuses[L];if(!(Ie&&!O))try{Se=await D(),Qe(Se,f),await new Promise($=>{setTimeout($,100)})}catch{I("error");return}try{let $=function(me,Me){const Ze=Me+1;return Ze>Ce&&(Ce=Me),me==null?void 0:me.map(nt=>({id:nt.id,account:nt.account,repliesCount:nt.repliesCount,content:nt.content,weight:tn(nt),level:Ze,replies:$(nt.__replies,Ze)}))};const N=await ae,{ancestors:W,descendants:j}=N;W.sort(rs),j.sort(rs),B.current=(j==null?void 0:j.length)||0;const K=new Set;W.forEach(me=>{Qe(me,f,{skipThreading:!0}),me.inReplyToId&&!W.find(Me=>Me.id===me.inReplyToId)&&K.add(me.inReplyToId)});const Oe=W.every(me=>me.account.id===Se.account.id),Ae=[];j.forEach(me=>{if(Qe(me,f,{skipThreading:!0}),me.inReplyToId&&!j.find(Me=>Me.id===me.inReplyToId)&&me.inReplyToId!==Se.id&&K.add(me.inReplyToId),me.inReplyToAccountId===me.account.id)Ae.push(me);else if(me.inReplyToId===Se.id)Ae.push(me);else if(!me.inReplyToAccountId&&Ae.find(Me=>Me.id===me.inReplyToId&&Me.account.id===Se.account.id)&&me.account.id===Se.account.id)Ae.push(me);else{const Me=j.find(Ze=>Ze.id===me.inReplyToId);Me&&(Me.__replies||(Me.__replies=[]),Me.__replies.push(me))}}),Ae.sort((me,Me)=>{const Ze=Se.account.id;return me.account.id===Ze&&Me.account.id!==Ze?-1:Me.account.id===Ze&&me.account.id!==Ze?1:0}),K.size;let Ce=1;const Be=[...W.map(me=>({id:me.id,ancestor:!0,isThread:Oe,accountID:me.account.id,account:me.account,repliesCount:me.repliesCount,weight:tn(me)})),{id:n,accountID:Se.account.id,weight:tn(Se)},...Ae.map(me=>({id:me.id,account:me.account,accountID:me.account.id,descendant:!0,thread:me.account.id===Se.account.id,weight:tn(me),level:1,replies:$(me.__replies,1)}))];I("default"),Y.current={offsetTop:(Pe=E.current)==null?void 0:Pe.offsetTop,scrollTop:(je=P.current)==null?void 0:je.scrollTop};const We=W.length||0;We>=re&&H(We+1),T(Be),wn[n]=Be,xo(Se,f)}catch{I("error")}})(),Q.current=Date.now(),()=>{clearTimeout(ee)}};ie(te,[n,b]);const[J,V]=R(!1);ie(()=>{let O=setInterval(()=>{const ee=Date.now();Q.current&&ee-Q.current>=6e4&&V(!0)},6e4);return()=>{clearInterval(O)}},[]),kt(()=>{var ee,fe;if(!k.length)return;const O=kn[n];if(O)P.current.scrollTop=O;else if(Y.current){const D={offsetTop:(ee=E.current)==null?void 0:ee.offsetTop,scrollTop:(fe=P.current)==null?void 0:fe.scrollTop},ae=D.offsetTop-Y.current.offsetTop+D.scrollTop;P.current.scrollTop=ae}else k.length===1&&(P.current.scrollTop=0);Y.current=null},[k]),ie(()=>{S.reloadStatusPage<=0||(async()=>{try{const{instanceURL:O}=ci(),ee=`https://${O}/api/v1/statuses/${n}/context`;return await(await caches.open("api")).delete(ee,{ignoreVary:!0}),te({reloadHero:!0})}catch{}})()},[S.reloadStatusPage]),ie(()=>()=>{kn={},x.reloadStatusPage=0,wn={},si={},oi.clear()},[]);const z=S.statuses[L]||S.statuses[n],ue=_e(()=>{if(!z)return"";const{account:O}=z,ee=document.createElement("div");return ee.innerHTML=O.displayName,ee.innerText.trim()},[z]),M=_e(()=>{if(!z)return"";let O=Ln(z);return O.length>64&&(O=O.slice(0,64)+"…"),O},[z]);tt(ue&&M?`${ue}: "${M}"`:o({id:"post.title"}),"/:instance?/s/:id");const F=_e(()=>{var ee;if(!z)return;const{url:O}=z;if(O)return(ee=URL.parse(O))==null?void 0:ee.hostname},[z]),G=_e(()=>{if(F)return F===f},[F,f]),[re,H]=R(mn),se=_e(()=>k.length-re,[k.length,re]),be=k.some(O=>O.descendant),we=k.filter(O=>O.ancestor),[Z,le]=R(!0),Re=_e(()=>{if(!E.current||Z)return null;const{top:O}=E.current.getBoundingClientRect();return O>0?"down":"up"},[Z]);Fe("esc",()=>{location.hash=i},{enabled:!l,ignoreEventWhen:O=>!!document.querySelector("#modal-container > *")}),Fe("backspace",()=>{location.hash=i}),Fe("j",()=>{const O=document.activeElement.closest(".status-link, .status-focus"),ee=O==null?void 0:O.getBoundingClientRect(),fe=Array.from(P.current.querySelectorAll(cs));if(O&&ee.top<P.current.clientHeight&&ee.bottom>0){const D=fe.indexOf(O);let ae=fe[D+1];ae&&(ae.focus(),ae.scrollIntoView(Jt))}else{const D=fe.find(ae=>{const Ie=ae.getBoundingClientRect();return Ie.top>=44&&Ie.left>=0});D&&(D.focus(),D.scrollIntoView(Jt))}},{useKey:!0}),Fe("k",()=>{const O=document.activeElement.closest(".status-link, .status-focus"),ee=O==null?void 0:O.getBoundingClientRect(),fe=Array.from(P.current.querySelectorAll(cs));if(O&&ee.top<P.current.clientHeight&&ee.bottom>0){const D=fe.indexOf(O);let ae=fe[D-1];ae&&(ae.focus(),ae.scrollIntoView(Jt))}else{const D=fe.find(ae=>{const Ie=ae.getBoundingClientRect();return Ie.top>=44&&Ie.left>=0});D&&(D.focus(),D.scrollIntoView(Jt))}},{useKey:!0}),Fe("x",()=>{const O=document.activeElement.closest(".status-link, .status-focus");if(O){const ee=O.nextElementSibling;ee&&ee.tagName.toLowerCase()==="details"&&(ee.open=!ee.open)}},{useKey:!0});const[$e,De]=R(!1),ze=q(l?"media+status":"status"),Le=ot((O,ee,fe,D)=>{O.preventDefault(),O.stopPropagation(),r({media:ee+1,mediaStatusID:D.id})},[n]),Te=ot((O,ee)=>{Sn(ee.id)},[]);ie(()=>{let O;return d&&l&&(O=setTimeout(()=>{var fe;const ee=(fe=P.current)==null?void 0:fe.querySelector(`.status-link[href*="/${d}"]`);ee&&ee.scrollIntoView(Jt)},400)),()=>{clearTimeout(O)}},[d,l]);const X=ot((O,ee)=>{const{id:fe,ancestor:D,isThread:ae,descendant:Ie,thread:Se,replies:Pe,repliesCount:je,weight:$,level:N}=O,W=fe===n;return e("li",{ref:W?E:null,class:`${D?"ancestor":""} ${Ie?"descendant":""} ${Se?"thread":""} ${W?"hero":""}`,children:[W?e(U,{children:[e(Ct,{threshold:.1,onChange:K=>{queueMicrotask(()=>{requestAnimationFrame(()=>{le(K)})})},class:"status-focus",tabIndex:0,children:e(qe,{statusID:fe,instance:f,withinContext:!0,size:"l",enableTranslate:!0,forceTranslate:m})}),C!=="loading"&&!w?e("div",{class:"post-status-banner",children:[e("p",{children:e(h,{id:"Vyeh4F"})}),e(ge,{to:os?`/login?instance=${os}&submit=1`:"/login",class:"button",children:e(h,{id:"sQia9P"})})]}):!_&&e("div",{class:"post-status-banner",children:[e("p",{children:e(h,{id:"j5roNG",values:{instance:f},components:{0:e("b",{})}})}),e("button",{type:"button",disabled:C==="loading",onClick:()=>{I("loading"),(async()=>{try{const K=await g.v2.search.fetch({q:z.url,type:"statuses",resolve:!0,limit:1});if(K.statuses.length){const Oe=K.statuses[0];location.hash=v?`/${v}/s/${Oe.id}`:`/s/${Oe.id}`}else throw new Error("No results")}catch(K){I("default"),alert(o({id:"DnepCE",values:{e:K}}))}})()},children:[e(A,{icon:"transfer"})," ",e(h,{id:"ejAVrO"})]})]})]}):e(Ql,{linkable:ae||D,to:f?`/${f}/s/${fe}`:`/s/${fe}`,onClick:()=>{Sn(fe)},children:[ee===0&&D?e(Ct,{threshold:.5,onChange:K=>{queueMicrotask(()=>{requestAnimationFrame(()=>{De(K)})})},children:e(qe,{statusID:fe,instance:f,withinContext:!0,size:Se||D?"m":"s",enableTranslate:!0,onMediaClick:Le,onStatusLinkClick:Te})}):e(qe,{statusID:fe,instance:f,withinContext:!0,size:Se||D?"m":"s",enableTranslate:!0,onMediaClick:Le,onStatusLinkClick:Te,showActionsBar:!!Ie}),D&&je>1&&e("div",{class:"replies-link",children:[e(A,{icon:"comment2",alt:o({id:"N8UzTV"})})," ",e("span",{title:je,children:Je(je)})]})," "]}),Ie&&(Pe==null?void 0:Pe.length)>0&&e(po,{instance:f,replies:Pe,hasParentThread:Se,level:N,accWeight:$,openAll:B.current<Zl,parentLink:{to:f?`/${f}/s/${fe}`:`/s/${fe}`,onClick:()=>Sn(fe)}}),C==="loading"&&W&&!!(z!=null&&z.repliesCount)&&!be&&e("div",{class:"status-loading",children:e(Ue,{abrupt:z.repliesCount>=3})}),C==="error"&&W&&!!(z!=null&&z.repliesCount)&&!be&&e("div",{class:"status-error",children:[e(h,{id:"HQJU6W"}),e("br",{}),e("button",{type:"button",class:"plain",onClick:()=>{x.reloadStatusPage++},children:e(h,{id:"KDw4GX"})})]})]},fe)},[n,f,C,w,_,m,Le,Te,be]),ke=_e(()=>{var O;if("navigation"in window&&(navigation!=null&&navigation.entries)){const ee=navigation.entries()[navigation.currentEntry.index-1];if(ee!=null&&ee.url)return as.test(ee.url)}return as.test((O=x.prevLocation)==null?void 0:O.pathname)},[L]),Ne=_e(()=>{if(!se)return[];const O=[];function ee(fe){O.push(fe.id),fe.replies&&fe.replies.forEach(ee)}return k.slice(re).forEach(ee),O.map(fe=>rt(fe,f))},[se,k,re,f]),ne=_e(()=>k.slice(0,re).map(X),[k,re,X]);return ie(()=>{let O=setTimeout(()=>{if(!E.current)return;const ee=E.current.querySelector(".spoiler-button:not(.spoiling), .spoiler-media-button:not(.spoiling)");ee&&ee.click()},1e3);return()=>clearTimeout(O)},[n]),e("div",{tabIndex:"-1",ref:P,class:`status-deck deck contained ${k.length>1?"padded-bottom":""} ${ze.current==="status"&&!a.current?"slide-in":""} ${p?`deck-view-${p}`:""}`,onAnimationEnd:O=>{ze.current==="status"&&(ze.current=null)},children:[e("header",{class:`${C==="loading"?"loading":""}`,onDblClick:O=>{x.reloadStatusPage++},children:e("div",{class:"header-grid header-grid-2",children:[e("h1",{children:[ke&&e("button",{type:"button",class:"plain deck-back",onClick:()=>{history.back()},children:e(A,{icon:"chevron-left",size:"xl",alt:o({id:"iH8pgl"})})}),!Z&&z&&C!=="loading"?e(U,{children:[e("span",{class:"hero-heading",children:[e(gt,{account:z.account,instance:f,showAvatar:!0,short:!0})," ",e("span",{class:"insignificant",children:["•"," ",e(It,{datetime:z.createdAt,format:"micro"})]})]})," ",e("button",{type:"button",class:"ancestors-indicator light small",onClick:O=>{O.preventDefault(),O.stopPropagation(),E.current.scrollIntoView({behavior:"smooth",block:"start"})},title:o({id:"NCy+Nw"}),children:e(A,{icon:Re==="down"?"arrow-down":"arrow-up"})})]}):e(U,{children:[e(h,{id:"post.title"})," ",e("button",{type:"button",class:"ancestors-indicator light small",onClick:O=>{O.preventDefault(),O.stopPropagation(),P.current.scrollTo({top:0,behavior:"smooth"})},hidden:!we.length||$e,title:o({id:"R8CUl0",values:{0:we.length}}),children:[e(A,{icon:"arrow-up"}),we.filter((O,ee,fe)=>fe.findIndex(D=>D.accountID===O.accountID)===ee).slice(0,3).map(O=>e(pt,{url:O.account.avatar,alt:O.account.displayName},O.account.id)),we.length>3&&e(U,{children:[" ",e("span",{class:"insignificant",children:Je(we.length)})]})]})]})]}),e("div",{class:"header-side",children:[e("button",{type:"button",class:"plain4 button-switch-view",style:{display:p==="full"?"":"none"},onClick:()=>{y(null),c.delete("media"),c.delete("media-only"),c.delete("view"),r(c)},title:o({id:"+/xYEI"}),children:e(A,{icon:"layout4",size:"l"})}),J&&e("button",{type:"button",class:"plain button-refresh",onClick:()=>{x.reloadStatusPage++,V(!1)},children:e(A,{icon:"refresh",size:"l",alt:o({id:"lCF0wC"})})}),e(lt,{align:"end",portal:{target:P.current},menuButton:e("button",{type:"button",class:"button plain4",children:e(A,{icon:"more",alt:o({id:"2FYpfJ"}),size:"xl"})}),children:[e(ve,{disabled:C==="loading",onClick:()=>{x.reloadStatusPage++},children:[e(A,{icon:"refresh"}),e("span",{children:e(h,{id:"lCF0wC"})})]}),e(ve,{className:"menu-switch-view",onClick:()=>{y(p==="full"?null:"full"),c.delete("media"),c.delete("media-only"),p==="full"?c.delete("view"):c.set("view","full"),r(c)},children:[e(A,{icon:{"":"layout5",full:"layout4"}[p||""]}),e("span",{children:o(p==="full"?{id:"+/xYEI"}:{id:"2LiWsE"})})]}),e(ve,{onClick:()=>{Array.from(P.current.querySelectorAll(".spoiler-button:not(.spoiling), .spoiler-media-button:not(.spoiling)")).forEach(ee=>{ee.click()})},children:[e(A,{icon:"eye-open"})," ",e("span",{children:e(h,{id:"8r8KmB"})})]}),e(Ve,{}),e(Rs,{className:"plain",children:e(h,{id:"Rsjgm0"})}),e(ve,{disabled:!F||G,onClick:()=>{const O=Cl(z.url);O?location.hash=O:alert(o({id:"9J6biQ"}))},children:[e(A,{icon:"transfer"}),e("small",{class:"menu-double-lines",children:o(F?{id:"Kp9SAs",values:{0:rn.toUnicode(F)}}:{id:"lb07+k"})})]})]}),e(ge,{class:"button plain deck-close",to:i,children:e(A,{icon:"x",size:"xl",alt:o({id:"yz7wBu"})})})]})]})}),k.length&&z?e("ul",{class:`timeline flat contextual grow ${C==="loading"?"loading":""}`,children:[ne,se>0&&e("li",{class:"descendant descendant-more",children:e("button",{type:"button",class:"plain block show-more",disabled:C==="loading",onClick:()=>H(O=>O+mn),style:{marginBlockEnd:"6em"},"data-state-post-ids":Ne.join(" "),children:[e("div",{class:"ib avatars-bunch",children:k.slice(re,re+5).map(O=>e(pt,{url:O.account.avatarStatic},O.id))})," ",e("div",{class:"ib",children:[e(h,{id:"uXRAkV"})," ",e("span",{class:"tag",children:se>mn?`${mn}+`:se})]})]})})]}):e(U,{children:[C==="loading"&&e("ul",{class:"timeline flat contextual grow loading",children:e("li",{children:e(qe,{skeleton:!0,size:"l"})})}),C==="error"&&e("p",{class:"ui-state",children:[e(h,{id:"JWxodU"}),e("br",{}),e("br",{}),e("button",{type:"button",onClick:()=>{x.reloadStatusPage++},children:e(h,{id:"KDw4GX"})})]})]})]})}function po({replies:n,instance:i,hasParentThread:s,level:o,accWeight:c,openAll:r,parentLink:u}){const{_:d}=de(),[l,a]=yt(),p=I=>I.reduce((E,L)=>{const{repliesCount:B,replies:P}=L,Y=(P==null?void 0:P.length)||B;return E+Y+p(P||[])},0),y=n.length+p(n),m=n.length===y,b=n.map(I=>I.account).filter((I,E,L)=>L.findIndex(B=>B.id===I.id)===E).slice(0,3),f=_e(()=>n==null?void 0:n.reduce((I,E)=>I+(E==null?void 0:E.weight),c),[c,n==null?void 0:n.length]);let g=!1;(r||f<=Xl||!s&&y===1&&tn(n[0])<2)&&(g=!0);const v=si[n[0].id],w=ot((I,E,L,B)=>{I.preventDefault(),I.stopPropagation(),a({media:E+1,mediaStatusID:B.id})},[]),_=q();kt(()=>{var E;function I(L){L.target.dataset.scrollLeft=L.target.scrollLeft}return(E=_.current)==null||E.addEventListener("scroll",I,{passive:!0}),()=>{var L;(L=_.current)==null||L.removeEventListener("scroll",I)}},[]);const[S,k]=R(v||g);ie(()=>{let I;return!v&&!g&&(I=setTimeout(()=>k(!0),100)),()=>clearTimeout(I)},[v,g]);const T=g?"div":"details",C=T==="details";return e(T,{ref:_,class:"replies",open:C?v||g:void 0,onToggle:C?I=>{const{open:E}=I.target;si[n[0].id]=E}:void 0,style:{"--comments-level":o},"data-comments-level":o,"data-comments-level-overflow":o>4,children:[!g&&e("summary",{class:"replies-summary",hidden:g,children:[e("span",{class:"avatars",children:b.map(I=>e(pt,{url:I.avatarStatic,title:`${I.displayName} @${I.username}`,squircle:I==null?void 0:I.bot},I.id))}),e("span",{class:"replies-counts",children:[e("b",{children:e(h,{id:"DOQUen",values:{0:n.length,1:Je(n.length)},components:{0:e("span",{title:n.length})}})}),!m&&y>1&&e(U,{children:[" ","·"," ",e("span",{children:e(h,{id:"qSQQSe",values:{0:Je(y),totalComments:y},components:{0:e("span",{title:y})}})})]})]}),e(A,{icon:"chevron-down",class:"replies-summary-chevron"}),!!u&&e(ge,{class:"replies-parent-link",to:u.to,onClick:u.onClick,title:d({id:"ZlV82A"}),children:"»"})]}),S&&e("ul",{children:n.map(I=>{var E,L;return e("li",{children:[e("div",{class:"status-focus",tabIndex:0,children:[e(qe,{statusID:I.id,instance:i,withinContext:!0,size:"s",enableTranslate:!0,onMediaClick:w,showActionsBar:!0}),!((E=I.replies)!=null&&E.length)&&I.repliesCount>0&&e("div",{class:"replies-link",children:[e(A,{icon:"comment2",alt:d({id:"N8UzTV"})})," ",e("span",{title:I.repliesCount,children:Je(I.repliesCount)})]})]}),((L=I.replies)==null?void 0:L.length)&&e(po,{instance:i,replies:I.replies,level:I.level,accWeight:g?f:I.weight,openAll:r,parentLink:{to:i?`/${i}/s/${I.id}`:`/s/${I.id}`,onClick:()=>{Sn(I.id)}}})]},I.id)})})]})}const td=140,nd=35,id=70,sd=140,oi=new Map;function tn(n){var b,f;const i=oi.get(n.id);if(i)return i;const{spoilerText:s,content:o,mediaAttachments:c,poll:r,card:u}=n,d=Es(s+o),l=c!=null&&c.length?td:0,a=(((b=r==null?void 0:r.options)==null?void 0:b.length)||0)*nd,p=u&&(c!=null&&c.length||(f=r==null?void 0:r.options)!=null&&f.length)?0:id,m=(d+l+a+p)/sd;return oi.set(n.id,m),m}const od=dt(Jl);function cd(){const n=Lt(),{id:i,instance:s}=n;return e(od,{id:i,instance:s})}const ad=""+new URL("boosts-carousel-BiOaNdMT.jpg",import.meta.url).href,rd=""+new URL("grouped-notifications-DFgwVVj3.jpg",import.meta.url).href,ld=""+new URL("multi-column-ROck0NVt.jpg",import.meta.url).href,dd=""+new URL("multi-hashtag-timeline-DH5INVHi.jpg",import.meta.url).href,ud=""+new URL("nested-comments-thread-hv59kZLc.jpg",import.meta.url).href,hd="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20fill-rule='evenodd'%20stroke-linejoin='round'%20stroke-miterlimit='2'%20clip-rule='evenodd'%20viewBox='0%200%20102%2028'%3e%3cpath%20fill='none'%20d='M0%200h101.5v27.5H0z'/%3e%3cg%20fill-rule='nonzero'%3e%3cpath%20fill='url(%23a)'%20d='M2.32%2021.85c1.4%200%202.21-.85%202.21-2.3v-4.64H8.5c4.45%200%207.54-2.9%207.54-7.24%200-4.35-2.98-7.24-7.32-7.24h-6.4C.93.43.11%201.28.11%202.73v16.82c0%201.45.82%202.3%202.21%202.3Zm2.21-10.4V3.94h3c2.54%200%204%201.34%204%203.75s-1.47%203.76-4%203.76h-3Z'/%3e%3cpath%20fill='url(%23b)'%20d='M20.52%2021.88c1.25%200%202.13-.76%202.13-2.23v-7.04c0-2.07%201.2-3.49%203.21-3.49%201.95%200%202.95%201.23%202.95%203.25v7.28c0%201.47.89%202.23%202.13%202.23%201.26%200%202.14-.76%202.14-2.23v-8.18c0-3.64-1.99-5.9-5.48-5.9-2.38%200-4.1%201.12-4.93%203.1h-.09V2.3c0-1.38-.78-2.2-2.1-2.2-1.31%200-2.1.82-2.1%202.2v17.34c0%201.47.9%202.23%202.14%202.23Z'/%3e%3cpath%20fill='url(%23c)'%20d='M40.45%2021.82c1.96%200%203.93-.98%204.8-2.65h.1v.8c.08%201.27.89%201.91%202.05%201.91%201.21%200%202.08-.73%202.08-2.15v-8.95c0-3.17-2.63-5.25-6.65-5.25-3.26%200-5.78%201.16-6.5%203.04-.15.32-.23.63-.23.96%200%20.97.75%201.64%201.79%201.64.69%200%201.23-.26%201.7-.79.95-1.23%201.74-1.65%203.04-1.65%201.62%200%202.64.85%202.64%202.31v1.04l-3.95.24c-3.93.23-6.13%201.88-6.13%204.74%200%202.83%202.27%204.76%205.26%204.76Zm1.4-3.09c-1.43%200-2.4-.73-2.4-1.9%200-1.12.91-1.83%202.51-1.95l3.31-.2v1.14c0%201.7-1.54%202.91-3.41%202.91Z'/%3e%3cpath%20fill='url(%23d)'%20d='M54.37%2021.88c1.26%200%202.14-.76%202.14-2.23v-7.09c0-2.03%201.21-3.44%203.13-3.44s2.89%201.17%202.89%203.22v7.31c0%201.47.88%202.23%202.14%202.23%201.24%200%202.13-.76%202.13-2.23v-8.2c0-3.68-1.96-5.87-5.45-5.87-2.41%200-4%201.07-4.83%203.01h-.09v-.87c0-1.35-.85-2.17-2.14-2.17-1.28%200-2.06.82-2.06%202.15v11.95c0%201.47.9%202.23%202.14%202.23Z'/%3e%3cpath%20fill='url(%23e)'%20d='M71.65%2027.17c1.26%200%202.14-.76%202.14-2.23v-6h.09a5.15%205.15%200%200%200%204.88%202.88c3.92%200%206.35-3.05%206.35-8.1%200-5.07-2.44-8.1-6.43-8.1a5.12%205.12%200%200%200-4.86%202.99h-.09v-.85c0-1.45-.88-2.21-2.1-2.21-1.24%200-2.11.76-2.11%202.2v17.2c0%201.46.89%202.22%202.13%202.22Zm5.6-8.8c-2.1%200-3.47-1.8-3.47-4.65%200-2.81%201.37-4.67%203.47-4.67%202.14%200%203.49%201.83%203.49%204.67%200%202.86-1.35%204.66-3.5%204.66Z'/%3e%3cpath%20fill='url(%23f)'%20d='M89.61%2027.39c3.44%200%205.26-1.5%206.73-5.55l4.81-13.1a4%204%200%200%200%20.24-1.26c0-1.13-.85-1.93-2.08-1.93-1.1%200-1.71.51-2.07%201.7l-3.4%2010.9h-.08L90.35%207.28c-.36-1.25-.94-1.73-2.07-1.73-1.26%200-2.21.83-2.21%201.99%200%20.35.09.82.25%201.26l5%2013.21-.21.56c-.52%201.1-1.32%201.42-2.07%201.42l-.75-.01c-.96%200-1.56.54-1.56%201.4%200%201.29%201%202%202.88%202Z'/%3e%3c/g%3e%3cdefs%3e%3cradialGradient%20id='a'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3cradialGradient%20id='b'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3cradialGradient%20id='c'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3cradialGradient%20id='d'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3cradialGradient%20id='e'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3cradialGradient%20id='f'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3c/defs%3e%3c/svg%3e",fd={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Blaede Phanpy",PHANPY_DEFAULT_INSTANCE:"mastodon.blaede.family",PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:"https://mastodon.blaede.family/auth/sign_up",PHANPY_GIPHY_API_KEY:"48JGsrSS1XE5w4nWe9c9hqxPbsfRWR0e",PHANPY_LINGVA_INSTANCES:"lingva.phanpy.social lingva.lunar.icu lingva.garudalinux.org translate.plausibility.cloud",PHANPY_PRIVACY_POLICY_URL:"https://mastodon.blaede.family/privacy-policy",PHANPY_TRANSLANG_INSTANCES:"translang.phanpy.social",PHANPY_WEBSITE:"https://phanpy.blaede.family",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},{PHANPY_DEFAULT_INSTANCE:Qt,PHANPY_WEBSITE:ls,PHANPY_PRIVACY_POLICY_URL:pd,PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:ds}=fd,us=ls?ls.replace(/https?:\/\//g,"").replace(/\/$/,""):null,hs=`${"2025-04-23T16:49:10.780Z".slice(0,10).replace(/-/g,".")}.4f6f237`;function mo(){const{_:n}=de();return tt(null,["/","/welcome"]),e("main",{id:"welcome",children:[e("div",{class:"hero-container",children:[e("div",{class:"hero-content",children:[e("h1",{children:[e("img",{src:yi,alt:"",width:"160",height:"160",style:{aspectRatio:"1/1",marginBlockEnd:-16}}),e("img",{src:hd,alt:"Phanpy",width:"200"})]}),e("p",{class:"desc",children:e(h,{id:"Ogtv0V"})}),e("p",{children:e(ge,{to:Qt?`/login?instance=${Qt}&submit=1`:"/login",class:"button",children:n(Qt?{id:"sQia9P"}:{id:"ZLoGls"})})}),Qt&&ds&&e("p",{children:e("a",{href:ds,class:"button plain5",children:e(h,{id:"e+RpCP"})})}),!Qt&&e("p",{class:"insignificant",children:e("small",{children:e(h,{id:"fvAsUK",components:{0:e("br",{})}})})})]}),(us||hs)&&e("p",{class:"app-site-version",children:e("small",{children:[us," ",hs]})}),e("p",{children:e(h,{id:"BskFI2",components:{0:e("a",{href:"https://github.com/cheeaun/phanpy",target:"_blank"}),1:e("a",{href:"https://mastodon.social/@cheeaun",target:"_blank",onClick:i=>{i.preventDefault(),x.showAccount="cheeaun@mastodon.social"}}),2:e("a",{href:pd,target:"_blank"})}})}),e("div",{children:e(vi,{})})]}),e("div",{id:"why-container",children:e("div",{class:"sections",children:[e("section",{children:[e("img",{src:ad,alt:n({id:"S5cYrQ"}),loading:"lazy"}),e("h4",{children:e(h,{id:"Tu+sCN"})}),e("p",{children:e(h,{id:"e2uVlo"})})]}),e("section",{children:[e("img",{src:ud,alt:n({id:"CGQ27z"}),loading:"lazy"}),e("h4",{children:e(h,{id:"cYE45+"})}),e("p",{children:e(h,{id:"Pc7QKh"})})]}),e("section",{children:[e("img",{src:rd,alt:n({id:"rnrM7k"}),loading:"lazy"}),e("h4",{children:e(h,{id:"4RRMre"})}),e("p",{children:e(h,{id:"8GMtDr"})})]}),e("section",{children:[e("img",{src:ld,alt:n({id:"VLKtvP"}),loading:"lazy"}),e("h4",{children:e(h,{id:"pEkad9"})}),e("p",{children:e(h,{id:"t7Py5R"})})]}),e("section",{children:[e("img",{src:dd,alt:n({id:"wOax6E"}),loading:"lazy"}),e("h4",{children:e(h,{id:"Wi1Ov0"})}),e("p",{children:e(h,{id:"tS2i+h"})})]})]})})]})}const md=window.alert;window.__nativeAlert||(window.__nativeAlert=md);window.alert=function(n){n instanceof Error&&(n!=null&&n.message)&&(n=n.message),typeof n!="string"&&(n=JSON.stringify(n));const i=Qo({text:n,className:"alert",gravity:"top",position:"center",duration:1e4,offset:{y:48},onClick:()=>{i.hideToast()}});i.showToast()};window.__STATES__=x;window.__STATES_STATS__=()=>{const n=["statuses","accounts","spoilers","unfurledLinks","statusQuotes"],i={};n.forEach(c=>{i[c]=Object.keys(x[c]).length});const{statuses:s}=x,o=[];for(const c in s)document.querySelector(`[data-state-post-id~="${c}"], [data-state-post-ids~="${c}"]`)||o.push(c)};setInterval(()=>{if(!window.__IDLE__)return;const{statuses:n,unfurledLinks:i,notifications:s}=x;let o=0;const{instance:c}=ce();for(const r in n){if(!window.__IDLE__)break;try{const u=document.querySelector(`[data-state-post-id~="${r}"], [data-state-post-ids~="${r}"]`),d=s.some(l=>{var a;return r===rt((a=l.status)==null?void 0:a.id,c)});if(!u&&!d){delete x.statuses[r],delete x.statusQuotes[r];for(const l in i){const a=i[l];if(rt(a.id,a.instance)===r){delete x.unfurledLinks[l];break}}o++}}catch{}}},15*60*1e3);setTimeout(()=>{for(const n in Bt)setTimeout(()=>{var i,s,o,c,r,u;Array.isArray(Bt[n])?(s=(i=Bt[n])[0])==null||s.call(i):typeof Bt[n]=="object"?(c=(o=Bt[n]).module)==null||c.call(o):(u=(r=Bt)[n])==null||u.call(r)},1)},5e3);(()=>{window.__IDLE__=!0;const n=["mousemove","mousedown","resize","keydown","touchstart","pointerdown","pointermove","wheel"],i=()=>{window.__IDLE__=!0},o=Ls(i,3e3),c=()=>{window.__IDLE__=!1,o()};n.forEach(r=>{window.addEventListener(r,c,{passive:!0,capture:!0})}),window.addEventListener("blur",i,{passive:!0}),document.documentElement.addEventListener("mouseleave",r=>{!r.relatedTarget&&!r.toElement&&i()},{passive:!0})})();const gd=/iPad|iPhone|iPod/.test(navigator.userAgent);gd&&document.addEventListener("visibilitychange",()=>{if(document.visibilityState==="visible"){if(document.getElementsByClassName("media-modal-container").length>0)return;const i=ye.local.get("theme");let s;if(i){if(s=document.querySelector('meta[name="theme-color"][data-theme-setting="manual"]'),s){const o=s.content,c=i==="light"?s.dataset.themeLightColorTemp:s.dataset.themeDarkColorTemp;s.content=c||"",setTimeout(()=>{s.content=o},10)}}else{const o=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";if(s=document.querySelector(`meta[name="theme-color"][media*="${o}"]`),s){const c=s.dataset.content,r=s.dataset.contentTemp;s.content=r||"",setTimeout(()=>{s.content=c},10)}}}});{const n=ye.local.get("theme");if(n){document.documentElement.classList.add(`is-${n}`),document.querySelector('meta[name="color-scheme"]').setAttribute("content",n||"dark light");const s=document.querySelector('meta[data-theme-setting="manual"]');s&&(s.name="theme-color",s.content=n==="light"?s.dataset.themeLightColor:s.dataset.themeDarkColor),document.querySelectorAll('meta[data-theme-setting="auto"]').forEach(c=>{c.name=""})}const i=ye.local.get("textSize");i&&document.documentElement.style.setProperty("--text-size",`${i}px`)}gs(x,n=>{var i;for(const[s,o,c,r]of n){if(o.join(".")==="settings.shortcutsViewMode"){const u=document.getElementById("app");u&&(u.dataset.shortcutsViewMode=(i=x.shortcuts)!=null&&i.length?c:"")}o.join(".")==="settings.cloakMode"&&document.body.classList.toggle("cloak",c)}});const gn=new Map;window.__BENCH_RESULTS=new Map;window.__BENCHMARK={start(n){},end(n){}};function bd(){const[n,i]=R(!1),[s,o]=R("loading");__BENCHMARK.start("app-init"),__BENCHMARK.start("time-to-following"),__BENCHMARK.start("time-to-home"),__BENCHMARK.start("time-to-isLoggedIn"),de(),ie(()=>{const r=ye.local.get("instanceURL"),u=decodeURIComponent((window.location.search.match(/code=([^&]+)/)||[,""])[1]);if(u){window.history.replaceState({},document.title,window.location.pathname||"/");const d=ye.sessionCookie.get("clientID"),l=ye.sessionCookie.get("clientSecret"),a=ye.sessionCookie.get("vapidKey"),p=ye.sessionCookie.get("codeVerifier");(async()=>{o("loading");const{access_token:y}=await Fl({instanceURL:r,client_id:d,client_secret:l,code:u,code_verifier:p||void 0});if(y){const m=Eo({instance:r,accessToken:y});await Promise.allSettled([Un(m),Bn(m,r),Ro(m,r,y,a)]),Ei(),window.__IGNORE_GET_ACCOUNT_ERROR__=!0,i(!0),o("default")}else o("error");__BENCHMARK.end("app-init")})()}else{window.__IGNORE_GET_ACCOUNT_ERROR__=!0;const d=decodeURIComponent((window.location.search.match(/account=([^&]+)/)||[,""])[1]);let l;if(d&&(l=Lo(d),l&&(_n(l.info.id),window.history.replaceState({},document.title,window.location.pathname||"/"))),l||(l=ci()),l){_n(l.info.id);const{client:a}=ce({account:l}),{instance:p}=a;Ei(),o("loading"),(async()=>{try{Mo()&&$o(p)?(Un(a),Bn(a,p)):await Promise.allSettled([Un(a),Bn(a,p)])}catch{}finally{i(!0),o("default"),__BENCHMARK.end("app-init")}})()}else o("default"),__BENCHMARK.end("app-init")}ye.sessionCookie.del("clientID"),ye.sessionCookie.del("clientSecret"),ye.sessionCookie.del("codeVerifier")},[]);let c=Wt();return x.currentLocation=c.pathname,ie(Qn,[c,n]),/\/https?:/.test(c.pathname)?e(Il,{}):s==="loading"?e(Ue,{id:"loader-root"}):e(U,{children:[e(vd,{isLoggedIn:n}),e(wd,{isLoggedIn:n}),e(ri,{children:e(Ke,{path:"/:instance?/s/:id",element:e(cd,{})})}),n&&e(sc,{}),n&&e(Wa,{}),e(Ha,{}),n&&e(Ga,{}),e(nc,{isLoggedIn:n}),e(Ka,{onClose:Qn}),e(oc,{})]})}function yd({isLoggedIn:n}){return n&&__BENCHMARK.end("time-to-isLoggedIn"),n?e(Sl,{}):e(mo,{})}const vd=dt(({isLoggedIn:n})=>{const i=Wt(),s=_e(()=>{const{pathname:o}=i;return!/^\/(login|welcome)/i.test(o)},[i]);return e(ri,{location:s||i,children:[e(Ke,{path:"/",element:e(yd,{isLoggedIn:n})}),e(Ke,{path:"/login",element:e(ql,{})}),e(Ke,{path:"/welcome",element:e(mo,{})})]})});function fs(){return x.prevLocation||null}function wd({isLoggedIn:n}){const i=Wt(),s=q(fs());return _e(()=>nn("/:instance/s/:id",i.pathname)||nn("/s/:id",i.pathname),[i.pathname,nn])?s.current||(s.current=fs()):s.current=null,e(ri,{location:s.current||i,children:[n&&e(U,{children:[e(Ke,{path:"/notifications",element:e(ao,{})}),e(Ke,{path:"/mentions",element:e(so,{})}),e(Ke,{path:"/following",element:e(Ii,{})}),e(Ke,{path:"/b",element:e(Zs,{})}),e(Ke,{path:"/f",element:e(Xs,{})}),e(Ke,{path:"/l",children:[e(Ke,{index:!0,element:e(Al,{})}),e(Ke,{path:":id",element:e(eo,{})})]}),e(Ke,{path:"/fh",element:e(Br,{})}),e(Ke,{path:"/sp",element:e(Gl,{})}),e(Ke,{path:"/ft",element:e(Dr,{})}),e(Ke,{path:"/catchup",element:e(Cr,{})}),e(Ke,{path:"/annual_report/:year",element:e(gr,{})})]}),e(Ke,{path:"/:instance?/t/:hashtag",element:e(Qs,{})}),e(Ke,{path:"/:instance?/a/:id",element:e(hr,{})}),e(Ke,{path:"/:instance?/p",children:[e(Ke,{index:!0,element:e(ii,{})}),e(Ke,{path:"l",element:e(ii,{local:!0})})]}),e(Ke,{path:"/:instance?/trending",element:e(uo,{})}),e(Ke,{path:"/:instance?/search",element:e(ro,{})})]})}No();Po(e(Do,{i18n:he,children:e(Oo,{children:e(bd,{})})}),document.getElementById("app"));setTimeout(()=>{try{Object.keys(localStorage).forEach(n=>{n.startsWith("iconify")&&localStorage.removeItem(n)}),Object.keys(sessionStorage).forEach(n=>{n.startsWith("iconify")&&sessionStorage.removeItem(n)}),localStorage.removeItem("settings:boostsCarousel")}catch{}},5e3);if("serviceWorker"in navigator&&typeof caches<"u"){const i=["icons"];let s=!1;const o=1e4,c=60*60*1e3;async function r(){if(window.__IDLE__)try{const u=await caches.keys();for(const d of u){if(i.includes(d))continue;const l=await caches.open(d),a=await l.keys();if(a.length>50){const p=a.slice(50);for(const y of p)await l.delete(y)}}s=!0}catch{}setTimeout(r,s?c:o)}setTimeout(r,o)}window.__CLOAK__=()=>{document.body.classList.toggle("cloak")};
//# sourceMappingURL=main-chrSCX6l.js.map
