import{a as Ue,b as Ge,N as He,r as je,o as qe}from"./main-qj_8dpGf.js";import{ac as Ke,a as Ye,q as Xe,p as L,h as Ve,v as z,a3 as We,$ as Qe,s as Le,F as Z,al as _e,ak as ne,D as Ze,_ as J,X as Je,e,c as we,k as ue,I as _,g as D,K as et,L as tt,aj as st,R as Ee,A as Ce,M as nt,N as $e,w as rt,aq as at,V as lt,aG as it,i as Te}from"./db-EEYTw_tY.js";import{u as ot}from"./index-_Y-Lyw2n.js";import"./intl-segmenter-polyfill-XHDQHdV5.js";const ct=""+new URL("catch-up-DuauQu-W.png",import.meta.url).href,dt="home",U=[{label:"last 1 hour",value:1},{label:"last 2 hours",value:2},{label:"last 3 hours",value:3},{label:"last 4 hours",value:4},{label:"last 5 hours",value:5},{label:"last 6 hours",value:6},{label:"last 7 hours",value:7},{label:"last 8 hours",value:8},{label:"last 9 hours",value:9},{label:"last 10 hours",value:10},{label:"last 11 hours",value:11},{label:"last 12 hours",value:12},{label:"beyond 12 hours",value:13}],ht={Filtered:"filtered",Groups:"group",Boosts:"boost",Replies:"reply","Followed tags":"followedTags",Original:"original"},ut={Filtered:"filtered posts",Groups:"group posts",Boosts:"boosts",Replies:"replies","Followed tags":"followed-tag posts",Original:"original posts"},pt={createdAt:["oldest","latest"],repliesCount:["fewest replies","most replies"],favouritesCount:["fewest likes","most likes"],reblogsCount:["fewest boosts","most boosts"],density:["least dense","most dense"]};function Dt(){Ke("Catch-up","/catchup");const{masto:f,instance:d}=Ye(),[u,o]=Xe(),h=u.get("id"),[p,C]=L("start"),[m,c]=L(!1),A=z(()=>Ve.session.get("currentAccount"),[]),B=t=>t===A;async function K({maxCreatedAt:t}){var l,S,y;const s=t?new Date(t):null,r=[],n=f.v1.timelines.home.list({limit:40});e:for(;;)try{const i=await n.next(),{value:v}=i;if(v!=null&&v.length){await Ue(v,d);let k=!1;for(let M=0;M<v.length;M++){const T=v[M],W=new Date(T.createdAt);if(!s||W>=s){const b=!B(((S=(l=T.reblog)==null?void 0:l.account)==null?void 0:S.id)||T.account.id)&&We(((y=T.reblog)==null?void 0:y.filtered)||T.filtered,dt);if((b==null?void 0:b.action)==="hide")continue;T._filtered=b;const O=Qe(T.id,d);T._followedTags=Le.statusFollowedTags[O]?[...Le.statusFollowedTags[O]]:[],r.push(T),k=!0}if(!k)break e}}else break e;await new Promise(k=>setTimeout(k,1e3))}catch{break e}return r.forEach(i=>{if(i!=null&&i.inReplyToId){const v=r.find(k=>k.id===i.inReplyToId);v&&!v.inReplyToId&&(v._thread=!0)}}),r}const[g,G]=L([]),ee=Z(),pe=z(()=>_e(),[]),$=Ze(async({duration:t}={})=>{const s=Date.now(),r=t?s-t:null;C("loading");const n=await K({maxCreatedAt:r}),l=`${pe}-${ot()}`;try{await ne.catchup.set(l,{id:l,posts:n,count:n.length,startAt:r,endAt:s}),o({id:l})}catch{}},[]);J(()=>{h?(async()=>{const t=await ne.catchup.get(h);t&&(t.posts.sort((s,r)=>s.createdAt>r.createdAt?1:-1),G(t.posts),C("results"))})():p==="results"&&(G([]),C("start"))},[h]);const[F,P]=Je(t=>t+1,0),[x,Y]=L(null),[re,ke]=L([]);J(()=>{(async()=>{try{const t=await ne.catchup.keys();if(t.length){const s=_e(),r=t.filter(n=>n.startsWith(`${s}-`));if(r.length){let n=await ne.catchup.getMany(r);n.sort((i,v)=>v.endAt-i.endAt);let l=n.slice(0,3),S=n.slice(3);const y=l.map(i=>{const{id:v,count:k,startAt:M,endAt:T}=i;return{id:v,count:k,startAt:M,endAt:T}});ke(y),Y(l[0].endAt),n=null,l=null,queueMicrotask(()=>{S.length&&ne.catchup.delMany(S.map(i=>i.id)).then(()=>{S=null}).catch(i=>{})});return}}}catch{}ke([])})()},[F]),J(()=>{p==="start"&&P()},[p==="start"]);const[Ae,ie]=z(()=>{var v,k,M,T,W;let t=0,s=0,r=0,n=0,l=0,S=0;const y={};for(const a of g){a._filtered?(t++,a.__FILTER="filtered"):a.group?(s++,a.__FILTER="group"):a.reblog?(r++,a.__FILTER="boost"):(v=a._followedTags)!=null&&v.length?(l++,a.__FILTER="followedTags"):a.inReplyToId&&a.inReplyToAccountId!==((k=a.account)==null?void 0:k.id)?(n++,a.__FILTER="reply"):(S++,a.__FILTER="original");const b=a.reblog||a;if(a.__FILTER!=="filtered"&&((M=b.card)!=null&&M.url)&&((T=b.card)!=null&&T.image)&&((W=b.card)==null?void 0:W.type)==="link"){const{card:O,favouritesCount:he,reblogsCount:Q}=b;let{url:I}=O;if(I=I.replace(/\/$/,""),!y[I])y[I]={postID:b.id,card:O,shared:1,sharers:[a.account],likes:he,boosts:Q};else{if(y[I].sharers.find(se=>se.id===a.account.id))continue;y[I].shared++,y[I].sharers.push(a.account),y[I].postID!==b.id&&(y[I].likes+=he,y[I].boosts+=Q)}}}let i=[];for(const a in y)i.push({url:a,...y[a]});if(i.sort((a,b)=>a.shared>b.shared?-1:a.shared<b.shared?1:a.boosts>b.boosts?-1:a.boosts<b.boosts?1:a.likes>b.likes?-1:a.likes<b.likes?1:0),i.length>10)e:for(let a=10;a<i.length;a++){const{shared:b}=i[a];if(b<=1){i=i.slice(0,a);break e}}return[{Filtered:t,Groups:s,Boosts:r,Replies:n,"Followed tags":l,Original:S},i]},[g]),[N,ge]=L("All"),[w,oe]=L(null),[H,Me]=L(1),[R,Re]=L("createdAt"),[X,fe]=L("asc"),[j,Ie]=L(null),[ae,E,V]=z(()=>{const t={},s=new Map;let r=g.filter(n=>{const l=N==="All"||n.__FILTER===ht[N];return l&&(t[n.account.id]=n.account,s.set(n.account.id,(s.get(n.account.id)||0)+1)),l});return w&&s.has(w)&&(r=r.filter(n=>n.account.id===w)),[r,t,Object.fromEntries(s)]},[N,w,g]),ce=z(()=>{const t={};return ae.forEach(s=>{t[s.id]=s}),t},[ae]),te=z(()=>Object.keys(V).sort((t,s)=>V[s]-V[t]),[V]),ze=z(()=>{const t={};return te.forEach((s,r)=>{t[s]=r}),ae.sort((s,r)=>{if(j==="account"){const n=s.account.id,l=r.account.id,S=t[n],y=t[l],i=S-y;if(i!==0)return i}if(R!=="createdAt"&&(s=s.reblog||s,r=r.reblog||r,R!=="density"&&s[R]===r[R]))return s.createdAt>r.createdAt?1:-1;if(R==="density"){const n=xe(s),l=xe(r);return X==="asc"?n>l?1:-1:l>n?1:-1}return X==="asc"?s[R]>r[R]?1:-1:r[R]>s[R]?1:-1})},[ae,R,X,j,te]),me=Z(null),le=Z(null),De=Z(!1);J(()=>{g.length>100||De.current||le.current&&(Ge(le.current,{duration:200}),De.current=!0)},[g,le]);const be=g.length>160?"3d":"2d",Be=z(()=>be!=="2d"?null:g.map(t=>{const s=ce[t.id];return e("span",{class:`post-dot ${s?"post-dot-highlight":""}`},t.id)}),[ce]),Pe=z(()=>be!=="3d"||!(g!=null&&g.length)?null:Ct(g,"createdAt",320).map((s,r)=>e("div",{class:"posts-bin",children:s.map(n=>{const l=ce[n.id];return e("span",{class:`post-dot ${l?"post-dot-highlight":""}`},n.id)})},r)),[ce]),de=Z(null),Se=z(()=>x?(Date.now()-x)/1e3/60/60:null,[x,H]);J(()=>{if(p!=="results")return;const t=w&&E[w]?E[w].username:"",s=X==="asc"?0:1,r={account:"authors"};let n=we({duration:5e3,text:`Showing ${ut[N]||"all posts"}${t?` by @${t}`:""}, ${pt[R][s]} first${j?`, grouped by ${j==="account"?r[j]:""}`:""}`});return()=>{var l;(l=n==null?void 0:n.hideToast)==null||l.call(n)}},[p,N,w,R,X,j,E]);const ye=Z(!1);J(()=>{let t;return w&&(E[w]?ye.current&&(t=setTimeout(()=>{var s;(s=le.current.querySelector(`[data-author="${w}"]`))==null||s.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})},500),ye.current=!1):ye.current=!0),()=>{clearTimeout(t)}},[w,E]);const[Ne,ve]=L(!1);return e("div",{ref:de,id:"catchup-page",class:"deck-container",tabIndex:"-1",children:[e("div",{class:"timeline-deck deck wide",children:[e("header",{class:`${p==="loading"?"loading":""}`,onClick:t=>{var s;t.target.closest("a, button")||(s=de.current)==null||s.scrollTo({top:0,behavior:"smooth"})},children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(He,{}),p==="results"&&e(ue,{to:"/catchup",class:"button plain",children:e(_,{icon:"history",size:"l"})}),p==="start"&&e(ue,{to:"/",class:"button plain",children:e(_,{icon:"home",size:"l"})})]}),e("h1",{children:p!=="start"&&e(D,{children:["Catch-up ",e("sup",{children:"beta"})]})}),e("div",{class:"header-side",children:p!=="start"&&p!=="loading"&&e("button",{type:"button",class:"plain",onClick:()=>{ve(!0)},children:"Help"})})]})}),e("main",{children:[p==="start"&&e("div",{class:"catchup-start",children:[e("h1",{children:["Catch-up ",e("sup",{children:"beta"})]}),e("details",{children:[e("summary",{children:"What is this?"}),e("p",{children:"Catch-up is a separate timeline for your followings, offering a high-level view at a glance, with a simple, email-inspired interface to effortlessly sort and filter through posts."}),e("img",{src:ct,width:"1200",height:"900",alt:"Preview of Catch-up UI"}),e("p",{children:e("button",{type:"button",onClick:t=>{t.target.closest("details").open=!1},children:"Let's catch up"})})]}),e("p",{children:"Let's catch up on the posts from your followings."}),e("p",{children:e("b",{children:"Show me all posts from…"})}),e("div",{class:"catchup-form",children:[e("input",{ref:ee,type:"range",value:H,min:U[0].value,max:U[U.length-1].value,step:"1",list:"catchup-ranges",onChange:t=>Me(+t.target.value)})," ",e("span",{style:{width:"8em"},children:[U[H-1].label,e("br",{}),e("small",{class:"insignificant",children:H==U[U.length-1].value?"until the max":et(new Date(Date.now()-H*60*60*1e3))})]}),e("datalist",{id:"catchup-ranges",children:U.map(({label:t,value:s})=>e("option",{value:s,label:t}))})," ",e("button",{type:"button",onClick:()=>{if(H<U[U.length-1].value){const t=H*60*60*1e3;$({duration:t})}else $()},children:"Catch up"})]}),Se&&H>Se&&e("p",{class:"catchup-info",children:[e(_,{icon:"info"})," Overlaps with your last catch-up"]}),e("p",{class:"insignificant",children:e("small",{children:"Note: your instance might only show a maximum of 800 posts in the Home timeline regardless of the time range. Could be less or more."})}),!!(re!=null&&re.length)&&e("div",{class:"catchup-prev",children:[e("p",{children:"Previously…"}),e("ul",{children:re.map(t=>e("li",{children:[e(ue,{to:`/catchup?id=${t.id}`,children:[e(_,{icon:"history"})," ",e("span",{children:Fe(new Date(t.startAt),new Date(t.endAt))})]})," ",e("span",{children:[e("small",{class:"ib insignificant",children:[t.count," posts"]})," ",e("button",{type:"button",class:"light danger small",onClick:async()=>{var r;if(confirm("Remove this catch-up?")){let n=we(`Removing Catch-up ${t.id}`);await ne.catchup.del(t.id),(r=n==null?void 0:n.hideToast)==null||r.call(n),we(`Catch-up ${t.id} removed`),P()}},children:e(_,{icon:"x"})})]})]},t.id))}),re.length>=3&&e("p",{children:e("small",{children:"Note: Only max 3 will be stored. The rest will be automatically removed."})})]})]}),p==="loading"&&e("div",{class:"ui-state catchup-start",children:[e(tt,{abrupt:!0}),e("p",{class:"insignificant",children:"Fetching posts…"}),e("p",{class:"insignificant",children:"This might take a while."})]}),p==="results"&&e(D,{children:[e("div",{class:"catchup-header",children:[g.length>0&&e("p",{children:e("b",{class:"ib",children:Fe(new Date(g[0].createdAt),new Date(g[g.length-1].createdAt))})}),e("aside",{children:[e("button",{hidden:N==="All"&&!w&&R==="createdAt"&&X==="asc",type:"button",class:"plain4 small",onClick:()=>{ge("All"),oe(null),Re("createdAt"),Ie(null),fe("asc")},children:"Reset filters"}),(ie==null?void 0:ie.length)>0&&e("button",{type:"button",class:"plain small",onClick:()=>c(!m),children:["Top links"," ",e(_,{icon:"chevron-down",style:{transform:m?"rotate(180deg)":"rotate(0deg)"}})]})]})]}),e("div",{class:"shazam-container no-animation",hidden:!m,children:e("div",{class:"shazam-container-inner",children:e("div",{class:"catchup-top-links links-bar",children:ie.map(t=>{const{card:s,shared:r,sharers:n,likes:l,boosts:S}=t,{blurhash:y,title:i,description:v,url:k,image:M,imageDescription:T,language:W,width:a,height:b,publishedAt:O}=s,he=new URL(k).hostname.replace(/^www\./,"").replace(/\/$/,"");let Q;if(y){const I=st(y),se=je(I);Q=qe([.6,se[1],se[2]])}return e("a",{href:k,target:"_blank",rel:"noopener noreferrer",style:Q?{"--accent-color":`rgb(${Q.join(",")})`,"--accent-alpha-color":`rgba(${Q.join(",")}, 0.4)`}:{},children:e("article",{children:[e("figure",{children:e("img",{src:M,alt:T,width:a,height:b,loading:"lazy"})}),e("div",{class:"article-body",children:[e("header",{children:[e("div",{class:"article-meta",children:[e("span",{class:"domain",children:he})," ",!!O&&e(D,{children:"· "}),!!O&&e(D,{children:e(Ee,{datetime:O,format:"micro"})})]}),!!i&&e("h1",{class:"title",lang:W,dir:"auto",children:i})]}),!!v&&e("p",{class:"description",lang:W,dir:"auto",children:v}),e("hr",{}),e("p",{style:{whiteSpace:"nowrap"},children:["Shared by"," ",n.map(I=>{const{avatarStatic:se,displayName:Oe}=I;return e(Ce,{url:se,size:"s",alt:Oe})})]})]})]})},k)})})})}),g.length>=5&&(be==="3d"?e("div",{class:"catchup-posts-viz-time-bar",children:Pe}):e("div",{class:"catchup-posts-viz-bar",children:Be})),g.length>=2&&e("div",{class:"catchup-filters",children:[e("label",{class:"filter-cat",children:[e("input",{type:"radio",name:"filter-cat",checked:N.toLowerCase()==="all",onChange:()=>{ge("All")}}),"All ",e("span",{class:"count",children:g.length})]}),["Original","Replies","Boosts","Followed tags","Groups","Filtered"].map(t=>!!Ae[t]&&e("label",{class:"filter-cat",children:[e("input",{type:"radio",name:"filter-cat",checked:N.toLowerCase()===t.toLowerCase(),onChange:()=>{ge(t)}}),t," ",e("span",{class:"count",children:Ae[t]})]},t))]}),g.length>=2&&!!V&&e("div",{class:"catchup-filters authors-filters",ref:le,children:[te.map(t=>e("label",{class:"filter-author","data-author":t,children:[e("input",{type:"radio",name:"filter-author",checked:w===t,onChange:()=>{oe(t)},onClick:()=>{w===t&&oe(null)}}),e(Ce,{url:E[t].avatarStatic||E[t].avatar,size:"xxl",alt:`${E[t].displayName} (@${E[t].username})`})," ",e("span",{class:"count",children:V[t]}),e("span",{class:"username",children:E[t].username})]},`${t}-${V[t]}`)),te.length>5&&e("small",{style:{whiteSpace:"nowrap",paddingInline:"1em",opacity:.33},children:[te.length," authors"]},"authors-count")]}),g.length>=2&&e("div",{class:"catchup-filters",children:[e("span",{class:"filter-label",children:"Sort"})," ",e("fieldset",{class:"radio-field-group",children:["createdAt","repliesCount","favouritesCount","reblogsCount","density"].map(t=>e("label",{class:"filter-sort",children:[e("input",{type:"radio",name:"filter-sort-cat",checked:R===t,onChange:()=>{Re(t);const s=/(replies|favourites|reblogs)/.test(t)?"desc":"asc";fe(s)}}),{createdAt:"Date",repliesCount:"Replies",favouritesCount:"Likes",reblogsCount:"Boosts",density:"Density"}[t]]},t))}),e("fieldset",{class:"radio-field-group",children:["asc","desc"].map(t=>e("label",{class:"filter-sort",children:[e("input",{type:"radio",name:"filter-sort-dir",checked:X===t,onChange:()=>{fe(t)}}),t==="asc"?"↑":"↓"]},t))}),e("span",{class:"filter-label",children:"Group"})," ",e("fieldset",{class:"radio-field-group",children:[null,"account"].map(t=>e("label",{class:"filter-group",children:[e("input",{type:"radio",name:"filter-group",checked:j===t,onChange:()=>{Ie(t)},disabled:t==="account"&&w}),{account:"Authors"}[t]||"None"]},t||"none"))}),w&&te.length>1?e("button",{type:"button",class:"plain small",onClick:()=>{oe(null)},style:{whiteSpace:"nowrap"},children:"Show all authors"}):null]}),e("ul",{class:"catchup-list",children:ze.map((t,s)=>{var l;const r=((l=t.reblog)==null?void 0:l.id)||t.id;let n=!1;return j==="account"&&(me.current&&t.account.id!==me.current&&s>0&&(n=!0),me.current=t.account.id),e(D,{children:[n&&e("li",{class:"separator"}),e(ft,{to:`/${d}/s/${r}`,post:t,root:de.current})]},`${t.id}-${n}`)})}),e("footer",{children:ae.length>5&&e("p",{children:[N==="Boosts"?"You don't have to read everything.":"That's all."," ",e("button",{type:"button",class:"textual",onClick:()=>{de.current.scrollTop=0},children:"Back to top"}),"."]})})]})]})]}),Ne&&e(nt,{onClose:()=>ve(!1),children:e("div",{class:"sheet",id:"catchup-help-sheet",children:[e("button",{type:"button",class:"sheet-close",onClick:()=>ve(!1),children:e(_,{icon:"x"})}),e("header",{children:e("h2",{children:"Help"})}),e("main",{children:e("dl",{children:[e("dt",{children:"Top links"}),e("dd",{children:"Links shared by followings, sorted by shared counts, boosts and likes."}),e("dt",{children:"Sort: Density"}),e("dd",{children:'Posts are sorted by information density or depth. Shorter posts are "lighter" while longer posts are "heavier". Posts with photos are "heavier" than posts without photos.'}),e("dt",{children:"Group: Authors"}),e("dd",{children:"Posts are grouped by authors, sorted by posts count per author."})]})})]})})]})}const gt=rt(function({post:f}){const{id:d,account:u,group:o,reblog:h,inReplyToId:p,inReplyToAccountId:C,_followedTags:m,_filtered:c,visibility:A}=f,B=p&&C!==u.id,K=!!c,g=G=>{G.shiftKey};return e("article",{class:`post-line ${o?"group":h?"reblog":m!=null&&m.length?"followed-tags":""} ${B?"reply-to":""} ${K?"filtered":""} visibility-${A}`,onMouseEnter:g,children:[e("span",{class:"post-author",children:h?e("span",{class:"post-reblog-avatar",children:[e(Ce,{url:u.avatarStatic||u.avatar,squircle:u.bot})," ",e(_,{icon:"rocket"})," ",e($e,{account:h.account,showAvatar:!0})]}):e($e,{account:u,showAvatar:!0})}),e(yt,{post:h||f,filterInfo:c}),e("span",{class:"post-meta",children:[e(vt,{post:h||f})," ",e(Ee,{datetime:new Date((h==null?void 0:h.createdAt)||f.createdAt),format:"micro"})]})]})},(f,d)=>{var u,o;return((u=f==null?void 0:f.post)==null?void 0:u.id)===((o=d==null?void 0:d.post)==null?void 0:o.id)}),ft=({root:f,to:d,...u})=>{const o=Z(),[h,p]=L(!1);return J(()=>{const C=new IntersectionObserver(m=>{m[0].isIntersecting&&(queueMicrotask(()=>p(!0)),C.unobserve(o.current))},{root:f,rootMargin:`${Math.max(320,screen.height*.75)}px`});return o.current&&C.observe(o.current),()=>{o.current&&C.unobserve(o.current)}},[]),h?e("li",{children:e(ue,{to:d,children:e(gt,{...u})})}):e("li",{ref:o,style:{height:"4em"}})},mt=8,bt=8;function xe(f){var c;const{spoilerText:d,content:u,poll:o,mediaAttachments:h,card:p}=f,C=(c=o==null?void 0:o.options)!=null&&c.length?o.options.reduce((A,B)=>A+B.title,""):"";return(d.length+at(u)+C.length)/140+(h!=null&&h.length?mt*h.length:p!=null&&p.image?bt:0)}const q=48;function yt({post:f,filterInfo:d}){const{spoilerText:u,sensitive:o,content:h,emojis:p,poll:C,mediaAttachments:m,card:c,inReplyToId:A,inReplyToAccountId:B,account:K,_thread:g}=f,G=A&&B===K.id||!!g,ee=!u&&!o,pe=h?lt(h):"";return e("div",{class:"post-peek",title:u?"":pe,children:[e("span",{class:"post-peek-content",children:d?e(D,{children:[G&&e(D,{children:[e("span",{class:"post-peek-tag post-peek-thread",children:"Thread"})," "]}),e("span",{class:"post-peek-filtered",children:["Filtered",d!=null&&d.titlesStr?`: ${d.titlesStr}`:""]})]}):u?e(D,{children:[G&&e(D,{children:[e("span",{class:"post-peek-tag post-peek-thread",children:"Thread"})," "]}),e("span",{class:"post-peek-spoiler",children:[e(_,{icon:"eye-close"})," ",u]})]}):e("div",{class:"post-peek-html",children:[G&&e(D,{children:[e("span",{class:"post-peek-tag post-peek-thread",children:"Thread"})," "]}),h?e("div",{dangerouslySetInnerHTML:{__html:it(h,p)}}):(m==null?void 0:m.length)===1&&m[0].description?e(D,{children:[e("span",{class:"post-peek-tag post-peek-alt",children:"ALT"})," ",e("div",{children:m[0].description})]}):null]})}),!d&&e("span",{class:"post-peek-post-content",children:[!!C&&e("span",{class:"post-peek-tag post-peek-poll",children:[e(_,{icon:"poll",size:"s"}),"Poll"]}),m!=null&&m.length?m.map($=>{const F=$.previewUrl||$.url,P=$.previewRemoteUrl||$.remoteUrl;return e("span",{class:"post-peek-media",children:{image:(F||P)&&ee?e("img",{src:F,width:q,height:q,alt:$.description,loading:"lazy",onError:x=>{const{src:Y}=x.target;Y===F&&(x.target.src=P)}}):e("span",{class:"post-peek-faux-media",children:"🖼"}),gifv:(F||P)&&ee?e("img",{src:F,width:q,height:q,alt:$.description,loading:"lazy",onError:x=>{const{src:Y}=x.target;Y===F&&(x.target.src=P)}}):e("span",{class:"post-peek-faux-media",children:"🎞️"}),video:(F||P)&&ee?e("img",{src:F,width:q,height:q,alt:$.description,loading:"lazy",onError:x=>{const{src:Y}=x.target;Y===F&&(x.target.src=P)}}):e("span",{class:"post-peek-faux-media",children:"📹"}),audio:e("span",{class:"post-peek-faux-media",children:"🎵"})}[$.type]||null},$.id)}):!!c&&c.image&&ee&&e("span",{class:`post-peek-media post-peek-card card-${c.type||""}`,children:c.image?e("img",{src:c.image,width:q,height:q,alt:c.title||c.description||c.imageDescription,loading:"lazy"}):e("span",{class:"post-peek-faux-media",children:"🔗"})})]})]})}function vt({post:f}){const{reblogsCount:d,repliesCount:u,favouritesCount:o}=f;return e("span",{class:"post-stats",children:[u>0&&e(D,{children:[e(_,{icon:"comment2",size:"s"})," ",Te(u)]}),o>0&&e(D,{children:[e(_,{icon:"heart",size:"s"})," ",Te(o)]}),d>0&&e(D,{children:[e(_,{icon:"rocket",size:"s"})," ",Te(d)]})]})}const{locale:wt}=new Intl.DateTimeFormat().resolvedOptions(),Tt=new Intl.DateTimeFormat(wt,{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"});function Fe(f,d){return Tt.formatRange(f,d)}function Ct(f,d,u){const o=f.map(c=>new Date(c[d])),h=o.reduce((c,A)=>A<c?A:c,o[0]),C=o.reduce((c,A)=>A>c?A:c,o[0]).getTime()-h.getTime(),m=Array.from({length:u},()=>[]);return f.forEach(c=>{const B=(new Date(c[d]).getTime()-h.getTime())/C,K=Math.floor(B*(u-1));m[K].push(c)}),m}export{Dt as default};
//# sourceMappingURL=catchup-7Tt63s29.js.map
