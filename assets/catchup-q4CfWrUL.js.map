{"version":3,"file":"catchup-q4CfWrUL.js","sources":["../../src/assets/features/catch-up.png","../../src/pages/catchup.jsx"],"sourcesContent":["export default \"__VITE_ASSET__S_9SYp01__\"","import '../components/links-bar.css';\nimport './catchup.css';\n\nimport autoAnimate from '@formkit/auto-animate';\nimport { getBlurHashAverageColor } from 'fast-blurhash';\nimport { Fragment } from 'preact';\nimport { memo } from 'preact/compat';\nimport {\n  useCallback,\n  useEffect,\n  useMemo,\n  useReducer,\n  useRef,\n  useState,\n} from 'preact/hooks';\nimport { useHotkeys } from 'react-hotkeys-hook';\nimport { useSearchParams } from 'react-router-dom';\nimport { uid } from 'uid/single';\n\nimport catchupUrl from '../assets/features/catch-up.png';\n\nimport Avatar from '../components/avatar';\nimport Icon from '../components/icon';\nimport Link from '../components/link';\nimport Loader from '../components/loader';\nimport Modal from '../components/modal';\nimport NameText from '../components/name-text';\nimport NavMenu from '../components/nav-menu';\nimport RelativeTime from '../components/relative-time';\nimport { api } from '../utils/api';\nimport { oklab2rgb, rgb2oklab } from '../utils/color-utils';\nimport db from '../utils/db';\nimport emojifyText from '../utils/emojify-text';\nimport { isFiltered } from '../utils/filters';\nimport htmlContentLength from '../utils/html-content-length';\nimport niceDateTime from '../utils/nice-date-time';\nimport shortenNumber from '../utils/shorten-number';\nimport showToast from '../utils/show-toast';\nimport states, { statusKey } from '../utils/states';\nimport statusPeek from '../utils/status-peek';\nimport store from '../utils/store';\nimport { getCurrentAccountNS } from '../utils/store-utils';\nimport { assignFollowedTags } from '../utils/timeline-utils';\nimport useTitle from '../utils/useTitle';\n\nconst FILTER_CONTEXT = 'home';\n\nconst RANGES = [\n  { label: 'last 1 hour', value: 1 },\n  { label: 'last 2 hours', value: 2 },\n  { label: 'last 3 hours', value: 3 },\n  { label: 'last 4 hours', value: 4 },\n  { label: 'last 5 hours', value: 5 },\n  { label: 'last 6 hours', value: 6 },\n  { label: 'last 7 hours', value: 7 },\n  { label: 'last 8 hours', value: 8 },\n  { label: 'last 9 hours', value: 9 },\n  { label: 'last 10 hours', value: 10 },\n  { label: 'last 11 hours', value: 11 },\n  { label: 'last 12 hours', value: 12 },\n  { label: 'beyond 12 hours', value: 13 },\n];\n\nconst FILTER_LABELS = [\n  'Original',\n  'Replies',\n  'Boosts',\n  'Followed tags',\n  'Groups',\n  'Filtered',\n];\nconst FILTER_SORTS = [\n  'createdAt',\n  'repliesCount',\n  'favouritesCount',\n  'reblogsCount',\n  'density',\n];\nconst FILTER_GROUPS = [null, 'account'];\nconst FILTER_VALUES = {\n  Filtered: 'filtered',\n  Groups: 'group',\n  Boosts: 'boost',\n  Replies: 'reply',\n  'Followed tags': 'followedTags',\n  Original: 'original',\n};\nconst FILTER_CATEGORY_TEXT = {\n  Filtered: 'filtered posts',\n  Groups: 'group posts',\n  Boosts: 'boosts',\n  Replies: 'replies',\n  'Followed tags': 'followed-tag posts',\n  Original: 'original posts',\n};\nconst SORT_BY_TEXT = {\n  // asc, desc\n  createdAt: ['oldest', 'latest'],\n  repliesCount: ['fewest replies', 'most replies'],\n  favouritesCount: ['fewest likes', 'most likes'],\n  reblogsCount: ['fewest boosts', 'most boosts'],\n  density: ['least dense', 'most dense'],\n};\n\nfunction Catchup() {\n  useTitle('Catch-up', '/catchup');\n  const { masto, instance } = api();\n  const [searchParams, setSearchParams] = useSearchParams();\n  const id = searchParams.get('id');\n  const [uiState, setUIState] = useState('start');\n  const [showTopLinks, setShowTopLinks] = useState(false);\n\n  const currentAccount = useMemo(() => {\n    return store.session.get('currentAccount');\n  }, []);\n  const isSelf = (accountID) => accountID === currentAccount;\n\n  async function fetchHome({ maxCreatedAt }) {\n    const maxCreatedAtDate = maxCreatedAt ? new Date(maxCreatedAt) : null;\n    console.debug('fetchHome', maxCreatedAtDate);\n    const allResults = [];\n    const homeIterator = masto.v1.timelines.home.list({ limit: 40 });\n    mainloop: while (true) {\n      try {\n        const results = await homeIterator.next();\n        const { value } = results;\n        if (value?.length) {\n          // This ignores maxCreatedAt filter, but it's ok for now\n          await assignFollowedTags(value, instance);\n          let addedResults = false;\n          for (let i = 0; i < value.length; i++) {\n            const item = value[i];\n            const createdAtDate = new Date(item.createdAt);\n            if (!maxCreatedAtDate || createdAtDate >= maxCreatedAtDate) {\n              // Filtered\n              const selfPost = isSelf(\n                item.reblog?.account?.id || item.account.id,\n              );\n              const filterInfo =\n                !selfPost &&\n                isFiltered(\n                  item.reblog?.filtered || item.filtered,\n                  FILTER_CONTEXT,\n                );\n              if (filterInfo?.action === 'hide') continue;\n              item._filtered = filterInfo;\n\n              // Followed tags\n              const sKey = statusKey(item.id, instance);\n              item._followedTags = states.statusFollowedTags[sKey]\n                ? [...states.statusFollowedTags[sKey]]\n                : [];\n\n              allResults.push(item);\n              addedResults = true;\n            } else {\n              // Don't immediately stop, still add the other items that might still be within range\n              // break mainloop;\n            }\n            // Only stop when ALL items are outside of range\n            if (!addedResults) {\n              break mainloop;\n            }\n          }\n        } else {\n          break mainloop;\n        }\n        // Pause 1s\n        await new Promise((resolve) => setTimeout(resolve, 1000));\n      } catch (e) {\n        console.error(e);\n        break mainloop;\n      }\n    }\n\n    // Post-process all results\n    // 1. Threadify - tag 1st-post in a thread\n    allResults.forEach((status) => {\n      if (status?.inReplyToId) {\n        const replyToStatus = allResults.find(\n          (s) => s.id === status.inReplyToId,\n        );\n        if (replyToStatus && !replyToStatus.inReplyToId) {\n          replyToStatus._thread = true;\n        }\n      }\n    });\n\n    return allResults;\n  }\n\n  const [posts, setPosts] = useState([]);\n  const catchupRangeRef = useRef();\n  const NS = useMemo(() => getCurrentAccountNS(), []);\n  const handleCatchupClick = useCallback(async ({ duration } = {}) => {\n    const now = Date.now();\n    const maxCreatedAt = duration ? now - duration : null;\n    setUIState('loading');\n    const results = await fetchHome({ maxCreatedAt });\n    // Namespaced by account ID\n    // Possible conflict if ID matches between different accounts from different instances\n    const catchupID = `${NS}-${uid()}`;\n    try {\n      await db.catchup.set(catchupID, {\n        id: catchupID,\n        posts: results,\n        count: results.length,\n        startAt: maxCreatedAt,\n        endAt: now,\n      });\n      setSearchParams({ id: catchupID });\n    } catch (e) {\n      console.error(e, results);\n    }\n  }, []);\n\n  useEffect(() => {\n    if (id) {\n      (async () => {\n        const catchup = await db.catchup.get(id);\n        if (catchup) {\n          catchup.posts.sort((a, b) => (a.createdAt > b.createdAt ? 1 : -1));\n          setPosts(catchup.posts);\n          setUIState('results');\n        }\n      })();\n    } else if (uiState === 'results') {\n      setPosts([]);\n      setUIState('start');\n    }\n  }, [id]);\n\n  const [reloadCatchupsCount, reloadCatchups] = useReducer((c) => c + 1, 0);\n  const [lastCatchupEndAt, setLastCatchupEndAt] = useState(null);\n  const [prevCatchups, setPrevCatchups] = useState([]);\n  useEffect(() => {\n    (async () => {\n      try {\n        const catchups = await db.catchup.keys();\n        if (catchups.length) {\n          const ns = getCurrentAccountNS();\n          const ownKeys = catchups.filter((key) => key.startsWith(`${ns}-`));\n          if (ownKeys.length) {\n            let ownCatchups = await db.catchup.getMany(ownKeys);\n            ownCatchups.sort((a, b) => b.endAt - a.endAt);\n\n            // Split to 1st 3 last catchups, and the rest\n            let lastCatchups = ownCatchups.slice(0, 3);\n            let restCatchups = ownCatchups.slice(3);\n\n            const trimmedCatchups = lastCatchups.map((c) => {\n              const { id, count, startAt, endAt } = c;\n              return {\n                id,\n                count,\n                startAt,\n                endAt,\n              };\n            });\n            setPrevCatchups(trimmedCatchups);\n            setLastCatchupEndAt(lastCatchups[0].endAt);\n\n            // GC time\n            ownCatchups = null;\n            lastCatchups = null;\n\n            queueMicrotask(() => {\n              if (restCatchups.length) {\n                // delete them\n                db.catchup\n                  .delMany(restCatchups.map((c) => c.id))\n                  .then(() => {\n                    // GC time\n                    restCatchups = null;\n                  })\n                  .catch((e) => {\n                    console.error(e);\n                  });\n              }\n            });\n\n            return;\n          }\n        }\n      } catch (e) {\n        console.error(e);\n      }\n      setPrevCatchups([]);\n    })();\n  }, [reloadCatchupsCount]);\n  useEffect(() => {\n    if (uiState === 'start') {\n      reloadCatchups();\n    }\n  }, [uiState === 'start']);\n\n  const [filterCounts, links] = useMemo(() => {\n    let filtereds = 0,\n      groups = 0,\n      boosts = 0,\n      replies = 0,\n      followedTags = 0,\n      originals = 0;\n    const links = {};\n    for (const post of posts) {\n      if (post._filtered) {\n        filtereds++;\n        post.__FILTER = 'filtered';\n      } else if (post.group) {\n        groups++;\n        post.__FILTER = 'group';\n      } else if (post.reblog) {\n        boosts++;\n        post.__FILTER = 'boost';\n      } else if (post._followedTags?.length) {\n        followedTags++;\n        post.__FILTER = 'followedTags';\n      } else if (\n        post.inReplyToId &&\n        post.inReplyToAccountId !== post.account?.id\n      ) {\n        replies++;\n        post.__FILTER = 'reply';\n      } else {\n        originals++;\n        post.__FILTER = 'original';\n      }\n\n      const thePost = post.reblog || post;\n      if (\n        post.__FILTER !== 'filtered' &&\n        thePost.card?.url &&\n        thePost.card?.image &&\n        thePost.card?.type === 'link'\n      ) {\n        const { card, favouritesCount, reblogsCount } = thePost;\n        let { url } = card;\n        url = url.replace(/\\/$/, '');\n        if (!links[url]) {\n          links[url] = {\n            postID: thePost.id,\n            card,\n            shared: 1,\n            sharers: [post.account],\n            likes: favouritesCount,\n            boosts: reblogsCount,\n          };\n        } else {\n          if (links[url].sharers.find((a) => a.id === post.account.id)) {\n            continue;\n          }\n          links[url].shared++;\n          links[url].sharers.push(post.account);\n          if (links[url].postID !== thePost.id) {\n            links[url].likes += favouritesCount;\n            links[url].boosts += reblogsCount;\n          }\n        }\n      }\n    }\n\n    let topLinks = [];\n    for (const link in links) {\n      topLinks.push({\n        url: link,\n        ...links[link],\n      });\n    }\n    topLinks.sort((a, b) => {\n      if (a.shared > b.shared) return -1;\n      if (a.shared < b.shared) return 1;\n      if (a.boosts > b.boosts) return -1;\n      if (a.boosts < b.boosts) return 1;\n      if (a.likes > b.likes) return -1;\n      if (a.likes < b.likes) return 1;\n      return 0;\n    });\n\n    // Slice links to shared > 1 but min 10 links\n    if (topLinks.length > 10) {\n      linksLoop: for (let i = 10; i < topLinks.length; i++) {\n        const { shared } = topLinks[i];\n        if (shared <= 1) {\n          topLinks = topLinks.slice(0, i);\n          break linksLoop;\n        }\n      }\n    }\n\n    return [\n      {\n        Filtered: filtereds,\n        Groups: groups,\n        Boosts: boosts,\n        Replies: replies,\n        'Followed tags': followedTags,\n        Original: originals,\n      },\n      topLinks,\n    ];\n  }, [posts]);\n\n  const [selectedFilterCategory, setSelectedFilterCategory] = useState('All');\n  const [selectedAuthor, setSelectedAuthor] = useState(null);\n\n  const [range, setRange] = useState(1);\n\n  const [sortBy, setSortBy] = useState('createdAt');\n  const [sortOrder, setSortOrder] = useState('asc');\n  const [groupBy, setGroupBy] = useState(null);\n\n  const [filteredPosts, authors, authorCounts] = useMemo(() => {\n    const authorsHash = {};\n    const authorCountsMap = new Map();\n\n    let filteredPosts = posts.filter((post) => {\n      const postFilterMatches =\n        selectedFilterCategory === 'All' ||\n        post.__FILTER === FILTER_VALUES[selectedFilterCategory];\n\n      if (postFilterMatches) {\n        authorsHash[post.account.id] = post.account;\n        authorCountsMap.set(\n          post.account.id,\n          (authorCountsMap.get(post.account.id) || 0) + 1,\n        );\n      }\n\n      return postFilterMatches;\n    });\n\n    if (selectedAuthor && authorCountsMap.has(selectedAuthor)) {\n      filteredPosts = filteredPosts.filter(\n        (post) => post.account.id === selectedAuthor,\n      );\n    }\n\n    return [filteredPosts, authorsHash, Object.fromEntries(authorCountsMap)];\n  }, [selectedFilterCategory, selectedAuthor, posts]);\n\n  const filteredPostsMap = useMemo(() => {\n    const map = {};\n    filteredPosts.forEach((post) => {\n      map[post.id] = post;\n    });\n    return map;\n  }, [filteredPosts]);\n\n  const authorCountsList = useMemo(\n    () =>\n      Object.keys(authorCounts).sort(\n        (a, b) => authorCounts[b] - authorCounts[a],\n      ),\n    [authorCounts],\n  );\n\n  const sortedFilteredPosts = useMemo(() => {\n    const authorIndices = {};\n    authorCountsList.forEach((authorID, index) => {\n      authorIndices[authorID] = index;\n    });\n    return filteredPosts.sort((a, b) => {\n      if (groupBy === 'account') {\n        const aAccountID = a.account.id;\n        const bAccountID = b.account.id;\n        const aIndex = authorIndices[aAccountID];\n        const bIndex = authorIndices[bAccountID];\n        const order = aIndex - bIndex;\n        if (order !== 0) {\n          return order;\n        }\n      }\n      if (sortBy !== 'createdAt') {\n        a = a.reblog || a;\n        b = b.reblog || b;\n        if (sortBy !== 'density' && a[sortBy] === b[sortBy]) {\n          return a.createdAt > b.createdAt ? 1 : -1;\n        }\n      }\n      if (sortBy === 'density') {\n        const aDensity = postDensity(a);\n        const bDensity = postDensity(b);\n        if (sortOrder === 'asc') {\n          return aDensity > bDensity ? 1 : -1;\n        } else {\n          return bDensity > aDensity ? 1 : -1;\n        }\n      }\n      if (sortOrder === 'asc') {\n        return a[sortBy] > b[sortBy] ? 1 : -1;\n      } else {\n        return b[sortBy] > a[sortBy] ? 1 : -1;\n      }\n    });\n  }, [filteredPosts, sortBy, sortOrder, groupBy, authorCountsList]);\n\n  const prevGroup = useRef(null);\n\n  const authorsListParent = useRef(null);\n  const autoAnimated = useRef(false);\n  useEffect(() => {\n    if (posts.length > 100 || autoAnimated.current) return;\n    if (authorsListParent.current) {\n      autoAnimate(authorsListParent.current, {\n        duration: 200,\n      });\n      autoAnimated.current = true;\n    }\n  }, [posts, authorsListParent]);\n\n  const postsBarType = posts.length > 160 ? '3d' : '2d';\n\n  const postsBar = useMemo(() => {\n    if (postsBarType !== '2d') return null;\n    return posts.map((post) => {\n      // If part of filteredPosts\n      const isFiltered = filteredPostsMap[post.id];\n      return (\n        <span\n          key={post.id}\n          class={`post-dot ${isFiltered ? 'post-dot-highlight' : ''}`}\n        />\n      );\n    });\n  }, [filteredPostsMap]);\n\n  const postsBins = useMemo(() => {\n    if (postsBarType !== '3d') return null;\n    if (!posts?.length) return null;\n    const bins = binByTime(posts, 'createdAt', 320);\n    return bins.map((posts, i) => {\n      return (\n        <div class=\"posts-bin\" key={i}>\n          {posts.map((post) => {\n            const isFiltered = filteredPostsMap[post.id];\n            return (\n              <span\n                key={post.id}\n                class={`post-dot ${isFiltered ? 'post-dot-highlight' : ''}`}\n              />\n            );\n          })}\n        </div>\n      );\n    });\n  }, [filteredPostsMap]);\n\n  const scrollableRef = useRef(null);\n\n  // if range value exceeded lastCatchupEndAt, show error\n  const lastCatchupRange = useMemo(() => {\n    // return hour, not ms\n    if (!lastCatchupEndAt) return null;\n    return (Date.now() - lastCatchupEndAt) / 1000 / 60 / 60;\n  }, [lastCatchupEndAt, range]);\n\n  useEffect(() => {\n    if (uiState !== 'results') return;\n    const authorUsername =\n      selectedAuthor && authors[selectedAuthor]\n        ? authors[selectedAuthor].username\n        : '';\n    const sortOrderIndex = sortOrder === 'asc' ? 0 : 1;\n    const groupByText = {\n      account: 'authors',\n    };\n    let toast = showToast({\n      duration: 5_000, // 5 seconds\n      text: `Showing ${\n        FILTER_CATEGORY_TEXT[selectedFilterCategory] || 'all posts'\n      }${authorUsername ? ` by @${authorUsername}` : ''}, ${\n        SORT_BY_TEXT[sortBy][sortOrderIndex]\n      } first${\n        !!groupBy\n          ? `, grouped by ${groupBy === 'account' ? groupByText[groupBy] : ''}`\n          : ''\n      }`,\n    });\n    return () => {\n      toast?.hideToast?.();\n    };\n  }, [\n    uiState,\n    selectedFilterCategory,\n    selectedAuthor,\n    sortBy,\n    sortOrder,\n    groupBy,\n    authors,\n  ]);\n\n  const prevSelectedAuthorMissing = useRef(false);\n  useEffect(() => {\n    // console.log({\n    //   prevSelectedAuthorMissing,\n    //   selectedAuthor,\n    //   authors,\n    // });\n    let timer;\n    if (selectedAuthor) {\n      if (authors[selectedAuthor]) {\n        if (prevSelectedAuthorMissing.current) {\n          timer = setTimeout(() => {\n            authorsListParent.current\n              .querySelector(`[data-author=\"${selectedAuthor}\"]`)\n              ?.scrollIntoView({\n                behavior: 'smooth',\n                block: 'nearest',\n                inline: 'center',\n              });\n          }, 500);\n          prevSelectedAuthorMissing.current = false;\n        }\n      } else {\n        prevSelectedAuthorMissing.current = true;\n      }\n    }\n    return () => {\n      clearTimeout(timer);\n    };\n  }, [selectedAuthor, authors]);\n\n  const [showHelp, setShowHelp] = useState(false);\n\n  const itemsSelector = '.catchup-list > li > a';\n  useHotkeys(\n    'j',\n    () => {\n      const activeItem = document.activeElement.closest(itemsSelector);\n      const activeItemRect = activeItem?.getBoundingClientRect();\n      const allItems = Array.from(\n        scrollableRef.current.querySelectorAll(itemsSelector),\n      );\n      if (\n        activeItem &&\n        activeItemRect.top < scrollableRef.current.clientHeight &&\n        activeItemRect.bottom > 0\n      ) {\n        const activeItemIndex = allItems.indexOf(activeItem);\n        const nextItem = allItems[activeItemIndex + 1];\n        if (nextItem) {\n          nextItem.focus();\n          nextItem.scrollIntoView({\n            block: 'center',\n            inline: 'center',\n            behavior: 'smooth',\n          });\n        }\n      } else {\n        const topmostItem = allItems.find((item) => {\n          const itemRect = item.getBoundingClientRect();\n          return itemRect.top >= 0;\n        });\n        if (topmostItem) {\n          topmostItem.focus();\n          topmostItem.scrollIntoView({\n            block: 'nearest',\n            inline: 'center',\n            behavior: 'smooth',\n          });\n        }\n      }\n    },\n    {\n      preventDefault: true,\n    },\n  );\n\n  return (\n    <div\n      ref={scrollableRef}\n      id=\"catchup-page\"\n      class=\"deck-container\"\n      tabIndex=\"-1\"\n    >\n      <div class=\"timeline-deck deck wide\">\n        <header\n          class={`${uiState === 'loading' ? 'loading' : ''}`}\n          onClick={(e) => {\n            if (!e.target.closest('a, button')) {\n              scrollableRef.current?.scrollTo({\n                top: 0,\n                behavior: 'smooth',\n              });\n            }\n          }}\n        >\n          <div class=\"header-grid\">\n            <div class=\"header-side\">\n              <NavMenu />\n              {uiState === 'results' && (\n                <Link to=\"/catchup\" class=\"button plain\">\n                  <Icon icon=\"history2\" size=\"l\" />\n                </Link>\n              )}\n              {uiState === 'start' && (\n                <Link to=\"/\" class=\"button plain\">\n                  <Icon icon=\"home\" size=\"l\" />\n                </Link>\n              )}\n            </div>\n            <h1>\n              {uiState !== 'start' && (\n                <>\n                  Catch-up <sup>beta</sup>\n                </>\n              )}\n            </h1>\n            <div class=\"header-side\">\n              {uiState !== 'start' && uiState !== 'loading' && (\n                <button\n                  type=\"button\"\n                  class=\"plain\"\n                  onClick={() => {\n                    setShowHelp(true);\n                  }}\n                >\n                  Help\n                </button>\n              )}\n            </div>\n          </div>\n        </header>\n        <main>\n          {uiState === 'start' && (\n            <div class=\"catchup-start\">\n              <h1>\n                Catch-up <sup>beta</sup>\n              </h1>\n              <details>\n                <summary>What is this?</summary>\n                <p>\n                  Catch-up is a separate timeline for your followings, offering\n                  a high-level view at a glance, with a simple, email-inspired\n                  interface to effortlessly sort and filter through posts.\n                </p>\n                <img\n                  src={catchupUrl}\n                  width=\"1200\"\n                  height=\"900\"\n                  alt=\"Preview of Catch-up UI\"\n                />\n                <p>\n                  <button\n                    type=\"button\"\n                    onClick={(e) => {\n                      e.target.closest('details').open = false;\n                    }}\n                  >\n                    Let's catch up\n                  </button>\n                </p>\n              </details>\n              <p>Let's catch up on the posts from your followings.</p>\n              <p>\n                <b>Show me all posts from…</b>\n              </p>\n              <div class=\"catchup-form\">\n                <input\n                  ref={catchupRangeRef}\n                  type=\"range\"\n                  value={range}\n                  min={RANGES[0].value}\n                  max={RANGES[RANGES.length - 1].value}\n                  step=\"1\"\n                  list=\"catchup-ranges\"\n                  onChange={(e) => setRange(+e.target.value)}\n                />{' '}\n                <span\n                  style={{\n                    width: '8em',\n                  }}\n                >\n                  {RANGES[range - 1].label}\n                  <br />\n                  <small class=\"insignificant\">\n                    {range == RANGES[RANGES.length - 1].value\n                      ? 'until the max'\n                      : niceDateTime(\n                          new Date(Date.now() - range * 60 * 60 * 1000),\n                        )}\n                  </small>\n                </span>\n                <datalist id=\"catchup-ranges\">\n                  {RANGES.map(({ label, value }) => (\n                    <option value={value} label={label} />\n                  ))}\n                </datalist>{' '}\n                <button\n                  type=\"button\"\n                  onClick={() => {\n                    if (range < RANGES[RANGES.length - 1].value) {\n                      const duration = range * 60 * 60 * 1000;\n                      handleCatchupClick({ duration });\n                    } else {\n                      handleCatchupClick();\n                    }\n                  }}\n                >\n                  Catch up\n                </button>\n              </div>\n              {lastCatchupRange && range > lastCatchupRange && (\n                <p class=\"catchup-info\">\n                  <Icon icon=\"info\" /> Overlaps with your last catch-up\n                </p>\n              )}\n              <p class=\"insignificant\">\n                <small>\n                  Note: your instance might only show a maximum of 800 posts in\n                  the Home timeline regardless of the time range. Could be less\n                  or more.\n                </small>\n              </p>\n              {!!prevCatchups?.length && (\n                <div class=\"catchup-prev\">\n                  <p>Previously…</p>\n                  <ul>\n                    {prevCatchups.map((pc) => (\n                      <li key={pc.id}>\n                        <Link to={`/catchup?id=${pc.id}`}>\n                          <Icon icon=\"history2\" />{' '}\n                          <span>\n                            {formatRange(\n                              new Date(pc.startAt),\n                              new Date(pc.endAt),\n                            )}\n                          </span>\n                        </Link>{' '}\n                        <span>\n                          <small class=\"ib insignificant\">\n                            {pc.count} posts\n                          </small>{' '}\n                          <button\n                            type=\"button\"\n                            class=\"light danger small\"\n                            onClick={async () => {\n                              const yes = confirm('Remove this catch-up?');\n                              if (yes) {\n                                let t = showToast(`Removing Catch-up ${pc.id}`);\n                                await db.catchup.del(pc.id);\n                                t?.hideToast?.();\n                                showToast(`Catch-up ${pc.id} removed`);\n                                reloadCatchups();\n                              }\n                            }}\n                          >\n                            <Icon icon=\"x\" />\n                          </button>\n                        </span>\n                      </li>\n                    ))}\n                  </ul>\n                  {prevCatchups.length >= 3 && (\n                    <p>\n                      <small>\n                        Note: Only max 3 will be stored. The rest will be\n                        automatically removed.\n                      </small>\n                    </p>\n                  )}\n                </div>\n              )}\n            </div>\n          )}\n          {uiState === 'loading' && (\n            <div class=\"ui-state catchup-start\">\n              <Loader abrupt />\n              <p class=\"insignificant\">Fetching posts…</p>\n              <p class=\"insignificant\">This might take a while.</p>\n            </div>\n          )}\n          {uiState === 'results' && (\n            <>\n              <div class=\"catchup-header\">\n                {posts.length > 0 && (\n                  <p>\n                    <b class=\"ib\">\n                      {formatRange(\n                        new Date(posts[0].createdAt),\n                        new Date(posts[posts.length - 1].createdAt),\n                      )}\n                    </b>\n                  </p>\n                )}\n                <aside>\n                  <button\n                    hidden={\n                      selectedFilterCategory === 'All' &&\n                      !selectedAuthor &&\n                      sortBy === 'createdAt' &&\n                      sortOrder === 'asc'\n                    }\n                    type=\"button\"\n                    class=\"plain4 small\"\n                    onClick={() => {\n                      setSelectedFilterCategory('All');\n                      setSelectedAuthor(null);\n                      setSortBy('createdAt');\n                      setGroupBy(null);\n                      setSortOrder('asc');\n                    }}\n                  >\n                    Reset filters\n                  </button>\n                  {links?.length > 0 && (\n                    <button\n                      type=\"button\"\n                      class=\"plain small\"\n                      onClick={() => setShowTopLinks(!showTopLinks)}\n                    >\n                      Top links{' '}\n                      <Icon\n                        icon=\"chevron-down\"\n                        style={{\n                          transform: showTopLinks\n                            ? 'rotate(180deg)'\n                            : 'rotate(0deg)',\n                        }}\n                      />\n                    </button>\n                  )}\n                </aside>\n              </div>\n              <div class=\"shazam-container no-animation\" hidden={!showTopLinks}>\n                <div class=\"shazam-container-inner\">\n                  <div class=\"catchup-top-links links-bar\">\n                    {links.map((link) => {\n                      const { card, shared, sharers, likes, boosts } = link;\n                      const {\n                        blurhash,\n                        title,\n                        description,\n                        url,\n                        image,\n                        imageDescription,\n                        language,\n                        width,\n                        height,\n                        publishedAt,\n                      } = card;\n                      const domain = new URL(url).hostname\n                        .replace(/^www\\./, '')\n                        .replace(/\\/$/, '');\n                      let accentColor;\n                      if (blurhash) {\n                        const averageColor = getBlurHashAverageColor(blurhash);\n                        const labAverageColor = rgb2oklab(averageColor);\n                        accentColor = oklab2rgb([\n                          0.6,\n                          labAverageColor[1],\n                          labAverageColor[2],\n                        ]);\n                      }\n\n                      return (\n                        <a\n                          key={url}\n                          href={url}\n                          target=\"_blank\"\n                          rel=\"noopener noreferrer\"\n                          style={\n                            accentColor\n                              ? {\n                                  '--accent-color': `rgb(${accentColor.join(\n                                    ',',\n                                  )})`,\n                                  '--accent-alpha-color': `rgba(${accentColor.join(\n                                    ',',\n                                  )}, 0.4)`,\n                                }\n                              : {}\n                          }\n                        >\n                          <article>\n                            <figure>\n                              <img\n                                src={image}\n                                alt={imageDescription}\n                                width={width}\n                                height={height}\n                                loading=\"lazy\"\n                              />\n                            </figure>\n                            <div class=\"article-body\">\n                              <header>\n                                <div class=\"article-meta\">\n                                  <span class=\"domain\">{domain}</span>{' '}\n                                  {!!publishedAt && <>&middot; </>}\n                                  {!!publishedAt && (\n                                    <>\n                                      <RelativeTime\n                                        datetime={publishedAt}\n                                        format=\"micro\"\n                                      />\n                                    </>\n                                  )}\n                                </div>\n                                {!!title && (\n                                  <h1 class=\"title\" lang={language} dir=\"auto\">\n                                    {title}\n                                  </h1>\n                                )}\n                              </header>\n                              {!!description && (\n                                <p\n                                  class=\"description\"\n                                  lang={language}\n                                  dir=\"auto\"\n                                >\n                                  {description}\n                                </p>\n                              )}\n                              <hr />\n                              <p\n                                style={{\n                                  whiteSpace: 'nowrap',\n                                }}\n                              >\n                                Shared by{' '}\n                                {sharers.map((s) => {\n                                  const { avatarStatic, displayName } = s;\n                                  return (\n                                    <Avatar\n                                      url={avatarStatic}\n                                      size=\"s\"\n                                      alt={displayName}\n                                    />\n                                  );\n                                })}\n                              </p>\n                            </div>\n                          </article>\n                        </a>\n                      );\n                    })}\n                  </div>\n                </div>\n              </div>\n              {posts.length >= 5 &&\n                (postsBarType === '3d' ? (\n                  <div class=\"catchup-posts-viz-time-bar\">{postsBins}</div>\n                ) : (\n                  <div class=\"catchup-posts-viz-bar\">{postsBar}</div>\n                ))}\n              {posts.length >= 2 && (\n                <div class=\"catchup-filters\">\n                  <label class=\"filter-cat\">\n                    <input\n                      type=\"radio\"\n                      name=\"filter-cat\"\n                      checked={selectedFilterCategory.toLowerCase() === 'all'}\n                      onChange={() => {\n                        setSelectedFilterCategory('All');\n                      }}\n                    />\n                    All <span class=\"count\">{posts.length}</span>\n                  </label>\n                  {FILTER_LABELS.map(\n                    (label) =>\n                      !!filterCounts[label] && (\n                        <label\n                          class=\"filter-cat\"\n                          key={label}\n                          title={\n                            (\n                              (filterCounts[label] / posts.length) *\n                              100\n                            ).toFixed(2) + '%'\n                          }\n                        >\n                          <input\n                            type=\"radio\"\n                            name=\"filter-cat\"\n                            checked={\n                              selectedFilterCategory.toLowerCase() ===\n                              label.toLowerCase()\n                            }\n                            onChange={() => {\n                              setSelectedFilterCategory(label);\n                              // setSelectedAuthor(null);\n                            }}\n                          />\n                          {label}{' '}\n                          <span class=\"count\">{filterCounts[label]}</span>\n                        </label>\n                      ),\n                  )}\n                </div>\n              )}\n              {posts.length >= 2 && !!authorCounts && (\n                <div\n                  class=\"catchup-filters authors-filters\"\n                  ref={authorsListParent}\n                >\n                  {authorCountsList.map((author) => (\n                    <label\n                      class=\"filter-author\"\n                      data-author={author}\n                      key={`${author}-${authorCounts[author]}`}\n                      // Preact messed up the order sometimes, need additional key besides just `author`\n                      // https://github.com/preactjs/preact/issues/2849\n                    >\n                      <input\n                        type=\"radio\"\n                        name=\"filter-author\"\n                        checked={selectedAuthor === author}\n                        onChange={() => {\n                          setSelectedAuthor(author);\n                          // setGroupBy(null);\n                        }}\n                        onClick={() => {\n                          if (selectedAuthor === author) {\n                            setSelectedAuthor(null);\n                          }\n                        }}\n                      />\n                      <Avatar\n                        url={\n                          authors[author].avatarStatic || authors[author].avatar\n                        }\n                        size=\"xxl\"\n                        alt={`${authors[author].displayName} (@${authors[author].username})`}\n                      />{' '}\n                      <span class=\"count\">{authorCounts[author]}</span>\n                      <span class=\"username\">{authors[author].username}</span>\n                    </label>\n                  ))}\n                  {authorCountsList.length > 5 && (\n                    <small\n                      key=\"authors-count\"\n                      style={{\n                        whiteSpace: 'nowrap',\n                        paddingInline: '1em',\n                        opacity: 0.33,\n                      }}\n                    >\n                      {authorCountsList.length} authors\n                    </small>\n                  )}\n                </div>\n              )}\n              {posts.length >= 2 && (\n                <div class=\"catchup-filters\">\n                  <span class=\"filter-label\">Sort</span>{' '}\n                  <fieldset class=\"radio-field-group\">\n                    {FILTER_SORTS.map((key) => (\n                      <label\n                        class=\"filter-sort\"\n                        key={key}\n                        onClick={(e) => {\n                          if (sortBy === key) {\n                            e.preventDefault();\n                            e.stopPropagation();\n                            setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc');\n                          }\n                        }}\n                      >\n                        <input\n                          type=\"radio\"\n                          name=\"filter-sort-cat\"\n                          checked={sortBy === key}\n                          onChange={() => {\n                            setSortBy(key);\n                            const order = /(replies|favourites|reblogs)/.test(\n                              key,\n                            )\n                              ? 'desc'\n                              : 'asc';\n                            setSortOrder(order);\n                          }}\n                        />\n                        {\n                          {\n                            createdAt: 'Date',\n                            repliesCount: 'Replies',\n                            favouritesCount: 'Likes',\n                            reblogsCount: 'Boosts',\n                            density: 'Density',\n                          }[key]\n                        }\n                        {sortBy === key && (sortOrder === 'asc' ? ' ↑' : ' ↓')}\n                      </label>\n                    ))}\n                  </fieldset>\n                  {/* <fieldset class=\"radio-field-group\">\n                    {['asc', 'desc'].map((key) => (\n                      <label class=\"filter-sort\" key={key}>\n                        <input\n                          type=\"radio\"\n                          name=\"filter-sort-dir\"\n                          checked={sortOrder === key}\n                          onChange={() => {\n                            setSortOrder(key);\n                          }}\n                        />\n                        {key === 'asc' ? '↑' : '↓'}\n                      </label>\n                    ))}\n                  </fieldset> */}\n                  <span class=\"filter-label\">Group</span>{' '}\n                  <fieldset class=\"radio-field-group\">\n                    {FILTER_GROUPS.map((key) => (\n                      <label class=\"filter-group\" key={key || 'none'}>\n                        <input\n                          type=\"radio\"\n                          name=\"filter-group\"\n                          checked={groupBy === key}\n                          onChange={() => {\n                            setGroupBy(key);\n                          }}\n                          disabled={key === 'account' && selectedAuthor}\n                        />\n                        {{\n                          account: 'Authors',\n                        }[key] || 'None'}\n                      </label>\n                    ))}\n                  </fieldset>\n                  {\n                    selectedAuthor && authorCountsList.length > 1 ? (\n                      <button\n                        type=\"button\"\n                        class=\"plain6 small\"\n                        onClick={() => {\n                          setSelectedAuthor(null);\n                        }}\n                        style={{\n                          whiteSpace: 'nowrap',\n                        }}\n                      >\n                        Show all authors\n                      </button>\n                    ) : null\n                    // <button\n                    //   type=\"button\"\n                    //   class=\"plain4 small\"\n                    //   onClick={() => {}}\n                    // >\n                    //   Group by authors\n                    // </button>\n                  }\n                </div>\n              )}\n              <ul\n                class={`catchup-list catchup-filter-${\n                  FILTER_VALUES[selectedFilterCategory] || ''\n                } ${sortBy ? `catchup-sort-${sortBy}` : ''} ${\n                  selectedAuthor && authors[selectedAuthor]\n                    ? `catchup-selected-author`\n                    : ''\n                } ${groupBy ? `catchup-group-${groupBy}` : ''}`}\n              >\n                {sortedFilteredPosts.map((post, i) => {\n                  const id = post.reblog?.id || post.id;\n                  let showSeparator = false;\n                  if (groupBy === 'account') {\n                    if (\n                      prevGroup.current &&\n                      post.account.id !== prevGroup.current &&\n                      i > 0\n                    ) {\n                      showSeparator = true;\n                    }\n                    prevGroup.current = post.account.id;\n                  }\n                  return (\n                    <Fragment key={`${post.id}-${showSeparator}`}>\n                      {showSeparator && <li class=\"separator\" />}\n                      <IntersectionPostLineItem\n                        to={`/${instance}/s/${id}`}\n                        post={post}\n                        root={scrollableRef.current}\n                      />\n                    </Fragment>\n                  );\n                })}\n              </ul>\n              <footer>\n                {filteredPosts.length > 5 && (\n                  <p>\n                    {selectedFilterCategory === 'Boosts'\n                      ? \"You don't have to read everything.\"\n                      : \"That's all.\"}{' '}\n                    <button\n                      type=\"button\"\n                      class=\"textual\"\n                      onClick={() => {\n                        scrollableRef.current.scrollTop = 0;\n                      }}\n                    >\n                      Back to top\n                    </button>\n                    .\n                  </p>\n                )}\n              </footer>\n            </>\n          )}\n        </main>\n      </div>\n      {showHelp && (\n        <Modal onClose={() => setShowHelp(false)}>\n          <div class=\"sheet\" id=\"catchup-help-sheet\">\n            <button\n              type=\"button\"\n              class=\"sheet-close\"\n              onClick={() => setShowHelp(false)}\n            >\n              <Icon icon=\"x\" />\n            </button>\n            <header>\n              <h2>Help</h2>\n            </header>\n            <main>\n              <dl>\n                <dt>Top links</dt>\n                <dd>\n                  Links shared by followings, sorted by shared counts, boosts\n                  and likes.\n                </dd>\n                <dt>Sort: Density</dt>\n                <dd>\n                  Posts are sorted by information density or depth. Shorter\n                  posts are \"lighter\" while longer posts are \"heavier\". Posts\n                  with photos are \"heavier\" than posts without photos.\n                </dd>\n                <dt>Group: Authors</dt>\n                <dd>\n                  Posts are grouped by authors, sorted by posts count per\n                  author.\n                </dd>\n              </dl>\n            </main>\n          </div>\n        </Modal>\n      )}\n    </div>\n  );\n}\n\nconst PostLine = memo(\n  function ({ post }) {\n    const {\n      id,\n      account,\n      group,\n      reblog,\n      inReplyToId,\n      inReplyToAccountId,\n      _followedTags: isFollowedTags,\n      _filtered: filterInfo,\n      visibility,\n    } = post;\n    const isReplyTo = inReplyToId && inReplyToAccountId !== account.id;\n    const isFiltered = !!filterInfo;\n\n    const debugHover = (e) => {\n      if (e.shiftKey) {\n        console.log({\n          ...post,\n        });\n      }\n    };\n\n    return (\n      <article\n        class={`post-line ${\n          group\n            ? 'group'\n            : reblog\n            ? 'reblog'\n            : isFollowedTags?.length\n            ? 'followed-tags'\n            : ''\n        } ${isReplyTo ? 'reply-to' : ''} ${\n          isFiltered ? 'filtered' : ''\n        } visibility-${visibility}`}\n        onMouseEnter={debugHover}\n      >\n        <span class=\"post-author\">\n          {reblog ? (\n            <span class=\"post-reblog-avatar\">\n              <Avatar\n                url={account.avatarStatic || account.avatar}\n                squircle={account.bot}\n              />{' '}\n              <Icon icon=\"rocket\" />{' '}\n              {/* <Avatar\n              url={reblog.account.avatarStatic || reblog.account.avatar}\n              squircle={reblog.account.bot}\n            /> */}\n              <NameText account={reblog.account} showAvatar />\n            </span>\n          ) : (\n            <NameText account={account} showAvatar />\n          )}\n        </span>\n        <PostPeek post={reblog || post} filterInfo={filterInfo} />\n        <span class=\"post-meta\">\n          <PostStats post={reblog || post} />{' '}\n          <RelativeTime\n            datetime={new Date(reblog?.createdAt || post.createdAt)}\n            format=\"micro\"\n          />\n        </span>\n      </article>\n    );\n  },\n  (oldProps, newProps) => {\n    return oldProps?.post?.id === newProps?.post?.id;\n  },\n);\n\nconst IntersectionPostLineItem = ({ root, to, ...props }) => {\n  const ref = useRef();\n  const [show, setShow] = useState(false);\n  useEffect(() => {\n    const observer = new IntersectionObserver(\n      (entries) => {\n        const entry = entries[0];\n        if (entry.isIntersecting) {\n          queueMicrotask(() => setShow(true));\n          observer.unobserve(ref.current);\n        }\n      },\n      {\n        root,\n        rootMargin: `${Math.max(320, screen.height * 0.75)}px`,\n      },\n    );\n    if (ref.current) observer.observe(ref.current);\n    return () => {\n      if (ref.current) observer.unobserve(ref.current);\n    };\n  }, []);\n\n  return show ? (\n    <li>\n      <Link to={to}>\n        <PostLine {...props} />\n      </Link>\n    </li>\n  ) : (\n    <li ref={ref} style={{ height: '4em' }} />\n  );\n};\n\n// A media speak a thousand words\nconst MEDIA_DENSITY = 8;\nconst CARD_DENSITY = 8;\nfunction postDensity(post) {\n  const { spoilerText, content, poll, mediaAttachments, card } = post;\n  const pollContent = poll?.options?.length\n    ? poll.options.reduce((acc, cur) => acc + cur.title, '')\n    : '';\n  const density =\n    (spoilerText.length + htmlContentLength(content) + pollContent.length) /\n      140 +\n    (mediaAttachments?.length\n      ? MEDIA_DENSITY * mediaAttachments.length\n      : card?.image\n      ? CARD_DENSITY\n      : 0);\n  return density;\n}\n\nconst MEDIA_SIZE = 48;\n\nfunction PostPeek({ post, filterInfo }) {\n  const {\n    spoilerText,\n    sensitive,\n    content,\n    emojis,\n    poll,\n    mediaAttachments,\n    card,\n    inReplyToId,\n    inReplyToAccountId,\n    account,\n    _thread,\n  } = post;\n  const isThread =\n    (inReplyToId && inReplyToAccountId === account.id) || !!_thread;\n  const showMedia = !spoilerText && !sensitive;\n  const postText = content ? statusPeek(post) : '';\n\n  return (\n    <div class=\"post-peek\" title={!spoilerText ? postText : ''}>\n      <span class=\"post-peek-content\">\n        {!!filterInfo ? (\n          <>\n            {isThread && (\n              <>\n                <span class=\"post-peek-tag post-peek-thread\">Thread</span>{' '}\n              </>\n            )}\n            <span class=\"post-peek-filtered\">\n              Filtered{filterInfo?.titlesStr ? `: ${filterInfo.titlesStr}` : ''}\n            </span>\n          </>\n        ) : !!spoilerText ? (\n          <>\n            {isThread && (\n              <>\n                <span class=\"post-peek-tag post-peek-thread\">Thread</span>{' '}\n              </>\n            )}\n            <span class=\"post-peek-spoiler\">\n              <Icon icon=\"eye-close\" /> {spoilerText}\n            </span>\n          </>\n        ) : (\n          <div class=\"post-peek-html\">\n            {isThread && (\n              <>\n                <span class=\"post-peek-tag post-peek-thread\">Thread</span>{' '}\n              </>\n            )}\n            {!!content && (\n              <div\n                dangerouslySetInnerHTML={{\n                  __html: emojifyText(content, emojis),\n                }}\n              />\n            )}\n            {!!poll?.options?.length &&\n              poll.options.map((o) => (\n                <div>\n                  {poll.multiple ? '▪️' : '•'} {o.title}\n                </div>\n              ))}\n            {!content &&\n              mediaAttachments?.length === 1 &&\n              mediaAttachments[0].description && (\n                <>\n                  <span class=\"post-peek-tag post-peek-alt\">ALT</span>{' '}\n                  <div>{mediaAttachments[0].description}</div>\n                </>\n              )}\n          </div>\n        )}\n      </span>\n      {!filterInfo && (\n        <span class=\"post-peek-post-content\">\n          {!!poll && (\n            <span class=\"post-peek-tag post-peek-poll\">\n              <Icon icon=\"poll\" size=\"s\" />\n              Poll\n            </span>\n          )}\n          {!!mediaAttachments?.length\n            ? mediaAttachments.map((m) => {\n                const mediaURL = m.previewUrl || m.url;\n                const remoteMediaURL = m.previewRemoteUrl || m.remoteUrl;\n                return (\n                  <span key={m.id} class=\"post-peek-media\">\n                    {{\n                      image:\n                        (mediaURL || remoteMediaURL) && showMedia ? (\n                          <img\n                            src={mediaURL}\n                            width={MEDIA_SIZE}\n                            height={MEDIA_SIZE}\n                            alt={m.description}\n                            loading=\"lazy\"\n                            onError={(e) => {\n                              const { src } = e.target;\n                              if (src === mediaURL) {\n                                e.target.src = remoteMediaURL;\n                              }\n                            }}\n                          />\n                        ) : (\n                          <span class=\"post-peek-faux-media\">🖼</span>\n                        ),\n                      gifv:\n                        (mediaURL || remoteMediaURL) && showMedia ? (\n                          <img\n                            src={mediaURL}\n                            width={MEDIA_SIZE}\n                            height={MEDIA_SIZE}\n                            alt={m.description}\n                            loading=\"lazy\"\n                            onError={(e) => {\n                              const { src } = e.target;\n                              if (src === mediaURL) {\n                                e.target.src = remoteMediaURL;\n                              }\n                            }}\n                          />\n                        ) : (\n                          <span class=\"post-peek-faux-media\">🎞️</span>\n                        ),\n                      video:\n                        (mediaURL || remoteMediaURL) && showMedia ? (\n                          <img\n                            src={mediaURL}\n                            width={MEDIA_SIZE}\n                            height={MEDIA_SIZE}\n                            alt={m.description}\n                            loading=\"lazy\"\n                            onError={(e) => {\n                              const { src } = e.target;\n                              if (src === mediaURL) {\n                                e.target.src = remoteMediaURL;\n                              }\n                            }}\n                          />\n                        ) : (\n                          <span class=\"post-peek-faux-media\">📹</span>\n                        ),\n                      audio: <span class=\"post-peek-faux-media\">🎵</span>,\n                    }[m.type] || null}\n                  </span>\n                );\n              })\n            : !!card &&\n              card.image &&\n              showMedia && (\n                <span\n                  class={`post-peek-media post-peek-card card-${\n                    card.type || ''\n                  }`}\n                >\n                  {card.image ? (\n                    <img\n                      src={card.image}\n                      width={MEDIA_SIZE}\n                      height={MEDIA_SIZE}\n                      alt={\n                        card.title || card.description || card.imageDescription\n                      }\n                      loading=\"lazy\"\n                    />\n                  ) : (\n                    <span class=\"post-peek-faux-media\">🔗</span>\n                  )}\n                </span>\n              )}\n        </span>\n      )}\n    </div>\n  );\n}\n\nfunction PostStats({ post }) {\n  const { reblogsCount, repliesCount, favouritesCount } = post;\n  return (\n    <span class=\"post-stats\">\n      {repliesCount > 0 && (\n        <span class=\"post-stat-replies\">\n          <Icon icon=\"comment2\" size=\"s\" /> {shortenNumber(repliesCount)}\n        </span>\n      )}\n      {favouritesCount > 0 && (\n        <span class=\"post-stat-likes\">\n          <Icon icon=\"heart\" size=\"s\" /> {shortenNumber(favouritesCount)}\n        </span>\n      )}\n      {reblogsCount > 0 && (\n        <span class=\"post-stat-boosts\">\n          <Icon icon=\"rocket\" size=\"s\" /> {shortenNumber(reblogsCount)}\n        </span>\n      )}\n    </span>\n  );\n}\n\nconst { locale } = new Intl.DateTimeFormat().resolvedOptions();\nconst dtf = new Intl.DateTimeFormat(locale, {\n  year: 'numeric',\n  month: 'short',\n  day: 'numeric',\n  hour: 'numeric',\n  minute: 'numeric',\n});\nfunction formatRange(startDate, endDate) {\n  return dtf.formatRange(startDate, endDate);\n}\n\nfunction binByTime(data, key, numBins) {\n  // Extract dates from data objects\n  const dates = data.map((item) => new Date(item[key]));\n\n  // Find minimum and maximum dates directly (avoiding Math.min/max)\n  const minDate = dates.reduce(\n    (acc, date) => (date < acc ? date : acc),\n    dates[0],\n  );\n  const maxDate = dates.reduce(\n    (acc, date) => (date > acc ? date : acc),\n    dates[0],\n  );\n\n  // Calculate the time span in milliseconds\n  const range = maxDate.getTime() - minDate.getTime();\n\n  // Create empty bins and loop through data\n  const bins = Array.from({ length: numBins }, () => []);\n  data.forEach((item) => {\n    const date = new Date(item[key]);\n    const normalized = (date.getTime() - minDate.getTime()) / range;\n    const binIndex = Math.floor(normalized * (numBins - 1));\n    bins[binIndex].push(item);\n  });\n\n  return bins;\n}\n\nexport default Catchup;\n"],"names":["catchupUrl","FILTER_CONTEXT","RANGES","label","value","FILTER_LABELS","FILTER_SORTS","FILTER_GROUPS","FILTER_VALUES","Filtered","Groups","Boosts","Replies","Original","FILTER_CATEGORY_TEXT","SORT_BY_TEXT","createdAt","repliesCount","favouritesCount","reblogsCount","density","Catchup","useTitle","masto","instance","api","searchParams","setSearchParams","useSearchParams","id","get","uiState","setUIState","useState","showTopLinks","setShowTopLinks","currentAccount","useMemo","store","session","isSelf","accountID","fetchHome","maxCreatedAt","maxCreatedAtDate","Date","debug","allResults","mainloop","results","homeIterator","assignFollowedTags","i","item","createdAtDate","selfPost","reblog","filterInfo","isFiltered","statusKey","sKey","states","addedResults","resolve","Promise","console","status","s","replyToStatus","find","catchupRangeRef","useRef","NS","setPosts","useCallback","duration","handleCatchupClick","now","db","catchupID","catchup","posts","count","length","useEffect","error","a","b","reloadCatchups","useReducer","c","setLastCatchupEndAt","prevCatchups","setPrevCatchups","lastCatchupEndAt","catchups","ns","getCurrentAccountNS","ownKeys","key","ownCatchups","trimmedCatchups","lastCatchups","restCatchups","endAt","startAt","queueMicrotask","reloadCatchupsCount","filtereds","groups","boosts","replies","followedTags","originals","post","_followedTags","inReplyToId","inReplyToAccountId","_e","thePost","__FILTER","card","url","links","sharers","links2","link","topLinks","sort","shared","linksLoop","likes","filteredPosts","authors","authorCounts","selectedFilterCategory","filteredPosts2","setSelectedAuthor","range","sortBy","authorsHash","setSortOrder","authorCountsMap","filter","selectedAuthor","account","set","filteredPostsMap","postFilterMatches","map","authorID","index","authorCountsList","Object","sortedFilteredPosts","aAccountID","forEach","authorIndices","order","bAccountID","aIndex","bIndex","postDensity","bDensity","aDensity","sortOrder","groupBy","prevGroup","authorsListParent","autoAnimated","current","postsBarType","autoAnimate","_jsx","postsBar","postsBins","binByTime","posts2","isFiltered2","children","lastCatchupRange","scrollableRef","groupByText","showToast","authorUsername","sortOrderIndex","prevSelectedAuthorMissing","timer","toast","showHelp","setShowHelp","useHotkeys","activeItem","itemsSelector","activeItemRect","clearTimeout","allItems","activeItemIndex","nextItem","document","activeElement","behavior","topmostItem","itemRect","scrollIntoView","_jsxs","e","_a","onClick","target","NavMenu","Link","Icon","to","class","icon","_Fragment","closest","setRange","type","min","max","niceDateTime","style","pc","formatRange","t","yes","abrupt","setSelectedFilterCategory","setSortBy","setGroupBy","transform","blurhash","width","title","description","image","imageDescription","language","height","publishedAt","accentColor","averageColor","getBlurHashAverageColor","labAverageColor","oklab2rgb","alt","domain","RelativeTime","dir","avatarStatic","Avatar","displayName","name","checked","toLowerCase","filterCounts","author","avatar","size","username","opacity","onChange","disabled","id2","showSeparator","Fragment","Modal","onClose","PostLine","memo","group","isFollowedTags","visibility","isReplyTo","NameText","debugHover","bot","showAvatar","oldProps","format","show","setShow","observer","entries","root","props","ref","entry","unobserve","rootMargin","Math","observe","spoilerText","pollContent","poll","acc","cur","htmlContentLength","content","mediaAttachments","MEDIA_DENSITY","CARD_DENSITY","MEDIA_SIZE","PostPeek","emojis","_thread","sensitive","showMedia","isThread","emojifyText","o","dangerouslySetInnerHTML","__html","multiple","mediaURL","m","remoteMediaURL","src","audio","shortenNumber","locale","dtf","startDate","endDate","Intl","data","minDate","DateTimeFormat","date","dates","bins","numBins","binIndex","normalized"],"mappings":"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"}